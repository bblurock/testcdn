function pluralRuleParser(a,b){function c(){}function d(a){return function(){for(var b=0;b<a.length;b++){var c=a[b]();if(null!==c)return c}return null}}function e(a){for(var b=u,c=[],d=0;d<a.length;d++){var e=a[d]();if(null===e)return u=b,null;c.push(e)}return c}function f(a,b){return function(){for(var c=u,d=[],e=b();null!==e;)d.push(e),e=b();return d.length<a?(u=c,null):d}}function g(b){var c=b.length;return function(){var d=null;return a.substr(u,c)===b&&(d=b,u+=c),d}}function h(b){return function(){var c=a.substr(u).match(b);return null===c?null:(u+=c[0].length,c[0])}}function i(){var a=x();return null===a?(c(" -- failed n"),a):(a=parseFloat(b),c(" -- passed n ",a),a)}function j(){var a=e([i,v,z,v,w]);return null===a?(c(" -- failed mod"),null):(c(" -- passed mod"),parseInt(a[0],10)%parseInt(a[4],10))}function k(){var a=e([v,A]);return null===a?(c(" -- failed not"),null):a[1]}function l(){var a=e([H,v,y,f(0,k),v,w]);return null!==a?(c(" -- passed is"),"not"===a[3][0]?a[0]!==parseInt(a[5],10):a[0]===parseInt(a[5],10)):(c(" -- failed is"),null)}function m(){var a=e([d([o,w]),f(0,n)]),b=[];return null!==a?(b=b.concat(a[0]),a[1][0]&&(b=b.concat(a[1][0])),b):(c(" -- failed rangeList"),null)}function n(){var a=e([E,m]);return null!==a?a[1]:(c(" -- failed rangeTail"),null)}function o(){var a,b=e([w,D,w]);if(null!==b){c(" -- passed range");var d=[],f=parseInt(b[0],10),g=parseInt(b[2],10);for(a=f;g>=a;a++)d.push(a);return d}return c(" -- failed range"),null}function p(){var a=e([H,f(0,k),v,B,v,m]);if(null!==a){c(" -- passed _in");for(var b=a[5],d=0;d<b.length;d++)if(parseInt(b[d],10)===a[0])return"not"!==a[1][0];return"not"===a[1][0]}return c(" -- failed _in "),null}function q(){var a=e([H,f(0,k),v,C,v,m]);if(null!==a){c(" -- passed within");var b=a[5];return a[0]>=parseInt(b[0])&&a[0]<parseInt(b[b.length-1])?"not"!==a[1][0]:"not"===a[1][0]}return c(" -- failed within "),null}function r(){var a=e([I,v,G,v,J]);return a?(c(" -- passed and"),a[0]&&a[4]):(c(" -- failed and"),null)}function s(){var a=e([I,v,F,v,J]);return a?(c(" -- passed or"),a[0]||a[4]):(c(" -- failed or"),null)}function t(){var a=J();return a}var u=0,v=h(/^\s+/),w=h(/^\d+/),x=g("n"),y=g("is"),z=g("mod"),A=g("not"),B=g("in"),C=g("within"),D=g(".."),E=g(","),F=g("or"),G=g("and");c("pluralRuleParser",a,b);var H=d([j,i]),I=d([l,p,q]),J=d([r,s,I]),K=t();return null===K||u!==a.length,K}var requirejs,require,define;!function(global){function isFunction(a){return"[object Function]"===ostring.call(a)}function isArray(a){return"[object Array]"===ostring.call(a)}function each(a,b){if(a){var c;for(c=0;c<a.length&&(!a[c]||!b(a[c],c,a));c+=1);}}function eachReverse(a,b){if(a){var c;for(c=a.length-1;c>-1&&(!a[c]||!b(a[c],c,a));c-=1);}}function hasProp(a,b){return hasOwn.call(a,b)}function getOwn(a,b){return hasProp(a,b)&&a[b]}function eachProp(a,b){var c;for(c in a)if(hasProp(a,c)&&b(a[c],c))break}function mixin(a,b,c,d){return b&&eachProp(b,function(b,e){!c&&hasProp(a,e)||(!d||"object"!=typeof b||!b||isArray(b)||isFunction(b)||b instanceof RegExp?a[e]=b:(a[e]||(a[e]={}),mixin(a[e],b,c,d)))}),a}function bind(a,b){return function(){return b.apply(a,arguments)}}function scripts(){return document.getElementsByTagName("script")}function defaultOnError(a){throw a}function getGlobal(a){if(!a)return a;var b=global;return each(a.split("."),function(a){b=b[a]}),b}function makeError(a,b,c,d){var e=new Error(b+"\nhttp://requirejs.org/docs/errors.html#"+a);return e.requireType=a,e.requireModules=d,c&&(e.originalError=c),e}function newContext(a){function b(a){var b,c,d=a.length;for(b=0;d>b;b++)if(c=a[b],"."===c)a.splice(b,1),b-=1;else if(".."===c){if(1===b&&(".."===a[2]||".."===a[0]))break;b>0&&(a.splice(b-1,2),b-=2)}}function c(a,c,d){var e,f,g,h,i,j,k,l,m,n,o,p=c&&c.split("/"),q=p,r=x.map,s=r&&r["*"];if(a&&"."===a.charAt(0)&&(c?(q=p.slice(0,p.length-1),a=a.split("/"),k=a.length-1,x.nodeIdCompat&&jsSuffixRegExp.test(a[k])&&(a[k]=a[k].replace(jsSuffixRegExp,"")),a=q.concat(a),b(a),a=a.join("/")):0===a.indexOf("./")&&(a=a.substring(2))),d&&r&&(p||s)){g=a.split("/");a:for(h=g.length;h>0;h-=1){if(j=g.slice(0,h).join("/"),p)for(i=p.length;i>0;i-=1)if(f=getOwn(r,p.slice(0,i).join("/")),f&&(f=getOwn(f,j))){l=f,m=h;break a}!n&&s&&getOwn(s,j)&&(n=getOwn(s,j),o=h)}!l&&n&&(l=n,m=o),l&&(g.splice(0,m,l),a=g.join("/"))}return e=getOwn(x.pkgs,a),e?e:a}function d(a){isBrowser&&each(scripts(),function(b){return b.getAttribute("data-requiremodule")===a&&b.getAttribute("data-requirecontext")===u.contextName?(b.parentNode.removeChild(b),!0):void 0})}function e(a){var b=getOwn(x.paths,a);return b&&isArray(b)&&b.length>1?(b.shift(),u.require.undef(a),u.require([a]),!0):void 0}function f(a){var b,c=a?a.indexOf("!"):-1;return c>-1&&(b=a.substring(0,c),a=a.substring(c+1,a.length)),[b,a]}function g(a,b,d,e){var g,h,i,j,k=null,l=b?b.name:null,m=a,n=!0,o="";return a||(n=!1,a="_@r"+(F+=1)),j=f(a),k=j[0],a=j[1],k&&(k=c(k,l,e),h=getOwn(C,k)),a&&(k?o=h&&h.normalize?h.normalize(a,function(a){return c(a,l,e)}):c(a,l,e):(o=c(a,l,e),j=f(o),k=j[0],o=j[1],d=!0,g=u.nameToUrl(o))),i=!k||h||d?"":"_unnormalized"+(G+=1),{prefix:k,name:o,parentMap:b,unnormalized:!!i,url:g,originalName:m,isDefine:n,id:(k?k+"!"+o:o)+i}}function h(a){var b=a.id,c=getOwn(y,b);return c||(c=y[b]=new u.Module(a)),c}function i(a,b,c){var d=a.id,e=getOwn(y,d);!hasProp(C,d)||e&&!e.defineEmitComplete?(e=h(a),e.error&&"error"===b?c(e.error):e.on(b,c)):"defined"===b&&c(C[d])}function j(a,b){var c=a.requireModules,d=!1;b?b(a):(each(c,function(b){var c=getOwn(y,b);c&&(c.error=a,c.events.error&&(d=!0,c.emit("error",a)))}),d||req.onError(a))}function k(){globalDefQueue.length&&(apsp.apply(B,[B.length,0].concat(globalDefQueue)),globalDefQueue=[])}function l(a){delete y[a],delete z[a]}function m(a,b,c){var d=a.map.id;a.error?a.emit("error",a.error):(b[d]=!0,each(a.depMaps,function(d,e){var f=d.id,g=getOwn(y,f);!g||a.depMatched[e]||c[f]||(getOwn(b,f)?(a.defineDep(e,C[f]),a.check()):m(g,b,c))}),c[d]=!0)}function n(){var a,b,c=1e3*x.waitSeconds,f=c&&u.startTime+c<(new Date).getTime(),g=[],h=[],i=!1,k=!0;if(!s){if(s=!0,eachProp(z,function(a){var c=a.map,j=c.id;if(a.enabled&&(c.isDefine||h.push(a),!a.error))if(!a.inited&&f)e(j)?(b=!0,i=!0):(g.push(j),d(j));else if(!a.inited&&a.fetched&&c.isDefine&&(i=!0,!c.prefix))return k=!1}),f&&g.length)return a=makeError("timeout","Load timeout for modules: "+g,null,g),a.contextName=u.contextName,j(a);k&&each(h,function(a){m(a,{},{})}),f&&!b||!i||!isBrowser&&!isWebWorker||w||(w=setTimeout(function(){w=0,n()},50)),s=!1}}function o(a){hasProp(C,a[0])||h(g(a[0],null,!0)).init(a[1],a[2])}function p(a,b,c,d){a.detachEvent&&!isOpera?d&&a.detachEvent(d,b):a.removeEventListener(c,b,!1)}function q(a){var b=a.currentTarget||a.srcElement;return p(b,u.onScriptLoad,"load","onreadystatechange"),p(b,u.onScriptError,"error"),{node:b,id:b&&b.getAttribute("data-requiremodule")}}function r(){var a;for(k();B.length;){if(a=B.shift(),null===a[0])return j(makeError("mismatch","Mismatched anonymous define() module: "+a[a.length-1]));o(a)}}var s,t,u,v,w,x={waitSeconds:7,baseUrl:"./",paths:{},bundles:{},pkgs:{},shim:{},config:{}},y={},z={},A={},B=[],C={},D={},E={},F=1,G=1;return v={require:function(a){return a.require?a.require:a.require=u.makeRequire(a.map)},exports:function(a){return a.usingExports=!0,a.map.isDefine?a.exports?C[a.map.id]=a.exports:a.exports=C[a.map.id]={}:void 0},module:function(a){return a.module?a.module:a.module={id:a.map.id,uri:a.map.url,config:function(){return getOwn(x.config,a.map.id)||{}},exports:a.exports||(a.exports={})}}},t=function(a){this.events=getOwn(A,a.id)||{},this.map=a,this.shim=getOwn(x.shim,a.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},t.prototype={init:function(a,b,c,d){d=d||{},this.inited||(this.factory=b,c?this.on("error",c):this.events.error&&(c=bind(this,function(a){this.emit("error",a)})),this.depMaps=a&&a.slice(0),this.errback=c,this.inited=!0,this.ignore=d.ignore,d.enabled||this.enabled?this.enable():this.check())},defineDep:function(a,b){this.depMatched[a]||(this.depMatched[a]=!0,this.depCount-=1,this.depExports[a]=b)},fetch:function(){if(!this.fetched){this.fetched=!0,u.startTime=(new Date).getTime();var a=this.map;return this.shim?void u.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],bind(this,function(){return a.prefix?this.callPlugin():this.load()})):a.prefix?this.callPlugin():this.load()}},load:function(){var a=this.map.url;D[a]||(D[a]=!0,u.load(this.map.id,a))},check:function(){if(this.enabled&&!this.enabling){var a,b,c=this.map.id,d=this.depExports,e=this.exports,f=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,this.depCount<1&&!this.defined){if(isFunction(f)){if(this.events.error&&this.map.isDefine||req.onError!==defaultOnError)try{e=u.execCb(c,f,d,e)}catch(g){a=g}else e=u.execCb(c,f,d,e);if(this.map.isDefine&&void 0===e&&(b=this.module,b?e=b.exports:this.usingExports&&(e=this.exports)),a)return a.requireMap=this.map,a.requireModules=this.map.isDefine?[this.map.id]:null,a.requireType=this.map.isDefine?"define":"require",j(this.error=a)}else e=f;this.exports=e,this.map.isDefine&&!this.ignore&&(C[c]=e,req.onResourceLoad&&req.onResourceLoad(u,this.map,this.depMaps)),l(c),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var a=this.map,b=a.id,d=g(a.prefix);this.depMaps.push(d),i(d,"defined",bind(this,function(d){var e,f,k,m=getOwn(E,this.map.id),n=this.map.name,o=this.map.parentMap?this.map.parentMap.name:null,p=u.makeRequire(a.parentMap,{enableBuildCallback:!0});return this.map.unnormalized?(d.normalize&&(n=d.normalize(n,function(a){return c(a,o,!0)})||""),f=g(a.prefix+"!"+n,this.map.parentMap),i(f,"defined",bind(this,function(a){this.init([],function(){return a},null,{enabled:!0,ignore:!0})})),k=getOwn(y,f.id),void(k&&(this.depMaps.push(f),this.events.error&&k.on("error",bind(this,function(a){this.emit("error",a)})),k.enable()))):m?(this.map.url=u.nameToUrl(m),void this.load()):(e=bind(this,function(a){this.init([],function(){return a},null,{enabled:!0})}),e.error=bind(this,function(a){this.inited=!0,this.error=a,a.requireModules=[b],eachProp(y,function(a){0===a.map.id.indexOf(b+"_unnormalized")&&l(a.map.id)}),j(a)}),e.fromText=bind(this,function(c,d){var f=a.name,i=g(f),k=useInteractive;d&&(c=d),k&&(useInteractive=!1),h(i),hasProp(x.config,b)&&(x.config[f]=x.config[b]);try{req.exec(c)}catch(l){return j(makeError("fromtexteval","fromText eval for "+b+" failed: "+l,l,[b]))}k&&(useInteractive=!0),this.depMaps.push(i),u.completeLoad(f),p([f],e)}),void d.load(a.name,p,e,x))})),u.enable(d,this),this.pluginMaps[d.id]=d},enable:function(){z[this.map.id]=this,this.enabled=!0,this.enabling=!0,each(this.depMaps,bind(this,function(a,b){var c,d,e;if("string"==typeof a){if(a=g(a,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[b]=a,e=getOwn(v,a.id))return void(this.depExports[b]=e(this));this.depCount+=1,i(a,"defined",bind(this,function(a){this.defineDep(b,a),this.check()})),this.errback&&i(a,"error",bind(this,this.errback))}c=a.id,d=y[c],hasProp(v,c)||!d||d.enabled||u.enable(a,this)})),eachProp(this.pluginMaps,bind(this,function(a){var b=getOwn(y,a.id);b&&!b.enabled&&u.enable(a,this)})),this.enabling=!1,this.check()},on:function(a,b){var c=this.events[a];c||(c=this.events[a]=[]),c.push(b)},emit:function(a,b){each(this.events[a],function(a){a(b)}),"error"===a&&delete this.events[a]}},u={config:x,contextName:a,registry:y,defined:C,urlFetched:D,defQueue:B,Module:t,makeModuleMap:g,nextTick:req.nextTick,onError:j,configure:function(a){a.baseUrl&&"/"!==a.baseUrl.charAt(a.baseUrl.length-1)&&(a.baseUrl+="/");var b=x.shim,c={paths:!0,bundles:!0,config:!0,map:!0};eachProp(a,function(a,b){c[b]?(x[b]||(x[b]={}),mixin(x[b],a,!0,!0)):x[b]=a}),a.bundles&&eachProp(a.bundles,function(a,b){each(a,function(a){a!==b&&(E[a]=b)})}),a.shim&&(eachProp(a.shim,function(a,c){isArray(a)&&(a={deps:a}),!a.exports&&!a.init||a.exportsFn||(a.exportsFn=u.makeShimExports(a)),b[c]=a}),x.shim=b),a.packages&&each(a.packages,function(a){var b,c;a="string"==typeof a?{name:a}:a,c=a.name,b=a.location,b&&(x.paths[c]=a.location),x.pkgs[c]=a.name+"/"+(a.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}),eachProp(y,function(a,b){a.inited||a.map.unnormalized||(a.map=g(b))}),(a.deps||a.callback)&&u.require(a.deps||[],a.callback)},makeShimExports:function(a){function b(){var b;return a.init&&(b=a.init.apply(global,arguments)),b||a.exports&&getGlobal(a.exports)}return b},makeRequire:function(b,e){function f(c,d,i){var k,l,m;return e.enableBuildCallback&&d&&isFunction(d)&&(d.__requireJsBuild=!0),"string"==typeof c?isFunction(d)?j(makeError("requireargs","Invalid require call"),i):b&&hasProp(v,c)?v[c](y[b.id]):req.get?req.get(u,c,b,f):(l=g(c,b,!1,!0),k=l.id,hasProp(C,k)?C[k]:j(makeError("notloaded",'Module name "'+k+'" has not been loaded yet for context: '+a+(b?"":". Use require([])")))):(r(),u.nextTick(function(){r(),m=h(g(null,b)),m.skipMap=e.skipMap,m.init(c,d,i,{enabled:!0}),n()}),f)}return e=e||{},mixin(f,{isBrowser:isBrowser,toUrl:function(a){var d,e=a.lastIndexOf("."),f=a.split("/")[0],g="."===f||".."===f;return-1!==e&&(!g||e>1)&&(d=a.substring(e,a.length),a=a.substring(0,e)),u.nameToUrl(c(a,b&&b.id,!0),d,!0)},defined:function(a){return hasProp(C,g(a,b,!1,!0).id)},specified:function(a){return a=g(a,b,!1,!0).id,hasProp(C,a)||hasProp(y,a)}}),b||(f.undef=function(a){k();var c=g(a,b,!0),e=getOwn(y,a);d(a),delete C[a],delete D[c.url],delete A[a],eachReverse(B,function(b,c){b[0]===a&&B.splice(c,1)}),e&&(e.events.defined&&(A[a]=e.events),l(a))}),f},enable:function(a){var b=getOwn(y,a.id);b&&h(a).enable()},completeLoad:function(a){var b,c,d,f=getOwn(x.shim,a)||{},g=f.exports;for(k();B.length;){if(c=B.shift(),null===c[0]){if(c[0]=a,b)break;b=!0}else c[0]===a&&(b=!0);o(c)}if(d=getOwn(y,a),!b&&!hasProp(C,a)&&d&&!d.inited){if(!(!x.enforceDefine||g&&getGlobal(g)))return e(a)?void 0:j(makeError("nodefine","No define call for "+a,null,[a]));o([a,f.deps||[],f.exportsFn])}n()},nameToUrl:function(a,b,c){var d,e,f,g,h,i,j,k=getOwn(x.pkgs,a);if(k&&(a=k),j=getOwn(E,a))return u.nameToUrl(j,b,c);if(req.jsExtRegExp.test(a))h=a+(b||"");else{for(d=x.paths,e=a.split("/"),f=e.length;f>0;f-=1)if(g=e.slice(0,f).join("/"),i=getOwn(d,g)){isArray(i)&&(i=i[0]),e.splice(0,f,i);break}h=e.join("/"),h+=b||(/^data\:|\?/.test(h)||c?"":".js"),h=("/"===h.charAt(0)||h.match(/^[\w\+\.\-]+:/)?"":x.baseUrl)+h}return x.urlArgs?h+((-1===h.indexOf("?")?"?":"&")+x.urlArgs):h},load:function(a,b){req.load(u,a,b)},execCb:function(a,b,c,d){return b.apply(d,c)},onScriptLoad:function(a){if("load"===a.type||readyRegExp.test((a.currentTarget||a.srcElement).readyState)){interactiveScript=null;var b=q(a);u.completeLoad(b.id)}},onScriptError:function(a){var b=q(a);return e(b.id)?void 0:j(makeError("scripterror","Script error for: "+b.id,a,[b.id]))}},u.require=u.makeRequire(),u}function getInteractiveScript(){return interactiveScript&&"interactive"===interactiveScript.readyState?interactiveScript:(eachReverse(scripts(),function(a){return"interactive"===a.readyState?interactiveScript=a:void 0}),interactiveScript)}var req,s,head,baseElement,dataMain,src,interactiveScript,currentlyAddingScript,mainScript,subPath,version="2.1.11",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,cjsRequireRegExp=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,jsSuffixRegExp=/\.js$/,currDirRegExp=/^\.\//,op=Object.prototype,ostring=op.toString,hasOwn=op.hasOwnProperty,ap=Array.prototype,apsp=ap.splice,isBrowser=!("undefined"==typeof window||"undefined"==typeof navigator||!window.document),isWebWorker=!isBrowser&&"undefined"!=typeof importScripts,readyRegExp=isBrowser&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),contexts={},cfg={},globalDefQueue=[],useInteractive=!1;if("undefined"==typeof define){if("undefined"!=typeof requirejs){if(isFunction(requirejs))return;cfg=requirejs,requirejs=void 0}"undefined"==typeof require||isFunction(require)||(cfg=require,require=void 0),req=requirejs=function(a,b,c,d){var e,f,g=defContextName;return isArray(a)||"string"==typeof a||(f=a,isArray(b)?(a=b,b=c,c=d):a=[]),f&&f.context&&(g=f.context),e=getOwn(contexts,g),e||(e=contexts[g]=req.s.newContext(g)),f&&e.configure(f),e.require(a,b,c)},req.config=function(a){return req(a)},req.nextTick="undefined"!=typeof setTimeout?function(a){setTimeout(a,4)}:function(a){a()},require||(require=req),req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,req.isBrowser=isBrowser,s=req.s={contexts:contexts,newContext:newContext},req({}),each(["toUrl","undef","defined","specified"],function(a){req[a]=function(){var b=contexts[defContextName];return b.require[a].apply(b,arguments)}}),isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=defaultOnError,req.createNode=function(a,b,c){var d=a.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return d.type=a.scriptType||"text/javascript",d.charset="utf-8",d.async=!0,d},req.load=function(a,b,c){var d,e=a&&a.config||{};if(isBrowser)return d=req.createNode(e,b,c),d.setAttribute("data-requirecontext",a.contextName),d.setAttribute("data-requiremodule",b),!d.attachEvent||d.attachEvent.toString&&d.attachEvent.toString().indexOf("[native code")<0||isOpera?(d.addEventListener("load",a.onScriptLoad,!1),d.addEventListener("error",a.onScriptError,!1)):(useInteractive=!0,d.attachEvent("onreadystatechange",a.onScriptLoad)),d.src=c,currentlyAddingScript=d,baseElement?head.insertBefore(d,baseElement):head.appendChild(d),currentlyAddingScript=null,d;if(isWebWorker)try{importScripts(c),a.completeLoad(b)}catch(f){a.onError(makeError("importscripts","importScripts failed for "+b+" at "+c,f,[b]))}},isBrowser&&!cfg.skipDataMain&&eachReverse(scripts(),function(a){return head||(head=a.parentNode),dataMain=a.getAttribute("data-main"),dataMain?(mainScript=dataMain,cfg.baseUrl||(src=mainScript.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath),mainScript=mainScript.replace(jsSuffixRegExp,""),req.jsExtRegExp.test(mainScript)&&(mainScript=dataMain),cfg.deps=cfg.deps?cfg.deps.concat(mainScript):[mainScript],!0):void 0}),define=function(a,b,c){var d,e;"string"!=typeof a&&(c=b,b=a,a=null),isArray(b)||(c=b,b=null),!b&&isFunction(c)&&(b=[],c.length&&(c.toString().replace(commentRegExp,"").replace(cjsRequireRegExp,function(a,c){b.push(c)}),b=(1===c.length?["require"]:["require","exports","module"]).concat(b))),useInteractive&&(d=currentlyAddingScript||getInteractiveScript(),d&&(a||(a=d.getAttribute("data-requiremodule")),e=contexts[d.getAttribute("data-requirecontext")])),(e?e.defQueue:globalDefQueue).push([a,b,c])},define.amd={jQuery:!0},req.exec=function(text){return eval(text)},req(cfg)}}(this),function(a,b){"object"==typeof module&&"object"==typeof module.exports?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("jQuery requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:this,function(a,b){function c(a){var b=a.length,c=aa.type(a);return"function"===c||aa.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===c||0===b||"number"==typeof b&&b>0&&b-1 in a}function d(a,b,c){if(aa.isFunction(b))return aa.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return aa.grep(a,function(a){return a===b!==c});if("string"==typeof b){if(ha.test(b))return aa.filter(b,a,c);b=aa.filter(b,a)}return aa.grep(a,function(a){return U.call(b,a)>=0!==c})}function e(a,b){for(;(a=a[b])&&1!==a.nodeType;);return a}function f(a){var b=oa[a]={};return aa.each(a.match(na)||[],function(a,c){b[c]=!0}),b}function g(){$.removeEventListener("DOMContentLoaded",g,!1),a.removeEventListener("load",g,!1),aa.ready()}function h(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=aa.expando+Math.random()}function i(a,b,c){var d;if(void 0===c&&1===a.nodeType)if(d="data-"+b.replace(ua,"-$1").toLowerCase(),c=a.getAttribute(d),"string"==typeof c){try{c="true"===c?!0:"false"===c?!1:"null"===c?null:+c+""===c?+c:ta.test(c)?aa.parseJSON(c):c}catch(e){}sa.set(a,b,c)}else c=void 0;return c}function j(){return!0}function k(){return!1}function l(){try{return $.activeElement}catch(a){}}function m(a,b){return aa.nodeName(a,"table")&&aa.nodeName(11!==b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function n(a){return a.type=(null!==a.getAttribute("type"))+"/"+a.type,a}function o(a){var b=Ka.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function p(a,b){for(var c=0,d=a.length;d>c;c++)ra.set(a[c],"globalEval",!b||ra.get(b[c],"globalEval"))}function q(a,b){var c,d,e,f,g,h,i,j;if(1===b.nodeType){if(ra.hasData(a)&&(f=ra.access(a),g=ra.set(b,f),j=f.events)){delete g.handle,g.events={};for(e in j)for(c=0,d=j[e].length;d>c;c++)aa.event.add(b,e,j[e][c])}sa.hasData(a)&&(h=sa.access(a),i=aa.extend({},h),sa.set(b,i))}}function r(a,b){var c=a.getElementsByTagName?a.getElementsByTagName(b||"*"):a.querySelectorAll?a.querySelectorAll(b||"*"):[];return void 0===b||b&&aa.nodeName(a,b)?aa.merge([a],c):c}function s(a,b){var c=b.nodeName.toLowerCase();"input"===c&&ya.test(a.type)?b.checked=a.checked:"input"!==c&&"textarea"!==c||(b.defaultValue=a.defaultValue)}function t(b,c){var d=aa(c.createElement(b)).appendTo(c.body),e=a.getDefaultComputedStyle?a.getDefaultComputedStyle(d[0]).display:aa.css(d[0],"display");return d.detach(),e}function u(a){var b=$,c=Oa[a];return c||(c=t(a,b),"none"!==c&&c||(Na=(Na||aa("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement),b=Na[0].contentDocument,b.write(),b.close(),c=t(a,b),Na.detach()),Oa[a]=c),c}function v(a,b,c){var d,e,f,g,h=a.style;return c=c||Ra(a),c&&(g=c.getPropertyValue(b)||c[b]),c&&(""!==g||aa.contains(a.ownerDocument,a)||(g=aa.style(a,b)),Qa.test(g)&&Pa.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f)),void 0!==g?g+"":g}function w(a,b){return{get:function(){return a()?void delete this.get:(this.get=b).apply(this,arguments)}}}function x(a,b){if(b in a)return b;for(var c=b[0].toUpperCase()+b.slice(1),d=b,e=Xa.length;e--;)if(b=Xa[e]+c,b in a)return b;return d}function y(a,b,c){var d=Ta.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||"px"):b}function z(a,b,c,d,e){for(var f=c===(d?"border":"content")?4:"width"===b?1:0,g=0;4>f;f+=2)"margin"===c&&(g+=aa.css(a,c+wa[f],!0,e)),d?("content"===c&&(g-=aa.css(a,"padding"+wa[f],!0,e)),"margin"!==c&&(g-=aa.css(a,"border"+wa[f]+"Width",!0,e))):(g+=aa.css(a,"padding"+wa[f],!0,e),"padding"!==c&&(g+=aa.css(a,"border"+wa[f]+"Width",!0,e)));return g}function A(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=Ra(a),g="border-box"===aa.css(a,"boxSizing",!1,f);if(0>=e||null==e){if(e=v(a,b,f),(0>e||null==e)&&(e=a.style[b]),Qa.test(e))return e;d=g&&(Z.boxSizingReliable()||e===a.style[b]),e=parseFloat(e)||0}return e+z(a,b,c||(g?"border":"content"),d,f)+"px"}function B(a,b){for(var c,d,e,f=[],g=0,h=a.length;h>g;g++)d=a[g],d.style&&(f[g]=ra.get(d,"olddisplay"),c=d.style.display,b?(f[g]||"none"!==c||(d.style.display=""),""===d.style.display&&xa(d)&&(f[g]=ra.access(d,"olddisplay",u(d.nodeName)))):f[g]||(e=xa(d),(c&&"none"!==c||!e)&&ra.set(d,"olddisplay",e?c:aa.css(d,"display"))));for(g=0;h>g;g++)d=a[g],d.style&&(b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none"));return a}function C(a,b,c,d,e){return new C.prototype.init(a,b,c,d,e)}function D(){return setTimeout(function(){Ya=void 0}),Ya=aa.now()}function E(a,b){var c,d=0,e={height:a};for(b=b?1:0;4>d;d+=2-b)c=wa[d],e["margin"+c]=e["padding"+c]=a;return b&&(e.opacity=e.width=a),e}function F(a,b,c){for(var d,e=(cb[b]||[]).concat(cb["*"]),f=0,g=e.length;g>f;f++)if(d=e[f].call(c,b,a))return d}function G(a,b,c){var d,e,f,g,h,i,j,k=this,l={},m=a.style,n=a.nodeType&&xa(a),o=ra.get(a,"fxshow");c.queue||(h=aa._queueHooks(a,"fx"),null==h.unqueued&&(h.unqueued=0,i=h.empty.fire,h.empty.fire=function(){h.unqueued||i()}),h.unqueued++,k.always(function(){k.always(function(){h.unqueued--,aa.queue(a,"fx").length||h.empty.fire()})})),1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[m.overflow,m.overflowX,m.overflowY],j=aa.css(a,"display"),"none"===j&&(j=u(a.nodeName)),"inline"===j&&"none"===aa.css(a,"float")&&(m.display="inline-block")),c.overflow&&(m.overflow="hidden",k.always(function(){m.overflow=c.overflow[0],m.overflowX=c.overflow[1],m.overflowY=c.overflow[2]}));for(d in b)if(e=b[d],$a.exec(e)){if(delete b[d],f=f||"toggle"===e,e===(n?"hide":"show")){if("show"!==e||!o||void 0===o[d])continue;n=!0}l[d]=o&&o[d]||aa.style(a,d)}if(!aa.isEmptyObject(l)){o?"hidden"in o&&(n=o.hidden):o=ra.access(a,"fxshow",{}),f&&(o.hidden=!n),n?aa(a).show():k.done(function(){aa(a).hide()}),k.done(function(){var b;ra.remove(a,"fxshow");for(b in l)aa.style(a,b,l[b])});for(d in l)g=F(n?o[d]:0,d,k),d in o||(o[d]=g.start,n&&(g.end=g.start,g.start="width"===d||"height"===d?1:0))}}function H(a,b){var c,d,e,f,g;for(c in a)if(d=aa.camelCase(c),e=b[d],f=a[c],aa.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=aa.cssHooks[d],g&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function I(a,b,c){var d,e,f=0,g=bb.length,h=aa.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=Ya||D(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;i>g;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),1>f&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:aa.extend({},b),opts:aa.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:Ya||D(),duration:c.duration,tweens:[],createTween:function(b,c){var d=aa.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;d>c;c++)j.tweens[c].run(1);return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this}}),k=j.props;for(H(k,j.opts.specialEasing);g>f;f++)if(d=bb[f].call(j,a,k,j.opts))return d;return aa.map(k,F,j),aa.isFunction(j.opts.start)&&j.opts.start.call(a,j),aa.fx.timer(aa.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}function J(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(na)||[];if(aa.isFunction(c))for(;d=f[e++];)"+"===d[0]?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function K(a,b,c,d){function e(h){var i;return f[h]=!0,aa.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||g||f[j]?g?!(i=j):void 0:(b.dataTypes.unshift(j),e(j),!1)}),i}var f={},g=a===vb;return e(b.dataTypes[0])||!f["*"]&&e("*")}function L(a,b){var c,d,e=aa.ajaxSettings.flatOptions||{};for(c in b)void 0!==b[c]&&((e[c]?a:d||(d={}))[c]=b[c]);return d&&aa.extend(!0,a,d),a}function M(a,b,c){for(var d,e,f,g,h=a.contents,i=a.dataTypes;"*"===i[0];)i.shift(),void 0===d&&(d=a.mimeType||b.getResponseHeader("Content-Type"));if(d)for(e in h)if(h[e]&&h[e].test(d)){i.unshift(e);break}if(i[0]in c)f=i[0];else{for(e in c){if(!i[0]||a.converters[e+" "+i[0]]){f=e;break}g||(g=e)}f=f||g}return f?(f!==i[0]&&i.unshift(f),c[f]):void 0}function N(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];for(f=k.shift();f;)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(g=j[i+" "+f]||j["* "+f],!g)for(e in j)if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){g===!0?g=j[e]:j[e]!==!0&&(f=h[0],k.unshift(h[1]));break}if(g!==!0)if(g&&a["throws"])b=g(b);else try{b=g(b)}catch(l){return{state:"parsererror",error:g?l:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}function O(a,b,c,d){var e;if(aa.isArray(b))aa.each(b,function(b,e){c||zb.test(a)?d(a,e):O(a+"["+("object"==typeof e?b:"")+"]",e,c,d)});else if(c||"object"!==aa.type(b))d(a,b);else for(e in b)O(a+"["+e+"]",b[e],c,d)}function P(a){return aa.isWindow(a)?a:9===a.nodeType&&a.defaultView}var Q=[],R=Q.slice,S=Q.concat,T=Q.push,U=Q.indexOf,V={},W=V.toString,X=V.hasOwnProperty,Y="".trim,Z={},$=a.document,_="2.1.0",aa=function(a,b){return new aa.fn.init(a,b)},ba=/^-ms-/,ca=/-([\da-z])/gi,da=function(a,b){return b.toUpperCase()};aa.fn=aa.prototype={jquery:_,constructor:aa,selector:"",length:0,toArray:function(){return R.call(this)},get:function(a){return null!=a?0>a?this[a+this.length]:this[a]:R.call(this)},pushStack:function(a){var b=aa.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b},each:function(a,b){return aa.each(this,a,b)},map:function(a){return this.pushStack(aa.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(R.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(0>a?b:0);return this.pushStack(c>=0&&b>c?[this[c]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:T,sort:Q.sort,splice:Q.splice},aa.extend=aa.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==typeof g||aa.isFunction(g)||(g={}),h===i&&(g=this,h--);i>h;h++)if(null!=(a=arguments[h]))for(b in a)c=g[b],d=a[b],g!==d&&(j&&d&&(aa.isPlainObject(d)||(e=aa.isArray(d)))?(e?(e=!1,f=c&&aa.isArray(c)?c:[]):f=c&&aa.isPlainObject(c)?c:{},g[b]=aa.extend(j,f,d)):void 0!==d&&(g[b]=d));return g},aa.extend({expando:"jQuery"+(_+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return"function"===aa.type(a)},isArray:Array.isArray,isWindow:function(a){return null!=a&&a===a.window},isNumeric:function(a){return a-parseFloat(a)>=0},isPlainObject:function(a){if("object"!==aa.type(a)||a.nodeType||aa.isWindow(a))return!1;try{if(a.constructor&&!X.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(b){return!1}return!0},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?V[W.call(a)]||"object":typeof a},globalEval:function(a){var b,c=eval;a=aa.trim(a),a&&(1===a.indexOf("use strict")?(b=$.createElement("script"),b.text=a,$.head.appendChild(b).parentNode.removeChild(b)):c(a))},camelCase:function(a){return a.replace(ba,"ms-").replace(ca,da)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b,d){var e,f=0,g=a.length,h=c(a);if(d){if(h)for(;g>f&&(e=b.apply(a[f],d),e!==!1);f++);else for(f in a)if(e=b.apply(a[f],d),e===!1)break}else if(h)for(;g>f&&(e=b.call(a[f],f,a[f]),e!==!1);f++);else for(f in a)if(e=b.call(a[f],f,a[f]),e===!1)break;return a},trim:function(a){return null==a?"":Y.call(a)},makeArray:function(a,b){var d=b||[];return null!=a&&(c(Object(a))?aa.merge(d,"string"==typeof a?[a]:a):T.call(d,a)),d},inArray:function(a,b,c){return null==b?-1:U.call(b,a,c)},merge:function(a,b){for(var c=+b.length,d=0,e=a.length;c>d;d++)a[e++]=b[d];return a.length=e,a},grep:function(a,b,c){for(var d,e=[],f=0,g=a.length,h=!c;g>f;f++)d=!b(a[f],f),d!==h&&e.push(a[f]);return e},map:function(a,b,d){var e,f=0,g=a.length,h=c(a),i=[];if(h)for(;g>f;f++)e=b(a[f],f,d),null!=e&&i.push(e);else for(f in a)e=b(a[f],f,d),null!=e&&i.push(e);return S.apply([],i)},guid:1,proxy:function(a,b){var c,d,e;
return"string"==typeof b&&(c=a[b],b=a,a=c),aa.isFunction(a)?(d=R.call(arguments,2),e=function(){return a.apply(b||this,d.concat(R.call(arguments)))},e.guid=a.guid=a.guid||aa.guid++,e):void 0},now:Date.now,support:Z}),aa.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){V["[object "+b+"]"]=b.toLowerCase()});var ea=function(a){function b(a,b,c,d){var e,f,g,h,i,j,l,o,p,q;if((b?b.ownerDocument||b:O)!==G&&F(b),b=b||G,c=c||[],!a||"string"!=typeof a)return c;if(1!==(h=b.nodeType)&&9!==h)return[];if(I&&!d){if(e=sa.exec(a))if(g=e[1]){if(9===h){if(f=b.getElementById(g),!f||!f.parentNode)return c;if(f.id===g)return c.push(f),c}else if(b.ownerDocument&&(f=b.ownerDocument.getElementById(g))&&M(b,f)&&f.id===g)return c.push(f),c}else{if(e[2])return _.apply(c,b.getElementsByTagName(a)),c;if((g=e[3])&&x.getElementsByClassName&&b.getElementsByClassName)return _.apply(c,b.getElementsByClassName(g)),c}if(x.qsa&&(!J||!J.test(a))){if(o=l=N,p=b,q=9===h&&a,1===h&&"object"!==b.nodeName.toLowerCase()){for(j=m(a),(l=b.getAttribute("id"))?o=l.replace(ua,"\\$&"):b.setAttribute("id",o),o="[id='"+o+"'] ",i=j.length;i--;)j[i]=o+n(j[i]);p=ta.test(a)&&k(b.parentNode)||b,q=j.join(",")}if(q)try{return _.apply(c,p.querySelectorAll(q)),c}catch(r){}finally{l||b.removeAttribute("id")}}}return v(a.replace(ia,"$1"),b,c,d)}function c(){function a(c,d){return b.push(c+" ")>y.cacheLength&&delete a[b.shift()],a[c+" "]=d}var b=[];return a}function d(a){return a[N]=!0,a}function e(a){var b=G.createElement("div");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function f(a,b){for(var c=a.split("|"),d=a.length;d--;)y.attrHandle[c[d]]=b}function g(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||W)-(~a.sourceIndex||W);if(d)return d;if(c)for(;c=c.nextSibling;)if(c===b)return-1;return a?1:-1}function h(a){return function(b){var c=b.nodeName.toLowerCase();return"input"===c&&b.type===a}}function i(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function j(a){return d(function(b){return b=+b,d(function(c,d){for(var e,f=a([],c.length,b),g=f.length;g--;)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function k(a){return a&&typeof a.getElementsByTagName!==V&&a}function l(){}function m(a,c){var d,e,f,g,h,i,j,k=S[a+" "];if(k)return c?0:k.slice(0);for(h=a,i=[],j=y.preFilter;h;){d&&!(e=ja.exec(h))||(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),d=!1,(e=ka.exec(h))&&(d=e.shift(),f.push({value:d,type:e[0].replace(ia," ")}),h=h.slice(d.length));for(g in y.filter)!(e=oa[g].exec(h))||j[g]&&!(e=j[g](e))||(d=e.shift(),f.push({value:d,type:g,matches:e}),h=h.slice(d.length));if(!d)break}return c?h.length:h?b.error(a):S(a,i).slice(0)}function n(a){for(var b=0,c=a.length,d="";c>b;b++)d+=a[b].value;return d}function o(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=Q++;return b.first?function(b,c,f){for(;b=b[d];)if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j=[P,f];if(g){for(;b=b[d];)if((1===b.nodeType||e)&&a(b,c,g))return!0}else for(;b=b[d];)if(1===b.nodeType||e){if(i=b[N]||(b[N]={}),(h=i[d])&&h[0]===P&&h[1]===f)return j[2]=h[2];if(i[d]=j,j[2]=a(b,c,g))return!0}}}function p(a){return a.length>1?function(b,c,d){for(var e=a.length;e--;)if(!a[e](b,c,d))return!1;return!0}:a[0]}function q(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;i>h;h++)(f=a[h])&&(c&&!c(f,d,e)||(g.push(f),j&&b.push(h)));return g}function r(a,b,c,e,f,g){return e&&!e[N]&&(e=r(e)),f&&!f[N]&&(f=r(f,g)),d(function(d,g,h,i){var j,k,l,m=[],n=[],o=g.length,p=d||u(b||"*",h.nodeType?[h]:h,[]),r=!a||!d&&b?p:q(p,m,a,h,i),s=c?f||(d?a:o||e)?[]:g:r;if(c&&c(r,s,h,i),e)for(j=q(s,n),e(j,[],h,i),k=j.length;k--;)(l=j[k])&&(s[n[k]]=!(r[n[k]]=l));if(d){if(f||a){if(f){for(j=[],k=s.length;k--;)(l=s[k])&&j.push(r[k]=l);f(null,s=[],j,i)}for(k=s.length;k--;)(l=s[k])&&(j=f?ba.call(d,l):m[k])>-1&&(d[j]=!(g[j]=l))}}else s=q(s===g?s.splice(o,s.length):s),f?f(null,g,s,i):_.apply(g,s)})}function s(a){for(var b,c,d,e=a.length,f=y.relative[a[0].type],g=f||y.relative[" "],h=f?1:0,i=o(function(a){return a===b},g,!0),j=o(function(a){return ba.call(b,a)>-1},g,!0),k=[function(a,c,d){return!f&&(d||c!==C)||((b=c).nodeType?i(a,c,d):j(a,c,d))}];e>h;h++)if(c=y.relative[a[h].type])k=[o(p(k),c)];else{if(c=y.filter[a[h].type].apply(null,a[h].matches),c[N]){for(d=++h;e>d&&!y.relative[a[d].type];d++);return r(h>1&&p(k),h>1&&n(a.slice(0,h-1).concat({value:" "===a[h-2].type?"*":""})).replace(ia,"$1"),c,d>h&&s(a.slice(h,d)),e>d&&s(a=a.slice(d)),e>d&&n(a))}k.push(c)}return p(k)}function t(a,c){var e=c.length>0,f=a.length>0,g=function(d,g,h,i,j){var k,l,m,n=0,o="0",p=d&&[],r=[],s=C,t=d||f&&y.find.TAG("*",j),u=P+=null==s?1:Math.random()||.1,v=t.length;for(j&&(C=g!==G&&g);o!==v&&null!=(k=t[o]);o++){if(f&&k){for(l=0;m=a[l++];)if(m(k,g,h)){i.push(k);break}j&&(P=u)}e&&((k=!m&&k)&&n--,d&&p.push(k))}if(n+=o,e&&o!==n){for(l=0;m=c[l++];)m(p,r,g,h);if(d){if(n>0)for(;o--;)p[o]||r[o]||(r[o]=Z.call(i));r=q(r)}_.apply(i,r),j&&!d&&r.length>0&&n+c.length>1&&b.uniqueSort(i)}return j&&(P=u,C=s),p};return e?d(g):g}function u(a,c,d){for(var e=0,f=c.length;f>e;e++)b(a,c[e],d);return d}function v(a,b,c,d){var e,f,g,h,i,j=m(a);if(!d&&1===j.length){if(f=j[0]=j[0].slice(0),f.length>2&&"ID"===(g=f[0]).type&&x.getById&&9===b.nodeType&&I&&y.relative[f[1].type]){if(b=(y.find.ID(g.matches[0].replace(va,wa),b)||[])[0],!b)return c;a=a.slice(f.shift().value.length)}for(e=oa.needsContext.test(a)?0:f.length;e--&&(g=f[e],!y.relative[h=g.type]);)if((i=y.find[h])&&(d=i(g.matches[0].replace(va,wa),ta.test(f[0].type)&&k(b.parentNode)||b))){if(f.splice(e,1),a=d.length&&n(f),!a)return _.apply(c,d),c;break}}return B(a,j)(d,b,!I,c,ta.test(a)&&k(b.parentNode)||b),c}var w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N="sizzle"+-new Date,O=a.document,P=0,Q=0,R=c(),S=c(),T=c(),U=function(a,b){return a===b&&(E=!0),0},V="undefined",W=1<<31,X={}.hasOwnProperty,Y=[],Z=Y.pop,$=Y.push,_=Y.push,aa=Y.slice,ba=Y.indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(this[b]===a)return b;return-1},ca="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",da="[\\x20\\t\\r\\n\\f]",ea="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",fa=ea.replace("w","w#"),ga="\\["+da+"*("+ea+")"+da+"*(?:([*^$|!~]?=)"+da+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+fa+")|)|)"+da+"*\\]",ha=":("+ea+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+ga.replace(3,8)+")*)|.*)\\)|)",ia=new RegExp("^"+da+"+|((?:^|[^\\\\])(?:\\\\.)*)"+da+"+$","g"),ja=new RegExp("^"+da+"*,"+da+"*"),ka=new RegExp("^"+da+"*([>+~]|"+da+")"+da+"*"),la=new RegExp("="+da+"*([^\\]'\"]*?)"+da+"*\\]","g"),ma=new RegExp(ha),na=new RegExp("^"+fa+"$"),oa={ID:new RegExp("^#("+ea+")"),CLASS:new RegExp("^\\.("+ea+")"),TAG:new RegExp("^("+ea.replace("w","w*")+")"),ATTR:new RegExp("^"+ga),PSEUDO:new RegExp("^"+ha),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+da+"*(even|odd|(([+-]|)(\\d*)n|)"+da+"*(?:([+-]|)"+da+"*(\\d+)|))"+da+"*\\)|)","i"),bool:new RegExp("^(?:"+ca+")$","i"),needsContext:new RegExp("^"+da+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+da+"*((?:-\\d)?\\d*)"+da+"*\\)|)(?=[^-]|$)","i")},pa=/^(?:input|select|textarea|button)$/i,qa=/^h\d$/i,ra=/^[^{]+\{\s*\[native \w/,sa=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ta=/[+~]/,ua=/'|\\/g,va=new RegExp("\\\\([\\da-f]{1,6}"+da+"?|("+da+")|.)","ig"),wa=function(a,b,c){var d="0x"+b-65536;return d!==d||c?b:0>d?String.fromCharCode(d+65536):String.fromCharCode(d>>10|55296,1023&d|56320)};try{_.apply(Y=aa.call(O.childNodes),O.childNodes),Y[O.childNodes.length].nodeType}catch(xa){_={apply:Y.length?function(a,b){$.apply(a,aa.call(b))}:function(a,b){for(var c=a.length,d=0;a[c++]=b[d++];);a.length=c-1}}}x=b.support={},A=b.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return b?"HTML"!==b.nodeName:!1},F=b.setDocument=function(a){var b,c=a?a.ownerDocument||a:O,d=c.defaultView;return c!==G&&9===c.nodeType&&c.documentElement?(G=c,H=c.documentElement,I=!A(c),d&&d!==d.top&&(d.addEventListener?d.addEventListener("unload",function(){F()},!1):d.attachEvent&&d.attachEvent("onunload",function(){F()})),x.attributes=e(function(a){return a.className="i",!a.getAttribute("className")}),x.getElementsByTagName=e(function(a){return a.appendChild(c.createComment("")),!a.getElementsByTagName("*").length}),x.getElementsByClassName=ra.test(c.getElementsByClassName)&&e(function(a){return a.innerHTML="<div class='a'></div><div class='a i'></div>",a.firstChild.className="i",2===a.getElementsByClassName("i").length}),x.getById=e(function(a){return H.appendChild(a).id=N,!c.getElementsByName||!c.getElementsByName(N).length}),x.getById?(y.find.ID=function(a,b){if(typeof b.getElementById!==V&&I){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},y.filter.ID=function(a){var b=a.replace(va,wa);return function(a){return a.getAttribute("id")===b}}):(delete y.find.ID,y.filter.ID=function(a){var b=a.replace(va,wa);return function(a){var c=typeof a.getAttributeNode!==V&&a.getAttributeNode("id");return c&&c.value===b}}),y.find.TAG=x.getElementsByTagName?function(a,b){return typeof b.getElementsByTagName!==V?b.getElementsByTagName(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){for(;c=f[e++];)1===c.nodeType&&d.push(c);return d}return f},y.find.CLASS=x.getElementsByClassName&&function(a,b){return typeof b.getElementsByClassName!==V&&I?b.getElementsByClassName(a):void 0},K=[],J=[],(x.qsa=ra.test(c.querySelectorAll))&&(e(function(a){a.innerHTML="<select t=''><option selected=''></option></select>",a.querySelectorAll("[t^='']").length&&J.push("[*^$]="+da+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||J.push("\\["+da+"*(?:value|"+ca+")"),a.querySelectorAll(":checked").length||J.push(":checked")}),e(function(a){var b=c.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&J.push("name"+da+"*[*^$|!~]?="),a.querySelectorAll(":enabled").length||J.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),J.push(",.*:")})),(x.matchesSelector=ra.test(L=H.webkitMatchesSelector||H.mozMatchesSelector||H.oMatchesSelector||H.msMatchesSelector))&&e(function(a){x.disconnectedMatch=L.call(a,"div"),L.call(a,"[s!='']:x"),K.push("!=",ha)}),J=J.length&&new RegExp(J.join("|")),K=K.length&&new RegExp(K.join("|")),b=ra.test(H.compareDocumentPosition),M=b||ra.test(H.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},U=b?function(a,b){if(a===b)return E=!0,0;var d=!a.compareDocumentPosition-!b.compareDocumentPosition;return d?d:(d=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1,1&d||!x.sortDetached&&b.compareDocumentPosition(a)===d?a===c||a.ownerDocument===O&&M(O,a)?-1:b===c||b.ownerDocument===O&&M(O,b)?1:D?ba.call(D,a)-ba.call(D,b):0:4&d?-1:1)}:function(a,b){if(a===b)return E=!0,0;var d,e=0,f=a.parentNode,h=b.parentNode,i=[a],j=[b];if(!f||!h)return a===c?-1:b===c?1:f?-1:h?1:D?ba.call(D,a)-ba.call(D,b):0;if(f===h)return g(a,b);for(d=a;d=d.parentNode;)i.unshift(d);for(d=b;d=d.parentNode;)j.unshift(d);for(;i[e]===j[e];)e++;return e?g(i[e],j[e]):i[e]===O?-1:j[e]===O?1:0},c):G},b.matches=function(a,c){return b(a,null,null,c)},b.matchesSelector=function(a,c){if((a.ownerDocument||a)!==G&&F(a),c=c.replace(la,"='$1']"),x.matchesSelector&&I&&(!K||!K.test(c))&&(!J||!J.test(c)))try{var d=L.call(a,c);if(d||x.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(e){}return b(c,G,null,[a]).length>0},b.contains=function(a,b){return(a.ownerDocument||a)!==G&&F(a),M(a,b)},b.attr=function(a,b){(a.ownerDocument||a)!==G&&F(a);var c=y.attrHandle[b.toLowerCase()],d=c&&X.call(y.attrHandle,b.toLowerCase())?c(a,b,!I):void 0;return void 0!==d?d:x.attributes||!I?a.getAttribute(b):(d=a.getAttributeNode(b))&&d.specified?d.value:null},b.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},b.uniqueSort=function(a){var b,c=[],d=0,e=0;if(E=!x.detectDuplicates,D=!x.sortStable&&a.slice(0),a.sort(U),E){for(;b=a[e++];)b===a[e]&&(d=c.push(e));for(;d--;)a.splice(c[d],1)}return D=null,a},z=b.getText=function(a){var b,c="",d=0,e=a.nodeType;if(e){if(1===e||9===e||11===e){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=z(a)}else if(3===e||4===e)return a.nodeValue}else for(;b=a[d++];)c+=z(b);return c},y=b.selectors={cacheLength:50,createPseudo:d,match:oa,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(va,wa),a[3]=(a[4]||a[5]||"").replace(va,wa),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||b.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&b.error(a[0]),a},PSEUDO:function(a){var b,c=!a[5]&&a[2];return oa.CHILD.test(a[0])?null:(a[3]&&void 0!==a[4]?a[2]=a[4]:c&&ma.test(c)&&(b=m(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(va,wa).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=R[a+" "];return b||(b=new RegExp("(^|"+da+")"+a+"("+da+"|$)"))&&R(a,function(a){return b.test("string"==typeof a.className&&a.className||typeof a.getAttribute!==V&&a.getAttribute("class")||"")})},ATTR:function(a,c,d){return function(e){var f=b.attr(e,a);return null==f?"!="===c:c?(f+="","="===c?f===d:"!="===c?f!==d:"^="===c?d&&0===f.indexOf(d):"*="===c?d&&f.indexOf(d)>-1:"$="===c?d&&f.slice(-d.length)===d:"~="===c?(" "+f+" ").indexOf(d)>-1:"|="===c?f===d||f.slice(0,d.length+1)===d+"-":!1):!0}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h;if(q){if(f){for(;p;){for(l=b;l=l[p];)if(h?l.nodeName.toLowerCase()===r:1===l.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){for(k=q[N]||(q[N]={}),j=k[a]||[],n=j[0]===P&&j[1],m=j[0]===P&&j[2],l=n&&q.childNodes[n];l=++n&&l&&l[p]||(m=n=0)||o.pop();)if(1===l.nodeType&&++m&&l===b){k[a]=[P,n,m];break}}else if(s&&(j=(b[N]||(b[N]={}))[a])&&j[0]===P)m=j[1];else for(;(l=++n&&l&&l[p]||(m=n=0)||o.pop())&&((h?l.nodeName.toLowerCase()!==r:1!==l.nodeType)||!++m||(s&&((l[N]||(l[N]={}))[a]=[P,m]),l!==b)););return m-=e,m===d||m%d===0&&m/d>=0}}},PSEUDO:function(a,c){var e,f=y.pseudos[a]||y.setFilters[a.toLowerCase()]||b.error("unsupported pseudo: "+a);return f[N]?f(c):f.length>1?(e=[a,a,"",c],y.setFilters.hasOwnProperty(a.toLowerCase())?d(function(a,b){for(var d,e=f(a,c),g=e.length;g--;)d=ba.call(a,e[g]),a[d]=!(b[d]=e[g])}):function(a){return f(a,0,e)}):f}},pseudos:{not:d(function(a){var b=[],c=[],e=B(a.replace(ia,"$1"));return e[N]?d(function(a,b,c,d){for(var f,g=e(a,null,d,[]),h=a.length;h--;)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,d,f){return b[0]=a,e(b,null,f,c),!c.pop()}}),has:d(function(a){return function(c){return b(a,c).length>0}}),contains:d(function(a){return function(b){return(b.textContent||b.innerText||z(b)).indexOf(a)>-1}}),lang:d(function(a){return na.test(a||"")||b.error("unsupported lang: "+a),a=a.replace(va,wa).toLowerCase(),function(b){var c;do if(c=I?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===H},focus:function(a){return a===G.activeElement&&(!G.hasFocus||G.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return a.disabled===!1},disabled:function(a){return a.disabled===!0},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!y.pseudos.empty(a)},header:function(a){return qa.test(a.nodeName)},input:function(a){return pa.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:j(function(){return[0]}),last:j(function(a,b){return[b-1]}),eq:j(function(a,b,c){return[0>c?c+b:c]}),even:j(function(a,b){for(var c=0;b>c;c+=2)a.push(c);return a}),odd:j(function(a,b){for(var c=1;b>c;c+=2)a.push(c);return a}),lt:j(function(a,b,c){for(var d=0>c?c+b:c;--d>=0;)a.push(d);return a}),gt:j(function(a,b,c){for(var d=0>c?c+b:c;++d<b;)a.push(d);return a})}},y.pseudos.nth=y.pseudos.eq;for(w in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})y.pseudos[w]=h(w);for(w in{submit:!0,reset:!0})y.pseudos[w]=i(w);return l.prototype=y.filters=y.pseudos,y.setFilters=new l,B=b.compile=function(a,b){var c,d=[],e=[],f=T[a+" "];if(!f){for(b||(b=m(a)),c=b.length;c--;)f=s(b[c]),f[N]?d.push(f):e.push(f);f=T(a,t(e,d))}return f},x.sortStable=N.split("").sort(U).join("")===N,x.detectDuplicates=!!E,F(),x.sortDetached=e(function(a){return 1&a.compareDocumentPosition(G.createElement("div"))}),e(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||f("type|href|height|width",function(a,b,c){return c?void 0:a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),x.attributes&&e(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")})||f("value",function(a,b,c){return c||"input"!==a.nodeName.toLowerCase()?void 0:a.defaultValue}),e(function(a){return null==a.getAttribute("disabled")})||f(ca,function(a,b,c){var d;return c?void 0:a[b]===!0?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),b}(a);aa.find=ea,aa.expr=ea.selectors,aa.expr[":"]=aa.expr.pseudos,aa.unique=ea.uniqueSort,aa.text=ea.getText,aa.isXMLDoc=ea.isXML,aa.contains=ea.contains;var fa=aa.expr.match.needsContext,ga=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,ha=/^.[^:#\[\.,]*$/;aa.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?aa.find.matchesSelector(d,a)?[d]:[]:aa.find.matches(a,aa.grep(b,function(a){return 1===a.nodeType}))},aa.fn.extend({find:function(a){var b,c=this.length,d=[],e=this;if("string"!=typeof a)return this.pushStack(aa(a).filter(function(){for(b=0;c>b;b++)if(aa.contains(e[b],this))return!0}));for(b=0;c>b;b++)aa.find(a,e[b],d);return d=this.pushStack(c>1?aa.unique(d):d),d.selector=this.selector?this.selector+" "+a:a,d},filter:function(a){return this.pushStack(d(this,a||[],!1))},not:function(a){return this.pushStack(d(this,a||[],!0))},is:function(a){return!!d(this,"string"==typeof a&&fa.test(a)?aa(a):a||[],!1).length}});var ia,ja=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,ka=aa.fn.init=function(a,b){var c,d;if(!a)return this;if("string"==typeof a){if(c="<"===a[0]&&">"===a[a.length-1]&&a.length>=3?[null,a,null]:ja.exec(a),!c||!c[1]&&b)return!b||b.jquery?(b||ia).find(a):this.constructor(b).find(a);if(c[1]){if(b=b instanceof aa?b[0]:b,aa.merge(this,aa.parseHTML(c[1],b&&b.nodeType?b.ownerDocument||b:$,!0)),ga.test(c[1])&&aa.isPlainObject(b))for(c in b)aa.isFunction(this[c])?this[c](b[c]):this.attr(c,b[c]);return this}return d=$.getElementById(c[2]),d&&d.parentNode&&(this.length=1,this[0]=d),this.context=$,this.selector=a,this}return a.nodeType?(this.context=this[0]=a,this.length=1,this):aa.isFunction(a)?"undefined"!=typeof ia.ready?ia.ready(a):a(aa):(void 0!==a.selector&&(this.selector=a.selector,this.context=a.context),aa.makeArray(a,this))};ka.prototype=aa.fn,ia=aa($);var la=/^(?:parents|prev(?:Until|All))/,ma={children:!0,contents:!0,next:!0,prev:!0};aa.extend({dir:function(a,b,c){for(var d=[],e=void 0!==c;(a=a[b])&&9!==a.nodeType;)if(1===a.nodeType){if(e&&aa(a).is(c))break;d.push(a)}return d},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}}),aa.fn.extend({has:function(a){var b=aa(a,this),c=b.length;return this.filter(function(){for(var a=0;c>a;a++)if(aa.contains(this,b[a]))return!0})},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=fa.test(a)||"string"!=typeof a?aa(a,b||this.context):0;e>d;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?g.index(c)>-1:1===c.nodeType&&aa.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(f.length>1?aa.unique(f):f)},index:function(a){return a?"string"==typeof a?U.call(aa(a),this[0]):U.call(this,a.jquery?a[0]:a):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(aa.unique(aa.merge(this.get(),aa(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}}),aa.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return aa.dir(a,"parentNode")},parentsUntil:function(a,b,c){return aa.dir(a,"parentNode",c)},next:function(a){return e(a,"nextSibling")},prev:function(a){return e(a,"previousSibling")},nextAll:function(a){return aa.dir(a,"nextSibling")},prevAll:function(a){return aa.dir(a,"previousSibling")},nextUntil:function(a,b,c){return aa.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return aa.dir(a,"previousSibling",c)},siblings:function(a){return aa.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return aa.sibling(a.firstChild)},contents:function(a){return a.contentDocument||aa.merge([],a.childNodes)}},function(a,b){aa.fn[a]=function(c,d){var e=aa.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=aa.filter(d,e)),this.length>1&&(ma[a]||aa.unique(e),la.test(a)&&e.reverse()),this.pushStack(e)}});var na=/\S+/g,oa={};aa.Callbacks=function(a){a="string"==typeof a?oa[a]||f(a):aa.extend({},a);var b,c,d,e,g,h,i=[],j=!a.once&&[],k=function(f){for(b=a.memory&&f,c=!0,h=e||0,e=0,g=i.length,d=!0;i&&g>h;h++)if(i[h].apply(f[0],f[1])===!1&&a.stopOnFalse){b=!1;break}d=!1,i&&(j?j.length&&k(j.shift()):b?i=[]:l.disable())},l={add:function(){if(i){var c=i.length;!function f(b){aa.each(b,function(b,c){var d=aa.type(c);"function"===d?a.unique&&l.has(c)||i.push(c):c&&c.length&&"string"!==d&&f(c)})}(arguments),d?g=i.length:b&&(e=c,k(b))}return this},remove:function(){return i&&aa.each(arguments,function(a,b){for(var c;(c=aa.inArray(b,i,c))>-1;)i.splice(c,1),d&&(g>=c&&g--,h>=c&&h--)}),this},has:function(a){return a?aa.inArray(a,i)>-1:!(!i||!i.length)},empty:function(){return i=[],g=0,this},disable:function(){return i=j=b=void 0,this},disabled:function(){return!i},lock:function(){return j=void 0,b||l.disable(),this},locked:function(){return!j},fireWith:function(a,b){return!i||c&&!j||(b=b||[],b=[a,b.slice?b.slice():b],d?j.push(b):k(b)),this},fire:function(){return l.fireWith(this,arguments),this},fired:function(){return!!c}};return l},aa.extend({Deferred:function(a){var b=[["resolve","done",aa.Callbacks("once memory"),"resolved"],["reject","fail",aa.Callbacks("once memory"),"rejected"],["notify","progress",aa.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return aa.Deferred(function(c){aa.each(b,function(b,f){var g=aa.isFunction(a[b])&&a[b];e[f[1]](function(){var a=g&&g.apply(this,arguments);a&&aa.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f[0]+"With"](this===d?c.promise():this,g?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?aa.extend(a,d):d}},e={};return d.pipe=d.then,aa.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this},e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b,c,d,e=0,f=R.call(arguments),g=f.length,h=1!==g||a&&aa.isFunction(a.promise)?g:0,i=1===h?a:aa.Deferred(),j=function(a,c,d){return function(e){c[a]=this,d[a]=arguments.length>1?R.call(arguments):e,d===b?i.notifyWith(c,d):--h||i.resolveWith(c,d)}};if(g>1)for(b=new Array(g),c=new Array(g),d=new Array(g);g>e;e++)f[e]&&aa.isFunction(f[e].promise)?f[e].promise().done(j(e,d,f)).fail(i.reject).progress(j(e,c,b)):--h;return h||i.resolveWith(d,f),i.promise()}});var pa;aa.fn.ready=function(a){return aa.ready.promise().done(a),this},aa.extend({isReady:!1,readyWait:1,holdReady:function(a){a?aa.readyWait++:aa.ready(!0)},ready:function(a){(a===!0?--aa.readyWait:aa.isReady)||(aa.isReady=!0,a!==!0&&--aa.readyWait>0||(pa.resolveWith($,[aa]),aa.fn.trigger&&aa($).trigger("ready").off("ready")))}}),aa.ready.promise=function(b){return pa||(pa=aa.Deferred(),"complete"===$.readyState?setTimeout(aa.ready):($.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1))),pa.promise(b)},aa.ready.promise();var qa=aa.access=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===aa.type(c)){e=!0;for(h in c)aa.access(a,b,h,c[h],!0,f,g)}else if(void 0!==d&&(e=!0,aa.isFunction(d)||(g=!0),j&&(g?(b.call(a,d),b=null):(j=b,b=function(a,b,c){return j.call(aa(a),c)})),b))for(;i>h;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f};aa.acceptData=function(a){return 1===a.nodeType||9===a.nodeType||!+a.nodeType},h.uid=1,h.accepts=aa.acceptData,h.prototype={key:function(a){if(!h.accepts(a))return 0;var b={},c=a[this.expando];if(!c){c=h.uid++;try{b[this.expando]={value:c},Object.defineProperties(a,b)}catch(d){b[this.expando]=c,aa.extend(a,b)}}return this.cache[c]||(this.cache[c]={}),c},set:function(a,b,c){var d,e=this.key(a),f=this.cache[e];if("string"==typeof b)f[b]=c;else if(aa.isEmptyObject(f))aa.extend(this.cache[e],b);else for(d in b)f[d]=b[d];return f},get:function(a,b){var c=this.cache[this.key(a)];return void 0===b?c:c[b]},access:function(a,b,c){var d;return void 0===b||b&&"string"==typeof b&&void 0===c?(d=this.get(a,b),void 0!==d?d:this.get(a,aa.camelCase(b))):(this.set(a,b,c),void 0!==c?c:b)},remove:function(a,b){var c,d,e,f=this.key(a),g=this.cache[f];if(void 0===b)this.cache[f]={};else{aa.isArray(b)?d=b.concat(b.map(aa.camelCase)):(e=aa.camelCase(b),b in g?d=[b,e]:(d=e,d=d in g?[d]:d.match(na)||[])),c=d.length;for(;c--;)delete g[d[c]]}},hasData:function(a){return!aa.isEmptyObject(this.cache[a[this.expando]]||{})},discard:function(a){a[this.expando]&&delete this.cache[a[this.expando]]}};var ra=new h,sa=new h,ta=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,ua=/([A-Z])/g;aa.extend({hasData:function(a){return sa.hasData(a)||ra.hasData(a)},data:function(a,b,c){return sa.access(a,b,c)},removeData:function(a,b){sa.remove(a,b)},_data:function(a,b,c){return ra.access(a,b,c)},_removeData:function(a,b){ra.remove(a,b)}}),aa.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0===a){if(this.length&&(e=sa.get(f),1===f.nodeType&&!ra.get(f,"hasDataAttrs"))){for(c=g.length;c--;)d=g[c].name,0===d.indexOf("data-")&&(d=aa.camelCase(d.slice(5)),i(f,d,e[d]));ra.set(f,"hasDataAttrs",!0)}return e}return"object"==typeof a?this.each(function(){sa.set(this,a)}):qa(this,function(b){var c,d=aa.camelCase(a);if(f&&void 0===b){if(c=sa.get(f,a),void 0!==c)return c;if(c=sa.get(f,d),void 0!==c)return c;if(c=i(f,d,void 0),void 0!==c)return c}else this.each(function(){var c=sa.get(this,d);sa.set(this,d,b),-1!==a.indexOf("-")&&void 0!==c&&sa.set(this,a,b)})},null,b,arguments.length>1,null,!0)},removeData:function(a){return this.each(function(){sa.remove(this,a)})}}),aa.extend({queue:function(a,b,c){var d;return a?(b=(b||"fx")+"queue",d=ra.get(a,b),c&&(!d||aa.isArray(c)?d=ra.access(a,b,aa.makeArray(c)):d.push(c)),d||[]):void 0},dequeue:function(a,b){b=b||"fx";var c=aa.queue(a,b),d=c.length,e=c.shift(),f=aa._queueHooks(a,b),g=function(){aa.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return ra.get(a,c)||ra.access(a,c,{empty:aa.Callbacks("once memory").add(function(){ra.remove(a,[b+"queue",c])})})}}),aa.fn.extend({queue:function(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length<c?aa.queue(this[0],a):void 0===b?this:this.each(function(){var c=aa.queue(this,a,b);aa._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&aa.dequeue(this,a)})},dequeue:function(a){return this.each(function(){aa.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=aa.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};for("string"!=typeof a&&(b=a,a=void 0),a=a||"fx";g--;)c=ra.get(f[g],a+"queueHooks"),c&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var va=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,wa=["Top","Right","Bottom","Left"],xa=function(a,b){return a=b||a,"none"===aa.css(a,"display")||!aa.contains(a.ownerDocument,a)},ya=/^(?:checkbox|radio)$/i;!function(){var a=$.createDocumentFragment(),b=a.appendChild($.createElement("div"));b.innerHTML="<input type='radio' checked='checked' name='t'/>",Z.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,b.innerHTML="<textarea>x</textarea>",Z.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue}();var za="undefined";Z.focusinBubbles="onfocusin"in a;var Aa=/^key/,Ba=/^(?:mouse|contextmenu)|click/,Ca=/^(?:focusinfocus|focusoutblur)$/,Da=/^([^.]*)(?:\.(.+)|)$/;aa.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=ra.get(a);if(q)for(c.handler&&(f=c,c=f.handler,e=f.selector),c.guid||(c.guid=aa.guid++),(i=q.events)||(i=q.events={}),(g=q.handle)||(g=q.handle=function(b){return typeof aa!==za&&aa.event.triggered!==b.type?aa.event.dispatch.apply(a,arguments):void 0}),b=(b||"").match(na)||[""],j=b.length;j--;)h=Da.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n&&(l=aa.event.special[n]||{},n=(e?l.delegateType:l.bindType)||n,l=aa.event.special[n]||{},k=aa.extend({type:n,origType:p,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&aa.expr.match.needsContext.test(e),namespace:o.join(".")},f),(m=i[n])||(m=i[n]=[],m.delegateCount=0,l.setup&&l.setup.call(a,d,o,g)!==!1||a.addEventListener&&a.addEventListener(n,g,!1)),l.add&&(l.add.call(a,k),k.handler.guid||(k.handler.guid=c.guid)),e?m.splice(m.delegateCount++,0,k):m.push(k),aa.event.global[n]=!0)},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=ra.hasData(a)&&ra.get(a);if(q&&(i=q.events)){for(b=(b||"").match(na)||[""],j=b.length;j--;)if(h=Da.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n){for(l=aa.event.special[n]||{},n=(d?l.delegateType:l.bindType)||n,m=i[n]||[],h=h[2]&&new RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)"),g=f=m.length;f--;)k=m[f],!e&&p!==k.origType||c&&c.guid!==k.guid||h&&!h.test(k.namespace)||d&&d!==k.selector&&("**"!==d||!k.selector)||(m.splice(f,1),k.selector&&m.delegateCount--,l.remove&&l.remove.call(a,k));g&&!m.length&&(l.teardown&&l.teardown.call(a,o,q.handle)!==!1||aa.removeEvent(a,n,q.handle),delete i[n])}else for(n in i)aa.event.remove(a,n+b[j],c,d,!0);aa.isEmptyObject(i)&&(delete q.handle,ra.remove(a,"events"))}},trigger:function(b,c,d,e){var f,g,h,i,j,k,l,m=[d||$],n=X.call(b,"type")?b.type:b,o=X.call(b,"namespace")?b.namespace.split("."):[];if(g=h=d=d||$,3!==d.nodeType&&8!==d.nodeType&&!Ca.test(n+aa.event.triggered)&&(n.indexOf(".")>=0&&(o=n.split("."),n=o.shift(),o.sort()),j=n.indexOf(":")<0&&"on"+n,b=b[aa.expando]?b:new aa.Event(n,"object"==typeof b&&b),
b.isTrigger=e?2:3,b.namespace=o.join("."),b.namespace_re=b.namespace?new RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=d),c=null==c?[b]:aa.makeArray(c,[b]),l=aa.event.special[n]||{},e||!l.trigger||l.trigger.apply(d,c)!==!1)){if(!e&&!l.noBubble&&!aa.isWindow(d)){for(i=l.delegateType||n,Ca.test(i+n)||(g=g.parentNode);g;g=g.parentNode)m.push(g),h=g;h===(d.ownerDocument||$)&&m.push(h.defaultView||h.parentWindow||a)}for(f=0;(g=m[f++])&&!b.isPropagationStopped();)b.type=f>1?i:l.bindType||n,k=(ra.get(g,"events")||{})[b.type]&&ra.get(g,"handle"),k&&k.apply(g,c),k=j&&g[j],k&&k.apply&&aa.acceptData(g)&&(b.result=k.apply(g,c),b.result===!1&&b.preventDefault());return b.type=n,e||b.isDefaultPrevented()||l._default&&l._default.apply(m.pop(),c)!==!1||!aa.acceptData(d)||j&&aa.isFunction(d[n])&&!aa.isWindow(d)&&(h=d[j],h&&(d[j]=null),aa.event.triggered=n,d[n](),aa.event.triggered=void 0,h&&(d[j]=h)),b.result}},dispatch:function(a){a=aa.event.fix(a);var b,c,d,e,f,g=[],h=R.call(arguments),i=(ra.get(this,"events")||{})[a.type]||[],j=aa.event.special[a.type]||{};if(h[0]=a,a.delegateTarget=this,!j.preDispatch||j.preDispatch.call(this,a)!==!1){for(g=aa.event.handlers.call(this,a,i),b=0;(e=g[b++])&&!a.isPropagationStopped();)for(a.currentTarget=e.elem,c=0;(f=e.handlers[c++])&&!a.isImmediatePropagationStopped();)a.namespace_re&&!a.namespace_re.test(f.namespace)||(a.handleObj=f,a.data=f.data,d=((aa.event.special[f.origType]||{}).handle||f.handler).apply(e.elem,h),void 0!==d&&(a.result=d)===!1&&(a.preventDefault(),a.stopPropagation()));return j.postDispatch&&j.postDispatch.call(this,a),a.result}},handlers:function(a,b){var c,d,e,f,g=[],h=b.delegateCount,i=a.target;if(h&&i.nodeType&&(!a.button||"click"!==a.type))for(;i!==this;i=i.parentNode||this)if(i.disabled!==!0||"click"!==a.type){for(d=[],c=0;h>c;c++)f=b[c],e=f.selector+" ",void 0===d[e]&&(d[e]=f.needsContext?aa(e,this).index(i)>=0:aa.find(e,this,null,[i]).length),d[e]&&d.push(f);d.length&&g.push({elem:i,handlers:d})}return h<b.length&&g.push({elem:this,handlers:b.slice(h)}),g},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var c,d,e,f=b.button;return null==a.pageX&&null!=b.clientX&&(c=a.target.ownerDocument||$,d=c.documentElement,e=c.body,a.pageX=b.clientX+(d&&d.scrollLeft||e&&e.scrollLeft||0)-(d&&d.clientLeft||e&&e.clientLeft||0),a.pageY=b.clientY+(d&&d.scrollTop||e&&e.scrollTop||0)-(d&&d.clientTop||e&&e.clientTop||0)),a.which||void 0===f||(a.which=1&f?1:2&f?3:4&f?2:0),a}},fix:function(a){if(a[aa.expando])return a;var b,c,d,e=a.type,f=a,g=this.fixHooks[e];for(g||(this.fixHooks[e]=g=Ba.test(e)?this.mouseHooks:Aa.test(e)?this.keyHooks:{}),d=g.props?this.props.concat(g.props):this.props,a=new aa.Event(f),b=d.length;b--;)c=d[b],a[c]=f[c];return a.target||(a.target=$),3===a.target.nodeType&&(a.target=a.target.parentNode),g.filter?g.filter(a,f):a},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==l()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===l()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&aa.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(a){return aa.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,c,d){var e=aa.extend(new aa.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?aa.event.trigger(e,null,b):aa.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},aa.removeEvent=function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)},aa.Event=function(a,b){return this instanceof aa.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&a.getPreventDefault&&a.getPreventDefault()?j:k):this.type=a,b&&aa.extend(this,b),this.timeStamp=a&&a.timeStamp||aa.now(),void(this[aa.expando]=!0)):new aa.Event(a,b)},aa.Event.prototype={isDefaultPrevented:k,isPropagationStopped:k,isImmediatePropagationStopped:k,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=j,a&&a.preventDefault&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=j,a&&a.stopPropagation&&a.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=j,this.stopPropagation()}},aa.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){aa.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return e&&(e===d||aa.contains(d,e))||(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),Z.focusinBubbles||aa.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function(a){aa.event.simulate(b,a.target,aa.event.fix(a),!0)};aa.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=ra.access(d,b);e||d.addEventListener(a,c,!0),ra.access(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=ra.access(d,b)-1;e?ra.access(d,b,e):(d.removeEventListener(a,c,!0),ra.remove(d,b))}}}),aa.fn.extend({on:function(a,b,c,d,e){var f,g;if("object"==typeof a){"string"!=typeof b&&(c=c||b,b=void 0);for(g in a)this.on(g,b,c,a[g],e);return this}if(null==c&&null==d?(d=b,c=b=void 0):null==d&&("string"==typeof b?(d=c,c=void 0):(d=c,c=b,b=void 0)),d===!1)d=k;else if(!d)return this;return 1===e&&(f=d,d=function(a){return aa().off(a),f.apply(this,arguments)},d.guid=f.guid||(f.guid=aa.guid++)),this.each(function(){aa.event.add(this,a,d,c,b)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,aa(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"==typeof a){for(e in a)this.off(e,b,a[e]);return this}return b!==!1&&"function"!=typeof b||(c=b,b=void 0),c===!1&&(c=k),this.each(function(){aa.event.remove(this,a,c,b)})},trigger:function(a,b){return this.each(function(){aa.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];return c?aa.event.trigger(a,b,c,!0):void 0}});var Ea=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Fa=/<([\w:]+)/,Ga=/<|&#?\w+;/,Ha=/<(?:script|style|link)/i,Ia=/checked\s*(?:[^=]|=\s*.checked.)/i,Ja=/^$|\/(?:java|ecma)script/i,Ka=/^true\/(.*)/,La=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Ma={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Ma.optgroup=Ma.option,Ma.tbody=Ma.tfoot=Ma.colgroup=Ma.caption=Ma.thead,Ma.th=Ma.td,aa.extend({clone:function(a,b,c){var d,e,f,g,h=a.cloneNode(!0),i=aa.contains(a.ownerDocument,a);if(!(Z.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||aa.isXMLDoc(a)))for(g=r(h),f=r(a),d=0,e=f.length;e>d;d++)s(f[d],g[d]);if(b)if(c)for(f=f||r(a),g=g||r(h),d=0,e=f.length;e>d;d++)q(f[d],g[d]);else q(a,h);return g=r(h,"script"),g.length>0&&p(g,!i&&r(a,"script")),h},buildFragment:function(a,b,c,d){for(var e,f,g,h,i,j,k=b.createDocumentFragment(),l=[],m=0,n=a.length;n>m;m++)if(e=a[m],e||0===e)if("object"===aa.type(e))aa.merge(l,e.nodeType?[e]:e);else if(Ga.test(e)){for(f=f||k.appendChild(b.createElement("div")),g=(Fa.exec(e)||["",""])[1].toLowerCase(),h=Ma[g]||Ma._default,f.innerHTML=h[1]+e.replace(Ea,"<$1></$2>")+h[2],j=h[0];j--;)f=f.lastChild;aa.merge(l,f.childNodes),f=k.firstChild,f.textContent=""}else l.push(b.createTextNode(e));for(k.textContent="",m=0;e=l[m++];)if((!d||-1===aa.inArray(e,d))&&(i=aa.contains(e.ownerDocument,e),f=r(k.appendChild(e),"script"),i&&p(f),c))for(j=0;e=f[j++];)Ja.test(e.type||"")&&c.push(e);return k},cleanData:function(a){for(var b,c,d,e,f,g,h=aa.event.special,i=0;void 0!==(c=a[i]);i++){if(aa.acceptData(c)&&(f=c[ra.expando],f&&(b=ra.cache[f]))){if(d=Object.keys(b.events||{}),d.length)for(g=0;void 0!==(e=d[g]);g++)h[e]?aa.event.remove(c,e):aa.removeEvent(c,e,b.handle);ra.cache[f]&&delete ra.cache[f]}delete sa.cache[c[sa.expando]]}}}),aa.fn.extend({text:function(a){return qa(this,function(a){return void 0===a?aa.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=a)})},null,a,arguments.length)},append:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=m(this,a);b.appendChild(a)}})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=m(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=a?aa.filter(a,this):this,e=0;null!=(c=d[e]);e++)b||1!==c.nodeType||aa.cleanData(r(c)),c.parentNode&&(b&&aa.contains(c.ownerDocument,c)&&p(r(c,"script")),c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++)1===a.nodeType&&(aa.cleanData(r(a,!1)),a.textContent="");return this},clone:function(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return aa.clone(this,a,b)})},html:function(a){return qa(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a&&1===b.nodeType)return b.innerHTML;if("string"==typeof a&&!Ha.test(a)&&!Ma[(Fa.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(Ea,"<$1></$2>");try{for(;d>c;c++)b=this[c]||{},1===b.nodeType&&(aa.cleanData(r(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=arguments[0];return this.domManip(arguments,function(b){a=this.parentNode,aa.cleanData(r(this)),a&&a.replaceChild(b,this)}),a&&(a.length||a.nodeType)?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b){a=S.apply([],a);var c,d,e,f,g,h,i=0,j=this.length,k=this,l=j-1,m=a[0],p=aa.isFunction(m);if(p||j>1&&"string"==typeof m&&!Z.checkClone&&Ia.test(m))return this.each(function(c){var d=k.eq(c);p&&(a[0]=m.call(this,c,d.html())),d.domManip(a,b)});if(j&&(c=aa.buildFragment(a,this[0].ownerDocument,!1,this),d=c.firstChild,1===c.childNodes.length&&(c=d),d)){for(e=aa.map(r(c,"script"),n),f=e.length;j>i;i++)g=c,i!==l&&(g=aa.clone(g,!0,!0),f&&aa.merge(e,r(g,"script"))),b.call(this[i],g,i);if(f)for(h=e[e.length-1].ownerDocument,aa.map(e,o),i=0;f>i;i++)g=e[i],Ja.test(g.type||"")&&!ra.access(g,"globalEval")&&aa.contains(h,g)&&(g.src?aa._evalUrl&&aa._evalUrl(g.src):aa.globalEval(g.textContent.replace(La,"")))}return this}}),aa.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){aa.fn[a]=function(a){for(var c,d=[],e=aa(a),f=e.length-1,g=0;f>=g;g++)c=g===f?this:this.clone(!0),aa(e[g])[b](c),T.apply(d,c.get());return this.pushStack(d)}});var Na,Oa={},Pa=/^margin/,Qa=new RegExp("^("+va+")(?!px)[a-z%]+$","i"),Ra=function(a){return a.ownerDocument.defaultView.getComputedStyle(a,null)};!function(){function b(){h.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%",f.appendChild(g);var b=a.getComputedStyle(h,null);c="1%"!==b.top,d="4px"===b.width,f.removeChild(g)}var c,d,e="padding:0;margin:0;border:0;display:block;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box",f=$.documentElement,g=$.createElement("div"),h=$.createElement("div");h.style.backgroundClip="content-box",h.cloneNode(!0).style.backgroundClip="",Z.clearCloneStyle="content-box"===h.style.backgroundClip,g.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",g.appendChild(h),a.getComputedStyle&&aa.extend(Z,{pixelPosition:function(){return b(),c},boxSizingReliable:function(){return null==d&&b(),d},reliableMarginRight:function(){var b,c=h.appendChild($.createElement("div"));return c.style.cssText=h.style.cssText=e,c.style.marginRight=c.style.width="0",h.style.width="1px",f.appendChild(g),b=!parseFloat(a.getComputedStyle(c,null).marginRight),f.removeChild(g),h.innerHTML="",b}})}(),aa.swap=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e};var Sa=/^(none|table(?!-c[ea]).+)/,Ta=new RegExp("^("+va+")(.*)$","i"),Ua=new RegExp("^([+-])=("+va+")","i"),Va={position:"absolute",visibility:"hidden",display:"block"},Wa={letterSpacing:0,fontWeight:400},Xa=["Webkit","O","Moz","ms"];aa.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=v(a,"opacity");return""===c?"1":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=aa.camelCase(b),i=a.style;return b=aa.cssProps[h]||(aa.cssProps[h]=x(i,h)),g=aa.cssHooks[b]||aa.cssHooks[h],void 0===c?g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b]:(f=typeof c,"string"===f&&(e=Ua.exec(c))&&(c=(e[1]+1)*e[2]+parseFloat(aa.css(a,b)),f="number"),null!=c&&c===c&&("number"!==f||aa.cssNumber[h]||(c+="px"),Z.clearCloneStyle||""!==c||0!==b.indexOf("background")||(i[b]="inherit"),g&&"set"in g&&void 0===(c=g.set(a,c,d))||(i[b]="",i[b]=c)),void 0)}},css:function(a,b,c,d){var e,f,g,h=aa.camelCase(b);return b=aa.cssProps[h]||(aa.cssProps[h]=x(a.style,h)),g=aa.cssHooks[b]||aa.cssHooks[h],g&&"get"in g&&(e=g.get(a,!0,c)),void 0===e&&(e=v(a,b,d)),"normal"===e&&b in Wa&&(e=Wa[b]),""===c||c?(f=parseFloat(e),c===!0||aa.isNumeric(f)?f||0:e):e}}),aa.each(["height","width"],function(a,b){aa.cssHooks[b]={get:function(a,c,d){return c?0===a.offsetWidth&&Sa.test(aa.css(a,"display"))?aa.swap(a,Va,function(){return A(a,b,d)}):A(a,b,d):void 0},set:function(a,c,d){var e=d&&Ra(a);return y(a,c,d?z(a,b,d,"border-box"===aa.css(a,"boxSizing",!1,e),e):0)}}}),aa.cssHooks.marginRight=w(Z.reliableMarginRight,function(a,b){return b?aa.swap(a,{display:"inline-block"},v,[a,"marginRight"]):void 0}),aa.each({margin:"",padding:"",border:"Width"},function(a,b){aa.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];4>d;d++)e[a+wa[d]+b]=f[d]||f[d-2]||f[0];return e}},Pa.test(a)||(aa.cssHooks[a+b].set=y)}),aa.fn.extend({css:function(a,b){return qa(this,function(a,b,c){var d,e,f={},g=0;if(aa.isArray(b)){for(d=Ra(a),e=b.length;e>g;g++)f[b[g]]=aa.css(a,b[g],!1,d);return f}return void 0!==c?aa.style(a,b,c):aa.css(a,b)},a,b,arguments.length>1)},show:function(){return B(this,!0)},hide:function(){return B(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){xa(this)?aa(this).show():aa(this).hide()})}}),aa.Tween=C,C.prototype={constructor:C,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(aa.cssNumber[c]?"":"px")},cur:function(){var a=C.propHooks[this.prop];return a&&a.get?a.get(this):C.propHooks._default.get(this)},run:function(a){var b,c=C.propHooks[this.prop];return this.options.duration?this.pos=b=aa.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):this.pos=b=a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):C.propHooks._default.set(this),this}},C.prototype.init.prototype=C.prototype,C.propHooks={_default:{get:function(a){var b;return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=aa.css(a.elem,a.prop,""),b&&"auto"!==b?b:0):a.elem[a.prop]},set:function(a){aa.fx.step[a.prop]?aa.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[aa.cssProps[a.prop]]||aa.cssHooks[a.prop])?aa.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}},C.propHooks.scrollTop=C.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},aa.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}},aa.fx=C.prototype.init,aa.fx.step={};var Ya,Za,$a=/^(?:toggle|show|hide)$/,_a=new RegExp("^(?:([+-])=|)("+va+")([a-z%]*)$","i"),ab=/queueHooks$/,bb=[G],cb={"*":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=_a.exec(b),f=e&&e[3]||(aa.cssNumber[a]?"":"px"),g=(aa.cssNumber[a]||"px"!==f&&+d)&&_a.exec(aa.css(c.elem,a)),h=1,i=20;if(g&&g[3]!==f){f=f||g[3],e=e||[],g=+d||1;do h=h||".5",g/=h,aa.style(c.elem,a,g+f);while(h!==(h=c.cur()/d)&&1!==h&&--i)}return e&&(g=c.start=+g||+d||0,c.unit=f,c.end=e[1]?g+(e[1]+1)*e[2]:+e[2]),c}]};aa.Animation=aa.extend(I,{tweener:function(a,b){aa.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;e>d;d++)c=a[d],cb[c]=cb[c]||[],cb[c].unshift(b)},prefilter:function(a,b){b?bb.unshift(a):bb.push(a)}}),aa.speed=function(a,b,c){var d=a&&"object"==typeof a?aa.extend({},a):{complete:c||!c&&b||aa.isFunction(a)&&a,duration:a,easing:c&&b||b&&!aa.isFunction(b)&&b};return d.duration=aa.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in aa.fx.speeds?aa.fx.speeds[d.duration]:aa.fx.speeds._default,null!=d.queue&&d.queue!==!0||(d.queue="fx"),d.old=d.complete,d.complete=function(){aa.isFunction(d.old)&&d.old.call(this),d.queue&&aa.dequeue(this,d.queue)},d},aa.fn.extend({fadeTo:function(a,b,c,d){return this.filter(xa).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=aa.isEmptyObject(a),f=aa.speed(b,c,d),g=function(){var b=I(this,aa.extend({},a),f);(e||ra.get(this,"finish"))&&b.stop(!0)};return g.finish=g,e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=aa.timers,g=ra.get(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&ab.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));!b&&c||aa.dequeue(this,a)})},finish:function(a){return a!==!1&&(a=a||"fx"),this.each(function(){var b,c=ra.get(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=aa.timers,g=d?d.length:0;for(c.finish=!0,aa.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;g>b;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),aa.each(["toggle","show","hide"],function(a,b){var c=aa.fn[b];aa.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(E(b,!0),a,d,e)}}),aa.each({slideDown:E("show"),slideUp:E("hide"),slideToggle:E("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){aa.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),aa.timers=[],aa.fx.tick=function(){var a,b=0,c=aa.timers;for(Ya=aa.now();b<c.length;b++)a=c[b],a()||c[b]!==a||c.splice(b--,1);c.length||aa.fx.stop(),Ya=void 0},aa.fx.timer=function(a){aa.timers.push(a),a()?aa.fx.start():aa.timers.pop()},aa.fx.interval=13,aa.fx.start=function(){Za||(Za=setInterval(aa.fx.tick,aa.fx.interval))},aa.fx.stop=function(){clearInterval(Za),Za=null},aa.fx.speeds={slow:600,fast:200,_default:400},aa.fn.delay=function(a,b){return a=aa.fx?aa.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},function(){var a=$.createElement("input"),b=$.createElement("select"),c=b.appendChild($.createElement("option"));a.type="checkbox",Z.checkOn=""!==a.value,Z.optSelected=c.selected,b.disabled=!0,Z.optDisabled=!c.disabled,a=$.createElement("input"),a.value="t",a.type="radio",Z.radioValue="t"===a.value}();var db,eb,fb=aa.expr.attrHandle;aa.fn.extend({attr:function(a,b){return qa(this,aa.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){aa.removeAttr(this,a)})}}),aa.extend({attr:function(a,b,c){var d,e,f=a.nodeType;if(a&&3!==f&&8!==f&&2!==f)return typeof a.getAttribute===za?aa.prop(a,b,c):(1===f&&aa.isXMLDoc(a)||(b=b.toLowerCase(),d=aa.attrHooks[b]||(aa.expr.match.bool.test(b)?eb:db)),void 0===c?d&&"get"in d&&null!==(e=d.get(a,b))?e:(e=aa.find.attr(a,b),null==e?void 0:e):null!==c?d&&"set"in d&&void 0!==(e=d.set(a,c,b))?e:(a.setAttribute(b,c+""),c):void aa.removeAttr(a,b))},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(na);if(f&&1===a.nodeType)for(;c=f[e++];)d=aa.propFix[c]||c,aa.expr.match.bool.test(c)&&(a[d]=!1),a.removeAttribute(c)},attrHooks:{type:{set:function(a,b){if(!Z.radioValue&&"radio"===b&&aa.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}}}),eb={set:function(a,b,c){return b===!1?aa.removeAttr(a,c):a.setAttribute(c,c),c}},aa.each(aa.expr.match.bool.source.match(/\w+/g),function(a,b){var c=fb[b]||aa.find.attr;fb[b]=function(a,b,d){var e,f;return d||(f=fb[b],fb[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,fb[b]=f),e}});var gb=/^(?:input|select|textarea|button)$/i;aa.fn.extend({prop:function(a,b){return qa(this,aa.prop,a,b,arguments.length>1)},removeProp:function(a){return this.each(function(){delete this[aa.propFix[a]||a]})}}),aa.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(a,b,c){var d,e,f,g=a.nodeType;if(a&&3!==g&&8!==g&&2!==g)return f=1!==g||!aa.isXMLDoc(a),f&&(b=aa.propFix[b]||b,e=aa.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]},propHooks:{tabIndex:{get:function(a){return a.hasAttribute("tabindex")||gb.test(a.nodeName)||a.href?a.tabIndex:-1}}}}),Z.optSelected||(aa.propHooks.selected={get:function(a){var b=a.parentNode;return b&&b.parentNode&&b.parentNode.selectedIndex,null}}),aa.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){aa.propFix[this.toLowerCase()]=this});var hb=/[\t\r\n\f]/g;aa.fn.extend({addClass:function(a){var b,c,d,e,f,g,h="string"==typeof a&&a,i=0,j=this.length;if(aa.isFunction(a))return this.each(function(b){aa(this).addClass(a.call(this,b,this.className))});if(h)for(b=(a||"").match(na)||[];j>i;i++)if(c=this[i],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(hb," "):" ")){for(f=0;e=b[f++];)d.indexOf(" "+e+" ")<0&&(d+=e+" ");g=aa.trim(d),c.className!==g&&(c.className=g)}return this},removeClass:function(a){var b,c,d,e,f,g,h=0===arguments.length||"string"==typeof a&&a,i=0,j=this.length;if(aa.isFunction(a))return this.each(function(b){aa(this).removeClass(a.call(this,b,this.className))});if(h)for(b=(a||"").match(na)||[];j>i;i++)if(c=this[i],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(hb," "):"")){for(f=0;e=b[f++];)for(;d.indexOf(" "+e+" ")>=0;)d=d.replace(" "+e+" "," ");g=a?aa.trim(d):"",c.className!==g&&(c.className=g)}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):aa.isFunction(a)?this.each(function(c){aa(this).toggleClass(a.call(this,c,this.className,b),b)}):this.each(function(){if("string"===c)for(var b,d=0,e=aa(this),f=a.match(na)||[];b=f[d++];)e.hasClass(b)?e.removeClass(b):e.addClass(b);else c!==za&&"boolean"!==c||(this.className&&ra.set(this,"__className__",this.className),this.className=this.className||a===!1?"":ra.get(this,"__className__")||"")})},hasClass:function(a){for(var b=" "+a+" ",c=0,d=this.length;d>c;c++)if(1===this[c].nodeType&&(" "+this[c].className+" ").replace(hb," ").indexOf(b)>=0)return!0;return!1}});var ib=/\r/g;aa.fn.extend({val:function(a){var b,c,d,e=this[0];{if(arguments.length)return d=aa.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(e=d?a.call(this,c,aa(this).val()):a,null==e?e="":"number"==typeof e?e+="":aa.isArray(e)&&(e=aa.map(e,function(a){return null==a?"":a+""})),b=aa.valHooks[this.type]||aa.valHooks[this.nodeName.toLowerCase()],b&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e))});if(e)return b=aa.valHooks[e.type]||aa.valHooks[e.nodeName.toLowerCase()],b&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:(c=e.value,"string"==typeof c?c.replace(ib,""):null==c?"":c)}}}),aa.extend({valHooks:{select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||0>e,g=f?null:[],h=f?e+1:d.length,i=0>e?h:f?e:0;h>i;i++)if(c=d[i],(c.selected||i===e)&&(Z.optDisabled?!c.disabled:null===c.getAttribute("disabled"))&&(!c.parentNode.disabled||!aa.nodeName(c.parentNode,"optgroup"))){if(b=aa(c).val(),f)return b;g.push(b)}return g},set:function(a,b){for(var c,d,e=a.options,f=aa.makeArray(b),g=e.length;g--;)d=e[g],(d.selected=aa.inArray(aa(d).val(),f)>=0)&&(c=!0);return c||(a.selectedIndex=-1),f}}}}),aa.each(["radio","checkbox"],function(){aa.valHooks[this]={set:function(a,b){return aa.isArray(b)?a.checked=aa.inArray(aa(a).val(),b)>=0:void 0}},Z.checkOn||(aa.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})}),aa.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){aa.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),aa.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}});var jb=aa.now(),kb=/\?/;aa.parseJSON=function(a){return JSON.parse(a+"")},aa.parseXML=function(a){var b,c;if(!a||"string"!=typeof a)return null;try{c=new DOMParser,b=c.parseFromString(a,"text/xml")}catch(d){b=void 0}return b&&!b.getElementsByTagName("parsererror").length||aa.error("Invalid XML: "+a),b};var lb,mb,nb=/#.*$/,ob=/([?&])_=[^&]*/,pb=/^(.*?):[ \t]*([^\r\n]*)$/gm,qb=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rb=/^(?:GET|HEAD)$/,sb=/^\/\//,tb=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,ub={},vb={},wb="*/".concat("*");try{mb=location.href}catch(xb){mb=$.createElement("a"),mb.href="",mb=mb.href}lb=tb.exec(mb.toLowerCase())||[],aa.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:mb,type:"GET",isLocal:qb.test(lb[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":wb,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":aa.parseJSON,"text xml":aa.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?L(L(a,aa.ajaxSettings),b):L(aa.ajaxSettings,a)},ajaxPrefilter:J(ub),ajaxTransport:J(vb),ajax:function(a,b){function c(a,b,c,g){var i,k,r,s,u,w=b;2!==t&&(t=2,h&&clearTimeout(h),d=void 0,f=g||"",v.readyState=a>0?4:0,i=a>=200&&300>a||304===a,c&&(s=M(l,v,c)),s=N(l,s,v,i),i?(l.ifModified&&(u=v.getResponseHeader("Last-Modified"),u&&(aa.lastModified[e]=u),u=v.getResponseHeader("etag"),u&&(aa.etag[e]=u)),204===a||"HEAD"===l.type?w="nocontent":304===a?w="notmodified":(w=s.state,k=s.data,r=s.error,i=!r)):(r=w,!a&&w||(w="error",0>a&&(a=0))),v.status=a,v.statusText=(b||w)+"",i?o.resolveWith(m,[k,w,v]):o.rejectWith(m,[v,w,r]),v.statusCode(q),q=void 0,j&&n.trigger(i?"ajaxSuccess":"ajaxError",[v,l,i?k:r]),p.fireWith(m,[v,w]),j&&(n.trigger("ajaxComplete",[v,l]),--aa.active||aa.event.trigger("ajaxStop")))}"object"==typeof a&&(b=a,a=void 0),b=b||{};var d,e,f,g,h,i,j,k,l=aa.ajaxSetup({},b),m=l.context||l,n=l.context&&(m.nodeType||m.jquery)?aa(m):aa.event,o=aa.Deferred(),p=aa.Callbacks("once memory"),q=l.statusCode||{},r={},s={},t=0,u="canceled",v={readyState:0,getResponseHeader:function(a){var b;if(2===t){if(!g)for(g={};b=pb.exec(f);)g[b[1].toLowerCase()]=b[2];b=g[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===t?f:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return t||(a=s[c]=s[c]||a,r[a]=b),this},overrideMimeType:function(a){return t||(l.mimeType=a),this},statusCode:function(a){var b;if(a)if(2>t)for(b in a)q[b]=[q[b],a[b]];else v.always(a[v.status]);return this},abort:function(a){var b=a||u;return d&&d.abort(b),c(0,b),this}};if(o.promise(v).complete=p.add,v.success=v.done,v.error=v.fail,l.url=((a||l.url||mb)+"").replace(nb,"").replace(sb,lb[1]+"//"),l.type=b.method||b.type||l.method||l.type,l.dataTypes=aa.trim(l.dataType||"*").toLowerCase().match(na)||[""],null==l.crossDomain&&(i=tb.exec(l.url.toLowerCase()),l.crossDomain=!(!i||i[1]===lb[1]&&i[2]===lb[2]&&(i[3]||("http:"===i[1]?"80":"443"))===(lb[3]||("http:"===lb[1]?"80":"443")))),l.data&&l.processData&&"string"!=typeof l.data&&(l.data=aa.param(l.data,l.traditional)),K(ub,l,b,v),2===t)return v;j=l.global,j&&0===aa.active++&&aa.event.trigger("ajaxStart"),l.type=l.type.toUpperCase(),l.hasContent=!rb.test(l.type),e=l.url,l.hasContent||(l.data&&(e=l.url+=(kb.test(e)?"&":"?")+l.data,delete l.data),l.cache===!1&&(l.url=ob.test(e)?e.replace(ob,"$1_="+jb++):e+(kb.test(e)?"&":"?")+"_="+jb++)),l.ifModified&&(aa.lastModified[e]&&v.setRequestHeader("If-Modified-Since",aa.lastModified[e]),aa.etag[e]&&v.setRequestHeader("If-None-Match",aa.etag[e])),(l.data&&l.hasContent&&l.contentType!==!1||b.contentType)&&v.setRequestHeader("Content-Type",l.contentType),v.setRequestHeader("Accept",l.dataTypes[0]&&l.accepts[l.dataTypes[0]]?l.accepts[l.dataTypes[0]]+("*"!==l.dataTypes[0]?", "+wb+"; q=0.01":""):l.accepts["*"]);for(k in l.headers)v.setRequestHeader(k,l.headers[k]);if(l.beforeSend&&(l.beforeSend.call(m,v,l)===!1||2===t))return v.abort();u="abort";for(k in{success:1,error:1,complete:1})v[k](l[k]);if(d=K(vb,l,b,v)){v.readyState=1,j&&n.trigger("ajaxSend",[v,l]),l.async&&l.timeout>0&&(h=setTimeout(function(){v.abort("timeout")},l.timeout));try{t=1,d.send(r,c)}catch(w){if(!(2>t))throw w;c(-1,w)}}else c(-1,"No Transport");return v},getJSON:function(a,b,c){return aa.get(a,b,c,"json")},getScript:function(a,b){return aa.get(a,void 0,b,"script")}}),aa.each(["get","post"],function(a,b){aa[b]=function(a,c,d,e){return aa.isFunction(c)&&(e=e||d,d=c,c=void 0),aa.ajax({url:a,type:b,dataType:e,data:c,success:d})}}),aa.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){aa.fn[b]=function(a){return this.on(b,a)}}),aa._evalUrl=function(a){return aa.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},aa.fn.extend({wrapAll:function(a){var b;return aa.isFunction(a)?this.each(function(b){aa(this).wrapAll(a.call(this,b))}):(this[0]&&(b=aa(a,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){for(var a=this;a.firstElementChild;)a=a.firstElementChild;return a}).append(this)),this)},wrapInner:function(a){return aa.isFunction(a)?this.each(function(b){aa(this).wrapInner(a.call(this,b))}):this.each(function(){var b=aa(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=aa.isFunction(a);return this.each(function(c){aa(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){aa.nodeName(this,"body")||aa(this).replaceWith(this.childNodes);
}).end()}}),aa.expr.filters.hidden=function(a){return a.offsetWidth<=0&&a.offsetHeight<=0},aa.expr.filters.visible=function(a){return!aa.expr.filters.hidden(a)};var yb=/%20/g,zb=/\[\]$/,Ab=/\r?\n/g,Bb=/^(?:submit|button|image|reset|file)$/i,Cb=/^(?:input|select|textarea|keygen)/i;aa.param=function(a,b){var c,d=[],e=function(a,b){b=aa.isFunction(b)?b():null==b?"":b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(void 0===b&&(b=aa.ajaxSettings&&aa.ajaxSettings.traditional),aa.isArray(a)||a.jquery&&!aa.isPlainObject(a))aa.each(a,function(){e(this.name,this.value)});else for(c in a)O(c,a[c],b,e);return d.join("&").replace(yb,"+")},aa.fn.extend({serialize:function(){return aa.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=aa.prop(this,"elements");return a?aa.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!aa(this).is(":disabled")&&Cb.test(this.nodeName)&&!Bb.test(a)&&(this.checked||!ya.test(a))}).map(function(a,b){var c=aa(this).val();return null==c?null:aa.isArray(c)?aa.map(c,function(a){return{name:b.name,value:a.replace(Ab,"\r\n")}}):{name:b.name,value:c.replace(Ab,"\r\n")}}).get()}}),aa.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(a){}};var Db=0,Eb={},Fb={0:200,1223:204},Gb=aa.ajaxSettings.xhr();a.ActiveXObject&&aa(a).on("unload",function(){for(var a in Eb)Eb[a]()}),Z.cors=!!Gb&&"withCredentials"in Gb,Z.ajax=Gb=!!Gb,aa.ajaxTransport(function(a){var b;return Z.cors||Gb&&!a.crossDomain?{send:function(c,d){var e,f=a.xhr(),g=++Db;if(f.open(a.type,a.url,a.async,a.username,a.password),a.xhrFields)for(e in a.xhrFields)f[e]=a.xhrFields[e];a.mimeType&&f.overrideMimeType&&f.overrideMimeType(a.mimeType),a.crossDomain||c["X-Requested-With"]||(c["X-Requested-With"]="XMLHttpRequest");for(e in c)f.setRequestHeader(e,c[e]);b=function(a){return function(){b&&(delete Eb[g],b=f.onload=f.onerror=null,"abort"===a?f.abort():"error"===a?d(f.status,f.statusText):d(Fb[f.status]||f.status,f.statusText,"string"==typeof f.responseText?{text:f.responseText}:void 0,f.getAllResponseHeaders()))}},f.onload=b(),f.onerror=b("error"),b=Eb[g]=b("abort"),f.send(a.hasContent&&a.data||null)},abort:function(){b&&b()}}:void 0}),aa.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){return aa.globalEval(a),a}}}),aa.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET")}),aa.ajaxTransport("script",function(a){if(a.crossDomain){var b,c;return{send:function(d,e){b=aa("<script>").prop({async:!0,charset:a.scriptCharset,src:a.url}).on("load error",c=function(a){b.remove(),c=null,a&&e("error"===a.type?404:200,a.type)}),$.head.appendChild(b[0])},abort:function(){c&&c()}}}});var Hb=[],Ib=/(=)\?(?=&|$)|\?\?/;aa.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=Hb.pop()||aa.expando+"_"+jb++;return this[a]=!0,a}}),aa.ajaxPrefilter("json jsonp",function(b,c,d){var e,f,g,h=b.jsonp!==!1&&(Ib.test(b.url)?"url":"string"==typeof b.data&&!(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&Ib.test(b.data)&&"data");return h||"jsonp"===b.dataTypes[0]?(e=b.jsonpCallback=aa.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(Ib,"$1"+e):b.jsonp!==!1&&(b.url+=(kb.test(b.url)?"&":"?")+b.jsonp+"="+e),b.converters["script json"]=function(){return g||aa.error(e+" was not called"),g[0]},b.dataTypes[0]="json",f=a[e],a[e]=function(){g=arguments},d.always(function(){a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,Hb.push(e)),g&&aa.isFunction(f)&&f(g[0]),g=f=void 0}),"script"):void 0}),aa.parseHTML=function(a,b,c){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(c=b,b=!1),b=b||$;var d=ga.exec(a),e=!c&&[];return d?[b.createElement(d[1])]:(d=aa.buildFragment([a],b,e),e&&e.length&&aa(e).remove(),aa.merge([],d.childNodes))};var Jb=aa.fn.load;aa.fn.load=function(a,b,c){if("string"!=typeof a&&Jb)return Jb.apply(this,arguments);var d,e,f,g=this,h=a.indexOf(" ");return h>=0&&(d=a.slice(h),a=a.slice(0,h)),aa.isFunction(b)?(c=b,b=void 0):b&&"object"==typeof b&&(e="POST"),g.length>0&&aa.ajax({url:a,type:e,dataType:"html",data:b}).done(function(a){f=arguments,g.html(d?aa("<div>").append(aa.parseHTML(a)).find(d):a)}).complete(c&&function(a,b){g.each(c,f||[a.responseText,b,a])}),this},aa.expr.filters.animated=function(a){return aa.grep(aa.timers,function(b){return a===b.elem}).length};var Kb=a.document.documentElement;aa.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,j,k=aa.css(a,"position"),l=aa(a),m={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=aa.css(a,"top"),i=aa.css(a,"left"),j=("absolute"===k||"fixed"===k)&&(f+i).indexOf("auto")>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),aa.isFunction(b)&&(b=b.call(a,c,h)),null!=b.top&&(m.top=b.top-h.top+g),null!=b.left&&(m.left=b.left-h.left+e),"using"in b?b.using.call(a,m):l.css(m)}},aa.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){aa.offset.setOffset(this,a,b)});var b,c,d=this[0],e={top:0,left:0},f=d&&d.ownerDocument;if(f)return b=f.documentElement,aa.contains(b,d)?(typeof d.getBoundingClientRect!==za&&(e=d.getBoundingClientRect()),c=P(f),{top:e.top+c.pageYOffset-b.clientTop,left:e.left+c.pageXOffset-b.clientLeft}):e},position:function(){if(this[0]){var a,b,c=this[0],d={top:0,left:0};return"fixed"===aa.css(c,"position")?b=c.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),aa.nodeName(a[0],"html")||(d=a.offset()),d.top+=aa.css(a[0],"borderTopWidth",!0),d.left+=aa.css(a[0],"borderLeftWidth",!0)),{top:b.top-d.top-aa.css(c,"marginTop",!0),left:b.left-d.left-aa.css(c,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||Kb;a&&!aa.nodeName(a,"html")&&"static"===aa.css(a,"position");)a=a.offsetParent;return a||Kb})}}),aa.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(b,c){var d="pageYOffset"===c;aa.fn[b]=function(e){return qa(this,function(b,e,f){var g=P(b);return void 0===f?g?g[c]:b[e]:void(g?g.scrollTo(d?a.pageXOffset:f,d?f:a.pageYOffset):b[e]=f)},b,e,arguments.length,null)}}),aa.each(["top","left"],function(a,b){aa.cssHooks[b]=w(Z.pixelPosition,function(a,c){return c?(c=v(a,b),Qa.test(c)?aa(a).position()[b]+"px":c):void 0})}),aa.each({Height:"height",Width:"width"},function(a,b){aa.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){aa.fn[d]=function(d,e){var f=arguments.length&&(c||"boolean"!=typeof d),g=c||(d===!0||e===!0?"margin":"border");return qa(this,function(b,c,d){var e;return aa.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(e=b.documentElement,Math.max(b.body["scroll"+a],e["scroll"+a],b.body["offset"+a],e["offset"+a],e["client"+a])):void 0===d?aa.css(b,c,g):aa.style(b,c,d,g)},b,f?d:void 0,f,null)}})}),aa.fn.size=function(){return this.length},aa.fn.andSelf=aa.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return aa});var Lb=a.jQuery,Mb=a.$;return aa.noConflict=function(b){return a.$===aa&&(a.$=Mb),b&&a.jQuery===aa&&(a.jQuery=Lb),aa},typeof b===za&&(a.jQuery=a.$=aa),aa}),function(){var a=this,b=a._,c={},d=Array.prototype,e=Object.prototype,f=Function.prototype,g=d.push,h=d.slice,i=d.concat,j=e.toString,k=e.hasOwnProperty,l=d.forEach,m=d.map,n=d.reduce,o=d.reduceRight,p=d.filter,q=d.every,r=d.some,s=d.indexOf,t=d.lastIndexOf,u=Array.isArray,v=Object.keys,w=f.bind,x=function(a){return a instanceof x?a:this instanceof x?void(this._wrapped=a):new x(a)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):a._=x,x.VERSION="1.6.0";var y=x.each=x.forEach=function(a,b,d){if(null==a)return a;if(l&&a.forEach===l)a.forEach(b,d);else if(a.length===+a.length){for(var e=0,f=a.length;f>e;e++)if(b.call(d,a[e],e,a)===c)return}else for(var g=x.keys(a),e=0,f=g.length;f>e;e++)if(b.call(d,a[g[e]],g[e],a)===c)return;return a};x.map=x.collect=function(a,b,c){var d=[];return null==a?d:m&&a.map===m?a.map(b,c):(y(a,function(a,e,f){d.push(b.call(c,a,e,f))}),d)};var z="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),n&&a.reduce===n)return d&&(b=x.bind(b,d)),e?a.reduce(b,c):a.reduce(b);if(y(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)}),!e)throw new TypeError(z);return c},x.reduceRight=x.foldr=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),o&&a.reduceRight===o)return d&&(b=x.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=a.length;if(f!==+f){var g=x.keys(a);f=g.length}if(y(a,function(h,i,j){i=g?g[--f]:--f,e?c=b.call(d,c,a[i],i,j):(c=a[i],e=!0)}),!e)throw new TypeError(z);return c},x.find=x.detect=function(a,b,c){var d;return A(a,function(a,e,f){return b.call(c,a,e,f)?(d=a,!0):void 0}),d},x.filter=x.select=function(a,b,c){var d=[];return null==a?d:p&&a.filter===p?a.filter(b,c):(y(a,function(a,e,f){b.call(c,a,e,f)&&d.push(a)}),d)},x.reject=function(a,b,c){return x.filter(a,function(a,d,e){return!b.call(c,a,d,e)},c)},x.every=x.all=function(a,b,d){b||(b=x.identity);var e=!0;return null==a?e:q&&a.every===q?a.every(b,d):(y(a,function(a,f,g){return(e=e&&b.call(d,a,f,g))?void 0:c}),!!e)};var A=x.some=x.any=function(a,b,d){b||(b=x.identity);var e=!1;return null==a?e:r&&a.some===r?a.some(b,d):(y(a,function(a,f,g){return e||(e=b.call(d,a,f,g))?c:void 0}),!!e)};x.contains=x.include=function(a,b){return null==a?!1:s&&a.indexOf===s?-1!=a.indexOf(b):A(a,function(a){return a===b})},x.invoke=function(a,b){var c=h.call(arguments,2),d=x.isFunction(b);return x.map(a,function(a){return(d?b:a[b]).apply(a,c)})},x.pluck=function(a,b){return x.map(a,x.property(b))},x.where=function(a,b){return x.filter(a,x.matches(b))},x.findWhere=function(a,b){return x.find(a,x.matches(b))},x.max=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.max.apply(Math,a);var d=-(1/0),e=-(1/0);return y(a,function(a,f,g){var h=b?b.call(c,a,f,g):a;h>e&&(d=a,e=h)}),d},x.min=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.min.apply(Math,a);var d=1/0,e=1/0;return y(a,function(a,f,g){var h=b?b.call(c,a,f,g):a;e>h&&(d=a,e=h)}),d},x.shuffle=function(a){var b,c=0,d=[];return y(a,function(a){b=x.random(c++),d[c-1]=d[b],d[b]=a}),d},x.sample=function(a,b,c){return null==b||c?(a.length!==+a.length&&(a=x.values(a)),a[x.random(a.length-1)]):x.shuffle(a).slice(0,Math.max(0,b))};var B=function(a){return null==a?x.identity:x.isFunction(a)?a:x.property(a)};x.sortBy=function(a,b,c){return b=B(b),x.pluck(x.map(a,function(a,d,e){return{value:a,index:d,criteria:b.call(c,a,d,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(d>c||void 0===d)return-1}return a.index-b.index}),"value")};var C=function(a){return function(b,c,d){var e={};return c=B(c),y(b,function(f,g){var h=c.call(d,f,g,b);a(e,h,f)}),e}};x.groupBy=C(function(a,b,c){x.has(a,b)?a[b].push(c):a[b]=[c]}),x.indexBy=C(function(a,b,c){a[b]=c}),x.countBy=C(function(a,b){x.has(a,b)?a[b]++:a[b]=1}),x.sortedIndex=function(a,b,c,d){c=B(c);for(var e=c.call(d,b),f=0,g=a.length;g>f;){var h=f+g>>>1;c.call(d,a[h])<e?f=h+1:g=h}return f},x.toArray=function(a){return a?x.isArray(a)?h.call(a):a.length===+a.length?x.map(a,x.identity):x.values(a):[]},x.size=function(a){return null==a?0:a.length===+a.length?a.length:x.keys(a).length},x.first=x.head=x.take=function(a,b,c){return null!=a?null==b||c?a[0]:0>b?[]:h.call(a,0,b):void 0},x.initial=function(a,b,c){return h.call(a,0,a.length-(null==b||c?1:b))},x.last=function(a,b,c){return null!=a?null==b||c?a[a.length-1]:h.call(a,Math.max(a.length-b,0)):void 0},x.rest=x.tail=x.drop=function(a,b,c){return h.call(a,null==b||c?1:b)},x.compact=function(a){return x.filter(a,x.identity)};var D=function(a,b,c){return b&&x.every(a,x.isArray)?i.apply(c,a):(y(a,function(a){x.isArray(a)||x.isArguments(a)?b?g.apply(c,a):D(a,b,c):c.push(a)}),c)};x.flatten=function(a,b){return D(a,b,[])},x.without=function(a){return x.difference(a,h.call(arguments,1))},x.partition=function(a,b){var c=[],d=[];return y(a,function(a){(b(a)?c:d).push(a)}),[c,d]},x.uniq=x.unique=function(a,b,c,d){x.isFunction(b)&&(d=c,c=b,b=!1);var e=c?x.map(a,c,d):a,f=[],g=[];return y(e,function(c,d){(b?d&&g[g.length-1]===c:x.contains(g,c))||(g.push(c),f.push(a[d]))}),f},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=function(a){var b=h.call(arguments,1);return x.filter(x.uniq(a),function(a){return x.every(b,function(b){return x.contains(b,a)})})},x.difference=function(a){var b=i.apply(d,h.call(arguments,1));return x.filter(a,function(a){return!x.contains(b,a)})},x.zip=function(){for(var a=x.max(x.pluck(arguments,"length").concat(0)),b=new Array(a),c=0;a>c;c++)b[c]=x.pluck(arguments,""+c);return b},x.object=function(a,b){if(null==a)return{};for(var c={},d=0,e=a.length;e>d;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c},x.indexOf=function(a,b,c){if(null==a)return-1;var d=0,e=a.length;if(c){if("number"!=typeof c)return d=x.sortedIndex(a,b),a[d]===b?d:-1;d=0>c?Math.max(0,e+c):c}if(s&&a.indexOf===s)return a.indexOf(b,c);for(;e>d;d++)if(a[d]===b)return d;return-1},x.lastIndexOf=function(a,b,c){if(null==a)return-1;var d=null!=c;if(t&&a.lastIndexOf===t)return d?a.lastIndexOf(b,c):a.lastIndexOf(b);for(var e=d?c:a.length;e--;)if(a[e]===b)return e;return-1},x.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);d>e;)f[e++]=a,a+=c;return f};var E=function(){};x.bind=function(a,b){var c,d;if(w&&a.bind===w)return w.apply(a,h.call(arguments,1));if(!x.isFunction(a))throw new TypeError;return c=h.call(arguments,2),d=function(){if(!(this instanceof d))return a.apply(b,c.concat(h.call(arguments)));E.prototype=a.prototype;var e=new E;E.prototype=null;var f=a.apply(e,c.concat(h.call(arguments)));return Object(f)===f?f:e}},x.partial=function(a){var b=h.call(arguments,1);return function(){for(var c=0,d=b.slice(),e=0,f=d.length;f>e;e++)d[e]===x&&(d[e]=arguments[c++]);for(;c<arguments.length;)d.push(arguments[c++]);return a.apply(this,d)}},x.bindAll=function(a){var b=h.call(arguments,1);if(0===b.length)throw new Error("bindAll must be passed function names");return y(b,function(b){a[b]=x.bind(a[b],a)}),a},x.originalBindAll=x.bindAll,x.bindAll=function(a){var b,c=Array.prototype.slice.call(arguments,1),d=[];if(0==c.length){for(var e in a)b=a[e],!b||"function"!=typeof b||b.prototype&&0!=x.keys(b.prototype).length||d.push(e);x.originalBindAll.apply(x,[a].concat(d))}else x.originalBindAll.apply(x,arguments)},x.memoize=function(a,b){var c={};return b||(b=x.identity),function(){var d=b.apply(this,arguments);return x.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}},x.delay=function(a,b){var c=h.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)},x.defer=function(a){return x.delay.apply(x,[a,1].concat(h.call(arguments,1)))},x.throttle=function(a,b,c){var d,e,f,g=null,h=0;c||(c={});var i=function(){h=c.leading===!1?0:x.now(),g=null,f=a.apply(d,e),d=e=null};return function(){var j=x.now();h||c.leading!==!1||(h=j);var k=b-(j-h);return d=this,e=arguments,0>=k?(clearTimeout(g),g=null,h=j,f=a.apply(d,e),d=e=null):g||c.trailing===!1||(g=setTimeout(i,k)),f}},x.debounce=function(a,b,c){var d,e,f,g,h,i=function(){var j=x.now()-g;b>j?d=setTimeout(i,b-j):(d=null,c||(h=a.apply(f,e),f=e=null))};return function(){f=this,e=arguments,g=x.now();var j=c&&!d;return d||(d=setTimeout(i,b)),j&&(h=a.apply(f,e),f=e=null),h}},x.once=function(a){var b,c=!1;return function(){return c?b:(c=!0,b=a.apply(this,arguments),a=null,b)}},x.wrap=function(a,b){return x.partial(b,a)},x.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},x.after=function(a,b){return function(){return--a<1?b.apply(this,arguments):void 0}},x.keys=function(a){if(!x.isObject(a))return[];if(v)return v(a);var b=[];for(var c in a)x.has(a,c)&&b.push(c);return b},x.values=function(a){for(var b=x.keys(a),c=b.length,d=new Array(c),e=0;c>e;e++)d[e]=a[b[e]];return d},x.pairs=function(a){for(var b=x.keys(a),c=b.length,d=new Array(c),e=0;c>e;e++)d[e]=[b[e],a[b[e]]];return d},x.invert=function(a){for(var b={},c=x.keys(a),d=0,e=c.length;e>d;d++)b[a[c[d]]]=c[d];return b},x.functions=x.methods=function(a){var b=[];for(var c in a)x.isFunction(a[c])&&b.push(c);return b.sort()},x.extend=function(a){return y(h.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]}),a},x.pick=function(a){var b={},c=i.apply(d,h.call(arguments,1));return y(c,function(c){c in a&&(b[c]=a[c])}),b},x.omit=function(a){var b={},c=i.apply(d,h.call(arguments,1));for(var e in a)x.contains(c,e)||(b[e]=a[e]);return b},x.defaults=function(a){return y(h.call(arguments,1),function(b){if(b)for(var c in b)void 0===a[c]&&(a[c]=b[c])}),a},x.clone=function(a){return x.isObject(a)?x.isArray(a)?a.slice():x.extend({},a):a},x.tap=function(a,b){return b(a),a};var F=function(a,b,c,d){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof x&&(a=a._wrapped),b instanceof x&&(b=b._wrapped);var e=j.call(a);if(e!=j.call(b))return!1;switch(e){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var f=c.length;f--;)if(c[f]==a)return d[f]==b;var g=a.constructor,h=b.constructor;if(g!==h&&!(x.isFunction(g)&&g instanceof g&&x.isFunction(h)&&h instanceof h)&&"constructor"in a&&"constructor"in b)return!1;c.push(a),d.push(b);var i=0,k=!0;if("[object Array]"==e){if(i=a.length,k=i==b.length)for(;i--&&(k=F(a[i],b[i],c,d)););}else{for(var l in a)if(x.has(a,l)&&(i++,!(k=x.has(b,l)&&F(a[l],b[l],c,d))))break;if(k){for(l in b)if(x.has(b,l)&&!i--)break;k=!i}}return c.pop(),d.pop(),k};x.isEqual=function(a,b){return F(a,b,[],[])},x.isEmpty=function(a){if(null==a)return!0;if(x.isArray(a)||x.isString(a))return 0===a.length;for(var b in a)if(x.has(a,b))return!1;return!0},x.isElement=function(a){return!(!a||1!==a.nodeType)},x.isArray=u||function(a){return"[object Array]"==j.call(a)},x.isObject=function(a){return a===Object(a)},y(["Arguments","Function","String","Number","Date","RegExp"],function(a){x["is"+a]=function(b){return j.call(b)=="[object "+a+"]"}}),x.isArguments(arguments)||(x.isArguments=function(a){return!(!a||!x.has(a,"callee"))}),"function"!=typeof/./&&(x.isFunction=function(a){return"function"==typeof a}),x.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))},x.isNaN=function(a){return x.isNumber(a)&&a!=+a},x.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"==j.call(a)},x.isNull=function(a){return null===a},x.isUndefined=function(a){return void 0===a},x.has=function(a,b){return k.call(a,b)},x.noConflict=function(){return a._=b,this},x.identity=function(a){return a},x.constant=function(a){return function(){return a}},x.property=function(a){return function(b){return b[a]}},x.matches=function(a){return function(b){if(b===a)return!0;for(var c in a)if(a[c]!==b[c])return!1;return!0}},x.times=function(a,b,c){for(var d=Array(Math.max(0,a)),e=0;a>e;e++)d[e]=b.call(c,e);return d},x.random=function(a,b){return null==b&&(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))},x.now=Date.now||function(){return(new Date).getTime()};var G={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};G.unescape=x.invert(G.escape);var H={escape:new RegExp("["+x.keys(G.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(G.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(a){x[a]=function(b){return null==b?"":(""+b).replace(H[a],function(b){return G[a][b]})}}),x.result=function(a,b){if(null!=a){var c=a[b];return x.isFunction(c)?c.call(a):c}},x.mixin=function(a){y(x.functions(a),function(b){var c=x[b]=a[b];x.prototype[b]=function(){var a=[this._wrapped];return g.apply(a,arguments),M.call(this,c.apply(x,a))}})};var I=0;x.uniqueId=function(a){var b=++I+"";return a?a+b:b},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var J=/(.)^/,K={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},L=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(a,b,c){var d;c=x.defaults({},c,x.templateSettings);var e=new RegExp([(c.escape||J).source,(c.interpolate||J).source,(c.evaluate||J).source].join("|")+"|$","g"),f=0,g="__p+='";a.replace(e,function(b,c,d,e,h){return g+=a.slice(f,h).replace(L,function(a){return"\\"+K[a]}),c&&(g+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'"),d&&(g+="'+\n((__t=("+d+"))==null?'':__t)+\n'"),e&&(g+="';\n"+e+"\n__p+='"),f=h+b.length,b}),g+="';\n",c.variable||(g="with(obj||{}){\n"+g+"}\n"),g="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+g+"return __p;\n";try{d=new Function(c.variable||"obj","_",g)}catch(h){throw h.source=g,h}if(b)return d(b,x);var i=function(a){return d.call(this,a,x)};return i.source="function("+(c.variable||"obj")+"){\n"+g+"}",i},x.chain=function(a){return x(a).chain()};var M=function(a){return this._chain?x(a).chain():a};x.mixin(x),y(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=d[a];x.prototype[a]=function(){var c=this._wrapped;return b.apply(c,arguments),"shift"!=a&&"splice"!=a||0!==c.length||delete c[0],M.call(this,c)}}),y(["concat","join","slice"],function(a){var b=d[a];x.prototype[a]=function(){return M.call(this,b.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return x})}.call(this),function(a,b){if("function"==typeof define&&define.amd)define("bb",["underscore","jquery","exports"],function(c,d,e){a.Backbone=b(a,e,c,d)});else if("undefined"!=typeof exports){var c=require("underscore");b(a,exports,c)}else a.Backbone=b(a,{},a._,a.jQuery||a.Zepto||a.ender||a.$)}(this,function(a,b,c,d){var e=a.Backbone,f=[],g=(f.push,f.slice);f.splice;b.VERSION="1.1.2",b.$=d,b.noConflict=function(){return a.Backbone=e,this},b.emulateHTTP=!1,b.emulateJSON=!1;var h=b.Events={on:function(a,b,c){if(!j(this,"on",a,[b,c])||!b)return this;this._events||(this._events={});var d=this._events[a]||(this._events[a]=[]);return d.push({callback:b,context:c,ctx:c||this}),this},once:function(a,b,d){if(!j(this,"once",a,[b,d])||!b)return this;var e=this,f=c.once(function(){e.off(a,f),b.apply(this,arguments)});return f._callback=b,this.on(a,f,d)},off:function(a,b,d){var e,f,g,h,i,k,l,m;if(!this._events||!j(this,"off",a,[b,d]))return this;if(!a&&!b&&!d)return this._events=void 0,this;for(h=a?[a]:c.keys(this._events),i=0,k=h.length;k>i;i++)if(a=h[i],g=this._events[a]){if(this._events[a]=e=[],b||d)for(l=0,m=g.length;m>l;l++)f=g[l],(b&&b!==f.callback&&b!==f.callback._callback||d&&d!==f.context)&&e.push(f);e.length||delete this._events[a]}return this},trigger:function(a){if(!this._events)return this;var b=g.call(arguments,1);if(!j(this,"trigger",a,b))return this;var c=this._events[a],d=this._events.all;return c&&k(c,b),d&&k(d,arguments),this},stopListening:function(a,b,d){var e=this._listeningTo;if(!e)return this;var f=!b&&!d;d||"object"!=typeof b||(d=this),a&&((e={})[a._listenId]=a);for(var g in e)a=e[g],a.off(b,d,this),(f||c.isEmpty(a._events))&&delete this._listeningTo[g];return this}},i=/\s+/,j=function(a,b,c,d){if(!c)return!0;if("object"==typeof c){for(var e in c)a[b].apply(a,[e,c[e]].concat(d));return!1}if(i.test(c)){for(var f=c.split(i),g=0,h=f.length;h>g;g++)a[b].apply(a,[f[g]].concat(d));return!1}return!0},k=function(a,b){var c,d=-1,e=a.length,f=b[0],g=b[1],h=b[2];switch(b.length){case 0:for(;++d<e;)(c=a[d]).callback.call(c.ctx);return;case 1:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f);return;case 2:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g);return;case 3:for(;++d<e;)(c=a[d]).callback.call(c.ctx,f,g,h);return;default:for(;++d<e;)(c=a[d]).callback.apply(c.ctx,b);return}},l={listenTo:"on",listenToOnce:"once"};c.each(l,function(a,b){h[b]=function(b,d,e){var f=this._listeningTo||(this._listeningTo={}),g=b._listenId||(b._listenId=c.uniqueId("l"));return f[g]=b,e||"object"!=typeof d||(e=this),b[a](d,e,this),this}}),h.bind=h.on,h.unbind=h.off,c.extend(b,h);var m=b.Model=function(a,b){var d=a||{};b||(b={}),this.cid=c.uniqueId("c"),this.attributes={},b.collection&&(this.collection=b.collection),b.parse&&(d=this.parse(d,b)||{}),d=c.defaults({},d,c.result(this,"defaults")),this.set(d,b),this.changed={},this.initialize.apply(this,arguments)};c.extend(m.prototype,h,{changed:null,validationError:null,idAttribute:"id",initialize:function(){},toJSON:function(a){return c.clone(this.attributes)},sync:function(){return b.sync.apply(this,arguments)},get:function(a){return this.attributes[a]},escape:function(a){return c.escape(this.get(a))},has:function(a){return null!=this.get(a)},set:function(a,b,d){var e,f,g,h,i,j,k,l;if(null==a)return this;if("object"==typeof a?(f=a,d=b):(f={})[a]=b,d||(d={}),!this._validate(f,d))return!1;g=d.unset,i=d.silent,h=[],j=this._changing,this._changing=!0,j||(this._previousAttributes=c.clone(this.attributes),this.changed={}),l=this.attributes,k=this._previousAttributes,this.idAttribute in f&&(this.id=f[this.idAttribute]);for(e in f)b=f[e],c.isEqual(l[e],b)||h.push(e),c.isEqual(k[e],b)?delete this.changed[e]:this.changed[e]=b,g?delete l[e]:l[e]=b;if(!i){h.length&&(this._pending=d);for(var m=0,n=h.length;n>m;m++)this.trigger("change:"+h[m],this,l[h[m]],d)}if(j)return this;if(!i)for(;this._pending;)d=this._pending,this._pending=!1,this.trigger("change",this,d);return this._pending=!1,this._changing=!1,this},unset:function(a,b){return this.set(a,void 0,c.extend({},b,{unset:!0}))},clear:function(a){var b={};for(var d in this.attributes)b[d]=void 0;return this.set(b,c.extend({},a,{unset:!0}))},hasChanged:function(a){return null==a?!c.isEmpty(this.changed):c.has(this.changed,a)},changedAttributes:function(a){if(!a)return this.hasChanged()?c.clone(this.changed):!1;var b,d=!1,e=this._changing?this._previousAttributes:this.attributes;for(var f in a)c.isEqual(e[f],b=a[f])||((d||(d={}))[f]=b);return d},previous:function(a){return null!=a&&this._previousAttributes?this._previousAttributes[a]:null},previousAttributes:function(){return c.clone(this._previousAttributes)},fetch:function(a){a=a?c.clone(a):{},void 0===a.parse&&(a.parse=!0);var b=this,d=a.success;return a.success=function(c){return b.set(b.parse(c,a),a)?(d&&d(b,c,a),void b.trigger("sync",b,c,a)):!1},L(this,a),this.sync("read",this,a)},save:function(a,b,d){var e,f,g,h=this.attributes;if(null==a||"object"==typeof a?(e=a,d=b):(e={})[a]=b,d=c.extend({validate:!0},d),e&&!d.wait){if(!this.set(e,d))return!1}else if(!this._validate(e,d))return!1;e&&d.wait&&(this.attributes=c.extend({},h,e)),void 0===d.parse&&(d.parse=!0);var i=this,j=d.success;return d.success=function(a){i.attributes=h;var b=i.parse(a,d);return d.wait&&(b=c.extend(e||{},b)),c.isObject(b)&&!i.set(b,d)?!1:(j&&j(i,a,d),void i.trigger("sync",i,a,d))},L(this,d),f=this.isNew()?"create":d.patch?"patch":"update","patch"===f&&(d.attrs=e),g=this.sync(f,this,d),e&&d.wait&&(this.attributes=h),g},destroy:function(a){a=a?c.clone(a):{};var b=this,d=a.success,e=function(){b.trigger("destroy",b,b.collection,a)};if(a.success=function(c){(a.wait||b.isNew())&&e(),d&&d(b,c,a),b.isNew()||b.trigger("sync",b,c,a)},this.isNew())return a.success(),!1;L(this,a);var f=this.sync("delete",this,a);return a.wait||e(),f},url:function(){var a=c.result(this,"urlRoot")||c.result(this.collection,"url")||K();return this.isNew()?a:a.replace(/([^\/])$/,"$1/")+encodeURIComponent(this.id)},parse:function(a,b){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(a){return this._validate({},c.extend(a||{},{validate:!0}))},_validate:function(a,b){if(!b.validate||!this.validate)return!0;a=c.extend({},this.attributes,a);var d=this.validationError=this.validate(a,b)||null;return d?(this.trigger("invalid",this,d,c.extend(b,{validationError:d})),!1):!0}});var n=["keys","values","pairs","invert","pick","omit"];c.each(n,function(a){m.prototype[a]=function(){var b=g.call(arguments);return b.unshift(this.attributes),c[a].apply(c,b)}});var o=b.Collection=function(a,b){b||(b={}),b.model&&(this.model=b.model),void 0!==b.comparator&&(this.comparator=b.comparator),this._reset(),this.initialize.apply(this,arguments),a&&this.reset(a,c.extend({silent:!0},b))},p={add:!0,remove:!0,merge:!0},q={add:!0,remove:!1};c.extend(o.prototype,h,{model:m,initialize:function(){},toJSON:function(a){return this.map(function(b){return b.toJSON(a)})},sync:function(){return b.sync.apply(this,arguments)},add:function(a,b){return this.set(a,c.extend({merge:!1},b,q))},remove:function(a,b){var d=!c.isArray(a);a=d?[a]:c.clone(a),b||(b={});var e,f,g,h;for(e=0,f=a.length;f>e;e++)h=a[e]=this.get(a[e]),h&&(delete this._byId[h.id],delete this._byId[h.cid],g=this.indexOf(h),this.models.splice(g,1),this.length--,b.silent||(b.index=g,h.trigger("remove",h,this,b)),this._removeReference(h,b));return d?a[0]:a},set:function(a,b){b=c.defaults({},b,p),b.parse&&(a=this.parse(a,b));var d=!c.isArray(a);a=d?a?[a]:[]:c.clone(a);var e,f,g,h,i,j,k,l=b.at,n=this.model,o=this.comparator&&null==l&&b.sort!==!1,q=c.isString(this.comparator)?this.comparator:null,r=[],s=[],t={},u=b.add,v=b.merge,w=b.remove,x=!o&&u&&w?[]:!1;for(e=0,f=a.length;f>e;e++){if(i=a[e]||{},g=i instanceof m?h=i:i[n.prototype.idAttribute||"id"],j=this.get(g))w&&(t[j.cid]=!0),v&&(i=i===h?h.attributes:i,b.parse&&(i=j.parse(i,b)),j.set(i,b),o&&!k&&j.hasChanged(q)&&(k=!0)),a[e]=j;else if(u){if(h=a[e]=this._prepareModel(i,b),!h)continue;r.push(h),this._addReference(h,b)}h=j||h,!x||!h.isNew()&&t[h.id]||x.push(h),t[h.id]=!0}if(w){for(e=0,f=this.length;f>e;++e)t[(h=this.models[e]).cid]||s.push(h);s.length&&this.remove(s,b)}if(r.length||x&&x.length)if(o&&(k=!0),this.length+=r.length,null!=l)for(e=0,f=r.length;f>e;e++)this.models.splice(l+e,0,r[e]);else{x&&(this.models.length=0);var y=x||r;for(e=0,f=y.length;f>e;e++)this.models.push(y[e])}if(k&&this.sort({silent:!0}),!b.silent){for(e=0,f=r.length;f>e;e++)(h=r[e]).trigger("add",h,this,b);(k||x&&x.length)&&this.trigger("sort",this,b)}return d?a[0]:a},reset:function(a,b){b||(b={});for(var d=0,e=this.models.length;e>d;d++)this._removeReference(this.models[d],b);return b.previousModels=this.models,this._reset(),a=this.add(a,c.extend({silent:!0},b)),b.silent||this.trigger("reset",this,b),a},push:function(a,b){return this.add(a,c.extend({at:this.length},b))},pop:function(a){var b=this.at(this.length-1);return this.remove(b,a),b},unshift:function(a,b){return this.add(a,c.extend({at:0},b))},shift:function(a){var b=this.at(0);return this.remove(b,a),b},slice:function(){return g.apply(this.models,arguments)},get:function(a){return null!=a?this._byId[a]||this._byId[a.id]||this._byId[a.cid]:void 0},at:function(a){return this.models[a]},where:function(a,b){return c.isEmpty(a)?b?void 0:[]:this[b?"find":"filter"](function(b){for(var c in a)if(a[c]!==b.get(c))return!1;return!0})},findWhere:function(a){return this.where(a,!0)},sort:function(a){if(!this.comparator)throw new Error("Cannot sort a set without a comparator");return a||(a={}),c.isString(this.comparator)||1===this.comparator.length?this.models=this.sortBy(this.comparator,this):this.models.sort(c.bind(this.comparator,this)),a.silent||this.trigger("sort",this,a),this},pluck:function(a){return c.invoke(this.models,"get",a)},fetch:function(a){a=a?c.clone(a):{},void 0===a.parse&&(a.parse=!0);var b=a.success,d=this;return a.success=function(c){var e=a.reset?"reset":"set";d[e](c,a),b&&b(d,c,a),d.trigger("sync",d,c,a);
},L(this,a),this.sync("read",this,a)},create:function(a,b){if(b=b?c.clone(b):{},!(a=this._prepareModel(a,b)))return!1;b.wait||this.add(a,b);var d=this,e=b.success;return b.success=function(a,c){b.wait&&d.add(a,b),e&&e(a,c,b)},a.save(null,b),a},parse:function(a,b){return a},clone:function(){return new this.constructor(this.models)},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(a,b){if(a instanceof m)return a;b=b?c.clone(b):{},b.collection=this;var d=new this.model(a,b);return d.validationError?(this.trigger("invalid",this,d.validationError,b),!1):d},_addReference:function(a,b){this._byId[a.cid]=a,null!=a.id&&(this._byId[a.id]=a),a.collection||(a.collection=this),a.on("all",this._onModelEvent,this)},_removeReference:function(a,b){this===a.collection&&delete a.collection,a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,d){("add"!==a&&"remove"!==a||c===this)&&("destroy"===a&&this.remove(b,d),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],null!=b.id&&(this._byId[b.id]=b)),this.trigger.apply(this,arguments))}});var r=["forEach","each","map","collect","reduce","foldl","inject","reduceRight","foldr","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","toArray","size","first","head","take","initial","rest","tail","drop","last","without","difference","indexOf","shuffle","lastIndexOf","isEmpty","chain","sample"];c.each(r,function(a){o.prototype[a]=function(){var b=g.call(arguments);return b.unshift(this.models),c[a].apply(c,b)}});var s=["groupBy","countBy","sortBy","indexBy"];c.each(s,function(a){o.prototype[a]=function(b,d){var e=c.isFunction(b)?b:function(a){return a.get(b)};return c[a](this.models,e,d)}});var t=b.View=function(a){this.cid=c.uniqueId("view"),a||(a={}),c.extend(this,c.pick(a,v)),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()},u=/^(\S+)\s*(.*)$/,v=["model","collection","el","id","attributes","className","tagName","events"];c.extend(t.prototype,h,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this.stopListening(),this},setElement:function(a,c){return this.$el&&this.undelegateEvents(),this.$el=a instanceof b.$?a:b.$(a),this.el=this.$el[0],c!==!1&&this.delegateEvents(),this},delegateEvents:function(a){if(!a&&!(a=c.result(this,"events")))return this;this.undelegateEvents();for(var b in a){var d=a[b];if(c.isFunction(d)||(d=this[a[b]]),d){var e=b.match(u),f=e[1],g=e[2];d=c.bind(d,this),f+=".delegateEvents"+this.cid,""===g?this.$el.on(f,d):this.$el.on(f,g,d)}}return this},undelegateEvents:function(){return this.$el.off(".delegateEvents"+this.cid),this},_ensureElement:function(){if(this.el)this.setElement(c.result(this,"el"),!1);else{var a=c.extend({},c.result(this,"attributes"));this.id&&(a.id=c.result(this,"id")),this.className&&(a["class"]=c.result(this,"className"));var d=b.$("<"+c.result(this,"tagName")+">").attr(a);this.setElement(d,!1)}}}),b.sync=function(a,d,e){var f=x[a];c.defaults(e||(e={}),{emulateHTTP:b.emulateHTTP,emulateJSON:b.emulateJSON});var g={type:f,dataType:"json"};if(e.url||(g.url=c.result(d,"url")||K()),null!=e.data||!d||"create"!==a&&"update"!==a&&"patch"!==a||(g.contentType="application/json",g.data=JSON.stringify(e.attrs||d.toJSON(e))),e.emulateJSON&&(g.contentType="application/x-www-form-urlencoded",g.data=g.data?{model:g.data}:{}),e.emulateHTTP&&("PUT"===f||"DELETE"===f||"PATCH"===f)){g.type="POST",e.emulateJSON&&(g.data._method=f);var h=e.beforeSend;e.beforeSend=function(a){return a.setRequestHeader("X-HTTP-Method-Override",f),h?h.apply(this,arguments):void 0}}"GET"===g.type||e.emulateJSON||(g.processData=!1),"PATCH"===g.type&&w&&(g.xhr=function(){return new ActiveXObject("Microsoft.XMLHTTP")});var i=e.xhr=b.ajax(c.extend(g,e));return d.trigger("request",d,i,e),i};var w=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent),x={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};b.ajax=function(){return b.$.ajax.apply(b.$,arguments)};var y=b.Router=function(a){a||(a={}),a.routes&&(this.routes=a.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},z=/\((.*?)\)/g,A=/(\(\?)?:\w+/g,B=/\*\w+/g,C=/[\-{}\[\]+?.,\\\^$|#\s]/g;c.extend(y.prototype,h,{initialize:function(){},route:function(a,d,e){c.isRegExp(a)||(a=this._routeToRegExp(a)),c.isFunction(d)&&(e=d,d=""),e||(e=this[d]);var f=this;return b.history.route(a,function(c){var g=f._extractParameters(a,c);f.execute(e,g),f.trigger.apply(f,["route:"+d].concat(g)),f.trigger("route",d,g),b.history.trigger("route",f,d,g)}),this},execute:function(a,b){a&&a.apply(this,b)},navigate:function(a,c){return b.history.navigate(a,c),this},_bindRoutes:function(){if(this.routes){this.routes=c.result(this,"routes");for(var a,b=c.keys(this.routes);null!=(a=b.pop());)this.route(a,this.routes[a])}},_routeToRegExp:function(a){return a=a.replace(C,"\\$&").replace(z,"(?:$1)?").replace(A,function(a,b){return b?a:"([^/?]+)"}).replace(B,"([^?]*?)"),new RegExp("^"+a+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(a,b){var d=a.exec(b).slice(1);return c.map(d,function(a,b){return b===d.length-1?a||null:a?decodeURIComponent(a):null})}});var D=b.History=function(){this.handlers=[],c.bindAll(this,"checkUrl"),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},E=/^[#\/]|\s+$/g,F=/^\/+|\/+$/g,G=/msie [\w.]+/,H=/\/$/,I=/#.*$/;D.started=!1,c.extend(D.prototype,h,{interval:50,atRoot:function(){return this.location.pathname.replace(/[^\/]$/,"$&/")===this.root},getHash:function(a){var b=(a||this).location.href.match(/#(.*)$/);return b?b[1]:""},getFragment:function(a,b){if(null==a)if(this._hasPushState||!this._wantsHashChange||b){a=decodeURI(this.location.pathname+this.location.search);var c=this.root.replace(H,"");a.indexOf(c)||(a=a.slice(c.length))}else a=this.getHash();return a.replace(E,"")},start:function(a){if(D.started)throw new Error("Backbone.history has already been started");D.started=!0,this.options=c.extend({root:"/"},this.options,a),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&this.history&&this.history.pushState);var d=this.getFragment(),e=document.documentMode,f=G.exec(navigator.userAgent.toLowerCase())&&(!e||7>=e);if(this.root=("/"+this.root+"/").replace(F,"/"),f&&this._wantsHashChange){var g=b.$('<iframe src="javascript:0" tabindex="-1">');this.iframe=g.hide().appendTo("body")[0].contentWindow,this.navigate(d)}this._hasPushState?b.$(window).on("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!f?b.$(window).on("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=d;var h=this.location;if(this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot())return this.fragment=this.getFragment(null,!0),this.location.replace(this.root+"#"+this.fragment),!0;this._hasPushState&&this.atRoot()&&h.hash&&(this.fragment=this.getHash().replace(E,""),this.history.replaceState({},document.title,this.root+this.fragment))}return this.options.silent?void 0:this.loadUrl()},stop:function(){b.$(window).off("popstate",this.checkUrl).off("hashchange",this.checkUrl),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),D.started=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(a){var b=this.getFragment();return b===this.fragment&&this.iframe&&(b=this.getFragment(this.getHash(this.iframe))),b===this.fragment?!1:(this.iframe&&this.navigate(b),void this.loadUrl())},loadUrl:function(a){return a=this.fragment=this.getFragment(a),c.any(this.handlers,function(b){return b.route.test(a)?(b.callback(a),!0):void 0})},navigate:function(a,b){if(!D.started)return!1;b&&b!==!0||(b={trigger:!!b});var c=this.root+(a=this.getFragment(a||""));if(a=a.replace(I,""),this.fragment!==a){if(this.fragment=a,""===a&&"/"!==c&&(c=c.slice(0,-1)),this._hasPushState)this.history[b.replace?"replaceState":"pushState"]({},document.title,c);else{if(!this._wantsHashChange)return this.location.assign(c);this._updateHash(this.location,a,b.replace),this.iframe&&a!==this.getFragment(this.getHash(this.iframe))&&(b.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,a,b.replace))}return b.trigger?this.loadUrl(a):void 0}},_updateHash:function(a,b,c){if(c){var d=a.href.replace(/(javascript:|#).*$/,"");a.replace(d+"#"+b)}else a.hash="#"+b}}),b.history=new D;var J=function(a,b){var d,e=this;d=a&&c.has(a,"constructor")?a.constructor:function(){return e.apply(this,arguments)},c.extend(d,e,b);var f=function(){this.constructor=d};return f.prototype=e.prototype,d.prototype=new f,a&&c.extend(d.prototype,a),d.__super__=e.prototype,d};m.extend=o.extend=y.extend=t.extend=D.extend=J;var K=function(){throw new Error('A "url" property or function must be specified')},L=function(a,b){var c=b.error;b.error=function(d){c&&c(a,d,b),a.trigger("error",a,d,b)}};return b});var Handlebars=function(){var a=function(){function a(a){this.string=a}var b;return a.prototype.toString=function(){return""+this.string},b=a}(),b=function(a){function b(a){return h[a]||"&amp;"}function c(a,b){for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c])}function d(a){return a instanceof g?a.toString():a||0===a?(a=""+a,j.test(a)?a.replace(i,b):a):""}function e(a){return a||0===a?!(!m(a)||0!==a.length):!0}var f={},g=a,h={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},i=/[&<>"'`]/g,j=/[&<>"'`]/;f.extend=c;var k=Object.prototype.toString;f.toString=k;var l=function(a){return"function"==typeof a};l(/x/)&&(l=function(a){return"function"==typeof a&&"[object Function]"===k.call(a)});var l;f.isFunction=l;var m=Array.isArray||function(a){return a&&"object"==typeof a?"[object Array]"===k.call(a):!1};return f.isArray=m,f.escapeExpression=d,f.isEmpty=e,f}(a),c=function(){function a(a,b){var d;b&&b.firstLine&&(d=b.firstLine,a+=" - "+d+":"+b.firstColumn);for(var e=Error.prototype.constructor.call(this,a),f=0;f<c.length;f++)this[c[f]]=e[c[f]];d&&(this.lineNumber=d,this.column=b.firstColumn)}var b,c=["description","fileName","lineNumber","message","name","number","stack"];return a.prototype=new Error,b=a}(),d=function(a,b){function c(a,b){this.helpers=a||{},this.partials=b||{},d(this)}function d(a){a.registerHelper("helperMissing",function(a){if(2!==arguments.length)throw new h("Missing helper: '"+a+"'")}),a.registerHelper("blockHelperMissing",function(b,c){var d=c.inverse||function(){},e=c.fn;return m(b)&&(b=b.call(this)),b===!0?e(this):b===!1||null==b?d(this):l(b)?b.length>0?a.helpers.each(b,c):d(this):e(b)}),a.registerHelper("each",function(a,b){var c,d=b.fn,e=b.inverse,f=0,g="";if(m(a)&&(a=a.call(this)),b.data&&(c=q(b.data)),a&&"object"==typeof a)if(l(a))for(var h=a.length;h>f;f++)c&&(c.index=f,c.first=0===f,c.last=f===a.length-1),g+=d(a[f],{data:c});else for(var i in a)a.hasOwnProperty(i)&&(c&&(c.key=i,c.index=f,c.first=0===f),g+=d(a[i],{data:c}),f++);return 0===f&&(g=e(this)),g}),a.registerHelper("if",function(a,b){return m(a)&&(a=a.call(this)),!b.hash.includeZero&&!a||g.isEmpty(a)?b.inverse(this):b.fn(this)}),a.registerHelper("unless",function(b,c){return a.helpers["if"].call(this,b,{fn:c.inverse,inverse:c.fn,hash:c.hash})}),a.registerHelper("with",function(a,b){return m(a)&&(a=a.call(this)),g.isEmpty(a)?void 0:b.fn(a)}),a.registerHelper("log",function(b,c){var d=c.data&&null!=c.data.level?parseInt(c.data.level,10):1;a.log(d,b)})}function e(a,b){p.log(a,b)}var f={},g=a,h=b,i="1.3.0";f.VERSION=i;var j=4;f.COMPILER_REVISION=j;var k={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:">= 1.0.0"};f.REVISION_CHANGES=k;var l=g.isArray,m=g.isFunction,n=g.toString,o="[object Object]";f.HandlebarsEnvironment=c,c.prototype={constructor:c,logger:p,log:e,registerHelper:function(a,b,c){if(n.call(a)===o){if(c||b)throw new h("Arg not supported with multiple helpers");g.extend(this.helpers,a)}else c&&(b.not=c),this.helpers[a]=b},registerPartial:function(a,b){n.call(a)===o?g.extend(this.partials,a):this.partials[a]=b}};var p={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(a,b){if(p.level<=a){var c=p.methodMap[a];"undefined"!=typeof console&&console[c]&&console[c].call(console,b)}}};f.logger=p,f.log=e;var q=function(a){var b={};return g.extend(b,a),b};return f.createFrame=q,f}(b,c),e=function(a,b,c){function d(a){var b=a&&a[0]||1,c=m;if(b!==c){if(c>b){var d=n[c],e=n[b];throw new l("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+d+") or downgrade your runtime to an older version ("+e+").")}throw new l("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+a[1]+").")}}function e(a,b){if(!b)throw new l("No environment passed to template");var c=function(a,c,d,e,f,g){var h=b.VM.invokePartial.apply(this,arguments);if(null!=h)return h;if(b.compile){var i={helpers:e,partials:f,data:g};return f[c]=b.compile(a,{data:void 0!==g},b),f[c](d,i)}throw new l("The partial "+c+" could not be compiled when running in runtime-only mode")},d={escapeExpression:k.escapeExpression,invokePartial:c,programs:[],program:function(a,b,c){var d=this.programs[a];return c?d=g(a,b,c):d||(d=this.programs[a]=g(a,b)),d},merge:function(a,b){var c=a||b;return a&&b&&a!==b&&(c={},k.extend(c,b),k.extend(c,a)),c},programWithDepth:b.VM.programWithDepth,noop:b.VM.noop,compilerInfo:null};return function(c,e){e=e||{};var f,g,h=e.partial?e:b;e.partial||(f=e.helpers,g=e.partials);var i=a.call(d,h,c,f,g,e.data);return e.partial||b.VM.checkRevision(d.compilerInfo),i}}function f(a,b,c){var d=Array.prototype.slice.call(arguments,3),e=function(a,e){return e=e||{},b.apply(this,[a,e.data||c].concat(d))};return e.program=a,e.depth=d.length,e}function g(a,b,c){var d=function(a,d){return d=d||{},b(a,d.data||c)};return d.program=a,d.depth=0,d}function h(a,b,c,d,e,f){var g={partial:!0,helpers:d,partials:e,data:f};if(void 0===a)throw new l("The partial "+b+" could not be found");return a instanceof Function?a(c,g):void 0}function i(){return""}var j={},k=a,l=b,m=c.COMPILER_REVISION,n=c.REVISION_CHANGES;return j.checkRevision=d,j.template=e,j.programWithDepth=f,j.program=g,j.invokePartial=h,j.noop=i,j}(b,c,d),f=function(a,b,c,d,e){var f,g=a,h=b,i=c,j=d,k=e,l=function(){var a=new g.HandlebarsEnvironment;return j.extend(a,g),a.SafeString=h,a.Exception=i,a.Utils=j,a.VM=k,a.template=function(b){return k.template(b,a)},a},m=l();return m.create=l,f=m}(d,a,c,b,e),g=function(a){function b(a){a=a||{},this.firstLine=a.first_line,this.firstColumn=a.first_column,this.lastColumn=a.last_column,this.lastLine=a.last_line}var c,d=a,e={ProgramNode:function(a,c,d,f){var g,h;3===arguments.length?(f=d,d=null):2===arguments.length&&(f=c,c=null),b.call(this,f),this.type="program",this.statements=a,this.strip={},d?(h=d[0],h?(g={first_line:h.firstLine,last_line:h.lastLine,last_column:h.lastColumn,first_column:h.firstColumn},this.inverse=new e.ProgramNode(d,c,g)):this.inverse=new e.ProgramNode(d,c),this.strip.right=c.left):c&&(this.strip.left=c.right)},MustacheNode:function(a,c,d,f,g){if(b.call(this,g),this.type="mustache",this.strip=f,null!=d&&d.charAt){var h=d.charAt(3)||d.charAt(2);this.escaped="{"!==h&&"&"!==h}else this.escaped=!!d;a instanceof e.SexprNode?this.sexpr=a:this.sexpr=new e.SexprNode(a,c),this.sexpr.isRoot=!0,this.id=this.sexpr.id,this.params=this.sexpr.params,this.hash=this.sexpr.hash,this.eligibleHelper=this.sexpr.eligibleHelper,this.isHelper=this.sexpr.isHelper},SexprNode:function(a,c,d){b.call(this,d),this.type="sexpr",this.hash=c;var e=this.id=a[0],f=this.params=a.slice(1),g=this.eligibleHelper=e.isSimple;this.isHelper=g&&(f.length||c)},PartialNode:function(a,c,d,e){b.call(this,e),this.type="partial",this.partialName=a,this.context=c,this.strip=d},BlockNode:function(a,c,e,f,g){if(b.call(this,g),a.sexpr.id.original!==f.path.original)throw new d(a.sexpr.id.original+" doesn't match "+f.path.original,this);this.type="block",this.mustache=a,this.program=c,this.inverse=e,this.strip={left:a.strip.left,right:f.strip.right},(c||e).strip.left=a.strip.right,(e||c).strip.right=f.strip.left,e&&!c&&(this.isInverse=!0)},ContentNode:function(a,c){b.call(this,c),this.type="content",this.string=a},HashNode:function(a,c){b.call(this,c),this.type="hash",this.pairs=a},IdNode:function(a,c){b.call(this,c),this.type="ID";for(var e="",f=[],g=0,h=0,i=a.length;i>h;h++){var j=a[h].part;if(e+=(a[h].separator||"")+j,".."===j||"."===j||"this"===j){if(f.length>0)throw new d("Invalid path: "+e,this);".."===j?g++:this.isScoped=!0}else f.push(j)}this.original=e,this.parts=f,this.string=f.join("."),this.depth=g,this.isSimple=1===a.length&&!this.isScoped&&0===g,this.stringModeValue=this.string},PartialNameNode:function(a,c){b.call(this,c),this.type="PARTIAL_NAME",this.name=a.original},DataNode:function(a,c){b.call(this,c),this.type="DATA",this.id=a},StringNode:function(a,c){b.call(this,c),this.type="STRING",this.original=this.string=this.stringModeValue=a},IntegerNode:function(a,c){b.call(this,c),this.type="INTEGER",this.original=this.integer=a,this.stringModeValue=Number(a)},BooleanNode:function(a,c){b.call(this,c),this.type="BOOLEAN",this.bool=a,this.stringModeValue="true"===a},CommentNode:function(a,c){b.call(this,c),this.type="comment",this.comment=a}};return c=e}(c),h=function(){var a,b=function(){function a(a,b){return{left:"~"===a.charAt(2),right:"~"===b.charAt(0)||"~"===b.charAt(1)}}function b(){this.yy={}}var c={trace:function(){},yy:{},symbols_:{error:2,root:3,statements:4,EOF:5,program:6,simpleInverse:7,statement:8,openInverse:9,closeBlock:10,openBlock:11,mustache:12,partial:13,CONTENT:14,COMMENT:15,OPEN_BLOCK:16,sexpr:17,CLOSE:18,OPEN_INVERSE:19,OPEN_ENDBLOCK:20,path:21,OPEN:22,OPEN_UNESCAPED:23,CLOSE_UNESCAPED:24,OPEN_PARTIAL:25,partialName:26,partial_option0:27,sexpr_repetition0:28,sexpr_option0:29,dataName:30,param:31,STRING:32,INTEGER:33,BOOLEAN:34,OPEN_SEXPR:35,CLOSE_SEXPR:36,hash:37,hash_repetition_plus0:38,hashSegment:39,ID:40,EQUALS:41,DATA:42,pathSegments:43,SEP:44,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"CONTENT",15:"COMMENT",16:"OPEN_BLOCK",18:"CLOSE",19:"OPEN_INVERSE",20:"OPEN_ENDBLOCK",22:"OPEN",23:"OPEN_UNESCAPED",24:"CLOSE_UNESCAPED",25:"OPEN_PARTIAL",32:"STRING",33:"INTEGER",34:"BOOLEAN",35:"OPEN_SEXPR",36:"CLOSE_SEXPR",40:"ID",41:"EQUALS",42:"DATA",44:"SEP"},productions_:[0,[3,2],[3,1],[6,2],[6,3],[6,2],[6,1],[6,1],[6,0],[4,1],[4,2],[8,3],[8,3],[8,1],[8,1],[8,1],[8,1],[11,3],[9,3],[10,3],[12,3],[12,3],[13,4],[7,2],[17,3],[17,1],[31,1],[31,1],[31,1],[31,1],[31,1],[31,3],[37,1],[39,3],[26,1],[26,1],[26,1],[30,2],[21,1],[43,3],[43,1],[27,0],[27,1],[28,0],[28,2],[29,0],[29,1],[38,1],[38,2]],performAction:function(b,c,d,e,f,g,h){var i=g.length-1;switch(f){case 1:return new e.ProgramNode(g[i-1],this._$);case 2:return new e.ProgramNode([],this._$);case 3:this.$=new e.ProgramNode([],g[i-1],g[i],this._$);break;case 4:this.$=new e.ProgramNode(g[i-2],g[i-1],g[i],this._$);break;case 5:this.$=new e.ProgramNode(g[i-1],g[i],[],this._$);break;case 6:this.$=new e.ProgramNode(g[i],this._$);break;case 7:this.$=new e.ProgramNode([],this._$);break;case 8:this.$=new e.ProgramNode([],this._$);break;case 9:this.$=[g[i]];break;case 10:g[i-1].push(g[i]),this.$=g[i-1];break;case 11:this.$=new e.BlockNode(g[i-2],g[i-1].inverse,g[i-1],g[i],this._$);break;case 12:this.$=new e.BlockNode(g[i-2],g[i-1],g[i-1].inverse,g[i],this._$);break;case 13:this.$=g[i];break;case 14:this.$=g[i];break;case 15:this.$=new e.ContentNode(g[i],this._$);break;case 16:this.$=new e.CommentNode(g[i],this._$);break;case 17:this.$=new e.MustacheNode(g[i-1],null,g[i-2],a(g[i-2],g[i]),this._$);break;case 18:this.$=new e.MustacheNode(g[i-1],null,g[i-2],a(g[i-2],g[i]),this._$);break;case 19:this.$={path:g[i-1],strip:a(g[i-2],g[i])};break;case 20:this.$=new e.MustacheNode(g[i-1],null,g[i-2],a(g[i-2],g[i]),this._$);break;case 21:this.$=new e.MustacheNode(g[i-1],null,g[i-2],a(g[i-2],g[i]),this._$);break;case 22:this.$=new e.PartialNode(g[i-2],g[i-1],a(g[i-3],g[i]),this._$);break;case 23:this.$=a(g[i-1],g[i]);break;case 24:this.$=new e.SexprNode([g[i-2]].concat(g[i-1]),g[i],this._$);break;case 25:this.$=new e.SexprNode([g[i]],null,this._$);break;case 26:this.$=g[i];break;case 27:this.$=new e.StringNode(g[i],this._$);break;case 28:this.$=new e.IntegerNode(g[i],this._$);break;case 29:this.$=new e.BooleanNode(g[i],this._$);break;case 30:this.$=g[i];break;case 31:g[i-1].isHelper=!0,this.$=g[i-1];break;case 32:this.$=new e.HashNode(g[i],this._$);break;case 33:this.$=[g[i-2],g[i]];break;case 34:this.$=new e.PartialNameNode(g[i],this._$);break;case 35:this.$=new e.PartialNameNode(new e.StringNode(g[i],this._$),this._$);break;case 36:this.$=new e.PartialNameNode(new e.IntegerNode(g[i],this._$));break;case 37:this.$=new e.DataNode(g[i],this._$);break;case 38:this.$=new e.IdNode(g[i],this._$);break;case 39:g[i-2].push({part:g[i],separator:g[i-1]}),this.$=g[i-2];break;case 40:this.$=[{part:g[i]}];break;case 43:this.$=[];break;case 44:g[i-1].push(g[i]);break;case 47:this.$=[g[i]];break;case 48:g[i-1].push(g[i])}},table:[{3:1,4:2,5:[1,3],8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],25:[1,15]},{1:[3]},{5:[1,16],8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],25:[1,15]},{1:[2,2]},{5:[2,9],14:[2,9],15:[2,9],16:[2,9],19:[2,9],20:[2,9],22:[2,9],23:[2,9],25:[2,9]},{4:20,6:18,7:19,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,8],22:[1,13],23:[1,14],25:[1,15]},{4:20,6:22,7:19,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,8],22:[1,13],23:[1,14],25:[1,15]},{5:[2,13],14:[2,13],15:[2,13],16:[2,13],19:[2,13],20:[2,13],22:[2,13],23:[2,13],25:[2,13]},{5:[2,14],14:[2,14],15:[2,14],16:[2,14],19:[2,14],20:[2,14],22:[2,14],23:[2,14],25:[2,14]},{5:[2,15],14:[2,15],15:[2,15],16:[2,15],19:[2,15],20:[2,15],22:[2,15],23:[2,15],25:[2,15]},{5:[2,16],14:[2,16],15:[2,16],16:[2,16],19:[2,16],20:[2,16],22:[2,16],23:[2,16],25:[2,16]},{17:23,21:24,30:25,40:[1,28],42:[1,27],43:26},{17:29,21:24,30:25,40:[1,28],42:[1,27],43:26},{17:30,21:24,30:25,40:[1,28],42:[1,27],43:26},{17:31,21:24,30:25,40:[1,28],42:[1,27],43:26},{21:33,26:32,32:[1,34],33:[1,35],40:[1,28],43:26},{1:[2,1]},{5:[2,10],14:[2,10],15:[2,10],16:[2,10],19:[2,10],20:[2,10],22:[2,10],23:[2,10],25:[2,10]},{10:36,20:[1,37]},{4:38,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,7],22:[1,13],23:[1,14],25:[1,15]},{7:39,8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,6],22:[1,13],23:[1,14],25:[1,15]},{17:23,18:[1,40],21:24,30:25,40:[1,28],42:[1,27],43:26},{10:41,20:[1,37]},{18:[1,42]},{18:[2,43],24:[2,43],28:43,32:[2,43],33:[2,43],34:[2,43],35:[2,43],36:[2,43],40:[2,43],42:[2,43]},{18:[2,25],24:[2,25],36:[2,25]},{18:[2,38],24:[2,38],32:[2,38],33:[2,38],34:[2,38],35:[2,38],36:[2,38],40:[2,38],42:[2,38],44:[1,44]},{21:45,40:[1,28],43:26},{18:[2,40],24:[2,40],32:[2,40],33:[2,40],34:[2,40],35:[2,40],36:[2,40],40:[2,40],42:[2,40],44:[2,40]},{18:[1,46]},{18:[1,47]},{24:[1,48]},{18:[2,41],21:50,27:49,40:[1,28],43:26},{18:[2,34],40:[2,34]},{18:[2,35],40:[2,35]},{18:[2,36],40:[2,36]},{5:[2,11],14:[2,11],15:[2,11],16:[2,11],19:[2,11],20:[2,11],22:[2,11],23:[2,11],25:[2,11]},{21:51,40:[1,28],43:26},{8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,3],22:[1,13],23:[1,14],25:[1,15]},{4:52,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,5],22:[1,13],23:[1,14],25:[1,15]},{14:[2,23],15:[2,23],16:[2,23],19:[2,23],20:[2,23],22:[2,23],23:[2,23],25:[2,23]},{5:[2,12],14:[2,12],15:[2,12],16:[2,12],19:[2,12],20:[2,12],22:[2,12],23:[2,12],25:[2,12]},{14:[2,18],15:[2,18],16:[2,18],19:[2,18],20:[2,18],22:[2,18],23:[2,18],25:[2,18]},{18:[2,45],21:56,24:[2,45],29:53,30:60,31:54,32:[1,57],33:[1,58],34:[1,59],35:[1,61],36:[2,45],37:55,38:62,39:63,40:[1,64],42:[1,27],43:26},{40:[1,65]},{18:[2,37],24:[2,37],32:[2,37],33:[2,37],34:[2,37],35:[2,37],36:[2,37],40:[2,37],42:[2,37]},{14:[2,17],15:[2,17],16:[2,17],19:[2,17],20:[2,17],22:[2,17],23:[2,17],25:[2,17]},{5:[2,20],14:[2,20],15:[2,20],16:[2,20],19:[2,20],20:[2,20],22:[2,20],23:[2,20],25:[2,20]},{5:[2,21],14:[2,21],15:[2,21],16:[2,21],19:[2,21],20:[2,21],22:[2,21],23:[2,21],25:[2,21]},{18:[1,66]},{18:[2,42]},{18:[1,67]},{8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,4],22:[1,13],23:[1,14],25:[1,15]},{18:[2,24],24:[2,24],36:[2,24]},{18:[2,44],24:[2,44],32:[2,44],33:[2,44],34:[2,44],35:[2,44],36:[2,44],40:[2,44],42:[2,44]},{18:[2,46],24:[2,46],36:[2,46]},{18:[2,26],24:[2,26],32:[2,26],33:[2,26],34:[2,26],35:[2,26],36:[2,26],40:[2,26],42:[2,26]},{18:[2,27],24:[2,27],32:[2,27],33:[2,27],34:[2,27],35:[2,27],36:[2,27],40:[2,27],42:[2,27]},{18:[2,28],24:[2,28],32:[2,28],33:[2,28],34:[2,28],35:[2,28],36:[2,28],40:[2,28],42:[2,28]},{18:[2,29],24:[2,29],32:[2,29],33:[2,29],34:[2,29],35:[2,29],36:[2,29],40:[2,29],42:[2,29]},{18:[2,30],24:[2,30],32:[2,30],33:[2,30],34:[2,30],35:[2,30],36:[2,30],40:[2,30],42:[2,30]},{17:68,21:24,30:25,40:[1,28],42:[1,27],43:26},{18:[2,32],24:[2,32],36:[2,32],39:69,40:[1,70]},{18:[2,47],24:[2,47],36:[2,47],40:[2,47]},{18:[2,40],24:[2,40],32:[2,40],33:[2,40],34:[2,40],35:[2,40],36:[2,40],40:[2,40],41:[1,71],42:[2,40],44:[2,40]},{18:[2,39],24:[2,39],32:[2,39],33:[2,39],34:[2,39],35:[2,39],36:[2,39],40:[2,39],42:[2,39],44:[2,39]},{5:[2,22],14:[2,22],15:[2,22],16:[2,22],19:[2,22],20:[2,22],22:[2,22],23:[2,22],25:[2,22]},{5:[2,19],14:[2,19],15:[2,19],16:[2,19],19:[2,19],20:[2,19],22:[2,19],23:[2,19],25:[2,19]},{36:[1,72]},{18:[2,48],24:[2,48],36:[2,48],40:[2,48]},{41:[1,71]},{21:56,30:60,31:73,32:[1,57],33:[1,58],34:[1,59],35:[1,61],40:[1,28],42:[1,27],43:26},{18:[2,31],24:[2,31],32:[2,31],33:[2,31],34:[2,31],35:[2,31],36:[2,31],40:[2,31],42:[2,31]},{18:[2,33],24:[2,33],36:[2,33],40:[2,33]}],defaultActions:{3:[2,2],16:[2,1],50:[2,42]},parseError:function(a,b){throw new Error(a)},parse:function(a){function b(){var a;return a=c.lexer.lex()||1,"number"!=typeof a&&(a=c.symbols_[a]||a),a}var c=this,d=[0],e=[null],f=[],g=this.table,h="",i=0,j=0,k=0;this.lexer.setInput(a),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});var l=this.lexer.yylloc;f.push(l);var m=this.lexer.options&&this.lexer.options.ranges;"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var n,o,p,q,r,s,t,u,v,w={};;){if(p=d[d.length-1],this.defaultActions[p]?q=this.defaultActions[p]:(null!==n&&"undefined"!=typeof n||(n=b()),q=g[p]&&g[p][n]),"undefined"==typeof q||!q.length||!q[0]){var x="";if(!k){v=[];for(s in g[p])this.terminals_[s]&&s>2&&v.push("'"+this.terminals_[s]+"'");x=this.lexer.showPosition?"Parse error on line "+(i+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+v.join(", ")+", got '"+(this.terminals_[n]||n)+"'":"Parse error on line "+(i+1)+": Unexpected "+(1==n?"end of input":"'"+(this.terminals_[n]||n)+"'"),this.parseError(x,{text:this.lexer.match,token:this.terminals_[n]||n,line:this.lexer.yylineno,loc:l,expected:v})}}if(q[0]instanceof Array&&q.length>1)throw new Error("Parse Error: multiple actions possible at state: "+p+", token: "+n);switch(q[0]){case 1:d.push(n),e.push(this.lexer.yytext),f.push(this.lexer.yylloc),d.push(q[1]),n=null,o?(n=o,o=null):(j=this.lexer.yyleng,h=this.lexer.yytext,i=this.lexer.yylineno,l=this.lexer.yylloc,k>0&&k--);break;case 2:if(t=this.productions_[q[1]][1],w.$=e[e.length-t],w._$={first_line:f[f.length-(t||1)].first_line,last_line:f[f.length-1].last_line,first_column:f[f.length-(t||1)].first_column,last_column:f[f.length-1].last_column},m&&(w._$.range=[f[f.length-(t||1)].range[0],f[f.length-1].range[1]]),r=this.performAction.call(w,h,j,i,this.yy,q[1],e,f),"undefined"!=typeof r)return r;t&&(d=d.slice(0,-1*t*2),e=e.slice(0,-1*t),f=f.slice(0,-1*t)),d.push(this.productions_[q[1]][0]),e.push(w.$),f.push(w._$),u=g[d[d.length-2]][d[d.length-1]],d.push(u);break;case 3:return!0}}return!0}},d=function(){var a={EOF:1,parseError:function(a,b){if(!this.yy.parser)throw new Error(a);this.yy.parser.parseError(a,b)},setInput:function(a){return this._input=a,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var a=this._input[0];this.yytext+=a,this.yyleng++,this.offset++,this.match+=a,this.matched+=a;var b=a.match(/(?:\r\n?|\n).*/g);return b?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),a},unput:function(a){var b=a.length,c=a.split(/(?:\r\n?|\n)/g);this._input=a+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-b-1),this.offset-=b;var d=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),c.length-1&&(this.yylineno-=c.length-1);var e=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:c?(c.length===d.length?this.yylloc.first_column:0)+d[d.length-c.length].length-c[0].length:this.yylloc.first_column-b},this.options.ranges&&(this.yylloc.range=[e[0],e[0]+this.yyleng-b]),this},more:function(){return this._more=!0,this},less:function(a){this.unput(this.match.slice(a))},pastInput:function(){var a=this.matched.substr(0,this.matched.length-this.match.length);return(a.length>20?"...":"")+a.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var a=this.match;return a.length<20&&(a+=this._input.substr(0,20-a.length)),(a.substr(0,20)+(a.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var a=this.pastInput(),b=new Array(a.length+1).join("-");return a+this.upcomingInput()+"\n"+b+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var a,b,c,d,e;this._more||(this.yytext="",this.match="");for(var f=this._currentRules(),g=0;g<f.length&&(c=this._input.match(this.rules[f[g]]),!c||b&&!(c[0].length>b[0].length)||(b=c,d=g,this.options.flex));g++);return b?(e=b[0].match(/(?:\r\n?|\n).*/g),e&&(this.yylineno+=e.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:e?e[e.length-1].length-e[e.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+b[0].length},this.yytext+=b[0],this.match+=b[0],this.matches=b,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(b[0].length),this.matched+=b[0],a=this.performAction.call(this,this.yy,this,f[d],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),a?a:void 0):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var a=this.next();return"undefined"!=typeof a?a:this.lex()},begin:function(a){this.conditionStack.push(a)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(a){this.begin(a)}};return a.options={},a.performAction=function(a,b,c,d){function e(a,c){return b.yytext=b.yytext.substr(a,b.yyleng-c)}switch(c){case 0:if("\\\\"===b.yytext.slice(-2)?(e(0,1),
this.begin("mu")):"\\"===b.yytext.slice(-1)?(e(0,1),this.begin("emu")):this.begin("mu"),b.yytext)return 14;break;case 1:return 14;case 2:return this.popState(),14;case 3:return e(0,4),this.popState(),15;case 4:return 35;case 5:return 36;case 6:return 25;case 7:return 16;case 8:return 20;case 9:return 19;case 10:return 19;case 11:return 23;case 12:return 22;case 13:this.popState(),this.begin("com");break;case 14:return e(3,5),this.popState(),15;case 15:return 22;case 16:return 41;case 17:return 40;case 18:return 40;case 19:return 44;case 20:break;case 21:return this.popState(),24;case 22:return this.popState(),18;case 23:return b.yytext=e(1,2).replace(/\\"/g,'"'),32;case 24:return b.yytext=e(1,2).replace(/\\'/g,"'"),32;case 25:return 42;case 26:return 34;case 27:return 34;case 28:return 33;case 29:return 40;case 30:return b.yytext=e(1,2),40;case 31:return"INVALID";case 32:return 5}},a.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:[\s\S]*?--\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{!--)/,/^(?:\{\{![\s\S]*?\}\})/,/^(?:\{\{(~)?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:-?[0-9]+(?=([~}\s)])))/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)]))))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:$)/],a.conditions={mu:{rules:[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32],inclusive:!1},emu:{rules:[2],inclusive:!1},com:{rules:[3],inclusive:!1},INITIAL:{rules:[0,1,32],inclusive:!0}},a}();return c.lexer=d,b.prototype=c,c.Parser=b,new b}();return a=b}(),i=function(a,b){function c(a){return a.constructor===f.ProgramNode?a:(e.yy=f,e.parse(a))}var d={},e=a,f=b;return d.parser=e,d.parse=c,d}(h,g),j=function(a){function b(){}function c(a,b,c){if(null==a||"string"!=typeof a&&a.constructor!==c.AST.ProgramNode)throw new f("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+a);b=b||{},"data"in b||(b.data=!0);var d=c.parse(a),e=(new c.Compiler).compile(d,b);return(new c.JavaScriptCompiler).compile(e,b)}function d(a,b,c){function d(){var d=c.parse(a),e=(new c.Compiler).compile(d,b),f=(new c.JavaScriptCompiler).compile(e,b,void 0,!0);return c.template(f)}if(null==a||"string"!=typeof a&&a.constructor!==c.AST.ProgramNode)throw new f("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+a);b=b||{},"data"in b||(b.data=!0);var e;return function(a,b){return e||(e=d()),e.call(this,a,b)}}var e={},f=a;return e.Compiler=b,b.prototype={compiler:b,disassemble:function(){for(var a,b,c,d=this.opcodes,e=[],f=0,g=d.length;g>f;f++)if(a=d[f],"DECLARE"===a.opcode)e.push("DECLARE "+a.name+"="+a.value);else{b=[];for(var h=0;h<a.args.length;h++)c=a.args[h],"string"==typeof c&&(c='"'+c.replace("\n","\\n")+'"'),b.push(c);e.push(a.opcode+" "+b.join(" "))}return e.join("\n")},equals:function(a){var b=this.opcodes.length;if(a.opcodes.length!==b)return!1;for(var c=0;b>c;c++){var d=this.opcodes[c],e=a.opcodes[c];if(d.opcode!==e.opcode||d.args.length!==e.args.length)return!1;for(var f=0;f<d.args.length;f++)if(d.args[f]!==e.args[f])return!1}if(b=this.children.length,a.children.length!==b)return!1;for(c=0;b>c;c++)if(!this.children[c].equals(a.children[c]))return!1;return!0},guid:0,compile:function(a,b){this.opcodes=[],this.children=[],this.depths={list:[]},this.options=b;var c=this.options.knownHelpers;if(this.options.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,"if":!0,unless:!0,"with":!0,log:!0},c)for(var d in c)this.options.knownHelpers[d]=c[d];return this.accept(a)},accept:function(a){var b,c=a.strip||{};return c.left&&this.opcode("strip"),b=this[a.type](a),c.right&&this.opcode("strip"),b},program:function(a){for(var b=a.statements,c=0,d=b.length;d>c;c++)this.accept(b[c]);return this.isSimple=1===d,this.depths.list=this.depths.list.sort(function(a,b){return a-b}),this},compileProgram:function(a){var b,c=(new this.compiler).compile(a,this.options),d=this.guid++;this.usePartial=this.usePartial||c.usePartial,this.children[d]=c;for(var e=0,f=c.depths.list.length;f>e;e++)b=c.depths.list[e],2>b||this.addDepth(b-1);return d},block:function(a){var b=a.mustache,c=a.program,d=a.inverse;c&&(c=this.compileProgram(c)),d&&(d=this.compileProgram(d));var e=b.sexpr,f=this.classifySexpr(e);"helper"===f?this.helperSexpr(e,c,d):"simple"===f?(this.simpleSexpr(e),this.opcode("pushProgram",c),this.opcode("pushProgram",d),this.opcode("emptyHash"),this.opcode("blockValue")):(this.ambiguousSexpr(e,c,d),this.opcode("pushProgram",c),this.opcode("pushProgram",d),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},hash:function(a){var b,c,d=a.pairs;this.opcode("pushHash");for(var e=0,f=d.length;f>e;e++)b=d[e],c=b[1],this.options.stringParams?(c.depth&&this.addDepth(c.depth),this.opcode("getContext",c.depth||0),this.opcode("pushStringParam",c.stringModeValue,c.type),"sexpr"===c.type&&this.sexpr(c)):this.accept(c),this.opcode("assignToHash",b[0]);this.opcode("popHash")},partial:function(a){var b=a.partialName;this.usePartial=!0,a.context?this.ID(a.context):this.opcode("push","depth0"),this.opcode("invokePartial",b.name),this.opcode("append")},content:function(a){this.opcode("appendContent",a.string)},mustache:function(a){this.sexpr(a.sexpr),a.escaped&&!this.options.noEscape?this.opcode("appendEscaped"):this.opcode("append")},ambiguousSexpr:function(a,b,c){var d=a.id,e=d.parts[0],f=null!=b||null!=c;this.opcode("getContext",d.depth),this.opcode("pushProgram",b),this.opcode("pushProgram",c),this.opcode("invokeAmbiguous",e,f)},simpleSexpr:function(a){var b=a.id;"DATA"===b.type?this.DATA(b):b.parts.length?this.ID(b):(this.addDepth(b.depth),this.opcode("getContext",b.depth),this.opcode("pushContext")),this.opcode("resolvePossibleLambda")},helperSexpr:function(a,b,c){var d=this.setupFullMustacheParams(a,b,c),e=a.id.parts[0];if(this.options.knownHelpers[e])this.opcode("invokeKnownHelper",d.length,e);else{if(this.options.knownHelpersOnly)throw new f("You specified knownHelpersOnly, but used the unknown helper "+e,a);this.opcode("invokeHelper",d.length,e,a.isRoot)}},sexpr:function(a){var b=this.classifySexpr(a);"simple"===b?this.simpleSexpr(a):"helper"===b?this.helperSexpr(a):this.ambiguousSexpr(a)},ID:function(a){this.addDepth(a.depth),this.opcode("getContext",a.depth);var b=a.parts[0];b?this.opcode("lookupOnContext",a.parts[0]):this.opcode("pushContext");for(var c=1,d=a.parts.length;d>c;c++)this.opcode("lookup",a.parts[c])},DATA:function(a){if(this.options.data=!0,a.id.isScoped||a.id.depth)throw new f("Scoped data references are not supported: "+a.original,a);this.opcode("lookupData");for(var b=a.id.parts,c=0,d=b.length;d>c;c++)this.opcode("lookup",b[c])},STRING:function(a){this.opcode("pushString",a.string)},INTEGER:function(a){this.opcode("pushLiteral",a.integer)},BOOLEAN:function(a){this.opcode("pushLiteral",a.bool)},comment:function(){},opcode:function(a){this.opcodes.push({opcode:a,args:[].slice.call(arguments,1)})},declare:function(a,b){this.opcodes.push({opcode:"DECLARE",name:a,value:b})},addDepth:function(a){0!==a&&(this.depths[a]||(this.depths[a]=!0,this.depths.list.push(a)))},classifySexpr:function(a){var b=a.isHelper,c=a.eligibleHelper,d=this.options;if(c&&!b){var e=a.id.parts[0];d.knownHelpers[e]?b=!0:d.knownHelpersOnly&&(c=!1)}return b?"helper":c?"ambiguous":"simple"},pushParams:function(a){for(var b,c=a.length;c--;)b=a[c],this.options.stringParams?(b.depth&&this.addDepth(b.depth),this.opcode("getContext",b.depth||0),this.opcode("pushStringParam",b.stringModeValue,b.type),"sexpr"===b.type&&this.sexpr(b)):this[b.type](b)},setupFullMustacheParams:function(a,b,c){var d=a.params;return this.pushParams(d),this.opcode("pushProgram",b),this.opcode("pushProgram",c),a.hash?this.hash(a.hash):this.opcode("emptyHash"),d}},e.precompile=c,e.compile=d,e}(c),k=function(a,b){function c(a){this.value=a}function d(){}var e,f=a.COMPILER_REVISION,g=a.REVISION_CHANGES,h=a.log,i=b;d.prototype={nameLookup:function(a,b){var c,e;return 0===a.indexOf("depth")&&(c=!0),e=/^[0-9]+$/.test(b)?a+"["+b+"]":d.isValidJavaScriptVariableName(b)?a+"."+b:a+"['"+b+"']",c?"("+a+" && "+e+")":e},compilerInfo:function(){var a=f,b=g[a];return"this.compilerInfo = ["+a+",'"+b+"'];\n"},appendToBuffer:function(a){return this.environment.isSimple?"return "+a+";":{appendToBuffer:!0,content:a,toString:function(){return"buffer += "+a+";"}}},initializeBuffer:function(){return this.quotedString("")},namespace:"Handlebars",compile:function(a,b,c,d){this.environment=a,this.options=b||{},h("debug",this.environment.disassemble()+"\n\n"),this.name=this.environment.name,this.isChild=!!c,this.context=c||{programs:[],environments:[],aliases:{}},this.preamble(),this.stackSlot=0,this.stackVars=[],this.registers={list:[]},this.hashes=[],this.compileStack=[],this.inlineStack=[],this.compileChildren(a,b);var e,f=a.opcodes;this.i=0;for(var g=f.length;this.i<g;this.i++)e=f[this.i],"DECLARE"===e.opcode?this[e.name]=e.value:this[e.opcode].apply(this,e.args),e.opcode!==this.stripNext&&(this.stripNext=!1);if(this.pushSource(""),this.stackSlot||this.inlineStack.length||this.compileStack.length)throw new i("Compile completed with content left on stack");return this.createFunctionContext(d)},preamble:function(){var a=[];if(this.isChild)a.push("");else{var b=this.namespace,c="helpers = this.merge(helpers, "+b+".helpers);";this.environment.usePartial&&(c=c+" partials = this.merge(partials, "+b+".partials);"),this.options.data&&(c+=" data = data || {};"),a.push(c)}this.environment.isSimple?a.push(""):a.push(", buffer = "+this.initializeBuffer()),this.lastContext=0,this.source=a},createFunctionContext:function(a){var b=this.stackVars.concat(this.registers.list);if(b.length>0&&(this.source[1]=this.source[1]+", "+b.join(", ")),!this.isChild)for(var c in this.context.aliases)this.context.aliases.hasOwnProperty(c)&&(this.source[1]=this.source[1]+", "+c+"="+this.context.aliases[c]);this.source[1]&&(this.source[1]="var "+this.source[1].substring(2)+";"),this.isChild||(this.source[1]+="\n"+this.context.programs.join("\n")+"\n"),this.environment.isSimple||this.pushSource("return buffer;");for(var d=this.isChild?["depth0","data"]:["Handlebars","depth0","helpers","partials","data"],e=0,f=this.environment.depths.list.length;f>e;e++)d.push("depth"+this.environment.depths.list[e]);var g=this.mergeSource();if(this.isChild||(g=this.compilerInfo()+g),a)return d.push(g),Function.apply(this,d);var i="function "+(this.name||"")+"("+d.join(",")+") {\n  "+g+"}";return h("debug",i+"\n\n"),i},mergeSource:function(){for(var a,b="",c=0,d=this.source.length;d>c;c++){var e=this.source[c];e.appendToBuffer?a=a?a+"\n    + "+e.content:e.content:(a&&(b+="buffer += "+a+";\n  ",a=void 0),b+=e+"\n  ")}return b},blockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var a=["depth0"];this.setupParams(0,a),this.replaceStack(function(b){return a.splice(1,0,b),"blockHelperMissing.call("+a.join(", ")+")"})},ambiguousBlockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var a=["depth0"];this.setupParams(0,a);var b=this.topStack();a.splice(1,0,b),this.pushSource("if (!"+this.lastHelper+") { "+b+" = blockHelperMissing.call("+a.join(", ")+"); }")},appendContent:function(a){this.pendingContent&&(a=this.pendingContent+a),this.stripNext&&(a=a.replace(/^\s+/,"")),this.pendingContent=a},strip:function(){this.pendingContent&&(this.pendingContent=this.pendingContent.replace(/\s+$/,"")),this.stripNext="strip"},append:function(){this.flushInline();var a=this.popStack();this.pushSource("if("+a+" || "+a+" === 0) { "+this.appendToBuffer(a)+" }"),this.environment.isSimple&&this.pushSource("else { "+this.appendToBuffer("''")+" }")},appendEscaped:function(){this.context.aliases.escapeExpression="this.escapeExpression",this.pushSource(this.appendToBuffer("escapeExpression("+this.popStack()+")"))},getContext:function(a){this.lastContext!==a&&(this.lastContext=a)},lookupOnContext:function(a){this.push(this.nameLookup("depth"+this.lastContext,a,"context"))},pushContext:function(){this.pushStackLiteral("depth"+this.lastContext)},resolvePossibleLambda:function(){this.context.aliases.functionType='"function"',this.replaceStack(function(a){return"typeof "+a+" === functionType ? "+a+".apply(depth0) : "+a})},lookup:function(a){this.replaceStack(function(b){return b+" == null || "+b+" === false ? "+b+" : "+this.nameLookup(b,a,"context")})},lookupData:function(){this.pushStackLiteral("data")},pushStringParam:function(a,b){this.pushStackLiteral("depth"+this.lastContext),this.pushString(b),"sexpr"!==b&&("string"==typeof a?this.pushString(a):this.pushStackLiteral(a))},emptyHash:function(){this.pushStackLiteral("{}"),this.options.stringParams&&(this.push("{}"),this.push("{}"))},pushHash:function(){this.hash&&this.hashes.push(this.hash),this.hash={values:[],types:[],contexts:[]}},popHash:function(){var a=this.hash;this.hash=this.hashes.pop(),this.options.stringParams&&(this.push("{"+a.contexts.join(",")+"}"),this.push("{"+a.types.join(",")+"}")),this.push("{\n    "+a.values.join(",\n    ")+"\n  }")},pushString:function(a){this.pushStackLiteral(this.quotedString(a))},push:function(a){return this.inlineStack.push(a),a},pushLiteral:function(a){this.pushStackLiteral(a)},pushProgram:function(a){null!=a?this.pushStackLiteral(this.programExpression(a)):this.pushStackLiteral(null)},invokeHelper:function(a,b,c){this.context.aliases.helperMissing="helpers.helperMissing",this.useRegister("helper");var d=this.lastHelper=this.setupHelper(a,b,!0),e=this.nameLookup("depth"+this.lastContext,b,"context"),f="helper = "+d.name+" || "+e;d.paramsInit&&(f+=","+d.paramsInit),this.push("("+f+",helper ? helper.call("+d.callParams+") : helperMissing.call("+d.helperMissingParams+"))"),c||this.flushInline()},invokeKnownHelper:function(a,b){var c=this.setupHelper(a,b);this.push(c.name+".call("+c.callParams+")")},invokeAmbiguous:function(a,b){this.context.aliases.functionType='"function"',this.useRegister("helper"),this.emptyHash();var c=this.setupHelper(0,a,b),d=this.lastHelper=this.nameLookup("helpers",a,"helper"),e=this.nameLookup("depth"+this.lastContext,a,"context"),f=this.nextStack();c.paramsInit&&this.pushSource(c.paramsInit),this.pushSource("if (helper = "+d+") { "+f+" = helper.call("+c.callParams+"); }"),this.pushSource("else { helper = "+e+"; "+f+" = typeof helper === functionType ? helper.call("+c.callParams+") : helper; }")},invokePartial:function(a){var b=[this.nameLookup("partials",a,"partial"),"'"+a+"'",this.popStack(),"helpers","partials"];this.options.data&&b.push("data"),this.context.aliases.self="this",this.push("self.invokePartial("+b.join(", ")+")")},assignToHash:function(a){var b,c,d=this.popStack();this.options.stringParams&&(c=this.popStack(),b=this.popStack());var e=this.hash;b&&e.contexts.push("'"+a+"': "+b),c&&e.types.push("'"+a+"': "+c),e.values.push("'"+a+"': ("+d+")")},compiler:d,compileChildren:function(a,b){for(var c,d,e=a.children,f=0,g=e.length;g>f;f++){c=e[f],d=new this.compiler;var h=this.matchExistingProgram(c);null==h?(this.context.programs.push(""),h=this.context.programs.length,c.index=h,c.name="program"+h,this.context.programs[h]=d.compile(c,b,this.context),this.context.environments[h]=c):(c.index=h,c.name="program"+h)}},matchExistingProgram:function(a){for(var b=0,c=this.context.environments.length;c>b;b++){var d=this.context.environments[b];if(d&&d.equals(a))return b}},programExpression:function(a){if(this.context.aliases.self="this",null==a)return"self.noop";for(var b,c=this.environment.children[a],d=c.depths.list,e=[c.index,c.name,"data"],f=0,g=d.length;g>f;f++)b=d[f],1===b?e.push("depth0"):e.push("depth"+(b-1));return(0===d.length?"self.program(":"self.programWithDepth(")+e.join(", ")+")"},register:function(a,b){this.useRegister(a),this.pushSource(a+" = "+b+";")},useRegister:function(a){this.registers[a]||(this.registers[a]=!0,this.registers.list.push(a))},pushStackLiteral:function(a){return this.push(new c(a))},pushSource:function(a){this.pendingContent&&(this.source.push(this.appendToBuffer(this.quotedString(this.pendingContent))),this.pendingContent=void 0),a&&this.source.push(a)},pushStack:function(a){this.flushInline();var b=this.incrStack();return a&&this.pushSource(b+" = "+a+";"),this.compileStack.push(b),b},replaceStack:function(a){var b,d,e,f="",g=this.isInline();if(g){var h=this.popStack(!0);if(h instanceof c)b=h.value,e=!0;else{d=!this.stackSlot;var i=d?this.incrStack():this.topStackName();f="("+this.push(i)+" = "+h+"),",b=this.topStack()}}else b=this.topStack();var j=a.call(this,b);return g?(e||this.popStack(),d&&this.stackSlot--,this.push("("+f+j+")")):(/^stack/.test(b)||(b=this.nextStack()),this.pushSource(b+" = ("+f+j+");")),b},nextStack:function(){return this.pushStack()},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var a=this.inlineStack;if(a.length){this.inlineStack=[];for(var b=0,d=a.length;d>b;b++){var e=a[b];e instanceof c?this.compileStack.push(e):this.pushStack(e)}}},isInline:function(){return this.inlineStack.length},popStack:function(a){var b=this.isInline(),d=(b?this.inlineStack:this.compileStack).pop();if(!a&&d instanceof c)return d.value;if(!b){if(!this.stackSlot)throw new i("Invalid stack pop");this.stackSlot--}return d},topStack:function(a){var b=this.isInline()?this.inlineStack:this.compileStack,d=b[b.length-1];return!a&&d instanceof c?d.value:d},quotedString:function(a){return'"'+a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},setupHelper:function(a,b,c){var d=[],e=this.setupParams(a,d,c),f=this.nameLookup("helpers",b,"helper");return{params:d,paramsInit:e,name:f,callParams:["depth0"].concat(d).join(", "),helperMissingParams:c&&["depth0",this.quotedString(b)].concat(d).join(", ")}},setupOptions:function(a,b){var c,d,e,f=[],g=[],h=[];f.push("hash:"+this.popStack()),this.options.stringParams&&(f.push("hashTypes:"+this.popStack()),f.push("hashContexts:"+this.popStack())),d=this.popStack(),e=this.popStack(),(e||d)&&(e||(this.context.aliases.self="this",e="self.noop"),d||(this.context.aliases.self="this",d="self.noop"),f.push("inverse:"+d),f.push("fn:"+e));for(var i=0;a>i;i++)c=this.popStack(),b.push(c),this.options.stringParams&&(h.push(this.popStack()),g.push(this.popStack()));return this.options.stringParams&&(f.push("contexts:["+g.join(",")+"]"),f.push("types:["+h.join(",")+"]")),this.options.data&&f.push("data:data"),f},setupParams:function(a,b,c){var d="{"+this.setupOptions(a,b).join(",")+"}";return c?(this.useRegister("options"),b.push("options"),"options="+d):(b.push(d),"")}};for(var j="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield".split(" "),k=d.RESERVED_WORDS={},l=0,m=j.length;m>l;l++)k[j[l]]=!0;return d.isValidJavaScriptVariableName=function(a){return!(d.RESERVED_WORDS[a]||!/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(a))},e=d}(d,c),l=function(a,b,c,d,e){var f,g=a,h=b,i=c.parser,j=c.parse,k=d.Compiler,l=d.compile,m=d.precompile,n=e,o=g.create,p=function(){var a=o();return a.compile=function(b,c){return l(b,c,a)},a.precompile=function(b,c){return m(b,c,a)},a.AST=h,a.Compiler=k,a.JavaScriptCompiler=n,a.Parser=i,a.parse=j,a};return g=p(),g.create=p,f=g}(f,g,i,j,k);return l}();define("handlebars",function(a){return function(){var b;return b||a.Handlebars}}(this)),function(a,b){if("object"==typeof exports){var c=require("underscore"),d=require("backbone");module.exports=b(c,d)}else"function"==typeof define&&define.amd&&define("backbone.babysitter",["underscore","backbone"],b)}(this,function(a,b){"option strict";return b.ChildViewContainer=function(a,b){var c=function(a){this._views={},this._indexByModel={},this._indexByCustom={},this._updateLength(),b.each(a,this.add,this)};b.extend(c.prototype,{add:function(a,b){var c=a.cid;return this._views[c]=a,a.model&&(this._indexByModel[a.model.cid]=c),b&&(this._indexByCustom[b]=c),this._updateLength(),this},findByModel:function(a){return this.findByModelCid(a.cid)},findByModelCid:function(a){var b=this._indexByModel[a];return this.findByCid(b)},findByCustom:function(a){var b=this._indexByCustom[a];return this.findByCid(b)},findByIndex:function(a){return b.values(this._views)[a]},findByCid:function(a){return this._views[a]},remove:function(a){var c=a.cid;return a.model&&delete this._indexByModel[a.model.cid],b.any(this._indexByCustom,function(a,b){return a===c?(delete this._indexByCustom[b],!0):void 0},this),delete this._views[c],this._updateLength(),this},call:function(a){this.apply(a,b.tail(arguments))},apply:function(a,c){b.each(this._views,function(d){b.isFunction(d[a])&&d[a].apply(d,c||[])})},_updateLength:function(){this.length=b.size(this._views)}});var d=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];return b.each(d,function(a){c.prototype[a]=function(){var c=b.values(this._views),d=[c].concat(b.toArray(arguments));return b[a].apply(b,d)}}),c}(b,a),b.ChildViewContainer}),function(a,b){if("object"==typeof exports){var c=require("underscore"),d=require("backbone");module.exports=b(c,d)}else"function"==typeof define&&define.amd&&define("backbone.wreqr",["underscore","backbone"],b)}(this,function(a,b){return b.Wreqr=function(a,b,c){var d={};return d.Handlers=function(a,b){var c=function(a){this.options=a,this._wreqrHandlers={},b.isFunction(this.initialize)&&this.initialize(a)};return c.extend=a.Model.extend,b.extend(c.prototype,a.Events,{setHandlers:function(a){b.each(a,function(a,c){var d=null;b.isObject(a)&&!b.isFunction(a)&&(d=a.context,a=a.callback),this.setHandler(c,a,d)},this)},setHandler:function(a,b,c){var d={callback:b,context:c};this._wreqrHandlers[a]=d,this.trigger("handler:add",a,b,c)},hasHandler:function(a){return!!this._wreqrHandlers[a]},getHandler:function(a){var b=this._wreqrHandlers[a];if(b)return function(){var a=Array.prototype.slice.apply(arguments);return b.callback.apply(b.context,a)}},removeHandler:function(a){delete this._wreqrHandlers[a]},removeAllHandlers:function(){this._wreqrHandlers={}}}),c}(a,c),d.CommandStorage=function(){var b=function(a){this.options=a,this._commands={},c.isFunction(this.initialize)&&this.initialize(a)};return c.extend(b.prototype,a.Events,{getCommands:function(a){var b=this._commands[a];return b||(b={command:a,instances:[]},this._commands[a]=b),b},addCommand:function(a,b){var c=this.getCommands(a);c.instances.push(b)},clearCommands:function(a){var b=this.getCommands(a);b.instances=[]}}),b}(),d.Commands=function(a){return a.Handlers.extend({storageType:a.CommandStorage,constructor:function(b){this.options=b||{},this._initializeStorage(this.options),this.on("handler:add",this._executeCommands,this);var c=Array.prototype.slice.call(arguments);a.Handlers.prototype.constructor.apply(this,c)},execute:function(a,b){a=arguments[0],b=Array.prototype.slice.call(arguments,1),this.hasHandler(a)?this.getHandler(a).apply(this,b):this.storage.addCommand(a,b)},_executeCommands:function(a,b,d){var e=this.storage.getCommands(a);c.each(e.instances,function(a){b.apply(d,a)}),this.storage.clearCommands(a)},_initializeStorage:function(a){var b,d=a.storageType||this.storageType;b=c.isFunction(d)?new d:d,this.storage=b}})}(d),d.RequestResponse=function(a){return a.Handlers.extend({request:function(){var a=arguments[0],b=Array.prototype.slice.call(arguments,1);return this.hasHandler(a)?this.getHandler(a).apply(this,b):void 0}})}(d),d.EventAggregator=function(a,b){var c=function(){};return c.extend=a.Model.extend,b.extend(c.prototype,a.Events),c}(a,c),d.Channel=function(b){var d=function(b){this.vent=new a.Wreqr.EventAggregator,this.reqres=new a.Wreqr.RequestResponse,this.commands=new a.Wreqr.Commands,this.channelName=b};return c.extend(d.prototype,{reset:function(){return this.vent.off(),this.vent.stopListening(),this.reqres.removeAllHandlers(),this.commands.removeAllHandlers(),this},connectEvents:function(a,b){return this._connect("vent",a,b),this},connectCommands:function(a,b){return this._connect("commands",a,b),this},connectRequests:function(a,b){return this._connect("reqres",a,b),this},_connect:function(a,b,d){if(b){d=d||this;var e="vent"===a?"on":"setHandler";c.each(b,function(b,f){this[a][e](f,c.bind(b,d))},this)}}}),d}(d),d.radio=function(a){var b=function(){this._channels={},this.vent={},this.commands={},this.reqres={},this._proxyMethods()};c.extend(b.prototype,{channel:function(a){if(!a)throw new Error("Channel must receive a name");return this._getChannel(a)},_getChannel:function(b){var c=this._channels[b];return c||(c=new a.Channel(b),this._channels[b]=c),c},_proxyMethods:function(){c.each(["vent","commands","reqres"],function(a){c.each(d[a],function(b){this[a][b]=e(this,a,b)},this)},this)}});var d={vent:["on","off","trigger","once","stopListening","listenTo","listenToOnce"],commands:["execute","setHandler","setHandlers","removeHandler","removeAllHandlers"],reqres:["request","setHandler","setHandlers","removeHandler","removeAllHandlers"]},e=function(a,b,c){return function(d){var e=a._getChannel(d)[b],f=Array.prototype.slice.call(arguments,1);e[c].apply(e,f)}};return new b}(d),d}(b,b.Marionette,a),b.Wreqr}),function(a,b){if("object"==typeof exports){var c=require("underscore"),d=require("backbone"),e=require("backbone.wreqr"),f=require("backbone.babysitter");module.exports=b(c,d,e,f)}else"function"==typeof define&&define.amd&&define("backbone.marionette",["underscore","backbone","backbone.wreqr","backbone.babysitter"],b)}(this,function(a,b){(function(a,b,c){function d(a,b){var c=new Error(a);throw c.name=b||"Error",c}var e={};b.Marionette=e,e.$=b.$;var f=Array.prototype.slice;return e.extend=b.Model.extend,e.getOption=function(a,b){if(a&&b){var c;return c=a.options&&b in a.options&&void 0!==a.options[b]?a.options[b]:a[b]}},e.normalizeMethods=function(a){var b,d={};return c.each(a,function(a,e){b=a,c.isFunction(b)||(b=this[b]),b&&(d[e]=b)},this),d},e.normalizeUIKeys=function(a,b){return"undefined"!=typeof a?(c.each(c.keys(a),function(c){var d=/@ui.[a-zA-Z_$0-9]*/g;c.match(d)&&(a[c.replace(d,function(a){return b[a.slice(4)]})]=a[c],delete a[c])}),a):void 0},e.actAsCollection=function(a,b){var d=["forEach","each","map","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","toArray","first","initial","rest","last","without","isEmpty","pluck"];c.each(d,function(d){a[d]=function(){var a=c.values(c.result(this,b)),e=[a].concat(c.toArray(arguments));return c[d].apply(c,e)}})},e.triggerMethod=function(){function a(a,b,c){return c.toUpperCase()}var b=/(^|:)(\w)/gi,d=function(d){var e="on"+d.replace(b,a),f=this[e];return c.isFunction(this.trigger)&&this.trigger.apply(this,arguments),c.isFunction(f)?f.apply(this,c.tail(arguments)):void 0};return d}(),e.MonitorDOMRefresh=function(a){function b(a){a._isShown=!0,e(a)}function d(a){a._isRendered=!0,e(a)}function e(a){a._isShown&&a._isRendered&&f(a)&&c.isFunction(a.triggerMethod)&&a.triggerMethod("dom:refresh")}function f(b){return a.contains(b.el)}return function(a){a.listenTo(a,"show",function(){b(a)}),a.listenTo(a,"render",function(){d(a)})}}(document.documentElement),function(a){function b(a,b,e,f){var g=f.split(/\s+/);c.each(g,function(c){var f=a[c];f||d("Method '"+c+"' was configured as an event handler, but does not exist."),a.listenTo(b,e,f)})}function e(a,b,c,d){a.listenTo(b,c,d)}function f(a,b,d,e){var f=e.split(/\s+/);c.each(f,function(c){var e=a[c];a.stopListening(b,d,e)})}function g(a,b,c,d){a.stopListening(b,c,d)}function h(a,b,d,e,f){b&&d&&(c.isFunction(d)&&(d=d.call(a)),c.each(d,function(d,g){c.isFunction(d)?e(a,b,g,d):f(a,b,g,d)}))}a.bindEntityEvents=function(a,c,d){h(a,c,d,e,b)},a.unbindEntityEvents=function(a,b,c){h(a,b,c,g,f)}}(e),e.Callbacks=function(){this._deferred=e.$.Deferred(),this._callbacks=[]},c.extend(e.Callbacks.prototype,{add:function(a,b){this._callbacks.push({cb:a,ctx:b}),this._deferred.done(function(c,d){b&&(c=b),a.call(c,d)})},run:function(a,b){this._deferred.resolve(b,a)},reset:function(){var a=this._callbacks;this._deferred=e.$.Deferred(),this._callbacks=[],c.each(a,function(a){this.add(a.cb,a.ctx)},this)}}),e.Controller=function(a){this.triggerMethod=e.triggerMethod,this.options=a||{},c.isFunction(this.initialize)&&this.initialize(this.options)},e.Controller.extend=e.extend,c.extend(e.Controller.prototype,b.Events,{close:function(){this.stopListening();var a=Array.prototype.slice.call(arguments);this.triggerMethod.apply(this,["close"].concat(a)),this.off()}}),e.Region=function(a){if(this.options=a||{},this.el=e.getOption(this,"el"),this.el||d("An 'el' must be specified for a region.","NoElError"),this.initialize){var b=Array.prototype.slice.apply(arguments);this.initialize.apply(this,b)}},c.extend(e.Region,{buildRegion:function(a,b){var e=c.isString(a),f=c.isString(a.selector),g=c.isUndefined(a.regionType),h=c.isFunction(a);h||e||f||d("Region must be specified as a Region type, a selector string or an object with selector property");var i,j;e&&(i=a),a.selector&&(i=a.selector,delete a.selector),h&&(j=a),!h&&g&&(j=b),a.regionType&&(j=a.regionType,delete a.regionType),(e||h)&&(a={}),a.el=i;var k=new j(a);return a.parentEl&&(k.getEl=function(b){var d=a.parentEl;return c.isFunction(d)&&(d=d()),d.find(b)}),k}}),c.extend(e.Region.prototype,b.Events,{show:function(a,b){this.ensureEl();var d=b||{},f=a.isClosed||c.isUndefined(a.$el),g=a!==this.currentView,h=!!d.preventClose,i=!h&&g;i&&this.close(),a.render(),e.triggerMethod.call(this,"before:show",a),e.triggerMethod.call(a,"before:show"),(g||f)&&this.open(a),this.currentView=a,e.triggerMethod.call(this,"show",a),e.triggerMethod.call(a,"show")},ensureEl:function(){this.$el&&0!==this.$el.length||(this.$el=this.getEl(this.el))},getEl:function(a){return e.$(a)},open:function(a){this.$el.empty().append(a.el)},close:function(){var a=this.currentView;a&&!a.isClosed&&(a.close?a.close():a.remove&&a.remove(),e.triggerMethod.call(this,"close",a),delete this.currentView)},attachView:function(a){this.currentView=a},reset:function(){this.close(),delete this.$el}}),e.Region.extend=e.extend,e.RegionManager=function(a){var b=a.Controller.extend({constructor:function(b){this._regions={},a.Controller.prototype.constructor.call(this,b)},addRegions:function(a,b){var d={};return c.each(a,function(a,e){c.isString(a)&&(a={selector:a}),a.selector&&(a=c.defaults({},a,b));var f=this.addRegion(e,a);d[e]=f},this),d},addRegion:function(b,d){var e,f=c.isObject(d),g=c.isString(d),h=!!d.selector;return e=g||f&&h?a.Region.buildRegion(d,a.Region):c.isFunction(d)?a.Region.buildRegion(d,a.Region):d,this._store(b,e),this.triggerMethod("region:add",b,e),e},get:function(a){return this._regions[a]},removeRegion:function(a){var b=this._regions[a];this._remove(a,b)},removeRegions:function(){c.each(this._regions,function(a,b){this._remove(b,a)},this)},closeRegions:function(){c.each(this._regions,function(a,b){a.close()},this)},close:function(){this.removeRegions(),a.Controller.prototype.close.apply(this,arguments)},_store:function(a,b){this._regions[a]=b,this._setLength()},_remove:function(a,b){b.close(),b.stopListening(),delete this._regions[a],this._setLength(),this.triggerMethod("region:remove",a,b);
},_setLength:function(){this.length=c.size(this._regions)}});return a.actAsCollection(b.prototype,"_regions"),b}(e),e.TemplateCache=function(a){this.templateId=a},c.extend(e.TemplateCache,{templateCaches:{},get:function(a){var b=this.templateCaches[a];return b||(b=new e.TemplateCache(a),this.templateCaches[a]=b),b.load()},clear:function(){var a,b=f.call(arguments),c=b.length;if(c>0)for(a=0;c>a;a++)delete this.templateCaches[b[a]];else this.templateCaches={}}}),c.extend(e.TemplateCache.prototype,{load:function(){if(this.compiledTemplate)return this.compiledTemplate;var a=this.loadTemplate(this.templateId);return this.compiledTemplate=this.compileTemplate(a),this.compiledTemplate},loadTemplate:function(a){var b=e.$(a).html();return b&&0!==b.length||d("Could not find template: '"+a+"'","NoTemplateError"),b},compileTemplate:function(a){return c.template(a)}}),e.Renderer={render:function(a,b){a||d("Cannot render the template since it's false, null or undefined.","TemplateNotFoundError");var c;return(c="function"==typeof a?a:e.TemplateCache.get(a))(b)}},e.View=b.View.extend({constructor:function(a){c.bindAll(this,"render"),c.isObject(this.behaviors)&&new e.Behaviors(this),this.options=c.extend({},c.result(this,"options"),c.isFunction(a)?a.call(this):a),this.events=this.normalizeUIKeys(c.result(this,"events")),b.View.prototype.constructor.apply(this,arguments),e.MonitorDOMRefresh(this),this.listenTo(this,"show",this.onShowCalled)},triggerMethod:e.triggerMethod,normalizeMethods:e.normalizeMethods,getTemplate:function(){return e.getOption(this,"template")},mixinTemplateHelpers:function(a){a=a||{};var b=e.getOption(this,"templateHelpers");return c.isFunction(b)&&(b=b.call(this)),c.extend(a,b)},normalizeUIKeys:function(a){var b=c.result(this,"ui");return e.normalizeUIKeys(a,b)},configureTriggers:function(){if(this.triggers){var a={},b=this.normalizeUIKeys(c.result(this,"triggers"));return c.each(b,function(b,d){var e=c.isObject(b),f=e?b.event:b;a[d]=function(a){if(a){var c=a.preventDefault,d=a.stopPropagation,g=e?b.preventDefault:c,h=e?b.stopPropagation:d;g&&c&&c.apply(a),h&&d&&d.apply(a)}var i={view:this,model:this.model,collection:this.collection};this.triggerMethod(f,i)}},this),a}},delegateEvents:function(a){this._delegateDOMEvents(a),e.bindEntityEvents(this,this.model,e.getOption(this,"modelEvents")),e.bindEntityEvents(this,this.collection,e.getOption(this,"collectionEvents"))},_delegateDOMEvents:function(a){a=a||this.events,c.isFunction(a)&&(a=a.call(this));var d={},e=c.result(this,"behaviorEvents")||{},f=this.configureTriggers();c.extend(d,e,a,f),b.View.prototype.delegateEvents.call(this,d)},undelegateEvents:function(){var a=Array.prototype.slice.call(arguments);b.View.prototype.undelegateEvents.apply(this,a),e.unbindEntityEvents(this,this.model,e.getOption(this,"modelEvents")),e.unbindEntityEvents(this,this.collection,e.getOption(this,"collectionEvents"))},onShowCalled:function(){},close:function(){if(!this.isClosed){var a=Array.prototype.slice.call(arguments),b=this.triggerMethod.apply(this,["before:close"].concat(a));b!==!1&&(this.isClosed=!0,this.triggerMethod.apply(this,["close"].concat(a)),this.unbindUIElements(),this.remove())}},bindUIElements:function(){if(this.ui){this._uiBindings||(this._uiBindings=this.ui);var a=c.result(this,"_uiBindings");this.ui={},c.each(c.keys(a),function(b){var c=a[b];this.ui[b]=this.$(c)},this)}},unbindUIElements:function(){this.ui&&this._uiBindings&&(c.each(this.ui,function(a,b){delete this.ui[b]},this),this.ui=this._uiBindings,delete this._uiBindings)}}),e.ItemView=e.View.extend({constructor:function(){e.View.prototype.constructor.apply(this,arguments)},serializeData:function(){var a={};return this.model?a=this.model.toJSON():this.collection&&(a={items:this.collection.toJSON()}),a},render:function(){this.isClosed=!1,this.triggerMethod("before:render",this),this.triggerMethod("item:before:render",this);var a=this.serializeData();a=this.mixinTemplateHelpers(a);var b=this.getTemplate(),c=e.Renderer.render(b,a);return this.$el.html(c),this.bindUIElements(),this.triggerMethod("render",this),this.triggerMethod("item:rendered",this),this},close:function(){this.isClosed||(this.triggerMethod("item:before:close"),e.View.prototype.close.apply(this,arguments),this.triggerMethod("item:closed"))}}),e.CollectionView=e.View.extend({itemViewEventPrefix:"itemview",constructor:function(a){this._initChildViewStorage(),e.View.prototype.constructor.apply(this,arguments),this._initialEvents(),this.initRenderBuffer()},initRenderBuffer:function(){this.elBuffer=document.createDocumentFragment(),this._bufferedChildren=[]},startBuffering:function(){this.initRenderBuffer(),this.isBuffering=!0},endBuffering:function(){this.isBuffering=!1,this.appendBuffer(this,this.elBuffer),this._triggerShowBufferedChildren(),this.initRenderBuffer()},_triggerShowBufferedChildren:function(){this._isShown&&(c.each(this._bufferedChildren,function(a){e.triggerMethod.call(a,"show")}),this._bufferedChildren=[])},_initialEvents:function(){this.collection&&(this.listenTo(this.collection,"add",this.addChildView),this.listenTo(this.collection,"remove",this.removeItemView),this.listenTo(this.collection,"reset",this.render))},addChildView:function(a,b,c){this.closeEmptyView();var d=this.getItemView(a),e=this.collection.indexOf(a);this.addItemView(a,d,e)},onShowCalled:function(){this.children.each(function(a){e.triggerMethod.call(a,"show")})},triggerBeforeRender:function(){this.triggerMethod("before:render",this),this.triggerMethod("collection:before:render",this)},triggerRendered:function(){this.triggerMethod("render",this),this.triggerMethod("collection:rendered",this)},render:function(){return this.isClosed=!1,this.triggerBeforeRender(),this._renderChildren(),this.triggerRendered(),this},_renderChildren:function(){this.startBuffering(),this.closeEmptyView(),this.closeChildren(),this.isEmpty(this.collection)?this.showEmptyView():this.showCollection(),this.endBuffering()},showCollection:function(){var a;this.collection.each(function(b,c){a=this.getItemView(b),this.addItemView(b,a,c)},this)},showEmptyView:function(){var a=this.getEmptyView();if(a&&!this._showingEmptyView){this._showingEmptyView=!0;var c=new b.Model;this.addItemView(c,a,0)}},closeEmptyView:function(){this._showingEmptyView&&(this.closeChildren(),delete this._showingEmptyView)},getEmptyView:function(){return e.getOption(this,"emptyView")},getItemView:function(a){var b=e.getOption(this,"itemView");return b||d("An `itemView` must be specified","NoItemViewError"),b},addItemView:function(a,b,d){var f=e.getOption(this,"itemViewOptions");c.isFunction(f)&&(f=f.call(this,a,d));var g=this.buildItemView(a,b,f);return this.addChildViewEventForwarding(g),this.triggerMethod("before:item:added",g),this.children.add(g),this.renderItemView(g,d),this._isShown&&!this.isBuffering&&e.triggerMethod.call(g,"show"),this.triggerMethod("after:item:added",g),g},addChildViewEventForwarding:function(a){var b=e.getOption(this,"itemViewEventPrefix");this.listenTo(a,"all",function(){var d=f.call(arguments),g=d[0],h=this.normalizeMethods(this.getItemEvents());d[0]=b+":"+g,d.splice(1,0,a),"undefined"!=typeof h&&c.isFunction(h[g])&&h[g].apply(this,d),e.triggerMethod.apply(this,d)},this)},getItemEvents:function(){return c.isFunction(this.itemEvents)?this.itemEvents.call(this):this.itemEvents},renderItemView:function(a,b){a.render(),this.appendHtml(this,a,b)},buildItemView:function(a,b,d){var e=c.extend({model:a},d);return new b(e)},removeItemView:function(a){var b=this.children.findByModel(a);this.removeChildView(b),this.checkEmpty()},removeChildView:function(a){a&&(a.close?a.close():a.remove&&a.remove(),this.stopListening(a),this.children.remove(a)),this.triggerMethod("item:removed",a)},isEmpty:function(a){return!this.collection||0===this.collection.length},checkEmpty:function(){this.isEmpty(this.collection)&&this.showEmptyView()},appendBuffer:function(a,b){a.$el.append(b)},appendHtml:function(a,b,c){a.isBuffering?(a.elBuffer.appendChild(b.el),a._bufferedChildren.push(b)):a.$el.append(b.el)},_initChildViewStorage:function(){this.children=new b.ChildViewContainer},close:function(){this.isClosed||(this.triggerMethod("collection:before:close"),this.closeChildren(),this.triggerMethod("collection:closed"),e.View.prototype.close.apply(this,arguments))},closeChildren:function(){this.children.each(function(a){this.removeChildView(a)},this),this.checkEmpty()}}),e.CompositeView=e.CollectionView.extend({constructor:function(){e.CollectionView.prototype.constructor.apply(this,arguments)},_initialEvents:function(){this.once("render",function(){this.collection&&(this.listenTo(this.collection,"add",this.addChildView),this.listenTo(this.collection,"remove",this.removeItemView),this.listenTo(this.collection,"reset",this._renderChildren))})},getItemView:function(a){var b=e.getOption(this,"itemView")||this.constructor;return b||d("An `itemView` must be specified","NoItemViewError"),b},serializeData:function(){var a={};return this.model&&(a=this.model.toJSON()),a},render:function(){this.isRendered=!0,this.isClosed=!1,this.resetItemViewContainer(),this.triggerBeforeRender();var a=this.renderModel();return this.$el.html(a),this.bindUIElements(),this.triggerMethod("composite:model:rendered"),this._renderChildren(),this.triggerMethod("composite:rendered"),this.triggerRendered(),this},_renderChildren:function(){this.isRendered&&(this.triggerMethod("composite:collection:before:render"),e.CollectionView.prototype._renderChildren.call(this),this.triggerMethod("composite:collection:rendered"))},renderModel:function(){var a={};a=this.serializeData(),a=this.mixinTemplateHelpers(a);var b=this.getTemplate();return e.Renderer.render(b,a)},appendBuffer:function(a,b){var c=this.getItemViewContainer(a);c.append(b)},appendHtml:function(a,b,c){if(a.isBuffering)a.elBuffer.appendChild(b.el),a._bufferedChildren.push(b);else{var d=this.getItemViewContainer(a);d.append(b.el)}},getItemViewContainer:function(a){if("$itemViewContainer"in a)return a.$itemViewContainer;var b,f=e.getOption(a,"itemViewContainer");if(f){var g=c.isFunction(f)?f.call(a):f;b="@"===g.charAt(0)&&a.ui?a.ui[g.substr(4)]:a.$(g),b.length<=0&&d("The specified `itemViewContainer` was not found: "+a.itemViewContainer,"ItemViewContainerMissingError")}else b=a.$el;return a.$itemViewContainer=b,b},resetItemViewContainer:function(){this.$itemViewContainer&&delete this.$itemViewContainer}}),e.Layout=e.ItemView.extend({regionType:e.Region,constructor:function(a){a=a||{},this._firstRender=!0,this._initializeRegions(a),e.ItemView.prototype.constructor.call(this,a)},render:function(){return this.isClosed&&this._initializeRegions(),this._firstRender?this._firstRender=!1:this.isClosed||this._reInitializeRegions(),e.ItemView.prototype.render.apply(this,arguments)},close:function(){this.isClosed||(this.regionManager.close(),e.ItemView.prototype.close.apply(this,arguments))},addRegion:function(a,b){var c={};return c[a]=b,this._buildRegions(c)[a]},addRegions:function(a){return this.regions=c.extend({},this.regions,a),this._buildRegions(a)},removeRegion:function(a){return delete this.regions[a],this.regionManager.removeRegion(a)},getRegion:function(a){return this.regionManager.get(a)},_buildRegions:function(a){var b=this,c={regionType:e.getOption(this,"regionType"),parentEl:function(){return b.$el}};return this.regionManager.addRegions(a,c)},_initializeRegions:function(a){var b;this._initRegionManager(),b=c.isFunction(this.regions)?this.regions(a):this.regions||{},this.addRegions(b)},_reInitializeRegions:function(){this.regionManager.closeRegions(),this.regionManager.each(function(a){a.reset()})},_initRegionManager:function(){this.regionManager=new e.RegionManager,this.listenTo(this.regionManager,"region:add",function(a,b){this[a]=b,this.trigger("region:add",a,b)}),this.listenTo(this.regionManager,"region:remove",function(a,b){delete this[a],this.trigger("region:remove",a,b)})}}),e.Behavior=function(a,b){function c(b,c){this.view=c,this.defaults=a.result(this,"defaults")||{},this.options=a.extend({},this.defaults,b),this.$=function(){return this.view.$.apply(this.view,arguments)},this.initialize.apply(this,arguments)}return a.extend(c.prototype,b.Events,{initialize:function(){},triggerMethod:e.triggerMethod}),c.extend=e.extend,c}(c,b),e.Behaviors=function(a,b){function c(a){this.behaviors=c.parseBehaviors(a,b.result(a,"behaviors")),c.wrap(a,this.behaviors,["bindUIElements","unbindUIElements","delegateEvents","undelegateEvents","onShow","onClose","behaviorEvents","triggerMethod","setElement"])}var d={setElement:function(a,c){a.apply(this,b.tail(arguments,2)),b.each(c,function(a){a.$el=this.$el},this)},onShow:function(c,d){var e=b.tail(arguments,2);b.each(d,function(b){a.triggerMethod.apply(b,["show"].concat(e))}),b.isFunction(c)&&c.apply(this,e)},onClose:function(c,d){var e=b.tail(arguments,2);b.each(d,function(b){a.triggerMethod.apply(b,["close"].concat(e))}),b.isFunction(c)&&c.apply(this,e)},bindUIElements:function(a,c){a.apply(this),b.invoke(c,a)},unbindUIElements:function(a,c){a.apply(this),b.invoke(c,a)},triggerMethod:function(a,c){var d=b.tail(arguments,2);a.apply(this,d),b.each(c,function(b){a.apply(b,d)})},delegateEvents:function(c,d){var e=b.tail(arguments,2);c.apply(this,e),b.each(d,function(b){a.bindEntityEvents(b,this.model,a.getOption(b,"modelEvents")),a.bindEntityEvents(b,this.collection,a.getOption(b,"collectionEvents"))},this)},undelegateEvents:function(c,d){var e=b.tail(arguments,2);c.apply(this,e),b.each(d,function(b){a.unbindEntityEvents(this,this.model,a.getOption(b,"modelEvents")),a.unbindEntityEvents(this,this.collection,a.getOption(b,"collectionEvents"))},this)},behaviorEvents:function(c,d){var e={},f=b.result(this,"ui");return b.each(d,function(c,d){var g={},h=b.result(c,"events")||{},i=b.result(c,"ui"),j=b.extend({},f,i);h=a.normalizeUIKeys(h,j),b.each(b.keys(h),function(a){var e=new Array(d+2).join(" "),f=a+e,i=b.isFunction(h[a])?h[a]:c[h[a]];g[f]=b.bind(i,c)}),e=b.extend(e,g)}),e}};return b.extend(c,{behaviorsLookup:function(){throw new Error("You must define where your behaviors are stored. See https://github.com/marionettejs/backbone.marionette/blob/master/docs/marionette.behaviors.md#behaviorslookup")},getBehaviorClass:function(a,d){return a.behaviorClass?a.behaviorClass:b.isFunction(c.behaviorsLookup)?c.behaviorsLookup.apply(this,arguments)[d]:c.behaviorsLookup[d]},parseBehaviors:function(a,d){return b.map(d,function(b,d){var e=c.getBehaviorClass(b,d);return new e(b,a)})},wrap:function(a,c,e){b.each(e,function(e){a[e]=b.partial(d[e],a[e],c)})}}),c}(e,c),e.AppRouter=b.Router.extend({constructor:function(a){b.Router.prototype.constructor.apply(this,arguments),this.options=a||{};var c=e.getOption(this,"appRoutes"),d=this._getController();this.processAppRoutes(d,c),this.on("route",this._processOnRoute,this)},appRoute:function(a,b){var c=this._getController();this._addAppRoute(c,a,b)},_processOnRoute:function(a,b){var d=c.invert(this.appRoutes)[a];c.isFunction(this.onRoute)&&this.onRoute(a,d,b)},processAppRoutes:function(a,b){if(b){var d=c.keys(b).reverse();c.each(d,function(c){this._addAppRoute(a,c,b[c])},this)}},_getController:function(){return e.getOption(this,"controller")},_addAppRoute:function(a,b,e){var f=a[e];f||d("Method '"+e+"' was not found on the controller"),this.route(b,e,c.bind(f,a))}}),e.Application=function(a){this._initRegionManager(),this._initCallbacks=new e.Callbacks,this.vent=new b.Wreqr.EventAggregator,this.commands=new b.Wreqr.Commands,this.reqres=new b.Wreqr.RequestResponse,this.submodules={},c.extend(this,a),this.triggerMethod=e.triggerMethod},c.extend(e.Application.prototype,b.Events,{execute:function(){this.commands.execute.apply(this.commands,arguments)},request:function(){return this.reqres.request.apply(this.reqres,arguments)},addInitializer:function(a){this._initCallbacks.add(a)},start:function(a){this.triggerMethod("initialize:before",a),this._initCallbacks.run(a,this),this.triggerMethod("initialize:after",a),this.triggerMethod("start",a)},addRegions:function(a){return this._regionManager.addRegions(a)},closeRegions:function(){this._regionManager.closeRegions()},removeRegion:function(a){this._regionManager.removeRegion(a)},getRegion:function(a){return this._regionManager.get(a)},module:function(a,b){var c=e.Module.getClass(b),d=f.call(arguments);return d.unshift(this),c.create.apply(c,d)},_initRegionManager:function(){this._regionManager=new e.RegionManager,this.listenTo(this._regionManager,"region:add",function(a,b){this[a]=b}),this.listenTo(this._regionManager,"region:remove",function(a,b){delete this[a]})}}),e.Application.extend=e.extend,e.Module=function(a,b,d){this.moduleName=a,this.options=c.extend({},this.options,d),this.initialize=d.initialize||this.initialize,this.submodules={},this._setupInitializersAndFinalizers(),this.app=b,this.startWithParent=!0,this.triggerMethod=e.triggerMethod,c.isFunction(this.initialize)&&this.initialize(this.options,a,b)},e.Module.extend=e.extend,c.extend(e.Module.prototype,b.Events,{initialize:function(){},addInitializer:function(a){this._initializerCallbacks.add(a)},addFinalizer:function(a){this._finalizerCallbacks.add(a)},start:function(a){this._isInitialized||(c.each(this.submodules,function(b){b.startWithParent&&b.start(a)}),this.triggerMethod("before:start",a),this._initializerCallbacks.run(a,this),this._isInitialized=!0,this.triggerMethod("start",a))},stop:function(){this._isInitialized&&(this._isInitialized=!1,e.triggerMethod.call(this,"before:stop"),c.each(this.submodules,function(a){a.stop()}),this._finalizerCallbacks.run(void 0,this),this._initializerCallbacks.reset(),this._finalizerCallbacks.reset(),e.triggerMethod.call(this,"stop"))},addDefinition:function(a,b){this._runModuleDefinition(a,b)},_runModuleDefinition:function(a,d){if(a){var f=c.flatten([this,this.app,b,e,e.$,c,d]);a.apply(this,f)}},_setupInitializersAndFinalizers:function(){this._initializerCallbacks=new e.Callbacks,this._finalizerCallbacks=new e.Callbacks}}),c.extend(e.Module,{create:function(a,b,d){var e=a,g=f.call(arguments);g.splice(0,3),b=b.split(".");var h=b.length,i=[];return i[h-1]=d,c.each(b,function(b,c){var f=e;e=this._getModule(f,b,a,d),this._addModuleDefinition(f,e,i[c],g)},this),e},_getModule:function(a,b,d,e,f){var g=c.extend({},e),h=this.getClass(e),i=a[b];return i||(i=new h(b,d,g),a[b]=i,a.submodules[b]=i),i},getClass:function(a){var b=e.Module;return a?a.prototype instanceof b?a:a.moduleClass||b:b},_addModuleDefinition:function(a,b,c,d){var e=this._getDefine(c),f=this._getStartWithParent(c,b);e&&b.addDefinition(e,d),this._addStartWithParent(a,b,f)},_getStartWithParent:function(a,b){var d;return c.isFunction(a)&&a.prototype instanceof e.Module?(d=b.constructor.prototype.startWithParent,c.isUndefined(d)?!0:d):c.isObject(a)?(d=a.startWithParent,c.isUndefined(d)?!0:d):!0},_getDefine:function(a){return!c.isFunction(a)||a.prototype instanceof e.Module?c.isObject(a)?a.define:null:a},_addStartWithParent:function(a,b,c){b.startWithParent=b.startWithParent&&c,b.startWithParent&&!b.startWithParentIsConfigured&&(b.startWithParentIsConfigured=!0,a.addInitializer(function(a){b.startWithParent&&b.start(a)}))}}),e})(this,b,a);return b.Marionette}),function(a,b,c,d,e,f,g){"object"==typeof d?e.exports=f(c("underscore"),c("backbone"),c("backbone.marionette")):"function"==typeof b&&b.amd?b("marionette_handlebars",["underscore","backbone","backbone.marionette"],function(b,c){return b=b===g?a._:b,c=c===g?a.Backbone:c,a.returnExportsGlobal=f(b,c,a)}):a.returnExportsGlobal=f(a._,a.Backbone)}(this,this.define,this.require,this.exports,this.module,function(a,b,c,d){var e;return e=b.Marionette.Renderer.render,b.Marionette.Renderer.render=function(b,c){return a.isObject(b)&&"handlebars"===b.type?b.template(c,b.options):e(b,c)},b.Marionette}),define("modules/globals/url",[],function(){var a=window.url;return a||console.log("Warn: `url` global variable is not set"),a}),define("modules/common/config",["modules/globals/url","jquery"],function(a){var b="datasvc",c="api";return{urls:{mainpage_url:a.site,miniblog_api_url:a.site+c+"/miniblog",home_feed_url:a.site+c+"/miniblog/homefeed/posts/all",poll_url:a.site+c+"/miniblog/poll",single_post_url:a.site+c+"/miniblog/post",create_post_url:a.site+c+"/miniblog/post",profile_feed_url:a.site+c+"/miniblog/profilefeed",watchlist_url:a.site+c+"/miniblog/watchlist",mentions_url:a.site+c+"/miniblog/mentions",mentions_count_url:a.site+b+"/user/{0}/mentions/unread/count",profile_url:a.site+c+"/miniblog/profile",follower_url:a.site+c+"/miniblog/fans",following_url:a.site+c+"/miniblog/fanof",getfriend_url:a.site+b+"/user/{0}/friends?offset={1}&limit={2}",badges_url:a.site+c+"/miniblog/badges",badges:a.site+b+"/user/{0}/badges",expired_badges_url:a.site+b+"/user/{0}/badges/expired",achievement_url:a.site+b+"/user/{0}/achievements",power_url:a.site+b+"/user/{0}/powers",replies_url:a.site+c+"/miniblog/replies",reshares_url:a.site+c+"/miniblog/reshares",ef_url:a.site+c+"/miniblog/emotions",discover_url:a.site+c+"/miniblog/discover",autocomplete_users:a.site+c+"/miniblog/autocomplete/users",autocomplete_groups:a.site+c+"/miniblog/autocomplete/groups",settings:a.site+c+"/miniblog/settings",search:a.site+c+"/miniblog/search",coverphotos:a.site+c+"/miniblog/coverphotos",coverphoto_upload:a.site+c+"/miniblog/coverphoto_upload",group_feed:a.site+c+"/group/feed/{0}/posts/all/{1}/{2}",group_invalidate_cache:a.site+c+"/group/invalidate_cache/{0}/{1}",alerts_url:a.site+b+"/user/{0}/alerts",alerts_unread_url:a.site+b+"/user/{0}/alerts/unread",invite:a.site+b+"/user/{0}/sent_invitation",user_games:a.site+b+"/user/{0}/games",user_groups:a.site+b+"/user/{0}/groups?page={1}&e={2}",user_chatrooms:a.site+b+"/user/{0}/chatrooms?page={1}&e={2}",search_chatrooms:a.site+b+"/chatroom/search?country_code={0}&search={1}&language={2}&page={3}&number_of_entries={4}",recommendations_user:a.site+b+"/recommendation/ur/user?targetID={0}",recommendations_user_country:a.site+b+"/recommendation/ur/countryofuser?targetID={0}",addressbook_users:a.site+b+"/recommendation/abc/user?targetID={0}",groups_official:a.site+b+"/groups/official?page={0}&e={1}",groups_games:a.site+b+"/groups/games",group_api:a.site+b+"/group",group:a.site+b+"/group/{0}",group_join:a.site+b+"/group/{0}/join",group_leave:a.site+b+"/group/{0}/leave",group_members:a.site+b+"/group/{0}/members",group_moderators:a.site+b+"/group/{0}/moderators",group_pending_invites:a.site+b+"/group/{0}/pending_invites",group_invite_request:a.site+b+"/group/{0}/invite/request",group_invite_accept:a.site+b+"/group/{0}/invite/{1}/accept",group_invite_reject:a.site+b+"/group/{0}/invite/{1}/reject",group_member_promote:a.site+b+"/group/{0}/member/{1}/promote",group_member_demote:a.site+b+"/group/{0}/member/{1}/demote",group_member_block:a.site+b+"/group/{0}/member/{1}/block",group_chatrooms:a.site+b+"/group/{0}/chatrooms",default_face_url:a.site+"/sites/resources/images/avatar/avatar_default_face.png",store_categories:a.site+b+"/store/categories/{0}",store_category:a.site+b+"/store/category/{0}",store_category_items:a.site+b+"/store/category/{0}/items",store_type_items:a.site+b+"/store/type/{0}/items",store_item:a.site+b+"/store/item/{0}",store_item_purchase:a.site+b+"/store/item/{0}/purchase",store_search_items:a.site+b+"/store/search/items",cxb_store_partner:a.site+b+"/cxb/storepartner/{0}",user_store_gifts_list:a.site+b+"/gift/list/{0}",user_store_gifts_received:a.site+b+"/user/{0}/gift/received",user_store_items_received:a.site+b+"/user/{0}/store/received",user_store_item_received:a.site+b+"/user/{0}/store/received/{1}",user_store_items_inventory:a.site+b+"/user/{0}/store/inventory",user_store_item_inventory:a.site+b+"/user/{0}/store/inventory/{1}",user_store_item_inventory_give:a.site+b+"/user/{0}/store/inventory/{1}/give",user_file_upload:a.site+b+"/user/{0}/file/upload",email_post:a.site+b+"/post/{0}/email",hashtags:a.site+b+"/search/facets/hashtags",hashtags_country:a.site+b+"/hashtag/countries",account_user_payment:a.site+b+"/user/{0}/payments",account_user_merchant:a.site+b+"/user/{0}/merchant",account_merchant_countries:a.site+b+"/merchant/countries",account_merchant_country:a.site+b+"/merchant/country/{0}",account_merchant_country_search:a.site+b+"/merchant/country/search",account_balance:a.site+b+"/account/balance",account_history:a.site+b+"/account/account_entries",account_transfer_credit:a.site+b+"/account/transfer_credit",account_convert_to_mvc:a.site+b+"/account/convert/mvc",account_convert_amount_in_mvc:a.site+b+"/payment/mvc/conversion/{0}/to/MGC?amount={1}",account_convert_amount:a.site+b+"/payment/mvc/conversion/{0}/to/{1}?amount={2}",country:a.site+b+"/country/{0}",user_alert_response:a.site+b+"/user/{0}/alert_response",user_alert_unread_count:a.site+b+"/user/{0}/alerts/unread/count",banner:a.site+b+"/banner",chatroom_info_url:a.site+b+"/chatroom/{0}",gamecenter_root_url:"http://migme.github.io",gamecenter_url:"http://migme.github.io/games/",music_root_url:"http://migme.github.io",music_url:"http://migme.github.io/music/",ios_download_url:"https://itunes.apple.com/us/app/migme/id981394834?ls=1&mt=8",android_download_url:"https://play.google.com/store/apps/details?id=com.projectgoth&hl=en",migworld_url:a.site+"/discover/migworld",twitter_share_url:"https://twitter.com/share?via=migmehq&url=",facebook_share_url:"http://www.facebook.com/sharer.php?u=",facebook_friending_url:a.site+b+"/friending/facebook_users_in_mig",friending_meet_random_url:a.site+b+"/friending/meet_at_random",user_fan_of_the_month:a.site+b+"/user/{0}/fanofthemonth",user_engagement:a.site+b+"/user/{0}/engagement?aggregatorId={1}&period={2}",artist_engagement:a.site+b+"/user/{0}/engagement",share_engagement_profile:a.site+b+"/event/share/profile/{0}",share_engagement_post:a.site+b+"/event/share/post/{0}",share_engagement_activity:a.site+b+"/event/sharingActivity",get_gift_favorite:a.site+b+"/user/{0}/favorite?userFavoriteType=VIRTUAL_GIFT",add_gift_favorite:a.site+b+"/user/{0}/favorite",remove_gift_favorite:a.site+b+"/user/{0}/favorite/delete",get_music_favorite:a.site+b+"/user/{0}/favorite",add_music_favorite:a.site+b+"/user/{0}/favorite",remove_music_favorite:a.site+b+"/user/{0}/favorite/delete",get_currency:a.site+b+"/user/{0}/currency"},grid:{desired_cell_width:188,cell_spacing:16,cell_height:204},variable:{limit:2*Math.floor($(window).height()/192),infinitescroll_height:300,max_media_size:5242880},timer:{poll:3e4,leaderboard_poll:6e4},posts:{limit:20,replies:{limit:20,logout_limit:10,homefeed_limit:1,homefeed_first_limit:1},reshares:{limit:20,logout_limit:10,homefeed_limit:1,parent_level:1}},invite_friends:{message_char_limit:128},chat_invite:{message_char_limit:200},migalerts:{limit:33,char_limit:30},notification_destinations:{POPUP_TYPE:2,STICKY_TYPE:3,MARKETING_TYPE:4,MIGALERT_TYPE:6,ACCUMULATED_VIRTUALGIFT_ALERT:8},groups:{limit:33,members:{limit:33}},profile:{sidebar:{limit:5},followers:{limit:20},following:{limit:20},gifts:{limit:20},badges:{limit:20},groups:{limit:20},games:{limit:20},chatrooms:{limit:100}},search:{chatrooms:{limit:20},users:{limit:20},posts:{limit:20},topics:{limit:20},meet_at_random:{limit:40}},recommendation:{users:{limit:20},hashtags:{limit:20}},store:{premium_price:.2,gift_shower_price:0,migcoins_currency_code:"MGC",show_migcoins:!1,type_to_category:{VIRTUAL_GIFT:1,AVATAR:2,EMOTICON:3,SUPER_EMOTICON:4,THEME:5,STICKER:6,APP_ITEM:7,GAME_ITEM:8},category_to_type:{1:"VIRTUAL_GIFT",2:"AVATAR",3:"EMOTICON",4:"SUPER_EMOTICON",5:"THEME",6:"STICKER",7:"APP_ITEM",8:"GAME_ITEM"},items:{limit:100,received:{limit:20}},purchase_location:{PROFILE:1,PRIVATE_CHAT_COMMAND:2,GROUP_CHAT_COMMAND:3,CHATROOM_COMMAND:4,PRIVATE_CHAT_MENU:5,GROUP_CHAT_MENU:6,CHATROOM_MENU:7,FRIENDS_LIST:8,STORE:9,GIFT_VIEW:10,MARKETING_REWARD:11,DISCOVER:12,POST:13}},account:{merchant:{limit:20}},facebook:{permissions:"publish_actions,email"},email:{merchant:"merchant@mig.me"},language:{fallbacks:{id_ID:["en_US"],hi_HI:["en_US"],ne_NE:["en_US"]}},favorite:{music:"MUSIC_CHANNEL",gift:"VIRTUAL_GIFT"}}}),define("hbs",["handlebars"],function(a){var b={},c=".hbs";return{load:function(d,e,f,g){var h=g.hbs&&g.hbs.templateExtension?g.hbs.templateExtension:c;if(g.isBuild){var i=nodeRequire("fs"),j=g.dirBaseUrl+"/"+d+h;b[d]=i.readFileSync(j).toString(),f()}else e(["text!"+d+h],function(b){f(a.compile(b))})},write:function(c,d,e){var f=a.precompile(b[d]);e("define('hbs!"+d+"', ['handlebars'], function(Handlebars){ \nreturn Handlebars.template("+f.toString()+");\n});\n")}}}),define("hbs!modules/template/common/success-modal",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="modal-dialog">\n  <div class="modal-content">\n    <div class="modal-body">\n      <span class="icon-wb_closepopup close pull-right font-color-grey visible-xs" data-dismiss="modal"></span>\n\n      <div class="col-sm-12 container text-center">\n        <h3 class="title font-light">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"common|success_message_title",g):i.call(b,"translate","common|success_message_title",g)))+'</h3>\n\n        <img src="'+j((f=c.getUrl||b&&b.getUrl,g={hash:{},data:e},f?f.call(b,"jsclient",g):i.call(b,"getUrl","jsclient",g)))+'/app/images/mig.me/success.svg" />\n\n        <div class="description font-color-caption">\n          \n        </div>\n\n        <div class="button-text btn-outline btn-inverse-default btn-center" data-dismiss="modal">\n          '+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"common|ok",g):i.call(b,"translate","common|ok",g)))+'\n        </div>\n\n      </div>\n      <div class="share-modal-spacing clear"></div>\n    </div>\n  </div>\n</div>\n\n'})}),define("modules/view/common/success_modal_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/common/success-modal","modules/common/config"],function(a,b,c,d,e,f,g){var h=e.Layout.extend({template:{type:"handlebars",template:g},id:"success-modal",className:"success-modal modal fade",regions:{title:".title",description:".description",button_text:".button-text"},updateText:function(a,c,d){"undefined"!=typeof a&&null!==a&&""!==a&&b(this.title.el,this.$el).html(a),"undefined"!=typeof c&&null!==c&&""!==c&&b(this.description.el,this.$el).html(c),"undefined"!=typeof d&&null!==d&&""!==d&&b(this.button_text.el,this.$el).html(d)}});return h}),define("modules/common/date_format",["jquery","underscore"],function(a,b){var c=function(){},d=function(){var c=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,e=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[\-+]\d{4})?)\b/g,f=/[^+\dA-Z\-]/g,g=function(a,b){for(a=String(a),b=b||2;a.length<b;)a="0"+a;return a};return function(h,i,j){if(1!=arguments.length||"[object String]"!=Object.prototype.toString.call(h)||/\d/.test(h)||(i=h,h=void 0),b.isString(h)&&(h=parseInt(h,10)),h=h?new Date(h):new Date,isNaN(h))throw new SyntaxError("invalid date");i=String(d.masks[i]||i||d.masks["default"]),"UTC:"==i.slice(0,4)&&(i=i.slice(4),j=!0);var k=j?"getUTC":"get",l=h[k+"Date"](),m=h[k+"Day"](),n=h[k+"Month"](),o=h[k+"FullYear"](),p=h[k+"Hours"](),q=h[k+"Minutes"](),r=h[k+"Seconds"](),s=h[k+"Milliseconds"](),t=j?0:h.getTimezoneOffset(),u={d:l,dd:g(l),ddd:a.i18n("date|"+d.i18n.dayNames[m]),dddd:a.i18n("date|"+d.i18n.dayNames[m+7]),m:n+1,mm:g(n+1),mmm:a.i18n("date|"+d.i18n.monthNames[n]),mmmm:a.i18n("date|"+d.i18n.monthNames[n+12]),yy:String(o).slice(2),yyyy:o,h:p%12||12,hh:g(p%12||12),H:p,HH:g(p),M:q,MM:g(q),s:r,ss:g(r),l:g(s,3),L:g(s>99?Math.round(s/10):s),t:12>p?"a":"p",tt:12>p?"am":"pm",T:12>p?"A":"P",TT:12>p?"AM":"PM",Z:j?"UTC":(String(h).match(e)||[""]).pop().replace(f,""),o:(t>0?"-":"+")+g(100*Math.floor(Math.abs(t)/60)+Math.abs(t)%60,4),S:["th","st","nd","rd"][l%10>3?0:(l%100-l%10!=10)*l%10]
};return i.replace(c,function(a){return a in u?u[a]:a.slice(1,a.length-1)})}}();return d.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"},d.i18n={dayNames:["sun","mon","tue","wed","thu","fri","sat","sunday","monday","tuesday","wednesday","thursday","friday","saturday"],monthNames:["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec","january","february","march","april","may","june","july","august","september","october","november","december"]},c.format=function(a,b,c){return d(a,b,c)},c}),define("modules/globals/session_user",[],function(){var a=window.session_user;return a||console.log("Loading the client with out a valid session!!!"),a}),define("modules/globals/settings",[],function(){var a=window.settings;return a||console.log("Warn: `settings` variable is not found"),a}),define("modules/chat/config/config_ts",["require","exports","underscore","modules/globals/session_user","modules/globals/url","modules/globals/settings"],function(a,b){var c=a("modules/globals/url"),d=a("modules/globals/settings"),e=a("modules/globals/session_user");b.config={Transport_Type:{xml:0,json:1},transport_mode:d.transport_mode,packet_array_server_support:!1,Presence:{online:1,busy:3,away:4,appear_offline:99,offline:99},IM_Type:{fusion:1,msn:2,yahoo:4,gtalk:6,facebook:7,mobile:99},IM_Name:{1:"fusion",2:"msn",4:"yahoo",6:"gtalk",7:"facebook"},IM_Group:{"-5":2,"-6":4,"-4":6,"-3":7},IM_Type_Disable:{2:!0,4:!0,6:!0,7:!0,99:!0},Message_Type:{1:1,2:4,4:6,7:7,6:8},Content_Type:{text:1,image:2,audio:3,video:4,file:5,emote:6,system:7},Application_State:{check_session:1,logging_in:2,logged_in:3},DestinationType:{individual:1,group:2,public_chat:3},SettingType:{password:1,mobilephone:2,securityQuestion:3},ChatroomType:{individual:1,group:2,public_chat:3},InitialWindowPosition:{x:0,y:0},MessageStatus:{composing:1,received:2,read:3,sent:1.5,sent_ok:1.6,unknown:-1},emoticon_hotkeys:"",isDebug:function(){return!0},getDisableIMType:function(a){var c=b.config.IM_Type_Disable[a];return c||!1},getMessageType:function(a){var c=b.config.Message_Type[a];return c||1},short_poll_interval:2,default_poll_interval:2,check_session_interval:120,offline_threshold:3,ClientType:5,ClientVersion:5,NoAvatarDisplayPicture:"/sites/resources/images/avatar/default-avatar.png",NoAvatarDisplayPictureSmall:"/sites/resources/images/avatar/default-avatar-24x24.png",session_cookie_domain:c?c.cookie_domain:"",gateway_path:"/xml/",image_server:c?c.image:"",migcore_url:c?c.migcore:"",gateway_url:c?c.gateway_url:"",register_url:c?c.register:"",login_url:c?c.login:"",config:{username:e?e.username:"",presence:1},b_url:c?c.migbo:"",site:"miniblog",path:"u/"+(e?e.alias:""),logout_url:c?c.logout:"",message_fetch_count:30}}),function(a){"function"==typeof define&&define.amd?define("jquery.cookie",["jquery"],a):a(jQuery)}(function(a){function b(a){return h.raw?a:encodeURIComponent(a)}function c(a){return h.raw?a:decodeURIComponent(a)}function d(a){return b(h.json?JSON.stringify(a):String(a))}function e(a){0===a.indexOf('"')&&(a=a.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\"));try{a=decodeURIComponent(a.replace(g," "))}catch(b){return}try{return h.json?JSON.parse(a):a}catch(b){}}function f(b,c){var d=h.raw?b:e(b);return a.isFunction(c)?c(d):d}var g=/\+/g,h=a.cookie=function(e,g,i){if(void 0!==g&&!a.isFunction(g)){if(i=a.extend({},h.defaults,i),"number"==typeof i.expires){var j=i.expires,k=i.expires=new Date;k.setDate(k.getDate()+j)}return document.cookie=[b(e),"=",d(g),i.expires?"; expires="+i.expires.toUTCString():"",i.path?"; path="+i.path:"",i.domain?"; domain="+i.domain:"",i.secure?"; secure":""].join("")}for(var l=e?void 0:{},m=document.cookie?document.cookie.split("; "):[],n=0,o=m.length;o>n;n++){var p=m[n].split("="),q=c(p.shift()),r=p.join("=");if(e&&e===q){l=f(r,g);break}e||void 0===(r=f(r))||(l[q]=r)}return l};h.defaults={},a.removeCookie=function(b,c){return void 0!==a.cookie(b)?(a.cookie(b,"",a.extend({},c,{expires:-1})),!0):!1}}),define("modules/common/local_storage",["modules/chat/config/config_ts","underscore","backbone","jquery.cookie"],function(a,b,c){var d=a.config,e={};return b.extend(e,c.Events),b.extend(e,{hasKey:function(a){var b;return b=window.localStorage?window.localStorage.getItem(a):$.cookie(a),null!==b},get:function(a){var b;return b=window.localStorage?window.localStorage.getItem(a):$.cookie(a),b=void 0===b||null===b||"undefined"===b?"null":b.toString(),JSON.parse(b)},set:function(a,b){return window.localStorage?window.localStorage.setItem(a,JSON.stringify(b)):$.cookies(a,JSON.stringify(b))},remove:function(a){return window.localStorage?window.localStorage.removeItem(a):$.cookie(a,null)},create_cookie:function(a,b,c){$.cookie(a,b,{expires:c,domain:d.session_cookie_domain})},get_cookie:function(a){$.cookie(a)},clear_cookie:function(a){this.create_cookie(a,null,-1)},has_cookie:function(a){return null!==$.cookie(a)}}),e}),define("modules/globals/variable",[],function(){var a=window.variable;return a||console.log("Warn: `variable` global variable not set!"),a}),define("modules/common/session_user",["backbone","modules/common/utility","modules/common/config","modules/common/local_storage"],function(a,b,c,d){var e={},f=null,g=!1;return e.Model=a.Model.extend({defaults:function(){return{commit:{}}},hasInitialized:function(){return g},initialize:function(){}}),e.initialize=function(a){return f=new e.Model(a),e.setup_session_user_shim(a),g=!0,f},e.getInstance=function(){return f},e.hasInitialized=function(){return g},e.setup_session_user_shim=function(a){a&&(a.get=function(b){return a[b]},a.set=function(b,c){a[b]=c,f.set({key:c})})},e}),define("modules/common/task_runner",["require","exports","underscore","jquery","backbone"],function(a,b){var c=a("underscore"),d=function(){function a(){}return a.prototype.start=function(a){this.scope=a.scope||window,this.fireOnStart=a.fireOnStart,this.run=a.run,this.interval=a.interval||5e3,this.bound_fn=c.bind(this.run,this.scope),this.stopped=!1,this.timeout_id=null,this.fireOnStart?this._run():this.check_run()},a.prototype.check_run=function(){var a=this;this.stopped||(this.timeout_id=setTimeout(function(){a._run()},this.interval))},a.prototype._run=function(){c.defer(this.bound_fn),this.check_run()},a.prototype.stop=function(){this.stopped=!0,null!==this.timeout_id&&window.clearTimeout(this.timeout_id)},a.prototype.clear=function(){this.stop(),this.stopped=!0,this.scope=null,this.fireOnStart=null,this.run=null,this.interval=null,this.bound_fn=null,this.timeout_id=null},a}();b.TaskRunner=d}),define("modules/common/event_logger",["require","exports","./task_runner","underscore","jquery","modules/globals/url"],function(a,b,c){var d=a("underscore"),e=a("jquery"),f=a("modules/globals/url"),g=function(){function b(){if(this.log_messages=[],null!==b.instance)throw"Please use Logger.getInstance() to get the logger instance";this.log_messages=[],this.startSending()}return b.getInstance=function(){return null===b.instance&&(b.instance=new b),b.instance},b.prototype.send_log=function(){var a=f.site+"sites/ajax/api/log_events";if(0===this.log_messages.length)return null;var b={logs:JSON.stringify(this.log_messages)};console.log("Sending logs to the server");var c=e.ajax(a,{type:"POST",data:b});c.done(function(a){console.log("Sending logs success "+JSON.stringify(a))}),c.fail(function(){console.log("Failed to send logs ...")}),this.log_messages=[]},b.prototype.startSending=function(){this.send_log_task=new c.TaskRunner;var a=b.LOG_COLLECTION_INTERVAL,d={run:this.send_log,interval:1e3*a,scope:this,fireOnStart:!1};this.send_log_task.start(d)},b.prototype.flattenObject=function(a){return d.each(a,function(b,c){d.isObject(b)&&(b=JSON.stringify(b)),a[c]=b}),a},b.prototype.buildMessageObject=function(b,c,e){"undefined"==typeof e&&(e={});var f={};e=this.flattenObject(e),d.extend(f,e),f.eventType=b,f.message=c;var g=a("modules/globals/session_user");return null!==g?(f.username=g.username,f.user_id=g.id):(f.username="",f.user_id=0),f},b.prototype.addMessageToQueue=function(a,b,c){"undefined"==typeof c&&(c={});var d=this.buildMessageObject(a,b,c);this.log_messages.push(d)},b.prototype.log=function(a,b){for(var c=[],d=0;d<arguments.length-2;d++)c[d]=arguments[d+2];var e="LOG";console.log([e,a,b,c]),this.addMessageToQueue(e,a,b)},b.prototype.warn=function(a,b){for(var c=[],d=0;d<arguments.length-2;d++)c[d]=arguments[d+2];var e="WARN";console.warn([e,a,b,c]),this.addMessageToQueue(e,a,b)},b.prototype.error=function(a,b){for(var c=[],d=0;d<arguments.length-2;d++)c[d]=arguments[d+2];var e="ERROR";console.error([e,a,b,c]),this.addMessageToQueue(e,a,b),this.send_log()},b.instance=null,b.LOG_COLLECTION_INTERVAL=60,b}();b.Logger=g}),function(a){"function"==typeof define&&define.amd?define("jquery.mousewheel",["jquery"],a):"object"==typeof exports?module.exports=a:a(jQuery)}(function(a){function b(b){var g=b||window.event,h=i.call(arguments,1),j=0,k=0,l=0,m=0;if(b=a.event.fix(g),b.type="mousewheel","detail"in g&&(l=-1*g.detail),"wheelDelta"in g&&(l=g.wheelDelta),"wheelDeltaY"in g&&(l=g.wheelDeltaY),"wheelDeltaX"in g&&(k=-1*g.wheelDeltaX),"axis"in g&&g.axis===g.HORIZONTAL_AXIS&&(k=-1*l,l=0),j=0===l?k:l,"deltaY"in g&&(l=-1*g.deltaY,j=l),"deltaX"in g&&(k=g.deltaX,0===l&&(j=-1*k)),0!==l||0!==k){if(1===g.deltaMode){var n=a.data(this,"mousewheel-line-height");j*=n,l*=n,k*=n}else if(2===g.deltaMode){var o=a.data(this,"mousewheel-page-height");j*=o,l*=o,k*=o}return m=Math.max(Math.abs(l),Math.abs(k)),(!f||f>m)&&(f=m,d(g,m)&&(f/=40)),d(g,m)&&(j/=40,k/=40,l/=40),j=Math[j>=1?"floor":"ceil"](j/f),k=Math[k>=1?"floor":"ceil"](k/f),l=Math[l>=1?"floor":"ceil"](l/f),b.deltaX=k,b.deltaY=l,b.deltaFactor=f,b.deltaMode=0,h.unshift(b,j,k,l),e&&clearTimeout(e),e=setTimeout(c,200),(a.event.dispatch||a.event.handle).apply(this,h)}}function c(){f=null}function d(a,b){return k.settings.adjustOldDeltas&&"mousewheel"===a.type&&b%120===0}var e,f,g=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],h="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],i=Array.prototype.slice;if(a.event.fixHooks)for(var j=g.length;j;)a.event.fixHooks[g[--j]]=a.event.mouseHooks;var k=a.event.special.mousewheel={version:"3.1.9",setup:function(){if(this.addEventListener)for(var c=h.length;c;)this.addEventListener(h[--c],b,!1);else this.onmousewheel=b;a.data(this,"mousewheel-line-height",k.getLineHeight(this)),a.data(this,"mousewheel-page-height",k.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var a=h.length;a;)this.removeEventListener(h[--a],b,!1);else this.onmousewheel=null},getLineHeight:function(b){return parseInt(a(b)["offsetParent"in a.fn?"offsetParent":"parent"]().css("fontSize"),10)},getPageHeight:function(b){return a(b).height()},settings:{adjustOldDeltas:!0}};a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})}),"undefined"!=typeof module&&module.exports&&(module.exports=pluralRuleParser),define("CLDRPluralRuleParser",function(){}),function(a){var b,c=Array.prototype.slice,d=function(b){this.options=a.extend({},d.defaults,b),this.parser=this.options.parser,this.locale=this.options.locale,this.messageStore=this.options.messageStore,this.languages={},this.init()};d.prototype={init:function(){var b;b=this,b.messageStore.init(b.locale),String.locale=b.locale,String.prototype.toLocaleString=function(){var c,d,e,f,g,h;for(f=this.valueOf(),g=b.locale,h=0;g;){c=g.toLowerCase().split("-"),e=c.length;do{var i=c.slice(0,e).join("-");if(b.options.messageLocationResolver&&(d=b.options.messageLocationResolver(i,f))&&!b.messageStore.isLoaded(i,d)&&b.messageStore.load(d,i),d=b.messageStore.get(i,f))return d;e--}while(e);if("en"===g)break;g=a.i18n.fallbacks[b.locale]&&a.i18n.fallbacks[b.locale][h]||b.options.fallbackLocale,b.log("Trying fallback locale for "+b.locale+": "+g),h++}return""}},destroy:function(){a.removeData(document,"i18n")},load:function(a,b){this.messageStore.load(a,b)},log:function(){window.console&&a.i18n.debug&&window.console.log.apply(window.console,arguments)},parse:function(b,c){var d=b.toLocaleString();return this.parser.language=a.i18n.languages[a.i18n().locale]||a.i18n.languages["default"],""===d&&(d=b),this.parser.parse(d,c)}},a.i18n=function(b,e){var f,g=a.data(document,"i18n");return(f="object"==typeof b&&b)&&f.locale&&g&&g.locale!==f.locale&&(String.locale=g.locale=f.locale),g||(g=new d(f),a.data(document,"i18n",g)),"string"==typeof b?(f=void 0!==e?c.call(arguments,1):[],g.parse(b,f)):g},a.fn.i18n=function(){var b=a.data(document,"i18n");return String.locale=b.locale,b||(b=new d,a.data(document,"i18n",b)),this.each(function(){var b=a(this);if(b.data("i18n")){var c=b.data("i18n").toLocaleString();""!==c&&b.text(c)}else b.find("[data-i18n]").i18n()})},String.locale=String.locale||a("html").attr("lang"),String.locale||(void 0!==typeof window.navigator?(b=window.navigator,String.locale=b.language||b.userLanguage||""):String.locale=""),a.i18n.languages={},a.i18n.messageStore=a.i18n.messageStore||{},a.i18n.parser={parse:function(a,b){return a.replace(/\$(\d+)/g,function(a,c){var d=parseInt(c,10)-1;return void 0!==b[d]?b[d]:"$"+c})},emitter:{}},a.i18n.debug=!1,d.defaults={locale:String.locale,fallbackLocale:"en",parser:a.i18n.parser,messageStore:a.i18n.messageStore,messageLocationResolver:null},a.I18N=d}(jQuery),function(a){var b=function(){this.language=a.i18n.languages[String.locale]||a.i18n.languages["default"]};b.prototype={constructor:b,emit:function(b,c){var d,e,f=this;switch(typeof b){case"string":case"number":d=b;break;case"object":if(d=a.map(b.slice(1),function(a){return f.emit(a,c)}),e=b[0].toLowerCase(),"function"!=typeof f[e])throw Error('unknown operation "'+e+'"');d=f[e](d,c);break;case"undefined":d="";break;default:throw Error("unexpected type in AST: "+typeof b)}return d},concat:function(b){var c="";return a.each(b,function(a,b){c+=b}),c},replace:function(a,b){var c=parseInt(a[0],10);return c<b.length?b[c]:"$"+(c+1)},plural:function(a){var b=parseFloat(this.language.convertNumber(a[0],10));return a=a.slice(1),a.length?this.language.convertPlural(b,a):""},gender:function(a){var b=a[0];return a=a.slice(1),this.language.gender(b,a)},grammar:function(a){var b=a[0];return(a=a[1])&&b&&this.language.convertGrammar(a,b)}},a.extend(a.i18n.parser.emitter,new b)}(jQuery),function(a){a.i18n=a.i18n||{},a.i18n.fallbacks={ab:["ru"],ace:["id"],aln:["sq"],als:["gsw","de"],an:["es"],anp:["hi"],arn:["es"],arz:["ar"],av:["ru"],ay:["es"],ba:["ru"],bar:["de"],"bat-smg":["sgs","lt"],bcc:["fa"],"be-x-old":["be-tarask"],bh:["bho"],bjn:["id"],bm:["fr"],bpy:["bn"],bqi:["fa"],bug:["id"],"cbk-zam":["es"],ce:["ru"],crh:["crh-latn"],"crh-cyrl":["ru"],csb:["pl"],cv:["ru"],"de-at":["de"],"de-ch":["de"],"de-formal":["de"],dsb:["de"],dtp:["ms"],egl:["it"],eml:["it"],ff:["fr"],fit:["fi"],"fiu-vro":["vro","et"],frc:["fr"],frp:["fr"],frr:["de"],fur:["it"],gag:["tr"],gan:["gan-hant","zh-hant","zh-hans"],"gan-hans":["zh-hans"],"gan-hant":["zh-hant","zh-hans"],gl:["pt"],glk:["fa"],gn:["es"],gsw:["de"],hif:["hif-latn"],hsb:["de"],ht:["fr"],ii:["zh-cn","zh-hans"],inh:["ru"],iu:["ike-cans"],jut:["da"],jv:["id"],kaa:["kk-latn","kk-cyrl"],kbd:["kbd-cyrl"],khw:["ur"],kiu:["tr"],kk:["kk-cyrl"],"kk-arab":["kk-cyrl"],"kk-latn":["kk-cyrl"],"kk-cn":["kk-arab","kk-cyrl"],"kk-kz":["kk-cyrl"],"kk-tr":["kk-latn","kk-cyrl"],kl:["da"],"ko-kp":["ko"],koi:["ru"],krc:["ru"],ks:["ks-arab"],ksh:["de"],ku:["ku-latn"],"ku-arab":["ckb"],kv:["ru"],lad:["es"],lb:["de"],lbe:["ru"],lez:["ru"],li:["nl"],lij:["it"],liv:["et"],lmo:["it"],ln:["fr"],ltg:["lv"],lzz:["tr"],mai:["hi"],"map-bms":["jv","id"],mg:["fr"],mhr:["ru"],min:["id"],mo:["ro"],mrj:["ru"],mwl:["pt"],myv:["ru"],mzn:["fa"],nah:["es"],nap:["it"],nds:["de"],"nds-nl":["nl"],"nl-informal":["nl"],no:["nb"],os:["ru"],pcd:["fr"],pdc:["de"],pdt:["de"],pfl:["de"],pms:["it"],pt:["pt-br"],"pt-br":["pt"],qu:["es"],qug:["qu","es"],rgn:["it"],rmy:["ro"],"roa-rup":["rup"],rue:["uk","ru"],ruq:["ruq-latn","ro"],"ruq-cyrl":["mk"],"ruq-latn":["ro"],sa:["hi"],sah:["ru"],scn:["it"],sg:["fr"],sgs:["lt"],sli:["de"],sr:["sr-ec"],srn:["nl"],stq:["de"],su:["id"],szl:["pl"],tcy:["kn"],tg:["tg-cyrl"],tt:["tt-cyrl","ru"],"tt-cyrl":["ru"],ty:["fr"],udm:["ru"],ug:["ug-arab"],uk:["ru"],vec:["it"],vep:["et"],vls:["nl"],vmf:["de"],vot:["fi"],vro:["et"],wa:["fr"],wo:["fr"],wuu:["zh-hans"],xal:["ru"],xmf:["ka"],yi:["he"],za:["zh-hans"],zea:["nl"],zh:["zh-hans"],"zh-classical":["lzh"],"zh-cn":["zh-hans"],"zh-hant":["zh-hans"],"zh-hk":["zh-hant","zh-hans"],"zh-min-nan":["nan"],"zh-mo":["zh-hk","zh-hant","zh-hans"],"zh-my":["zh-sg","zh-hans"],"zh-sg":["zh-hans"],"zh-tw":["zh-hant","zh-hans"],"zh-yue":["yue"]}}(jQuery),function(a){a.extend(a.i18n.languages,{"default":{pluralRules:{gv:{one:"n mod 10 in 1..2 or n mod 20 is 0"},gu:{one:"n is 1"},rof:{one:"n is 1"},ga:{few:"n in 3..6",many:"n in 7..10",two:"n is 2",one:"n is 1"},gl:{one:"n is 1"},lg:{one:"n is 1"},lb:{one:"n is 1"},xog:{one:"n is 1"},ln:{one:"n in 0..1"},lo:"",brx:{one:"n is 1"},tr:"",ts:{one:"n is 1"},tn:{one:"n is 1"},to:"",lt:{few:"n mod 10 in 2..9 and n mod 100 not in 11..19",one:"n mod 10 is 1 and n mod 100 not in 11..19"},tk:{one:"n is 1"},th:"",ksb:{one:"n is 1"},te:{one:"n is 1"},ksh:{zero:"n is 0",one:"n is 1"},fil:{one:"n in 0..1"},haw:{one:"n is 1"},kcg:{one:"n is 1"},ssy:{one:"n is 1"},yo:"",de:{one:"n is 1"},ko:"",da:{one:"n is 1"},dz:"",dv:{one:"n is 1"},guw:{one:"n in 0..1"},shi:{few:"n in 2..10",one:"n within 0..1"},el:{one:"n is 1"},eo:{one:"n is 1"},en:{one:"n is 1"},ses:"",teo:{one:"n is 1"},ee:{one:"n is 1"},kde:"",fr:{one:"n within 0..2 and n is not 2"},eu:{one:"n is 1"},et:{one:"n is 1"},es:{one:"n is 1"},seh:{one:"n is 1"},ru:{few:"n mod 10 in 2..4 and n mod 100 not in 12..14",many:"n mod 10 is 0 or n mod 10 in 5..9 or n mod 100 in 11..14",one:"n mod 10 is 1 and n mod 100 is not 11"},kl:{one:"n is 1"},sms:{two:"n is 2",one:"n is 1"},smn:{two:"n is 2",one:"n is 1"},smj:{two:"n is 2",one:"n is 1"},smi:{two:"n is 2",one:"n is 1"},fy:{one:"n is 1"},rm:{one:"n is 1"},ro:{few:"n is 0 OR n is not 1 AND n mod 100 in 1..19",one:"n is 1"},bn:{one:"n is 1"},sma:{two:"n is 2",one:"n is 1"},be:{few:"n mod 10 in 2..4 and n mod 100 not in 12..14",many:"n mod 10 is 0 or n mod 10 in 5..9 or n mod 100 in 11..14",one:"n mod 10 is 1 and n mod 100 is not 11"},bg:{one:"n is 1"},ms:"",wa:{one:"n in 0..1"},ps:{one:"n is 1"},wo:"",bm:"",jv:"",bo:"",bh:{one:"n in 0..1"},kea:"",asa:{one:"n is 1"},cgg:{one:"n is 1"},br:{few:"n mod 10 in 3..4,9 and n mod 100 not in 10..19,70..79,90..99",many:"n mod 1000000 is 0 and n is not 0",two:"n mod 10 is 2 and n mod 100 not in 12,72,92",one:"n mod 10 is 1 and n mod 100 not in 11,71,91"},bs:{few:"n mod 10 in 2..4 and n mod 100 not in 12..14",many:"n mod 10 is 0 or n mod 10 in 5..9 or n mod 100 in 11..14",one:"n mod 10 is 1 and n mod 100 is not 11"},ja:"",om:{one:"n is 1"},fa:"",vun:{one:"n is 1"},or:{one:"n is 1"},xh:{one:"n is 1"},nso:{one:"n in 0..1"},ca:{one:"n is 1"},cy:{few:"n is 3",zero:"n is 0",many:"n is 6",two:"n is 2",one:"n is 1"},cs:{few:"n in 2..4",one:"n is 1"},zh:"",lv:{zero:"n is 0",one:"n mod 10 is 1 and n mod 100 is not 11"},pt:{one:"n is 1"},wae:{one:"n is 1"},tl:{one:"n in 0..1"},chr:{one:"n is 1"},pa:{one:"n is 1"},ak:{one:"n in 0..1"},pl:{few:"n mod 10 in 2..4 and n mod 100 not in 12..14",many:"n is not 1 and n mod 10 in 0..1 or n mod 10 in 5..9 or n mod 100 in 12..14",one:"n is 1"},hr:{few:"n mod 10 in 2..4 and n mod 100 not in 12..14",many:"n mod 10 is 0 or n mod 10 in 5..9 or n mod 100 in 11..14",one:"n mod 10 is 1 and n mod 100 is not 11"},am:{one:"n in 0..1"},ti:{one:"n in 0..1"},hu:"",hi:{one:"n in 0..1"},jmc:{one:"n is 1"},ha:{one:"n is 1"},he:{one:"n is 1"},mg:{one:"n in 0..1"},fur:{one:"n is 1"},bem:{one:"n is 1"},ml:{one:"n is 1"},mo:{few:"n is 0 OR n is not 1 AND n mod 100 in 1..19",one:"n is 1"},mn:{one:"n is 1"},mk:{one:"n mod 10 is 1 and n is not 11"},ur:{one:"n is 1"},bez:{one:"n is 1"},mt:{few:"n is 0 or n mod 100 in 2..10",many:"n mod 100 in 11..19",one:"n is 1"},uk:{few:"n mod 10 in 2..4 and n mod 100 not in 12..14",many:"n mod 10 is 0 or n mod 10 in 5..9 or n mod 100 in 11..14",one:"n mod 10 is 1 and n mod 100 is not 11"},mr:{one:"n is 1"},ta:{one:"n is 1"},my:"",sah:"",ve:{one:"n is 1"},af:{one:"n is 1"},vi:"",is:{one:"n is 1"},iu:{two:"n is 2",one:"n is 1"},it:{one:"n is 1"},kn:"",ii:"",ar:{few:"n mod 100 in 3..10",zero:"n is 0",many:"n mod 100 in 11..99",two:"n is 2",one:"n is 1"},zu:{one:"n is 1"},saq:{one:"n is 1"},az:"",tzm:{one:"n in 0..1 or n in 11..99"},id:"",ig:"",pap:{one:"n is 1"},nl:{one:"n is 1"},nn:{one:"n is 1"},no:{one:"n is 1"},nah:{one:"n is 1"},nd:{one:"n is 1"},ne:{one:"n is 1"},ny:{one:"n is 1"},naq:{two:"n is 2",one:"n is 1"},nyn:{one:"n is 1"},kw:{two:"n is 2",one:"n is 1"},nr:{one:"n is 1"},tig:{one:"n is 1"},kab:{one:"n within 0..2 and n is not 2"},mas:{one:"n is 1"},rwk:{one:"n is 1"},kaj:{one:"n is 1"},lag:{zero:"n is 0",one:"n within 0..2 and n is not 0 and n is not 2"},syr:{one:"n is 1"},kk:{one:"n is 1"},ff:{one:"n within 0..2 and n is not 2"},fi:{one:"n is 1"},fo:{one:"n is 1"},ka:"",gsw:{one:"n is 1"},ckb:{one:"n is 1"},ss:{one:"n is 1"},sr:{few:"n mod 10 in 2..4 and n mod 100 not in 12..14",many:"n mod 10 is 0 or n mod 10 in 5..9 or n mod 100 in 11..14",one:"n mod 10 is 1 and n mod 100 is not 11"},sq:{one:"n is 1"},sw:{one:"n is 1"},sv:{one:"n is 1"},km:"",st:{one:"n is 1"},sk:{few:"n in 2..4",one:"n is 1"},sh:{few:"n mod 10 in 2..4 and n mod 100 not in 12..14",many:"n mod 10 is 0 or n mod 10 in 5..9 or n mod 100 in 11..14",one:"n mod 10 is 1 and n mod 100 is not 11"},so:{one:"n is 1"},sn:{one:"n is 1"},ku:{one:"n is 1"},sl:{few:"n mod 100 in 3..4",two:"n mod 100 is 2",one:"n mod 100 is 1"},sg:"",nb:{one:"n is 1"},se:{two:"n is 2",one:"n is 1"}},convertPlural:function(b,c){var d;return c&&0!==c.length?(d=this.pluralRules[a.i18n().locale])?(d=this.getPluralForm(b,d),d=Math.min(d,c.length-1),c[d]):1===b?c[0]:c[1]:""},getPluralForm:function(a,b){var c,d="zero one two few many other".split(" "),e=0;for(c=0;c<d.length;c++)if(b[d[c]]){if(pluralRuleParser(b[d[c]],a))break;e++}return e},convertNumber:function(b,c){var d,e,f,g,h;if(f=this.digitTransformTable(a.i18n().locale),g=""+b,h="",!f)return b;if(c){if(parseFloat(b,10)===b)return b;d=[];for(e in f)d[f[e]]=e;f=d}for(d=0;d<g.length;d++)h=f[g[d]]?h+f[g[d]]:h+g[d];return c?parseFloat(h,10):h},convertGrammar:function(a){return a},gender:function(a,b){if(!b||0===b.length)return"";for(;2>b.length;)b.push(b[b.length-1]);return"male"===a?b[0]:"female"===a?b[1]:3===b.length?b[2]:b[0]},digitTransformTable:function(a){var b={ar:"٠١٢٣٤٥٦٧٨٩",fa:"۰۱۲۳۴۵۶۷۸۹",ml:"൦൧൨൩൪൫൬൭൮൯",kn:"೦೧೨೩೪೫೬೭೮೯",lo:"໐໑໒໓໔໕໖໗໘໙",or:"୦୧୨୩୪୫୬୭୮୯",kh:"០១២៣៤៥៦៧៨៩",pa:"੦੧੨੩੪੫੬੭੮੯",gu:"૦૧૨૩૪૫૬૭૮૯",hi:"०१२३४५६७८९",my:"၀၁၂၃၄၅၆၇၈၉",ta:"௦௧௨௩௪௫௬௭௮௯",te:"౦౧౨౩౪౫౬౭౮౯",th:"๐๑๒๓๔๕๖๗๘๙",bo:"༠༡༢༣༤༥༦༧༨༩"};return b[a]?b[a].split(""):!1}}})}(jQuery),function(a,b){var c=function(){this.messages={},this.sources={},this.locale=String.locale};c.prototype={init:function(b){var c=this;c.locale=b,c.log("initializing for "+b),a("link").each(function(b,d){var e=a(d),f=(e.attr("rel")||"").toLowerCase().split(/\s+/);-1!==a.inArray("localizations",f)?c.load(e.attr("href")):-1!==a.inArray("localization",f)&&c.queue((e.attr("hreflang")||"").toLowerCase(),e.attr("href"))})},load:function(a,b){var c=null,d=this,e=Object.prototype.hasOwnProperty;if(a)if("string"==typeof a)d.log("Loading messages from: "+a),d.jsonMessageLoader(a).done(function(c){d.load(c,b),d.queue(b,a),d.markLoaded(b,a)});else for(c in a)e.call(a,c)&&(b?(d.messages[b]||(d.messages[b]={}),d.messages[b][c]=a[c],d.log("["+b+"]["+c+"] : "+a[c])):d.load(a[c],c));else d.log("Resetting for locale "+b),d.messages={}},log:function(){b.console&&a.i18n.debug&&b.console.log.apply(b.console,arguments)},markLoaded:function(a,b){var c,d=this.sources[a];for(d||(this.queue(a,b),d=this.sources[a]),this.sources[a]=this.sources[a]||[],c=0;c<d.length;c++)if(d[c].source.url===b){d[c].source.loaded=!0;break}},queue:function(a,b){var c,d=this.sources[a];if(this.sources[a]=this.sources[a]||[],d)for(c=0;c<d.length;c++)if(d[c].source.url===b)return;this.log("Source for: "+a+" is "+b+" registered"),this.sources[a].push({source:{url:b,loaded:!1}})},loadFromQueue:function(a){var b,c=this.sources[a];if(c)for(b=0;b<c.length;b++)c[b].source.loaded||(this.load(c[b].source.url,a),this.sources[a][b].source.loaded=!0)},isLoaded:function(a,b){var c,d=this.sources[a],e=!1;if(d)for(c=0;c<d.length;c++)d[c].source.url===b&&(e=!0);return e},jsonMessageLoader:function(b){var c=this;return a.ajax({url:b,dataType:"json",async:!1}).fail(function(a,d,e){c.log("Error in loading messages from "+b+" Exception: "+e)})},get:function(a,b){return this.messages[a]||this.loadFromQueue(a),this.messages[a]&&this.messages[a][b]}},a.extend(a.i18n.messageStore,new c)}(jQuery,window),function(a){var b=function(b){this.options=a.extend({},a.i18n.parser.defaults,b),this.language=a.i18n.languages[String.locale]||a.i18n.languages["default"],this.emitter=a.i18n.parser.emitter};b.prototype={constructor:b,simpleParse:function(a,b){return a.replace(/\$(\d+)/g,function(a,c){var d=parseInt(c,10)-1;return void 0!==b[d]?b[d]:"$"+c})},parse:function(b,c){return 0>b.indexOf("{{")?this.simpleParse(b,c):(this.emitter.language=a.i18n.languages[a.i18n().locale]||a.i18n.languages["default"],this.emitter.emit(this.ast(b),c))},ast:function(a){function b(a){return function(){var b,c;for(b=0;b<a.length;b++)if(c=a[b](),null!==c)return c;return null}}function c(a){var b,c,d=m,e=[];for(b=0;b<a.length;b++){if(c=a[b](),null===c)return m=d,null;e.push(c)}return e}function d(a,b){return function(){for(var c=m,d=[],e=b();null!==e;)d.push(e),e=b();return d.length<a?(m=c,null):d}}function e(b){var c=b.length;return function(){var d=null;return a.substr(m,c)===b&&(d=b,m+=c),d}}function f(b){return function(){var c=a.substr(m).match(b);return null===c?null:(m+=c[0].length,c[0])}}function g(){var a=c([p,q]);return null===a?null:a[1]}function h(){var a=c([r,s]);return null===a?null:["REPLACE",parseInt(a[1],10)-1]}function i(){var a=c([n,d(0,D)]);return null===a?null:(a=a[1],1<a.length?["CONCAT"].concat(a):a[0])}function j(){var a=c([w,o,h]);return null===a?null:[a[0],a[2]]}function k(){var a=c([w,o,D]);return null===a?null:[a[0],a[2]]}function l(){var a=c([B,A,C]);return null===a?null:a[1]}var m=0,n=e("|"),o=e(":"),p=e("\\"),q=f(/^./),r=e("$"),s=f(/^\d+/),t=f(/^[^{}\[\]$\\]/),u=f(/^[^{}\[\]$\\|]/),v=f(/^[^{}\[\]$\s]/);b([g,v]);var w,x=b([g,u]),y=b([g,t]),z=f(/^[ !"$&'()*,.\/0-9;=?@A-Z\^_`a-z~\x80-\xFF+\-]+/);w=function(){var a=z();return null===a?null:a.toString()};var A=b([function(){var a=c([b([j,k]),d(0,i)]);return null===a?null:a[0].concat(a[1])},function(){var a=c([w,d(0,i)]);return null===a?null:[a[0]].concat(a[1])}]),B=e("{{"),C=e("}}"),t=b([l,h,function(){var a=d(1,y)();return null===a?null:a.join("")}]),D=b([l,h,function(){var a=d(1,x)();return null===a?null:a.join("")}]);if(t=d(0,t)(),t=null===t?null:["CONCAT"].concat(t),null===t||m!==a.length)throw Error("Parse error at position "+m.toString()+" in input: "+a);return t}},a.extend(a.i18n.parser,new b)}(jQuery),define("jquery.i18n",["jquery","CLDRPluralRuleParser"],function(){}),function(){function a(){}function b(a,b){for(var c=a.length;c--;)if(a[c].listener===b)return c;return-1}function c(a){return function(){return this[a].apply(this,arguments)}}var d=a.prototype,e=this,f=e.EventEmitter;d.getListeners=function(a){var b,c,d=this._getEvents();if(a instanceof RegExp){b={};for(c in d)d.hasOwnProperty(c)&&a.test(c)&&(b[c]=d[c])}else b=d[a]||(d[a]=[]);return b},d.flattenListeners=function(a){var b,c=[];for(b=0;b<a.length;b+=1)c.push(a[b].listener);return c},d.getListenersAsObject=function(a){var b,c=this.getListeners(a);return c instanceof Array&&(b={},b[a]=c),b||c},d.addListener=function(a,c){var d,e=this.getListenersAsObject(a),f="object"==typeof c;for(d in e)e.hasOwnProperty(d)&&-1===b(e[d],c)&&e[d].push(f?c:{listener:c,once:!1});return this},d.on=c("addListener"),d.addOnceListener=function(a,b){return this.addListener(a,{listener:b,once:!0})},d.once=c("addOnceListener"),d.defineEvent=function(a){return this.getListeners(a),this},d.defineEvents=function(a){for(var b=0;b<a.length;b+=1)this.defineEvent(a[b]);return this},d.removeListener=function(a,c){var d,e,f=this.getListenersAsObject(a);for(e in f)f.hasOwnProperty(e)&&(d=b(f[e],c),-1!==d&&f[e].splice(d,1));return this},d.off=c("removeListener"),d.addListeners=function(a,b){return this.manipulateListeners(!1,a,b)},d.removeListeners=function(a,b){return this.manipulateListeners(!0,a,b)},d.manipulateListeners=function(a,b,c){var d,e,f=a?this.removeListener:this.addListener,g=a?this.removeListeners:this.addListeners;if("object"!=typeof b||b instanceof RegExp)for(d=c.length;d--;)f.call(this,b,c[d]);else for(d in b)b.hasOwnProperty(d)&&(e=b[d])&&("function"==typeof e?f.call(this,d,e):g.call(this,d,e));return this},d.removeEvent=function(a){var b,c=typeof a,d=this._getEvents();if("string"===c)delete d[a];else if(a instanceof RegExp)for(b in d)d.hasOwnProperty(b)&&a.test(b)&&delete d[b];else delete this._events;return this},d.removeAllListeners=c("removeEvent"),d.emitEvent=function(a,b){var c,d,e,f,g=this.getListenersAsObject(a);for(e in g)if(g.hasOwnProperty(e))for(d=g[e].length;d--;)c=g[e][d],c.once===!0&&this.removeListener(a,c.listener),f=c.listener.apply(this,b||[]),f===this._getOnceReturnValue()&&this.removeListener(a,c.listener);return this},d.trigger=c("emitEvent"),d.emit=function(a){var b=Array.prototype.slice.call(arguments,1);return this.emitEvent(a,b)},d.setOnceReturnValue=function(a){return this._onceReturnValue=a,this},d._getOnceReturnValue=function(){return this.hasOwnProperty("_onceReturnValue")?this._onceReturnValue:!0},d._getEvents=function(){return this._events||(this._events={})},a.noConflict=function(){return e.EventEmitter=f,a},"function"==typeof define&&define.amd?define("eventEmitter/EventEmitter",[],function(){return a}):"object"==typeof module&&module.exports?module.exports=a:this.EventEmitter=a}.call(this),function(a){function b(b){var c=a.event;return c.target=c.target||c.srcElement||b,c}var c=document.documentElement,d=function(){};c.addEventListener?d=function(a,b,c){a.addEventListener(b,c,!1)}:c.attachEvent&&(d=function(a,c,d){a[c+d]=d.handleEvent?function(){var c=b(a);d.handleEvent.call(d,c)}:function(){var c=b(a);d.call(a,c)},a.attachEvent("on"+c,a[c+d])});var e=function(){};c.removeEventListener?e=function(a,b,c){a.removeEventListener(b,c,!1)}:c.detachEvent&&(e=function(a,b,c){a.detachEvent("on"+b,a[b+c]);try{delete a[b+c]}catch(d){a[b+c]=void 0}});var f={bind:d,unbind:e};"function"==typeof define&&define.amd?define("eventie/eventie",f):"object"==typeof exports?module.exports=f:a.eventie=f}(this),function(a,b){"function"==typeof define&&define.amd?define("imagesloaded",["eventEmitter/EventEmitter","eventie/eventie"],function(c,d){return b(a,c,d)}):"object"==typeof exports?module.exports=b(a,require("eventEmitter"),require("eventie")):a.imagesLoaded=b(a,a.EventEmitter,a.eventie)}(this,function(a,b,c){function d(a,b){for(var c in b)a[c]=b[c];return a}function e(a){return"[object Array]"===m.call(a)}function f(a){var b=[];if(e(a))b=a;else if("number"==typeof a.length)for(var c=0,d=a.length;d>c;c++)b.push(a[c]);else b.push(a);return b}function g(a,b,c){if(!(this instanceof g))return new g(a,b);"string"==typeof a&&(a=document.querySelectorAll(a)),this.elements=f(a),this.options=d({},this.options),"function"==typeof b?c=b:d(this.options,b),c&&this.on("always",c),this.getImages(),j&&(this.jqDeferred=new j.Deferred);var e=this;setTimeout(function(){e.check();
})}function h(a){this.img=a}function i(a){this.src=a,n[a]=this}var j=a.jQuery,k=a.console,l="undefined"!=typeof k,m=Object.prototype.toString;g.prototype=new b,g.prototype.options={},g.prototype.getImages=function(){this.images=[];for(var a=0,b=this.elements.length;b>a;a++){var c=this.elements[a];"IMG"===c.nodeName&&this.addImage(c);for(var d=c.querySelectorAll("img"),e=0,f=d.length;f>e;e++){var g=d[e];this.addImage(g)}}},g.prototype.addImage=function(a){var b=new h(a);this.images.push(b)},g.prototype.check=function(){function a(a,e){return b.options.debug&&l&&k.log("confirm",a,e),b.progress(a),c++,c===d&&b.complete(),!0}var b=this,c=0,d=this.images.length;if(this.hasAnyBroken=!1,!d)return void this.complete();for(var e=0;d>e;e++){var f=this.images[e];f.on("confirm",a),f.check()}},g.prototype.progress=function(a){this.hasAnyBroken=this.hasAnyBroken||!a.isLoaded;var b=this;setTimeout(function(){b.emit("progress",b,a),b.jqDeferred&&b.jqDeferred.notify&&b.jqDeferred.notify(b,a)})},g.prototype.complete=function(){var a=this.hasAnyBroken?"fail":"done";this.isComplete=!0;var b=this;setTimeout(function(){if(b.emit(a,b),b.emit("always",b),b.jqDeferred){var c=b.hasAnyBroken?"reject":"resolve";b.jqDeferred[c](b)}})},j&&(j.fn.imagesLoaded=function(a,b){var c=new g(this,a,b);return c.jqDeferred.promise(j(this))}),h.prototype=new b,h.prototype.check=function(){var a=n[this.img.src]||new i(this.img.src);if(a.isConfirmed)return void this.confirm(a.isLoaded,"cached was confirmed");if(this.img.complete&&void 0!==this.img.naturalWidth)return void this.confirm(0!==this.img.naturalWidth,"naturalWidth");var b=this;a.on("confirm",function(a,c){return b.confirm(a.isLoaded,c),!0}),a.check()},h.prototype.confirm=function(a,b){this.isLoaded=a,this.emit("confirm",this,b)};var n={};return i.prototype=new b,i.prototype.check=function(){if(!this.isChecked){var a=new Image;c.bind(a,"load",this),c.bind(a,"error",this),a.src=this.src,this.isChecked=!0}},i.prototype.handleEvent=function(a){var b="on"+a.type;this[b]&&this[b](a)},i.prototype.onload=function(a){this.confirm(!0,"onload"),this.unbindProxyEvents(a)},i.prototype.onerror=function(a){this.confirm(!1,"onerror"),this.unbindProxyEvents(a)},i.prototype.confirm=function(a,b){this.isConfirmed=!0,this.isLoaded=a,this.emit("confirm",this,b)},i.prototype.unbindProxyEvents=function(a){c.unbind(a.target,"load",this),c.unbind(a.target,"error",this)},g}),function(a,b,c){!function(a){"function"==typeof define&&define.amd?define("qtip",["jquery"],a):jQuery&&!jQuery.fn.qtip&&a(jQuery)}(function(d){function e(a,b,c,e){this.id=c,this.target=a,this.tooltip=G,this.elements={target:a},this._id=T+"-"+c,this.timers={img:{}},this.options=b,this.plugins={},this.cache={event:{},target:d(),disabled:F,attr:e,onTooltip:F,lastClass:""},this.rendered=this.destroyed=this.disabled=this.waiting=this.hiddenDuringWait=this.positioning=this.triggering=F}function f(a){return a===G||"object"!==d.type(a)}function g(a){return!(d.isFunction(a)||a&&a.attr||a.length||"object"===d.type(a)&&(a.jquery||a.then))}function h(a){var b,c,e,h;return f(a)?F:(f(a.metadata)&&(a.metadata={type:a.metadata}),"content"in a&&(b=a.content,f(b)||b.jquery||b.done?b=a.content={text:c=g(b)?F:b}:c=b.text,"ajax"in b&&(e=b.ajax,h=e&&e.once!==F,delete b.ajax,b.text=function(a,b){var f=c||d(this).attr(b.options.content.attr)||"Loading...",g=d.ajax(d.extend({},e,{context:b})).then(e.success,G,e.error).then(function(a){return a&&h&&b.set("content.text",a),a},function(a,c,d){b.destroyed||0===a.status||b.set("content.text",c+": "+d)});return h?f:(b.set("content.text",f),g)}),"title"in b&&(f(b.title)||(b.button=b.title.button,b.title=b.title.text),g(b.title||F)&&(b.title=F))),"position"in a&&f(a.position)&&(a.position={my:a.position,at:a.position}),"show"in a&&f(a.show)&&(a.show=a.show.jquery?{target:a.show}:a.show===E?{ready:E}:{event:a.show}),"hide"in a&&f(a.hide)&&(a.hide=a.hide.jquery?{target:a.hide}:{event:a.hide}),"style"in a&&f(a.style)&&(a.style={classes:a.style}),d.each(S,function(){this.sanitize&&this.sanitize(a)}),a)}function i(a,b){for(var c,d=0,e=a,f=b.split(".");e=e[f[d++]];)d<f.length&&(c=e);return[c||a,f.pop()]}function j(a,b){var c,d,e;for(c in this.checks)for(d in this.checks[c])(e=new RegExp(d,"i").exec(a))&&(b.push(e),("builtin"===c||this.plugins[c])&&this.checks[c][d].apply(this.plugins[c]||this,b))}function k(a){return W.concat("").join(a?"-"+a+" ":" ")}function l(c){return c&&{type:c.type,pageX:c.pageX,pageY:c.pageY,target:c.target,relatedTarget:c.relatedTarget,scrollX:c.scrollX||a.pageXOffset||b.body.scrollLeft||b.documentElement.scrollLeft,scrollY:c.scrollY||a.pageYOffset||b.body.scrollTop||b.documentElement.scrollTop}||{}}function m(a,b){return b>0?setTimeout(d.proxy(a,this),b):void a.call(this)}function n(a){return this.tooltip.hasClass(ba)?F:(clearTimeout(this.timers.show),clearTimeout(this.timers.hide),void(this.timers.show=m.call(this,function(){this.toggle(E,a)},this.options.show.delay)))}function o(a){if(this.tooltip.hasClass(ba))return F;var b=d(a.relatedTarget),c=b.closest(X)[0]===this.tooltip[0],e=b[0]===this.options.show.target[0];if(clearTimeout(this.timers.show),clearTimeout(this.timers.hide),this!==b[0]&&"mouse"===this.options.position.target&&c||this.options.hide.fixed&&/mouse(out|leave|move)/.test(a.type)&&(c||e))try{a.preventDefault(),a.stopImmediatePropagation()}catch(f){}else this.timers.hide=m.call(this,function(){this.toggle(F,a)},this.options.hide.delay,this)}function p(a){return this.tooltip.hasClass(ba)||!this.options.hide.inactive?F:(clearTimeout(this.timers.inactive),void(this.timers.inactive=m.call(this,function(){this.hide(a)},this.options.hide.inactive)))}function q(a){this.rendered&&this.tooltip[0].offsetWidth>0&&this.reposition(a)}function r(a,c,e){d(b.body).delegate(a,(c.split?c:c.join(ha+" "))+ha,function(){var a=z.api[d.attr(this,V)];a&&!a.disabled&&e.apply(a,arguments)})}function s(a,c,f){var g,i,j,k,l,m=d(b.body),n=a[0]===b?m:a,o=a.metadata?a.metadata(f.metadata):G,p="html5"===f.metadata.type&&o?o[f.metadata.name]:G,q=a.data(f.metadata.name||"qtipopts");try{q="string"==typeof q?d.parseJSON(q):q}catch(r){}if(k=d.extend(E,{},z.defaults,f,"object"==typeof q?h(q):G,h(p||o)),i=k.position,k.id=c,"boolean"==typeof k.content.text){if(j=a.attr(k.content.attr),k.content.attr===F||!j)return F;k.content.text=j}if(i.container.length||(i.container=m),i.target===F&&(i.target=n),k.show.target===F&&(k.show.target=n),k.show.solo===E&&(k.show.solo=i.container.closest("body")),k.hide.target===F&&(k.hide.target=n),k.position.viewport===E&&(k.position.viewport=i.container),i.container=i.container.eq(0),i.at=new B(i.at,E),i.my=new B(i.my),a.data(T))if(k.overwrite)a.qtip("destroy",!0);else if(k.overwrite===F)return F;return a.attr(U,c),k.suppress&&(l=a.attr("title"))&&a.removeAttr("title").attr(da,l).attr("title",""),g=new e(a,k,c,!!j),a.data(T,g),a.one("remove.qtip-"+c+" removeqtip.qtip-"+c,function(){var a;(a=d(this).data(T))&&a.destroy(!0)}),g}function t(a){return a.charAt(0).toUpperCase()+a.slice(1)}function u(a,b){var d,e,f=b.charAt(0).toUpperCase()+b.slice(1),g=(b+" "+sa.join(f+" ")+f).split(" "),h=0;if(ra[b])return a.css(ra[b]);for(;d=g[h++];)if((e=a.css(d))!==c)return ra[b]=d,e}function v(a,b){return Math.ceil(parseFloat(u(a,b)))}function w(a,b){this._ns="tip",this.options=b,this.offset=b.offset,this.size=[b.width,b.height],this.init(this.qtip=a)}function x(a,b){this.options=b,this._ns="-modal",this.init(this.qtip=a)}function y(a,b){this._ns="ie6",this.init(this.qtip=a)}var z,A,B,C,D,E=!0,F=!1,G=null,H="x",I="y",J="width",K="height",L="top",M="left",N="bottom",O="right",P="center",Q="flipinvert",R="shift",S={},T="qtip",U="data-hasqtip",V="data-qtip-id",W=["ui-widget","ui-tooltip"],X="."+T,Y="click dblclick mousedown mouseup mousemove mouseleave mouseenter".split(" "),Z=T+"-fixed",$=T+"-default",_=T+"-focus",aa=T+"-hover",ba=T+"-disabled",ca="_replacedByqTip",da="oldtitle",ea={ie:function(){for(var a=3,c=b.createElement("div");(c.innerHTML="<!--[if gt IE "+ ++a+"]><i></i><![endif]-->")&&c.getElementsByTagName("i")[0];);return a>4?a:NaN}(),iOS:parseFloat((""+(/CPU.*OS ([0-9_]{1,5})|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))||F};A=e.prototype,A._when=function(a){return d.when.apply(d,a)},A.render=function(a){if(this.rendered||this.destroyed)return this;var b,c=this,e=this.options,f=this.cache,g=this.elements,h=e.content.text,i=e.content.title,j=e.content.button,k=e.position,l=("."+this._id+" ",[]);return d.attr(this.target[0],"aria-describedby",this._id),ea.iOS||(this.tooltip=g.tooltip=b=d("<div/>",{id:this._id,"class":[T,$,e.style.classes,T+"-pos-"+e.position.my.abbrev()].join(" "),width:e.style.width||"",height:e.style.height||"",tracking:"mouse"===k.target&&k.adjust.mouse,role:"alert","aria-live":"polite","aria-atomic":F,"aria-describedby":this._id+"-content","aria-hidden":E}).toggleClass(ba,this.disabled).attr(V,this.id).data(T,this).appendTo(k.container).append(g.content=d("<div />",{"class":T+"-content",id:this._id+"-content","aria-atomic":E}))),this.rendered=-1,this.positioning=E,i&&(this._createTitle(),d.isFunction(i)||l.push(this._updateTitle(i,F))),j&&this._createButton(),d.isFunction(h)||l.push(this._updateContent(h,F)),this.rendered=E,this._setWidget(),d.each(S,function(a){var b;"render"===this.initialize&&(b=this(c))&&(c.plugins[a]=b)}),this._unassignEvents(),this._assignEvents(),this._when(l).then(function(){c._trigger("render"),c.positioning=F,c.hiddenDuringWait||!e.show.ready&&!a||c.toggle(E,f.event,F),c.hiddenDuringWait=F}),z.api[this.id]=this,this},A.destroy=function(a){function b(){if(!this.destroyed){this.destroyed=E;var a=this.target,b=a.attr(da);this.rendered&&this.tooltip.stop(1,0).find("*").remove().end().remove(),d.each(this.plugins,function(a){this.destroy&&this.destroy()}),clearTimeout(this.timers.show),clearTimeout(this.timers.hide),this._unassignEvents(),a.removeData(T).removeAttr(V).removeAttr(U).removeAttr("aria-describedby"),this.options.suppress&&b&&a.attr("title",b).removeAttr(da),this._unbind(a),this.options=this.elements=this.cache=this.timers=this.plugins=this.mouse=G,delete z.api[this.id]}}return this.destroyed?this.target:(a===E&&"hide"!==this.triggering||!this.rendered?b.call(this):(this.tooltip.one("tooltiphidden",d.proxy(b,this)),!this.triggering&&this.hide()),this.target)},C=A.checks={builtin:{"^id$":function(a,b,c,e){var f=c===E?z.nextid:c,g=T+"-"+f;f!==F&&f.length>0&&!d("#"+g).length?(this._id=g,this.rendered&&(this.tooltip[0].id=this._id,this.elements.content[0].id=this._id+"-content",this.elements.title[0].id=this._id+"-title")):a[b]=e},"^prerender":function(a,b,c){c&&!this.rendered&&this.render(this.options.show.ready)},"^content.text$":function(a,b,c){this._updateContent(c)},"^content.attr$":function(a,b,c,d){this.options.content.text===this.target.attr(d)&&this._updateContent(this.target.attr(c))},"^content.title$":function(a,b,c){return c?(c&&!this.elements.title&&this._createTitle(),void this._updateTitle(c)):this._removeTitle()},"^content.button$":function(a,b,c){this._updateButton(c)},"^content.title.(text|button)$":function(a,b,c){this.set("content."+b,c)},"^position.(my|at)$":function(a,b,c){"string"==typeof c&&(a[b]=new B(c,"at"===b))},"^position.container$":function(a,b,c){this.rendered&&this.tooltip.appendTo(c)},"^show.ready$":function(a,b,c){c&&(!this.rendered&&this.render(E)||this.toggle(E))},"^style.classes$":function(a,b,c,d){this.rendered&&this.tooltip.removeClass(d).addClass(c)},"^style.(width|height)":function(a,b,c){this.rendered&&this.tooltip.css(b,c)},"^style.widget|content.title":function(){this.rendered&&this._setWidget()},"^style.def":function(a,b,c){this.rendered&&this.tooltip.toggleClass($,!!c)},"^events.(render|show|move|hide|focus|blur)$":function(a,b,c){this.rendered&&this.tooltip[(d.isFunction(c)?"":"un")+"bind"]("tooltip"+b,c)},"^(show|hide|position).(event|target|fixed|inactive|leave|distance|viewport|adjust)":function(){if(this.rendered){var a=this.options.position;this.tooltip.attr("tracking","mouse"===a.target&&a.adjust.mouse),this._unassignEvents(),this._assignEvents()}}}},A.get=function(a){if(this.destroyed)return this;var b=i(this.options,a.toLowerCase()),c=b[0][b[1]];return c.precedance?c.string():c};var fa=/^position\.(my|at|adjust|target|container|viewport)|style|content|show\.ready/i;A.set=function(a,b){if(this.destroyed)return this;var c,e=(this.rendered,F),f=this.options;this.checks;return"string"==typeof a?(c=a,a={},a[c]=b):a=d.extend({},a),d.each(a,function(b,c){var g,h=i(f,b.toLowerCase());g=h[0][h[1]],h[0][h[1]]=c&&c.nodeType?d(c):c,e=fa.test(b)||e,a[b]=[h[0],h[1],c,g]}),h(f),this.positioning=E,d.each(a,d.proxy(j,this)),this.positioning=F,this.rendered&&this.tooltip[0].offsetWidth>0&&e&&this.reposition("mouse"===f.position.target?G:this.cache.event),this},A._update=function(a,b,c){var e=this,f=this.cache;return this.rendered&&a?(d.isFunction(a)&&(a=a.call(this.elements.target,f.event,this)||""),d.isFunction(a.then)?(f.waiting=E,a.then(function(a){return f.waiting=F,e._update(a,b)},G,function(a){return e._update(a,b)})):a===F||!a&&""!==a?F:(a.jquery&&a.length>0?b.empty().append(a.css({display:"block",visibility:"visible"})):b.html(a),this._waitForContent(b).then(function(a){a.images&&a.images.length&&e.rendered&&e.tooltip[0].offsetWidth>0&&e.reposition(f.event,!a.length)}))):F},A._waitForContent=function(a){var b=this.cache;return b.waiting=E,d.Deferred().resolve([]).done(function(){b.waiting=F}).promise()},A._updateContent=function(a,b){this._update(a,this.elements.content,b)},A._updateTitle=function(a,b){this._update(a,this.elements.title,b)===F&&this._removeTitle(F)},A._createTitle=function(){var a=this.elements,b=this._id+"-title";a.titlebar&&this._removeTitle(),a.titlebar=d("<div />",{"class":T+"-titlebar "+(this.options.style.widget?k("header"):"")}).append(a.title=d("<div />",{id:b,"class":T+"-title","aria-atomic":E})).insertBefore(a.content).delegate(".qtip-close","mousedown keydown mouseup keyup mouseout",function(a){d(this).toggleClass("ui-state-active ui-state-focus","down"===a.type.substr(-4))}).delegate(".qtip-close","mouseover mouseout",function(a){d(this).toggleClass("ui-state-hover","mouseover"===a.type)}),this.options.content.button&&this._createButton()},A._removeTitle=function(a){var b=this.elements;b.title&&(b.titlebar.remove(),b.titlebar=b.title=b.button=G,a!==F&&this.reposition())},A.reposition=function(c,e){if(!this.rendered||this.positioning||this.destroyed)return this;this.positioning=E;var f,g,h=this.cache,i=this.tooltip,j=this.options.position,k=j.target,l=j.my,m=j.at,n=j.viewport,o=j.container,p=j.adjust,q=p.method.split(" "),r=i.outerWidth(F),s=i.outerHeight(F),t=0,u=0,v=i.css("position"),w={left:0,top:0},x=i[0].offsetWidth>0,y=c&&"scroll"===c.type,z=d(a),A=o[0].ownerDocument,B=this.mouse;if(d.isArray(k)&&2===k.length)m={x:M,y:L},w={left:k[0],top:k[1]};else if("mouse"===k)m={x:M,y:L},!B||!B.pageX||!p.mouse&&c&&c.pageX?c&&c.pageX||((!p.mouse||this.options.show.distance)&&h.origin&&h.origin.pageX?c=h.origin:c&&(!c||"resize"!==c.type&&"scroll"!==c.type)||(c=h.event)):c=B,"static"!==v&&(w=o.offset()),A.body.offsetWidth!==(a.innerWidth||A.documentElement.clientWidth)&&(g=d(b.body).offset()),w={left:c.pageX-w.left+(g&&g.left||0),top:c.pageY-w.top+(g&&g.top||0)},p.mouse&&y&&B&&(w.left-=(B.scrollX||0)-z.scrollLeft(),w.top-=(B.scrollY||0)-z.scrollTop());else{if("event"===k?c&&c.target&&"scroll"!==c.type&&"resize"!==c.type?h.target=d(c.target):c.target||(h.target=this.elements.target):"event"!==k&&(h.target=d(k.jquery?k:this.elements.target)),k=h.target,k=d(k).eq(0),0===k.length)return this;k[0]===b||k[0]===a?(t=ea.iOS?a.innerWidth:k.width(),u=ea.iOS?a.innerHeight:k.height(),k[0]===a&&(w={top:(n||k).scrollTop(),left:(n||k).scrollLeft()})):S.imagemap&&k.is("area")?f=S.imagemap(this,k,m,S.viewport?q:F):S.svg&&k&&k[0].ownerSVGElement?f=S.svg(this,k,m,S.viewport?q:F):(t=k.outerWidth(F),u=k.outerHeight(F),w=k.offset()),f&&(t=f.width,u=f.height,g=f.offset,w=f.position),w=this.reposition.offset(k,w,o),(ea.iOS>3.1&&ea.iOS<4.1||ea.iOS>=4.3&&ea.iOS<4.33||!ea.iOS&&"fixed"===v)&&(w.left-=z.scrollLeft(),w.top-=z.scrollTop()),(!f||f&&f.adjustable!==F)&&(w.left+=m.x===O?t:m.x===P?t/2:0,w.top+=m.y===N?u:m.y===P?u/2:0)}return w.left+=p.x+(l.x===O?-r:l.x===P?-r/2:0),w.top+=p.y+(l.y===N?-s:l.y===P?-s/2:0),S.viewport?(w.adjusted=S.viewport(this,w,j,t,u,r,s),g&&w.adjusted.left&&(w.left+=g.left),g&&w.adjusted.top&&(w.top+=g.top)):w.adjusted={left:0,top:0},this._trigger("move",[w,n.elem||n],c)?(delete w.adjusted,e===F||!x||isNaN(w.left)||isNaN(w.top)||"mouse"===k||!d.isFunction(j.effect)?i.css(w):d.isFunction(j.effect)&&(j.effect.call(i,this,d.extend({},w)),i.queue(function(a){d(this).css({opacity:"",height:""}),ea.ie&&this.style.removeAttribute("filter"),a()})),this.positioning=F,this):this},A.reposition.offset=function(a,c,e){function f(a,b){c.left+=b*a.scrollLeft(),c.top+=b*a.scrollTop()}if(!e[0])return c;var g,h,i,j,k=d(a[0].ownerDocument),l=!!ea.ie&&"CSS1Compat"!==b.compatMode,m=e[0];do"static"!==(h=d.css(m,"position"))&&("fixed"===h?(i=m.getBoundingClientRect(),f(k,-1)):(i=d(m).position(),i.left+=parseFloat(d.css(m,"borderLeftWidth"))||0,i.top+=parseFloat(d.css(m,"borderTopWidth"))||0),c.left-=i.left+(parseFloat(d.css(m,"marginLeft"))||0),c.top-=i.top+(parseFloat(d.css(m,"marginTop"))||0),g||"hidden"===(j=d.css(m,"overflow"))||"visible"===j||(g=d(m)));while(m=m.offsetParent);return g&&(g[0]!==k[0]||l)&&f(g,1),c};var ga=(B=A.reposition.Corner=function(a,b){a=(""+a).replace(/([A-Z])/," $1").replace(/middle/gi,P).toLowerCase(),this.x=(a.match(/left|right/i)||a.match(/center/)||["inherit"])[0].toLowerCase(),this.y=(a.match(/top|bottom|center/i)||["inherit"])[0].toLowerCase(),this.forceY=!!b;var c=a.charAt(0);this.precedance="t"===c||"b"===c?I:H}).prototype;ga.invert=function(a,b){this[a]=this[a]===M?O:this[a]===O?M:b||this[a]},ga.string=function(){var a=this.x,b=this.y;return a===b?a:this.precedance===I||this.forceY&&"center"!==b?b+" "+a:a+" "+b},ga.abbrev=function(){var a=this.string().split(" ");return a[0].charAt(0)+(a[1]&&a[1].charAt(0)||"")},ga.clone=function(){return new B(this.string(),this.forceY)},A.toggle=function(a,c){var e=this.cache,f=this.options,g=this.tooltip;if(c){if(/over|enter/.test(c.type)&&/out|leave/.test(e.event.type)&&f.show.target.add(c.target).length===f.show.target.length&&g.has(c.relatedTarget).length)return this;e.event=l(c)}if(this.waiting&&!a&&(this.hiddenDuringWait=E),!this.rendered)return a?this.render(1):this;if(this.destroyed||this.disabled)return this;var h,i,j,k=a?"show":"hide",m=this.options[k],n=(this.options[a?"hide":"show"],this.options.position),o=this.options.content,p=this.tooltip.css("width"),q=this.tooltip.is(":visible"),r=a||1===m.target.length,s=!c||m.target.length<2||e.target[0]===c.target;return(typeof a).search("boolean|number")&&(a=!q),h=!g.is(":animated")&&q===a&&s,i=h?G:!!this._trigger(k,[90]),this.destroyed?this:(i!==F&&a&&this.focus(c),!i||h?this:(d.attr(g[0],"aria-hidden",!a),a?(e.origin=l(this.mouse),d.isFunction(o.text)&&this._updateContent(o.text,F),d.isFunction(o.title)&&this._updateTitle(o.title,F),!D&&"mouse"===n.target&&n.adjust.mouse&&(d(b).bind("mousemove."+T,this._storeMouse),D=E),p||g.css("width",g.outerWidth(F)),this.reposition(c,arguments[2]),p||g.css("width",""),m.solo&&("string"==typeof m.solo?d(m.solo):d(X,m.solo)).not(g).not(m.target).qtip("hide",d.Event("tooltipsolo"))):(clearTimeout(this.timers.show),delete e.origin,D&&!d(X+'[tracking="true"]:visible',m.solo).not(g).length&&(d(b).unbind("mousemove."+T),D=F),this.blur(c)),j=d.proxy(function(){a?(ea.ie&&g[0].style.removeAttribute("filter"),g.css("overflow",""),"string"==typeof m.autofocus&&d(this.options.show.autofocus,g).focus(),this.options.show.target.trigger("qtip-"+this.id+"-inactive")):g.css({display:"",visibility:"",opacity:"",left:"",top:""}),this._trigger(a?"visible":"hidden")},this),m.effect===F||r===F?(g[k](),j()):d.isFunction(m.effect)?(g.stop(1,1),m.effect.call(g,this),g.queue("fx",function(a){j(),a()})):g.fadeTo(90,a?1:0,j),a&&m.target.trigger("qtip-"+this.id+"-inactive"),this))},A.show=function(a){return this.toggle(E,a)},A.hide=function(a){return this.toggle(F,a)},A.focus=function(a){if(!this.rendered||this.destroyed)return this;var b=d(X),c=this.tooltip,e=parseInt(c[0].style.zIndex,10),f=z.zindex+b.length;return c.hasClass(_)||this._trigger("focus",[f],a)&&(e!==f&&(b.each(function(){this.style.zIndex>e&&(this.style.zIndex=this.style.zIndex-1)}),b.filter("."+_).qtip("blur",a)),c.addClass(_)[0].style.zIndex=f),this},A.blur=function(a){return!this.rendered||this.destroyed?this:(this.tooltip.removeClass(_),this._trigger("blur",[this.tooltip.css("zIndex")],a),this)},A.disable=function(a){return this.destroyed?this:("toggle"===a?a=!(this.rendered?this.tooltip.hasClass(ba):this.disabled):"boolean"!=typeof a&&(a=E),this.rendered&&this.tooltip.toggleClass(ba,a).attr("aria-disabled",a),this.disabled=!!a,this)},A.enable=function(){return this.disable(F)},A._createButton=function(){var a=this,b=this.elements,c=b.tooltip,e=this.options.content.button,f="string"==typeof e,g=f?e:"Close tooltip";b.button&&b.button.remove(),e.jquery?b.button=e:b.button=d("<a />",{"class":"qtip-close "+(this.options.style.widget?"":T+"-icon"),title:g,"aria-label":g}).prepend(d("<span />",{"class":"ui-icon ui-icon-close",html:"&times;"})),b.button.appendTo(b.titlebar||c).attr("role","button").click(function(b){return c.hasClass(ba)||a.hide(b),F})},A._updateButton=function(a){if(!this.rendered)return F;var b=this.elements.button;a?this._createButton():b.remove()},A._setWidget=function(){var a=this.options.style.widget,b=this.elements,c=b.tooltip,d=c.hasClass(ba);c.removeClass(ba),ba=a?"ui-state-disabled":"qtip-disabled",c.toggleClass(ba,d),c.toggleClass("ui-helper-reset "+k(),a).toggleClass($,this.options.style.def&&!a),b.content&&b.content.toggleClass(k("content"),a),b.titlebar&&b.titlebar.toggleClass(k("header"),a),b.button&&b.button.toggleClass(T+"-icon",!a)},A._storeMouse=function(a){(this.mouse=l(a)).type="mousemove"},A._bind=function(a,b,c,e,f){var g="."+this._id+(e?"-"+e:"");b.length&&d(a).bind((b.split?b:b.join(g+" "))+g,d.proxy(c,f||this))},A._unbind=function(a,b){d(a).unbind("."+this._id+(b?"-"+b:""))};var ha="."+T;d(function(){r(X,["mouseenter","mouseleave"],function(a){var b="mouseenter"===a.type,c=d(a.currentTarget),e=d(a.relatedTarget||a.target),f=this.options;b?(this.focus(a),c.hasClass(Z)&&!c.hasClass(ba)&&clearTimeout(this.timers.hide)):"mouse"===f.position.target&&f.hide.event&&f.show.target&&!e.closest(f.show.target[0]).length&&this.hide(a),c.toggleClass(aa,b)}),r("["+V+"]",Y,p)}),A._trigger=function(a,b,c){var e=d.Event("tooltip"+a);return e.originalEvent=c&&d.extend({},c)||this.cache.event||G,this.triggering=a,this.tooltip.trigger(e,[this].concat(b||[])),this.triggering=F,!e.isDefaultPrevented()},A._bindEvents=function(a,b,c,e,f,g){if(e.add(c).length===e.length){var h=[];b=d.map(b,function(b){var c=d.inArray(b,a);return c>-1?void h.push(a.splice(c,1)[0]):b}),h.length&&this._bind(c,h,function(a){var b=this.rendered?this.tooltip[0].offsetWidth>0:!1;(b?g:f).call(this,a)})}this._bind(c,a,f),this._bind(e,b,g)},A._assignInitialEvents=function(a){function b(a){return this.disabled||this.destroyed?F:(this.cache.event=l(a),this.cache.target=a?d(a.target):[c],clearTimeout(this.timers.show),void(this.timers.show=m.call(this,function(){this.render("object"==typeof a||e.show.ready)},e.show.delay)))}var e=this.options,f=e.show.target,g=e.hide.target,h=e.show.event?d.trim(""+e.show.event).split(" "):[],i=e.hide.event?d.trim(""+e.hide.event).split(" "):[];/mouse(over|enter)/i.test(e.show.event)&&!/mouse(out|leave)/i.test(e.hide.event)&&i.push("mouseleave"),this._bind(f,"mousemove",function(a){this._storeMouse(a),this.cache.onTarget=E}),this._bindEvents(h,i,f,g,b,function(){clearTimeout(this.timers.show)}),(e.show.ready||e.prerender)&&b.call(this,a)},A._assignEvents=function(){var c=this,e=this.options,f=e.position,g=this.tooltip,h=e.show.target,i=e.hide.target,j=f.container,k=f.viewport,l=d(b),m=(d(b.body),d(a)),r=e.show.event?d.trim(""+e.show.event).split(" "):[],s=e.hide.event?d.trim(""+e.hide.event).split(" "):[];d.each(e.events,function(a,b){c._bind(g,"toggle"===a?["tooltipshow","tooltiphide"]:["tooltip"+a],b,null,g)}),/mouse(out|leave)/i.test(e.hide.event)&&"window"===e.hide.leave&&this._bind(l,["mouseout","blur"],function(a){/select|option/.test(a.target.nodeName)||a.relatedTarget||this.hide(a)}),e.hide.fixed?i=i.add(g.addClass(Z)):/mouse(over|enter)/i.test(e.show.event)&&this._bind(i,"mouseleave",function(){clearTimeout(this.timers.show)}),(""+e.hide.event).indexOf("unfocus")>-1&&this._bind(j.closest("html"),["mousedown","touchstart"],function(a){var b=d(a.target),c=this.rendered&&!this.tooltip.hasClass(ba)&&this.tooltip[0].offsetWidth>0,e=b.parents(X).filter(this.tooltip[0]).length>0;b[0]===this.target[0]||b[0]===this.tooltip[0]||e||this.target.has(b[0]).length||!c||this.hide(a)}),"number"==typeof e.hide.inactive&&(this._bind(h,"qtip-"+this.id+"-inactive",p),this._bind(i.add(g),z.inactiveEvents,p,"-inactive")),this._bindEvents(r,s,h,i,n,o),this._bind(h.add(g),"mousemove",function(a){if("number"==typeof e.hide.distance){var b=this.cache.origin||{},c=this.options.hide.distance,d=Math.abs;(d(a.pageX-b.pageX)>=c||d(a.pageY-b.pageY)>=c)&&this.hide(a)}this._storeMouse(a)}),"mouse"===f.target&&f.adjust.mouse&&(e.hide.event&&this._bind(h,["mouseenter","mouseleave"],function(a){this.cache.onTarget="mouseenter"===a.type}),this._bind(l,"mousemove",function(a){this.rendered&&this.cache.onTarget&&!this.tooltip.hasClass(ba)&&this.tooltip[0].offsetWidth>0&&this.reposition(a)})),(f.adjust.resize||k.length)&&this._bind(d.event.special.resize?k:m,"resize",q),f.adjust.scroll&&this._bind(m.add(f.container),"scroll",q)},A._unassignEvents=function(){var c=[this.options.show.target[0],this.options.hide.target[0],this.rendered&&this.tooltip[0],this.options.position.container[0],this.options.position.viewport[0],this.options.position.container.closest("html")[0],a,b];this._unbind(d([]).pushStack(d.grep(c,function(a){return"object"==typeof a})))},z=d.fn.qtip=function(a,b,e){var f=(""+a).toLowerCase(),g=G,i=d.makeArray(arguments).slice(1),j=i[i.length-1],k=this[0]?d.data(this[0],T):G;return!arguments.length&&k||"api"===f?k:"string"==typeof a?(this.each(function(){var a=d.data(this,T);if(!a)return E;if(j&&j.timeStamp&&(a.cache.event=j),!b||"option"!==f&&"options"!==f)a[f]&&a[f].apply(a,i);else{if(e===c&&!d.isPlainObject(b))return g=a.get(b),F;a.set(b,e)}}),g!==G?g:this):"object"!=typeof a&&arguments.length?void 0:(k=h(d.extend(E,{},a)),this.each(function(a){var b,c;return c=d.isArray(k.id)?k.id[a]:k.id,c=!c||c===F||c.length<1||z.api[c]?z.nextid++:c,b=s(d(this),c,k),b===F?E:(z.api[c]=b,d.each(S,function(){"initialize"===this.initialize&&this(b)}),void b._assignInitialEvents(j))}))},d.qtip=e,z.api={},d.each({attr:function(a,b){if(this.length){var c=this[0],e="title",f=d.data(c,"qtip");if(a===e&&f&&"object"==typeof f&&f.options.suppress)return arguments.length<2?d.attr(c,da):(f&&f.options.content.attr===e&&f.cache.attr&&f.set("content.text",b),this.attr(da,b))}return d.fn["attr"+ca].apply(this,arguments)},clone:function(a){var b=(d([]),d.fn["clone"+ca].apply(this,arguments));return a||b.filter("["+da+"]").attr("title",function(){return d.attr(this,da)}).removeAttr(da),b}},function(a,b){if(!b||d.fn[a+ca])return E;var c=d.fn[a+ca]=d.fn[a];d.fn[a]=function(){return b.apply(this,arguments)||c.apply(this,arguments)}}),d.ui||(d["cleanData"+ca]=d.cleanData,d.cleanData=function(a){for(var b,c=0;(b=d(a[c])).length;c++)if(b.attr(U))try{b.triggerHandler("removeqtip")}catch(e){}d["cleanData"+ca].apply(this,arguments)}),z.version="2.2.0",z.nextid=0,z.inactiveEvents=Y,z.zindex=15e3,z.defaults={prerender:F,id:F,overwrite:E,suppress:E,content:{text:E,attr:"title",title:F,button:F},position:{my:"top left",at:"bottom right",target:F,container:F,viewport:F,adjust:{x:0,y:0,mouse:E,scroll:E,resize:E,method:"flipinvert flipinvert"},effect:function(a,b,c){d(this).animate(b,{duration:200,queue:F})}},show:{target:F,event:"mouseenter",effect:E,delay:90,solo:F,ready:F,autofocus:F},hide:{target:F,event:"mouseleave",effect:E,delay:0,fixed:F,inactive:F,leave:"window",distance:F},style:{classes:"",widget:F,width:F,height:F,def:E},events:{render:G,move:G,show:G,hide:G,toggle:G,visible:G,hidden:G,focus:G,blur:G}};var ia,ja="margin",ka="border",la="color",ma="background-color",na="transparent",oa=" !important",pa=!!b.createElement("canvas").getContext,qa=/rgba?\(0, 0, 0(, 0)?\)|transparent|#123456/i,ra={},sa=["Webkit","O","Moz","ms"];if(pa)var ta=a.devicePixelRatio||1,ua=function(){var a=b.createElement("canvas").getContext("2d");return a.backingStorePixelRatio||a.webkitBackingStorePixelRatio||a.mozBackingStorePixelRatio||a.msBackingStorePixelRatio||a.oBackingStorePixelRatio||1}(),va=ta/ua;else var wa=function(a,b,c){return"<qtipvml:"+a+' xmlns="urn:schemas-microsoft.com:vml" class="qtip-vml" '+(b||"")+' style="behavior: url(#default#VML); '+(c||"")+'" />'};d.extend(w.prototype,{init:function(a){var b,c;c=this.element=a.elements.tip=d("<div />",{"class":T+"-tip"}).prependTo(a.tooltip),pa?(b=d("<canvas />").appendTo(this.element)[0].getContext("2d"),b.lineJoin="miter",b.miterLimit=1e5,b.save()):(b=wa("shape",'coordorigin="0,0"',"position:absolute;"),this.element.html(b+b),a._bind(d("*",c).add(c),["click","mousedown"],function(a){a.stopPropagation()},this._ns)),a._bind(a.tooltip,"tooltipmove",this.reposition,this._ns,this),this.create()},_swapDimensions:function(){this.size[0]=this.options.height,this.size[1]=this.options.width},_resetDimensions:function(){this.size[0]=this.options.width,this.size[1]=this.options.height},_useTitle:function(a){var b=this.qtip.elements.titlebar;return b&&(a.y===L||a.y===P&&this.element.position().top+this.size[1]/2+this.options.offset<b.outerHeight(E))},_parseCorner:function(a){var b=this.qtip.options.position.my;return a===F||b===F?a=F:a===E?a=new B(b.string()):a.string||(a=new B(a),a.fixed=E),a},_parseWidth:function(a,b,c){var d=this.qtip.elements,e=ka+t(b)+"Width";return(c?v(c,e):v(d.content,e)||v(this._useTitle(a)&&d.titlebar||d.content,e)||v(d.tooltip,e))||0},_parseRadius:function(a){var b=this.qtip.elements,c=ka+t(a.y)+t(a.x)+"Radius";return ea.ie<9?0:v(this._useTitle(a)&&b.titlebar||b.content,c)||v(b.tooltip,c)||0},_invalidColour:function(a,b,c){var d=a.css(b);return!d||c&&d===a.css(c)||qa.test(d)?F:d},_parseColours:function(a){var b=this.qtip.elements,c=this.element.css("cssText",""),e=ka+t(a[a.precedance])+t(la),f=this._useTitle(a)&&b.titlebar||b.content,g=this._invalidColour,h=[];return h[0]=g(c,ma)||g(f,ma)||g(b.content,ma)||g(b.tooltip,ma)||c.css(ma),h[1]=g(c,e,la)||g(f,e,la)||g(b.content,e,la)||g(b.tooltip,e,la)||b.tooltip.css(e),d("*",c).add(c).css("cssText",ma+":"+na+oa+";"+ka+":0"+oa+";"),h},_calculateSize:function(a){var b,c,d,e=a.precedance===I,f=this.options.width,g=this.options.height,h="c"===a.abbrev(),i=(e?f:g)*(h?.5:1),j=Math.pow,k=Math.round,l=Math.sqrt(j(i,2)+j(g,2)),m=[this.border/i*l,this.border/g*l];return m[2]=Math.sqrt(j(m[0],2)-j(this.border,2)),m[3]=Math.sqrt(j(m[1],2)-j(this.border,2)),b=l+m[2]+m[3]+(h?0:m[0]),c=b/l,d=[k(c*f),k(c*g)],e?d:d.reverse()},_calculateTip:function(a,b,c){c=c||1,b=b||this.size;var d=b[0]*c,e=b[1]*c,f=Math.ceil(d/2),g=Math.ceil(e/2),h={br:[0,0,d,e,d,0],bl:[0,0,d,0,0,e],tr:[0,e,d,0,d,e],tl:[0,0,0,e,d,e],tc:[0,e,f,0,d,e],bc:[0,0,d,0,f,e],rc:[0,0,d,g,0,e],lc:[d,0,d,e,0,g]};return h.lt=h.br,h.rt=h.bl,h.lb=h.tr,h.rb=h.tl,h[a.abbrev()]},_drawCoords:function(a,b){a.beginPath(),a.moveTo(b[0],b[1]),a.lineTo(b[2],b[3]),a.lineTo(b[4],b[5]),a.closePath()},create:function(){var a=this.corner=(pa||ea.ie)&&this._parseCorner(this.options.corner);return(this.enabled=!!this.corner&&"c"!==this.corner.abbrev())&&(this.qtip.cache.corner=a.clone(),this.update()),this.element.toggle(this.enabled),
this.corner},update:function(b,c){if(!this.enabled)return this;var e,f,g,h,i,j,k,l,m=this.qtip.elements,n=this.element,o=n.children(),p=this.options,q=this.size,r=p.mimic,s=Math.round;b||(b=this.qtip.cache.corner||this.corner),r===F?r=b:(r=new B(r),r.precedance=b.precedance,"inherit"===r.x?r.x=b.x:"inherit"===r.y?r.y=b.y:r.x===r.y&&(r[b.precedance]=b[b.precedance])),f=r.precedance,b.precedance===H?this._swapDimensions():this._resetDimensions(),e=this.color=this._parseColours(b),e[1]!==na?(l=this.border=this._parseWidth(b,b[b.precedance]),p.border&&1>l&&!qa.test(e[1])&&(e[0]=e[1]),this.border=l=p.border!==E?p.border:l):this.border=l=0,k=this.size=this._calculateSize(b),n.css({width:k[0],height:k[1],lineHeight:k[1]+"px"}),j=b.precedance===I?[s(r.x===M?l:r.x===O?k[0]-q[0]-l:(k[0]-q[0])/2),s(r.y===L?k[1]-q[1]:0)]:[s(r.x===M?k[0]-q[0]:0),s(r.y===L?l:r.y===N?k[1]-q[1]-l:(k[1]-q[1])/2)],pa?(g=o[0].getContext("2d"),g.restore(),g.save(),g.clearRect(0,0,6e3,6e3),h=this._calculateTip(r,q,va),i=this._calculateTip(r,this.size,va),o.attr(J,k[0]*va).attr(K,k[1]*va),o.css(J,k[0]).css(K,k[1]),this._drawCoords(g,i),g.fillStyle=e[1],g.fill(),g.translate(j[0]*va,j[1]*va),this._drawCoords(g,h),g.fillStyle=e[0],g.fill()):(h=this._calculateTip(r),h="m"+h[0]+","+h[1]+" l"+h[2]+","+h[3]+" "+h[4]+","+h[5]+" xe",j[2]=l&&/^(r|b)/i.test(b.string())?8===ea.ie?2:1:0,o.css({coordsize:k[0]+l+" "+(k[1]+l),antialias:""+(r.string().indexOf(P)>-1),left:j[0]-j[2]*Number(f===H),top:j[1]-j[2]*Number(f===I),width:k[0]+l,height:k[1]+l}).each(function(a){var b=d(this);b[b.prop?"prop":"attr"]({coordsize:k[0]+l+" "+(k[1]+l),path:h,fillcolor:e[0],filled:!!a,stroked:!a}).toggle(!(!l&&!a)),!a&&b.html(wa("stroke",'weight="'+2*l+'px" color="'+e[1]+'" miterlimit="1000" joinstyle="miter"'))})),a.opera&&setTimeout(function(){m.tip.css({display:"inline-block",visibility:"visible"})},1),c!==F&&this.calculate(b,k)},calculate:function(a,b){if(!this.enabled)return F;var c,e,f=this,g=this.qtip.elements,h=this.element,i=this.options.offset,j=(g.tooltip.hasClass("ui-widget"),{});return a=a||this.corner,c=a.precedance,b=b||this._calculateSize(a),e=[a.x,a.y],c===H&&e.reverse(),d.each(e,function(d,e){var h,k,l;e===P?(h=c===I?M:L,j[h]="50%",j[ja+"-"+h]=-Math.round(b[c===I?0:1]/2)+i):(h=f._parseWidth(a,e,g.tooltip),k=f._parseWidth(a,e,g.content),l=f._parseRadius(a),j[e]=Math.max(-f.border,d?k:i+(l>h?l:-h)))}),j[a[c]]-=b[c===H?0:1],h.css({margin:"",top:"",bottom:"",left:"",right:""}).css(j),j},reposition:function(a,b,d,e){function f(a,b,c,d,e){a===R&&k.precedance===b&&l[d]&&k[c]!==P?k.precedance=k.precedance===H?I:H:a!==R&&l[d]&&(k[b]=k[b]===P?l[d]>0?d:e:k[b]===d?e:d)}function g(a,b,e){k[a]===P?q[ja+"-"+b]=p[a]=h[ja+"-"+b]-l[b]:(i=h[e]!==c?[l[b],-h[b]]:[-l[b],h[b]],(p[a]=Math.max(i[0],i[1]))>i[0]&&(d[b]-=l[b],p[b]=F),q[h[e]!==c?e:b]=p[a])}if(this.enabled){var h,i,j=b.cache,k=this.corner.clone(),l=d.adjusted,m=b.options.position.adjust.method.split(" "),n=m[0],o=m[1]||m[0],p={left:F,top:F,x:0,y:0},q={};this.corner.fixed!==E&&(f(n,H,I,M,O),f(o,I,H,L,N),k.string()===j.corner.string()||j.cornerTop===l.top&&j.cornerLeft===l.left||this.update(k,F)),h=this.calculate(k),h.right!==c&&(h.left=-h.right),h.bottom!==c&&(h.top=-h.bottom),h.user=this.offset,(p.left=n===R&&!!l.left)&&g(H,M,O),(p.top=o===R&&!!l.top)&&g(I,L,N),this.element.css(q).toggle(!(p.x&&p.y||k.x===P&&p.y||k.y===P&&p.x)),d.left-=h.left.charAt?h.user:n!==R||p.top||!p.left&&!p.top?h.left+this.border:0,d.top-=h.top.charAt?h.user:o!==R||p.left||!p.left&&!p.top?h.top+this.border:0,j.cornerLeft=l.left,j.cornerTop=l.top,j.corner=k.clone()}},destroy:function(){this.qtip._unbind(this.qtip.tooltip,this._ns),this.qtip.elements.tip&&this.qtip.elements.tip.find("*").remove().end().remove()}}),ia=S.tip=function(a){return new w(a,a.options.style.tip)},ia.initialize="render",ia.sanitize=function(a){if(a.style&&"tip"in a.style){var b=a.style.tip;"object"!=typeof b&&(b=a.style.tip={corner:b}),/string|boolean/i.test(typeof b.corner)||(b.corner=E)}},C.tip={"^position.my|style.tip.(corner|mimic|border)$":function(){this.create(),this.qtip.reposition()},"^style.tip.(height|width)$":function(a){this.size=[a.width,a.height],this.update(),this.qtip.reposition()},"^content.title|style.(classes|widget)$":function(){this.update()}},d.extend(E,z.defaults,{style:{tip:{corner:E,mimic:F,width:6,height:6,border:E,offset:0}}});var xa,ya,za="qtip-modal",Aa="."+za;ya=function(){function a(a){if(d.expr[":"].focusable)return d.expr[":"].focusable;var b,c,e,f=!isNaN(d.attr(a,"tabindex")),g=a.nodeName&&a.nodeName.toLowerCase();return"area"===g?(b=a.parentNode,c=b.name,a.href&&c&&"map"===b.nodeName.toLowerCase()?(e=d("img[usemap=#"+c+"]")[0],!!e&&e.is(":visible")):!1):/input|select|textarea|button|object/.test(g)?!a.disabled:"a"===g?a.href||f:f}function c(a){k.length<1&&a.length?a.not("body").blur():k.first().focus()}function e(a){if(i.is(":visible")){var b,e=d(a.target),h=f.tooltip,j=e.closest(X);b=j.length<1?F:parseInt(j[0].style.zIndex,10)>parseInt(h[0].style.zIndex,10),b||e.closest(X)[0]===h[0]||c(e),g=a.target===k[k.length-1]}}var f,g,h,i,j=this,k={};d.extend(j,{init:function(){return i=j.elem=d("<div />",{id:"qtip-overlay",html:"<div></div>",mousedown:function(){return F}}).hide(),d(b.body).bind("focusin"+Aa,e),d(b).bind("keydown"+Aa,function(a){f&&f.options.show.modal.escape&&27===a.keyCode&&f.hide(a)}),i.bind("click"+Aa,function(a){f&&f.options.show.modal.blur&&f.hide(a)}),j},update:function(b){f=b,k=b.options.show.modal.stealfocus!==F?b.tooltip.find("*").filter(function(){return a(this)}):[]},toggle:function(a,e,g){var k=(d(b.body),a.tooltip),l=a.options.show.modal,m=l.effect,n=e?"show":"hide",o=i.is(":visible"),p=d(Aa).filter(":visible:not(:animated)").not(k);return j.update(a),e&&l.stealfocus!==F&&c(d(":focus")),i.toggleClass("blurs",l.blur),e&&i.appendTo(b.body),i.is(":animated")&&o===e&&h!==F||!e&&p.length?j:(i.stop(E,F),d.isFunction(m)?m.call(i,e):m===F?i[n]():i.fadeTo(parseInt(g,10)||90,e?1:0,function(){e||i.hide()}),e||i.queue(function(a){i.css({left:"",top:""}),d(Aa).length||i.detach(),a()}),h=e,f.destroyed&&(f=G),j)}}),j.init()},ya=new ya,d.extend(x.prototype,{init:function(a){var b=a.tooltip;return this.options.on?(a.elements.overlay=ya.elem,b.addClass(za).css("z-index",z.modal_zindex+d(Aa).length),a._bind(b,["tooltipshow","tooltiphide"],function(a,c,e){var f=a.originalEvent;if(a.target===b[0])if(f&&"tooltiphide"===a.type&&/mouse(leave|enter)/.test(f.type)&&d(f.relatedTarget).closest(ya.elem[0]).length)try{a.preventDefault()}catch(g){}else(!f||f&&"tooltipsolo"!==f.type)&&this.toggle(a,"tooltipshow"===a.type,e)},this._ns,this),a._bind(b,"tooltipfocus",function(a,c){if(!a.isDefaultPrevented()&&a.target===b[0]){var e=d(Aa),f=z.modal_zindex+e.length,g=parseInt(b[0].style.zIndex,10);ya.elem[0].style.zIndex=f-1,e.each(function(){this.style.zIndex>g&&(this.style.zIndex-=1)}),e.filter("."+_).qtip("blur",a.originalEvent),b.addClass(_)[0].style.zIndex=f,ya.update(c);try{a.preventDefault()}catch(h){}}},this._ns,this),void a._bind(b,"tooltiphide",function(a){a.target===b[0]&&d(Aa).filter(":visible").not(b).last().qtip("focus",a)},this._ns,this)):this},toggle:function(a,b,c){return a&&a.isDefaultPrevented()?this:void ya.toggle(this.qtip,!!b,c)},destroy:function(){this.qtip.tooltip.removeClass(za),this.qtip._unbind(this.qtip.tooltip,this._ns),ya.toggle(this.qtip,F),delete this.qtip.elements.overlay}}),xa=S.modal=function(a){return new x(a,a.options.show.modal)},xa.sanitize=function(a){a.show&&("object"!=typeof a.show.modal?a.show.modal={on:!!a.show.modal}:"undefined"==typeof a.show.modal.on&&(a.show.modal.on=E))},z.modal_zindex=z.zindex-200,xa.initialize="render",C.modal={"^show.modal.(on|blur)$":function(){this.destroy(),this.init(),this.qtip.elems.overlay.toggle(this.qtip.tooltip[0].offsetWidth>0)}},d.extend(E,z.defaults,{show:{modal:{on:F,effect:E,blur:E,stealfocus:E,escape:E}}}),S.viewport=function(c,d,e,f,g,h,i){function j(a,b,c,e,f,g,h,i,j){var k=d[f],m=v[a],t=w[a],u=c===R,x=m===f?j:m===g?-j:-j/2,y=t===f?i:t===g?-i:-i/2,z=r[f]+s[f]-(o?0:n[f]),A=z-k,B=k+j-(h===J?p:q)-z,C=x-(v.precedance===a||m===v[b]?y:0)-(t===P?i/2:0);return u?(C=(m===f?1:-1)*x,d[f]+=A>0?A:B>0?-B:0,d[f]=Math.max(-n[f]+s[f],k-C,Math.min(Math.max(-n[f]+s[f]+(h===J?p:q),k+C),d[f],"center"===m?k-x:1e9))):(e*=c===Q?2:0,A>0&&(m!==f||B>0)?(d[f]-=C+e,l.invert(a,f)):B>0&&(m!==g||A>0)&&(d[f]-=(m===P?-C:C)+e,l.invert(a,g)),d[f]<r&&-d[f]>B&&(d[f]=k,l=v.clone())),d[f]-k}var k,l,m,n,o,p,q,r,s,t=e.target,u=c.elements.tooltip,v=e.my,w=e.at,x=e.adjust,y=x.method.split(" "),z=y[0],A=y[1]||y[0],B=e.viewport,C=e.container,D=c.cache,E={left:0,top:0};return B.jquery&&t[0]!==a&&t[0]!==b.body&&"none"!==x.method?(n=C.offset()||E,o="static"===C.css("position"),k="fixed"===u.css("position"),p=B[0]===a?B.width():B.outerWidth(F),q=B[0]===a?B.height():B.outerHeight(F),r={left:k?0:B.scrollLeft(),top:k?0:B.scrollTop()},s=B.offset()||E,"shift"===z&&"shift"===A||(l=v.clone()),E={left:"none"!==z?j(H,I,z,x.x,M,O,J,f,h):0,top:"none"!==A?j(I,H,A,x.y,L,N,K,g,i):0},l&&D.lastClass!==(m=T+"-pos-"+l.abbrev())&&u.removeClass(c.cache.lastClass).addClass(c.cache.lastClass=m),E):E},S.polys={polygon:function(a,b){var c,d,e,f={width:0,height:0,position:{top:1e10,right:0,bottom:0,left:1e10},adjustable:F},g=0,h=[],i=1,j=1,k=0,l=0;for(g=a.length;g--;)c=[parseInt(a[--g],10),parseInt(a[g+1],10)],c[0]>f.position.right&&(f.position.right=c[0]),c[0]<f.position.left&&(f.position.left=c[0]),c[1]>f.position.bottom&&(f.position.bottom=c[1]),c[1]<f.position.top&&(f.position.top=c[1]),h.push(c);if(d=f.width=Math.abs(f.position.right-f.position.left),e=f.height=Math.abs(f.position.bottom-f.position.top),"c"===b.abbrev())f.position={left:f.position.left+f.width/2,top:f.position.top+f.height/2};else{for(;d>0&&e>0&&i>0&&j>0;)for(d=Math.floor(d/2),e=Math.floor(e/2),b.x===M?i=d:b.x===O?i=f.width-d:i+=Math.floor(d/2),b.y===L?j=e:b.y===N?j=f.height-e:j+=Math.floor(e/2),g=h.length;g--&&!(h.length<2);)k=h[g][0]-f.position.left,l=h[g][1]-f.position.top,(b.x===M&&k>=i||b.x===O&&i>=k||b.x===P&&(i>k||k>f.width-i)||b.y===L&&l>=j||b.y===N&&j>=l||b.y===P&&(j>l||l>f.height-j))&&h.splice(g,1);f.position={left:h[0][0],top:h[0][1]}}return f},rect:function(a,b,c,d){return{width:Math.abs(c-a),height:Math.abs(d-b),position:{left:Math.min(a,c),top:Math.min(b,d)}}},_angles:{tc:1.5,tr:7/4,tl:5/4,bc:.5,br:.25,bl:.75,rc:2,lc:1,c:0},ellipse:function(a,b,c,d,e){var f=S.polys._angles[e.abbrev()],g=0===f?0:c*Math.cos(f*Math.PI),h=d*Math.sin(f*Math.PI);return{width:2*c-Math.abs(g),height:2*d-Math.abs(h),position:{left:a+g,top:b+h},adjustable:F}},circle:function(a,b,c,d){return S.polys.ellipse(a,b,c,c,d)}},S.svg=function(a,c,e){for(var f,g,h,i,j,k,l,m,n,o,p,q=d(b),r=c[0],s=d(r.ownerSVGElement),t=1,u=1,v=!0;!r.getBBox;)r=r.parentNode;if(!r.getBBox||!r.parentNode)return F;f=s.attr("width")||s.width()||parseInt(s.css("width"),10),g=s.attr("height")||s.height()||parseInt(s.css("height"),10);var w=(parseInt(c.css("stroke-width"),10)||0)/2;switch(w&&(t+=w/f,u+=w/g),r.nodeName){case"ellipse":case"circle":o=S.polys.ellipse(r.cx.baseVal.value,r.cy.baseVal.value,(r.rx||r.r).baseVal.value+w,(r.ry||r.r).baseVal.value+w,e);break;case"line":case"polygon":case"polyline":for(n=r.points||[{x:r.x1.baseVal.value,y:r.y1.baseVal.value},{x:r.x2.baseVal.value,y:r.y2.baseVal.value}],o=[],m=-1,k=n.numberOfItems||n.length;++m<k;)l=n.getItem?n.getItem(m):n[m],o.push.apply(o,[l.x,l.y]);o=S.polys.polygon(o,e);break;default:o=r.getBoundingClientRect(),o={width:o.width,height:o.height,position:{left:o.left,top:o.top}},v=!1}return p=o.position,s=s[0],v&&(s.createSVGPoint&&(h=r.getScreenCTM(),n=s.createSVGPoint(),n.x=p.left,n.y=p.top,i=n.matrixTransform(h),p.left=i.x,p.top=i.y),s.viewBox&&(j=s.viewBox.baseVal)&&j.width&&j.height&&(t*=f/j.width,u*=g/j.height)),p.left+=q.scrollLeft(),p.top+=q.scrollTop(),o},S.imagemap=function(a,b,c,e){b.jquery||(b=d(b));var f,g,h,i,j,k=b.attr("shape").toLowerCase().replace("poly","polygon"),l=d('img[usemap="#'+b.parent("map").attr("name")+'"]'),m=d.trim(b.attr("coords")),n=m.replace(/,$/,"").split(",");if(!l.length)return F;if("polygon"===k)i=S.polys.polygon(n,c);else{if(!S.polys[k])return F;for(h=-1,j=n.length,g=[];++h<j;)g.push(parseInt(n[h],10));i=S.polys[k].apply(this,g.concat(c))}return f=l.offset(),f.left+=Math.ceil((l.outerWidth(F)-l.width())/2),f.top+=Math.ceil((l.outerHeight(F)-l.height())/2),i.position.left+=f.left,i.position.top+=f.top,i};var Ba,Ca='<iframe class="qtip-bgiframe" frameborder="0" tabindex="-1" src="javascript:\'\';"  style="display:block; position:absolute; z-index:-1; filter:alpha(opacity=0); -ms-filter:"progid:DXImageTransform.Microsoft.Alpha(Opacity=0)";"></iframe>';d.extend(y.prototype,{_scroll:function(){var b=this.qtip.elements.overlay;b&&(b[0].style.top=d(a).scrollTop()+"px")},init:function(c){var e=c.tooltip;d("select, object").length<1&&(this.bgiframe=c.elements.bgiframe=d(Ca).appendTo(e),c._bind(e,"tooltipmove",this.adjustBGIFrame,this._ns,this)),this.redrawContainer=d("<div/>",{id:T+"-rcontainer"}).appendTo(b.body),c.elements.overlay&&c.elements.overlay.addClass("qtipmodal-ie6fix")&&(c._bind(a,["scroll","resize"],this._scroll,this._ns,this),c._bind(e,["tooltipshow"],this._scroll,this._ns,this)),this.redraw()},adjustBGIFrame:function(){var a,b,c=this.qtip.tooltip,d={height:c.outerHeight(F),width:c.outerWidth(F)},e=this.qtip.plugins.tip,f=this.qtip.elements.tip;b=parseInt(c.css("borderLeftWidth"),10)||0,b={left:-b,top:-b},e&&f&&(a="x"===e.corner.precedance?[J,M]:[K,L],b[a[1]]-=f[a[0]]()),this.bgiframe.css(b).css(d)},redraw:function(){if(this.qtip.rendered<1||this.drawing)return this;var a,b,c,d,e=this.qtip.tooltip,f=this.qtip.options.style,g=this.qtip.options.position.container;return this.qtip.drawing=1,f.height&&e.css(K,f.height),f.width?e.css(J,f.width):(e.css(J,"").appendTo(this.redrawContainer),b=e.width(),1>b%2&&(b+=1),c=e.css("maxWidth")||"",d=e.css("minWidth")||"",a=(c+d).indexOf("%")>-1?g.width()/100:0,c=(c.indexOf("%")>-1?a:1)*parseInt(c,10)||b,d=(d.indexOf("%")>-1?a:1)*parseInt(d,10)||0,b=c+d?Math.min(Math.max(b,d),c):b,e.css(J,Math.round(b)).appendTo(g)),this.drawing=0,this},destroy:function(){this.bgiframe&&this.bgiframe.remove(),this.qtip._unbind([a,this.qtip.tooltip],this._ns)}}),Ba=S.ie6=function(a){return 6===ea.ie?new y(a):F},Ba.initialize="render",C.ie6={"^content|style$":function(){this.redraw()}}})}(window,document),define("modules/common/utility",["jquery","underscore","backbone","modules/view/common/success_modal_view","modules/common/date_format","modules/common/local_storage","modules/globals/url","modules/globals/variable","modules/globals/session_user","modules/common/session_user","modules/common/config","modules/common/event_logger","jquery.mousewheel","jquery.i18n","qtip"],function(a,b,c,d,e,f,g,h,i,j,k,l){Date.now||(Date.now=function(){return+new Date});var m={};m.createFancyBox=function(a){a.fancybox({type:"image",padding:20,fitToView:!1,autoSize:!0,mouseWheel:!1,scrollOutside:!1,maxWidth:900,maxHeight:900,helpers:{title:{type:"inside"}}})},m.storeItemAllowedToBuyItemFromMigLevel=function(a){return i.mig_level?!(a.migLevelMin>i.mig_level):!1},m.storeItemAllowedToBuyItemFromGroup=function(a){return null!==a.groupName?!!a.isGroupMember:!0},m.isGiftShowerItem=function(a){return"VIRTUAL_GIFT"===a.type&&a.price<=k.store.gift_shower_price},m.highlight_top_menu=function(b){a(".nav.navbar-nav","#main-header").find("li").removeClass("active"),""!==b?(a("#"+b+"-dropdown").addClass("active"),a(".navbar-toggle").html(b),a(".navbar-toggle").prepend('<span class="icon-tab_'+b+'"></span>'),a(".navbar-toggle").append('<span class="icon-wb_arrowDown"></span>')):(a(".navbar-toggle").html("feed"),a(".navbar-toggle").prepend('<span class="icon-tab_feed"></span>'),a(".navbar-toggle").append('<span class="icon-wb_arrowDown"></span>')),a(".navbar-collapse").removeClass("in"),a(".navbar-toggle").addClass("collapsed")},m.isBase64String=function(a){var b=/^data:image\/[^;]+;base64,/,c=new RegExp("^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4})$");return a=a.replace(b,""),c.test(a)},m.dataURItoBlob=function(a){for(var b=atob(a.split(",")[1]),c=a.split(",")[0].split(":")[1].split(";")[0],d=new ArrayBuffer(b.length),e=new Uint8Array(d),f=0;f<b.length;f++)e[f]=b.charCodeAt(f);return new Blob([d],{type:c})},m.set_user_data=function(a,b){if(!i.username)throw"No active session found;";f.set(i.username+"_"+a,b)},m.get_user_data=function(a){if(!i.username)throw"No active session found;";return f.get(i.username+"_"+a)},m.remove_user_data=function(a){if(!i.username)throw"No active session found;";return f.remove(i.username+"_"+a)},m.get_gtm_var=function(a){var b=window.gtm_var;return"undefined"==typeof b||"undefined"==typeof b[a]?"":b[a]},m.parse_profile_hovercard=function(c){var d=require("modules/mig33_app"),e=require("modules/model/user/user_model"),f=require("modules/view/user/user_view"),g=b.isUndefined(c.$el)||b.isNull(c.$el)?c:c.$el,h=a(".profile-hovercard",g);h.each(function(){var b=a(this).data("username"),c=a(this).data("at"),g=a(this).data("my"),h=a(this).data("adjust-method");c=c||"bottom center",g=g||"top center",h=h||"flip flip",a(this).qtip({content:{text:function(a,c){var g=function(){var a=new f({model:d.cache.user[b]});return a.render(),a.$el};if(d.cache.user[b])return g();var h=new e({username:b});return h.fetch(),h.on("change",function(){d.cache.user[b]=h,c.set("content.text",g())}),'<div style="height:318px;width:219px;text-align:middle;" class="loading">'+m.translate("common|loading")+"...</div>"}},position:{target:"event",my:g,at:c,viewport:a(window),effect:!0,adjust:{method:h}},style:{classes:"hovercard qtip-bootstrap",width:"auto",height:"auto"},show:{delay:500},hide:{fixed:!0,delay:100,event:"mouseleave"}}).click(function(b){a(b.currentTarget).qtip("api").destroy()})})},m.send_pageTrack_to_ga=function(a){"function"==typeof ga&&dataLayer.push({event:"sendVirtualPageview",vpv:a})},m.send_event_to_ga=function(a,b,c){"undefined"==typeof c&&(c=null),dataLayer.push({event:"trackEvent",eventDetails:{category:a,action:b,label:c}})},m.send_exception_to_ga=function(){if(!window.settings||!window.settings.debug&&!window.settings.do_not_report_error){var a=window.onerror;window.onerror=function(b,c,d){return l&&l.Logger.getInstance().error(b,{url:c,line:d}),"function"==typeof ga&&ga("send","exception",{exDescription:b+" - "+c+" ("+d+")",exFatal:!1}),a?a(b,c,d):(console.log("Unhandled Exception"),console.log(b+" - "+c+" ("+d+")"),!1)}}},m.ecommerce_send_impressions_to_ga=function(a){var b,c=[],d=this;a.forEach(function(a,e,f){var g=a.attributes,h=f.length-1,i=d.humanize_string(g.type);b=g.localCurrency,c.push({id:g.id,name:g.name,category:i+" ("+a.collection.options.category_id+")",variant:g.storeCategoryID,metric1:g.localPrice,list:i+" list",position:e+1}),(e+1)%15!=0&&e!=h||(dataLayer.push({event:"trackEvent",eventDetails:{category:"Store Ecommerce",action:"Product Impression"},ecommerce:{currencyCode:b,impressions:c}}),c=[])})},m.ecommerce_send_storeClick_to_ga=function(a){var b=a.attributes,d=b.localCurrency,e=b.storeCategoryID,f=this.humanize_string(b.type),g=f+" list";"store"==c.history.fragment&&(g="Store list"),a.collection&&a.collection.options&&a.collection.options.category_id&&(e=a.collection.options.category_id);var h=[{id:b.id,name:b.name,category:f+" ("+e+")",variant:b.storeCategoryID,metric1:b.localPrice,position:b.index+1}];dataLayer.push({event:"trackEvent",eventDetails:{category:"Store Ecommerce",action:"Product Click"},ecommerce:{currencyCode:d,click:{actionField:{list:g},products:h}}}),h[0].quantity=1,delete h[0].position,dataLayer.push({event:"trackEvent",eventDetails:{category:"Store Ecommerce",action:"Product Detail"},ecommerce:{currencyCode:d,detail:{products:h}}})},m.ecommerce_send_purchase_to_ga=function(a){var b=a.localCurrency,c=this.humanize_string(a.type),d=[{id:a.id,name:a.name,category:c+" ("+a.parentStoreCategoryID+")",variant:a.storeCategoryID,quantity:a.quantity,metric1:a.localPrice}];dataLayer.push({event:"trackEvent",eventDetails:{category:"Store Ecommerce",action:"Purchase"},redeemedCredits:a.quantity*a.localPrice,ecommerce:{currencyCode:b,purchase:{actionField:{id:+Date.now()+"-"+Math.floor(1e4*Math.random()+1)},products:d}}})},m.is_pushstate_enabled=function(){return window.history&&window.history.pushState},m.isNode=function(a){return"object"==typeof Node?a instanceof Node:a&&"object"==typeof a&&"number"==typeof a.nodeType&&"string"==typeof a.nodeName},m.isElement=function(a){return"object"==typeof HTMLElement?a instanceof HTMLElement:a&&"object"==typeof a&&null!==a&&1===a.nodeType&&"string"==typeof a.nodeName},m.show_document_title=function(a,c){var d="";a=""===a?document.title:a;var e=/\([0-9]+\)?/g,f=c||0,g=document.title.match(e),h=b.isArray(g)?g[0]:g;d=h&&0===f?a.replace(h+" ",""):h&&f>0?a.replace(h,"("+c+")"):"("+f+") "+a,document.title=d.replace("(0) ","")},m.isolate_scroll=function(b){var c=a(b);c.on("mousewheel",function(a,b){var d=c.height(),e=c.get(0).scrollHeight;(this.scrollTop===e-d&&0>b||0===this.scrollTop&&b>0)&&a.preventDefault()})},m.show_success=function(a){this.show_message("success",a)},m.show_error=function(a){this.show_message("error",a)},m.show_info=function(a){this.show_message("info",a)},m.show_message=function(a,b){a="undefined"!=typeof a?a:"info";var c=require("modules/mig33_app"),d=(new Date).getTime(),e=[{type:k.notification_destinations.MARKETING_TYPE,count:1,alerts:[{id:d,type:"MESSAGE_"+a.toUpperCase(),title:a.charAt(0).toUpperCase()+a.slice(1),message:b}]}];c.vent.trigger(c.ApplicationEvents.NEW_NOTIFICATIONS,e)},m.show_success_modal=function(b,c,e){var f=a("#main-container"),g=new d;f.after(g.render().el),g.updateText(b,c,e),g.$el.modal("show"),g.$el.one("hidden.bs.modal",function(a){this.remove()})},m.parse_location_href=function(){return this.is_pushstate_enabled()?location.href:g.site&&location.hash&&0===location.hash.indexOf("#")?g.site+location.hash.slice(1):location.href},m.parse_ajax_response=function(a){return"undefined"==typeof a?!1:"undefined"!=typeof a.error||a.error?a.error.errno?{error:a.error.message}:a.data:a},m.get_profile_url=function(a){return g.personalized+"/"+a};var n=null;m.invalidate_display_picture_browser_cache=function(){n=(new Date).getTime()},m.get_username=function(){var a=window.location.pathname,b=a.split("/"),c=b.length,d=b[c-1];return 5==c?d=b[c-3]:4==c?d=b[c-2]:3==c?"u"!=b[1]&&(d=b[c-2]):2==c||(console.log("Invalid username. Unable to parse username from url."),d=""),d},m.get_display_picture_url=function(a,c,d,e,f){if(b.isEmpty(a))return"";c="undefined"!=typeof c?c:1,d="undefined"!=typeof d?d:48,e="undefined"!=typeof e?e:48;var h=1==c?"a":"u";f||(h="dp");var j=g.image+"/"+h+"/"+a+"?w="+d+"&h="+e+"&a=1&c=1";return null!==n&&a===i.username&&(j+="&_="+n),j},m.parse_url=function(a,b){if(!a)return{};var c=document.createElement("a");c.href=a;var d={protocol:c.protocol,hostname:c.hostname,port:c.port,pathname:c.pathname,search:c.search,hash:c.hash,host:c.host};return b?d[b]||"":d},m.parse_query=function(a,c){var d=this.parse_url(a,"search");d=d.substr(1,d.length-1);var e=d.split("&"),f={};return b.each(e,function(a){var b=a.split("=");b.length>1&&(f[b[0]]=b[1])}),c?f[c]||"":f},m.get_badge_image_url=function(a,b){return b="undefined"!=typeof b?b:64,g.cdn+"/resources/img/badges/"+b+"x"+b+"/"+a},m.get_badge_image_monotone_url=function(a,b){return b="undefined"!=typeof b?b:64,g.cdn+"/resources/img/badges/"+b+"x"+b+"/monotone/"+a},m.get_gift_image_url=function(a,b,c){return null===a||void 0===a?"http://web.mig.me/228/app/images/mig.me/wb_store_gift.svg":0===a.indexOf("http://")||0===a.indexOf("https://")?a:(b="undefined"!=typeof b?b:64,c="undefined"!=typeof c?c:"png",g.migcore+"/images/emoticons/virtualgifts/"+a+"_"+b+"."+c)},m.get_gender=function(a){switch(a){case"M":return h.gender.name.M;case"F":return h.gender.name.F;default:return""}},m.block_function=function(a){var b=function(){};return b.__blocked_function=a,b},m.unblock_function=function(a){return a.__blocked_function&&b.isFunction(a.__blocked_function)?a.__blocked_function:a},m.translate=function(){return a.i18n.fallbacks.default_lang_set||(a.i18n.fallbacks.default_lang_set=!0,a.each(k.language.fallbacks,function(b,c){a.i18n.fallbacks[b]=c})),a.i18n.apply(this,arguments)},m.format=function(){for(var a=arguments[0]||"",b=1;b<arguments.length;b++){var c=new RegExp("\\{"+(b-1)+"\\}","gi");a=a.replace(c,arguments[b])}return a},m.is_logged_in=function(){var a=!b.isUndefined(i)&&!b.isNull(i);return a&&!b.isNull(i.username)},m.is_owner=function(){if(!this.is_logged_in())return!1;var a=m.get_username();return i.username==a||i.alias==a},m.add_thousands_seperator=function(a){a+="";for(var b=a.split("."),c=b[0],d=b.length>1?"."+b[1]:"",e=/(\d+)(\d{3})/;e.test(c);)c=c.replace(e,"$1,$2");return c+d},m.round_number_decimal=function(a,b){var c;return b=b||2,c=Math.pow(10,b),a=parseFloat(a),isNaN(a)?0:Math.ceil((a*c).toFixed(5),b)/c},m.number_format=function(a,b){if(a=parseFloat(a),isNaN(a))return a;b||(b=0);var c=Math.pow(10,b);return Math.floor(a*c+(a*c*10%10>=5?1:0))/c},m.round_number=function(a,b,c){if(b="undefined"!=typeof b?b:1e6,c="undefined"!=typeof c?c:1,b>a)return this.add_thousands_seperator(a);c=Math.pow(10,c);for(var d=["K","M","B","T"],e=d.length-1;e>=0;e--){var f=Math.pow(10,3*(e+1));if(a>=f){a=Math.round(a*c/f)/c,1e3==a&&e<d.length-1&&(a=1,e++),a+=d[e];break}}return a},m.strip_tags=function(a){return a?a.replace(/<\/?[^>]+(>|$)/g,""):a},m.htmlspecialchars=function(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},m.character_limiter=function(a,b,c){return c=c||!1,"undefined"==typeof a?a:(c&&(a=this.strip_tags(a)),a.length>b?a.substring(0,b)+"...":a)},m.humanize_string=function(a){return b.isUndefined(a)?"":a.replace(/_/g," ").toLowerCase().replace(/(?:^|\s)\S/g,function(a){return a.toUpperCase()})};var o,p,q,r,s=function(a,b){return q[b]},t=function(a,b){return b in r?r[b]:String.fromCharCode(parseInt(b.substr(2),10))};m.addCharacterEntities=function(a){var b,c,d=[],e=[];for(b in a)Object.prototype.hasOwnProperty.call(a,b)&&(c=a[b],r[b]=c,q[c]=b,d.push(c),e.push(b));o=new RegExp("("+d.join("|")+")","g"),p=new RegExp("("+e.join("|")+"|&#[0-9]{1,5};)","g")},m.getLanguage=function(){return"ENG"},m.resetCharacterEntities=function(){q={},r={},this.addCharacterEntities({"&amp;":"&","&gt;":">","&lt;":"<","&quot;":'"'})},m.htmlEncode=function(a){return a?String(a).replace(o,s):a},m.htmlDecode=function(a){return a?String(a).replace(p,t):a},m.resetCharacterEntities(),m.dateFormat=function(a,b,c){return e.format(a,b,c)},m.lpad=function(a,c,d){if(!b.isString(a))throw"lpad function expects a string as the first param";for(var e=a;e.length<d;)e=c+e;return e},m.rpad=function(a,c,d){if(!b.isString(a))throw"rpad function expects a string as the first param";for(var e=a;e.length<d;)e+=c;return e};var u=0,v="mig33";m.set_global_function=function(a){var b=[v,"handler",++u,(new Date).getTime()].join("_");return window[b]=a,b},m.delete_global_function=function(a){return delete window[a],!0};var w=Math.random,x="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";return m.get_uuid=function(){return x.replace(/[xy]/g,function(a){var b=16*w()|0,c="x"==a?b:3&b|8;return c.toString(16)})},m.get_guid=m.get_uuid,m.get_query_params_by_name=function(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b=new RegExp("[\\?&]"+a+"=([^&#]*)"),c=b.exec(location.search);return null===c?"":decodeURIComponent(c[1].replace(/\+/g," "))},m.check_recharge_page=function(){var a=/credit\/recharge\/\w+/.exec(document.URL);return a},m.appendQueryString=function(a,b){var c=-1==a.indexOf("?")?"?":"&",d=[];for(var e in b)d.push(e+"="+b[e]);var f=d.join("&");return a+c+f},m.show_share_dialog=function(b,c){var d="",e=c.mimetype||{};"undefined"!=typeof c.attributes?"undefined"!=typeof c.attributes.id&&(d=c.attributes.id):"undefined"!=typeof c.chatroomname?d=c.chatroomname:"undefined"!=typeof c.id&&(d=c.id),m.send_event_to_ga("Post","Share "+b,d);var f;f=a("#share-modal").data("shareModalViewObject"),f.updateShareURL(b,c),f.setMimeType(e),a("#share-modal").modal("show")},m.show_share_to_chat_dialog=function(b,c){var d;d=a("#share-to-chat-modal").data("shareToChatModalViewObject"),d.populate(),a("#share-to-chat-modal").modal("show")},m.show_gift_selection=function(b,c){if(!this.is_logged_in())return void this.show_login_dialog();var d;d=a("#gift-modal").data("giftModalViewObject"),d.showGiftSelection(b,c),a("#gift-modal").modal("show")},m.show_invite_friend_dialog=function(){if(!this.is_logged_in())return void this.show_login_dialog();a("#invite-friends-modal").data("inviteModalViewObject");a("#invite-friends-modal").modal("show")},m.show_gift_dialog=function(b,d){if(!this.is_logged_in())return void this.show_login_dialog();"undefined"==typeof d&&(d="buy");var e,f=this;e=a("#gift-modal").data("giftModalViewObject"),e.showGiftItem(b,d),a("#gift-modal").modal("show");var g=c.history.fragment;a("title").text();a("#gift-modal").one("hidden.bs.modal",function(a){f.track_navigate(g)}),this.track_navigate("/store/item/"+b.id)},m.escapeHtmlTags=function(a){return a?a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):a},m.show_chat_invite_dialog=function(b){var c=a("#chat-invite-modal").data("chatInviteModalViewObject");c.populate(b),a("#chat-invite-modal").modal("show")},m.show_find_more_people=function(b){c.history.navigate("/search/users/",!0),a("input[name=search-form-query]").focus(),a(".search-tab-container .nav.nav-tabs",this.$el).show().find("li").removeClass("active").end().find("li.search-tab-users").addClass("active")},m.show_login_dialog=function(){if(a("#login-modal").length>0){var b=a("#login-modal").data("loginModalViewObject");return b.updateReturnURL(),b.showModal(),!0}return!1},m.hide_mobile_chat=function(){var b;b=a("#navbar-inner").data("navbarLayoutObject"),b.hideMobileChat(null)},m.random_array_sort=function(a){var b,c,d=a.length;if(0>=d)return a;for(;--d;)c=Math.floor(Math.random()*(d+1)),b=a[c],a[c]=a[d],a[d]=b;return a},a.expr[":"].containsIgnoreCase=function(a,b,c){return jQuery(a).text().toUpperCase().indexOf(c[3].toUpperCase())>=0},m.getBase64Image=function(a){var b=document.createElement("canvas");b.width=a.width,b.height=a.height;var c=b.getContext("2d");c.drawImage(a,0,0);var d=b.toDataURL("image/png");return d},m.dataURItoBlob=function(a){var b;b=a.split(",")[0].indexOf("base64")>=0?atob(a.split(",")[1]):decodeURI(a.split(",")[1]);for(var c=a.split(",")[0].split(":")[1].split(";")[0],d=new Uint8Array(b.length),e=0;e<b.length;e++)d[e]=b.charCodeAt(e);return new Blob([d],{type:c})},m.deviceOS=function(){var a=navigator.userAgent;return a.match(/iPad/i)||a.match(/iPhone/i)||a.match(/iPod/i)?"iOS":a.match(/Android/i)?"Android":void 0},m.isMigmeApp=function(){var a=navigator.userAgent;return!!a.match(/migme/i)},m.isMobile=function(){var a=navigator.userAgent,b=!1;return(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4)))&&(b=!0),
b},m.initFacebook=function(a){return"undefined"!=typeof window.FB?void a():(window.fbAsyncInit=function(){window.FB.init({appId:h.fb_app_id,xfbml:!0,version:"v2.5"}),a()},void function(a,b,c){var d,e=a.getElementsByTagName(b)[0];a.getElementById(c)||(d=a.createElement(b),d.id=c,d.src="//connect.facebook.net/en_US/sdk.js",e.parentNode.insertBefore(d,e))}(document,"script","facebook-jssdk"))},m.FacebookLogin=function(a,b){this.initFacebook(function(){window.FB.getLoginStatus(function(c){"connected"!==c.status?window.FB.login(a,{scope:b}):a()})})},m.getFacebookFriends=function(a){this.FacebookLogin(function(){window.FB.api("/me/friends",{limit:9999},function(b){a(b)})},"user_friends")},m.inviteFriendToFacebook=function(b,c,d,e){null==c&&(c=585),null==d&&(d=360),null==e&&(e=g.site+"/utilities/close_window");var f={app_id:h.fb_app_id,display:"popup",message:"Come chat with me on migme!",href:b,redirect_uri:e,title:"Invite to migme"},i="https://www.facebook.com/dialog/apprequests?"+a.param(f);this.openPopupWindow(i,c,d)},m.shareToFacebook=function(b,c,d){null==c&&(c=585),null==d&&(d=360);var e={app_id:h.fb_app_id,display:"popup",href:b,redirect_uri:g.site+"/utilities/close_window"},f="https://www.facebook.com/dialog/share?"+a.param(e);this.openPopupWindow(f,c,d)},m.openPopupWindow=function(a,b,c){var d=void 0!=window.screenLeft?window.screenLeft:screen.left,e=void 0!=window.screenTop?window.screenTop:screen.top,f=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,g=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,h=f/2-b/2+d,i=g/2-c/2+e,j=window.open(a,"mig33SettingsPopup","status=no,height="+c+",width="+b+",resizable=yes,left="+h+",top="+i+",toolbar=no,menubar=no,scrollbars=no,location=no,directories=no");j.focus()},m.getSessionInfo=function(){j.getInstance()},m.getCoverphoto=function(){var a=j.getInstance();return a.attributes.cover_photo_url},m.getMentions=function(){var b=0,c=j.getInstance(),d=c.attributes.id;return a.ajax({url:m.format(k.urls.mentions_count_url,d),async:!1}).done(function(a){b=a.data}),b},m.getId=function(){var a=j.getInstance();return a.attributes.id},m.elementSupportsAttribute=function(a,b){var c=document.createElement(a);return b in c},m.getQueryString=function(){var b={};return a.each(document.location.search.substr(1).split("&"),function(a,c){var d=c.split("=");return"undefined"==typeof d[1]?b:void(b[d[0].toString()]=d[1].toString())}),b},m.track_navigate=function(a){c.history.navigate(a,{trigger:!1,replace:!0}),"object"!=typeof dataLayer||"undefined"!=typeof c.history.firstLoad&&c.history.firstLoad!==!1||dataLayer.push({event:"sendVirtualPageview",vpv:"/"+c.history.fragment})},m.mapMonthName=function(a){var b="string"!=typeof a?String(a):a,c={0:"January",1:"February",2:"March",3:"April",4:"May",5:"June",6:"July",7:"August",8:"September",9:"October",10:"November",11:"December"};return c[b]||null},m.inline_svg=function(){jQuery("img.svg").each(function(){var a=jQuery(this),b=a.attr("id"),c=a.attr("class"),d=a.attr("src");jQuery.ajax({url:d,crossDomain:!0,dataType:"xml"}).then(function(d){var e=jQuery(d).find("svg");"undefined"!=typeof b&&(e=e.attr("id",b)),"undefined"!=typeof c&&(e=e.attr("class",c+" replaced-svg")),e=e.removeAttr("xmlns:a"),!e.attr("viewBox")&&e.attr("height")&&e.attr("width")&&e.attr("viewBox","0 0 "+e.attr("height")+" "+e.attr("width")),a.replaceWith(e)})})},m.is_empty=function(a){return"undefined"==typeof a||null===a||""===a?!0:void 0},m.get_userlabel_color=function(a){var b="normal-user";return"undefined"!=typeof a.admin&&null!==a.admin&&("C"===a.admin&&(b="username-coach"),"A"===a.admin&&(b="username-admin"),"CA"===a.admin&&(b="username-chatadmin"),"GA"===a.admin&&(b="username-groupadmin")),"undefined"!=typeof a.merchant&&null!==a.merchant&&("M"===a.merchant&&(b="username-merchant"),"MT"===a.merchant&&(b="username-merchant-mentor")),b},m.isNewLabelAchievementFeedDismissed=function(a){var b="dismissed_new_achievement_label_feed_"+a;return f.hasKey(b)||f.set(a,!1),Boolean(f.get(b))},m.setNewLabelAchievementFeedDismissed=function(a,b){f.set("dismissed_new_achievement_label_feed_"+a,b)},window.show_error=m.show_error,window.show_success=m.show_success,window.show_message=m.show_message,m}),define("modules/chat/data/ftransport_queue",["require","exports","../../common/task_runner","../../common/event_logger","underscore"],function(a,b,c,d){var e=(a("underscore"),d.Logger.getInstance()),f=function(){function a(a){this.queue=[],this.queue_monitor=new c.TaskRunner,this.send_multi_packet=!1,this.monitor_timeout=2e4,this.max_packet_retry=3,this.config={transport:null},this.transport=a}return a.prototype.start_monitor=function(){var a=this;this.queue_monitor.clear(),this.queue_monitor.start({scope:this,fireOnStart:!1,run:function(){a.check_queue()},interval:this.monitor_timeout})},a.prototype.stop_monitor=function(){this.queue_monitor.stop()},a.prototype.check_queue=function(){e.log(Date.now()+":checking queue, length is "+this.queue.length);var a,b=[];if(this.queue.length>0){if(this.send_multi_packet){for(e.log(Date.now()+":resending multiple packets..");this.queue.length>0;)a=this.queue.shift(),a.retry_count<this.max_packet_retry?(a.sent_time=Date.now(),a.retry_count+=1,e.log(Date.now()+":resending multi packet "+JSON.stringify(a.to_packet_json())),b.push(a)):e.log(Date.now()+":resending multi packet has reached max retry! "+JSON.stringify(a.to_packet_json()));this.queue=[],this.transport.send_packets(b)}else a=this.queue.shift(),a.retry_count<this.max_packet_retry?(e.log(Date.now()+":resending single packet "+JSON.stringify(a.to_packet_json())),a.sent_time=Date.now(),a.retry_count+=1,this.transport.send_packet(a)):e.log(Date.now()+":packet has reached max retry! "+JSON.stringify(a.to_packet_json()));this.start_monitor()}},a.prototype.add_packet=function(a){e.log(Date.now()+":adding packet to queue: "+JSON.stringify(a.to_packet_json())),this.queue.push(a)},a.prototype.remove_packet=function(a){if(a.queue===!1||0===this.queue.length)return!1;var b=this.queue[0];return b.transaction_id===a.transaction_id?(this.queue.shift(),!0):!1},a}();b.TransportQueue=f}),define("modules/chat/data/fthread_manager",["require","exports","underscore"],function(a,b){var c=a("underscore"),d=function(){function a(){this.queue=[],this.timeout=0,this.process_size=1e3,this.timer=null}return a.prototype.queue_worker=function(a,b){"undefined"==typeof b&&(b=!1),this.queue.push(a),b&&this.start()},a.prototype.execute=function(){var a=this;this.timer=null,c.times(this.process_size,function(){var b=a.queue.shift();b&&(b.working?a.queue.unshift(b):b.execute())}),this.queue.length>0?this.start():this.stop()},a.prototype.start=function(){var a=this;null===this.timer&&(this.timer=setTimeout(function(){a.execute()},this.timeout))},a.prototype.stop=function(){null!==this.timer&&clearTimeout(this.timer),this.timer=null},a}();b.ThreadManager=d}),define("modules/chat/fusion/fpacket_defs",["require","exports"],function(a,b){var c=function(){function a(){}return a.ACCEPT_CONTACT_REQUEST=413,a.ACCOUNT_BALANCE=902,a.ACTIVATE_ACCOUNT=204,a.ADD_CONTACT=405,a.ADD_FAVOURITE_CHATROOM=711,a.ADD_GROUP=408,a.ALERT=5,a.ANONYMOUS_CALL_NOTIFICATION=806,a.ANONYMOUS_CALL_RESPONSE=807,a.APPLICATION_MENU=933,a.APPLICATION_MENU_COMPLETE=934,a.AVATAR=603,a.CAPTCHA=16,a.CAPTCHA_RESPONSE=17,a.CHANGE_PASSWORD=908,a.CHANGE_USER_EVENT_SETTING=921,a.CHAT=560,a.CHATROOM=701,a.CHATROOM_CATEGORY=714,a.CHATROOM_NOTIFICATION=718,a.CHATROOM_PARTICIPANTS=708,a.CHATROOM_THEME=719,a.CHATROOM_USER_STATUS=720,a.CHAT_LIST_VERSION=561,a.CLEAR_EMOTICON=915,a.COMPARE_CALL_RATE=805,a.CONTACT=402,a.CONTACT_LIST_VERSION=420,a.CONTACT_REQUEST=412,a.CREATE_CHATROOM=705,a.CREATE_GROUP_CHAT=751,a.CREATE_SESSION=211,a.DEVICE_MODE=604,a.DIAL=804,a.DISPLAY_PICTURE=423,a.DYNAMIC_MENU=911,a.DYNAMIC_MENU_ICON=930,a.EMOTICON=914,a.EMOTICON_HOTKEYS=916,a.END_MESSAGES=562,a.END_STICKER_PACK=942,a.ERROR=0,a.FILE_RECEIVED=502,a.FORGOT_PASSWORD=904,a.GET_ACCOUNT_BALANCE=901,a.GET_CATEGORIZED_CHATROOMS=716,a.GET_CATEGORIZED_CHATROOMS_COMPLETE=717,a.GET_CHATROOMS=700,a.GET_CHATROOMS_COMPLETE=702,a.GET_CHATROOM_CATEGORIES=713,a.GET_CHATROOM_CATEGORIES_COMPLETE=715,a.GET_CHATROOM_PARTICIPANTS=707,a.GET_CHATS=551,a.GET_CONTACTS=400,a.GET_CONTACTS_COMPLETE=403,a.GET_CONTACT_REQUESTS=425,a.GET_DYNAMIC_MENU_ICON=929,a.GET_EMOTICON=913,a.GET_EMOTICONS_COMPLETE=928,a.GET_EMOTICON_HOTKEYS=937,a.GET_GIFT=935,a.GET_GROUP_CHAT_PARTICIPANTS=754,a.GET_HELP_TEXT=7,a.GET_IM_ICONS=926,a.GET_MESSAGES=550,a.GET_MIDLET_PROPERTY=12,a.GET_PERMISSION_LIST=415,a.GET_PINNED_MESSAGE=553,a.GET_PRELOGIN_MARKETING_MSG=931,a.GET_SERVER_QUESTION=18,a.GET_STICKER_PACK=940,a.GET_STICKER_PACK_LIST=938,a.GET_UPLOAD_DATA_TICKET=959,a.GET_URL=910,a.GET_USER_INIT_DETAILS=424,a.GET_USER_PROFILE=905,a.GIFT_HOTKEYS=936,a.GROUP=401,a.GROUP_CHAT=750,a.GROUP_CHAT_INVITE=752,a.GROUP_CHAT_PARTICIPANTS=755,a.GROUP_CHAT_USER_STATUS=756,a.HAVE_LATEST_CHAT_LIST=552,a.HAVE_LATEST_CONTACT_LIST=419,a.HELP_TEXT=6,a.HTTP_POLL=13,a.IM_AVAILABLE=208,a.IM_ICONS=927,a.IM_LOGIN=206,a.IM_LOGOUT=302,a.IM_SESSION_STATUS=207,a.INVITE_FRIEND=900,a.JOIN_CHATROOM=703,a.KICK_CHATROOM_PARTICIPANT=706,a.LANGUAGE=925,a.LATEST_MESSAGES_DIGEST=563,a.LEAVE_CHATROOM=704,a.LEAVE_GROUP_CHAT=753,a.LEAVE_PRIVATE_CHAT=507,a.LOGIN=200,a.LOGIN_CHALLENGE=201,a.LOGIN_OK=203,a.LOGIN_RESPONSE=202,a.LOGOUT=300,a.MAIL_INFO=503,a.MESSAGE=500,a.MESSAGE_EVENT=506,a.MIDLET_ACTION=920,a.MIDLET_PROPERTY=11,a.MIDLET_TAB=918,a.MOVE_CONTACT=411,a.MUTE_CHATROOM_PARTICIPANT=709,a.NEW_REGISTRATION=100,a.NOTIFICATION=14,a.OK=1,a.OPEN_URL=922,a.OPEN_URL_RESPONSE=923,a.PERMISSION_LIST=416,a.PHONE_CALL=800,a.PING=2,a.PING_REPLY=3,a.PRELOGIN_MARKETING_MSG=932,a.PRESENCE=404,a.RECHARGE=903,a.REGISTRATION=101,a.REGISTRATION_CHALLENGE=102,a.REGISTRATION_ERROR=104,a.REGISTRATION_RESPONSE=103,a.REJECT_CONTACT_REQUEST=414,a.REMOVE_CONTACT=406,a.REMOVE_FAVOURITE_CHATROOM=712,a.REMOVE_GROUP=409,a.REPORT=10,a.RESEND_VERIFICATION_CODE=205,a.RESERVED=15,a.SERVER_QUESTION=8,a.SERVER_QUESTION_REPLY=9,a.SESSION_TERMINATED=301,a.SET_CHAT_NAME=564,a.SET_DISPLAY_PICTURE=602,a.SET_MESSAGE_EVENT=505,a.SET_PERMISSION=417,a.SET_PRESENCE=600,a.SET_STATUS_MESSAGE=601,a.SLIM_LOGIN=209,a.SLIM_LOGIN_CHALLENGE=212,a.SLIM_LOGIN_OK=210,a.STATUS_MESSAGE=421,a.STICKER_PACK=941,a.STICKER_PACK_LIST=939,a.TEXT_COLOUR=924,a.TRANSFER_CREDIT=909,a.UNMUTE_CHATROOM_PARTICIPANT=710,a.UPDATE_CONTACT=407,a.UPDATE_GROUP=410,a.UPDATE_USER_PROFILE=907,a.UPLOAD_ADDRESS_BOOK_CONTACTS=960,a.UPLOAD_FILE=504,a.USER_EVENT=422,a.USER_PROFILE=906,a.VOICE_CAPABILITY=418,a.WALLPAPER=912,a.WAP_PUSH=501,a.WEBCALL=801,a.WEBCALL_NOTIFICATION=802,a.WEBCALL_RESPONSE=803,a}();b.FUSION_PACKET_TYPES=c,b.FUSION_PACKET_FIELDS={0:{errordescription:2,errornumber:1},1:{serverresponse:1,servertime:2},2:{},3:{},5:{alerttype:1,content:2,contenttype:3,timeout:5,title:4},6:{text:1},7:{id:1},8:{question:2,questiontype:1,timeout:5,title:4,url:3},9:{answer:1,questionid:2},10:{description:2,reporttype:1},11:{key:2,propertytype:1,value:3},12:{key:2,propertytype:1},13:{},14:{notificationtype:3,pendingnotificationstotal:4,text:1,url:2},15:{},16:{captchaimage:2,displaytext:1},17:{captcharesponse:1},18:{},100:{dateofbirth:8,displayname:5,emailaddress:9,firstname:6,groupid:12,imei:15,lastname:7,mobiledevice:14,mobilephone:4,password:3,servicetype:1,startupcardnumber:10,startupcardpin:11,useragent:13,username:2},101:{clienttype:3,screenheight:2,screenwidth:1},102:{captchaid:2,captchaimage:3,iddcode:1},103:{captchaid:4,captcharesponse:5,dateofbirth:8,groupid:6,imei:11,mobiledevice:10,mobilephone:3,password:2,useragent:9,username:1},104:{captchaid:2,captchaimage:3,errordescription:1},200:{applicationmenuversion:23,cellid:17,clienttype:2,clientversion:3,emailaddress:6,fontheight:11,initialpresence:9,language:15,localareacode:20,mobilecountrycode:22,mobiledevice:8,mobilenetworkcode:21,protocolversion:1,screenheight:13,screenwidth:12,servicetype:4,sessionid:18,stickersize:26,streamuserevents:19,themeid:16,useragent:7,username:5,vastrackingid:24,vgsize:25,voicecapability:10,wallpaperid:14},201:{challenge:1,sessionid:2},202:{passwordhash:1},203:{aimdetail:7,alert:3,alertcontenttype:4,anonymouscalling:25,asteriskid:9,asteriskserver:10,asteriskservers:5,badgehotkey:28,contactlistversion:20,currency:11,emoticonheight:16,exchangerate:12,facebookdetail:30,fusionpresence:34,gtalkdetail:17,imageserverurl:23,localdidsupport:18,mailcount:14,mailurl:13,mobilephone:1,mobileverified:2,msndetail:6,pageleturl:26,reputationimagepath:32,reputationlevel:31,sendconnectionreport:29,servertime:43,supportschatsync:40,supportsstickers:42,tcptunnelling:33,usereventstokeep:24,userid:38,username:39,usertype:27,virtualgiftsize:41,voipcodec:15,yahoodetail:8},204:{verificationcode:1},205:{mobilephone:1},206:{imtype:1,initialpresence:2,showofflinecontacts:3},207:{imtype:1,reason:3,status:2,supportsconference:4},208:{imdetail:4,imtype:1,messagetype:3,name:2,supportsgroupchat:5},209:{clienttype:2,clientversion:3,initialpresence:7,mobiledevice:9,password:6,protocolversion:10,servicetype:4,useragent:8,username:5},210:{sessionid:1},211:{applicationmenuversion:16,clienttype:2,clientversion:5,fontheight:10,initialpresence:8,language:15,mobiledevice:7,protocolversion:1,screenheight:12,screenwidth:11,sessionid:3,stickersize:19,streamuserevents:4,themeid:14,useragent:6,vastrackingid:17,vgsize:18,voicecapability:9,wallpaperid:13},212:{challenge:2,sessionid:1},300:{},301:{reason:1},302:{imtype:1},400:{contactid:2,presence:1},401:{groupid:1,groupname:2},402:{aimpresence:17,aimusername:16,contactid:1,defaultim:11,defaultphone:7,displayname:3,displaypicture:28,emailaddress:6,facebookpresence:30,facebookusername:29,firstname:4,fusionpresence:13,fusionusername:12,groupid:2,gtalkpresence:23,gtalkusername:22,homephone:9,icqpresence:21,icqusername:20,impresences:32,imtypes:31,imusernames:33,lastname:5,mobilephone:8,msnpresence:15,msnusername:14,officephone:10,sharemobilephone:24,statusmessage:27,voicecapability:25,yahoopresence:19,yahoousername:18},403:{},404:{aimpresence:4,contactid:1,facebookpresence:8,fusionpresence:2,gtalkpresence:7,icqpresence:6,impresences:10,imtypes:9,msnpresence:3,yahoopresence:5},405:{aimusername:16,defaultim:11,defaultphone:7,displayname:3,emailaddress:6,facebookusername:29,firstname:4,fusionusername:12,groupid:2,gtalkusername:22,homephone:9,icqusername:20,imtype:31,imusername:30,lastname:5,mobilephone:8,msnusername:14,officephone:10,sharemobilephone:24,yahoousername:18},406:{contactid:1},407:{aimuserame:16,contactid:1,defaultim:11,defaultphone:7,displayname:3,emailaddress:6,facebookuserame:29,firstname:4,fusionuserame:12,groupid:2,gtalkuserame:22,homephone:9,icquserame:20,imtypes:31,imusernames:30,lastname:5,mobilephone:8,msnuserame:14,officephone:10,yahoouserame:18},408:{groupname:2},409:{groupid:1},410:{groupid:1,groupname:2},411:{contactid:1,groupid:2},412:{profileurl:2,username:1},413:{addcontact:2,contactusername:1,groupid:3,sharemobilephone:4},414:{blockuser:2,contactusername:1},415:{listtype:1},416:{allowlist:1,blocklist:2},417:{permission:2,username:1},418:{contactid:1,voicecapability:2},419:{statustimestamp:1},420:{contactlistversion:1,statustimestamp:2},421:{contactid:1,statusmessage:2,statustimestamp:3},422:{eventtype:2,generatinguserprofileimageguid:3,secondsago:1,text:4,timestamp:5},423:{contactid:1,displaypicture:2,statustimestamp:3},424:{},425:{},500:{badgehotkey:14,contactid:5,contentasstring:8,contenttype:6,destination:4,destinationtype:3,displaypicture:10,emotecontenttype:20,filename:7,fromadministrator:9,groupchatname:17,groupchatowner:18,guid:15,hotkeys:11,messagecolor:13,messagetype:1,pinnedType:24,previousmessageguid:19,source:2,sourcecolor:12,timestamp:16,mimetype:21,mimetypedata:22,messageeventtype:23},501:{username:1},502:{contactid:3,infomessage:4,source:2,sourcetype:1,url:5},503:{mailcount:1},504:{content:2,description:3,destination:4,filetype:1,useasdisplaypicture:5},505:{messagedestination:4,messagedestinationtype:3,messageeventtype:6,messageguid:5,messagesource:2,messagetype:1,eventsourceserver:7,messagetimestamp:8},506:{messagedestination:4,messagedestinationtype:3,messageeventtype:6,messageguid:5,messagesource:2,messagetype:1},507:{destinationusername:1,imtype:2},550:{chatidentifier:1,chattype:2,latestmessagetimestamp:3,limit:5,oldestmessagetimestamp:4},551:{chattype:3,limit:2,version:1},552:{timestamp:2,version:1},553:{chatid:1,destinationtype:2},560:{chatdisplayname:2,chatidentifier:1,chatlisttimestamp:12,chatlistversion:11,chattype:3,contactid:5,displayguid:8,groupowner:6,isclosedchat:7,messagetype:9,timestamp:10,unreadmessagecount:4,isrenamedchat:13},561:{timestamp:2,version:1},562:{chatidentifier:1,finalmessageguid:3,firstmessageguid:2,messagessent:4},563:{chatid:1,guids:2,timestamps:3,chattypes:4,messages:5},564:{chatidentifier:1,chatname:3,chattype:2},565:{guids:6,timestamps:7},600:{newpresence:1},601:{statusmessage:1},602:{displaypicture:1},603:{avatar:4,badgehotkey:3,displaypicture:2,fullbodyavatar:5,statusmessage:1},604:{devicemode:1},700:{chatroomnames:3,page:2,searchstring:1},701:{adultonly:5,category:6,chatroomid:9,chatroomname:1,creator:10,description:2,groupid:8,maximumsize:3,newowner:12,size:4,themeid:11,userowned:7},702:{infotext:2,pages:1},703:{chatroomname:1,requestPinned:2},704:{chatroomname:1},705:{chatroomname:1},706:{chatroomname:1,username:2},707:{chatroomname:1},708:{administrators:3,chatroomname:1,mutedparticipants:4,participants:2,requestingUserType:5},709:{chatroomname:1,username:2},710:{chatroomname:1,username:2},711:{chatroomname:1},712:{category:1,chatroomname:2},713:{},714:{category:1,collapse:4,header:2,itemscanbedeleted:5,refreshmethod:3},715:{},716:{category:1,refresh:2},717:{categoryfooter:1},718:{text:1,url:2},719:{adminmsgcolor:10,adminusernamecolor:9,backgroundcolor:2,backgroundimgalignment:4,backgroundimgurl:3,clientmsgcolor:15,emotemsgcolor:11,errormsgcolor:12,recpmsgcolor:8,recpusernamecolor:7,sendermsgcolor:6,senderusernamecolor:5,servermsgcolor:14,serverusernamecolor:13,themeid:1},720:{chatroomname:2,fusionusername:3,userstatustype:1,usertype:4},750:{creator:2,groupchatid:1,imtype:3},751:{imtype:3,inviteduser:2,otherpartylist:4,participant:1},752:{groupchatid:1,imtype:3,username:2,usernames:4},753:{groupchatid:1,imtype:2},754:{groupchatid:1,imtype:2},755:{groupchatid:1,imtype:5,mutedparticipants:4,participants:2},756:{chatroomname:2,fusionusername:3,userstatustype:1,usertype:4},800:{contactid:3,destination:2,evaluate:4,method:5,source:1},801:{destination:2,destinationtype:1,evaluate:5,gateway:3,gatewayname:4,protocol:6},802:{destination:2,gateway:3,gatewayname:4,source:1,sourceprotocol:5},803:{destinationprotocol:5,gateway:2,gatewayname:3,source:1,sourceprotocol:4},804:{confirmationmessage:2,phonenumber:1},805:{destination:2,source:1},806:{description:1,requestingusername:2},807:{blockrequestinguser:3,disableanonymouscalling:4,requestingusername:1,response:2},900:{displayname:2,groupid:3,mobilephone:1},901:{},902:{accountbalance:1},903:{amount:10,cardexpirydate:6,cardholder:7,cardnumber:4,cardpin:5,cardtype:3,receiptnumber:8,rechargecode:9,rechargemethod:2,username:1},904:{mobilephone:2,username:1},905:{},906:{aimautologin:23,aimpassword:22,aimusername:21,autorecharge:14,awaymessage:13,city:4,countryid:6,dateofbirth:8,displayname:1,emailaddress:10,facebookautologin:29,facebookpassword:28,facebookusername:27,firstname:2,gender:9,gtalkautologin:26,gtalkpassword:25,gtalkusername:24,lastname:3,mobilephone:12,msnautologin:17,msnpassword:16,msnusername:15,onmailinglist:11,state:5,utcoffset:7,yahooautologin:20,yahoopassword:19,yahoousername:18},907:{aimautologin:23,aimpassword:22,aimusername:21,autorecharge:14,awaymessage:13,city:4,countryid:6,dateofbirth:8,displayname:1,emailaddress:10,facebookautologin:29,facebookpassword:28,facebookusername:27,firstname:2,gender:9,gtalkautologin:26,gtalkpassword:25,gtalkusername:24,imtypetoremove:30,lastname:3,mobilephone:12,msnautologin:17,msnpassword:16,msnusername:15,onmailinglist:11,state:5,utcoffset:7,yahooautologin:20,yahoopassword:19,yahoousername:18},908:{newpassword:2,oldpassword:1},909:{amount:2,commit:3,username:1},910:{profilename:2,urltype:1},911:{iconid:5,menutype:1,position:2,title:3,url:4},912:{content:2,id:1},913:{hotkeys:1},914:{alias:3,alternatehotkeys:2,content:4,contenttype:5,hotkey:1,packid:6,url:7},915:{},916:{alternatekeys:2,hotkeys:1},918:{focus:2,url:1},920:{action:1},921:{allevents:1},922:{cookies:11,method:1,parameter:3,url:2},923:{content:2,cookies:11,responsecode:1,timetolive:3},924:{chatmessagecolours:2,chatsendercolours:1},925:{language:1},926:{imtypes:1},927:{away:5,busy:4,imtype:1,offline:6,online:2,roaming:3},928:{},929:{iconid:1},930:{icon:2,iconid:1},931:{clienttype:1,clientversion:2},932:{marketingmsg:1,url:2},933:{actionurl:4,iconurl:5,menuversionid:1,position:2,textid:3},934:{menuversionid:1},935:{limit:1},936:{giftnames:2,giftprice:3,hotkeys:1},937:{sessionid:1},938:{},939:{stickerpackids:1,stickerpackversions:2},940:{packids:1},941:{stickerhotkeys:3,stickerpackiconurl:4,stickerpackid:1,stickerpackname:2,stickerpackversion:5},942:{},959:{},960:{}}});var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};define("modules/chat/fusion/fpacket",["require","exports","./fpacket_defs","underscore","jquery","backbone"],function(a,b,c){function d(){var a="transaction_id_key",b=parseInt($.jStorage.get(a),10);return b||(b=1),b=1+b%32766,$.jStorage.set(a,b),b}function e(a){return p[a]}function f(a){var b=o.get(a);return m.isUndefined(b)||m.isNull(b)?[]:b.get("listeners")||[]}function g(a){return a._isPacket}function h(a){return b.isPacket(a)?void(p[a.transaction_id]=a):void console.log("Not a packet")}function i(a,b){return a.type==b}function j(a){var b,c;c=o.get(a.packet_type),c?b=c.get("listeners"):(b=[],o.add({id:a.packet_type,listeners:b})),b.push(a)}function k(a,b){var c=new q;return c.setPacketParams(a,b),c}function l(a){var c=a.I,d=b.create_packet(parseInt(a.T,10),parseInt(c,10));return d.set(a.F),d}var m=a("underscore");b.get_transaction_id=d,b.get_packet_by_id=e;var n=function(){function a(){}return a.create="create",a.sent="sent",a.sent_success="sent_success",a.send_failed="send_failed",a.received="received",a.error="error",a.ok="ok",a.response="response",a}();b.packet_events=n;var o=new Backbone.Collection,p={};b.get_packet_listeners=f,b.isPacket=g,b.add_to_packet_collection=h,b.isPacketType=i,b.add_packet_listener=j,b.create_packet=k,b.create_packet_from_json=l;var q=function(a){function d(){a.apply(this,arguments),this.timeout=3e4,this.event_list=n}return __extends(d,a),d.prototype.setPacketParams=function(a,d){var e=this,f=!0;if(d?(this.transaction_id=d,this.parent_packet=b.get_packet_by_id(d),this.ignore_global_listeners=this.parent_packet?this.parent_packet.ignore_global_listeners:!1):(this.parent_packet=null,this.transaction_id=b.get_transaction_id(),f=!1,this.ignore_global_listeners=!1),this.type=a,this.field_names=c.FUSION_PACKET_FIELDS[a],this._isPacket=!0,this.queue=!0,this.retry=!0,this.retry_count=0,this.create_time=Date.now(),this.bypass_thread=!1,!this.ignore_global_listeners){var g=b.get_packet_listeners(a);g.forEach(function(a){var b=function(b){b.name+"_fn";switch(b.name){case e.event_list.create:a.create_fn(e);break;case e.event_list.sent:a.sent_fn(e);break;case e.event_list.received:a.received_fn(e);break;case e.event_list.ok:a.ok_fn(e);break;case e.event_list.error:a.error_fn(e);break;case e.event_list.response:a.response_fn(e);break;case e.event_list.send_failed:a.send_failed_fn(e)}};return e.on(e.event_list.create,b,e),e.on(e.event_list.sent,b,e),e.on(e.event_list.received,b,e),e.on(e.event_list.ok,b,e),e.on(e.event_list.error,b,e),e.on(e.event_list.response,b,e),e.on(e.event_list.send_failed,b,e),null})}f||b.add_to_packet_collection(this),this.trigger(this.event_list.create,{event:this,name:this.event_list.create})},d.prototype.set_ignore_global_listeners=function(a){this.ignore_global_listeners=a},d.prototype.fire_send_event=function(){this.trigger(this.event_list.sent,{event:this,name:this.event_list.sent})},d.prototype.fire_send_success_event=function(){this.trigger(this.event_list.sent_success,{event:this,name:this.event_list.sent_success})},d.prototype.fire_send_failed_event=function(){this.trigger(this.event_list.send_failed,{event:this,name:this.event_list.send_failed})},d.prototype.fire_ok_event=function(a){this.trigger(this.event_list.ok,{response_packet:a,event:this,name:this.event_list.ok})},d.prototype.fire_response_event=function(a){this.trigger(this.event_list.response,{response_packet:a,event:this,name:this.event_list.response})},d.prototype.fire_error_event=function(a){this.trigger(this.event_list.error,{response_packet:a,event:this,name:this.event_list.error})},d.prototype.is_ok_packet=function(){return 1===this.type},d.prototype.is_error_packet=function(){return 0===this.type},d.prototype.get_error_message=function(){return this.is_error_packet()?this.get_field_value(2):null},d.prototype.get_key_from_string=function(a){if(m.isString(a)){var b=this.field_names[a];if(m.isUndefined(b)||m.isNull(b))throw a+" Field not found for packet type "+this.type;return b}throw"get_key_from_string method accepts a string value as parameter"},d.prototype.add_field=function(a,b){var c=this.get_key_from_string(a);this.set(c,b)},d.prototype.get_field_value=function(a){return m.isNumber(a)||(a=this.get_key_from_string(a)),this.get(a)},d.prototype.toObject=function(){var a=this,b={};return m.each(this.field_names,function(c,d){b[d]=a.get(c.toString())},this),b},d.prototype.to_packet_json=function(a){"undefined"==typeof a&&(a=!1);var b=a?0:this.transaction_id;return{T:this.type,I:b,F:this.toJSON()}},d.prototype.execute=function(){this.trigger(this.event_list.received,{event:this,name:this.event_list.received}),this.parent_packet&&(this.is_ok_packet()?(console.log("Received an ok packet"),this.parent_packet.fire_ok_event(this)):this.is_error_packet()&&(console.log("Received an error packet"),this.parent_packet.fire_error_event(this)),this.is_error_packet()||this.parent_packet.fire_response_event(this))},d}(Backbone.Model);b.FusionPacketType=q}),define("modules/chat/data/fthread_worker",["require","exports","../fusion/fpacket","underscore"],function(a,b,c){var d=function(){function a(){this.batch_id=0,this.working=!1}return a.createThreadWorker=function(b,c){"undefined"==typeof c&&(c={});var d=new a;return d.data=b,d.options=c,d.batch_id=0,d.working=!1,d},a.prototype.execute=function(){this.working=!0;var a;a=c.create_packet_from_json(this.data),a.execute(),this.working=!1},a}();b.ThreadWorker=d}),function(){function a(){var a=!1;if("localStorage"in window)try{window.localStorage.setItem("_tmptest","tmpval"),a=!0,window.localStorage.removeItem("_tmptest")}catch(b){}if(a)try{window.localStorage&&(v=window.localStorage,y="localStorage",B=v.jStorage_update)}catch(e){}else if("globalStorage"in window)try{window.globalStorage&&(v="localhost"==window.location.hostname?window.globalStorage["localhost.localdomain"]:window.globalStorage[window.location.hostname],y="globalStorage",B=v.jStorage_update)}catch(f){}else{if(w=document.createElement("link"),!w.addBehavior)return void(w=null);w.style.behavior="url(#default#userData)",document.getElementsByTagName("head")[0].appendChild(w);try{w.load("jStorage")}catch(g){w.setAttribute("jStorage","{}"),w.save("jStorage"),w.load("jStorage")}var i="{}";try{i=w.getAttribute("jStorage")}catch(j){}try{B=w.getAttribute("jStorage_update")}catch(m){}v.jStorage=i,y="userDataBehavior"}h(),k(),c(),l(),"addEventListener"in window&&window.addEventListener("pageshow",function(a){a.persisted&&d()},!1)}function b(){var a="{}";if("userDataBehavior"==y){w.load("jStorage");try{a=w.getAttribute("jStorage")}catch(b){}try{B=w.getAttribute("jStorage_update")}catch(c){}v.jStorage=a}h(),k(),l()}function c(){"localStorage"==y||"globalStorage"==y?"addEventListener"in window?window.addEventListener("storage",d,!1):document.attachEvent("onstorage",d):"userDataBehavior"==y&&setInterval(d,1e3)}function d(){var a;clearTimeout(A),A=setTimeout(function(){if("localStorage"==y||"globalStorage"==y)a=v.jStorage_update;else if("userDataBehavior"==y){w.load("jStorage");try{a=w.getAttribute("jStorage_update")}catch(b){}}a&&a!=B&&(B=a,e())},25)}function e(){var a,c=s.parse(s.stringify(u.__jstorage_meta.CRC32));b(),a=s.parse(s.stringify(u.__jstorage_meta.CRC32));var d,e=[],g=[];for(d in c)if(c.hasOwnProperty(d)){if(!a[d]){g.push(d);continue}c[d]!=a[d]&&"2."==String(c[d]).substr(0,2)&&e.push(d)}for(d in a)a.hasOwnProperty(d)&&(c[d]||e.push(d));f(e,"updated"),f(g,"deleted")}function f(a,b){if(a=[].concat(a||[]),"flushed"==b){a=[];for(var c in z)z.hasOwnProperty(c)&&a.push(c);b="deleted"}for(var d=0,e=a.length;e>d;d++){if(z[a[d]])for(var f=0,g=z[a[d]].length;g>f;f++)z[a[d]][f](a[d],b);if(z["*"])for(var f=0,g=z["*"].length;g>f;f++)z["*"][f](a[d],b)}}function g(){var a=(+new Date).toString();if("localStorage"==y||"globalStorage"==y)try{v.jStorage_update=a}catch(b){y=!1}else"userDataBehavior"==y&&(w.setAttribute("jStorage_update",a),w.save("jStorage"));d()}function h(){if(v.jStorage)try{u=s.parse(String(v.jStorage))}catch(a){v.jStorage="{}"}else v.jStorage="{}";x=v.jStorage?String(v.jStorage).length:0,u.__jstorage_meta||(u.__jstorage_meta={}),u.__jstorage_meta.CRC32||(u.__jstorage_meta.CRC32={})}function i(){n();try{v.jStorage=s.stringify(u),w&&(w.setAttribute("jStorage",v.jStorage),w.save("jStorage")),x=v.jStorage?String(v.jStorage).length:0}catch(a){}}function j(a){if("string"!=typeof a&&"number"!=typeof a)throw new TypeError("Key name must be string or numeric");if("__jstorage_meta"==a)throw new TypeError("Reserved key name");return!0}function k(){var a,b,c,d,e=1/0,h=!1,j=[];if(clearTimeout(t),u.__jstorage_meta&&"object"==typeof u.__jstorage_meta.TTL){a=+new Date,c=u.__jstorage_meta.TTL,d=u.__jstorage_meta.CRC32;for(b in c)c.hasOwnProperty(b)&&(c[b]<=a?(delete c[b],delete d[b],delete u[b],h=!0,j.push(b)):c[b]<e&&(e=c[b]));e!=1/0&&(t=setTimeout(k,e-a)),h&&(i(),g(),f(j,"deleted"))}}function l(){var a,b;if(u.__jstorage_meta.PubSub){var c,d=D;for(a=b=u.__jstorage_meta.PubSub.length-1;a>=0;a--)c=u.__jstorage_meta.PubSub[a],c[0]>D&&(d=c[0],m(c[1],c[2]));D=d}}function m(a,b){if(C[a])for(var c=0,d=C[a].length;d>c;c++)try{C[a][c](a,s.parse(s.stringify(b)))}catch(e){}}function n(){if(u.__jstorage_meta.PubSub){for(var a=+new Date-2e3,b=0,c=u.__jstorage_meta.PubSub.length;c>b;b++)if(u.__jstorage_meta.PubSub[b][0]<=a){u.__jstorage_meta.PubSub.splice(b,u.__jstorage_meta.PubSub.length-b);break}u.__jstorage_meta.PubSub.length||delete u.__jstorage_meta.PubSub}}function o(a,b){u.__jstorage_meta||(u.__jstorage_meta={}),u.__jstorage_meta.PubSub||(u.__jstorage_meta.PubSub=[]),u.__jstorage_meta.PubSub.unshift([+new Date,a,b]),i(),g()}function p(a,b){for(var c,d=a.length,e=b^d,f=0;d>=4;)c=255&a.charCodeAt(f)|(255&a.charCodeAt(++f))<<8|(255&a.charCodeAt(++f))<<16|(255&a.charCodeAt(++f))<<24,c=1540483477*(65535&c)+((1540483477*(c>>>16)&65535)<<16),c^=c>>>24,c=1540483477*(65535&c)+((1540483477*(c>>>16)&65535)<<16),e=1540483477*(65535&e)+((1540483477*(e>>>16)&65535)<<16)^c,d-=4,++f;switch(d){case 3:e^=(255&a.charCodeAt(f+2))<<16;case 2:e^=(255&a.charCodeAt(f+1))<<8;case 1:e^=255&a.charCodeAt(f),e=1540483477*(65535&e)+((1540483477*(e>>>16)&65535)<<16)}return e^=e>>>13,e=1540483477*(65535&e)+((1540483477*(e>>>16)&65535)<<16),e^=e>>>15,e>>>0}var q="0.4.8",r=window.jQuery||window.$||(window.$={}),s={parse:window.JSON&&(window.JSON.parse||window.JSON.decode)||String.prototype.evalJSON&&function(a){return String(a).evalJSON()}||r.parseJSON||r.evalJSON,stringify:Object.toJSON||window.JSON&&(window.JSON.stringify||window.JSON.encode)||r.toJSON};if(!("parse"in s&&"stringify"in s))throw new Error("No JSON support found, include //cdnjs.cloudflare.com/ajax/libs/json2/20110223/json2.js to page");
var t,u={__jstorage_meta:{CRC32:{}}},v={jStorage:"{}"},w=null,x=0,y=!1,z={},A=!1,B=0,C={},D=+new Date,E={isXML:function(a){var b=(a?a.ownerDocument||a:0).documentElement;return b?"HTML"!==b.nodeName:!1},encode:function(a){if(!this.isXML(a))return!1;try{return(new XMLSerializer).serializeToString(a)}catch(b){try{return a.xml}catch(c){}}return!1},decode:function(a){var b,c="DOMParser"in window&&(new DOMParser).parseFromString||window.ActiveXObject&&function(a){var b=new ActiveXObject("Microsoft.XMLDOM");return b.async="false",b.loadXML(a),b};return c?(b=c.call("DOMParser"in window&&new DOMParser||window,a,"text/xml"),this.isXML(b)?b:!1):!1}};r.jStorage={version:q,set:function(a,b,c){if(j(a),c=c||{},"undefined"==typeof b)return this.deleteKey(a),b;if(E.isXML(b))b={_is_xml:!0,xml:E.encode(b)};else{if("function"==typeof b)return;b&&"object"==typeof b&&(b=s.parse(s.stringify(b)))}return u[a]=b,u.__jstorage_meta.CRC32[a]="2."+p(s.stringify(b),2538058380),this.setTTL(a,c.TTL||0),f(a,"updated"),b},get:function(a,b){return j(a),a in u?u[a]&&"object"==typeof u[a]&&u[a]._is_xml?E.decode(u[a].xml):u[a]:"undefined"==typeof b?null:b},deleteKey:function(a){return j(a),a in u?(delete u[a],"object"==typeof u.__jstorage_meta.TTL&&a in u.__jstorage_meta.TTL&&delete u.__jstorage_meta.TTL[a],delete u.__jstorage_meta.CRC32[a],i(),g(),f(a,"deleted"),!0):!1},setTTL:function(a,b){var c=+new Date;return j(a),b=Number(b)||0,a in u?(u.__jstorage_meta.TTL||(u.__jstorage_meta.TTL={}),b>0?u.__jstorage_meta.TTL[a]=c+b:delete u.__jstorage_meta.TTL[a],i(),k(),g(),!0):!1},getTTL:function(a){var b,c=+new Date;return j(a),a in u&&u.__jstorage_meta.TTL&&u.__jstorage_meta.TTL[a]?(b=u.__jstorage_meta.TTL[a]-c,b||0):0},flush:function(){return u={__jstorage_meta:{CRC32:{}}},i(),g(),f(null,"flushed"),!0},storageObj:function(){function a(){}return a.prototype=u,new a},index:function(){var a,b=[];for(a in u)u.hasOwnProperty(a)&&"__jstorage_meta"!=a&&b.push(a);return b},storageSize:function(){return x},currentBackend:function(){return y},storageAvailable:function(){return!!y},listenKeyChange:function(a,b){j(a),z[a]||(z[a]=[]),z[a].push(b)},stopListening:function(a,b){if(j(a),z[a]){if(!b)return void delete z[a];for(var c=z[a].length-1;c>=0;c--)z[a][c]==b&&z[a].splice(c,1)}},subscribe:function(a,b){if(a=(a||"").toString(),!a)throw new TypeError("Channel not defined");C[a]||(C[a]=[]),C[a].push(b)},publish:function(a,b){if(a=(a||"").toString(),!a)throw new TypeError("Channel not defined");o(a,b)},reInit:function(){b()},noConflict:function(a){return delete window.$.jStorage,a&&(window.jStorage=this),this}},a()}(),define("jstorage",["jquery"],function(){}),define("modules/chat/data/offline",["require","exports","../config/config_ts","underscore","jstorage","backbone"],function(a,b,c){var d=c.config,e=a("underscore"),f=a("jquery"),g=function(){function a(a){this.retryInterval=null,this.remaining=null,this.delay=null,this.max_waiting_seconds=3600,this.state="",this.reset(),this.offline=a,a.on("down",e.bind(this.down,this)),a.on("up",e.bind(this.up,this)),a.on("server-up",e.bind(this.up,this)),a.on("server-down",e.bind(this.down,this)),a.on("confirmed-down",e.bind(this.nope,this))}return a.prototype.reset=function(){this.state&&this.state!=a.INACTIVE&&this.offline.trigger("reconnect:stopped"),this.state=a.INACTIVE,this.remaining=this.delay=3},a.prototype.next=function(){var a=Math.min(Math.ceil(1.5*this.delay),this.max_waiting_seconds);this.remaining=this.delay=a},a.prototype.tick=function(){this.state!==a.CONNECTING&&(this.remaining-=1,this.offline.trigger("reconnect:tick"),0===this.remaining&&this.tryNow())},a.prototype.tryNow=function(){this.state===a.WAITING&&(this.offline.trigger("reconnect:connecting"),this.state=a.CONNECTING,this.offline.check())},a.prototype.down=function(){this.reset(),this.state=a.WAITING,this.offline.trigger("reconnect:started"),this.retryInterval=setInterval(e.bind(this.tick,this),1e3)},a.prototype.up=function(){this.retryInterval&&(clearInterval(this.retryInterval),this.retryInterval=null),this.reset()},a.prototype.nope=function(){this.state===a.CONNECTING&&(this.offline.trigger("reconnect:failure"),this.state=a.WAITING,this.next())},a.INACTIVE="inactive",a.CONNECTING="connecting",a.WAITING="waiting",a}();b.Reconnect=g;var h=function(){function b(){if(this.offline_threshold=d.offline_threshold,this.state="",this.server_state="",this.options={},b.instance)throw new Error("Error: Instantiation failed: Use Offline.getInstance() instead of new.");e.extend(this,Backbone.Events),this.reconnect=new g(this),this.listenToNativeEvents(),this.current_offline_count=0,this.state=b.STATE_UP,b.instance=this,e.delay(e.bind(this.listenToAppEvents,this),10)}return b.getInstance=function(){return b.instance||(b.instance=new b),b.instance},b.prototype.listenToAppEvents=function(){var b=this,c=a("modules/mig33_app");c.vent.on(c.ApplicationEvents.CHAT_SESSION_CONNECTED,function(){b.markServerUp(),b.markUp()}),c.vent.on(c.ApplicationEvents.CHAT_SESSION_ERROR,function(){b.markServerDown(),b.markDown()})},b.prototype.listenToNativeEvents=function(){var a=this;f(window).on("online",function(){setTimeout(e.bind(a.check,a),100)}),f(window).on("offline",function(){a.markDown()})},b.prototype.check=function(){this.trigger("check-network")},b.prototype.markServerUp=function(){this.trigger("confirmed-up"),this.server_state!==b.STATE_UP&&(this.server_state=b.STATE_UP,this.trigger("server-up"))},b.prototype.markServerDown=function(){this.trigger("confirmed-down"),this.server_state!==b.STATE_DOWN&&(this.server_state=b.STATE_DOWN,this.trigger("server-down"))},b.prototype.markUp=function(){this.trigger("confirmed-up"),this.state!==b.STATE_UP&&(this.state=b.STATE_UP,this.trigger("up"))},b.prototype.markDown=function(){this.trigger("confirmed-down"),this.state!==b.STATE_DOWN&&(this.state=b.STATE_DOWN,this.trigger("down"))},b.prototype.interceptXHR=function(a){this.checkXHR(a)},b.prototype.triggerCheckSession=function(){this.state===b.STATE_UP&&this.server_state===b.STATE_UP||this.trigger("check-session")},b.prototype.checkXHR=function(a){var b=this,c=function(){a.status&&a.status<12e3?503===a.status||504===a.status?(b.markDown(),b.markServerDown()):(b.current_offline_count=0,b.triggerCheckSession()):(b.current_offline_count++,b.current_offline_count>=b.offline_threshold&&b.markDown())};if("undefined"==typeof a.onprogress){var d=a.onerror,e=(a.ontimeout,a.onload);a.onerror=function(){b.markDown(),d&&d.call(a,arguments)},a.ontimeout=function(){b.markDown(),d&&d.call(a,arguments)},a.onload=function(){c(),e&&e.call(a,arguments)}}else{var f=a.onreadystatechange;a.onreadystatechange=function(){4===a.readyState?c():0===a.readyState&&b.markDown(),f&&f.apply(a,arguments)}}},b.STATE_UP="up",b.STATE_DOWN="down",b}();b.Offline=h;var i='<div class="offline-ui"><div class="offline-ui-content"></div></div>',j='<a href class="offline-ui-retry"></a>',k=function(){function a(){this.flashTimeouts={},this.init()}return a.prototype.flashClass=function(a,b){var c=this;this.$el.addClass(a),this.flashTimeouts[a]&&(clearTimeout(this.flashTimeouts[a]),delete this.flashTimeouts[a]),this.flashTimeouts[a]=setTimeout(function(){c.$el.removeClass(a),delete c.flashTimeouts[a]},1e3*b)},a.prototype.roundTime=function(a){var b={day:86400,hour:3600,minute:60,second:1},c=null,d=null;for(c in b)if(d=b[c],a>=d)return[Math.floor(a/d)+"",c];return["now",""]},a.prototype.render=function(){var a=this;if(this.$el=f(i),this.offline.reconnect){this.$el.append(f(j));var b=f(".offline-ui-retry",this.$el),c=function(b){b.preventDefault(),a.offline.reconnect.tryNow()};b.on("click",c)}this.$el.addClass("offline-ui-"+this.offline.state),this.$content=this.$el.find(".offline-ui-content")},a.prototype.init=function(){var a=this;this.offline=h.getInstance(),this.render(),this.offline.on("up",function(){a.$el.removeClass("offline-ui-down"),a.$el.addClass("offline-ui-up"),a.flashClass("offline-ui-up-2s",2),a.flashClass("offline-ui-up-5s",5)}),this.offline.on("down",function(){a.$el.removeClass("offline-ui-up"),a.$el.addClass("offline-ui-down"),a.flashClass("offline-ui-down-2s",2),a.flashClass("offline-ui-down-5s",5)}),this.offline.on("reconnect:connecting",function(){a.$el.removeClass("offline-ui-waiting"),a.$el.addClass("offline-ui-connecting")}),this.offline.on("reconnect:tick",function(){a.$el.addClass("offline-ui-waiting"),a.$el.removeClass("offline-ui-connecting");var b=a.roundTime(a.offline.reconnect.remaining);a.$content.attr("data-retry-in-value",b[0]),a.$content.attr("data-retry-in-unit",b[1])}),this.offline.on("reconnect:stopped",function(){a.$el.removeClass("offline-ui-connecting offline-ui-waiting"),a.$content.attr("data-retry-in-value",null),a.$content.attr("data-retry-in-unit",null)}),this.offline.on("reconnect:failure",function(){a.flashClass("offline-ui-reconnect-failed-2s",2),a.flashClass("offline-ui-reconnect-failed-5s",5)}),this.offline.on("reconnect:success",function(){a.flashClass("offline-ui-reconnect-succeeded-2s",2),a.flashClass("offline-ui-reconnect-succeeded-5s",5)})},a.prototype.getElement=function(){return this.$el},a}();b.OfflineView=k}),!function(a,b){function c(a,b){var c,d,e=a.toLowerCase();for(b=[].concat(b),c=0;c<b.length;c+=1)if(d=b[c]){if(d.test&&d.test(a))return!0;if(d.toLowerCase()===e)return!0}}var d=b.prototype.trim,e=b.prototype.trimRight,f=b.prototype.trimLeft,g=function(a){return 1*a||0},h=function(a,b){if(1>b)return"";for(var c="";b>0;)1&b&&(c+=a),b>>=1,a+=a;return c},i=[].slice,j=function(a){return null==a?"\\s":a.source?a.source:"["+o.escapeRegExp(a)+"]"},k={lt:"<",gt:">",quot:'"',amp:"&",apos:"'"},l={};for(var m in k)l[k[m]]=m;l["'"]="#39";var n=function(){function a(a){return Object.prototype.toString.call(a).slice(8,-1).toLowerCase()}var c=h,d=function(){return d.cache.hasOwnProperty(arguments[0])||(d.cache[arguments[0]]=d.parse(arguments[0])),d.format.call(null,d.cache[arguments[0]],arguments)};return d.format=function(d,e){var f,g,h,i,j,k,l,m=1,o=d.length,p="",q=[];for(g=0;o>g;g++)if(p=a(d[g]),"string"===p)q.push(d[g]);else if("array"===p){if(i=d[g],i[2])for(f=e[m],h=0;h<i[2].length;h++){if(!f.hasOwnProperty(i[2][h]))throw new Error(n('[_.sprintf] property "%s" does not exist',i[2][h]));f=f[i[2][h]]}else f=i[1]?e[i[1]]:e[m++];if(/[^s]/.test(i[8])&&"number"!=a(f))throw new Error(n("[_.sprintf] expecting number but found %s",a(f)));switch(i[8]){case"b":f=f.toString(2);break;case"c":f=b.fromCharCode(f);break;case"d":f=parseInt(f,10);break;case"e":f=i[7]?f.toExponential(i[7]):f.toExponential();break;case"f":f=i[7]?parseFloat(f).toFixed(i[7]):parseFloat(f);break;case"o":f=f.toString(8);break;case"s":f=(f=b(f))&&i[7]?f.substring(0,i[7]):f;break;case"u":f=Math.abs(f);break;case"x":f=f.toString(16);break;case"X":f=f.toString(16).toUpperCase()}f=/[def]/.test(i[8])&&i[3]&&f>=0?"+"+f:f,k=i[4]?"0"==i[4]?"0":i[4].charAt(1):" ",l=i[6]-b(f).length,j=i[6]?c(k,l):"",q.push(i[5]?f+j:j+f)}return q.join("")},d.cache={},d.parse=function(a){for(var b=a,c=[],d=[],e=0;b;){if(null!==(c=/^[^\x25]+/.exec(b)))d.push(c[0]);else if(null!==(c=/^\x25{2}/.exec(b)))d.push("%");else{if(null===(c=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(b)))throw new Error("[_.sprintf] huh?");if(c[2]){e|=1;var f=[],g=c[2],h=[];if(null===(h=/^([a-z_][a-z_\d]*)/i.exec(g)))throw new Error("[_.sprintf] huh?");for(f.push(h[1]);""!==(g=g.substring(h[0].length));)if(null!==(h=/^\.([a-z_][a-z_\d]*)/i.exec(g)))f.push(h[1]);else{if(null===(h=/^\[(\d+)\]/.exec(g)))throw new Error("[_.sprintf] huh?");f.push(h[1])}c[2]=f}else e|=2;if(3===e)throw new Error("[_.sprintf] mixing positional and named placeholders is not (yet) supported");d.push(c)}b=b.substring(c[0].length)}return d},d}(),o={VERSION:"2.3.0",isBlank:function(a){return null==a&&(a=""),/^\s*$/.test(a)},stripTags:function(a){return null==a?"":b(a).replace(/<\/?[^>]+>/g,"")},capitalize:function(a){return a=null==a?"":b(a),a.charAt(0).toUpperCase()+a.slice(1)},chop:function(a,c){return null==a?[]:(a=b(a),c=~~c,c>0?a.match(new RegExp(".{1,"+c+"}","g")):[a])},clean:function(a){return o.strip(a).replace(/\s+/g," ")},count:function(a,c){if(null==a||null==c)return 0;a=b(a),c=b(c);for(var d=0,e=0,f=c.length;;){if(e=a.indexOf(c,e),-1===e)break;d++,e+=f}return d},chars:function(a){return null==a?[]:b(a).split("")},swapCase:function(a){return null==a?"":b(a).replace(/\S/g,function(a){return a===a.toUpperCase()?a.toLowerCase():a.toUpperCase()})},escapeHTML:function(a){return null==a?"":b(a).replace(/[&<>"']/g,function(a){return"&"+l[a]+";"})},unescapeHTML:function(a){return null==a?"":b(a).replace(/\&([^;]+);/g,function(a,c){var d;return c in k?k[c]:(d=c.match(/^#x([\da-fA-F]+)$/))?b.fromCharCode(parseInt(d[1],16)):(d=c.match(/^#(\d+)$/))?b.fromCharCode(~~d[1]):a})},escapeRegExp:function(a){return null==a?"":b(a).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")},splice:function(a,b,c,d){var e=o.chars(a);return e.splice(~~b,~~c,d),e.join("")},insert:function(a,b,c){return o.splice(a,b,0,c)},include:function(a,c){return""===c?!0:null==a?!1:-1!==b(a).indexOf(c)},join:function(){var a=i.call(arguments),b=a.shift();return null==b&&(b=""),a.join(b)},lines:function(a){return null==a?[]:b(a).split("\n")},reverse:function(a){return o.chars(a).reverse().join("")},startsWith:function(a,c){return""===c?!0:null==a||null==c?!1:(a=b(a),c=b(c),a.length>=c.length&&a.slice(0,c.length)===c)},endsWith:function(a,c){return""===c?!0:null==a||null==c?!1:(a=b(a),c=b(c),a.length>=c.length&&a.slice(a.length-c.length)===c)},succ:function(a){return null==a?"":(a=b(a),a.slice(0,-1)+b.fromCharCode(a.charCodeAt(a.length-1)+1))},titleize:function(a){return null==a?"":(a=b(a).toLowerCase(),a.replace(/(?:^|\s|-)\S/g,function(a){return a.toUpperCase()}))},camelize:function(a){return o.trim(a).replace(/[-_\s]+(.)?/g,function(a,b){return b?b.toUpperCase():""})},underscored:function(a){return o.trim(a).replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/[-\s]+/g,"_").toLowerCase()},dasherize:function(a){return o.trim(a).replace(/([A-Z])/g,"-$1").replace(/[-_\s]+/g,"-").toLowerCase()},classify:function(a){return o.titleize(b(a).replace(/[\W_]/g," ")).replace(/\s/g,"")},humanize:function(a){return o.capitalize(o.underscored(a).replace(/_id$/,"").replace(/_/g," "))},trim:function(a,c){return null==a?"":!c&&d?d.call(a):(c=j(c),b(a).replace(new RegExp("^"+c+"+|"+c+"+$","g"),""))},ltrim:function(a,c){return null==a?"":!c&&f?f.call(a):(c=j(c),b(a).replace(new RegExp("^"+c+"+"),""))},rtrim:function(a,c){return null==a?"":!c&&e?e.call(a):(c=j(c),b(a).replace(new RegExp(c+"+$"),""))},truncate:function(a,c,d){return null==a?"":(a=b(a),d=d||"...",c=~~c,a.length>c?a.slice(0,c)+d:a)},prune:function(a,c,d){if(null==a)return"";if(a=b(a),c=~~c,d=null!=d?b(d):"...",a.length<=c)return a;var e=function(a){return a.toUpperCase()!==a.toLowerCase()?"A":" "},f=a.slice(0,c+1).replace(/.(?=\W*\w*$)/g,e);return f=f.slice(f.length-2).match(/\w\w/)?f.replace(/\s*\S+$/,""):o.rtrim(f.slice(0,f.length-1)),(f+d).length>a.length?a:a.slice(0,f.length)+d},words:function(a,b){return o.isBlank(a)?[]:o.trim(a,b).split(b||/\s+/)},pad:function(a,c,d,e){a=null==a?"":b(a),c=~~c;var f=0;switch(d?d.length>1&&(d=d.charAt(0)):d=" ",e){case"right":return f=c-a.length,a+h(d,f);case"both":return f=c-a.length,h(d,Math.ceil(f/2))+a+h(d,Math.floor(f/2));default:return f=c-a.length,h(d,f)+a}},lpad:function(a,b,c){return o.pad(a,b,c)},rpad:function(a,b,c){return o.pad(a,b,c,"right")},lrpad:function(a,b,c){return o.pad(a,b,c,"both")},sprintf:n,vsprintf:function(a,b){return b.unshift(a),n.apply(null,b)},toNumber:function(a,b){return a?(a=o.trim(a),a.match(/^-?\d+(?:\.\d+)?$/)?g(g(a).toFixed(~~b)):NaN):0},numberFormat:function(a,b,c,d){if(isNaN(a)||null==a)return"";a=a.toFixed(~~b),d="string"==typeof d?d:",";var e=a.split("."),f=e[0],g=e[1]?(c||".")+e[1]:"";return f.replace(/(\d)(?=(?:\d{3})+$)/g,"$1"+d)+g},strRight:function(a,c){if(null==a)return"";a=b(a),c=null!=c?b(c):c;var d=c?a.indexOf(c):-1;return~d?a.slice(d+c.length,a.length):a},strRightBack:function(a,c){if(null==a)return"";a=b(a),c=null!=c?b(c):c;var d=c?a.lastIndexOf(c):-1;return~d?a.slice(d+c.length,a.length):a},strLeft:function(a,c){if(null==a)return"";a=b(a),c=null!=c?b(c):c;var d=c?a.indexOf(c):-1;return~d?a.slice(0,d):a},strLeftBack:function(a,b){if(null==a)return"";a+="",b=null!=b?""+b:b;var c=a.lastIndexOf(b);return~c?a.slice(0,c):a},toSentence:function(a,b,c,d){b=b||", ",c=c||" and ";var e=a.slice(),f=e.pop();return a.length>2&&d&&(c=o.rtrim(b)+c),e.length?e.join(b)+c+f:f},toSentenceSerial:function(){var a=i.call(arguments);return a[3]=!0,o.toSentence.apply(o,a)},slugify:function(a){if(null==a)return"";var c="ąàáäâãåæăćęèéëêìíïîłńòóöôõøśșțùúüûñçżź",d="aaaaaaaaaceeeeeiiiilnoooooosstuuuunczz",e=new RegExp(j(c),"g");return a=b(a).toLowerCase().replace(e,function(a){var b=c.indexOf(a);return d.charAt(b)||"-"}),o.dasherize(a.replace(/[^\w\s-]/g,""))},surround:function(a,b){return[b,a,b].join("")},quote:function(a,b){return o.surround(a,b||'"')},unquote:function(a,b){return b=b||'"',a[0]===b&&a[a.length-1]===b?a.slice(1,a.length-1):a},exports:function(){var a={};for(var b in this)this.hasOwnProperty(b)&&!b.match(/^(?:include|contains|reverse)$/)&&(a[b]=this[b]);return a},repeat:function(a,c,d){if(null==a)return"";if(c=~~c,null==d)return h(b(a),c);for(var e=[];c>0;e[--c]=a);return e.join(d)},naturalCmp:function(a,c){if(a==c)return 0;if(!a)return-1;if(!c)return 1;for(var d=/(\.\d+)|(\d+)|(\D+)/g,e=b(a).toLowerCase().match(d),f=b(c).toLowerCase().match(d),g=Math.min(e.length,f.length),h=0;g>h;h++){var i=e[h],j=f[h];if(i!==j){var k=parseInt(i,10);if(!isNaN(k)){var l=parseInt(j,10);if(!isNaN(l)&&k-l)return k-l}return j>i?-1:1}}return e.length===f.length?e.length-f.length:c>a?-1:1},levenshtein:function(a,c){if(null==a&&null==c)return 0;if(null==a)return b(c).length;if(null==c)return b(a).length;a=b(a),c=b(c);for(var d,e,f=[],g=0;g<=c.length;g++)for(var h=0;h<=a.length;h++)e=g&&h?a.charAt(h-1)===c.charAt(g-1)?d:Math.min(f[h],f[h-1],d)+1:g+h,d=f[h],f[h]=e;return f.pop()},toBoolean:function(a,b,d){return"number"==typeof a&&(a=""+a),"string"!=typeof a?!!a:(a=o.trim(a),c(a,b||["true","1"])?!0:c(a,d||["false","0"])?!1:void 0)}};o.strip=o.trim,o.lstrip=o.ltrim,o.rstrip=o.rtrim,o.center=o.lrpad,o.rjust=o.lpad,o.ljust=o.rpad,o.contains=o.include,o.q=o.quote,o.toBool=o.toBoolean,"undefined"!=typeof exports&&("undefined"!=typeof module&&module.exports&&(module.exports=o),exports._s=o),"function"==typeof define&&define.amd&&define("underscore.string",[],function(){return o}),a._=a._||{},a._.string=a._.str=o}(this,String),define("modules/chat/data/ftransport",["require","exports","../config/config_ts","./ftransport_queue","./fthread_manager","./fthread_worker","../fusion/fpacket","./offline","../../common/event_logger","underscore","jstorage","modules/common/local_storage","backbone","underscore.string"],function(a,b,c,d,e,f,g,h,i){var j,k=a("underscore.string"),l=i.Logger.getInstance(),m=(a("modules/common/local_storage"),a("underscore"));!function(a){a[a.WS=1]="WS",a[a.AJAX=2]="AJAX"}(j||(j={}));var n=c.config,o="packet_data",p=function(){function a(){if(this.timeout=2e4,this.max_retry_count=3,this.server=n.migcore_url+n.gateway_path,this.transport_mode=n.transport_mode&&"WS"===n.transport_mode?1:2,m.extend(this,Backbone.Events),a._instance)throw new Error("Error: Instantiation failed: Use Transport.getInstance() instead of new.");a._instance=this}return a.prototype.initialize=function(){if(l.log("Trying to create transport with the give mode - "+n.transport_mode),!m.isUndefined(window.WebSocket)&&WebSocket.OPEN||(l.log("Browser doesn't support WebSocket"),this.transport_mode=2),1===this.transport_mode){this.server=n.gateway_url;try{this.websocket=this.build_websocket_connection(this.server)}catch(a){l.log("we errored out",{error:a.toString()},a),this.transport_mode=2}}2===this.transport_mode&&(this.server=n.migcore_url+n.gateway_path),this._transport_id=Date.now(),this.allowed_packet_types=null,this.queue=this.build_transport_queue(),this.is_connection_error=!1,this.is_ajax_call_in_progress=!1,this.thread_manager=new e.ThreadManager,this.create_connection_shim(),this.initialize_offline_listener()},a.prototype.initialize_offline_listener=function(){var a=this,b=h.Offline.getInstance();b.on("up",function(){a.connection_success()}),b.on("down",function(){a.connection_error()}),b.on("check-network",function(){a.send_packet(null)})},a.prototype.connection_success=function(){this.allowed_packet_types=null,this.is_connection_error=!1,l.log("Setting connection error state to false")},a.prototype.connection_error=function(){this.is_connection_error=!0,this.allowed_packet_types=[211]},a.prototype.build_transport_queue=function(){var a=new d.TransportQueue(this);return a},a.prototype.build_websocket_connection=function(a){var b=this;if(!WebSocket||!WebSocket.OPEN)throw"Browser does not support websocket";l.log("Creating websocket connection to - "+a);var c=new WebSocket(a);return c.onopen=function(){l.log("We connected to the server!"),b.queue.check_queue()},c.onmessage=function(a){l.log("Got response from server [ws] - "+a.data,{},a);var c=b.convert_to_valid_server_response(a.data);c=JSON.parse(c),b.broadcast_response(c)},c.onclose=function(a){l.log("Got closed for some reason",{},arguments)},c},a.prototype.convert_to_valid_server_response=function(a){if(!m.isString(a)||0===a.indexOf("[")||0!==a.indexOf("{"))throw"invalid response error";return"["+a+"]"},a.prototype.create_connection_shim=function(){var a=this;$.jStorage.subscribe(o,function(b,c){a.process_packet_data(c)})},a.prototype.process_packet_data=function(a){if(null!==a&&a.length>0){for(var b=0;b<a.length;++b){var c=f.ThreadWorker.createThreadWorker(a[b]);this.thread_manager.queue_worker(c,!1)}this.thread_manager.start()}},a.prototype.broadcast_response=function(a){return a&&a.length&&m.isArray(a)?void $.jStorage.publish(o,a):void l.log("Empty or invalid response not being broadcasted")},a.prototype.websocket_send=function(a){return this.websocket&&this.websocket.readyState!==WebSocket.CLOSING&&this.websocket.readyState!==WebSocket.CLOSED||(l.log(Date.now()+":web socket was closed, or never created"),this.websocket=this.build_websocket_connection(this.server)),this.websocket.readyState===WebSocket.CONNECTING?(l.log(Date.now()+":web socket is connecting now... Packet should be queued for later user"),!1):(l.log(Date.now()+":Sending data in websocket - "+a),this.websocket.send(a),!0)},a.prototype.make_ajax_call=function(a,b){var c=Date.now(),d=$.ajax(this.server+"?"+c,{type:"POST",data:a,xhr:function(){var a=jQuery.ajaxSettings.xhr();return a instanceof XMLHttpRequest&&h.Offline.getInstance().interceptXHR(a),a},beforeSend:function(a){a.setRequestHeader("Content-Type","application/json"),a.setRequestHeader("X-Mig33-JSON-Version","2"),$("#loading").hide()},timeout:b});return this.is_ajax_call_in_progress=!0,d},a.prototype.is_allowed_packet=function(a){return null===a?!0:!(this.allowed_packet_types&&this.allowed_packet_types.length>0)||m.contains(this.allowed_packet_types,a.type)},a.prototype.send_packets=function(a){var b,c,d,e,f,g=this;return 1!==this.transport_mode&&n.packet_array_server_support?(c=m.filter(a,function(a){return a&&g.is_allowed_packet(a)},this),0===c.length&&l.log("Packets blocked and not sent to the server"),b=m.map(c,function(a){return a.to_packet_json()}),d=this.timeout,e=JSON.stringify(b),l.log("Sending request with data[] - "+e),f=this.make_ajax_call(e,d),f.success(function(a){g.is_ajax_call_in_progress=!1,g.queue.check_queue(),m.each(c,function(a){g.process_packet_send_success(a)});var b=JSON.stringify(a);l.log("Got response from server [array] - "+k.truncate(b,300),{},b),g.broadcast_response(a)}),f.fail(function(a,b,d){g.is_ajax_call_in_progress=!1,l.log("failed to send packets [array] - "+e),m.each(c,function(c){g.process_packet_failure(c,a,b,d)})}),void f.always(function(a,b,c){})):void m.each(a,function(a){g.send_packet(a)})},a.prototype.send_packet=function(a){var b,c,d=this,e=null;if(null!==a&&!g.isPacket(a))throw"Send packet failed invalid packet";if(!this.is_allowed_packet(a))return l.log("Blocked packet that are not allowed. Packet Type - "+(a?a.type:null)+"; Allowed packets - "+this.allowed_packet_types),this.process_packet_failure(a,{},status,"packet blocked"),null;if(b=this.timeout,null!==a&&(b=a.timeout,c=a.transaction_id,e=JSON.stringify(a.to_packet_json())),2===this.transport_mode){if(this.is_ajax_call_in_progress===!0)return null===a?(l.log("Skipping poll (call in progress)"),0):(this.queue.add_packet(a),c);l.log("Sending request with data - "+e);var f=this.make_ajax_call(e,b);a&&a.fire_send_event();Date.now();f.done(m.once(function(b){d.is_ajax_call_in_progress=!1,d.queue.check_queue(),d.process_packet_send_success(a);var c=JSON.stringify(b);l.log("Got response from server - "+k.truncate(c,300),{},c),d.broadcast_response(b)})),f.fail(function(b,c,e){d.is_ajax_call_in_progress=!1,d.process_packet_failure(a,b,c,e)}),f.always(function(a,b,c){})}else if(a){var h=this.websocket_send(e);h?(a.fire_send_event(),this.process_packet_send_success(a),l.log(Date.now()+":Successfully sent packet to gateway. Fusion packet is "+e),this.queue.check_queue()):(this.queue.add_packet(a),l.log(Date.now()+":Failed to send packet to gateway. Fusion packet is "+e))}return c},a.prototype.process_packet_send_success=function(a){if(a){a.fire_send_success_event();var b=this.queue.remove_packet(a);b&&l.error("Unexpected packet in queue")}},a.prototype.process_packet_failure=function(a,b,c,d){l.log("failed to send packets - "+a),a&&(a.fire_send_failed_event(),this.queue.add_packet(a))},a.getInstance=function(){return a._instance||(a._instance=new a),a._instance},a}();b.Transport=p});var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};define("modules/chat/models/model",["require","exports","../data/ftransport","../fusion/fpacket","underscore","jquery","backbone"],function(a,b,c,d){var e=c.Transport.getInstance(),f=a("underscore"),g=function(a){function b(b){a.call(this,b)}return __extends(b,a),b.prototype.registerPacketHandler=function(a){d.add_packet_listener(a)},b.prototype.random=function(a){return(f.isUndefined(a)||f.isNaN(a)||null===a)&&(a=1e3),Math.floor(Math.random()*a+1)},b.prototype.send_packet=function(a){return e.send_packet(a)},b.prototype.on_packet_created=function(a){},b.prototype.on_packet_sent=function(a){},b.prototype.on_packet_received=function(a){},b.prototype.on_packet_error=function(a){},b.prototype.on_packet_ok=function(a){},b.prototype.on_packet_response=function(a){},b}(Backbone.Model);b.MigModel=g}),define("modules/chat/models/packet_handler",["require","exports","../fusion/fpacket_defs","../config/config_ts","underscore","modules/common/config","modules/common/utility"],function(a,b,c,d){var e=(a("underscore"),a("modules/common/config"),a("modules/common/utility"),d.config,function(){function a(){this.packet_type=c.FUSION_PACKET_TYPES.OK}return a.prototype.received_fn=function(a){},a.prototype.error_fn=function(a){},a.prototype.create_fn=function(a){},a.prototype.sent_fn=function(a){},a.prototype.sent_success_fn=function(a){},a.prototype.send_failed_fn=function(a){},a.prototype.ok_fn=function(a){},a.prototype.response_fn=function(a){},a}());b.PacketHandlerBase=e});var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};define("modules/chat/models/session_packet_handler",["require","exports","../fusion/fpacket","../fusion/fpacket_defs","../config/config_ts","./packet_handler","underscore","modules/common/config","modules/common/utility"],function(a,b,c,d,e,f){var g=a("underscore"),h=a("modules/common/config"),i=a("modules/common/utility"),j=e.config,k=!1,l=function(a){function b(b){a.call(this),this.packet_type=d.FUSION_PACKET_TYPES.IM_AVAILABLE,this.listener_obj=b}return __extends(b,a),b.prototype.received_fn=function(a){var b=a.toObject();1===parseInt(b.imdetail,10),parseInt(b.imtype,10),parseInt(b.messagetype,10),1===parseInt(b.supportsgroupchat,10),b.name},b}(f.PacketHandlerBase);b.IMAvailablePacketHander=l;var m=function(a){function b(b){a.call(this),this.packet_type=d.FUSION_PACKET_TYPES.STICKER_PACK_LIST,this.listener_obj=b}return __extends(b,a),b.prototype.received_fn=function(a){var b=a.toObject(),e=b.stickerpackids,f=c.create_packet(d.FUSION_PACKET_TYPES.GET_STICKER_PACK);f.add_field("packids",e),this.listener_obj.send_packet(f)},b}(f.PacketHandlerBase);b.StickerPackListHandler=m;var n=function(b){function c(a){b.call(this),this.packet_type=d.FUSION_PACKET_TYPES.SERVER_QUESTION,this.listener_obj=a}return __extends(c,b),c.prototype.received_fn=function(b){if(!k){k=!0;var c=b.toObject();if(c.question){var d=a("modules/mig33_app"),e=[{type:h.notification_destinations.MARKETING_TYPE,count:1,alerts:[{message:c.question,timestamp:Date.now(),id:Date.now(),url:c.url,title:c.title,questionType:c.questiontype,type:"MARKETING_MESSAGE_ALERT"}]}];d.vent.trigger(d.ApplicationEvents.NEW_NOTIFICATIONS,e),i.send_event_to_ga("migAlerts","MARKETING_MESSAGE_ALERT",c.question)}}},c}(f.PacketHandlerBase);b.ServerQuestionHandler=n;var o=function(a){function b(b){a.call(this),this.packet_type=d.FUSION_PACKET_TYPES.EMOTICON,this.listener_obj=b}return __extends(b,a),b.prototype.received_fn=function(a){var b=a.toObject();g.isUndefined(b.packid)||g.isNull(b.packid)||this.listener_obj.add_sticker(parseInt(b.packid,10),b.hotkey,b)},b}(f.PacketHandlerBase);b.EmoticonHandler=o;var p=function(a){function b(b){a.call(this),this.packet_type=d.FUSION_PACKET_TYPES.STICKER_PACK,this.listener_obj=b}return __extends(b,a),b.prototype.received_fn=function(a){var b=a.toObject();this.listener_obj.add_sticker_pack(b)},b}(f.PacketHandlerBase);b.StickerPackHandler=p;var q=function(a){function b(b){a.call(this),this.packet_type=d.FUSION_PACKET_TYPES.ERROR,this.listener_obj=b}return __extends(b,a),b.prototype.received_fn=function(a){if(!a.parent_packet||500!=a.parent_packet.type){var b=a.get_error_message();g.isEmpty(b)||(this.listener_obj.get("session_state")==j.Application_State.logging_in?this.listener_obj.prompt_session_disconnect():this.listener_obj.trigger("error",b),i.show_error(b))}},b}(f.PacketHandlerBase);b.ErrorHandler=q;var r=function(a){function b(b){a.call(this),this.packet_type=d.FUSION_PACKET_TYPES.ALERT,this.listener_obj=b}return __extends(b,a),b.prototype.received_fn=function(a){var b=a.toObject();b.content&&i.show_info(b.content)},b}(f.PacketHandlerBase);b.AlertHandler=r;var s=function(a){function b(b){a.call(this),this.packet_type=d.FUSION_PACKET_TYPES.GET_CHATROOM_CATEGORIES_COMPLETE,this.listener_obj=b}return __extends(b,a),b.prototype.received_fn=function(a){},b}(f.PacketHandlerBase);b.ChatRoomCategoryHandler=s;var t=function(a){function b(b){a.call(this),this.packet_type=d.FUSION_PACKET_TYPES.IM_SESSION_STATUS,this.listener_obj=b}return __extends(b,a),b.prototype.received_fn=function(a){var b=a.toObject(),c=parseInt(b.imtype,10),d=b.reason,e=b.status,f="";switch(c){case j.IM_Type.msn:f="msn";break;case j.IM_Type.yahoo:f="yahoo";break;case j.IM_Type.gtalk:f="gtalk";break;case j.IM_Type.facebook:f="facebook"}this.listener_obj.set_IM_status(f,c,"1"==e,d)},b}(f.PacketHandlerBase);b.IMSessionStatus=t;var u=function(a){function b(b){a.call(this),this.packet_type=d.FUSION_PACKET_TYPES.SET_STATUS_MESSAGE,this.listener_obj=b}return __extends(b,a),b.prototype.error_fn=function(a){console.log("Unable to set the status message")},b}(f.PacketHandlerBase);b.StatusMessageHandler=u;var v=function(a){function b(b){a.call(this),this.packet_type=d.FUSION_PACKET_TYPES.LOGOUT,this.listener_obj=b}return __extends(b,a),b.prototype.received_fn=function(a){this.listener_obj.clear_session_and_navigateaway(!0)},b}(f.PacketHandlerBase);b.LogoutHandler=v;var w=function(a){function b(b){a.call(this),this.packet_type=d.FUSION_PACKET_TYPES.LOGIN_OK,
this.listener_obj=b}return __extends(b,a),b.prototype.received_fn=function(a){var b=a.toObject(),c=b.msndetail,d=b.yahoodetail,e=b.gtalkdetail,f=b.facebookdetail,g=b.mailurl&&b.mailurl.length>0,h=parseInt(b.servertime,10)||Date.now(),i=Date.now()-h;this.listener_obj.initialize_local_session({msn_signed_in:2==c,yahoo_signed_in:2==d,gtalk_signed_in:2==e,facebook_signed_in:2==f,msn_setup:c>=1,yahoo_setup:d>=1,gtalk_setup:e>=1,facebook_setup:f>=1,new_email:b.mailcount,contact_list_version:b.contactlistversion,chat_list_version:0,allow_email:g,supports_stickers:parseInt(b.supportsstickers,10),login_message:b.alert,login_mtype:b.alertcontenttype,session_user_level:b.reputationlevel,session_user_level_image:b.reputationimagepath,session_user_type:b.usertype,session_state:j.Application_State.logged_in,server_time_delta:i})},b}(f.PacketHandlerBase);b.LoginOkHandler=w;var x=function(a){function b(b){a.call(this),this.packet_type=d.FUSION_PACKET_TYPES.EMOTICON_HOTKEYS,this.listener_obj=b}return __extends(b,a),b.prototype.received_fn=function(a){var b=a.toObject(),c=b.hotkeys+" "+b.alternatekeys;this.listener_obj.add_emoticon_hotkeys(b.hotkeys.split(" "),b.alternatekeys.split(" "),c.split(" "))},b}(f.PacketHandlerBase);b.EmoticonHotkeyHandler=x;var y=function(b){function c(a){b.call(this),this.packet_type=d.FUSION_PACKET_TYPES.ACCOUNT_BALANCE,this.listener_obj=a}return __extends(c,b),c.prototype.received_fn=function(b){var c=b.toObject(),d=c.accountbalance;this.listener_obj.get("currency_symbol");this.listener_obj.set({account_balance:parseFloat(d.replace(/[^0-9\.]+/g,""))}),this.listener_obj.trigger("balance_updated");var e=a("modules/mig33_app");e.vent.trigger(e.ApplicationEvents.ACCOUNT_BALANCE,d)},c}(f.PacketHandlerBase);b.AccountBalanceHandler=y;var z=function(a){function b(b){a.call(this),this.packet_type=d.FUSION_PACKET_TYPES.AVATAR,this.listener_obj=b}return __extends(b,a),b.prototype.received_fn=function(a){var b=a.toObject(),c=b.statusmessage;this.listener_obj.set_status_message(c)},b}(f.PacketHandlerBase);b.AvatarHandler=z});var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};define("modules/chat/models/contact_packet_handler",["require","exports","../fusion/fpacket_defs","../config/config_ts","./packet_handler","underscore","modules/common/config","modules/common/utility"],function(a,b,c,d,e){var f=(a("underscore"),a("modules/common/config"),a("modules/common/utility"),d.config),g=function(a){function b(b){a.call(this),this.packet_type=c.FUSION_PACKET_TYPES.GROUP,this.listener_obj=b}return __extends(b,a),b.prototype.received_fn=function(a){var b=a.toObject(),c=parseInt(b.groupid,10),e=b.groupname,g=d.config.IM_Group[c];f.getDisableIMType(g)||this.listener_obj.add_contact_group(c,e,a)},b}(e.PacketHandlerBase);b.ContactGroupHandler=g;var h=function(a){function b(b){a.call(this),this.packet_type=c.FUSION_PACKET_TYPES.REMOVE_CONTACT,this.listener_obj=b}return __extends(b,a),b.prototype.received_fn=function(a){var b=a.toObject(),c=parseInt(b.contactid,10);this.listener_obj.remove_contact(c)},b}(e.PacketHandlerBase);b.RemoveContactHandler=h;var i=function(a){function b(b){a.call(this),this.packet_type=c.FUSION_PACKET_TYPES.REMOVE_GROUP,this.listener_obj=b}return __extends(b,a),b.prototype.received_fn=function(a){var b=a.toObject(),c=parseInt(b.groupid,10);this.listener_obj.remove_contact_group(c)},b}(e.PacketHandlerBase);b.RemoveGroupHandler=i;var j=function(a){function b(b){a.call(this),this.packet_type=c.FUSION_PACKET_TYPES.CONTACT,this.listener_obj=b}return __extends(b,a),b.prototype.received_fn=function(a){var b=this.parseContact(a);this.listener_obj.add_contact(b,a)},b.prototype.parseContact=function(a){var b=a.toObject();return{contactId:parseInt(b.contactid,10),groupId:parseInt(b.groupid,10),groupName:"",displayName:b.displayname,mobilePhone:b.mobilephone,fusionUsername:b.fusionusername,msnUsername:b.msnusername,yahooUsername:b.yahoousername,gtalkUsername:b.gtalkusername,displayPicture:b.displaypicture,facebookUsername:b.facebookusername,fusionPresence:parseInt(b.fusionpresence,10),msnPresence:parseInt(b.msnpresence,10),yahooPresence:parseInt(b.yahoopresence,10),gtalkPresence:parseInt(b.gtalkpresence,10),facebookPresence:parseInt(b.facebookpresence,10),statusMessage:b.statusmessage}},b}(e.PacketHandlerBase);b.ContactHandler=j;var k=function(b){function d(a){b.call(this),this.packet_type=c.FUSION_PACKET_TYPES.CONTACT_LIST_VERSION,this.listener_obj=a}return __extends(d,b),d.prototype.received_fn=function(b){var c=b.toObject(),d=c.contactlistversion,e=a("modules/chat/models/user_session"),f=e.Session.getInstance();f.set_user_data("contact_list_version",d)},d}(e.PacketHandlerBase);b.ContactListVersionHandler=k;var l=function(a){function b(b){a.call(this),this.packet_type=c.FUSION_PACKET_TYPES.PRESENCE,this.listener_obj=b}return __extends(b,a),b.prototype.received_fn=function(a){var b=a.toObject(),c=parseInt(b.contactid,10),d=parseInt(b.fusionpresence,10),e=parseInt(b.msnpresence,10),f=parseInt(b.aimpresence,10),g=parseInt(b.yahoopresence,10),h=parseInt(b.gtalkpresence,10),i=parseInt(b.facebookpresence,10);this.listener_obj.set_presence(c,{fusionPresence:d,msnPresence:e,aimPresence:f,yahooPresence:g,gtalkPresence:h,facebookPresence:i})},b}(e.PacketHandlerBase);b.PresenceHandler=l;var m=function(a){function b(b){a.call(this),this.packet_type=c.FUSION_PACKET_TYPES.STATUS_MESSAGE,this.listener_obj=b}return __extends(b,a),b.prototype.received_fn=function(a){var b=a.toObject(),c=parseInt(b.contactid,10),d=b.statusmessage;this.listener_obj.set_status_message(c,d)},b}(e.PacketHandlerBase);b.StatusMessageHandler=m;var n=function(a){function b(b){a.call(this),this.packet_type=c.FUSION_PACKET_TYPES.GET_CONTACTS_COMPLETE,this.listener_obj=b}return __extends(b,a),b.prototype.received_fn=function(a){this.listener_obj.contact_load_complete()},b}(e.PacketHandlerBase);b.ContactCompleteHandler=n}),define("modules/export_marionette",["backbone","backbone.marionette"],function(a,b){window.Marionette=a.Marionette}),define("modules/chat/views/content_window_helper",["underscore.string","modules/common/utility","underscore","jquery","qtip"],function(a,b,c){var d=function(){var a=this;this.tearaway_window_refs={},this.current_window=null,window.mig33||(window.mig33={}),window.closeWindow=function(b){a.close_window(b)},window.mig33.close_window=function(b){a.close_window(b)},this.$window_parent=$("<div></div>"),this.modal_window_id=c.uniqueId("modal-"),this.$window_parent.qtip({id:this.modal_window_id,content:{text:"",title:{text:"title",button:!0}},position:{my:"center",at:"center",target:$(window)},show:{effect:!1,event:"click",solo:!0,modal:!0},hide:{effect:!1,event:"",leave:!1},style:"qtip-shadow qtip-bootstrap qtip-migme"}),this.once_shown=!1,this.$content_iframe=$("<iframe id='"+c.uniqueId("ifr_")+"' src='about:blank' style='border:0px;padding:0px;margin:0px;'></iframe>")},e=function(b){var d=b;return function(){return a.sprintf.apply(a,c.union([d],c.values(arguments)))}};return c.extend(d.prototype,{window_details:{add_contact:{height:300,width:550,title:b.translate("chat|add_contact"),url:"/sites/ajax/contacts/add_contact?win_id=add-contact"},add_contact_group:{height:300,width:550,title:b.translate("chat|add_contact_group"),url:"/sites/ajax/contacts/add_contact_group?win_id=add-contact-group&action=add"},search_chat_room:{height:580,width:550,title:b.translate("chat|search_chatrooms"),url:"/sites/ajax/chatroom/search?win_id=chatroom-search"},search_chat_room_w_param:{height:580,width:550,title:b.translate("chat|search_chatrooms"),url:e("/sites/ajax/chatroom/search_submit?win_id=chatroom-search&search=%1$s&language=%2$s&search_keywords=%3$s")},report_abuse:{height:300,width:550,title:b.translate("common|report_abuse"),url:e("/sites/ajax/report/report_abuse?win_id=report_abuse&type=%1$s&offender=%2$s&subject=%3$s&subject_id=%4$s")},transfer_credit:{height:300,width:550,title:b.translate("user|transfer_credit"),url:e("/sites/ajax/account/transfer_credit?win_id=account-window&recipient_username=%1s")},edit_msn_details:{height:300,title:b.translate("chat|edit_msn"),url:"/sites/ajax/im/edit?win_id=edit-im-2&imtype=2"},edit_yahoo_details:{height:300,width:550,title:b.translate("chat|edit_yahoo"),url:"/sites/ajax/im/edit?win_id=edit-im-4&imtype=4"},edit_gtalk_details:{height:300,width:550,title:b.translate("chat|edit_gtalk"),url:"/sites/ajax/im/edit?win_id=edit-im-6&imtype=6"},edit_facebook_details:{height:300,width:550,title:b.translate("chat|edit_facebook"),url:"/sites/ajax/im/edit?win_id=edit-im-7&imtype=7"},add_contact_user:{height:300,width:550,title:b.translate("chat|follow_a_user"),url:e("/sites/ajax/contacts/add_mig33_user_submit?win_id=add-contact&username=%1$s&sharemobile=0")},rename_contact_group:{height:300,width:550,title:b.translate("chat|rename_group"),url:e("/sites/ajax/contacts/add_contact_group?win_id=rename-contact-group&action=rename&group_id=%1$s&group_name=%2$s&")},change_chatroom_multiid:{height:300,width:550,title:b.translate("chat|settings_control_multids"),url:e("/sites/ajax/chatroom/setup_multiids/?roomName=%1$s&win_id=chatroom-settings-setup_multiids")},setup_chatroom_settings:{height:300,width:550,title:b.translate("chat|settings_chatroom"),url:e("/sites/ajax/chatroom/setup/?roomName=%1$s&win_id=chatroom-settings-setup")},create_new_chatroom:{height:560,width:750,title:b.translate("chat|create_chatroom"),url:"/sites/ajax/chatroom/create"},invite_friends:{height:400,width:500,title:b.translate("chat|invite_friends"),url:"/discover/invite"}},show_window:function(a){var b=this.window_details[a];if(!b)return void console.log("unable to find window schema for - "+a);this.close_window();var d="";if(c.isFunction(b.url)){var e=c.rest(arguments);d=b.url.apply(this,e)}else d=b.url;this.show_inpage_window(d,b.title,b.width,b.height)},show_inpage_window:function(a,b,d,e){var f=this,g=this.$content_iframe,h=this.$window_parent;g.css({width:"100%",height:e+20});try{g.attr("src","about:blank")}catch(i){}var j=h.qtip("api");d>$(window).width()&&(d=$(window).width()),e>$(window).height()&&(e=$(window).height()),j.show(),f.once_shown||j.set("content.text",g),c.defer(function(){j.set("content.title",b),j.set("style.width",d),j.set("style.height",e),g.attr("src",a)}),this.current_window=j,this.once_shown=!0},show_tearaway_window:function(a,b,c,d,e){if(this.tearaway_window_refs[e])try{this.tearaway_window_refs[e].close()}catch(f){}this.tearaway_window_refs[e]=window.open(a+"?noredir=1",e,"width="+c+",height="+d)},close_window:function(){this.current_window&&this.current_window.hide(),this.current_window=null}}),new d});var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};define("modules/chat/models/contacts",["require","exports","./model","../fusion/fpacket","../fusion/fpacket_defs","../data/ftransport","../config/config_ts","./contact_packet_handler","modules/export_marionette","backbone.marionette","underscore","jquery","backbone","modules/common/local_storage","modules/common/utility","modules/chat/views/content_window_helper"],function(a,b,c,d,e,f,g,h){var i=a("modules/chat/views/content_window_helper"),j=(f.Transport.getInstance(),g.config),k=(a("modules/common/local_storage"),a("modules/common/utility")),l=a("underscore"),m=function(b){function c(a){b.call(this,a)}return __extends(c,b),c.prototype.setPresence=function(a){this.set({fusionPresence:a.fusionPresence,msnPresence:a.msnPresence,gtalkPresence:a.gtalkPresence,yahooPresence:a.yahooPresence,facebookPresence:a.facebookPresence})},c.prototype.setStatusMessage=function(a){this.set({statusMessage:a})},c.prototype.getDisplayPicture=function(a,b,c,d){return"undefined"==typeof a&&(a=32),"undefined"==typeof b&&(b=32),"undefined"==typeof c&&(c=1),"undefined"==typeof d&&(d=1),this.getType()===j.IM_Type.fusion?j.image_server+"/dp/"+this.getUsername()+"?w="+a+"&h="+b+"&c="+c+"&a="+d:j.image_server+"/dp/default?w="+a+"&h="+b+"&c="+c+"&a="+d},c.prototype.getSortOrder=function(){return k.lpad(this.getPresence()+"","0",2)+"-"+this.getDisplayName()},c.prototype.getDisplayName=function(){var a=this.get("displayName");return l.isEmpty(a)&&(l.isEmpty(this.get("username"))||(a=this.get("username"))),a},c.prototype.getUsername=function(){var a=this.get("fusionUsername");return l.isEmpty(a)&&(l.isEmpty(this.get("msnUsername"))?l.isEmpty(this.get("yahooUsername"))?l.isEmpty(this.get("gtalkUsername"))?l.isEmpty(this.get("facebookUsername"))?l.isEmpty(this.get("displayName"))?l.isEmpty(this.get("username"))||(a=this.get("username")):a=this.get("displayName"):a=this.get("facebookUsername"):a=this.get("gtalkUsername"):a=this.get("yahooUsername"):a=this.get("msnUsername")),a},c.prototype.getType=function(){var a=j.IM_Type.fusion;return l.isEmpty(this.get("fusionUsername"))&&(a=l.isEmpty(this.get("msnUsername"))?l.isEmpty(this.get("yahooUsername"))?l.isEmpty(this.get("gtalkUsername"))?l.isEmpty(this.get("facebookUsername"))?j.IM_Type.mobile:j.IM_Type.facebook:j.IM_Type.gtalk:j.IM_Type.yahoo:j.IM_Type.msn),a},c.prototype.isFusionContact=function(){var a=this.getType();return a===j.IM_Type.fusion},c.prototype.getPresence=function(){var b,c=a("modules/chat/models/user_session"),d=c.Session.getInstance(),e=null;return l.isEmpty(this.get("fusionUsername"))&&(l.isEmpty(this.get("msnUsername"))?l.isEmpty(this.get("yahooUsername"))?l.isEmpty(this.get("gtalkUsername"))?l.isEmpty(this.get("facebookUsername"))||(b=d.get("facebook_signed_in"),e=b?this.get("facebookPresence"):j.Presence.appear_offline):(b=d.get("gtalk_signed_in"),e=b?this.get("gtalkPresence"):j.Presence.appear_offline):(b=d.get("yahoo_signed_in"),e=b?this.get("yahooPresence"):j.Presence.appear_offline):(b=d.get("msn_signed_in"),e=b?this.get("msnPresence"):j.Presence.appear_offline)),null===e&&(e=this.get("fusionPresence")),e=parseInt(e,10)?e:j.Presence.appear_offline,parseInt(e,10)},c.prototype.isOffline=function(){var a=this.getPresence();return null===a||a==j.Presence.appear_offline},c.prototype.getIMPresence=function(a){var b;switch(parseInt(a,10)){case j.IM_Type.fusion:b=this.get("fusionPresence");break;case j.IM_Type.msn:b=this.get("msnPresence");break;case j.IM_Type.gtalk:b=this.get("gtalkPresence");break;case j.IM_Type.yahoo:b=this.get("yahooPresence");break;case j.IM_Type.facebook:b=this.get("facebookPresence");break;default:b=j.Presence.appear_offline}return parseInt(b,10)||j.Presence.appear_offline},c.prototype.getIconClass=function(a){switch(a){case j.Presence.online:return"online";case j.Presence.busy:return"busy";case j.Presence.away:return"away";case j.Presence.appear_offline:return"offline";default:return"offline"}},c.prototype.getIMType=function(a){switch(a){case j.IM_Type.fusion:return"fusion";case j.IM_Type.msn:return"msn";case j.IM_Type.gtalk:return"gtalk";case j.IM_Type.yahoo:return"yahoo";case j.IM_Type.facebook:return"facebook";default:return""}},c.prototype.getPresenceIconCls=function(){return this.getIMType(this.getType())+"-"+this.getIconClass(this.getPresence())},c}(c.MigModel);b.ContactModel=m,m.prototype.idAttribute="contactId";var n=function(a){function b(){a.apply(this,arguments),this.model=m}return __extends(b,a),b}(Backbone.Collection);b.ContactsCollection=n;var o=function(b){function c(c){var d=this;if(b.call(this,c),this.contacts=new n,this.contacts.on("add",function(a){d.trigger("contact_added",a)}),this.contacts.on("remove",function(a){d.trigger("contact_removed",a)}),this.contacts.on("change",function(a){d.trigger("contact_updated",a)}),this.is_im()){var e=a("modules/chat/models/user_session"),f=e.Session.getInstance(),h=g.config.IM_Group[this.get("groupId")],i=g.config.IM_Name[h];f.on("change:"+i+"_signed_in",function(){d.trigger("im_loggin_toggle"),d.check_and_remove_contacts()})}}return __extends(c,b),c.prototype.check_and_remove_contacts=function(){var a=this;if(!this.is_im_logged_in()){var b=1;this.contacts.each(function(c){l.delay(function(){a.contacts.remove(c)},10*b++)})}},c.prototype.is_im=function(){return!!g.config.IM_Group[this.get("groupId")]},c.prototype.is_im_logged_in=function(){var b=g.config.IM_Group[this.get("groupId")];if(!b)return!1;var c=a("modules/chat/models/user_session"),d=c.Session.getInstance(),e=g.config.IM_Name[b];return d.get(e+"_signed_in")},c.prototype.is_im_setup=function(){var b=g.config.IM_Group[this.get("groupId")];if(!b)return!1;var c=a("modules/chat/models/user_session"),d=c.Session.getInstance(),e=g.config.IM_Name[b];return d.get(e+"_setup")},c.prototype.setup_im=function(){var a=g.config.IM_Group[this.get("groupId")];if(!a)return!1;var b=g.config.IM_Name[a];i.show_window("edit_"+b+"_details")},c.prototype.toggle_login=function(){this.is_im_logged_in()?this.logout_im():this.login_im()},c.prototype.login_im=function(){var a=g.config.IM_Group[this.get("groupId")];if(!a)return!1;var b=d.create_packet(e.FUSION_PACKET_TYPES.IM_LOGIN);b.add_field("imtype",a),b.add_field("initialpresence",1),b.add_field("showofflinecontacts",0),this.send_packet(b)},c.prototype.logout_im=function(){var a=g.config.IM_Group[this.get("groupId")];if(!a)return!1;var b=d.create_packet(e.FUSION_PACKET_TYPES.IM_LOGOUT);b.add_field("imtype",a),this.send_packet(b)},c.prototype.get_contacts=function(){return this.contacts},c.prototype.get_contact_by_id=function(a){return this.contacts.get(a)},c.prototype.has_contact=function(a){return this.contacts.contains(a)},c.prototype.add=function(a,b){this.contacts.add(a,b)},c.prototype.remove=function(a){return this.contacts.remove(a)},c.prototype.get_contact_by_name=function(a){var b=this.contacts;return b.find(function(b){return b.get("username")===a})},c}(c.MigModel);b.ContactGroupModel=o,o.prototype.idAttribute="groupId";var p=function(a){function b(){a.apply(this,arguments),this.model=o}return __extends(b,a),b}(Backbone.Collection);b.ContactGroupCollection=p;var q=function(b){function c(a){var d=this;if(b.call(this,a),this.packets={GET_CONTACT_REQUESTS:e.FUSION_PACKET_TYPES.GET_CONTACT_REQUESTS,GET_CONTACTS:e.FUSION_PACKET_TYPES.GET_CONTACTS,MOVE_CONTACT:e.FUSION_PACKET_TYPES.MOVE_CONTACT,REMOVE_CONTACT:e.FUSION_PACKET_TYPES.REMOVE_CONTACT,REMOVE_CONTACT_GROUP:e.FUSION_PACKET_TYPES.REMOVE_GROUP,SET_PERMISSION:e.FUSION_PACKET_TYPES.SET_PERMISSION},this.initial_contacts_loaded=!1,this.contact_cache_by_name={},this.contact_name_cache_by_im_names={},this._pre_storage_contact_group_cache=[],this._pre_storage_contact_cache=[],this._debounce_persist_contact=null,this._debounce_persist_contact_group=null,c._instance)throw new Error("Contact Store instance already exist... use getInstance()");c._instance=this,this.contactGroups=new p,this.contactGroups.on("add",function(a){d.trigger("contact_group_added",a)}),this.contactGroups.on("remove",function(a){d.trigger("contact_group_removed",a)}),this.contactGroups.on("change",function(a){d.trigger("contact_group_updated",a)}),this.all_contacts=new n,this.setup_subscribed_packets()}return __extends(c,b),c.getInstance=function(){return c._instance||(c._instance=new c),c._instance},c.prototype.setup_subscribed_packets=function(){this.registerPacketHandler(new h.ContactCompleteHandler(this)),this.registerPacketHandler(new h.ContactGroupHandler(this)),this.registerPacketHandler(new h.ContactHandler(this)),this.registerPacketHandler(new h.ContactListVersionHandler(this)),this.registerPacketHandler(new h.PresenceHandler(this)),this.registerPacketHandler(new h.RemoveContactHandler(this)),this.registerPacketHandler(new h.RemoveGroupHandler(this)),this.registerPacketHandler(new h.StatusMessageHandler(this))},c.prototype.add_contact_group=function(a,b,c){var d=this.contactGroups.get(a);d?d.get("name")!=b&&d.set({name:b}):this.contactGroups.add({groupId:a,name:b}),this.store_contact_group_local(a,c)},c.prototype.remove_contact=function(a){var b=this.find_contact_by_id(a),c=this.get_group_from_contact_id(a);b&&c&&c.remove([b]),this.store_contact_local(a,null)},c.prototype.remove_contact_group=function(a){var b=this.get_contact_group(a);this.contactGroups.remove(b),this.store_contact_group_local(a,null)},c.prototype.add_contact=function(a,b){var c=!this.initial_contacts_loaded,d=a.contactId;a.groupId&&!l.isNaN(a.groupId)||(a.groupId=-1);var e=a.groupId,f=this.contactGroups.get(e);if(f){a.groupName=f.get("name");var g=this.find_contact_by_id(d);if(g){g.setPresence(a);var h=this.get_group_from_contact_id(a.contactId);h&&h.get("groupId")==e||(h&&h.remove([g]),g.set({groupId:e,groupName:f.get("name")},{silent:!0}),f.add([g]))}else f.add([a],{silent:c}),g=this.find_contact_by_id(d),this.all_contacts.add(g,{silent:c}),this.contact_name_cache_by_im_names[g.getUsername()]=g.getDisplayName(),this.contact_cache_by_name[a.displayName]=g;this.store_contact_local(d,b)}},c.prototype.set_presence=function(a,b){var c=this.find_contact_by_id(a);c?c.setPresence(b):this.request_contact(a)},c.prototype.set_status_message=function(a,b){var c=this.find_contact_by_id(a);c?c.setStatusMessage(b):this.request_contact(a)},c.prototype.contact_load_complete=function(){this.initial_contacts_loaded=!0,this.trigger("contacts_load_complete",this.all_contacts)},c.prototype.filter_contacts=function(a){return this.all_contacts.filter(a)},c.prototype.is_contacts_loaded=function(){return this.initial_contacts_loaded},c.prototype.get_all_contacts=function(){return this.all_contacts},c.prototype.init=function(){var b=this,c=a("modules/chat/models/user_session"),d=c.Session.getInstance();d.on("session_created",function(){b.send_get_contacts()}),d.on("im_status_update",function(a){if(1!==parseInt(a.status,10)){var c=a.imtype;b.all_contacts.each(function(a){a.getType()===c&&a.trigger("change")})}},this),this.contact_cache_by_name={},this.contact_name_cache_by_im_names={}},c.prototype.is_cached_contacts_latest=function(){var b=a("modules/chat/models/user_session"),c=b.Session.getInstance(),d=c.get("contact_list_version"),e=parseInt(c.get_user_data("contact_list_version"),10);return d===e?c.is_user_data_set("contact_group_list")&&c.is_user_data_set("contact_list"):!1},c.prototype.get_cached_contact_groups=function(){if(!this.is_cached_contacts_latest())return null;var b=a("modules/chat/models/user_session"),c=b.Session.getInstance();return c.get_user_data("contact_group_list")},c.prototype.get_cached_contacts=function(){if(!this.is_cached_contacts_latest())return null;var b=a("modules/chat/models/user_session"),c=b.Session.getInstance();return c.get_user_data("contact_list")},c.prototype.send_get_contacts=function(a){var b=this;"undefined"==typeof a&&(a=!1);var c=d.create_packet(this.packets.GET_CONTACTS);!this.is_cached_contacts_latest()||a?c.add_field("presence",null):(this._pre_storage_contact_group_cache=this.get_cached_contact_groups(),l.each(this._pre_storage_contact_group_cache,function(a){var b=d.create_packet_from_json(a);b.execute()}),this._pre_storage_contact_cache=this.get_cached_contacts(),l.each(this._pre_storage_contact_cache,function(a){var b=d.create_packet_from_json(a);b.execute()}),c.add_field("presence",j.Presence.online),l.delay(function(){b.send_get_contacts(!0)},6e4)),this.send_packet(c)},c.prototype.send_block_user=function(a){var b=d.create_packet(this.packets.SET_PERMISSION);b.add_field("username",a),b.add_field("permission",2),this.send_packet(b)},c.prototype.request_contact=function(a){var b=d.create_packet(this.packets.GET_CONTACTS);b.add_field("contactid",a),this.send_packet(b)},c.prototype.get_group_from_contact_id=function(a){var b=this.contactGroups,c=null;return b.each(function(b){b.get_contact_by_id(a)&&(c=b)}),c},c.prototype.get_contact_group=function(a){var b=this.contactGroups;return b.get(a)},c.prototype.get_contact_groups=function(){return this.contactGroups},c.prototype.send_delete_contact_group=function(a,b){var c=this,e=d.create_packet(this.packets.REMOVE_CONTACT_GROUP);e.add_field("groupid",a),e.on("response",function(){var b=c.contactGroups,d=b.get(a);b.remove(d),c.store_contact_group_local(a,null)}),e.on("error",function(d){var e=d.response_packet,f=e.get_error_message();c.trigger("contact_group_remove_failed",f,a,b)}),this.send_packet(e)},c.prototype.get_display_name_from_cache=function(a){var b=this.contact_name_cache_by_im_names[a];return b||a},c.prototype.send_move_contact=function(a,b){var c=d.create_packet(this.packets.MOVE_CONTACT);c.add_field("contactid",a),c.add_field("groupid",b),this.send_packet(c)},c.prototype.send_remove_friend=function(a){var b=d.create_packet(this.packets.REMOVE_CONTACT);b.add_field("contactid",a),this.send_packet(b)},c.prototype.find_contact_by_id=function(a){var b=this.contactGroups,c=this.all_contacts.get(a);return c||b.each(function(b){var d=b.get_contact_by_id(a);l.isUndefined(d)||l.isNull(d)||(c=d)}),c},c.prototype.find_contact_by_name=function(a){return this.contact_cache_by_name[a]},c.prototype.store_contact_local=function(b,c){var d=this;console.log("storing more stuff"),l.isNull(c)?(this._pre_storage_contact_cache[b]=null,delete this._pre_storage_contact_cache[b]):(c.add_field("fusionpresence",j.Presence.appear_offline),c.add_field("msnpresence",j.Presence.appear_offline),c.add_field("yahoopresence",j.Presence.appear_offline),c.add_field("gtalkpresence",j.Presence.appear_offline),c.add_field("facebookpresence",j.Presence.appear_offline),this._pre_storage_contact_cache[b]=c.to_packet_json(!0)),this._debounce_persist_contact||(this._debounce_persist_contact=l.debounce(function(){var b=a("modules/chat/models/user_session"),c=b.Session.getInstance();c.set_user_data("contact_list",d._pre_storage_contact_cache)},1e3)),this._debounce_persist_contact()},c.prototype.store_contact_group_local=function(b,c){var d=this;console.log("storing stuff"),l.isNull(c)?(this._pre_storage_contact_group_cache[b]=null,delete this._pre_storage_contact_group_cache[b]):this._pre_storage_contact_group_cache[b]=c.to_packet_json(!0),this._debounce_persist_contact_group||(this._debounce_persist_contact_group=l.debounce(function(){var b=a("modules/chat/models/user_session"),c=b.Session.getInstance();c.set_user_data("contact_group_list",d._pre_storage_contact_group_cache)},1e3)),this._debounce_persist_contact_group()},c}(c.MigModel);b.ContactGroupStore=q}),define("modules/common/image_optimizer",["require","exports"],function(a,b){var c=(a("underscore"),a("jquery")),d=function(){function a(){if(a.instance)throw new Error("Image Optimizer can not be constructed directly, use static function getInstance to get the instance");a.instance=this}return a.getInstance=function(){return null===a.instance&&(a.instance=new a),a.instance},a.prototype.renderElements=function(){this.canv=document.createElement("canvas"),this.ctx=this.canv.getContext("2d"),c("body").append(this.canv),c(this.canv).hide(),this.canv.width=a.DEFAULT_MAX_WIDTH,this.canv.height=a.DEFAULT_MAX_HEIGHT},a.prototype.resizeCanvas=function(a,b){this.canv.width=b,this.canv.height=a},a.prototype.resizeImage=function(a,b,c,d){var e=a.width,f=a.height,g=[c/e,b/f],h=Math.min(g[0],g[1]),i=Math.floor(e*h),j=Math.floor(f*h);return i>e&&j>f&&(i=e,j=f),this.resizeCanvas(j,i),this.ctx.clearRect(0,0,i,j),this.ctx.drawImage(a,0,0,e,f,0,0,i,j),{base64:this.canv.toDataURL(d.mimetype),height:j,width:i}},a.prototype.optimize=function(b,d,e,f){var g=this;"undefined"==typeof d&&(d=a.DEFAULT_MAX_WIDTH),"undefined"==typeof e&&(e=a.DEFAULT_MAX_HEIGHT),"undefined"==typeof f&&(f=a.MIME_TYPE_JPG);var h=c.Deferred();this.ctx||this.renderElements();var i=new Image;return i.onload=function(){h.resolve(g.resizeImage(i,d,e,f))},i.src=b,h},a.instance=null,a.MIME_TYPE_JPG={extensions:"jpg,jpeg,jpe",mimetype:"image/jpeg"},a.MIME_TYPE_PNG={extensions:"png,x-png",mimetype:"image/png"},a.DEFAULT_MAX_HEIGHT=1024,a.DEFAULT_MAX_WIDTH=1024,a}();b.ImageOptimizer=d}),define("modules/chat/data/Base64Binary",["require","exports"],function(a,b){var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",d=function(){function a(){}return a.decode=function(a,b){var d=c.indexOf(a.charAt(a.length-1)),e=c.indexOf(a.charAt(a.length-2)),f=a.length/4*3;64==d&&f--,64==e&&f--;var g,h,i,j,k,l,m,n,o=0,p=0;for(g=b?new Uint8Array(b):new Uint8Array(f),a=a.replace(/[^A-Za-z0-9\+\/\=]/g,""),o=0;f>o;o+=3)k=c.indexOf(a.charAt(p++)),l=c.indexOf(a.charAt(p++)),m=c.indexOf(a.charAt(p++)),n=c.indexOf(a.charAt(p++)),h=k<<2|l>>4,i=(15&l)<<4|m>>2,j=(3&m)<<6|n,g[o]=h,64!=m&&(g[o+1]=i),64!=n&&(g[o+2]=j);return g},a}();b.Base64Binary=d});var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};define("modules/chat/models/chat_packet_handler",["require","exports","./user_session","../fusion/fpacket_defs","../config/config_ts","./packet_handler","./contacts","./chats","../data/Base64Binary","underscore","modules/common/config","modules/common/utility"],function(a,b,c,d,e,f,g,h,i){var j=a("underscore"),k=(a("modules/common/config"),a("modules/common/utility")),l=e.config,m=function(a){function b(b){a.call(this),this.packet_type=d.FUSION_PACKET_TYPES.FILE_RECEIVED,this.listener_obj=b}return __extends(b,a),b.prototype.received_fn=function(a){var b=c.Session.getInstance(),d=b.get("session_user");this.listener_obj.handleMessageData(this.parseChatData(a),this.parseMessageDataFromFilePacket(a,d))},b.prototype.parseChatData=function(a){var b=a.toObject(),c=l.DestinationType.individual,d=b.source,e=b.contactid,f=(b.infomessage,b.url),h=d,i=l.Message_Type[l.IM_Type.fusion],j=(Date.now(),k.get_guid(),k.parse_query(f,"nid"),this.listener_obj.computeChatHandle(c,h.toString()));return{chatHandle:j,messageType:i,destinationType:c,destination_for_user_messages:h,destination:h,destinationName:g.ContactGroupStore.getInstance().get_display_name_from_cache(h),createdBy:d,contactId:e,timestampFromServer:Date.now(),source:d}},b.prototype.parseMessageDataFromFilePacket=function(a,b){var d=a.toObject(),f=l.DestinationType.individual,h=d.source,i=(d.contactid,d.infomessage),j=d.url,m=h,n=l.Message_Type[l.IM_Type.fusion],o=Date.now(),p=c.Session.getInstance().session_start_time<o,q=k.get_guid(),r=k.parse_query(j,"nid"),s=d.pinnedType,t=h==b,u=this.listener_obj.computeChatHandle(f,m.toString());return{message:i,source:g.ContactGroupStore.getInstance().get_display_name_from_cache(h),content_type:l.Content_Type.image,content_data:r,message_type:n,admin_message:!1,allowed_emoticons:"",emoticons:"",source_colour:"",message_colour:"",is_own_message:t,message_status:e.config.MessageStatus.sent_ok,is_live_message:p,chatroom_type:f,chatroom_identifier:u,destination:b,pinnedType:s,time:new Date(o),timestamp:o,inSync:!0,message_id:q,emote_type:null,previous_message_id:null,mime_type:null,mime_type_data:null}},b}(f.PacketHandlerBase);b.FileRecievedHandler=m;var n=function(a){function b(b){a.call(this),this.packet_type=d.FUSION_PACKET_TYPES.GROUP_CHAT_PARTICIPANTS,this.listener_obj=b}return __extends(b,a),b.prototype.received_fn=function(a){var b=a.toObject(),c=b.groupchatid;if(c==this.listener_obj.get("destination")){var d=b.participants;if(d){var e=d.split(";");this.listener_obj.setParticipants(e)}}},b}(f.PacketHandlerBase);b.ParticipantsPacketHandler=n;var o=function(a){function b(b){a.call(this),this.packet_type=d.FUSION_PACKET_TYPES.LATEST_MESSAGES_DIGEST,this.listener_obj=b}return __extends(b,a),b.prototype.received_fn=function(a){var b=a.toObject(),c=[],d=i.Base64Binary.decode(b.chattypes),e=b.chatid;j.each(e,function(a,e){var f=b.guids[e],g=b.timestamps[e],h=d[e],i=b.messages[e];c.push({chat_id:a,message_guid:f,message_timestamp:g,chat_type:h,message:i})}),this.listener_obj.add_message_digests(c)},b}(f.PacketHandlerBase);b.MessageDigestHandler=o;var p=function(a){function b(b){a.call(this),this.packet_type=d.FUSION_PACKET_TYPES.SET_MESSAGE_EVENT,this.listener_obj=b}return __extends(b,a),b.prototype.received_fn=function(a){var b=c.Session.getInstance(),d=(b.get("session_user"),a.toObject()),e=this.listener_obj.computeChatHandle(d.messagedestinationtype,d.messagedestination.toString()),f=this.listener_obj.getChat(e);
f&&f.setMessageStatus(d.messageguid,parseInt(d.messageeventtype,10))},b}(f.PacketHandlerBase);b.MessageEventHandler=p;var q=function(a){function b(b){a.call(this),this.packet_type=d.FUSION_PACKET_TYPES.MESSAGE,this.listener_obj=b}return __extends(b,a),b.prototype.received_fn=function(a){var b=c.Session.getInstance(),d=b.get("session_user"),e=this.parseChatData(a,d),f=h.ChatStoreModel.parseMessageData(a,d);e&&f&&this.listener_obj.handleMessageData(this.parseChatData(a,d),f)},b.prototype.parseChatData=function(a,b){var d=a.toObject(),e=d.destinationtype;if(e===l.DestinationType.public_chat)return null;var f=d.messagetype,h=d.source,i=d.destination,j=d.contactid,k=parseInt(d.timestamp,10),m=c.Session.getInstance().get_aproximated_server_time();k=k?k:m;var n=h,o=h==b;e==l.DestinationType.individual?n=o?i:h:e==l.DestinationType.group&&(n=i);var p=this.listener_obj.computeChatHandle(e,n.toString());return{chatHandle:p,messageType:f,destinationType:e,destination_for_user_messages:n,destination:n,destinationName:e==l.DestinationType.group?"":g.ContactGroupStore.getInstance().get_display_name_from_cache(n),createdBy:h,contactId:j,timestampFromServer:Date.now(),source:h}},b}(f.PacketHandlerBase);b.MessageHandler=q;var r=function(a){function b(b){a.call(this),this.packet_type=d.FUSION_PACKET_TYPES.GROUP_CHAT,this.listener_obj=b}return __extends(b,a),b.prototype.received_fn=function(a){var b=c.Session.getInstance(),d=b.get("session_user");this.listener_obj.getOrCreateChat(this.parseChatData(a,d))},b.prototype.parseChatData=function(a,b){var c=a.toObject(),d=parseInt(c.imtype,10),e=c.groupchatid,f=c.creator,g=l.DestinationType.group,h=this.listener_obj.computeChatHandle(g,e.toString());return{chatHandle:h,messageType:d,destinationType:g,destination_for_user_messages:e,destination:e,destinationName:"",createdBy:f,contactId:null,timestampFromServer:Date.now(),source:null}},b}(f.PacketHandlerBase);b.GroupChatHandler=r;var s=function(a){function b(b){a.call(this),this.packet_type=d.FUSION_PACKET_TYPES.CHAT,this.listener_obj=b}return __extends(b,a),b.prototype.received_fn=function(a){var b=c.Session.getInstance(),d=b.get("session_user"),e=a.toObject(),f=this.listener_obj.computeChatHandle(parseInt(e.chattype,10),e.chatidentifier);if(parseInt(e.isclosedchat,10)&&parseInt(e.chattype,10)!==l.DestinationType.public_chat){var g=this.listener_obj.chats.get(f);g&&this.listener_obj.chats.remove(g)}else parseInt(e.chattype,10)!==l.DestinationType.public_chat&&this.listener_obj.getOrCreateChat(this.parseChatData(a,d))},b.prototype.parseChatData=function(a,b){var c=a.toObject(),d=parseInt(c.messagetype,10),e=c.chatidentifier,f=b,g=parseInt(c.chattype,10),h=this.listener_obj.computeChatHandle(g,e.toString());return{chatHandle:h,messageType:d,destinationType:g,destination_for_user_messages:e,destination:e,destinationName:c.chatdisplayname,createdBy:g===l.DestinationType.individual?f:c.groupowner,contactId:g===l.DestinationType.individual?c.contactid:null,timestampFromServer:parseInt(c.timestamp,10),source:null}},b}(f.PacketHandlerBase);b.ChatHandler=s;var t=function(a){function b(b){a.call(this),this.packet=d.FUSION_PACKET_TYPES.CHAT_LIST_VERSION,this.listener_obj=b}return __extends(b,a),b.prototype.received_fn=function(a){var b=a.toObject(),d=c.Session.getInstance();d.set("chat_list_version",b.version),this.listener_obj.save_chats()},b}(f.PacketHandlerBase);b.ChatListVersionHandler=t;var u=function(a){function b(b){a.call(this),this.packet_type=d.FUSION_PACKET_TYPES.GROUP_CHAT_USER_STATUS,this.listener_obj=b}return __extends(b,a),b.prototype.received_fn=function(a){var b=a.toObject(),c=b.chatroomname,d=b.fusionusername,e=parseInt(b.userstatustype,10),f=parseInt(b.usertype,10);return j.isNaN(e)?void console.error("invalid value in the user status: expected a number"):(j.isNaN(f)&&(f=0),void(e?this.listener_obj.add_chat_participant(c,d,1===f):this.listener_obj.remove_chat_participant(c,d)))},b}(f.PacketHandlerBase);b.ChatUserStatusHandler=u}),define("modules/model/mimetypes/def/text_plain_mime",["require","exports"],function(a,b){var c=function(){function a(a){this.base_o=a}return Object.defineProperty(a.prototype,"text",{get:function(){return this.base_o.text},set:function(a){this.base_o.text=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"color",{get:function(){return this.base_o.color},set:function(a){this.base_o.color=a},enumerable:!0,configurable:!0}),a}();b.TextPlainMime=c}),define("modules/model/mimetypes/def/image_mime",["require","exports"],function(a,b){var c=function(){function a(a){this.base_o=a}return Object.defineProperty(a.prototype,"id",{get:function(){return this.base_o.id},set:function(a){this.base_o.id=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"url",{get:function(){return this.base_o.url},set:function(a){this.base_o.url=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"thumbnailUrl",{get:function(){return this.base_o.thumbnailUrl},set:function(a){this.base_o.thumbnailUrl=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"width",{get:function(){return this.base_o.width},set:function(a){this.base_o.width=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"height",{get:function(){return this.base_o.height},set:function(a){this.base_o.height=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"text",{get:function(){return this.base_o.text},set:function(a){this.base_o.text=a},enumerable:!0,configurable:!0}),a.prototype.toJSON=function(){return JSON.stringify(this.base_o)},a}();b.ImageMime=c}),define("modules/model/mimetypes/def/video_mime",["require","exports"],function(a,b){var c=function(){function a(a){this.base_o=a}return Object.defineProperty(a.prototype,"url",{get:function(){return this.base_o.url},set:function(a){this.base_o.url=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"thumbnail_url",{get:function(){return this.base_o.thumbnail_url},set:function(a){this.base_o.url=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"text",{get:function(){return this.base_o.text},set:function(a){this.base_o.url=a},enumerable:!0,configurable:!0}),a}();b.VideoMime=c});var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};define("modules/model/mimetypes/def/youtube_mime",["require","exports","./video_mime"],function(a,b,c){var d=function(a){function b(b){a.call(this,b)}return __extends(b,a),Object.defineProperty(b.prototype,"wmode",{get:function(){return this.base_o.wmode},set:function(a){this.base_o.wmode=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"allowfullscreen",{get:function(){return this.base_o.allowfullscreen},set:function(a){this.base_o.allowfullscreen=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"controls",{get:function(){return this.base_o.controls},set:function(a){this.base_o.controls=a},enumerable:!0,configurable:!0}),b}(c.VideoMime);b.YoutubeMime=d}),define("modules/model/mimetypes/def/gift_mime",["require","exports"],function(a,b){!function(a){a[a.GIFT=1]="GIFT",a[a.GIFT_SHOWER=2]="GIFT_SHOWER"}(b.GIFTTYPE||(b.GIFTTYPE={}));var c=(b.GIFTTYPE,function(){function a(a){this.base_o=a}return Object.defineProperty(a.prototype,"type",{get:function(){return this.base_o.type},set:function(a){this.base_o.type=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"hotkey",{get:function(){return this.base_o.hotkey},set:function(a){this.base_o.hotkey=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"message",{get:function(){return this.base_o.message},set:function(a){this.base_o.message=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"recipient",{get:function(){return this.base_o.recipient},set:function(a){this.base_o.recipient=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"sender",{get:function(){return this.base_o.sender},set:function(a){this.base_o.sender=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"name",{get:function(){return this.base_o.name},set:function(a){this.base_o.name=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"url",{get:function(){return this.base_o.url},set:function(a){this.base_o.url=a},enumerable:!0,configurable:!0}),a.prototype.get_gift_type=function(){return"GIFT_SHOWER"===this.base_o.type?2:1},a.prototype.is_gift_shower=function(){return"GIFT_SHOWER"===this.base_o.type},a}());b.GiftMime=c});var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};define("modules/model/mimetypes/def/sticker_mime",["require","exports","./text_plain_mime"],function(a,b,c){var d=function(a){function b(b){a.call(this,b)}return __extends(b,a),Object.defineProperty(b.prototype,"hotkey",{get:function(){return this.base_o.hotkey},set:function(a){this.base_o.hotkey=a},enumerable:!0,configurable:!0}),b}(c.TextPlainMime);b.StickerMime=d});var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};define("modules/model/mimetypes/def/vimeo_mime",["require","exports","./video_mime"],function(a,b,c){var d=function(a){function b(b){a.call(this,b)}return __extends(b,a),Object.defineProperty(b.prototype,"wmode",{get:function(){return this.base_o.wmode},set:function(a){this.base_o.wmode=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"allowfullscreen",{get:function(){return this.base_o.allowfullscreen},set:function(a){this.base_o.allowfullscreen=a},enumerable:!0,configurable:!0}),b}(c.VideoMime);b.VimeoMime=d});var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};define("modules/model/mimetypes/def/deezer_mime",["require","exports","./video_mime"],function(a,b,c){function d(){var a=.83333,b=8;return{showCover:"false",width:($(".chat-window-messages").width()*a-b).toString(),height:"100",playlist:"false",format:"horizontal"}}function e(){var a=8;return{showCover:"false",width:($(".mig-window .pin-container").width()-a).toString(),height:"100",playlist:"false",format:"horizontal"}}function f(){var a,b=16,c=.29;$(".container .content-homefeed").length?a=$(".container .content-homefeed"):$(".container .content-profile").length?a=$(".container .content-profile"):$(".container .content-singlepost").length?a=$(".container .content-singlepost"):$(".container .content-search").length&&(a=$(".container .content-search"));var d=a.width()-b;return{showCover:"true",width:d.toString(),height:(d*c).toString(),playlist:"true",format:"horizontal"}}function g(){return{showCover:"true",width:$(".panel.panel-deezer").width().toString(),height:"525",playlist:"true",format:"vertical"}}var h=function(a){function b(b){a.call(this,b)}return __extends(b,a),Object.defineProperty(b.prototype,"id",{get:function(){return this.base_o.id},set:function(a){this.base_o.id=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"showCover",{get:function(){return this.base_o.showCover},set:function(a){this.base_o.showCover=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"width",{get:function(){return this.base_o.width},set:function(a){this.base_o.width=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"height",{get:function(){return this.base_o.height},set:function(a){this.base_o.height=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"type",{get:function(){return this.base_o.type},set:function(a){this.base_o.type=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"format",{get:function(){return this.base_o.format},set:function(a){this.base_o.format=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"playlist",{get:function(){return this.base_o.playlist},set:function(a){this.base_o.playlist=a},enumerable:!0,configurable:!0}),b}(c.VideoMime);b.DeezerMime=h,b.getChatWindowConfig=d,b.getPinnedAreaConfig=e,b.getBlogPostConfig=f,b.getSidebarConfig=g});var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};define("modules/model/mimetypes/def/flickr_mime",["require","exports","./video_mime"],function(a,b,c){var d=function(a){function b(b){a.call(this,b)}return __extends(b,a),Object.defineProperty(b.prototype,"id",{get:function(){return this.base_o.id},set:function(a){this.base_o.id=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"wmode",{get:function(){return this.base_o.wmode},set:function(a){this.base_o.wmode=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"allowfullscreen",{get:function(){return this.base_o.allowfullscreen},set:function(a){this.base_o.allowfullscreen=a},enumerable:!0,configurable:!0}),b}(c.VideoMime);b.FlickrMime=d});var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};define("modules/model/mimetypes/def/soundcloud_mime",["require","exports","./video_mime"],function(a,b,c){var d=function(a){function b(b){a.call(this,b)}return __extends(b,a),Object.defineProperty(b.prototype,"width",{get:function(){return this.base_o.width},set:function(a){this.base_o.width=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"height",{get:function(){return this.base_o.height},set:function(a){this.base_o.height=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"scrolling",{get:function(){return this.base_o.scrolling},set:function(a){this.base_o.scrolling=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"frameborder",{get:function(){return this.base_o.frameborder},set:function(a){this.base_o.frameborder=a},enumerable:!0,configurable:!0}),b}(c.VideoMime);b.SoundcloudMime=d}),define("modules/model/mimetypes/def/migmelink_mime",["require","exports"],function(a,b){var c=function(){function a(a){this.base_o=a}return Object.defineProperty(a.prototype,"image",{get:function(){return this.base_o.image},set:function(a){this.base_o.image=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"title",{get:function(){return this.base_o.title},set:function(a){this.base_o.title=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"url",{get:function(){return this.base_o.url},set:function(a){this.base_o.url=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"description",{get:function(){return this.base_o.description},set:function(a){this.base_o.description=a},enumerable:!0,configurable:!0}),a}();b.MigmeLinkMime=c}),define("modules/model/mimetypes/def/event_mime",["require","exports"],function(a,b){var c=function(){function a(a){this.base_o=a}return Object.defineProperty(a.prototype,"icon_image",{get:function(){return this.base_o.icon_image},set:function(a){this.base_o.icon_image=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"title",{get:function(){return this.base_o.title},set:function(a){this.base_o.title=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"application_title",{get:function(){return this.base_o.application_title},set:function(a){this.base_o.application_title=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"application_url",{get:function(){return this.base_o.application_url},set:function(a){this.base_o.application_url=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"application_custom_url",{get:function(){return this.base_o.application_custom_url},set:function(a){this.base_o.application_custom_url=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"action_button",{get:function(){return this.base_o.action_button},set:function(a){this.base_o.action_button=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"thumbnail",{get:function(){return this.base_o.thumbnail},set:function(a){this.base_o.thumbnail=a},enumerable:!0,configurable:!0}),a}();b.EventMime=c}),define("modules/model/mimetypes/mime_types",["require","exports","./def/text_plain_mime","./def/image_mime","./def/youtube_mime","./def/gift_mime","./def/sticker_mime","./def/vimeo_mime","./def/deezer_mime","./def/flickr_mime","./def/soundcloud_mime","./def/migmelink_mime","./def/event_mime","modules/globals/url","modules/common/utility","underscore","jquery","backbone"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(a){var b=null;return o.each(p,function(c,d){null===b&&c.test(a)&&(b=parseInt(d,10))}),b}b.TextPlainMimeFactory=c,b.ImageMimeFactory=d,b.YoutubeMimeFactory=e,b.GiftMimeFactory=f,b.StickerMimeFactory=g,b.VimeoMimeFactory=h,b.DeezerMimeFactory=i,b.FlickrMimeFactory=j,b.SoundcloudMimeFactory=k,b.MigmeLinkMimeFactory=l,b.EventMimeFactory=m;var o=a("underscore");!function(a){a[a.ROOT=0]="ROOT",a[a.TEXT_PLAIN=1]="TEXT_PLAIN",a[a.TEXT_RICH=2]="TEXT_RICH",a[a.IMAGE=3]="IMAGE",a[a.YOUTUBE=4]="YOUTUBE",a[a.GIFT=5]="GIFT",a[a.STICKER=6]="STICKER",a[a.EMOTE=7]="EMOTE",a[a.VIMEO=8]="VIMEO",a[a.FLICKR=9]="FLICKR",a[a.SOUNDCLOUD=10]="SOUNDCLOUD",a[a.MIGMELINK=11]="MIGMELINK",a[a.EVENT=12]="EVENT",a[a.ERROR=13]="ERROR",a[a.DEEZER=14]="DEEZER",a[a.PARENT=15]="PARENT",a[a.PARTNER=16]="PARTNER",a[a.BADGE=17]="BADGE",a[a.ACHIEVEMENT=18]="ACHIEVEMENT"}(b.MIMETYPE||(b.MIMETYPE={}));var p=(b.MIMETYPE,{});p[0]=/^application\/vnd.migme.root/,p[15]=/^application\/vnd.migme.parent_post/,p[1]=/^text\/(plain|rtf)/,p[3]=/^image\/(flickr|gif|jpeg|png|jpg)/,p[4]=/^application\/vnd.migme.youtube/,p[5]=/^application\/vnd.migme.gift/,p[6]=/^application\/vnd.migme.sticker/,p[7]=/^application\/vnd.migme.emote/,p[8]=/^application\/vnd.migme.vimeo/,p[14]=/^application\/vnd.migme.deezer/,p[9]=/^application\/vnd.migme.flickr/,p[10]=/^application\/vnd.migme.soundcloud/,p[11]=/^application\/vnd.migme.link/,p[12]=/^application\/vnd.migme.event/,p[13]=/^application\/vnd.migme.error/,p[16]=/^application\/vnd.migme.partnerlink/,p[17]=/^application\/vnd.migme.badge/,p[18]=/^application\/vnd.migme.achievement/,b.getMimeType=n});var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};define("modules/chat/models/chatmessages",["require","exports","./model","../config/config_ts","../fusion/fpacket","../fusion/fpacket_defs","../data/ftransport","../../model/mimetypes/mime_types","modules/globals/url","modules/common/utility","underscore","jquery","backbone"],function(a,b,c,d,e,f,g,h){var i=d.config,j=a("modules/globals/url"),k=(a("modules/common/utility"),a("underscore")),l=f.FUSION_PACKET_TYPES,m=(f.FUSION_PACKET_FIELDS,function(){function a(){}return a.STICKER=1,a}()),n=function(b){function c(a){b.call(this,a);var c=this.get("time");this._isMessageRead=!1,k.isString(c)&&this.set("time",new Date(c)),this.status_packet_queue=g.Transport.getInstance().build_transport_queue()}return __extends(c,b),Object.defineProperty(c.prototype,"message",{get:function(){return this.get("message")},set:function(a){this.set("message",a)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"message_id",{get:function(){return this.get("message_id")},set:function(a){this.set("message_id",a)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"source",{get:function(){return this.get("source")},set:function(a){this.set("source",a)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"content_type",{get:function(){return this.get("content_type")},set:function(a){this.set("content_type",a)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"message_type",{get:function(){return this.get("message_type")},set:function(a){this.set("message_type",a)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"admin_message",{get:function(){return this.get("admin_message")},set:function(a){this.set("admin_message",a)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"allowed_emoticons",{get:function(){return this.get("allowed_emoticons")},set:function(a){this.set("allowed_emoticons",a)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"emoticons",{get:function(){return this.get("emoticons")},set:function(a){this.set("emoticons",a)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"source_colour",{get:function(){return this.get("source_colour")},set:function(a){this.set("source_colour",a)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"message_colour",{get:function(){return this.get("message_colour")},set:function(a){this.set("message_colour",a)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"chatroom_type",{get:function(){return this.get("chatroom_type")},set:function(a){this.set("chatroom_type",a)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"chatroom_identifier",{get:function(){return this.get("chatroom_identifier")},set:function(a){this.set("chatroom_identifier",a)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"destination",{get:function(){return this.get("destination")},set:function(a){this.set("destination",a)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"inSync",{get:function(){return this.get("inSync")},set:function(a){this.set("inSync",a)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"time",{get:function(){return this.get("time")},set:function(a){this.set("time",a)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"timestamp",{get:function(){return this.get("timestamp")},set:function(a){this.set("timestamp",a)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"pinnedType",{get:function(){return this.get("pinnedType")},set:function(a){this.set("pinnedType",a)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"is_live_message",{get:function(){return k.isEmpty(this.get("previous_message_id"))},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"mime_type",{get:function(){return this.get("mime_type")},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"mime_type_data",{get:function(){return this.get("mime_type_data")},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"message_status",{get:function(){return this.get("message_status")},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"is_own_message",{get:function(){return this.get("is_own_message")},enumerable:!0,configurable:!0}),c.prototype.isSelfMessage=function(){var b=a("modules/chat/models/user_session"),c=b.Session.getInstance();return this.get("source")==c.attributes.session_user},c.prototype.is_system_message=function(){return this.content_type==i.Content_Type.system},c.prototype.is_emote=function(){return this.get("content_type")==i.Content_Type.emote},c.prototype.is_sticker=function(){return this.get("emote_type")==m.STICKER||6===h.getMimeType(this.mime_type)},c.prototype.is_plain_message=function(){return!this.is_sticker()&&!this.is_emote()&&(k.isUndefined(this.get("mime_type"))||k.isNull(this.get("mime_type")))},c.prototype.is_gift=function(){return 5===h.getMimeType(this.mime_type)},c.prototype.is_gift_shower=function(){var a=this.get_gift_mime_type_data();return a?2===a.get_gift_type():!1},c.prototype.get_gift_mime_type_data=function(){return this.is_gift()&&this.mime_type_data?new h.GiftMimeFactory.GiftMime(JSON.parse(this.mime_type_data)):null},c.prototype.get_image_mime_type_data=function(){if(!this.is_image()||!this.mime_type_data)return null;if(this.is_mime_type_image()){var a=new h.ImageMimeFactory.ImageMime(JSON.parse(this.mime_type_data));return a}var b=this.get("content_data");return b&&0!==b.indexOf("http://")&&0!==b.indexOf("https://")&&(b=j.image+"/"+b),new h.ImageMimeFactory.ImageMime({id:"",url:b,thumbnailUrl:b,height:0,width:0,text:""})},c.prototype.get_youtube_data=function(){return new h.YoutubeMimeFactory.YoutubeMime(JSON.parse(this.mime_type_data))},c.prototype.get_flickr_data=function(){return new h.FlickrMimeFactory.FlickrMime(JSON.parse(this.mime_type_data))},c.prototype.get_vimeo_data=function(){return new h.VimeoMimeFactory.VimeoMime(JSON.parse(this.mime_type_data))},c.prototype.get_deezer_data=function(){return new h.DeezerMimeFactory.DeezerMime(JSON.parse(this.mime_type_data))},c.prototype.get_soundcloud_data=function(){return new h.SoundcloudMimeFactory.SoundcloudMime(JSON.parse(this.mime_type_data))},c.prototype.get_migmelink_data=function(){return new h.MigmeLinkMimeFactory.MigmeLinkMime(JSON.parse(this.mime_type_data))},c.prototype.get_sticker_data=function(){return new h.StickerMimeFactory.StickerMime(JSON.parse(this.mime_type_data))},c.prototype.get_plain_text_html=function(){return this.is_sticker()?new h.StickerMimeFactory.StickerMime(JSON.parse(this.mime_type_data)):new h.TextPlainMimeFactory.TextPlainMime(JSON.parse(this.mime_type_data))},c.prototype.is_mime_type_image=function(){return!(k.isUndefined(this.get("mime_type"))||k.isNull(this.get("mime_type")))&&-1!=this.get("mime_type").indexOf("image/")},c.prototype.is_text=function(){return 1===h.getMimeType(this.get("mime_type"))||6===h.getMimeType(this.get("mime_type"))},c.prototype.is_image=function(){return this.get("content_type")==i.Content_Type.image||this.is_mime_type_image()},c.prototype.is_youtube=function(){return 4===h.getMimeType(this.get("mime_type"))},c.prototype.is_flickr=function(){return 9===h.getMimeType(this.get("mime_type"))},c.prototype.is_vimeo=function(){return 8===h.getMimeType(this.get("mime_type"))},c.prototype.is_deezer=function(){return 14===h.getMimeType(this.get("mime_type"))},c.prototype.is_soundcloud=function(){return 10===h.getMimeType(this.get("mime_type"))},c.prototype.is_migmelink=function(){return 11===h.getMimeType(this.get("mime_type"))},c.prototype.is_server_message=function(){return this.source===this.destination},c.prototype.set_message_status=function(a){a>this.message_status&&this.set("message_status",a)},c.prototype.retry_send=function(){},c.prototype.send_received_status=function(){var a=this;if(this.message_status===d.config.MessageStatus.sent_ok&&!this.is_own_message){var b=e.create_packet(l.SET_MESSAGE_EVENT);b.add_field("messagetype",this.message_type),b.add_field("messagesource",this.source),b.add_field("messagedestinationtype",this.chatroom_type),b.add_field("messagedestination",this.destination),b.add_field("messageguid",this.message_id),b.add_field("messageeventtype",d.config.MessageStatus.received),b.add_field("eventsourceserver",0),b.add_field("messagetimestamp",this.timestamp),b.on("response",function(){a.set_message_status(d.config.MessageStatus.received)}),this.status_packet_queue.add_packet(b)}},c}(c.MigModel);b.ChatMessage=n,n.prototype.idAttribute="message_id";var o=function(a){function b(){a.apply(this,arguments),this.model=n}return __extends(b,a),b.prototype.comparator=function(a){return a.get("time")},b.prototype.next=function(a){var b=this.indexOf(a);return 0>b||b>=this.length-1?null:this.at(b+1)},b.prototype.prev=function(a){var b=this.indexOf(a);return 1>b?null:this.at(b-1)},b}(Backbone.Collection);b.ChatMessagesCollection=o}),define("modules/common/mime_types_parser",["require","exports","../model/mimetypes/mime_types","../chat/config/config_ts"],function(a,b,c,d){function e(a,d){"undefined"==typeof d&&(d=0);var e=[],f=c.TextPlainMimeFactory.TextPlainMime,g=c.EventMimeFactory.EventMime,h=c.DeezerMimeFactory.DeezerMime;if(a.body||"reshare"===a.originality_text||"reply"===a.originality_text){var j,k,l,m,n,r="text/plain",s=q.parseHTML(a.body);if(s&&p.isString(s.toString())){var t=s.toString();if(t.match(/(deezer)/i))if(t.match(w))n=a.body.match(w)[0],k=n.split("deezer/")[1].split("?")[0],l=k.split("/")[0],m=k.split("/")[1],"track"==l.toLowerCase()&&(l="tracks"),"mixes"==l.toLowerCase()&&(l="radio"),"radio"!=l.toLowerCase()&&"mixes"!=l.toLowerCase()||(m=l+"-"+m),r="application/vnd.migme.deezer",j=new h({id:m,type:l,text:a.body});else if(t.match(x)){n=t.match(x)[0];var u=x.exec(n);l=u[1],"track"==l.toLowerCase()?(l="tracks",m=u[4]):"radio"==l.toLowerCase()||"mixes"==l.toLowerCase()?"genre"==u[3].toLowerCase()?m="radio-"+u[4]:"artist"==u[2].toLowerCase()&&(m="artist-"+u[4]):m=u[4],r="application/vnd.migme.deezer",j=new h({id:m,type:l,text:a.body})}}var v=a.body;"text/plain"==r&&(j=new f({text:v}));var y={};y[r]=j,e.push(y)}if(a.event){var z=a.event,A={},B=new g({icon_image:z.media.icon.size_999,title:z.title,application_title:z.application.title,application_url:z.application.view.ajax,application_custom_url:z.custom_url.ajax,action_button:z.template.action_button_title,thumbnail:z.media.image.size_120});A["application/vnd.migme.event"]=B,e.push(A)}if(a.media){var C=a.media,D=i(C,a.id,a);"application/vnd.migme.gift"===Object.keys(D[0])[0]?e=D:q.merge(e,D)}if(a.originality>1&&d>=0){var E={},F={};1!=d&&a.parent_post&&a.parent_post.id!=a.root_post.id?(a.parent_post.root_post=a.root_post,F["application/vnd.migme.parent_post"]=b.generate_post_mimedata(a.parent_post,o.posts.reshares.parent_level),e.push(F)):(E["application/vnd.migme.root"]=b.generate_post_mimedata(a.root_post),e.push(E))}return a.mimeData=e,a}function f(a){var d,e,f,g,h=c.GiftMimeFactory.GiftMime,i=c.StickerMimeFactory.StickerMime,j=c.TextPlainMimeFactory.TextPlainMime,k=c.YoutubeMimeFactory.YoutubeMime,l=c.YoutubeMimeFactory.YoutubeMime,m=c.DeezerMimeFactory.DeezerMime,o=c.SoundcloudMimeFactory.SoundcloudMime,p=c.FlickrMimeFactory.FlickrMime,q=c.ImageMimeFactory.ImageMime;if(!a.mimetype||"emote/gift"!==a.mimetype&&"application/vnd.migme.emote"!==a.mimetype&&"application/vnd.migme.gift"!==a.mimetype&&"application/vnd.migme.sticker"!==a.mimetype||(a.contenttype=n.Content_Type.emote),a.contenttype===n.Content_Type.text){var G,H,I=null,J="http://vimeo.com/moogaloop.swf?clip_id=";if(a.contentasstring.match(t)){G=a.contentasstring.match(t)[0];var K="http://www.youtube.com/v/";K+=G.split("v=")[1],a.mimetype="application/vnd.migme.youtube",d=new k({url:K,thumbnail_url:"",controls:"0",text:a.contentasstring.replace(t,"")})}else if(a.contentasstring.match(r))G=a.contentasstring.match(r)[0],a.mimetype="application/vnd.migme.youtube",d=new k({url:G,thumbnail_url:"",controls:"0",text:a.contentasstring.replace(r,"")});else if(a.contentasstring.match(s)){G=a.contentasstring.match(s)[0];var L="http://www.youtube.com/v/";L+=G.split("youtu.be/")[1],a.mimetype="application/vnd.migme.youtube",d=new k({url:L,thumbnail_url:"",controls:"0",text:a.contentasstring.replace(s,"")})}else if(a.contentasstring.match(u))G=a.contentasstring.match(u)[0],"/"==G.substr(-1)&&(G=G.substr(0,G.length-1)),J+=G.substr(G.lastIndexOf("/")+1),J+="&server=vimeo.com&color=00adef&fullscreen=1",a.mimetype="application/vnd.migme.vimeo",d=new l({url:J,thumbnail_url:"",text:a.contentasstring.replace(u,"")});else if(a.contentasstring.match(v))G=a.contentasstring.match(v)[0],"/"==G.substr(-1)&&(G=G.substr(0,G.length-1)),J+=G.substr(G.lastIndexOf("/")+1),J+="&server=vimeo.com&color=00adef&fullscreen=1",a.mimetype="application/vnd.migme.vimeo",d=new l({url:J,thumbnail_url:"",text:a.contentasstring.replace(v,"")});else if(a.contentasstring.match(w))G=a.contentasstring.match(w)[0],e=G.split("deezer/")[1].split("?")[0],f=e.split("/")[0],g=e.split("/")[1],"track"==f.toLowerCase()&&(f="tracks"),"radio"==f.toLowerCase()&&(g=f+"-"+g),a.mimetype="application/vnd.migme.deezer",d=new m({id:g,type:f,text:a.contentasstring.replace(w,"")});else if(a.contentasstring.match(x))G=a.contentasstring.match(x)[0],I=x.exec(G),f=I[1],"track"==f.toLowerCase()?(f="tracks",g=I[4]):"radio"==f.toLowerCase()?"genre"==I[3].toLowerCase()?g="radio-"+I[3]:"artist"==I[3].toLowerCase()&&(g="artist-"+I[3]):g=I[4],
a.mimetype="application/vnd.migme.deezer",d=new m({id:g,type:f,text:a.contentasstring.replace(x,"")});else if(a.contentasstring.match(y)){G=a.contentasstring.match(y)[0];var M="https://w.soundcloud.com/player/?visual=true&amp;url=";M+=G,a.mimetype="application/vnd.migme.soundcloud",d=new o({url:M,thumbnail_url:"",height:"auto",text:a.contentasstring.replace(y,"")})}else if(a.contentasstring.match(z))I=a.contentasstring.match(A)[0],H=I.split(".com/")[1],H=H.split("/show")[0],a.mimetype="application/vnd.migme.flickr",d=new p({url:H,thumbnail_url:"",text:a.contentasstring.replace(z,"")});else if(a.contentasstring.match(A)){H=a.contentasstring.match(A)[0],H=H.substring(0,H.indexOf("/in/")),"/"==H.substr(-1)&&(H=I.substr(0,I.length-1));var N=H.substr(H.lastIndexOf("/")+1);a.mimetype="image/jpeg",d=new q({id:"flickr-"+N,url:"http://web.mig.me/228/app/images/fancybox_loading.gif",text:a.contentasstring.replace(A,"")}),b.get_flickr_image_url(N,d)}else a.contentasstring.match(B)?(I=a.contentasstring.match(B),a.mimetype="image/jpeg",d=new q({url:I[0],text:a.contentasstring.replace(B,"")})):a.contentasstring.match(C)?(I=a.contentasstring.match(C),a.mimetype="image/jpeg",d=new q({url:I[0],text:a.contentasstring.replace(C,"")})):a.contentasstring.match(D)?(I=a.contentasstring.match(D),a.mimetype="image/jpeg",d=new q({url:I[0],text:a.contentasstring.replace(D,"")})):a.contentasstring.match(E)?(I=a.contentasstring.match(E),a.mimetype="image/"+I[1],d=new q({url:I[0],text:a.contentasstring.replace(E,"")})):a.contentasstring.match(F)?(I=a.contentasstring.match(F),a.mimetype="image/"+I[3],d=new q({url:I[0],text:a.contentasstring.replace(F,"")})):(a.mimetype="text/plain",a.hotkeys&&""!==a.hotkeys&&(a.mimetype="text/rtf"),d=new j({text:a.contentasstring,color:a.messagecolor}));a.mimetypedata=JSON.stringify(d.base_o)}return a.contenttype===n.Content_Type.emote&&(a.mimetype=a.mimetype?a.mimetype:"application/vnd.migme.emote","emote/gift"===a.mimetype&&(a.mimetype="application/vnd.migme.gift"),"application/vnd.migme.gift"===a.mimetype?d=new h(JSON.parse(a.mimetypedata)):"application/vnd.migme.sticker"===a.mimetype?d=new i(JSON.parse(a.mimetypedata)):1==a.emotecontenttype&&a.hotkeys&&""!==a.hotkeys?(a.mimetype="application/vnd.migme.sticker",d=new i({hotkey:a.hotkeys,text:a.contentasstring,color:a.messagecolor})):d=new j({text:a.contentasstring,color:a.messagecolor}),a.mimetypedata=JSON.stringify(d.base_o)),a}function g(a){var b=null;m(/\/|[color]/i,a);b.mimeType.push("text/plain"),b.mimeData.push({text:a})}function h(a){var b,c=null;if(b=m(/flickr\.com\/photos\/([@\w\-\_]+)\/(\d+)/i,a),null!==b&&null!==b[2]&&(c.mimeType.push("image/flickr"),c.mimeData.push({url:b[0],id:b[2]})),b=l(a),null!==b&&null!==b[1]){var d=this._execAll(/title=\"(\S+)\"/i,a),e=b[0];e[1]&&(e=d[1]);var f="link";null!==m(/(mig\.me)/i,a)&&(f="mig33"),c.mimeType.push("image/"+b[1]),c.mimeData.push({type:f,url:b[0],title:e[1]})}}function i(b,d,e){var f=[];if(b.photo){var g=b.photo;if(g){var h=g.type;switch("link"===h&&H.test(b.photo.url.original)&&(h="gift"),h){case"flickr":var i={};i["image/flickr"]={url:g.url},f.push(i);break;case"gift":var j=c.GiftMimeFactory.GiftMime,l={},m="application/vnd.migme.gift",n=e.body.match(/data-username="((\S)*)"/);n=n[1];var o=e.body.match(/&quot;(.*)&quot;$/);null!==o&&(o=o[1]);var p={name:"",type:"gift",hotkey:"",message:o,recipient:n,sender:e.author.username,url:g.url.original},q=new j(p);l[m]=q,f.push(l);break;case"mig33":case"link":var r={},s="jpeg",t="image/"+s;r[t]={url:g.url},f.push(r)}}}else if(b.video){var u=b.video;if(u){var v=u.type;switch(v){case"youtube":var w={};w["application/vnd.migme.youtube"]={thumbnail_url:u.thumbnail_url,url:u.url},f.push(w);break;case"flickr":var x={};x["application/vnd.migme.flickr"]={api_key:u.api_key,api_url:u.api_url,api_params:u.api_params,thumbnail_url:u.thumbnail_url,url:u.url},f.push(x);break;case"vimeo":var y={};y["application/vnd.migme.vimeo"]={video_url:u.video_url,thumbnail_url:u.thumbnail_url,url:u.url},f.push(y);break;case"soundcloud":var z={};z["application/vnd.migme.soundcloud"]={title:u.title,thumbnail_url:u.thumbnail_url,url:u.url},f.push(z)}}}else if(b.links){var A=b.links[0];if(A.url.match(G)){var B={},C=a("hbs!modules/template/mimetypes/partnerlink");B["application/vnd.migme.partnerlink"]={author:A.author,description:A.description,image:A.image,site_name:A.site_name,title:A.title,url:A.url,partnerURL:"http://www.hipwee.com",favicon:"/app/images/hipwee.png"},k(B["application/vnd.migme.partnerlink"],d,C),f.push(B)}else{var D={},E=a("hbs!modules/template/mimetypes/migmelink");D["application/vnd.migme.link"]={author:A.author,description:A.description,image:A.image,site_name:A.site_name,title:A.title,url:A.url},k(D["application/vnd.migme.link"],d,E),f.push(D)}}return f}function j(a,b){var c="c9ed1f026b0534f6884c333d1a7b5239",d="https://api.flickr.com/services/rest?method=flickr.photos.getSizes&api_key="+c+"&photo_id="+a+"&format=json&nojsoncallback=1";jQuery.ajax({url:d,success:function(b){"ok"===b.stat&&q.each(b.sizes.size,function(b,c){"Medium"===c.label&&q(".flickr-"+a).attr("src",c.source)})}})}function k(a,b,c){var d=q.ajax({url:"https://api.mig.me/meta?url="+a.url});d.done(function(d){a.sync=!0,a.image=d.meta["og:image"],a.url=d.url,a.title=d.title,a.description=d.meta["og:description"],a.title=d.title;var e=c(a);q("#post-"+b+" .post-meta").html(e)})}function l(a){return m(/https?\:\/\/[a-zA-Z0-9\-\.]+\.[a-zA-Z]{2,3}(?:\/\S*)?(?:[a-zA-Z0-9_])+\.((?:jpg|jpeg|gif|png))/i,a)}function m(a,b){var c;return c=a.exec(b)}var n=d.config,o=a("modules/common/config"),p=a("underscore"),q=a("jquery"),r=/(https?:\/\/)?([^\/]*\.)?youtube\.com\/v\/(\S*)/i,s=/(https?:\/\/)?([^\/]*\.)?youtu.be\/(\S*)/i,t=/(https?:\/\/)?([^\/]*\.)?youtube\.com\/watch\?([^]*&)?v=(\S*)/i,u=/(https?:\/\/)?([^\/]*\.)?vimeo\.com\/(\S*)/i,v=/(https?:\/\/)?([^\/]*\.)?vimeo\.com\/channels\/\w+(&[^]*)?\/(\S*)/i,w=/(https?:\/\/)?([^\/]*\.)?(mig\.me|qalab\.projectgoth\.com|migme\.stg\.projectgoth\.com)(\/share)?\/music\/deezer\/?(radio|playlist|album|track|charts)\/\w+(&[^]*)?(\S*)/i,x=/https?:\/\/?[^\/]*\.?deezer\.com\/?(radio|mixes|playlist|album|track|charts|artist)\/?((genre|artist)\/)?(\S*)/i,y=/(https?:\/\/)?([^\/]*\.)?soundcloud\.com\/\w+([\S]*)?(\/)?\w+([\S]*)?/i,z=/(https?:\/\/)?([^\/]*\.)?\w?(flickr\.com\/).+(\/show\/)(\S*)/i,A=/(https?:\/\/)?([^\/]*\.)?\w?(flickr\.com\/).+(\/in\/)(\S*)/i,B=/(https?:\/\/)?([^\/]*\.)?\w?(b-img\.cdn\.mig\.me\/)(\S*)/i,C=/(https?:\/\/)?([^\/]*\.)?\w?(images-staging\.mig33\.com)(\S*)/i,D=/(https?:\/\/)?([^\/]*\.)?\w?(b-img\.cdn\.alpha\.migbo\.projectgoth\.com\/)(\S*)/i,E=/data:image\/(\S*)/i,F=/(https?:\/\/)(\w+\.)+\w+\/.+\.(jpg|jpeg|gif|png)/i,G=/(https?:\/\/)?([^\/]*\.)?hipwee\.com(\/([^\/]+))+/i,H=/\/images\/emoticons\/virtualgifts\//;b.generate_post_mimedata=e,b.generate_chat_mimedata=f,b.parse_text=g,b.parse_photos=h,b.get_flickr_image_url=j}),define("modules/model/common/mig33_model",["underscore","backbone","modules/common/utility"],function(a,b,c){var d=b.Model.extend({fetch:function(a){var b,e=this;return a=a||{},this.currentPage=a.page||this.currentPage,b=d.__super__.fetch.apply(this,arguments),b.done(function(a){var b=c.parse_ajax_response(a);b.error?e.trigger("fetch:error",b):e.trigger("fetch:done",b)}),b.fail(function(a){e.trigger("fetch:fail",a)}),b.always(function(){e.trigger("fetch:complete")}),b}});return d}),define("modules/model/common/mig33_collection",["underscore","backbone","modules/mig33_app","modules/common/config","modules/common/utility"],function(a,b,c,d,e){function f(b){a.isUndefined(b)||b.__isMig33Collection||(b.original_sync||(b.original_sync=b.sync),b.sync=function(){return a.defer(function(){b.trigger("sync_start")}),b.original_sync.apply(b,arguments)},b.__isMig33Collection=!0)}var g=b.Collection.extend({currentPage:1,limit:33,constructor:function(a){b.Collection.apply(this,arguments),f(this)},fetch:function(a){var b,c=this;return a=a||{},this.currentPage=a.page||this.currentPage,b=g.__super__.fetch.apply(this,arguments),"undefined"!=typeof b&&(b.done(function(b){var d=e.parse_ajax_response(b);null===d||d.error?c.trigger("fetch:error",d):(d.more=a.more||!1,c.trigger("fetch:done",d))}),b.fail(function(a){c.trigger("fetch:fail",a)}),b.always(function(){c.trigger("fetch:complete")})),b},getPage:function(){return this.currentPage},setPage:function(a){this.currentPage=a},nextPage:function(){this.currentPage++},prevPage:function(){this.currentPage--},resetPage:function(){this.currentPage=1},setLimit:function(a){this.limit=a}},{prepareCollectionForExtraEvents:f});return g}),define("modules/model/post/reply_model",["underscore","backbone","modules/mig33_app","modules/common/config","modules/common/session_user","modules/common/utility","modules/model/common/mig33_model"],function(a,b,c,d,e,f,g){var h=g.extend({watchPost:function(){var a=this;f.send_event_to_ga("Post","Watch",a.get("id"));var b=$.ajax({type:"post",dataType:"json",url:d.urls.miniblog_api_url+"/watch/"+a.get("id")});return b.done(function(b){b&&(a.set("watcher_count",a.get("watcher_count")+1),a.set("num_watched_posts",a.get("num_watched_posts")+1),e.getInstance().set("num_watched_posts",e.getInstance().get("num_watched_posts")+1))}),b.fail(function(a,b,c){f.show_error(c)}),b},unwatchPost:function(){var a=this;f.send_event_to_ga("Post","Unwatch",a.get("id"));var b=$.ajax({type:"delete",dataType:"json",url:d.urls.miniblog_api_url+"/unwatch/"+a.get("id")});return b.done(function(b){b&&(a.set("watcher_count",a.get("watcher_count")-1),a.set("num_watched_posts",a.get("num_watched_posts")-1),e.getInstance().set("num_watched_posts",e.getInstance().get("num_watched_posts")-1))}),b.fail(function(a,b,c){f.show_error(c)}),b},reportPost:function(){f.send_event_to_ga("Post","Report");var a=this,b=$.ajax({type:"post",dataType:"json",url:d.urls.miniblog_api_url+"/report/"+a.get("id")});return b.fail(function(a,b,c){f.show_error(c)}),b},deleteReply:function(){f.send_event_to_ga("Post","Delete Reply");var a=this,b=$.ajax({type:"delete",dataType:"json",url:d.urls.miniblog_api_url+"/delete/"+a.get("id")});return b.fail(function(a,b,c){f.show_error(c)}),b}});return h}),define("modules/model/post/reply_collection",["underscore","backbone","modules/model/common/mig33_collection","modules/common/config","modules/model/post/reply_model"],function(a,b,c,d,e){var f=c.extend({model:e,currentPage:1,parentId:null,nestedRepliesLimit:d.posts.replies.homefeed_first_limit,comparator:function(a){var b="desc"==this.sort_order?-a.get("timestamp"):a.get("timestamp");return b},url:function(){return d.urls.replies_url+"/"+this.parentId+"/"+this.currentPage+"/"+this.limit+"/"+this.nestedRepliesLimit},initialize:function(){this.sort_order="desc"},parse:function(b){if(b.data&&!a.isUndefined(b.data.replies)&&null!==b.data.replies){var c=b.data.replies,d=b.data.post?b.data.post:null;if(c.length>0)for(var e=0;e<c.length;e++)c[e].parent_post=d;return c}return b},reverse:function(){this.sort_order=this.sort_order="asc",this.sort()},setParentId:function(a){this.parentId=a}});return f}),define("modules/model/post/reshare_model",["underscore","backbone","modules/mig33_app","modules/common/config","modules/common/utility","modules/model/common/mig33_model"],function(a,b,c,d,e,f){var g=f.extend({});return g}),define("modules/model/post/reshare_collection",["underscore","backbone","modules/model/common/mig33_collection","modules/common/config","modules/model/post/reshare_model"],function(a,b,c,d,e){var f=c.extend({model:e,currentPage:1,parentId:null,comparator:function(a){return-a.get("timestamp")},url:function(){return d.urls.reshares_url+"/"+this.parentId+"/"+this.currentPage+"/"+this.limit},initialize:function(){},parse:function(b){if(b.data&&!a.isUndefined(b.data.reshares)&&null!==b.data.reshares){var c=b.data.reshares,d=b.data.post?b.data.post:null;if(c.length>0)for(var e=0;e<c.length;e++)c[e].parent_post=d;return c}return b},setParentId:function(a){this.parentId=a}});return f}),define("modules/model/post/post_model",["underscore","backbone","modules/common/config","modules/common/utility","modules/common/mime_types_parser","modules/common/session_user","modules/model/common/mig33_model","modules/model/post/reply_collection","modules/model/post/reshare_collection","modules/model/mimetypes/mime_types"],function(a,b,c,d,e,f,g,h,i,j){var k=g.extend({repliesLimit:0,resharesLimit:0,efLimit:0,replies:null,reshares:null,data:null,initialize:function(){null===this.replies&&(this.replies=new h),null===this.reshares&&(this.reshares=new i)},setRepliesLimit:function(a){this.repliesLimit=a},setResharesLimit:function(a){this.resharesLimit=a},setEfLimit:function(a){this.efLimit=a},parse:function(a){if(a.data){var b=!1;""===a.data.mimeData||"undefined"==typeof a.data.mimeData?a.data=e.generate_post_mimedata(a.data):(a.data.mimeData=$.parseJSON(a.data.mimeData),Object.keys(a.data.mimeData[0]).forEach(function(a){j.getMimeType(a)||(b=!0)}),b&&(a.data=e.generate_post_mimedata(a.data))),this.data=a.data}else{if(this.replies=new h,a.replies&&a.replies.length>0){for(var c=a.replies,d=0;d<c.length;d++)c[d].parent_post=a;this.replies.reset(c)}if(this.reshares=new i,a.reshares&&a.reshares.length>0){for(var f=a.reshares,g=0;g<f.length;g++)f[g].parent_post=a;this.reshares.reset(f)}""!==a.mimeData&&"undefined"!=typeof a.mimeData||(a=e.generate_post_mimedata(a)),this.data=a}return this.data},url:function(){return c.urls.single_post_url+"/"+this.get("id")+"/"+this.repliesLimit+"/"+this.resharesLimit},watchPost:function(){var a=this;d.send_event_to_ga("Post","Watch",a.get("id"));var b=$.ajax({type:"post",dataType:"json",url:c.urls.miniblog_api_url+"/watch/"+a.get("id")});return b.done(function(b){b&&(a.set("watcher_count",a.get("watcher_count")+1),a.set("num_watched_posts",a.get("num_watched_posts")+1),f.getInstance().set("num_watched_posts",f.getInstance().get("num_watched_posts")+1))}),b.fail(function(a,b,c){d.show_error(c)}),b},unwatchPost:function(){var a=this;d.send_event_to_ga("Post","Unwatch",a.get("id"));var b=$.ajax({type:"delete",dataType:"json",url:c.urls.miniblog_api_url+"/unwatch/"+a.get("id")});return b.done(function(b){b&&(a.set("watcher_count",a.get("watcher_count")-1),a.set("num_watched_posts",a.get("num_watched_posts")-1),f.getInstance().set("num_watched_posts",f.getInstance().get("num_watched_posts")-1))}),b.fail(function(a,b,c){d.show_error(c)}),b},reportPost:function(){d.send_event_to_ga("Post","Report");var a=this,b=$.ajax({type:"post",dataType:"json",url:c.urls.miniblog_api_url+"/report/"+a.get("id")});return b.fail(function(a,b,c){d.show_error(c)}),b},setReplyPermission:function(a){d.send_event_to_ga("Post","Reply Permission",a);var b=this,e=$.ajax({type:"post",dataType:"json",url:c.urls.miniblog_api_url+"/replies_permission/"+b.get("id")+"/"+a}),f=1===a?"lock":"unlock";return e.done(function(c){c=d.parse_ajax_response(c),c?(b.set("reply_permission",a),d.show_success(d.translate("post|success_"+f))):d.show_error(d.translate("post|error_"+f))}),e.fail(function(a,b,c){d.show_error(c)}),e},deletePost:function(){d.send_event_to_ga("Post","Delete");var a=this,b=$.ajax({type:"delete",dataType:"json",url:c.urls.miniblog_api_url+"/delete/"+a.get("id")});return b.done(function(){var b=require("modules/mig33_app");b.vent.trigger(b.ApplicationEvents.POST_DELETED,a)}),b.fail(function(a,b,c){d.show_error(c)}),b},tagPost:function(a,b){d.send_event_to_ga("Post","Tag "+a,b);var e=this,f=$.ajax({type:"post",dataType:"json",url:c.urls.miniblog_api_url+"/tag_post/"+a+"/"+e.get("id")+"/"+b});return f.done(function(a){if(a=d.parse_ajax_response(a)){e.set("tag_entity",a);var b=require("modules/mig33_app");b.vent.trigger(b.ApplicationEvents.POST_EF_ADDED,a)}}),f.fail(function(){d.show_error(d.translate("post|error_tag"))}),f},getReplies:function(){return this.replies},getReshares:function(){return this.reshares}});return k}),define("modules/model/post/post_collection",["modules/model/common/mig33_collection","modules/mig33_app","modules/common/config","modules/model/post/post_model","backbone"],function(a,b,c,d){var e=a.extend({model:d,initialize:function(){},url:function(){return c.urls.home_feed_url+"/"+this.currentPage+"/"+c.variable.limit+"/"+c.posts.replies.homefeed_limit+"/"+c.posts.reshares.homefeed_limit},comparator:function(a){return-a.get("timestamp")}});return e}),define("modules/model/user/user_model",["underscore","modules/model/common/mig33_model","modules/mig33_app","modules/common/config","modules/common/utility","modules/model/post/post_collection"],function(a,b,c,d,e,f){var g=b.extend({initialize:function(){var a=this;this.profile_feed=new f,this.profile_feed.url=function(){return d.urls.profile_feed_url+"/"+a.get("id")+"/"+a.profile_feed.currentPage+"/"+d.variable.limit+"/"+d.posts.replies.homefeed_limit+"/"+d.posts.reshares.homefeed_limit}},url:function(){return this.get("id")?d.urls.profile_url+"/"+this.get("id")+"?use_userid=1":d.urls.profile_url+"/"+this.get("username").replace("touch/","")},isAlreadyFollowing:function(){var a=this.get("relationship");return a.is_follower},follow:function(){if(!e.is_logged_in())return null;e.send_event_to_ga("User","Follow");var b=this,c=$.ajax({type:"post",cache:!1,dataType:"json",url:d.urls.miniblog_api_url+"/follow/"+parseInt(b.get("id"),10),success:function(c){if(c=e.parse_ajax_response(c),c.error)e.show_error(e.translate(c.error,b.get("username")));else{var d=b.get("relationship"),f={};a.extend(f,d),f.is_follower=!0,b.set({num_followers:b.get("num_followers")+1,relationship:f});var g=require("modules/common/session_user");g&&g.getInstance().set({num_following:g.getInstance().get("num_following")+1}),e.show_success(e.translate(c.success,b.get("username")))}},error:function(){e.show_error(e.translate("user|follow_error",b.get("username")))}});return c},unfollow:function(){if(!e.is_logged_in())return null;e.send_event_to_ga("User","Unfollow");var b=this;return $.ajax({type:"post",cache:!1,dataType:"json",url:d.urls.miniblog_api_url+"/unfollow/"+parseInt(b.get("id"),10),success:function(c){if(c=e.parse_ajax_response(c),c.error)e.show_error(e.translate(c.error,b.get("username")));else{var d=b.get("relationship"),f={};a.extend(f,d),f.is_follower=!1,b.set({num_followers:b.get("num_followers")-1,relationship:f});var g=require("modules/common/session_user");g&&g.getInstance().set({num_following:g.getInstance().get("num_following")-1}),e.show_success(e.translate(c.success,b.get("username")))}},error:function(){e.show_error(e.translate("user|unfollow_error",b.get("username")))}})},block:function(){if(e.is_logged_in()){var b=this;window.confirm(e.translate("user|confirm_block",b.get("username")))&&(e.send_event_to_ga("User","Block"),$.ajax({type:"post",cache:!1,dataType:"json",url:d.urls.miniblog_api_url+"/block_user/"+parseInt(b.get("id"),10),success:function(c){if(c=e.parse_ajax_response(c),c.error)e.show_error(e.translate("user|block_error",b.get("username")));else{var d=b.get("relationship"),f={};a.extend(f,d),f.is_blocked_by=!0,b.set("relationship",f),e.show_success(e.translate("user|block_successful",b.get("username")))}},error:function(){e.show_error(e.translate("user|block_error",this.get("username")))}}))}},unblock:function(){if(e.is_logged_in()){e.send_event_to_ga("User","Unblock");var b=this;$.ajax({type:"post",cache:!1,dataType:"json",url:d.urls.miniblog_api_url+"/unblock_user/"+parseInt(b.get("id"),10),success:function(c){if(c=e.parse_ajax_response(c),c.error)e.show_error(e.translate("user|unblock_error",b.get("username")));else{var d=b.get("relationship"),f={};a.extend(f,d),f.is_blocked_by=!1,b.set("relationship",f),e.show_success(e.translate("user|unblock_successful",b.get("username")))}},error:function(){e.show_error(e.translate("user|unblock_error",b.get("username")))}})}},mention:function(){var a=this;e.is_logged_in()&&a.get("username")},addFavoriteGift:function(a,b){var c=this,f=b.hasOwnProperty("itemId")?String(b.itemId):"",g={data:[{userFavoriteType:a,userFavorite:f}]},h=JSON.stringify(g),i=$.ajax({type:"post",contentType:"application/json",dataType:"json",url:e.format(d.urls.add_gift_favorite,c.get("id")),data:h});i.done(function(a){var b=e.parse_ajax_response(a);b.status="add",b.error?c.trigger("fetch:error",b):c.trigger("favourite:gift",b)})},removeFavoriteGift:function(a,b){var c=this,f=b.hasOwnProperty("itemId")?String(b.itemId):"",g={data:[{userFavoriteType:a,userFavorite:f}]},h=JSON.stringify(g),i=$.ajax({type:"post",contentType:"application/json",dataType:"json",url:e.format(d.urls.remove_gift_favorite,c.get("id")),data:h});i.done(function(a){var b=e.parse_ajax_response(a);b.status="remove",b.error?c.trigger("fetch:error",b):c.trigger("favourite:gift",b)})}});return g});var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};define("modules/chat/models/chats",["require","exports","../../common/image_optimizer","./model","../data/ftransport","../fusion/fpacket","../fusion/fpacket_defs","./chat_packet_handler","./contacts","../config/config_ts","./user_session","./chatmessages","../../model/mimetypes/mime_types","modules/export_marionette","backbone.marionette","underscore","jquery","backbone","modules/common/local_storage","modules/common/utility","modules/common/config","modules/common/mime_types_parser","modules/model/user/user_model"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){function n(a,b){return[a,b].join("_").replace(".","_").replace("@","_")}var o=j.config,p=e.Transport.getInstance(),q=a("modules/common/local_storage"),r=a("modules/common/utility"),s=a("modules/common/mime_types_parser"),t=a("underscore"),u=(i.ContactGroupStore.getInstance(),a("modules/common/session_user")),v=30,w=function(b){function d(c){b.call(this,c),this.participants=[],this.admins=[],this.unread_message_count=0,this.messages=new l.ChatMessagesCollection,this.initialization_time=Date.now();var d=a("modules/chat/models/user_session"),e=d.Session.getInstance();this.session_user=e.get("session_user"),this.emoticons=e.emoticon_hotkeys.join(" "),this.user_owned=this.session_user===this.get("createdBy"),this.is_group_chat()||this.is_chat_room()||(this.participants.push(this.session_user),this.participants.push(this.get("destinationName"))),this.messages.on("add",this.after_message_added,this),this.chat_digest=null,this.load_last_stored_message(),this.setup_subscribed_packets()}return __extends(d,b),Object.defineProperty(d.prototype,"chatHandle",{get:function(){return this.get("chatHandle")},enumerable:!0,configurable:!0}),d.prototype.setParticipants=function(a){this.participants=t.compact(a),this.trigger("participant_added",this.participants)},d.prototype.getUserDetails=function(){var b,c=this,d=a("modules/mig33_app"),e=a("modules/model/user/user_model");if(this.is_private_chat()&&this.is_fusion_chat())if(b=this.get("destination"),d.cache.user[b])this.trigger("user_details",d.cache.user[b]);else{var f=new e({username:b});f.fetch(),f.on("change",function(){c.trigger("user_details",d.cache.user[b])}),d.cache.user[b]=f}},d.prototype.setup_subscribed_packets=function(){this.registerPacketHandler(new h.ParticipantsPacketHandler(this))},d.prototype.is_group_chat=function(){return this.get("destinationType")==o.DestinationType.group},d.prototype.is_chat_room=function(){return!1},d.prototype.is_fusion_chat=function(){var a=this.is_chat_room()||this.is_group_chat();return a||(a=this.get("messageType")==o.getMessageType(o.IM_Type.fusion)),a},d.prototype.is_private_chat=function(){return!this.is_chat_room()&&!this.is_group_chat()},d.prototype.is_admin=function(a){return!1},d.prototype.add_admin=function(a){},d.prototype.get_unread_message_count=function(){return this.unread_message_count},d.prototype.had_unread_messages=function(){return this.unread_message_count>0},d.prototype.getSortOrder=function(){return this.getLatestTimeFromServer()},d.prototype.getLatestTimeFromServer=function(){return this.get("timestampFromServer")},d.prototype.setLatestTimeFromServer=function(a){this.set("timestampFromServer",a),this.trigger("chat_became_latest")},d.prototype.getDigestMessageString=function(){var a=this.chat_digest?this.chat_digest.message:"",b=this.chat_digest?this.chat_digest.message_timestamp:null,c=this.getLastMessage()?this.getLastMessage().timestamp:null;return c>b?this.getLastMessage().message:b?a:r.translate("chat|default_chat_message_text")},d.prototype.getDigestMessgeTimeStamp=function(){var a=this.chat_digest?this.chat_digest.message_timestamp:null,b=this.getLastMessage()?this.getLastMessage().timestamp:null;return b>a?b:a?a:this.getLatestTimeFromServer()},d.prototype.setDigest=function(a){this.chat_digest=a,this.trigger("digest_change")},d.prototype.count_unread_messages=function(){for(var a=0,b=this.messages.last();b&&!b.get("isRead");)a++,b=this.get_prev_message(b);return this.unread_message_count=a,this.trigger("unread_message_count_changed"),this.unread_message_count},d.prototype.hasParticipant=function(a){return t.contains(this.participants,a)},d.prototype.addParticipantsByUsername=function(a){var b,c=this;if(a&&0!==a.length){if(1===a.length)return void this.addParticipant(a[0]);this.is_group_chat()?(b=f.create_packet(g.FUSION_PACKET_TYPES.GROUP_CHAT_INVITE),b.add_field("groupchatid",this.get("destination")),b.add_field("usernames","web:"+a.join(","))):(b=f.create_packet(g.FUSION_PACKET_TYPES.CREATE_GROUP_CHAT),b.add_field("participant",this.get("destination")),b.add_field("otherpartylist","web:"+a.join(","))),b.on("error",function(a){var b=a.response_packet,d=b.get_error_message();c.trigger("chat_invite_failed",d)}),this.send_packet(b)}},d.prototype.addParticipants=function(a){var b=[];if(a&&0!==a.length){if(1===a.length)return void this.addParticipant(a[0].getDisplayName());t.each(a,function(a){b.push(a.getDisplayName())},this),this.addParticipantsByUsername(b)}},d.prototype.addParticipant=function(a){var b,c=this;this.is_group_chat()?(b=f.create_packet(g.FUSION_PACKET_TYPES.GROUP_CHAT_INVITE),b.add_field("groupchatid",this.get("destination")),b.add_field("username",a)):(b=f.create_packet(g.FUSION_PACKET_TYPES.CREATE_GROUP_CHAT),b.add_field("participant",this.get("destination")),b.add_field("inviteduser",a)),b.on("error",function(a){var b=a.response_packet,d=b.get_error_message();c.trigger("chat_invite_failed",d)}),this.send_packet(b)},d.prototype.getParticipants=function(a){return"undefined"==typeof a&&(a=!1),a&&this.is_group_chat()&&this.request_group_chat_participant(),this.participants},d.prototype.add_participant=function(a,b){"undefined"==typeof b&&(b=!1),a=$.trim(a),!t.contains(this.participants,a)&&a&&(this.participants.push(a),b&&this.add_admin(a),this.trigger("participant_added",a))},d.prototype.remove_participant=function(a){a=$.trim(a),this.participants=t.without(this.participants,a),this.trigger("participant_added",a)},d.prototype.getUserListAsString=function(){return this.participants.join(", ")||this.participants.length+" Participants"},d.prototype.getParticipantCount=function(){return this.participants.length+1},d.prototype.isDuplicateMessage=function(a){return this.isDuplicateMessageId(a)&&this.isDuplicateMessageContent(a)},d.prototype.isDuplicateMessageId=function(a){var b=this.messages,c=b.get(a.message_id),d=!1;return c&&(d=!0),d},d.prototype.isDuplicateMessageContent=function(a){var b=this.messages,c=/^data:image\/(\w+)/i,d=b.get(a.message_id);return d?d.get("message").match(c)?!0:d.get("message")===a.message:!1},d.prototype.add_chat_message=function(a){var b=0,c=this.messages,d=null;if(!a.message_id||this.isDuplicateMessageId(a)&&!this.isDuplicateMessageContent(a)?a.message_id=Date.now().toString():this.isDuplicateMessage(a)&&(this.setMessageStatus(a.message_id,a.message_status),d=c.get(a.message_id)),1===a.pinnedType){var e=new Date;a.message_id=a.message_id+"_pinned"+e.getTime()}return c.add(a),d||(d=c.get(a.message_id)),d.get("isRead")||(b=this.get_last_read_message_timestamp(),d.set("isRead",b>=d.get("timestamp"))),this.check_and_bump_chat(),this.count_unread_messages(),d},d.prototype.check_and_bump_chat=function(){var a=10,b=this.getLatestTimeFromServer(),c=this.messages.last();if(c){var d=c.get("timestamp");d-b>a&&this.setLatestTimeFromServer(d)}},d.prototype.setJoinedState=function(a,b){"undefined"==typeof b&&(b=!1),this.set("hasJoined",a),b||(a?this.trigger("chatroom_joined",this,b):this.trigger("chatroom_left",this))},d.prototype.leave_chatroom=function(){var a,b=this,c=this;if(this.messages.reset([]),this.is_group_chat())a=f.create_packet(g.FUSION_PACKET_TYPES.LEAVE_GROUP_CHAT),a.add_field("groupchatid",this.get("destination")),a.add_field("imtype",this.get("messageType"));else{if(!this.is_fusion_chat())return void c.set({hasJoined:!1});a=f.create_packet(g.FUSION_PACKET_TYPES.LEAVE_PRIVATE_CHAT),a.add_field("destinationusername",this.get("destination")),a.add_field("imtype",this.get("messageType"))}a.on("response",function(){c.set({hasJoined:!1}),b.trigger("chat_left")}),this.send_packet(a)},d.prototype.get_popular_gifts=function(){},d.prototype.get_prev_message=function(a){return this.messages.prev(a)},d.prototype.get_next_message=function(a){return this.messages.next(a)},d.prototype.get_last_read_message_id=function(){var a=q.get("last_read_message_"+this.get("chatHandle"));return a?a.message_id:null},d.prototype.get_last_read_message_timestamp=function(){return q.get("last_read_message_ts_"+this.get("chatHandle"))},d.prototype.set_last_read_message=function(a){this.set_message_as_read(a);var b=parseInt(a.get("timestamp"),10),c=this.get_last_read_message_timestamp();b>c&&(q.set("last_read_message_"+this.get("chatHandle"),a),q.set("last_read_message_ts_"+this.get("chatHandle"),a.get("timestamp"))),this.count_unread_messages()},d.prototype.set_message_as_read=function(a){a&&!a.get("isRead")&&(a.set("isRead",!0),this.set_message_as_read(this.get_prev_message(a)))},d.prototype.request_group_chat_participant=function(){var a=f.create_packet(g.FUSION_PACKET_TYPES.GET_GROUP_CHAT_PARTICIPANTS);a.add_field("groupchatid",this.get("destination")),a.add_field("imtype",this.get("messageType")),this.send_packet(a)},d.prototype.rename_chat=function(a){if(a=$.trim(a),this.is_group_chat()&&""!==a&&this.getTitle()!==a){var b=f.create_packet(g.FUSION_PACKET_TYPES.SET_CHAT_NAME);b.add_field("chatidentifier",this.get("destination")),b.add_field("chatname",a),b.add_field("chattype",this.get("destinationType")),this.send_packet(b),this.set("destinationName",a)}},d.prototype.load_last_stored_message=function(){},d.prototype.load_last_stored_message_time=function(){return q.get("last_message_time_"+this.get("chatHandle"))},d.prototype.save_last_stored_message_time=function(a){q.set("last_message_time_"+this.get("chatHandle"),a)},d.prototype.is_chat_synched=function(){var b=a("modules/chat/models/user_session"),c=b.Session.getInstance(),d=1e4,e=q.get("timestamp_from_server_"+this.get("chatHandle"));if(!e)return!0;var f=this.load_last_stored_message_time();return c.isChatSyncReady()?!1:f?(e=parseInt(e,10),f=parseInt(f,10),f>=e-d):(this.save_last_stored_message_time(e),!0)},d.prototype.after_message_added=function(a){a.pinnedType&&1===a.pinnedType&&(this.trigger("pin_chat",a),a.pinnedType=1),this.trigger("chat_message_added",a),this.store_last_message_reference(),this.is_private_chat()&&a.send_received_status()},d.prototype.store_last_message_reference=function(){},d.prototype.getInitializationTime=function(){return this.initialization_time},d.prototype.getLastMessage=function(){return this.messages.last()},d.prototype.getFirstMessage=function(){return this.messages.first()},d.prototype.getMessages=function(){return this.messages},d.prototype.fetchRecentMessages=function(){this.fetchMessages()},d.prototype.fetchPreviousMessages=function(){this.fetchMessages()},d.prototype.is_next_message_contiguous=function(a){var b=this.get_next_message(a);return a.is_live_message||!b||b.is_live_message||this.is_prev_message_contiguous(b)},d.prototype.is_prev_message_contiguous=function(a){if(a.is_live_message||!a.get("previous_message_id"))return!0;
var b=a.get("previous_message_id");return!t.isEmpty(this.messages.get(b))},d.prototype.fetchMessages=function(b,c,d){var e,h=this;if(this.get("destinationType")){var i=a("modules/chat/models/user_session"),j=i.Session.getInstance(),k=d||v;c=c||j.get_aproximated_server_time(),b=b||0;var l=f.create_packet(g.FUSION_PACKET_TYPES.GET_MESSAGES),m=$.Deferred();this.trigger("fetch_messages_start"),l.on("response",function(a){this.trigger("fetch_messages_success"),this.trigger("fetch_messages_stop"),f.isPacketType(a.response_packet,g.FUSION_PACKET_TYPES.END_MESSAGES)&&m.resolve(a.response_packet)},this),l.on("error",function(a){this.trigger("fetch_messages_error"),this.trigger("fetch_messages_stop"),m.reject(a.response_packet)},this),l.on("send_failed",function(){h.trigger("fetch_messages_error"),h.trigger("fetch_messages_stop")}),l.add_field("chatidentifier",this.get("destination")),l.add_field("chattype",this.get("destinationType")),l.add_field("limit",k),l.add_field("latestmessagetimestamp",c),l.add_field("oldestmessagetimestamp",b),this.send_packet(l),e=m.promise()}return e},d.prototype.getTitle=function(){return this.is_group_chat()?this.get("destinationName")&&""!==this.get("destinationName")?this.get("destinationName"):this.participants.join(", ")||"Group Chat":this.get("destinationName")},d.prototype.invoke_activate_event=function(){this.trigger("chat_activate")},d.prototype.setMessageStatus=function(a,b){var c=this.messages.get(a);c&&c.set_message_status(b)},d.prototype.addTextMessageToStore=function(b,c){var d=a("modules/chat/models/user_session"),e=d.Session.getInstance(),f=e.get_aproximated_server_time(),g={message:b,message_id:Date.now().toString(),source:this.session_user,content_type:o.Content_Type.text,message_type:this.get("messageType"),admin_message:!1,allowed_emoticons:"",emoticons:e.emoticon_hotkeys.join(" "),source_colour:"",message_colour:c?parseInt("0x30aa00",10).toString():"",chatroom_type:this.get("destinationType"),chatroom_identifier:this.get("chatHandle"),destination:this.get("destination"),inSync:!1,time:new Date(f),pinnedType:0,timestamp:f,is_live_message:!0,is_own_message:!0,message_status:j.config.MessageStatus.unknown,mime_type:null,mime_type_data:null};return this.add_chat_message(g)},d.prototype.uploadFile=function(b,c){var d=a("modules/common/config"),e=new FormData;e.append("coverphoto",b,"image.jpg");var f=$.ajax({type:"post",cache:!1,contentType:!1,processData:!1,dataType:"json",url:r.format(d.urls.user_file_upload,u.getInstance().get("id")),data:b,xhr:function(){var a=$.ajaxSettings.xhr();return a.upload&&a.upload.addEventListener("progress",function(a){if(a.lengthComputable){Math.floor(100*a.loaded/a.total)-Math.floor(10*Math.random())}},!1),a}});return f},d.prototype.add_message_and_send_packet=function(a,b){var c=this,d=a.get_field_value("contentasstring");a.on(f.packet_events.ok,function(a){var b=a.response_packet,d=b.toObject(),e=d.serverresponse;d.servertime;t.delay(function(){c.setMessageStatus(e,j.config.MessageStatus.sent_ok)},1e3)}),a.on(f.packet_events.error,function(a){var b=a.response_packet,e="Failed to send the message - "+d,f=b.get_error_message()||e;c.addTextMessageToStore(f,!0)}),b?(b.done(function(b){c.send_packet(a)}),b.fail(function(a,b,c){console.warn(["upload not done",a,b,c])})):this.send_packet(a);var e="/"==d.charAt(0);e||p.broadcast_response([a.to_packet_json()])},d.prototype.addUserImageMessage=function(b){var d=this,e=a("modules/chat/models/user_session"),h=e.Session.getInstance(),i=c.ImageOptimizer.getInstance(),j=i.optimize(b,c.ImageOptimizer.DEFAULT_MAX_WIDTH,c.ImageOptimizer.DEFAULT_MAX_HEIGHT,c.ImageOptimizer.MIME_TYPE_JPG);j.done(function(a){var b,e,i,j,k=f.create_packet(g.FUSION_PACKET_TYPES.MESSAGE),l=r.get_guid(),n=h.get_aproximated_server_time(),p=new m.ImageMimeFactory.ImageMime({id:"",url:a.base64,width:a.width,height:a.height,thumbnailUrl:a.base64,text:""});d.is_chat_room()?(b=o.DestinationType.public_chat,e=o.getMessageType(o.IM_Type.fusion),i=d.get("name"),j=null):(b=d.get("destinationType"),e=d.get("messageType"),i=d.get("destination"),j=d.get("contactId")),k.add_field("guid",l),k.add_field("messagetype",e),k.add_field("source",d.session_user),k.add_field("destinationtype",b),k.add_field("destination",i),k.add_field("contactid",j),k.add_field("timestamp",n),k.add_field("contenttype",o.Content_Type.text),k.add_field("contentasstring",a.base64),k.add_field("mimetype",c.ImageOptimizer.MIME_TYPE_JPG.mimetype),k.add_field("mimetypedata",p.toJSON());var q=a.base64,s=d.uploadFile(r.dataURItoBlob(q),c.ImageOptimizer.MIME_TYPE_JPG),t=d;s.done(function(a){p.thumbnailUrl=a.data.thumbnailUrl,p.url=a.data.url,k.add_field("mimetypedata",p.toJSON()),k.add_field("contentasstring",a.data.url),t.add_message_and_send_packet(k,s)}),s.fail(function(a,b,c){t.add_message_and_send_packet(k,s)})})},d.prototype.addUserTextMessage=function(b){var c,d,e,h,i=a("modules/chat/models/user_session"),j=i.Session.getInstance(),k=f.create_packet(g.FUSION_PACKET_TYPES.MESSAGE),l=r.get_guid();return this.is_chat_room()?(c=o.DestinationType.public_chat,d=o.getMessageType(o.IM_Type.fusion),e=this.get("name"),h=null):(c=this.get("destinationType"),d=this.get("messageType"),e=this.get("destination"),h=this.get("contactId")),k.add_field("guid",l),k.add_field("messagetype",d),k.add_field("source",this.session_user),k.add_field("destinationtype",c),k.add_field("destination",e),k.add_field("contactid",h),k.add_field("timestamp",j.get_aproximated_server_time()),k.add_field("contenttype",o.Content_Type.text),k.add_field("contentasstring",b),this.add_message_and_send_packet(k),k},d.prototype.display_pinitem=function(a,b){var c=f.create_packet(g.FUSION_PACKET_TYPES.GET_PINNED_MESSAGE);c.add_field("chatid",a),c.add_field("destinationtype",b),c.on("response",function(){console.log("successfully set request to get pinned item")}),c.on("error",function(a){console.log("failed to request for pinned item"+a)}),this.send_packet(c)},d}(d.MigModel);b.Chat=w,w.prototype.idAttribute="chatHandle";var x=function(a){function b(b){a.call(this,b),this.model=w}return __extends(b,a),b}(Backbone.Collection);b.ChatCollection=x;var y=function(b){function c(a){var d=this;if(b.call(this,a),c._instance)throw new Error("Chat Store instance already exist... use getInstance()");this.chats=new x,this.chats.on("add",function(a){d.trigger("chat_added",a),d.save_chats(),a.on("chat_left",function(){d.chats.remove(a),a.off("chat_left"),d.trigger("chat_left",a)});var b=d.message_digests[a.chatHandle];b&&a.setDigest(b)}),this.chats.on("update",function(a){d.trigger("chat_updated",a),d.save_chats()}),this.message_digests={},this.setup_subscribed_packets()}return __extends(c,b),c.parseMessageData=function(a,b){var c,d=a.toObject();d=s.generate_chat_mimedata(d);var e=parseInt(d.destinationtype,10),f=parseInt(d.messagetype,10),g=d.source,h=d.destination,l=d.contentasstring,m=d.contenttype,p=d.hotkeys,q=d.messagecolor,r=parseInt(d.pinnedType,10),u=d.sourcecolor,v=parseInt(d.timestamp,10),w=k.Session.getInstance().get_aproximated_server_time();v=v?v:w;var x=k.Session.getInstance().session_start_time<v,y=d.guid,z=parseInt(d.emotecontenttype,10),A=d.previousmessageguid,B=g,C=g==b;C&&t.isEmpty(p)&&(p=k.Session.getInstance().emoticon_hotkeys_all.join(" "));var c=parseInt(d.messageeventtype,10);isNaN(c)&&(c=C&&x?j.config.MessageStatus.sent:j.config.MessageStatus.sent_ok),e==o.DestinationType.individual?B=C?h:g:e==o.DestinationType.group&&(B=h);var D=n(e.toString(),B.toString());return{message:l,source:i.ContactGroupStore.getInstance().get_display_name_from_cache(g),content_type:m,content_data:null,message_type:f,message_status:c,admin_message:!1,allowed_emoticons:p,emoticons:p,source_colour:u,message_colour:q,chatroom_type:e,chatroom_identifier:D,destination:h,time:new Date(v),pinnedType:r,timestamp:v,inSync:!0,message_id:y,emote_type:z,previous_message_id:A,is_live_message:x,is_own_message:C,mime_type:d.mimetype,mime_type_data:d.mimetypedata}},c.getInstance=function(){return c._instance||(c._instance=new c),c._instance},c.prototype.setup_subscribed_packets=function(){this.registerPacketHandler(new h.ChatHandler(this)),this.registerPacketHandler(new h.ChatListVersionHandler(this)),this.registerPacketHandler(new h.FileRecievedHandler(this)),this.registerPacketHandler(new h.GroupChatHandler(this)),this.registerPacketHandler(new h.MessageHandler(this)),this.registerPacketHandler(new h.ChatUserStatusHandler(this)),this.registerPacketHandler(new h.MessageEventHandler(this)),this.registerPacketHandler(new h.MessageDigestHandler(this))},c.prototype.add_message_digests=function(a){var b=this;t.each(a,function(a,c){var d=b.computeChatHandle(a.chat_type,a.chat_id);b.message_digests[d]=a;var e=b.getChat(d);e&&e.setDigest(a)})},c.prototype.init=function(){var b=a("modules/chat/models/user_session"),c=b.Session.getInstance();c.on("session_created",this.getChats,this),this.save_chats=t.throttle(t.bind(this._save,this),500)},c.prototype.getChats=function(){var a=f.create_packet(g.FUSION_PACKET_TYPES.GET_CHATS);a.add_field("version",0),this.send_packet(a)},c.prototype._save=function(){var b=a("modules/chat/models/user_session"),c=b.Session.getInstance();c.set_user_data("chat_list",{chat_list_version:c.get("chat_list_version"),chats:this.chats.toJSON()})},c.prototype.startPrivateChat=function(a,b,c,d,e){c=c||o.IM_Type.fusion,d=d||b,e=e||!1;var f=o.getMessageType(c),g=o.DestinationType.individual,h=n(g.toString(),d.toString()),i=this.chats.get(h);return i||(this.chats.add({chatHandle:h,messageType:f,destinationType:g,destination:d,destinationName:b,createdBy:d,contactId:a,userInitiated:!0,timestampFromServer:Date.now()}),i=this.chats.get(h)),e!==!0&&this.trigger("user_initiated_chat",i),i},c.prototype.startGroupChat=function(a){var b=this;if(a&&0!==a.length){var c=a[0].getDisplayName();if(1===a.length)return this.startPrivateChat(a[0].get("contactId"),c);var d=[];t.each(a,function(a,b){0!==b&&d.push(a.getDisplayName())});var e=f.create_packet(g.FUSION_PACKET_TYPES.CREATE_GROUP_CHAT);e.add_field("participant",c),e.add_field("otherpartylist","web:"+d.join(",")),e.on("error",function(a){var c=a.response_packet,d=c.get_error_message();b.trigger("chat_invite_failed",d)}),this.send_packet(e)}},c.prototype.getOrCreateChat=function(a){var b=this.chats,c=b.get(a.chatHandle);return c||(b.add(a),c=b.get(a.chatHandle)),c},c.prototype.getChat=function(a){return this.chats.get(a)},c.prototype.handleMessageData=function(a,b){var c=this.getOrCreateChat(a);c.add_chat_message(b)},c.prototype.add_chat_participant=function(a,b,c){var d=n(o.ChatroomType.group.toString(),a),e=this.chats.get(d);e&&e.add_participant(b,c)},c.prototype.remove_chat_participant=function(a,b){var c=n(o.ChatroomType.group.toString(),a),d=this.chats.get(c);d&&d.remove_participant(b)},c.prototype.computeChatHandle=function(a,b){return n(a.toString(),b)},c}(d.MigModel);b.ChatStoreModel=y});var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};define("modules/chat/models/chatroom_packet_handler",["require","exports","./user_session","../fusion/fpacket_defs","../config/config_ts","./packet_handler","./chats","underscore","modules/common/config","modules/common/utility"],function(a,b,c,d,e,f,g){var h=a("underscore"),i=(a("modules/common/config"),a("modules/common/utility"),e.config),j=function(a){function b(b){a.call(this),this.packet_type=d.FUSION_PACKET_TYPES.CHATROOM_NOTIFICATION,this.listener_obj=b}return __extends(b,a),b.prototype.received_fn=function(a){var b=c.Session.getInstance(),d=(b.get("session_user"),a.toObject());this.listener_obj.trigger("chatroom_notification",d.text)},b}(f.PacketHandlerBase);b.ChatRoomNotificationHandler=j;var k=function(a){function b(b){a.call(this),this.packet_type=d.FUSION_PACKET_TYPES.CHATROOM,this.listener_obj=b}return __extends(b,a),b.prototype.received_fn=function(a){var b=c.Session.getInstance(),d=(b.get("session_user"),a.toObject()),e=parseInt(d.category||-999,10);this.listener_obj.updateOrCreateChatroom(this.parseChatRoomData(a),e)},b.prototype.parseChatRoomData=function(a){var b=a.toObject(),c=(b.category,parseInt(b.chatroomid,10)),d=b.chatroomname;return{chatRoomId:c,name:d,destination:d,destinationType:i.DestinationType.public_chat,description:b.description,max_size:parseInt(b.maximumsize,10),size:parseInt(b.size,10),adult_only:b.adultonly,user_owned:b.newowner,group_id:b.groupid,creator:b.userowned}},b}(f.PacketHandlerBase);b.ChatRoomHandler=k;var l=function(a){function b(b){a.call(this),this.packet_type=d.FUSION_PACKET_TYPES.CHATROOM_USER_STATUS,this.listener_obj=b}return __extends(b,a),b.prototype.received_fn=function(a){var b=a.toObject(),c=b.chatroomname,d=b.fusionusername,e=parseInt(b.userstatustype,10),f=parseInt(b.usertype,10);return h.isNaN(e)?void console.error("invalid value in the user status: expected a number"):(h.isNaN(f)&&(f=0),void(1===e?this.listener_obj.add_chatroom_participant(c,d,1===f):this.listener_obj.remove_chatroom_participant(c,d)))},b}(f.PacketHandlerBase);b.ChatRoomUserStatusHandler=l;var m=function(a){function b(b){a.call(this),this.packet_type=d.FUSION_PACKET_TYPES.CHATROOM_CATEGORY,this.listener_obj=b}return __extends(b,a),b.prototype.received_fn=function(a){var b=c.Session.getInstance(),d=(b.get("session_user"),a.toObject());parseInt(d.category||-999,10);this.listener_obj.addChatRoomCategory(this.parseChatRoomCategoryData(a))},b.prototype.parseChatRoomCategoryData=function(a){var b=a.toObject(),c=b.category;return{categoryId:parseInt(c,10),name:b.header,should_replace:b.refreshmethod,can_delete:1===parseInt(b.itemscanbedeleted,10),can_collapse:1===parseInt(b.collapse,10)}},b}(f.PacketHandlerBase);b.ChatRoomCategoryHandler=m;var n=function(a){function b(b){a.call(this),this.packet_type=d.FUSION_PACKET_TYPES.MESSAGE,this.listener_obj=b}return __extends(b,a),b.prototype.received_fn=function(a){var b=c.Session.getInstance(),d=b.get("session_user"),e=a.toObject(),f=parseInt(e.destinationtype,10);if(f===i.DestinationType.public_chat){var h=e.destination,j=this.listener_obj.get_chatroom_by_name(h);if(j){var e=a.toObject();parseInt(e.category||-999,10);this.listener_obj.addChatRoomMessage(g.ChatStoreModel.parseMessageData(a,d),j,!0)}}},b}(f.PacketHandlerBase);b.ChatRoomMessageHandler=n});var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};define("modules/chat/models/chatrooms",["require","exports","./model","./chats","../config/config_ts","./user_session","./chatroom_packet_handler","../fusion/fpacket","../fusion/fpacket_defs","modules/export_marionette","backbone.marionette","underscore","jquery","backbone","modules/common/local_storage","modules/common/utility"],function(a,b,c,d,e,f,g,h,i){function j(a){return"chatroom_"+a.replace(" ","_").replace("@","_")}var k=e.config,l=a("modules/common/local_storage"),m=(a("modules/common/utility"),a("underscore")),n=function(a){function b(b){a.call(this,b),this.subscribed_packets=[],this.participants_received=!1,this.participants_requested=!1,this.join_request_sent=!1,this.set("chatHandle",j(this.get("name")))}return __extends(b,a),b.prototype.is_group_chat=function(){return!1},b.prototype.is_chat_room=function(){return!0},b.prototype.is_fusion_chat=function(){return!0},b.prototype.is_admin=function(a){return m.contains(this.admins,a)},b.prototype.add_admin=function(a){a=$.trim(a),m.contains(this.admins,a)||""===a||this.admins.push(a)},b.prototype.addParticipantsByUsername=function(a){var b=this;a&&0!==a.length&&m.each(a,function(a){b.addParticipant(a)})},b.prototype.addParticipants=function(a){var b=this;a&&0!==a.length&&m.each(a,function(a){b.addParticipant(a.getDisplayName(),a.get("contactId"))})},b.prototype.addParticipant=function(a,b){"undefined"==typeof b&&(b="");var c=d.ChatStoreModel.getInstance(),e=c.startPrivateChat(b,a),f="Come and join me in +["+this.get("name")+"] chatroom";e.addUserTextMessage(f)},b.prototype.rename_chat=function(a){},b.prototype.getTitle=function(){return this.get("name")},b.prototype.getDisplayName=function(){return this.get("name")},b.prototype.getDisplayCount=function(){return this.get("size")+"/"+this.get("max_size")},b.prototype.getSize=function(){return this.get("size")},b.prototype.getMaxSize=function(){return this.get("max_size")},b.prototype.trigger_display=function(){this.trigger("chatroom_display",this)},b.prototype.invoke_invite_friends_event=function(){this.trigger("display_invite_friends",this)},b.prototype.join_chatroom=function(a){var b=this;if("undefined"==typeof a&&(a=!1),!this.join_request_sent){if(this.get("hasJoined"))return void this.invoke_activate_event();var c=h.create_packet(i.FUSION_PACKET_TYPES.JOIN_CHATROOM);c.add_field("chatroomname",this.get("name")),c.add_field("requestPinned",!0),this.setLatestTimeFromServer(Date.now()),c.on("response",function(){b.request_chatroom_participants(),b.setJoinedState(!0),b.initialization_time=Date.now(),b.join_request_sent=!1}),c.on("error",function(a){var c=a.response_packet,d=c.get_error_message();b.setJoinedState(!1),b.trigger("chatroom_join_failed",d),b.join_request_sent=!1}),this.send_packet(c),this.join_request_sent=!0,this.trigger_display()}},b.prototype.leave_chatroom=function(){var a=this;this.messages.reset([]);var b=h.create_packet(i.FUSION_PACKET_TYPES.LEAVE_CHATROOM);b.add_field("chatroomname",this.get("name")),b.on("response",function(){a.setJoinedState(!1)}),b.on("ok",function(){a.setJoinedState(!1)}),this.send_packet(b)},b.prototype.request_chatroom_participants=function(){var a=this;if(!this.participants_requested){var b=h.create_packet(i.FUSION_PACKET_TYPES.GET_CHATROOM_PARTICIPANTS);b.add_field("chatroomname",this.get("name")),b.on("response",function(b){a.participants_requested=!1;var c=b.response_packet;if(708==c.type){a.admins=[],a.participants=[],a.participants_received=!0;var d=c.field_names,e=c.get_field_value(d.administrators),g=c.get_field_value(d.requestingUserType);if(e||1==g){if(e){var h=e.split(";");m.each(h,function(b){a.add_admin(b)})}if(g){var i=f.Session.getInstance();a.add_admin(i.get("session_user"))}}var j=c.get_field_value(d.participants);if(!j)return;var k=j.split(";");m.each(k,function(b){a.add_participant(b)})}}),b.on("error",function(){a.participants_requested=!1}),this.send_packet(b),this.participants_requested=!0}},b.prototype.getParticipants=function(a){return"undefined"==typeof a&&(a=!1),!this.participants_received&&a&&this.request_chatroom_participants(),this.participants},b.prototype.set_as_favourite=function(){r.getInstance().add_favourite_chatroom(this.get("name"))},b.prototype.remove_as_favourite=function(){r.getInstance().remove_favourite_chatroom(this.get("name"))},b.prototype.send_kick_user=function(a){var b=h.create_packet(i.FUSION_PACKET_TYPES.KICK_CHATROOM_PARTICIPANT);b.add_field("chatroomname",this.get("name")),b.add_field("username",a),this.send_packet(b)},b.prototype.send_pin_item=function(a){var b=a.source,c=a.destination,d=null;if(a.is_own_message||1!=a.chatroom_type){var e=f.Session.getInstance();b=e.get("session_user")}else b=a.destination,c=a.source;a.contactId&&(d=a.contactId);var g=h.create_packet(i.FUSION_PACKET_TYPES.MESSAGE);g.add_field("contentasstring",a.message),g.add_field("guid",a.message_id),g.add_field("messagetype",a.message_type),g.add_field("source",b),g.add_field("destinationtype",a.chatroom_type),g.add_field("destination",c),g.add_field("contactid",d),g.add_field("timestamp",a.timestamp),g.add_field("contenttype",k.Content_Type.text),g.add_field("mimetype",a.mime_type),g.add_field("mimetypedata",a.mime_type_data),g.add_field("emotecontenttype",a.get("emote_type")),g.add_field("fromadministrator",a.admin_message),g.add_field("sourcecolor",a.source_colour),g.add_field("messagecolor",a.message_colour),g.add_field("pinnedType",1),g.on("response",function(){}),g.on("error",function(a){console.log(a)}),this.send_packet(g)},b}(d.Chat);b.ChatRoom=n;var o=function(a){function b(){a.apply(this,arguments),this.model=n}return __extends(b,a),b}(Backbone.Collection);b.ChatRoomCollection=o;var p=function(a){function b(b){var c=this;a.call(this,b),this.chat_room_cache_by_name={},this.chat_room_cache_by_id={},this.refreshed_once=!1,this.chatRooms=new o,this.chatRooms.on("add",function(a){var b=a.get("name");c.chat_room_cache_by_name[b]=a,c.chat_room_cache_by_id[a.get("chatRoomId")]=a,c.trigger("chatroom_added",a)}),this.chatRooms.on("update",function(a){c.trigger("chatroom_updated",a)}),this.chatRooms.on("remove",function(a){var b=a.get("name");c.chat_room_cache_by_name[b]=null,c.chat_room_cache_by_id[a.get("chatRoomId")]=null,c.trigger("chatroom_removed",a)}),this._is_refreshing=!1,this.get("notfromserver")||this.refresh()}return __extends(b,a),b.prototype.isRecentCategory=function(){return 2==this.get("categoryId")},b.prototype.isFavouriteCategory=function(){return 1==this.get("categoryId")},b.prototype.add_chatroom_model=function(a){var b=a.get("name"),c=this.get_chatroom_by_name(b);c?this.trigger("chatroom_added",c):this.chatRooms.add(a)},b.prototype.send_remove_chatroom=function(a){r.getInstance().remove_favourite_chatroom(a)},b.prototype.get_chatroom_by_name=function(a){return this.chat_room_cache_by_name[a]},b.prototype.get_chatroom_by_id=function(a){return this.chat_room_cache_by_id[a]},b.prototype.refresh=function(a){var b=this;if("undefined"==typeof a&&(a=!1),a=!this.refreshed_once||a,!this._is_refreshing){var c=h.create_packet(i.FUSION_PACKET_TYPES.GET_CATEGORIZED_CHATROOMS);c.add_field("category",this.get("categoryId")),c.add_field("refresh",a?1:0),a&&(this.chatRooms.reset([]),this.trigger("reset")),c.on("response",function(a){b.refreshed_once=!0;var c=a.response_packet;c.type==i.FUSION_PACKET_TYPES.GET_CATEGORIZED_CHATROOMS_COMPLETE&&(b._is_refreshing=!1,b.trigger("refresh_stop",b),m.isEmpty(c.changed)&&b.trigger("empty_refresh",b))}),c.on("error",function(){b._is_refreshing=!1,b.trigger("refresh_stop",b)}),this.send_packet(c),this._is_refreshing=!0,this.trigger("refresh_start",this)}},b}(c.MigModel);b.ChatRoomCategory=p,p.prototype.idAttribute="categoryId";var q=function(a){function b(){a.apply(this,arguments),this.model=p}return __extends(b,a),b}(Backbone.Collection);b.ChatRoomCategoryCollection=q;var r=function(b){function c(a){if(b.call(this,a),c._instance)throw new Error("ChatRoomCategory Store instance already exist... use getInstance()");c._instance=this,this.chatRoomCategories=new q,this.attachCategoryCollectionEvents(),this.uncategorized_group_id=-999,this.favourite_chatroom_category=null,this.recent_chatroom_category=null,this.uncategorized_chatrooms=new p({categoryId:this.uncategorized_group_id,name:"_uncategorized",notfromserver:"true"}),this.chat_room_cache_by_name={},this.chat_room_cache_by_id={},this.setup_subscribed_packets()}return __extends(c,b),c.getInstance=function(){return c._instance||(c._instance=new c),c._instance},c.prototype.attachCategoryCollectionEvents=function(){var a=this;this.chatRoomCategories.on("add",function(b){var d=b.get("categoryId");d===c.FAVOURITE_CHATROOM_ID&&(a.favourite_chatroom_category=b),d===c.RECENT_CHATROOM_ID&&(a.recent_chatroom_category=b)},this)},c.prototype.refresh_chatrooms=function(){var a=this.chatRoomCategories;a.each(function(a){a.refresh(!0)})},c.prototype.refresh_chatroom_category=function(a,b){var c=this.chatRoomCategories.get(a);c&&c.refresh(b)},c.prototype.get_chatroom_categories=function(){var a=h.create_packet(i.FUSION_PACKET_TYPES.GET_CHATROOM_CATEGORIES);this.send_packet(a)},c.prototype.get_chatroom_category_by_id=function(a){return this.chatRoomCategories.get(a)},c.prototype.get_chatroom_by_id=function(a){return this.chat_room_cache_by_id[a]},c.prototype.get_chatroom_by_name=function(a){return this.chat_room_cache_by_name[a]},c.prototype.handle_chatroom_chat_packet=function(a){var b=a.toObject(),c=j(b.chatidentifier);l.set("timestamp_from_server_"+c,b.timestamp),this.join_chatroom_by_name(b.chatidentifier,!0)},c.prototype.join_chatroom_by_name=function(a,b,c){"undefined"==typeof b&&(b=!1),"undefined"==typeof c&&(c=!1);var d=this.get_chatroom_by_name(a);d||(d=new n({name:a,destination:a}),this.attach_chatroom_event(d),this.chat_room_cache_by_name[a]=d),b?d.trigger_display():d.join_chatroom(c)},c.prototype.send_pin_item=function(a,b){var c=this.get_chatroom_by_name(a);c||(c=new n({name:a,destination:a}),this.attach_chatroom_event(c),this.chat_room_cache_by_name[a]=c),c.send_pin_item(b)},c.prototype.init=function(){var b=this,c=a("modules/chat/models/user_session"),d=c.Session.getInstance();d.on("session_created",function(){b.get_chatroom_categories()},this);var e=this.chatRoomCategories;e.on("add",function(a){b.trigger("chatroom_category_added",a)}),e.on("update",function(a){b.trigger("chatroom_category_update",a)})},c.prototype.add_chatroom_participant=function(a,b,c){var d=this.get_chatroom_by_name(a);d&&d.add_participant(b,c)},c.prototype.remove_chatroom_participant=function(a,b){var c=this.get_chatroom_by_name(a);c&&c.remove_participant(b)},c.prototype.is_chatroom_favourite=function(a){if(!this.favourite_chatroom_category)return!1;var b=this.favourite_chatroom_category.chatRooms;return-1!==m.indexOf(b.pluck("name"),a)},c.prototype.add_recent_chatroom=function(a){this.recent_chatroom_category&&this.recent_chatroom_category.add_chatroom_model(a)},c.prototype.add_favourite_chatroom=function(a){var b=this,c=this.get_chatroom_by_name(a),d=h.create_packet(i.FUSION_PACKET_TYPES.ADD_FAVOURITE_CHATROOM);d.add_field("chatroomname",c.get("name")),d.on("error",function(a){var d=a.response_packet;c.trigger("add_favourite_failed",d.get_error_message(),c),b.trigger("add_favourite_failed",d.get_error_message(),b,c)}),d.on("response",function(){b.trigger("add_favourite_chatroom_success")}),this.send_packet(d)},c.prototype.remove_favourite_chatroom=function(a){var b=this,c=h.create_packet(i.FUSION_PACKET_TYPES.REMOVE_FAVOURITE_CHATROOM),d=this.get_chatroom_by_name(a);c.add_field("category",this.get("categoryId")),c.add_field("chatroomname",a),c.on("error",function(a){var c=a.response_packet;b.favourite_chatroom_category&&b.favourite_chatroom_category.trigger("remove_chatroom_failed",c.get_error_message(),b,d),b.trigger("remove_chatroom_failed",c.get_error_message(),b,d)}),c.on("response",function(){b.favourite_chatroom_category&&b.favourite_chatroom_category.chatRooms.remove(d),b.trigger("remove_favourite_chatroom_success")}),this.send_packet(c)},c.prototype.addChatRoomCategory=function(a){var b=this,c=this.chatRoomCategories.get(a.categoryId);c||(this.chatRoomCategories.add(a),c=this.chatRoomCategories.get(a.categoryId)),c.on("remove_chatroom_failed",function(a,c,d){b.trigger("remove_chatroom_failed",a,c,d)})},c.prototype.setup_subscribed_packets=function(){this.registerPacketHandler(new g.ChatRoomCategoryHandler(this)),this.registerPacketHandler(new g.ChatRoomHandler(this)),this.registerPacketHandler(new g.ChatRoomMessageHandler(this)),this.registerPacketHandler(new g.ChatRoomNotificationHandler(this)),this.registerPacketHandler(new g.ChatRoomUserStatusHandler(this))},c.prototype.updateOrCreateChatroom=function(a,b){var c=this.chatRoomCategories.get(b),d=this.get_chatroom_by_name(a.name);d?d.set(a):(d=new n(a),this.attach_chatroom_event(d)),this.chat_room_cache_by_name[a.name]=d,this.chat_room_cache_by_id[a.chatRoomId]=d,c?c.add_chatroom_model(d):(this.uncategorized_chatrooms.add_chatroom_model(d),this.add_recent_chatroom(d))},c.prototype.addChatRoomMessage=function(a,b,c){"undefined"==typeof c&&(c=!1),c&&!b.get("hasJoined")&&(b.setLatestTimeFromServer(Date.now()),b.setJoinedState(!0,!0),b.trigger_display()),b.add_chat_message(a)},c.prototype.attach_chatroom_event=function(a){var b=this;a.on("chatroom_joined",function(a,c){"undefined"==typeof c&&(c=!1),b.trigger("chatroom_joined",a,c)}),a.on("chatroom_left",function(a){b.trigger("chatroom_left",a)}),a.on("chatroom_display",function(a){b.trigger("chatroom_display",a)}),a.on("chatroom_join_failed",function(a){b.trigger("chatroom_join_failed",a)})},c._instance=null,c.FAVOURITE_CHATROOM_ID=1,c.RECENT_CHATROOM_ID=2,c}(c.MigModel);b.ChatRoomCategoryStore=r});var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};define("modules/chat/models/user_session",["require","exports","./model","./session_packet_handler","../data/offline","../config/config_ts","../fusion/fpacket","../fusion/fpacket_defs","./contacts","./chats","./chatrooms","../../common/task_runner","../../common/event_logger","modules/export_marionette","backbone.marionette","underscore","jquery","backbone","modules/globals/url","modules/common/local_storage","modules/common/utility","modules/common/config"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=m.Logger.getInstance(),o=(a("modules/globals/url"),f.config),p=a("modules/common/local_storage"),q=a("modules/common/utility"),r=a("underscore"),s=a("jquery"),t="2",u=o.offline_threshold,v=0,w=function(b){function c(a){if(b.call(this,a),this._session_start_time=Date.now(),this.emoticon_hotkeys=[],this.emoticon_hotkeys_alt=[],this.emoticon_hotkeys_all=[],this.emoticon_hotkeys_array=[],this.sticker_packs=[],this.sticker_packs_by_id={},this.sticker_by_hotkeys={},this.isChatSyncOnce=!!p.get("chatsync_v"+t),this.session_initialization_complete=!1,this.need_reconnect=!1,this.is_polling=!1,this.polling_interval=null,this.reconnecting=!1,this.isOffline=!1,c._instance)throw new Error("Error: Instantiation failed: Use Session.getInstance() instead of new.");c._instance=this,this._class_initialize(a),this.initialize_offline_listener()}return __extends(c,b),c.getInstance=function(){return c._instance||(c._instance=new c),c._instance},c.prototype.initialize_offline_listener=function(){var a=this,b=e.Offline.getInstance();b.on("down",function(){a.stop_check_session(),a.stop_poll(),a.need_reconnect=!0}),b.on("server-down",function(){a.stop_check_session(),a.stop_poll(),a.need_reconnect=!0}),b.on("check-session",function(){a.check_session()})},c.prototype._class_initialize=function(a){this.check_session_task_runner=new l.TaskRunner,this.poll_task_runner=new l.TaskRunner,this.registerPacketHandler(new d.StickerPackListHandler(this)),this.registerPacketHandler(new d.ServerQuestionHandler(this)),this.registerPacketHandler(new d.EmoticonHandler(this)),this.registerPacketHandler(new d.StickerPackHandler(this)),this.registerPacketHandler(new d.ErrorHandler(this)),this.registerPacketHandler(new d.AlertHandler(this)),this.registerPacketHandler(new d.ChatRoomCategoryHandler(this)),this.registerPacketHandler(new d.IMSessionStatus(this)),this.registerPacketHandler(new d.StatusMessageHandler(this)),this.registerPacketHandler(new d.LoginOkHandler(this)),this.registerPacketHandler(new d.EmoticonHotkeyHandler(this)),this.registerPacketHandler(new d.AccountBalanceHandler(this)),this.registerPacketHandler(new d.AvatarHandler(this)),this.registerPacketHandler(new d.LogoutHandler(this)),this.registerPacketHandler(new d.IMAvailablePacketHander(this))},Object.defineProperty(c.prototype,"session_start_time",{get:function(){return this._session_start_time},enumerable:!0,configurable:!0}),c.prototype.get_aproximated_server_time=function(){var a=parseInt(this.get("server_time_delta")||0,10);return Date.now()-a},c.prototype.isChatSyncReady=function(){return this.isChatSyncOnce},c.prototype.is_user_data_set=function(a){if(!this.get("session_user"))throw"No active session found;";return p.hasKey(this.get("session_user")+"_"+a)},c.prototype.set_user_data=function(a,b){},c.prototype.get_user_data=function(a){return q.get_user_data(a)},c.prototype.remove_user_data=function(a){return q.remove_user_data(a)},c.prototype.add_emoticon_hotkeys=function(a,b,c){this.emoticon_hotkeys=a,this.emoticon_hotkeys_alt=b,this.emoticon_hotkeys_all=c,this.emoticon_hotkeys_array=[],this.trigger("emoticon_hotkeys",this);
},c.prototype.fetch_emoticon_hotkeys=function(){var a=g.create_packet(h.FUSION_PACKET_TYPES.GET_EMOTICON_HOTKEYS);this.send_packet(a)},c.prototype.fetch_sticker_pack_list=function(){var a;this.get("supports_stickers")&&(a=g.create_packet(h.FUSION_PACKET_TYPES.GET_STICKER_PACK_LIST),this.send_packet(a))},c.prototype.add_sticker=function(a,b,c){var d=this.sticker_packs_by_id[a];r.isEmpty(d)||r.has(d.stickers_by_hotkey,b)||(d.stickers.push(c),d.stickers_by_hotkey[b]=c),this.sticker_by_hotkeys[b]=c,this.trigger("sticker_received",c,d)},c.prototype.add_sticker_pack=function(a){n.log("Got a sticker packet "+JSON.stringify(a)),this.sticker_packs_by_id[a.stickerpackid]||(a.hotkeys_cached=!1,a.stickers=[],a.stickers_by_hotkey={},a.stickerhotkeys=r.unique(a.stickerhotkeys.split(" ")).join(" "),this.sticker_packs.push(a),this.sticker_packs_by_id[a.stickerpackid]=a,this.trigger_fetch_stickers(a.stickerpackid),this.trigger("sticker_pack_received",a))},c.prototype.trigger_fetch_stickers=function(a){var b=this.sticker_packs_by_id[a];if(!r.isEmpty(b)){var c=g.create_packet(h.FUSION_PACKET_TYPES.GET_EMOTICON);c.add_field("hotkeys",b.stickerhotkeys),this.send_packet(c)}},c.prototype.trigger_fetch_sticker=function(a,b){var c=g.create_packet(h.FUSION_PACKET_TYPES.GET_EMOTICON);c.add_field("hotkeys",a),c.on("response",function(c){var d=c.response_packet.toObject();b(a,d)},this),this.send_packet(c)},c.prototype.initModels=function(){i.ContactGroupStore.getInstance().init(),k.ChatRoomCategoryStore.getInstance().init(),j.ChatStoreModel.getInstance().init()},c.prototype.init=function(){return o&&o.config.username?(this.set({sid:s.cookie("eid"),session_state:o.Application_State.logging_in,presence:o.Presence.appear_offline,invisible_login:!0,session_user:o.config.username}),this.initModels(),void this.initiate_fusion_session()):(n.log("No need to create session, user is from non logged in public page"),void this.trigger("no_session_initiated",this))},c.prototype.initiate_fusion_session=function(){if(!this.reconnecting){this.reconnecting=!0;var b=g.create_packet(h.FUSION_PACKET_TYPES.CREATE_SESSION);b.add_field("clienttype",o.ClientType),b.add_field("clientversion",o.ClientVersion),b.add_field("sessionid",this.get("sid")),b.add_field("fontheight",16),b.add_field("screenwidth",800),b.add_field("stickersize",240);var c=a("modules/mig33_app");b.on(g.packet_events.send_failed,function(){n.log("Unable to establish session due to network error",{}),c.vent.trigger(c.ApplicationEvents.CHAT_SESSION_ERROR)}),b.on(g.packet_events.error,function(){n.log("Unable to establish, server returned error packet",{}),c.vent.trigger(c.ApplicationEvents.CHAT_SESSION_ERROR)}),this.send_packet(b)}},c.prototype.initialize_local_session=function(b){if(this.set(b),!this.session_initialization_complete){this.reconnecting=!1,this.need_reconnect=!1,this.trigger("session_created",this),this.trigger("session_startup_completed"),this.fetch_session_data(),this.start_check_session(),this.start_poll(),this._session_start_time=Date.now(),p.set("chatsync_v1",!0);var c=a("modules/mig33_app");c.vent.trigger(c.ApplicationEvents.CHAT_SESSION_CONNECTED)}},c.prototype.fetch_session_data=function(){this.fetch_presence(),this.fetch_status_message(),this.fetch_emoticon_hotkeys(),this.fetch_server_question()},c.prototype.clear_session_and_navigateaway=function(a){this.stop_poll(),this.stop_check_session(),this.tear_down(),a&&(window.location=o.logout_url)},c.prototype.user_logout=function(a){var b=this,c=g.create_packet(h.FUSION_PACKET_TYPES.LOGOUT),d=function(){b.clear_session_and_navigateaway(a)};c.on("sent_success",d,this),c.on("send_failed",d,this),this.send_packet(c)},c.prototype.tear_down=function(){p.clear_cookie("sid"),p.clear_cookie("eid"),p.remove("sess")},c.prototype.fetch_status_message=function(){var a=this,b="/sites/ajax/profile/display_pic_xml",c=s.ajax(b,{dataType:"xml"});c.done(function(b){var c=null,d=s(b).find("displaypic").get(0);d&&(c=s(d).attr("statusMessage"),a.set({status_message:c}),a.trigger("status_updated",a))})},c.prototype.set_status_message=function(b){var c=this,d=a("modules/globals/session_user");if(b!==d.status_message){d.status_message=b;var e=g.create_packet(h.FUSION_PACKET_TYPES.SET_STATUS_MESSAGE);e.add_field("statusmessage",b),this.send_packet(e),e.on("response",function(a){var d=a.response_packet;d.is_error_packet()||(c.set({status_message:b}),c.trigger("status_updated",c),q.show_success(q.translate("chat|status_message_set")))},this)}},c.prototype.setPresence=function(a,b){"undefined"==typeof b&&(b=!1),this.set({presence:a}),b&&this.trigger("login_presence",a),this.send_presence()},c.prototype.send_presence=function(){var a=this,b=g.create_packet(h.FUSION_PACKET_TYPES.SET_PRESENCE);b.add_field("newpresence",this.get("presence")),b.on("response",function(){a.trigger("presence_changed",a.get("presence"))},this),this.send_packet(b)},c.prototype.fetch_presence=function(){var b=this,c="/sites/ajax/api/profile_compat",d=s.ajax(c,{dataType:"json"});d.done(function(c){var d=q.parse_ajax_response(c);if(d.balance&&!r.isNaN(parseFloat(d.balance.balance))){b.set({currency_code:d.balance.currency_code,currency_symbol:d.balance.currency_symbol,account_balance:parseFloat(d.balance.balance)});var e=a("modules/mig33_app");e.vent.trigger(e.ApplicationEvents.ACCOUNT_BALANCE,q.add_thousands_seperator(q.round_number_decimal(d.balance.balance,2))+" "+d.balance.currency_code)}else n.log("Unable to get account balance: ",{},c);if(d.presence){if(d.presence==b.get("presence"))return;b.setPresence(d.presence,!0)}else n.log("Unable to query presence: ",{},c)})},c.prototype.set_IM_status=function(a,b,c,d){c&&this.set(a+"_setup",!0),this.set(a+"_signed_in",c),this.trigger("im_status_update",{imtype:b,status:c,reason:d}),d&&(c?q.show_info(d):q.show_info(d))},c.prototype.start_check_session=function(){this.stop_check_session();var a=o.check_session_interval,b={run:this.check_session,interval:1e3*a,scope:this,fireOnStart:!1};this.check_session_task_runner.start(b)},c.prototype.check_session=function(){var a=this,b=s.ajax("/sites/ajax/session/check",{cache:!1,type:"GET",dataType:"json",timeout:3e4});b.done(function(b){b.error&&0!==parseInt(b.error.errno,10)?(n.log("Session getting error errno: "+b.error.errno),a.check_session_failure()):a.check_session_success(b.data)}),b.fail(function(b,c,d){n.log("Session check fail - XHR:"+b.responseText+" - "+b.responseJSON+" - "+b.readyState+" - "+b.status+"-"+b.statusText+" - "+c+" - "+d),v++,v>=u&&a.check_session_failure()})},c.prototype.check_session_success=function(a){if(a&&a.is_logged_in){if(v=0,n.log("Session still alive"),this.need_reconnect&&this.initiate_fusion_session(),this.get("session_state")==o.Application_State.logged_in)return;this.set({session_user:a.username}),this.trigger("session_check_complete",this)}else n.log("Session died"),this.check_session_failure()},c.prototype.check_session_failure=function(){this.stop_poll(),this.stop_check_session(),this.set("session_state",o.Application_State.logging_in),this.isOffline||this.prompt_session_disconnect()},c.prototype.prompt_session_disconnect=function(){n.log("This is where I will prompt the user to connect back"),this.trigger("logout_forced",q.translate("chat|session-end"))},c.prototype.stop_check_session=function(){this.check_session_task_runner.stop()},c.prototype.stop_poll=function(){this.is_polling=!1,this.poll_task_runner.stop()},c.prototype.do_poll=function(){if(n.log("Polling...."),o.transport_mode&&"WS"===o.transport_mode){var a=g.create_packet(h.FUSION_PACKET_TYPES.PING);this.send_packet(a)}else this.send_packet(null)},c.prototype.start_poll=function(a){this.poll_task_runner.stop(),a=a||o.default_poll_interval,this.polling_interval=1e3*a;var b={run:this.do_poll,interval:this.polling_interval,scope:this,fireOnStart:!1};this.is_polling=!0,this.poll_task_runner.start(b)},c.prototype.fetch_server_question=function(){var a=g.create_packet(h.FUSION_PACKET_TYPES.GET_SERVER_QUESTION);this.send_packet(a)},c}(c.MigModel);b.Session=w});var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};define("modules/view/common/mig33_views",["require","exports","jquery","backbone","backbone.marionette","modules/export_marionette","underscore","modules/model/common/mig33_collection"],function(a,b){function c(a,b){b.forEach(function(b){Object.getOwnPropertyNames(b.prototype).forEach(function(c){a.prototype[c]=b.prototype[c]})})}var d=(a("underscore"),a("modules/model/common/mig33_collection")),e=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b}(Backbone.Collection);b.CollectionCtx=e;var f=function(){function a(){}return a}();b.Option=f;var g=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b.prototype.showEmptyView=function(){var a,b;if(!this.__collection_synced&&this.__sync_started&&Marionette.getOption(this,"loadingView")?a=Marionette.getOption(this,"loadingView"):this.__errored_out&&Marionette.getOption(this,"errorView")?(a=Marionette.getOption(this,"errorView"),b=Marionette.getOption(this,"errorViewModel")):(a=Marionette.getOption(this,"emptyView"),b=Marionette.getOption(this,"emptyViewModel")),a&&!this._showingEmptyView){this._showingEmptyView=!0;var c=b||new Backbone.Model;this.addItemView(c,a,0)}},b.prototype.__render_on_sync=function(a){var b=this.__collection_synced;this.__collection_synced=!0,b||0!==a.collection.length||this.render()},b.prototype.setupCollectionEventForEmptyView=function(a){var b=this;a.collection&&(a.collection.on("sync_start",function(){0===a.collection.length&&(b.__sync_started=!0),b.__collection_synced||b.render()},this),a.collection.on("sync",function(){b.__errored_out=!1,b.__sync_started=!1,b.__render_on_sync(a)},this),a.collection.on("error",function(){b.__errored_out=!0,b.__sync_started=!1,b.__render_on_sync(a)},this)),this.__errored_out=!1,this.__collection_synced=!1,this.__sync_started=!1,d.prepareCollectionForExtraEvents(a.collection)},b}(Marionette.CollectionView),h=function(a){function b(b){this.setupCollectionEventForEmptyView(b),a.call(this,b)}return __extends(b,a),b.prototype.showEmptyView=function(){},b.prototype.__render_on_sync=function(a){},b.prototype.setupCollectionEventForEmptyView=function(a){},b}(Marionette.CollectionView);b.CollectionView=h;var i=function(a){function b(b){this.setupCollectionEventForEmptyView(b),a.call(this,b)}return __extends(b,a),b.prototype.showEmptyView=function(){},b.prototype.__render_on_sync=function(a){},b.prototype.setupCollectionEventForEmptyView=function(a){},b}(Marionette.CompositeView);b.CompositeView=i;var j=function(a){function b(b){a.call(this,b)}return __extends(b,a),b}(Marionette.Layout);b.Layout=j;var k=function(a){function b(b){a.call(this,b)}return __extends(b,a),b}(Marionette.ItemView);b.ItemView=k,c(i,[g]),c(h,[g])}),function(){var a,b,c,d,e,f={}.hasOwnProperty,g=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};d=function(){function a(){this.options_index=0,this.parsed=[]}return a.prototype.add_node=function(a){return"OPTGROUP"===a.nodeName.toUpperCase()?this.add_group(a):this.add_option(a)},a.prototype.add_group=function(a){var b,c,d,e,f,g;for(b=this.parsed.length,this.parsed.push({array_index:b,group:!0,label:this.escapeExpression(a.label),children:0,disabled:a.disabled}),f=a.childNodes,g=[],d=0,e=f.length;e>d;d++)c=f[d],g.push(this.add_option(c,b,a.disabled));return g},a.prototype.add_option=function(a,b,c){return"OPTION"===a.nodeName.toUpperCase()?(""!==a.text?(null!=b&&(this.parsed[b].children+=1),this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:a.value,text:a.text,html:a.innerHTML,selected:a.selected,disabled:c===!0?c:a.disabled,group_array_index:b,classes:a.className,style:a.style.cssText})):this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:!0}),this.options_index+=1):void 0},a.prototype.escapeExpression=function(a){var b,c;return null==a||a===!1?"":/[\&\<\>\"\'\`]/.test(a)?(b={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},c=/&(?!\w+;)|[\<\>\"\'\`]/g,a.replace(c,function(a){return b[a]||"&amp;"})):a},a}(),d.select_to_array=function(a){var b,c,e,f,g;for(c=new d,g=a.childNodes,e=0,f=g.length;f>e;e++)b=g[e],c.add_node(b);return c.parsed},b=function(){function a(b,c){this.form_field=b,this.options=null!=c?c:{},a.browser_is_supported()&&(this.is_multiple=this.form_field.multiple,this.set_default_text(),this.set_default_values(),this.setup(),this.set_up_html(),this.register_observers())}return a.prototype.set_default_values=function(){var a=this;return this.click_test_action=function(b){return a.test_active_click(b)},this.activate_action=function(b){return a.activate_field(b)},this.active_field=!1,this.mouse_on_container=!1,this.results_showing=!1,this.result_highlighted=null,this.allow_single_deselect=null!=this.options.allow_single_deselect&&null!=this.form_field.options[0]&&""===this.form_field.options[0].text?this.options.allow_single_deselect:!1,this.disable_search_threshold=this.options.disable_search_threshold||0,this.disable_search=this.options.disable_search||!1,this.enable_split_word_search=null!=this.options.enable_split_word_search?this.options.enable_split_word_search:!0,this.group_search=null!=this.options.group_search?this.options.group_search:!0,this.search_contains=this.options.search_contains||!1,this.single_backstroke_delete=null!=this.options.single_backstroke_delete?this.options.single_backstroke_delete:!0,this.max_selected_options=this.options.max_selected_options||1/0,this.inherit_select_classes=this.options.inherit_select_classes||!1,this.display_selected_options=null!=this.options.display_selected_options?this.options.display_selected_options:!0,this.display_disabled_options=null!=this.options.display_disabled_options?this.options.display_disabled_options:!0},a.prototype.set_default_text=function(){return this.form_field.getAttribute("data-placeholder")?this.default_text=this.form_field.getAttribute("data-placeholder"):this.is_multiple?this.default_text=this.options.placeholder_text_multiple||this.options.placeholder_text||a.default_multiple_text:this.default_text=this.options.placeholder_text_single||this.options.placeholder_text||a.default_single_text,this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||a.default_no_result_text},a.prototype.mouse_enter=function(){return this.mouse_on_container=!0},a.prototype.mouse_leave=function(){return this.mouse_on_container=!1},a.prototype.input_focus=function(a){var b=this;if(this.is_multiple){if(!this.active_field)return setTimeout(function(){return b.container_mousedown()},50)}else if(!this.active_field)return this.activate_field()},a.prototype.input_blur=function(a){var b=this;return this.mouse_on_container?void 0:(this.active_field=!1,setTimeout(function(){return b.blur_test()},100))},a.prototype.results_option_build=function(a){var b,c,d,e,f;for(b="",f=this.results_data,d=0,e=f.length;e>d;d++)c=f[d],b+=c.group?this.result_add_group(c):this.result_add_option(c),(null!=a?a.first:void 0)&&(c.selected&&this.is_multiple?this.choice_build(c):c.selected&&!this.is_multiple&&this.single_set_selected_text(c.text));return b},a.prototype.result_add_option=function(a){var b,c;return a.search_match&&this.include_option_in_results(a)?(b=[],a.disabled||a.selected&&this.is_multiple||b.push("active-result"),!a.disabled||a.selected&&this.is_multiple||b.push("disabled-result"),a.selected&&b.push("result-selected"),null!=a.group_array_index&&b.push("group-option"),""!==a.classes&&b.push(a.classes),c=document.createElement("li"),c.className=b.join(" "),c.style.cssText=a.style,c.setAttribute("data-option-array-index",a.array_index),c.innerHTML=a.search_text,this.outerHTML(c)):""},a.prototype.result_add_group=function(a){var b;return(a.search_match||a.group_match)&&a.active_options>0?(b=document.createElement("li"),b.className="group-result",b.innerHTML=a.search_text,this.outerHTML(b)):""},a.prototype.results_update_field=function(){return this.set_default_text(),this.is_multiple||this.results_reset_cleanup(),this.result_clear_highlight(),this.results_build(),this.results_showing?this.winnow_results():void 0},a.prototype.reset_single_select_options=function(){var a,b,c,d,e;for(d=this.results_data,e=[],b=0,c=d.length;c>b;b++)a=d[b],a.selected?e.push(a.selected=!1):e.push(void 0);return e},a.prototype.results_toggle=function(){return this.results_showing?this.results_hide():this.results_show()},a.prototype.results_search=function(a){return this.results_showing?this.winnow_results():this.results_show()},a.prototype.winnow_results=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m;for(this.no_results_clear(),e=0,g=this.get_search_text(),a=g.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),d=this.search_contains?"":"^",c=new RegExp(d+a,"i"),j=new RegExp(a,"i"),m=this.results_data,k=0,l=m.length;l>k;k++)b=m[k],b.search_match=!1,f=null,this.include_option_in_results(b)&&(b.group&&(b.group_match=!1,b.active_options=0),null!=b.group_array_index&&this.results_data[b.group_array_index]&&(f=this.results_data[b.group_array_index],0===f.active_options&&f.search_match&&(e+=1),f.active_options+=1),b.group&&!this.group_search||(b.search_text=b.group?b.label:b.html,b.search_match=this.search_string_match(b.search_text,c),b.search_match&&!b.group&&(e+=1),b.search_match?(g.length&&(h=b.search_text.search(j),i=b.search_text.substr(0,h+g.length)+"</em>"+b.search_text.substr(h+g.length),b.search_text=i.substr(0,h)+"<em>"+i.substr(h)),null!=f&&(f.group_match=!0)):null!=b.group_array_index&&this.results_data[b.group_array_index].search_match&&(b.search_match=!0)));return this.result_clear_highlight(),1>e&&g.length?(this.update_results_content(""),this.no_results(g)):(this.update_results_content(this.results_option_build()),this.winnow_results_set_highlight())},a.prototype.search_string_match=function(a,b){var c,d,e,f;if(b.test(a))return!0;if(this.enable_split_word_search&&(a.indexOf(" ")>=0||0===a.indexOf("["))&&(d=a.replace(/\[|\]/g,"").split(" "),d.length))for(e=0,f=d.length;f>e;e++)if(c=d[e],b.test(c))return!0},a.prototype.choices_count=function(){var a,b,c,d;if(null!=this.selected_option_count)return this.selected_option_count;for(this.selected_option_count=0,d=this.form_field.options,b=0,c=d.length;c>b;b++)a=d[b],a.selected&&(this.selected_option_count+=1);return this.selected_option_count},a.prototype.choices_click=function(a){return a.preventDefault(),this.results_showing||this.is_disabled?void 0:this.results_show()},a.prototype.keyup_checker=function(a){var b,c;switch(b=null!=(c=a.which)?c:a.keyCode,this.search_field_scale(),b){case 8:if(this.is_multiple&&this.backstroke_length<1&&this.choices_count()>0)return this.keydown_backstroke();if(!this.pending_backstroke)return this.result_clear_highlight(),this.results_search();break;case 13:if(a.preventDefault(),this.results_showing)return this.result_select(a);break;case 27:return this.results_showing&&this.results_hide(),!0;case 9:case 38:case 40:case 16:case 91:case 17:break;default:return this.results_search()}},a.prototype.clipboard_event_checker=function(a){var b=this;return setTimeout(function(){return b.results_search()},50)},a.prototype.container_width=function(){return null!=this.options.width?this.options.width:""+this.form_field.offsetWidth+"px"},a.prototype.include_option_in_results=function(a){return this.is_multiple&&!this.display_selected_options&&a.selected?!1:!this.display_disabled_options&&a.disabled?!1:!a.empty},a.prototype.search_results_touchstart=function(a){return this.touch_started=!0,this.search_results_mouseover(a)},a.prototype.search_results_touchmove=function(a){return this.touch_started=!1,this.search_results_mouseout(a)},a.prototype.search_results_touchend=function(a){return this.touch_started?this.search_results_mouseup(a):void 0},a.prototype.outerHTML=function(a){var b;return a.outerHTML?a.outerHTML:(b=document.createElement("div"),b.appendChild(a),b.innerHTML)},a.browser_is_supported=function(){return"Microsoft Internet Explorer"===window.navigator.appName?document.documentMode>=8:!0},a.default_multiple_text="Select Some Options",a.default_single_text="Select an Option",a.default_no_result_text="No results match",a}(),a=jQuery,a.fn.extend({chosen:function(d){return b.browser_is_supported()?this.each(function(b){var e,f;e=a(this),f=e.data("chosen"),"destroy"===d&&f?f.destroy():f||e.data("chosen",new c(this,d))}):this}}),c=function(b){function c(){return e=c.__super__.constructor.apply(this,arguments)}return g(c,b),c.prototype.setup=function(){return this.form_field_jq=a(this.form_field),this.current_selectedIndex=this.form_field.selectedIndex,this.is_rtl=this.form_field_jq.hasClass("chosen-rtl")},c.prototype.set_up_html=function(){var b,c;return b=["chosen-container"],b.push("chosen-container-"+(this.is_multiple?"multi":"single")),this.inherit_select_classes&&this.form_field.className&&b.push(this.form_field.className),this.is_rtl&&b.push("chosen-rtl"),c={"class":b.join(" "),style:"width: "+this.container_width()+";",title:this.form_field.title},this.form_field.id.length&&(c.id=this.form_field.id.replace(/[^\w]/g,"_")+"_chosen"),this.container=a("<div />",c),this.is_multiple?this.container.html('<ul class="chosen-choices"><li class="search-field"><input type="text" value="'+this.default_text+'" class="default" autocomplete="off" style="width:25px;" /></li></ul><div class="chosen-drop"><ul class="chosen-results"></ul></div>'):this.container.html('<a class="chosen-single chosen-default" tabindex="-1"><span>'+this.default_text+'</span><div><b></b></div></a><div class="chosen-drop"><div class="chosen-search"><input type="text" autocomplete="off" /></div><ul class="chosen-results"></ul></div>'),this.form_field_jq.hide().after(this.container),this.dropdown=this.container.find("div.chosen-drop").first(),this.search_field=this.container.find("input").first(),this.search_results=this.container.find("ul.chosen-results").first(),this.search_field_scale(),this.search_no_results=this.container.find("li.no-results").first(),this.is_multiple?(this.search_choices=this.container.find("ul.chosen-choices").first(),this.search_container=this.container.find("li.search-field").first()):(this.search_container=this.container.find("div.chosen-search").first(),this.selected_item=this.container.find(".chosen-single").first()),this.results_build(),this.set_tab_index(),this.set_label_behavior(),this.form_field_jq.trigger("chosen:ready",{chosen:this})},c.prototype.register_observers=function(){var a=this;return this.container.bind("mousedown.chosen",function(b){a.container_mousedown(b)}),this.container.bind("mouseup.chosen",function(b){a.container_mouseup(b)}),this.container.bind("mouseenter.chosen",function(b){a.mouse_enter(b)}),this.container.bind("mouseleave.chosen",function(b){a.mouse_leave(b)}),this.search_results.bind("mouseup.chosen",function(b){a.search_results_mouseup(b)}),this.search_results.bind("mouseover.chosen",function(b){a.search_results_mouseover(b)}),this.search_results.bind("mouseout.chosen",function(b){a.search_results_mouseout(b)}),this.search_results.bind("mousewheel.chosen DOMMouseScroll.chosen",function(b){a.search_results_mousewheel(b)}),this.search_results.bind("touchstart.chosen",function(b){a.search_results_touchstart(b)}),this.search_results.bind("touchmove.chosen",function(b){a.search_results_touchmove(b)}),this.search_results.bind("touchend.chosen",function(b){a.search_results_touchend(b)}),this.form_field_jq.bind("chosen:updated.chosen",function(b){a.results_update_field(b)}),this.form_field_jq.bind("chosen:activate.chosen",function(b){a.activate_field(b)}),this.form_field_jq.bind("chosen:open.chosen",function(b){a.container_mousedown(b)}),this.form_field_jq.bind("chosen:close.chosen",function(b){a.input_blur(b)}),this.search_field.bind("blur.chosen",function(b){a.input_blur(b)}),this.search_field.bind("keyup.chosen",function(b){a.keyup_checker(b)}),this.search_field.bind("keydown.chosen",function(b){a.keydown_checker(b)}),this.search_field.bind("focus.chosen",function(b){a.input_focus(b)}),this.search_field.bind("cut.chosen",function(b){a.clipboard_event_checker(b)}),this.search_field.bind("paste.chosen",function(b){a.clipboard_event_checker(b)}),this.is_multiple?this.search_choices.bind("click.chosen",function(b){a.choices_click(b)}):this.container.bind("click.chosen",function(a){a.preventDefault()})},c.prototype.destroy=function(){return a(this.container[0].ownerDocument).unbind("click.chosen",this.click_test_action),this.search_field[0].tabIndex&&(this.form_field_jq[0].tabIndex=this.search_field[0].tabIndex),this.container.remove(),this.form_field_jq.removeData("chosen"),this.form_field_jq.show()},c.prototype.search_field_disabled=function(){return this.is_disabled=this.form_field_jq[0].disabled,this.is_disabled?(this.container.addClass("chosen-disabled"),this.search_field[0].disabled=!0,this.is_multiple||this.selected_item.unbind("focus.chosen",this.activate_action),this.close_field()):(this.container.removeClass("chosen-disabled"),this.search_field[0].disabled=!1,this.is_multiple?void 0:this.selected_item.bind("focus.chosen",this.activate_action))},c.prototype.container_mousedown=function(b){return this.is_disabled||(b&&"mousedown"===b.type&&!this.results_showing&&b.preventDefault(),null!=b&&a(b.target).hasClass("search-choice-close"))?void 0:(this.active_field?this.is_multiple||!b||a(b.target)[0]!==this.selected_item[0]&&!a(b.target).parents("a.chosen-single").length||(b.preventDefault(),this.results_toggle()):(this.is_multiple&&this.search_field.val(""),a(this.container[0].ownerDocument).bind("click.chosen",this.click_test_action),this.results_show()),this.activate_field())},c.prototype.container_mouseup=function(a){return"ABBR"!==a.target.nodeName||this.is_disabled?void 0:this.results_reset(a)},c.prototype.search_results_mousewheel=function(a){var b;return a.originalEvent&&(b=-a.originalEvent.wheelDelta||a.originalEvent.detail),null!=b?(a.preventDefault(),"DOMMouseScroll"===a.type&&(b=40*b),this.search_results.scrollTop(b+this.search_results.scrollTop())):void 0},c.prototype.blur_test=function(a){return!this.active_field&&this.container.hasClass("chosen-container-active")?this.close_field():void 0},c.prototype.close_field=function(){return a(this.container[0].ownerDocument).unbind("click.chosen",this.click_test_action),this.active_field=!1,this.results_hide(),this.container.removeClass("chosen-container-active"),this.clear_backstroke(),this.show_search_field_default(),this.search_field_scale()},c.prototype.activate_field=function(){return this.container.addClass("chosen-container-active"),this.active_field=!0,this.search_field.val(this.search_field.val()),this.search_field.focus()},c.prototype.test_active_click=function(b){var c;return c=a(b.target).closest(".chosen-container"),c.length&&this.container[0]===c[0]?this.active_field=!0:this.close_field()},c.prototype.results_build=function(){return this.parsing=!0,this.selected_option_count=null,this.results_data=d.select_to_array(this.form_field),this.is_multiple?this.search_choices.find("li.search-choice").remove():this.is_multiple||(this.single_set_selected_text(),this.disable_search||this.form_field.options.length<=this.disable_search_threshold?(this.search_field[0].readOnly=!0,this.container.addClass("chosen-container-single-nosearch")):(this.search_field[0].readOnly=!1,this.container.removeClass("chosen-container-single-nosearch"))),this.update_results_content(this.results_option_build({first:!0})),this.search_field_disabled(),this.show_search_field_default(),this.search_field_scale(),this.parsing=!1},c.prototype.result_do_highlight=function(a){var b,c,d,e,f;if(a.length){if(this.result_clear_highlight(),this.result_highlight=a,this.result_highlight.addClass("highlighted"),d=parseInt(this.search_results.css("maxHeight"),10),f=this.search_results.scrollTop(),e=d+f,c=this.result_highlight.position().top+this.search_results.scrollTop(),b=c+this.result_highlight.outerHeight(),b>=e)return this.search_results.scrollTop(b-d>0?b-d:0);if(f>c)return this.search_results.scrollTop(c)}},c.prototype.result_clear_highlight=function(){return this.result_highlight&&this.result_highlight.removeClass("highlighted"),this.result_highlight=null},c.prototype.results_show=function(){return this.is_multiple&&this.max_selected_options<=this.choices_count()?(this.form_field_jq.trigger("chosen:maxselected",{chosen:this}),!1):(this.container.addClass("chosen-with-drop"),this.results_showing=!0,this.search_field.focus(),this.search_field.val(this.search_field.val()),this.winnow_results(),this.form_field_jq.trigger("chosen:showing_dropdown",{chosen:this}))},c.prototype.update_results_content=function(a){return this.search_results.html(a)},c.prototype.results_hide=function(){return this.results_showing&&(this.result_clear_highlight(),this.container.removeClass("chosen-with-drop"),this.form_field_jq.trigger("chosen:hiding_dropdown",{chosen:this})),this.results_showing=!1},c.prototype.set_tab_index=function(a){var b;return this.form_field.tabIndex?(b=this.form_field.tabIndex,this.form_field.tabIndex=-1,this.search_field[0].tabIndex=b):void 0},c.prototype.set_label_behavior=function(){var b=this;return this.form_field_label=this.form_field_jq.parents("label"),!this.form_field_label.length&&this.form_field.id.length&&(this.form_field_label=a("label[for='"+this.form_field.id+"']")),this.form_field_label.length>0?this.form_field_label.bind("click.chosen",function(a){return b.is_multiple?b.container_mousedown(a):b.activate_field()}):void 0},c.prototype.show_search_field_default=function(){return this.is_multiple&&this.choices_count()<1&&!this.active_field?(this.search_field.val(this.default_text),this.search_field.addClass("default")):(this.search_field.val(""),this.search_field.removeClass("default"))},c.prototype.search_results_mouseup=function(b){var c;return c=a(b.target).hasClass("active-result")?a(b.target):a(b.target).parents(".active-result").first(),c.length?(this.result_highlight=c,this.result_select(b),this.search_field.focus()):void 0},c.prototype.search_results_mouseover=function(b){var c;return c=a(b.target).hasClass("active-result")?a(b.target):a(b.target).parents(".active-result").first(),c?this.result_do_highlight(c):void 0},c.prototype.search_results_mouseout=function(b){return a(b.target).hasClass("active-result")?this.result_clear_highlight():void 0},c.prototype.choice_build=function(b){var c,d,e=this;return c=a("<li />",{"class":"search-choice"}).html("<span>"+b.html+"</span>"),b.disabled?c.addClass("search-choice-disabled"):(d=a("<a />",{"class":"search-choice-close icon-wb_close","data-option-array-index":b.array_index}),d.bind("click.chosen",function(a){return e.choice_destroy_link_click(a)}),c.append(d)),this.search_container.before(c)},c.prototype.choice_destroy_link_click=function(b){return b.preventDefault(),b.stopPropagation(),this.is_disabled?void 0:this.choice_destroy(a(b.target))},c.prototype.choice_destroy=function(a){return this.result_deselect(a[0].getAttribute("data-option-array-index"))?(this.show_search_field_default(),this.is_multiple&&this.choices_count()>0&&this.search_field.val().length<1&&this.results_hide(),a.parents("li").first().remove(),this.search_field_scale()):void 0},c.prototype.results_reset=function(){return this.reset_single_select_options(),this.form_field.options[0].selected=!0,this.single_set_selected_text(),this.show_search_field_default(),this.results_reset_cleanup(),this.form_field_jq.trigger("change"),this.active_field?this.results_hide():void 0},c.prototype.results_reset_cleanup=function(){return this.current_selectedIndex=this.form_field.selectedIndex,this.selected_item.find("abbr").remove()},c.prototype.result_select=function(a){var b,c;return this.result_highlight?(b=this.result_highlight,
this.result_clear_highlight(),this.is_multiple&&this.max_selected_options<=this.choices_count()?(this.form_field_jq.trigger("chosen:maxselected",{chosen:this}),!1):(this.is_multiple?b.removeClass("active-result"):this.reset_single_select_options(),c=this.results_data[b[0].getAttribute("data-option-array-index")],c.selected=!0,this.form_field.options[c.options_index].selected=!0,this.selected_option_count=null,this.is_multiple?this.choice_build(c):this.single_set_selected_text(c.text),(a.metaKey||a.ctrlKey)&&this.is_multiple||this.results_hide(),this.search_field.val(""),(this.is_multiple||this.form_field.selectedIndex!==this.current_selectedIndex)&&this.form_field_jq.trigger("change",{selected:this.form_field.options[c.options_index].value}),this.current_selectedIndex=this.form_field.selectedIndex,this.search_field_scale())):void 0},c.prototype.single_set_selected_text=function(a){return null==a&&(a=this.default_text),a===this.default_text?this.selected_item.addClass("chosen-default"):(this.single_deselect_control_build(),this.selected_item.removeClass("chosen-default")),this.selected_item.find("span").text(a)},c.prototype.result_deselect=function(a){var b;return b=this.results_data[a],this.form_field.options[b.options_index].disabled?!1:(b.selected=!1,this.form_field.options[b.options_index].selected=!1,this.selected_option_count=null,this.result_clear_highlight(),this.results_showing&&this.winnow_results(),this.form_field_jq.trigger("change",{deselected:this.form_field.options[b.options_index].value}),this.search_field_scale(),!0)},c.prototype.single_deselect_control_build=function(){return this.allow_single_deselect?(this.selected_item.find("abbr").length||this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>'),this.selected_item.addClass("chosen-single-with-deselect")):void 0},c.prototype.get_search_text=function(){return this.search_field.val()===this.default_text?"":a("<div/>").text(a.trim(this.search_field.val())).html()},c.prototype.winnow_results_set_highlight=function(){var a,b;return b=this.is_multiple?[]:this.search_results.find(".result-selected.active-result"),a=b.length?b.first():this.search_results.find(".active-result").first(),null!=a?this.result_do_highlight(a):void 0},c.prototype.no_results=function(b){var c;return c=a('<li class="no-results">'+this.results_none_found+' "<span></span>"</li>'),c.find("span").first().html(b),this.search_results.append(c),this.form_field_jq.trigger("chosen:no_results",{chosen:this})},c.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()},c.prototype.keydown_arrow=function(){var a;return this.results_showing&&this.result_highlight?(a=this.result_highlight.nextAll("li.active-result").first())?this.result_do_highlight(a):void 0:this.results_show()},c.prototype.keyup_arrow=function(){var a;return this.results_showing||this.is_multiple?this.result_highlight?(a=this.result_highlight.prevAll("li.active-result"),a.length?this.result_do_highlight(a.first()):(this.choices_count()>0&&this.results_hide(),this.result_clear_highlight())):void 0:this.results_show()},c.prototype.keydown_backstroke=function(){var a;return this.pending_backstroke?(this.choice_destroy(this.pending_backstroke.find("a").first()),this.clear_backstroke()):(a=this.search_container.siblings("li.search-choice").last(),a.length&&!a.hasClass("search-choice-disabled")?(this.pending_backstroke=a,this.single_backstroke_delete?this.keydown_backstroke():this.pending_backstroke.addClass("search-choice-focus")):void 0)},c.prototype.clear_backstroke=function(){return this.pending_backstroke&&this.pending_backstroke.removeClass("search-choice-focus"),this.pending_backstroke=null},c.prototype.keydown_checker=function(a){var b,c;switch(b=null!=(c=a.which)?c:a.keyCode,this.search_field_scale(),8!==b&&this.pending_backstroke&&this.clear_backstroke(),b){case 8:this.backstroke_length=this.search_field.val().length;break;case 9:this.results_showing&&!this.is_multiple&&this.result_select(a),this.mouse_on_container=!1;break;case 13:a.preventDefault();break;case 38:a.preventDefault(),this.keyup_arrow();break;case 40:a.preventDefault(),this.keydown_arrow()}},c.prototype.search_field_scale=function(){var b,c,d,e,f,g,h,i,j;if(this.is_multiple){for(d=0,h=0,f="position:absolute; left: -1000px; top: -1000px; display:none;",g=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"],i=0,j=g.length;j>i;i++)e=g[i],f+=e+":"+this.search_field.css(e)+";";return b=a("<div />",{style:f}),b.text(this.search_field.val()),a("body").append(b),h=b.width()+25,b.remove(),c=this.container.outerWidth(),h>c-10&&(h=c-10),this.search_field.css({width:h+"px"})}},c}(b)}.call(this),define("chosen",["jquery"],function(){}),define("hbs!modules/template/chat/expanded/add_participant",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<select data-placeholder="Select user(s) to chat with" multiple class="chosen-select add-participant-input"></select>\n<div class="btn-area" style="margin-top: 8px;">\n    <input type="button" class="start-chat btn btn-default" value="START CHAT">\n	&nbsp;&nbsp;&nbsp;\n    <button class="btn btn-xs btn-danger">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"common|cancel",g):i.call(b,"translate","common|cancel",g)))+"</button>\n</div>"})});var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};define("modules/chat/views/chat_sidebar/add_participant_window",["require","exports","../../../chat/models/contacts","modules/export_marionette","backbone.marionette","marionette_handlebars","chosen","underscore","jquery","backbone","modules/common/utility","hbs!modules/template/chat/expanded/add_participant"],function(a,b,c){function d(a){var b=[];return a.forEach(function(a){b.push(i.find_contact_by_name(a))}),b=f.compact(b)}function e(a){var b={};return a.forEach(function(a){b[a]=1}),b}var f=a("underscore"),g=a("jquery"),h=(a("modules/common/utility"),a("hbs!modules/template/chat/expanded/add_participant")),i=c.ContactGroupStore.getInstance(),j=15,k=function(a){function b(b){this.template={type:"handlebars",template:h},this.events={"click .btn-danger":"_cancelBtnClick","click .start-chat":"_startChatClick","change .add-participant-input":"_toggleButtonArea"},this.className="chat-item-add-participant hidden",a.call(this,b)}return __extends(b,a),b.prototype.initialize=function(){f.bindAll(this)},b.prototype._cancelBtnClick=function(a){a.preventDefault(),this.hidePanel()},b.prototype._toggleButtonArea=function(a){var b=this.text_area.val();b&&b.length>0?this.button_area.find("input").removeAttr("disabled"):this.button_area.find("input").attr("disabled","disabled")},b.prototype.onRender=function(){this.text_area=g(".add-participant-input",this.$el),this.button_area=g(".btn-area",this.$el),this.text_area.chosen({max_selected_options:j,display_selected_options:!1,width:"95%"}),g(".search-field>input",this.$el).on("click",function(a){a.stopPropagation()})},b.prototype._triggerContactSelected=function(a){var b={contacts:d(a)},c=jQuery.Event("ContactSelected",b);this.$el.trigger(c),this.trigger("ContactSelected",b),this._resetInput()},b.prototype._resetInput=function(){this.text_area.val([]).trigger("chosen:updated")},b.prototype._startChatClick=function(a){a.preventDefault(),this._triggerContactSelected(this.text_area.val()),this.hidePanel()},b.prototype._populateContent=function(a,b){var c=i.get_all_contacts(),d=e(b),f="<option></option>";c.each(function(a){a.isFusionContact()&&1!==d[a.getUsername()]&&(f+="<option>"+a.getUsername()+"</option>")}),g("input.start-chat",this.$el).text(a.toUpperCase()),this.text_area.html(f),this.text_area.trigger("chosen:updated")},b.prototype.showPanel=function(a,b){return"undefined"==typeof a&&(a=""),"undefined"==typeof b&&(b=[]),this.$el.removeClass("hidden"),this._resetInput(),this._populateContent(a,b),!0},b.prototype.hidePanel=function(){return this._resetInput(),this.$el.addClass("hidden"),!0},b}(Marionette.ItemView);b.AddParticipantView=k}),define("hbs!modules/template/chat/expanded/pinned-area",["handlebars"],function(a){return a.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},'<div class="content"></div>\n<div class="pindrop hidden noshow"><a class="pinlink" href="#"><span class="icon-wb_arrowDown"></span></a></div>'})});var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};define("modules/chat/views/chat_window/chat_pinned_view",["require","exports","../../../view/common/mig33_views","underscore","jquery","backbone","hbs!modules/template/chat/expanded/pinned-area"],function(a,b,c){var d,e=a("hbs!modules/template/chat/expanded/pinned-area"),f=function(a){function b(b){this.tagName="div",this.className="pinned",this.template={type:"handlebars",template:e},this.events={click:"onclick","mouseover .content":"onEnter","mouseout .content":"onLeave","click .pindrop .pinlink":"deactivate"},a.call(this,b)}return __extends(b,a),b.prototype.onRender=function(){this.trigger("display_pinitem")},b.prototype.onEnter=function(){this.$el.parent().hasClass("active")&&($(".pindrop",this.$el).show(),$(".icon-wb_arrowDown",this.$el).addClass("inverse"),clearTimeout(d))},b.prototype.onLeave=function(){var a=this;d=setTimeout(function(){a.$el.parent().hasClass("active")&&$(".pindrop",this.$el).hide()},2500)},b.prototype.activate=function(){this.$el.parent().toggleClass("active")},b.prototype.deactivate=function(a){this.$el.parent().toggleClass("active"),$(".icon-wb_arrowDown",this.$el).removeClass("inverse")},b.prototype.onclick=function(a){a.preventDefault(),this.trigger("select",this.model)},b}(c.ItemView);b.ChatItemView=f}),define("hbs!modules/template/chat/image_message_block",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+='\n        <p class="video-text">',(e=c.text)?d=e.call(a,{hash:{},data:b}):(e=a&&a.text,d=typeof e===k?e.call(a,{hash:{},data:b}):e),(d||0===d)&&(f+=d),f+="</p>\n    "}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var g,h,i,j="",k="function",l=this,m=c.helperMissing,n=this.escapeExpression;return j+="<div>\n    ",h=c.isNotEmpty||b&&b.isNotEmpty,i={hash:{},inverse:l.noop,fn:l.program(1,f,e),data:e},g=h?h.call(b,b&&b.text,i):m.call(b,"isNotEmpty",b&&b.text,i),(g||0===g)&&(j+=g),j+='\n    <a href="',(h=c.url)?g=h.call(b,{hash:{},data:e}):(h=b&&b.url,g=typeof h===k?h.call(b,{hash:{},data:e}):h),j+=n(g)+'" class="fancybox" rel="homefeed">\n        ',(h=c.mime_content)?g=h.call(b,{hash:{},data:e}):(h=b&&b.mime_content,g=typeof h===k?h.call(b,{hash:{},data:e}):h),(g||0===g)&&(j+=g),j+="\n    </a>\n</div>\n"})}),define("modules/chat/util/chatblock_renderer",["require","exports","hbs!modules/template/chat/image_message_block"],function(a,b){function c(b,c,d){var e=a("hbs!modules/template/chat/image_message_block");return e({url:b,mime_content:c,text:d})}b.get_image_message_block=c}),define("modules/view/mimetypes/mimetype_layout_renderer",["require","exports","../../model/mimetypes/mime_types","../../chat/models/user_session"],function(a,b,c,d){function e(b,d,e){switch(e=e?e:{},"object"!=typeof d&&(d=$.parseJSON(d)),c.getMimeType(b)){case 7:var g=a("hbs!modules/template/mimetypes/textplain");return g({text:d.text,color:d.color});case 1:var g=a("hbs!modules/template/mimetypes/textplain");return g({text:d.text,color:d.color});case 2:a("hbs!modules/template/mimetypes/textrich");return g({text:d.text,color:d.color,hotkeys:d.hotkeys});case 5:var h=a("hbs!modules/template/chat/gift_message_block"),i=new c.GiftMimeFactory.GiftMime(d),j=f.get("session_user")===i.sender,k=i.url?i.url:"";return h({is_gift_shower:i.is_gift_shower(),gift_hotkey:i.hotkey,gift_block_id:"hk:"+i.hotkey,gift_message:i.message,recipient_name:i.recipient,sender_name:i.sender,is_self:j,url:k});case 6:var l="st_"+Date.now(),m='<div><img src="" id="'+l+'" class="sticker emoticon-pending" alt="'+d.hotkey+'" title="'+d.hotkey+'"></div>';return d.hotkey&&""!==d.hotkey&&f.trigger_fetch_sticker(d.hotkey,function(a,b){$("#"+l).attr("src",b.url)}),m;case 3:var n=a("hbs!modules/template/mimetypes/image");return n({url:d.url,thumbnailUrl:d.thumbnailUrl,width:d.width,height:d.height,setWidthHeight:!(!d.width||!d.height),text:d.text,"class":e["class"],displayThumbnail:e["display-thumbnail"]?e.display_thumbnail:!1});case 4:var o=a("hbs!modules/template/mimetypes/youtube");return o({url:d.url,wmode:d.wmode?d.wmode:"transparent",allowfullscreen:d.allowfullscreen?d.allowfullscreen:"true",controls:d.controls?d.controls:"1",text:d.text,"class":e["class"],pinneditem:e.pinnedType&&1==e.pinnedType?"pinned-item":""});case 8:var o=a("hbs!modules/template/mimetypes/vimeo");return o({url:d.url,wmode:d.wmode?d.wmode:"transparent",allowfullscreen:d.allowfullscreen?d.allowfullscreen:"true",text:d.text,"class":e["class"],pinneditem:e.pinnedType&&1==e.pinnedType?"pinned-item":""});case 14:var o=a("hbs!modules/template/mimetypes/deezer");return o({id:d.id,showCover:d.showCover?d.showCover:"true",showPlaylist:d.showPlaylist?d.showPlayist:"false",width:d.width,height:d.height,type:d.type?d.type:"radio",text:d.text,"class":e["class"]});case 9:var o=a("hbs!modules/template/mimetypes/flickr");return o({url:d.url,id:d.id,wmode:d.wmode?d.wmode:"transparent",allowfullscreen:d.allowfullscreen?d.allowfullscreen:"true","class":e["class"]});case 10:var o=a("hbs!modules/template/mimetypes/soundcloud");return o({url:d.url,width:d.width?d.width:"100%",height:d.height?d.height:"450",scrolling:d.scrolling?d.scrolling:"no",text:d.text,frameborder:d.frameborder?d.frameborder:"no"});case 11:var p=a("hbs!modules/template/mimetypes/migmelink");return p({image:d.image,title:d.title,url:d.url,description:d.description,characterLimiter:e.characterLimiter});case 12:var q=a("hbs!modules/template/mimetypes/migmeevent");return q({icon_image:d.icon_image,title:d.title,application_title:d.application_title,application_url:d.application_url,application_custom_url:d.application_custom_url,action_button:d.action_button,thumbnail:d.thumbnail,width:e.width,height:e.height});case 13:var r=a("hbs!modules/template/mimetypes/unsupported_block");return r({details:d.message});case 16:var s=a("hbs!modules/template/mimetypes/partnerlink");return s({image:d.image,title:d.title,url:d.url,description:d.description,characterLimiter:e.characterLimiter});case 17:var t=a("hbs!modules/template/mimetypes/badge");return t({username:d.username,badgeName:d.badgeName,description:d.description,imageName:d.imageName});case 18:var u=a("hbs!modules/template/mimetypes/achievement");return u({name:d.title,labelGreetings:d.username+"is a "+d.labelName+"!",description:d.description,imageName:d.labelName.toLowerCase()+"_display.png"});default:var r=a("hbs!modules/template/mimetypes/unsupported_block");return r({details:"This feature is currently not supported."})}}var f=d.Session.getInstance();a("modules/common/utility");b.get_mime_layout=e}),define("hbs!modules/template/chat/gift_block",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i="function";return h+='<div class="fragment-image"><img class="ico ico-32" src="',(g=c.gift_url)?f=g.call(b,{hash:{},data:e}):(g=b&&b.gift_url,f=typeof g===i?g.call(b,{hash:{},data:e}):g),(f||0===f)&&(h+=f),h+='"></img></div>\n'})}),define("hbs!modules/template/chat/chat_message",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){return"col-xs-1"}function g(a,b){return"col-xs-2"}function h(a,b){var d,e="";return e+='<div class="pinner"><a href="#"><span class="icon-wb_music_unpin noshow ',d=c["if"].call(a,a&&a.is_self,{hash:{},inverse:r.noop,fn:r.program(6,i,b),data:b}),(d||0===d)&&(e+=d),e+='"></span></a></div>'}function i(a,b){return" offset-left "}function j(a,b){return"col-xs-10"}function k(a,b){return"col-xs-9"}function l(a,b){return"sticker_msg"}function m(a,b){var d,e,f="";return f+='\n			<div class="chat-msg-username message-source">\n				<a href="/u/',(e=c.source)?d=e.call(a,{hash:{},data:b}):(e=a&&a.source,d=typeof e===s?e.call(a,{hash:{},data:b}):e),f+=t(d)+'">\n					<span class="',(e=c.user_class)?d=e.call(a,{hash:{},data:b}):(e=a&&a.user_class,d=typeof e===s?e.call(a,{hash:{},data:b}):e),f+=t(d)+'" ',(e=c.source_style)?d=e.call(a,{hash:{},data:b}):(e=a&&a.source_style,d=typeof e===s?e.call(a,{hash:{},data:b}):e),f+=t(d)+">",(e=c.source)?d=e.call(a,{hash:{},data:b}):(e=a&&a.source,d=typeof e===s?e.call(a,{hash:{},data:b}):e),f+=t(d)+"</span>\n				</a>\n			</div>\n        "}function n(a,b){return"sticker-msg-time"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var o,p,q="",r=this,s="function",t=this.escapeExpression;return q+='<div class="row chat-message ',(p=c["message-classes"])?o=p.call(b,{hash:{},data:e}):(p=b&&b["message-classes"],o=typeof p===s?p.call(b,{hash:{},data:e}):p),q+=t(o)+'">\n    <div class="',o=c["if"].call(b,b&&b.is_self,{hash:{},inverse:r.program(3,g,e),fn:r.program(1,f,e),data:e}),(o||0===o)&&(q+=o),q+=' no-padding">\n        <div data-username="',(p=c.source)?o=p.call(b,{hash:{},data:e}):(p=b&&b.source,o=typeof p===s?p.call(b,{hash:{},data:e}):p),q+=t(o)+'" class="chat-msg-avatar message-source profile-hovercard ',(p=c.is_source_hidden)?o=p.call(b,{hash:{},data:e}):(p=b&&b.is_source_hidden,o=typeof p===s?p.call(b,{hash:{},data:e}):p),q+=t(o)+'">\n            <a href="/u/',(p=c.source)?o=p.call(b,{hash:{},data:e}):(p=b&&b.source,o=typeof p===s?p.call(b,{hash:{},data:e}):p),q+=t(o)+'">\n                <img height="',(p=c.avatar_height)?o=p.call(b,{hash:{},data:e}):(p=b&&b.avatar_height,o=typeof p===s?p.call(b,{hash:{},data:e}):p),q+=t(o)+'" width="',(p=c.avatar_width)?o=p.call(b,{hash:{},data:e}):(p=b&&b.avatar_width,o=typeof p===s?p.call(b,{hash:{},data:e}):p),q+=t(o)+'" src="',(p=c.avatar_url)?o=p.call(b,{hash:{},data:e}):(p=b&&b.avatar_url,o=typeof p===s?p.call(b,{hash:{},data:e}):p),q+=t(o)+'" class="img-circle" />\n            </a>\n        </div>\n        ',o=c["if"].call(b,b&&b.is_pinnable,{hash:{},inverse:r.noop,fn:r.program(5,h,e),data:e}),(o||0===o)&&(q+=o),q+='\n    </div>\n    <div class="',o=c["if"].call(b,b&&b.is_self,{hash:{},inverse:r.program(10,k,e),fn:r.program(8,j,e),data:e}),(o||0===o)&&(q+=o),q+=" no-padding chat-msg-content ",(p=c.self_msg_status_class)?o=p.call(b,{hash:{},data:e}):(p=b&&b.self_msg_status_class,o=typeof p===s?p.call(b,{hash:{},data:e}):p),q+=t(o)+" ",(p=c.self_msg_hidden_class)?o=p.call(b,{hash:{},data:e}):(p=b&&b.self_msg_hidden_class,o=typeof p===s?p.call(b,{hash:{},data:e}):p),q+=t(o)+" ",o=c["if"].call(b,b&&b.is_sticker,{hash:{},inverse:r.noop,fn:r.program(12,l,e),data:e}),(o||0===o)&&(q+=o),q+='">\n        ',o=c.unless.call(b,b&&b.is_gift,{hash:{},inverse:r.noop,fn:r.program(14,m,e),data:e}),(o||0===o)&&(q+=o),q+='\n        <div class="chat-msg-msg">\n		    ',(p=c.message)?o=p.call(b,{hash:{},data:e}):(p=b&&b.message,o=typeof p===s?p.call(b,{hash:{},data:e}):p),(o||0===o)&&(q+=o),q+='\n        </div>\n        <div class="timestamp-width chat-msg-time ',o=c["if"].call(b,b&&b.is_sticker,{hash:{},inverse:r.noop,fn:r.program(16,n,e),data:e}),(o||0===o)&&(q+=o),q+='">\n		    ',(p=c.formatted_date)?o=p.call(b,{hash:{},data:e}):(p=b&&b.formatted_date,o=typeof p===s?p.call(b,{hash:{},data:e}):p),q+=t(o)+'\n	        <span class="ico ico-received"></span>\n        </div>\n    </div>\n</div>'})}),define("hbs!modules/template/chat/gift_chat_message",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){return'\n<div class="chat-gift-pin">\n    <div class="pinner">\n        <a href="#">\n            <span class="icon-wb_music_unpin"></span>\n        </a>\n    </div>\n</div>\n'}function g(a,b){var c="";return c}function h(a,b){return"gift_msg"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var i,j,k="",l=this,m="function";return i=c["if"].call(b,b&&b.is_pinnable,{hash:{},inverse:l.noop,fn:l.program(1,f,e),data:e}),(i||0===i)&&(k+=i),k+='\n<div class="row chat-message ',i=c["if"].call(b,b&&b.is_self,{hash:{},inverse:l.program(5,h,e),fn:l.program(3,g,e),data:e}),(i||0===i)&&(k+=i),k+='">\n	',(j=c.content)?i=j.call(b,{hash:{},data:e}):(j=b&&b.content,i=typeof j===m?j.call(b,{hash:{},data:e}):j),(i||0===i)&&(k+=i),k+="\n</div>"})}),define("modules/chat/util/message_renderer",["require","exports","../models/user_session","../config/config_ts","./chatblock_renderer","../../view/mimetypes/mimetype_layout_renderer","../../model/mimetypes/def/deezer_mime","underscore","jquery","backbone","modules/common/utility","modules/globals/url","handlebars","underscore.string","hbs!modules/template/chat/gift_block","hbs!modules/template/chat/chat_message","hbs!modules/template/chat/gift_chat_message","modules/common/mime_types_parser"],function(a,b,c,d,e,f,g){function h(a,b){return b=b.split(R.toString()).join(S.toString()),M({gift_name:a,gift_url:b})}function i(a){return a.replace(/([.*+?\^${}()|\[\]\/\\])/g,"\\$1")}function j(a){var b=a.get_image_mime_type_data(),c=b.url,d=b.id;if(b){var g=e.get_image_message_block(c,f.get_mime_layout(a.mime_type,b,{"class":"chat-image "+d,displayThumbnail:!1}),b.text);return a.pinnedType&&1==a.pinnedType&&(g="<div class='pinned-item-img'>"+g+"</div>"),g}}function k(a){var b=/(\b(https?|ftp|file):\/\/[\-A-Z0-9+&@#\/%?=~_|!:,.;]*[\-A-Z0-9+&@#\/%=~_|])/gi,c=a.match(b),d=[];return c&&J.each(c,function(b,c){a=a.replace(b,V({index:c})),d.push("<a class='parsed_link' target='mig33-new-window' href='"+b+"'>"+b+"</a>")}),{message:a,links_array:d}}function l(a,b){return b&&b.length>0&&J.each(b,function(b,c){a=a.replace(V({index:c}),b)}),a}function m(a){return a.replace(/\B@([\w\.\-]+)/gm,'<a href="/u/$1" class="profile-hovercard" data-username="$1">@$1</a>')}function n(a){var b=/\+\[.*?\]/gi;if(!a.match(b))return a;var c=a.match(b)[0];return c=c.split("[")[1].split("]")[0],a.replace(b,'<a data-roomname="'+c+'" href="#">'+c+"</a>")}function o(a){return f.get_mime_layout("application/vnd.migme.error",a)}function p(a,b){var c=a.get_gift_mime_type_data(),d=Q.get("session_user")===c.sender;if(c){var e=O({is_self:d,is_pinnable:!!(b.is_admin(Q.get("session_user"))||b.is_private_chat()||b.is_group_chat()),content:f.get_mime_layout(a.mime_type,c)});return e}}function q(a){var b={"class":"chat-video-object"};return a.pinnedType&&(b.pinnedType=a.pinnedType),f.get_mime_layout(a.mime_type,a.get_youtube_data(),b)}function r(a){return f.get_mime_layout(a.mime_type,a.get_flickr_data(),{"class":"chat-video-object"})}function s(a){var b={"class":"chat-video-object"};return a.pinnedType&&(b.pinnedType=a.pinnedType),f.get_mime_layout(a.mime_type,a.get_vimeo_data(),b)}function t(a){var b=g.getChatWindowConfig(),c=a.get_deezer_data();return c.showCover=b.showCover,c.width=b.width,c.height=b.height,c.playlist=b.playlist,f.get_mime_layout(a.mime_type,c,{"class":"chat-music-deezer"})}function u(a){return f.get_mime_layout(a.mime_type,a.get_soundcloud_data(),{"class":"chat-video-object"})}function v(a){return f.get_mime_layout(a.mime_type,a.get_migmelink_data())}function w(a){var b=f.get_mime_layout(a.mime_type,a.get_plain_text_html()),c=(a.source,a.isSelfMessage()),e=a.is_server_message(),g=a.content_type,h=a.admin_message,i=K.trim(a.emoticons),j=(a.source_colour,a.message_colour),o=a.chatroom_type,p=(a.chatroom_identifier,a.is_sticker()),q=a.destination,r=[];if(b=b.replace(/&apos;/g,"'"),a.is_system_message()&&(b=H.htmlEncode(b)),""!==b&&"\n"!==b){b=J.escape(b),b=b.replace(new RegExp("\\n","g"),"<br />");var s=k(b);b=s.message,r=s.links_array,b=n(b),b=m(b),g!=d.config.Content_Type.file&&(p?(a.mime_type_data&&(i=K.trim(JSON.parse(a.mime_type_data).hotkey)),b=x(a.message,i)):i&&""!==i&&(b=y(b,i))),g!=d.config.Content_Type.emote||a.is_sticker()||(b=J.escape(a.message));var t=A(b);t&&H.send_event_to_ga("Chat","Mentions","Show Mention");var u="message "+z(q,c,e,g,h,o,b,t);b='<span class="'+u+'" '+B(j,null,t)+">"+b+"</span>",a.is_system_message()||g!=d.config.Content_Type.text||e||(b+='<span class="timestamp-width">&nbsp;</span>'),b=l(b,r),a.pinnedType&&0!==a.pinnedType&&(b="<div class='pinned-item-text'>"+b+"</div>")}return b}function x(a,b){var c="st_"+Date.now(),d='<div><img src="" id="'+c+'" class="sticker emoticon-pending" alt="'+b+'" title="'+b+'"><div class="sticker-msg">'+a+"</div></div>";return b&&""!==b&&Q.trigger_fetch_sticker(b,function(a,b){L("#"+c).attr("src",b.url)}),d}function y(a,b){var c=b.split(" ").sort(function(a,b){return b.length-a.length}),d=a,e=[];return J.each(c,function(a,b){if(!(a.length<=0)){var c={reference:"%%"+b+"%%",str:J.escape(a)};e.push(c),d=d.replace(new RegExp(i(c.str),"g"),c.reference)}}),J.each(e,function(a){var b=L.parseHTML(a.str)[0].textContent;d=d.replace(new RegExp(a.reference,"g"),'<img src="" emoticon:id="'+b+'" class="emoticon-pending emoticon" alt="'+b+'" title="'+b+'">')}),d}function z(a,b,c,e,f,g,h,i){var j="";return i&&(j+=" self-mention"),e==d.config.Content_Type.emote?j+=" emote":f?j+=" admin":b?j+=" author":g!=d.config.ChatroomType.group&&g!=d.config.ChatroomType.public_chat||!c?j+=" normal":(j=" server",-1!==h.indexOf(" has entered")?j+=" user-enter useraction icon-wb_chatjoin":-1!==h.indexOf(" has left")&&(j+=" user-left useraction icon-wb_chatleft")),j}function A(a){var b;return a&&a.toLowerCase?(a=a.toLowerCase(),b=Q.get("session_user").toLowerCase(),-1!==a.indexOf("@"+b)):!1}function B(a,b,c){var d="",e="";if(a){var f=parseInt(a,10).toString(16);d='style="color:#'+H.lpad(f,"0",6)+";"+e+'"'}else d=b?'style="color:#'+b+";"+e+'"':'style="'+e+'"';return d}function C(a){var b=a.content_type,c=a.destination,e=a.source,f=a.chatroom_type,g=a.pinnedType;return b==d.config.Content_Type.emote&&!a.is_sticker()||!isNaN(g)&&0!==g?!1:f==d.config.DestinationType.individual||c!=e}function D(a){return a==Q.get("session_user")}function E(b,c){var d="",e=a("modules/mig33_app"),f=a("modules/model/user/user_model");if(d=D(b)?"username-author":c?"username-admin":"username",d+=" ",e.cache.user[b])d+=H.get_userlabel_color(e.cache.user[b].get("label"));else{var g=new f({username:b});g.fetch(),g.on("change",function(){e.cache.user[b]=g,d+=H.get_userlabel_color(e.cache.user[b].get("label")),L("span[class*='username']:contains('"+b+"')",L("div.chat-msg-username")).addClass(d)})}return d}function F(a,b){return a.message_status===d.config.MessageStatus.sent_ok?"msg-sent-ok":a.message_status===d.config.MessageStatus.received?"msg-received":a.message_status===d.config.MessageStatus.sent?"msg-sent":""}function G(a,c){var e=a.source,f=a.admin_message,g=a.source_colour,h=a.time,i=a.message_type===d.config.IM_Type.fusion,k=a.pinnedType,l=a.isSelfMessage(),m="/sites/resources/images/avatar/default-avatar.png",n=new Date,x="HH:MM",y="";if(k||!isNaN(k)&&0!==k||n.setHours(0,0,0,0),(i||l)&&(m=d.config.image_server+"/dp/"+e+"?w="+U+"&h="+T+"&c=1&a=1"),a.message_type==d.config.Message_Type[1]&&a.content_type==d.config.Content_Type.image&&void 0!==typeof a.attributes&&void 0!==typeof a.attributes.content_data){var z=a.attributes.content_data;a.set("mime_type","image/jpg"),a.set("mime_type_data",'{"id":"","url":"'+d.config.image_server+"/"+z+'"}')}if(a.is_image()){var F=JSON.parse(a.mime_type_data),G=j(a);if(F.id&&"flickr-"==F.id.substring(0,7)&&P.get_flickr_image_url(F.id.split("flickr-")[1]),!G)return null;y+=G}else if(a.is_gift()){var I=p(a,c);if(!I)return null;y+=I}else a.is_youtube()?y+=q(a):a.is_flickr()?y+=r(a):a.is_vimeo()?y+=s(a):a.is_deezer()?y+=t(a):a.is_soundcloud()?y+=u(a):a.is_migmelink()?y+=v(a):a.is_text()?y+=w(a):a.is_emote()?y+=w(a):y=o(a);if(C(a)&&""!==y){var J="",K=A(y);K&&(J+=" self-mention"),D(e)&&(J+=" chat-msg-self"),y=N({message_classes:J,source:e,is_source_hidden:D(e)?" hidden":"",avatar_height:T,avatar_width:U,avatar_url:m,is_sticker:a.is_sticker(),is_self:a.isSelfMessage(),is_pinnable:!!(c.is_admin(Q.get("session_user"))||c.is_private_chat()||c.is_group_chat()),self_msg_hidden_class:D(e)?"self-msg":"",self_msg_status_class:D(e)?b.get_message_status_class(a,c):"",is_gift:a.is_gift(),user_class:E(e,f),source_style:B(g,D(e)?"007700":"444444",!1),formatted_date:H.dateFormat(h,x),message:y}),E(e,f)}return y}var H=a("modules/common/utility"),I=(a("modules/globals/url"),a("handlebars")),J=a("underscore"),K=a("underscore.string"),L=a("jquery"),M=a("hbs!modules/template/chat/gift_block"),N=a("hbs!modules/template/chat/chat_message"),O=a("hbs!modules/template/chat/gift_chat_message"),P=a("modules/common/mime_types_parser"),Q=c.Session.getInstance(),R=16,S=64,T=36,U=36;b.render_gift_emoticon=h;var V=I.compile("-!!-{{index}}--!!--");b.get_message_status_class=F,b.render=G}),function(a){"function"==typeof define&&define.amd?define("jquery.scrollTo",["jquery"],a):a(jQuery)}(function(a){function b(b){return a.isFunction(b)||"object"==typeof b?b:{top:b,left:b}}var c=a.scrollTo=function(b,c,d){return a(window).scrollTo(b,c,d)};return c.defaults={axis:"xy",duration:parseFloat(a.fn.jquery)>=1.3?0:1,limit:!0},c.window=function(b){return a(window)._scrollable()},a.fn._scrollable=function(){return this.map(function(){var b=this,c=!b.nodeName||-1!=a.inArray(b.nodeName.toLowerCase(),["iframe","#document","html","body"]);if(!c)return b;var d=(b.contentWindow||b).document||b.ownerDocument||b;return/webkit/i.test(navigator.userAgent)||"BackCompat"==d.compatMode?d.body:d.documentElement})},a.fn.scrollTo=function(d,e,f){return"object"==typeof e&&(f=e,e=0),"function"==typeof f&&(f={onAfter:f}),"max"==d&&(d=9e9),f=a.extend({},c.defaults,f),e=e||f.duration,f.queue=f.queue&&f.axis.length>1,f.queue&&(e/=2),f.offset=b(f.offset),f.over=b(f.over),this._scrollable().each(function(){function g(a){j.animate(l,e,f.easing,a&&function(){a.call(this,k,f)})}if(null!=d){var h,i=this,j=a(i),k=d,l={},m=j.is("html,body");switch(typeof k){case"number":case"string":if(/^([+-]=?)?\d+(\.\d+)?(px|%)?$/.test(k)){k=b(k);break}if(k=a(k,this),!k.length)return;case"object":(k.is||k.style)&&(h=(k=a(k)).offset())}var n=a.isFunction(f.offset)&&f.offset(i,k)||f.offset;a.each(f.axis.split(""),function(a,b){var d="x"==b?"Left":"Top",e=d.toLowerCase(),o="scroll"+d,p=i[o],q=c.max(i,b);if(h)l[o]=h[e]+(m?0:p-j.offset()[e]),f.margin&&(l[o]-=parseInt(k.css("margin"+d))||0,l[o]-=parseInt(k.css("border"+d+"Width"))||0),l[o]+=n[e]||0,f.over[e]&&(l[o]+=k["x"==b?"width":"height"]()*f.over[e]);else{var r=k[e];l[o]=r.slice&&"%"==r.slice(-1)?parseFloat(r)/100*q:r}f.limit&&/^\d+$/.test(l[o])&&(l[o]=l[o]<=0?0:Math.min(l[o],q)),!a&&f.queue&&(p!=l[o]&&g(f.onAfterFirst),delete l[o])}),g(f.onAfter)}}).end()},c.max=function(b,c){var d="x"==c?"Width":"Height",e="scroll"+d;if(!a(b).is("html,body"))return b[e]-a(b)[d.toLowerCase()]();var f="client"+d,g=b.ownerDocument.documentElement,h=b.ownerDocument.body;return Math.max(g[e],h[e])-Math.min(g[f],h[f])},c}),function(){var a=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1},b=[].slice;!function(a,b){return b(a.jQuery,a)}(this,function(c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;return e=c(d),l=a.call(d,"ontouchstart")>=0,h={horizontal:{},vertical:{}},i=1,k={},j="waypoints-context-id",o="resize.waypoints",p="scroll.waypoints",q=1,r="waypoints-waypoint-ids",s="waypoint",t="waypoints",f=function(){function a(a){var b=this;this.$element=a,this.element=a[0],this.didResize=!1,this.didScroll=!1,this.id="context"+i++,this.oldScroll={x:a.scrollLeft(),y:a.scrollTop()},this.waypoints={horizontal:{},vertical:{}},a.data(j,this.id),k[this.id]=this,a.bind(p,function(){var a;return b.didScroll||l?void 0:(b.didScroll=!0,a=function(){return b.doScroll(),b.didScroll=!1},d.setTimeout(a,c[t].settings.scrollThrottle));
}),a.bind(o,function(){var a;return b.didResize?void 0:(b.didResize=!0,a=function(){return c[t]("refresh"),b.didResize=!1},d.setTimeout(a,c[t].settings.resizeThrottle))})}return a.prototype.doScroll=function(){var a,b=this;return a={horizontal:{newScroll:this.$element.scrollLeft(),oldScroll:this.oldScroll.x,forward:"right",backward:"left"},vertical:{newScroll:this.$element.scrollTop(),oldScroll:this.oldScroll.y,forward:"down",backward:"up"}},!l||a.vertical.oldScroll&&a.vertical.newScroll||c[t]("refresh"),c.each(a,function(a,d){var e,f,g;return g=[],f=d.newScroll>d.oldScroll,e=f?d.forward:d.backward,c.each(b.waypoints[a],function(a,b){var c,e;return d.oldScroll<(c=b.offset)&&c<=d.newScroll?g.push(b):d.newScroll<(e=b.offset)&&e<=d.oldScroll?g.push(b):void 0}),g.sort(function(a,b){return a.offset-b.offset}),f||g.reverse(),c.each(g,function(a,b){return b.options.continuous||a===g.length-1?b.trigger([e]):void 0})}),this.oldScroll={x:a.horizontal.newScroll,y:a.vertical.newScroll}},a.prototype.refresh=function(){var a,b,d,e=this;return d=c.isWindow(this.element),b=this.$element.offset(),this.doScroll(),a={horizontal:{contextOffset:d?0:b.left,contextScroll:d?0:this.oldScroll.x,contextDimension:this.$element.width(),oldScroll:this.oldScroll.x,forward:"right",backward:"left",offsetProp:"left"},vertical:{contextOffset:d?0:b.top,contextScroll:d?0:this.oldScroll.y,contextDimension:d?c[t]("viewportHeight"):this.$element.height(),oldScroll:this.oldScroll.y,forward:"down",backward:"up",offsetProp:"top"}},c.each(a,function(a,b){return c.each(e.waypoints[a],function(a,d){var e,f,g,h,i;return e=d.options.offset,g=d.offset,f=c.isWindow(d.element)?0:d.$element.offset()[b.offsetProp],c.isFunction(e)?e=e.apply(d.element):"string"==typeof e&&(e=parseFloat(e),d.options.offset.indexOf("%")>-1&&(e=Math.ceil(b.contextDimension*e/100))),d.offset=f-b.contextOffset+b.contextScroll-e,d.options.onlyOnScroll&&null!=g||!d.enabled?void 0:null!==g&&g<(h=b.oldScroll)&&h<=d.offset?d.trigger([b.backward]):null!==g&&g>(i=b.oldScroll)&&i>=d.offset?d.trigger([b.forward]):null===g&&b.oldScroll>=d.offset?d.trigger([b.forward]):void 0})})},a.prototype.checkEmpty=function(){return c.isEmptyObject(this.waypoints.horizontal)&&c.isEmptyObject(this.waypoints.vertical)?(this.$element.unbind([o,p].join(" ")),delete k[this.id]):void 0},a}(),g=function(){function a(a,b,d){var e,f;d=c.extend({},c.fn[s].defaults,d),"bottom-in-view"===d.offset&&(d.offset=function(){var a;return a=c[t]("viewportHeight"),c.isWindow(b.element)||(a=b.$element.height()),a-c(this).outerHeight()}),this.$element=a,this.element=a[0],this.axis=d.horizontal?"horizontal":"vertical",this.callback=d.handler,this.context=b,this.enabled=d.enabled,this.id="waypoints"+q++,this.offset=null,this.options=d,b.waypoints[this.axis][this.id]=this,h[this.axis][this.id]=this,e=null!=(f=a.data(r))?f:[],e.push(this.id),a.data(r,e)}return a.prototype.trigger=function(a){return this.enabled?(null!=this.callback&&this.callback.apply(this.element,a),this.options.triggerOnce?this.destroy():void 0):void 0},a.prototype.disable=function(){return this.enabled=!1},a.prototype.enable=function(){return this.context.refresh(),this.enabled=!0},a.prototype.destroy=function(){return delete h[this.axis][this.id],delete this.context.waypoints[this.axis][this.id],this.context.checkEmpty()},a.getWaypointsByElement=function(a){var b,d;return(d=c(a).data(r))?(b=c.extend({},h.horizontal,h.vertical),c.map(d,function(a){return b[a]})):[]},a}(),n={init:function(a,b){var d;return null==b&&(b={}),null==(d=b.handler)&&(b.handler=a),this.each(function(){var a,d,e,h;return a=c(this),e=null!=(h=b.context)?h:c.fn[s].defaults.context,c.isWindow(e)||(e=a.closest(e)),e=c(e),d=k[e.data(j)],d||(d=new f(e)),new g(a,d,b)}),c[t]("refresh"),this},disable:function(){return n._invoke(this,"disable")},enable:function(){return n._invoke(this,"enable")},destroy:function(){return n._invoke(this,"destroy")},prev:function(a,b){return n._traverse.call(this,a,b,function(a,b,c){return b>0?a.push(c[b-1]):void 0})},next:function(a,b){return n._traverse.call(this,a,b,function(a,b,c){return b<c.length-1?a.push(c[b+1]):void 0})},_traverse:function(a,b,e){var f,g;return null==a&&(a="vertical"),null==b&&(b=d),g=m.aggregate(b),f=[],this.each(function(){var b;return b=c.inArray(this,g[a]),e(f,b,g[a])}),this.pushStack(f)},_invoke:function(a,b){return a.each(function(){var a;return a=g.getWaypointsByElement(this),c.each(a,function(a,c){return c[b](),!0})}),this}},c.fn[s]=function(){var a,d;return d=arguments[0],a=2<=arguments.length?b.call(arguments,1):[],n[d]?n[d].apply(this,a):c.isFunction(d)?n.init.apply(this,arguments):c.isPlainObject(d)?n.init.apply(this,[null,d]):d?c.error("The "+d+" method does not exist in jQuery Waypoints."):c.error("jQuery Waypoints needs a callback function or handler option.")},c.fn[s].defaults={context:d,continuous:!0,enabled:!0,horizontal:!1,offset:0,triggerOnce:!1},m={refresh:function(){return c.each(k,function(a,b){return b.refresh()})},viewportHeight:function(){var a;return null!=(a=d.innerHeight)?a:e.height()},aggregate:function(a){var b,d,e;return b=h,a&&(b=null!=(e=k[c(a).data(j)])?e.waypoints:void 0),b?(d={horizontal:[],vertical:[]},c.each(d,function(a,e){return c.each(b[a],function(a,b){return e.push(b)}),e.sort(function(a,b){return a.offset-b.offset}),d[a]=c.map(e,function(a){return a.element}),d[a]=c.unique(d[a])}),d):[]},above:function(a){return null==a&&(a=d),m._filter(a,"vertical",function(a,b){return b.offset<=a.oldScroll.y})},below:function(a){return null==a&&(a=d),m._filter(a,"vertical",function(a,b){return b.offset>a.oldScroll.y})},left:function(a){return null==a&&(a=d),m._filter(a,"horizontal",function(a,b){return b.offset<=a.oldScroll.x})},right:function(a){return null==a&&(a=d),m._filter(a,"horizontal",function(a,b){return b.offset>a.oldScroll.x})},enable:function(){return m._invoke("enable")},disable:function(){return m._invoke("disable")},destroy:function(){return m._invoke("destroy")},extendFn:function(a,b){return n[a]=b},_invoke:function(a){var b;return b=c.extend({},h.vertical,h.horizontal),c.each(b,function(b,c){return c[a](),!0})},_filter:function(a,b,d){var e,f;return(e=k[c(a).data(j)])?(f=[],c.each(e.waypoints[b],function(a,b){return d(e,b)?f.push(b):void 0}),f.sort(function(a,b){return a.offset-b.offset}),c.map(f,function(a){return a.element})):[]}},c[t]=function(){var a,c;return c=arguments[0],a=2<=arguments.length?b.call(arguments,1):[],m[c]?m[c].apply(null,a):m.aggregate.call(null,c)},c[t].settings={resizeThrottle:100,scrollThrottle:30},e.load(function(){return c[t]("refresh")})})}.call(this),define("jquery.waypoints",["jquery"],function(){}),function(a){var b={init:function(b){var c={set_width:!1,set_height:!1,horizontalScroll:!1,scrollInertia:950,mouseWheel:!0,mouseWheelPixels:"auto",autoDraggerLength:!0,autoHideScrollbar:!1,alwaysShowScrollbar:!1,snapAmount:null,snapOffset:0,scrollButtons:{enable:!1,scrollType:"continuous",scrollSpeed:"auto",scrollAmount:40},advanced:{updateOnBrowserResize:!0,updateOnContentResize:!1,autoExpandHorizontalScroll:!1,autoScrollOnFocus:!0,normalizeMouseWheelDelta:!1},contentTouchScroll:!0,callbacks:{onScrollStart:function(){},onScroll:function(){},onTotalScroll:function(){},onTotalScrollBack:function(){},onTotalScrollOffset:0,onTotalScrollBackOffset:0,whileScrolling:function(){}},theme:"light"},b=a.extend(!0,c,b);return this.each(function(){var c=a(this);if(b.set_width&&c.css("width",b.set_width),b.set_height&&c.css("height",b.set_height),a(document).data("mCustomScrollbar-index")){var d=parseInt(a(document).data("mCustomScrollbar-index"));a(document).data("mCustomScrollbar-index",d+1)}else a(document).data("mCustomScrollbar-index","1");c.wrapInner("<div class='mCustomScrollBox mCS-"+b.theme+"' id='mCSB_"+a(document).data("mCustomScrollbar-index")+"' style='position:relative; height:100%; overflow:hidden; max-width:100%;' />").addClass("mCustomScrollbar _mCS_"+a(document).data("mCustomScrollbar-index"));var e=c.children(".mCustomScrollBox");if(b.horizontalScroll){e.addClass("mCSB_horizontal").wrapInner("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />");var f=e.children(".mCSB_h_wrapper");f.wrapInner("<div class='mCSB_container' style='position:absolute; left:0;' />").children(".mCSB_container").css({width:f.children().outerWidth(),position:"relative"}).unwrap()}else e.wrapInner("<div class='mCSB_container' style='position:relative; top:0;' />");var g=e.children(".mCSB_container");a.support.touch&&g.addClass("mCS_touch"),g.after("<div class='mCSB_scrollTools' style='position:absolute;'><div class='mCSB_draggerContainer'><div class='mCSB_dragger' style='position:absolute;' oncontextmenu='return false;'><div class='mCSB_dragger_bar' style='position:relative;'></div></div><div class='mCSB_draggerRail'></div></div></div>");var h=e.children(".mCSB_scrollTools"),i=h.children(".mCSB_draggerContainer"),j=i.children(".mCSB_dragger");if(b.horizontalScroll?j.data("minDraggerWidth",j.width()):j.data("minDraggerHeight",j.height()),b.scrollButtons.enable&&(b.horizontalScroll?h.prepend("<a class='mCSB_buttonLeft' oncontextmenu='return false;'></a>").append("<a class='mCSB_buttonRight' oncontextmenu='return false;'></a>"):h.prepend("<a class='mCSB_buttonUp' oncontextmenu='return false;'></a>").append("<a class='mCSB_buttonDown' oncontextmenu='return false;'></a>")),e.bind("scroll",function(){c.is(".mCS_disabled")||e.scrollTop(0).scrollLeft(0)}),c.data({mCS_Init:!0,mCustomScrollbarIndex:a(document).data("mCustomScrollbar-index"),horizontalScroll:b.horizontalScroll,scrollInertia:b.scrollInertia,scrollEasing:"mcsEaseOut",mouseWheel:b.mouseWheel,mouseWheelPixels:b.mouseWheelPixels,autoDraggerLength:b.autoDraggerLength,autoHideScrollbar:b.autoHideScrollbar,alwaysShowScrollbar:b.alwaysShowScrollbar,snapAmount:b.snapAmount,snapOffset:b.snapOffset,scrollButtons_enable:b.scrollButtons.enable,scrollButtons_scrollType:b.scrollButtons.scrollType,scrollButtons_scrollSpeed:b.scrollButtons.scrollSpeed,scrollButtons_scrollAmount:b.scrollButtons.scrollAmount,autoExpandHorizontalScroll:b.advanced.autoExpandHorizontalScroll,autoScrollOnFocus:b.advanced.autoScrollOnFocus,normalizeMouseWheelDelta:b.advanced.normalizeMouseWheelDelta,contentTouchScroll:b.contentTouchScroll,onScrollStart_Callback:b.callbacks.onScrollStart,onScroll_Callback:b.callbacks.onScroll,onTotalScroll_Callback:b.callbacks.onTotalScroll,onTotalScrollBack_Callback:b.callbacks.onTotalScrollBack,onTotalScroll_Offset:b.callbacks.onTotalScrollOffset,onTotalScrollBack_Offset:b.callbacks.onTotalScrollBackOffset,whileScrolling_Callback:b.callbacks.whileScrolling,bindEvent_scrollbar_drag:!1,bindEvent_content_touch:!1,bindEvent_scrollbar_click:!1,bindEvent_mousewheel:!1,bindEvent_buttonsContinuous_y:!1,bindEvent_buttonsContinuous_x:!1,bindEvent_buttonsPixels_y:!1,bindEvent_buttonsPixels_x:!1,bindEvent_focusin:!1,bindEvent_autoHideScrollbar:!1,mCSB_buttonScrollRight:!1,mCSB_buttonScrollLeft:!1,mCSB_buttonScrollDown:!1,mCSB_buttonScrollUp:!1}),b.horizontalScroll)"none"!==c.css("max-width")&&(b.advanced.updateOnContentResize||(b.advanced.updateOnContentResize=!0));else if("none"!==c.css("max-height")){var k=!1,l=parseInt(c.css("max-height"));c.css("max-height").indexOf("%")>=0&&(k=l,l=c.parent().height()*k/100),c.css("overflow","hidden"),e.css("max-height",l)}if(c.mCustomScrollbar("update"),b.advanced.updateOnBrowserResize){var m,n=a(window).width(),o=a(window).height();a(window).bind("resize."+c.data("mCustomScrollbarIndex"),function(){m&&clearTimeout(m),m=setTimeout(function(){if(!c.is(".mCS_disabled")&&!c.is(".mCS_destroyed")){var b=a(window).width(),d=a(window).height();n===b&&o===d||("none"!==c.css("max-height")&&k&&e.css("max-height",c.parent().height()*k/100),c.mCustomScrollbar("update"),n=b,o=d)}},150)})}if(b.advanced.updateOnContentResize){var p;if(b.horizontalScroll)var q=g.outerWidth();else var q=g.outerHeight();p=setInterval(function(){if(b.horizontalScroll){b.advanced.autoExpandHorizontalScroll&&g.css({position:"absolute",width:"auto"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({width:g.outerWidth(),position:"relative"}).unwrap();var a=g.outerWidth()}else var a=g.outerHeight();a!=q&&(c.mCustomScrollbar("update"),q=a)},300)}})},update:function(){var b=a(this),c=b.children(".mCustomScrollBox"),d=c.children(".mCSB_container");d.removeClass("mCS_no_scrollbar"),b.removeClass("mCS_disabled mCS_destroyed"),c.scrollTop(0).scrollLeft(0);var e=c.children(".mCSB_scrollTools"),f=e.children(".mCSB_draggerContainer"),g=f.children(".mCSB_dragger");if(b.data("horizontalScroll")){var h=e.children(".mCSB_buttonLeft"),i=e.children(".mCSB_buttonRight"),j=c.width();b.data("autoExpandHorizontalScroll")&&d.css({position:"absolute",width:"auto"}).wrap("<div class='mCSB_h_wrapper' style='position:relative; left:0; width:999999px;' />").css({width:d.outerWidth(),position:"relative"}).unwrap();var k=d.outerWidth()}else var l=e.children(".mCSB_buttonUp"),m=e.children(".mCSB_buttonDown"),n=c.height(),o=d.outerHeight();if(o>n&&!b.data("horizontalScroll")){e.css("display","block");var p=f.height();if(b.data("autoDraggerLength")){var q=Math.round(n/o*p),r=g.data("minDraggerHeight");if(r>=q)g.css({height:r});else if(q>=p-10){var s=p-10;g.css({height:s})}else g.css({height:q});g.children(".mCSB_dragger_bar").css({"line-height":g.height()+"px"})}var t=g.height(),u=(o-n)/(p-t);b.data("scrollAmount",u).mCustomScrollbar("scrolling",c,d,f,g,l,m,h,i);var v=Math.abs(d.position().top);b.mCustomScrollbar("scrollTo",v,{scrollInertia:0,trigger:"internal"})}else if(k>j&&b.data("horizontalScroll")){e.css("display","block");var w=f.width();if(b.data("autoDraggerLength")){var x=Math.round(j/k*w),y=g.data("minDraggerWidth");if(y>=x)g.css({width:y});else if(x>=w-10){var z=w-10;g.css({width:z})}else g.css({width:x})}var A=g.width(),u=(k-j)/(w-A);b.data("scrollAmount",u).mCustomScrollbar("scrolling",c,d,f,g,l,m,h,i);var v=Math.abs(d.position().left);b.mCustomScrollbar("scrollTo",v,{scrollInertia:0,trigger:"internal"})}else c.unbind("mousewheel focusin"),b.data("horizontalScroll")?g.add(d).css("left",0):g.add(d).css("top",0),b.data("alwaysShowScrollbar")?b.data("horizontalScroll")?b.data("horizontalScroll")&&g.css({width:f.width()}):g.css({height:f.height()}):(e.css("display","none"),d.addClass("mCS_no_scrollbar")),b.data({bindEvent_mousewheel:!1,bindEvent_focusin:!1})},scrolling:function(b,d,e,f,g,h,i,j){function k(a,b,c,d){n.data("horizontalScroll")?n.mCustomScrollbar("scrollTo",f.position().left-b+d,{moveDragger:!0,trigger:"internal"}):n.mCustomScrollbar("scrollTo",f.position().top-a+c,{moveDragger:!0,trigger:"internal"})}function l(a){f.data("preventAction")||(f.data("preventAction",!0),n.mCustomScrollbar("scrollTo",a,{trigger:"internal"}))}function m(){var a=n.data("scrollButtons_scrollSpeed");return"auto"===n.data("scrollButtons_scrollSpeed")&&(a=Math.round((n.data("scrollInertia")+100)/40)),a}var n=a(this);if(!n.data("bindEvent_scrollbar_drag")){var o,p,q,r,s;a.support.pointer?(q="pointerdown",r="pointermove",s="pointerup"):a.support.msPointer&&(q="MSPointerDown",r="MSPointerMove",s="MSPointerUp"),a.support.pointer||a.support.msPointer?(f.bind(q,function(b){b.preventDefault(),n.data({on_drag:!0}),f.addClass("mCSB_dragger_onDrag");var c=a(this),d=c.offset(),e=b.originalEvent.pageX-d.left,g=b.originalEvent.pageY-d.top;e<c.width()&&e>0&&g<c.height()&&g>0&&(o=g,p=e)}),a(document).bind(r+"."+n.data("mCustomScrollbarIndex"),function(a){if(a.preventDefault(),n.data("on_drag")){var b=f,c=b.offset(),d=a.originalEvent.pageX-c.left,e=a.originalEvent.pageY-c.top;k(o,p,e,d)}}).bind(s+"."+n.data("mCustomScrollbarIndex"),function(a){n.data({on_drag:!1}),f.removeClass("mCSB_dragger_onDrag")})):(f.bind("mousedown touchstart",function(b){b.preventDefault(),b.stopImmediatePropagation();var c,d,e=a(this),g=e.offset();if("touchstart"===b.type){var h=b.originalEvent.touches[0]||b.originalEvent.changedTouches[0];c=h.pageX-g.left,d=h.pageY-g.top}else n.data({on_drag:!0}),f.addClass("mCSB_dragger_onDrag"),c=b.pageX-g.left,d=b.pageY-g.top;c<e.width()&&c>0&&d<e.height()&&d>0&&(o=d,p=c)}).bind("touchmove",function(b){b.preventDefault(),b.stopImmediatePropagation();var c=b.originalEvent.touches[0]||b.originalEvent.changedTouches[0],d=a(this),e=d.offset(),f=c.pageX-e.left,g=c.pageY-e.top;k(o,p,g,f)}),a(document).bind("mousemove."+n.data("mCustomScrollbarIndex"),function(a){if(n.data("on_drag")){var b=f,c=b.offset(),d=a.pageX-c.left,e=a.pageY-c.top;k(o,p,e,d)}}).bind("mouseup."+n.data("mCustomScrollbarIndex"),function(a){n.data({on_drag:!1}),f.removeClass("mCSB_dragger_onDrag")})),n.data({bindEvent_scrollbar_drag:!0})}if(a.support.touch&&n.data("contentTouchScroll")&&!n.data("bindEvent_content_touch")){var t,u,v,w,x,y,z;d.bind("touchstart",function(b){b.stopImmediatePropagation(),t=b.originalEvent.touches[0]||b.originalEvent.changedTouches[0],u=a(this),v=u.offset(),x=t.pageX-v.left,w=t.pageY-v.top,y=w,z=x}),d.bind("touchmove",function(b){b.preventDefault(),b.stopImmediatePropagation(),t=b.originalEvent.touches[0]||b.originalEvent.changedTouches[0],u=a(this).parent(),v=u.offset(),x=t.pageX-v.left,w=t.pageY-v.top,n.data("horizontalScroll")?n.mCustomScrollbar("scrollTo",z-x,{trigger:"internal"}):n.mCustomScrollbar("scrollTo",y-w,{trigger:"internal"})})}if(n.data("bindEvent_scrollbar_click")||(e.bind("click",function(b){var c=(b.pageY-e.offset().top)*n.data("scrollAmount"),d=a(b.target);n.data("horizontalScroll")&&(c=(b.pageX-e.offset().left)*n.data("scrollAmount")),(d.hasClass("mCSB_draggerContainer")||d.hasClass("mCSB_draggerRail"))&&n.mCustomScrollbar("scrollTo",c,{trigger:"internal",scrollEasing:"draggerRailEase"})}),n.data({bindEvent_scrollbar_click:!0})),n.data("mouseWheel")&&(n.data("bindEvent_mousewheel")||(b.bind("mousewheel",function(a,b){var c,g=n.data("mouseWheelPixels"),h=Math.abs(d.position().top),i=f.position().top,j=e.height()-f.height();n.data("normalizeMouseWheelDelta")&&(b=0>b?-1:1),"auto"===g&&(g=100+Math.round(n.data("scrollAmount")/2)),n.data("horizontalScroll")&&(i=f.position().left,j=e.width()-f.width(),h=Math.abs(d.position().left)),(b>0&&0!==i||0>b&&i!==j)&&(a.preventDefault(),a.stopImmediatePropagation()),c=h-b*g,n.mCustomScrollbar("scrollTo",c,{trigger:"internal"})}),n.data({bindEvent_mousewheel:!0}))),n.data("scrollButtons_enable"))if("pixels"===n.data("scrollButtons_scrollType"))n.data("horizontalScroll")?(j.add(i).unbind("mousedown touchstart MSPointerDown pointerdown mouseup MSPointerUp pointerup mouseout MSPointerOut pointerout touchend",A,B),n.data({bindEvent_buttonsContinuous_x:!1}),n.data("bindEvent_buttonsPixels_x")||(j.bind("click",function(a){a.preventDefault(),l(Math.abs(d.position().left)+n.data("scrollButtons_scrollAmount"))}),i.bind("click",function(a){a.preventDefault(),l(Math.abs(d.position().left)-n.data("scrollButtons_scrollAmount"))}),n.data({bindEvent_buttonsPixels_x:!0}))):(h.add(g).unbind("mousedown touchstart MSPointerDown pointerdown mouseup MSPointerUp pointerup mouseout MSPointerOut pointerout touchend",A,B),n.data({bindEvent_buttonsContinuous_y:!1}),n.data("bindEvent_buttonsPixels_y")||(h.bind("click",function(a){a.preventDefault(),l(Math.abs(d.position().top)+n.data("scrollButtons_scrollAmount"))}),g.bind("click",function(a){a.preventDefault(),l(Math.abs(d.position().top)-n.data("scrollButtons_scrollAmount"))}),n.data({bindEvent_buttonsPixels_y:!0})));else if(n.data("horizontalScroll")){if(j.add(i).unbind("click"),n.data({bindEvent_buttonsPixels_x:!1}),!n.data("bindEvent_buttonsContinuous_x")){j.bind("mousedown touchstart MSPointerDown pointerdown",function(a){a.preventDefault();var b=m();n.data({mCSB_buttonScrollRight:setInterval(function(){n.mCustomScrollbar("scrollTo",Math.abs(d.position().left)+b,{trigger:"internal",scrollEasing:"easeOutCirc"})},17)})});var A=function(a){a.preventDefault(),clearInterval(n.data("mCSB_buttonScrollRight"))};j.bind("mouseup touchend MSPointerUp pointerup mouseout MSPointerOut pointerout",A),i.bind("mousedown touchstart MSPointerDown pointerdown",function(a){a.preventDefault();var b=m();n.data({mCSB_buttonScrollLeft:setInterval(function(){n.mCustomScrollbar("scrollTo",Math.abs(d.position().left)-b,{trigger:"internal",scrollEasing:"easeOutCirc"})},17)})});var B=function(a){a.preventDefault(),clearInterval(n.data("mCSB_buttonScrollLeft"))};i.bind("mouseup touchend MSPointerUp pointerup mouseout MSPointerOut pointerout",B),n.data({bindEvent_buttonsContinuous_x:!0})}}else if(h.add(g).unbind("click"),n.data({bindEvent_buttonsPixels_y:!1}),!n.data("bindEvent_buttonsContinuous_y")){h.bind("mousedown touchstart MSPointerDown pointerdown",function(a){a.preventDefault();var b=m();n.data({mCSB_buttonScrollDown:setInterval(function(){n.mCustomScrollbar("scrollTo",Math.abs(d.position().top)+b,{trigger:"internal",scrollEasing:"easeOutCirc"})},17)})});var C=function(a){a.preventDefault(),clearInterval(n.data("mCSB_buttonScrollDown"))};h.bind("mouseup touchend MSPointerUp pointerup mouseout MSPointerOut pointerout",C),g.bind("mousedown touchstart MSPointerDown pointerdown",function(a){a.preventDefault();var b=m();n.data({mCSB_buttonScrollUp:setInterval(function(){n.mCustomScrollbar("scrollTo",Math.abs(d.position().top)-b,{trigger:"internal",scrollEasing:"easeOutCirc"})},17)})});var D=function(a){a.preventDefault(),clearInterval(n.data("mCSB_buttonScrollUp"))};g.bind("mouseup touchend MSPointerUp pointerup mouseout MSPointerOut pointerout",D),n.data({bindEvent_buttonsContinuous_y:!0})}n.data("autoScrollOnFocus")&&(n.data("bindEvent_focusin")||(b.bind("focusin",function(){b.scrollTop(0).scrollLeft(0);var c=a(document.activeElement);if(c.is("input,textarea,select,button,a[tabindex],area,object")){var e=d.position().top,f=c.position().top,g=b.height()-c.outerHeight();n.data("horizontalScroll")&&(e=d.position().left,f=c.position().left,g=b.width()-c.outerWidth()),(0>e+f||e+f>g)&&n.mCustomScrollbar("scrollTo",f,{trigger:"internal"})}}),n.data({bindEvent_focusin:!0}))),n.data("autoHideScrollbar")&&!n.data("alwaysShowScrollbar")&&(n.data("bindEvent_autoHideScrollbar")||(b.bind("mouseenter",function(a){b.addClass("mCS-mouse-over"),c.showScrollbar.call(b.children(".mCSB_scrollTools"))}).bind("mouseleave touchend",function(a){b.removeClass("mCS-mouse-over"),"mouseleave"===a.type&&c.hideScrollbar.call(b.children(".mCSB_scrollTools"))}),n.data({bindEvent_autoHideScrollbar:!0})))},scrollTo:function(b,d){function e(a){if(k.data("mCustomScrollbarIndex"))switch(this.mcs={top:n.position().top,left:n.position().left,draggerTop:q.position().top,draggerLeft:q.position().left,topPct:Math.round(100*Math.abs(n.position().top)/Math.abs(n.outerHeight()-m.height())),leftPct:Math.round(100*Math.abs(n.position().left)/Math.abs(n.outerWidth()-m.width()))},a){case"onScrollStart":k.data("mCS_tweenRunning",!0).data("onScrollStart_Callback").call(k,this.mcs);break;case"whileScrolling":k.data("whileScrolling_Callback").call(k,this.mcs);break;case"onScroll":k.data("onScroll_Callback").call(k,this.mcs);break;case"onTotalScrollBack":k.data("onTotalScrollBack_Callback").call(k,this.mcs);break;case"onTotalScroll":k.data("onTotalScroll_Callback").call(k,this.mcs)}}var f,g,h,i,j,k=a(this),l={moveDragger:!1,trigger:"external",callbacks:!0,scrollInertia:k.data("scrollInertia"),scrollEasing:k.data("scrollEasing")},d=a.extend(l,d),m=k.children(".mCustomScrollBox"),n=m.children(".mCSB_container"),o=m.children(".mCSB_scrollTools"),p=o.children(".mCSB_draggerContainer"),q=p.children(".mCSB_dragger"),r=draggerSpeed=d.scrollInertia;if(!n.hasClass("mCS_no_scrollbar")&&(k.data({mCS_trigger:d.trigger}),k.data("mCS_Init")&&(d.callbacks=!1),b||0===b)){if("number"==typeof b)d.moveDragger?(f=b,b=k.data("horizontalScroll")?q.position().left*k.data("scrollAmount"):q.position().top*k.data("scrollAmount"),draggerSpeed=0):f=b/k.data("scrollAmount");else if("string"==typeof b){var s;s="top"===b?0:"bottom"!==b||k.data("horizontalScroll")?"left"===b?0:"right"===b&&k.data("horizontalScroll")?n.outerWidth()-m.width():"first"===b?k.find(".mCSB_container").find(":first"):"last"===b?k.find(".mCSB_container").find(":last"):k.find(b):n.outerHeight()-m.height(),1===s.length?(b=k.data("horizontalScroll")?s.position().left:s.position().top,f=b/k.data("scrollAmount")):f=b=s}if(k.data("horizontalScroll")){k.data("onTotalScrollBack_Offset")&&(h=-k.data("onTotalScrollBack_Offset")),k.data("onTotalScroll_Offset")&&(j=m.width()-n.outerWidth()+k.data("onTotalScroll_Offset")),0>f?(f=b=0,clearInterval(k.data("mCSB_buttonScrollLeft")),h||(g=!0)):f>=p.width()-q.width()?(f=p.width()-q.width(),b=m.width()-n.outerWidth(),clearInterval(k.data("mCSB_buttonScrollRight")),j||(i=!0)):b=-b;var t=k.data("snapAmount");t&&(b=Math.round(b/t)*t-k.data("snapOffset")),c.mTweenAxis.call(this,q[0],"left",Math.round(f),draggerSpeed,d.scrollEasing),c.mTweenAxis.call(this,n[0],"left",Math.round(b),r,d.scrollEasing,{onStart:function(){d.callbacks&&!k.data("mCS_tweenRunning")&&e("onScrollStart"),k.data("autoHideScrollbar")&&!k.data("alwaysShowScrollbar")&&c.showScrollbar.call(o)},onUpdate:function(){d.callbacks&&e("whileScrolling")},onComplete:function(){d.callbacks&&(e("onScroll"),(g||h&&n.position().left>=h)&&e("onTotalScrollBack"),(i||j&&n.position().left<=j)&&e("onTotalScroll")),q.data("preventAction",!1),k.data("mCS_tweenRunning",!1),k.data("autoHideScrollbar")&&!k.data("alwaysShowScrollbar")&&(m.hasClass("mCS-mouse-over")||c.hideScrollbar.call(o))}})}else{k.data("onTotalScrollBack_Offset")&&(h=-k.data("onTotalScrollBack_Offset")),k.data("onTotalScroll_Offset")&&(j=m.height()-n.outerHeight()+k.data("onTotalScroll_Offset")),0>f?(f=b=0,clearInterval(k.data("mCSB_buttonScrollUp")),h||(g=!0)):f>=p.height()-q.height()?(f=p.height()-q.height(),b=m.height()-n.outerHeight(),clearInterval(k.data("mCSB_buttonScrollDown")),j||(i=!0)):b=-b;var t=k.data("snapAmount");t&&(b=Math.round(b/t)*t-k.data("snapOffset")),c.mTweenAxis.call(this,q[0],"top",Math.round(f),draggerSpeed,d.scrollEasing),c.mTweenAxis.call(this,n[0],"top",Math.round(b),r,d.scrollEasing,{onStart:function(){d.callbacks&&!k.data("mCS_tweenRunning")&&e("onScrollStart"),k.data("autoHideScrollbar")&&!k.data("alwaysShowScrollbar")&&c.showScrollbar.call(o)},onUpdate:function(){d.callbacks&&e("whileScrolling")},onComplete:function(){d.callbacks&&(e("onScroll"),(g||h&&n.position().top>=h)&&e("onTotalScrollBack"),(i||j&&n.position().top<=j)&&e("onTotalScroll")),q.data("preventAction",!1),k.data("mCS_tweenRunning",!1),k.data("autoHideScrollbar")&&!k.data("alwaysShowScrollbar")&&(m.hasClass("mCS-mouse-over")||c.hideScrollbar.call(o))}})}k.data("mCS_Init")&&k.data({mCS_Init:!1})}},stop:function(){var b=a(this),d=b.children().children(".mCSB_container"),e=b.children().children().children().children(".mCSB_dragger");c.mTweenAxisStop.call(this,d[0]),c.mTweenAxisStop.call(this,e[0])},disable:function(b){var c=a(this),d=c.children(".mCustomScrollBox"),e=d.children(".mCSB_container"),f=d.children(".mCSB_scrollTools"),g=f.children().children(".mCSB_dragger");d.unbind("mousewheel focusin mouseenter mouseleave touchend"),e.unbind("touchstart touchmove"),b&&(c.data("horizontalScroll")?g.add(e).css("left",0):g.add(e).css("top",0)),f.css("display","none"),e.addClass("mCS_no_scrollbar"),c.data({bindEvent_mousewheel:!1,bindEvent_focusin:!1,bindEvent_content_touch:!1,bindEvent_autoHideScrollbar:!1}).addClass("mCS_disabled")},destroy:function(){var b=a(this);b.removeClass("mCustomScrollbar _mCS_"+b.data("mCustomScrollbarIndex")).addClass("mCS_destroyed").children().children(".mCSB_container").unwrap().children().unwrap().siblings(".mCSB_scrollTools").remove(),a(document).unbind("mousemove."+b.data("mCustomScrollbarIndex")+" mouseup."+b.data("mCustomScrollbarIndex")+" MSPointerMove."+b.data("mCustomScrollbarIndex")+" MSPointerUp."+b.data("mCustomScrollbarIndex")),a(window).unbind("resize."+b.data("mCustomScrollbarIndex"))}},c={showScrollbar:function(){this.stop().animate({opacity:1},"fast")},hideScrollbar:function(){this.stop().animate({opacity:0},"fast")},mTweenAxis:function(a,b,c,d,e,f){function g(){return window.performance&&window.performance.now?window.performance.now():window.performance&&window.performance.webkitNow?window.performance.webkitNow():Date.now?Date.now():(new Date).getTime()}function h(){r||n.call(),r=g()-q,i(),r>=a._time&&(a._time=r>a._time?r+m-(r-a._time):r+m-1,a._time<r+1&&(a._time=r+1)),a._time<d?a._id=_request(h):p.call()}function i(){d>0?(a.currVal=l(a._time,s,u,d,e),t[b]=Math.round(a.currVal)+"px"):t[b]=c+"px",o.call()}function j(){m=1e3/60,a._time=r+m,_request=window.requestAnimationFrame?window.requestAnimationFrame:function(a){return i(),setTimeout(a,.01)},a._id=_request(h)}function k(){null!=a._id&&(window.requestAnimationFrame?window.cancelAnimationFrame(a._id):clearTimeout(a._id),a._id=null)}function l(a,b,c,d,e){switch(e){case"linear":return c*a/d+b;case"easeOutQuad":return a/=d,-c*a*(a-2)+b;case"easeInOutQuad":return a/=d/2,1>a?c/2*a*a+b:(a--,-c/2*(a*(a-2)-1)+b);case"easeOutCubic":return a/=d,a--,c*(a*a*a+1)+b;case"easeOutQuart":return a/=d,a--,-c*(a*a*a*a-1)+b;case"easeOutQuint":return a/=d,a--,c*(a*a*a*a*a+1)+b;case"easeOutCirc":return a/=d,a--,c*Math.sqrt(1-a*a)+b;case"easeOutSine":return c*Math.sin(a/d*(Math.PI/2))+b;case"easeOutExpo":return c*(-Math.pow(2,-10*a/d)+1)+b;case"mcsEaseOut":var f=(a/=d)*a,g=f*a;return b+c*(.499999999999997*g*f+-2.5*f*f+5.5*g+-6.5*f+4*a);case"draggerRailEase":return a/=d/2,1>a?c/2*a*a*a+b:(a-=2,c/2*(a*a*a+2)+b)}}var m,f=f||{},n=f.onStart||function(){},o=f.onUpdate||function(){},p=f.onComplete||function(){},q=g(),r=0,s=a.offsetTop,t=a.style;"left"===b&&(s=a.offsetLeft);var u=c-s;k(),j()},mTweenAxisStop:function(a){null!=a._id&&(window.requestAnimationFrame?window.cancelAnimationFrame(a._id):clearTimeout(a._id),a._id=null)},rafPolyfill:function(){for(var a=["ms","moz","webkit","o"],b=a.length;--b>-1&&!window.requestAnimationFrame;)window.requestAnimationFrame=window[a[b]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[a[b]+"CancelAnimationFrame"]||window[a[b]+"CancelRequestAnimationFrame"]}};c.rafPolyfill.call(),a.support.touch=!!("ontouchstart"in window),a.support.pointer=window.navigator.pointerEnabled,a.support.msPointer=window.navigator.msPointerEnabled;var d="https:"==document.location.protocol?"https:":"http:";a.event.special.mousewheel||document.write('<script src="'+d+'//cdnjs.cloudflare.com/ajax/libs/jquery-mousewheel/3.0.6/jquery.mousewheel.min.js"></script>'),a.fn.mCustomScrollbar=function(c){return b[c]?b[c].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof c&&c?void a.error("Method "+c+" does not exist"):b.init.apply(this,arguments)}}(jQuery),define("jquery.mCustomScrollbar",["jquery","jquery.mousewheel"],function(){}),define("modules/chat/util/avatar_cache",["underscore","backbone","jquery"],function(a,b){var c={},d=new b.Collection;return a.extend(c,b.Events),a.extend(c,{get_avatar_data:function(a){var b=this,c=$.ajax("/sites/json/avatar_api/get_image_key",{type:"GET",data:{username:a},timeout:5e3});c.success(function(a){b.save_data(a)}),c.fail(function(){b.trigger("avatar_error",{username:a})})},get_avatar_key:function(b){var c=d.get(b);a.isUndefined(c)||a.isNull(c)?this.get_avatar_data(b):(this.trigger("head_key",b,c.get("keys").head_key),this.trigger("body_key",b,c.get("keys").body_key))},save_data:function(a,b){d.add({id:a,keys:{head_key:b.head_key,body_key:b.body_key}}),this.trigger("head_key",a,b.head_key),this.trigger("body_key",a,b.body_key)}}),c}),define("modules/chat/util/emoticon_cache",["underscore","backbone","jquery"],function(a,b){var c=function(){},d=new b.Collection;return a.extend(c,b.Events),a.extend(c,{_get_emoticon_data:function(b,c,e){var f=this,g=$.ajax("/sites/ajax/api/get_emoticon",{type:"POST",dataType:"json",beforeSend:function(a){a.setRequestHeader("Content-Type","application/json"),a.setRequestHeader("X-Mig33-JSON-Version","2")},data:JSON.stringify(b)});g.success(function(b){a.each(b.emoticons,function(a){
d.get(a.hk)||d.add({id:a.hk,data:a})},this),c&&c.call(e||f,b.emoticons),f.trigger("cachefilled")}),g.fail(function(){f.trigger("cache_failed")})},_load_emoticon:function(b,c,e){var f=this,g=[],h=[];a.isArray(b)||(b=b.split(" ")),a.each(b,function(a){d.get(a)?g.push(d.get(a).get("data")):h.push(a)}),c&&g.length>0&&c.call(e||f,g),0!==h.length&&this._get_emoticon_data({hotkeys:h},c,e)},get_cached_emoticon:function(a){return d.get(a)?d.get(a).get("data"):null},get_emoticon:function(a,b,c){a&&0!==a.length&&(d.get(a)?b&&b.call(c||this,d.get(a).get("data")):this._load_emoticon(a,b,c))},get_emoticons:function(b,c,d){if(b&&0!==b.length){var e=[];this._load_emoticon(b,function(b){a.each(b,function(a){e.push(a)}),c&&c.call(d||this,e)},this)}}}),c}),define("modules/common/guardset",["underscore","modules/common/local_storage","modules/globals/settings"],function(a,b,c){var d=function(){var a=require("modules/common/session_user").getInstance();return a.hasInitialized()?a.get("username")+"::":""},e=function(a){return d()+a},f={};return f.KEYS={EXPERIMENTAL:"EXPERIMENTAL",CHAT_SMART_PREVIEW:"CHAT_SMART_PREVIEW"},f.enableAllExperimental=function(){var b=this;a.each(this.KEYS,function(a,c){a!=b.KEYS.EXPERIMENTAL&&b.enableFeature(a)}),this.enableExperimental()},f.disableAllExperimental=function(){var b=this;a.each(this.KEYS,function(a,c){a!=b.KEYS.EXPERIMENTAL&&b.disableFeature(a)}),this.disableExperimental()},f.enableFeature=function(a){var c=require("modules/common/session_user").getInstance();return c.hasInitialized()?b.get(e(a)):!1},f.disableFeature=function(a){var c=require("modules/common/session_user").getInstance();return c.hasInitialized()?b.get(e(a)):!1},f.isExperimental=function(){if(c.force_experimetals_off)return!1;var a=require("modules/common/session_user").getInstance();return a.hasInitialized()?b.get(e(this.KEYS.EXPERIMENTAL)):!1},f.enableExperimental=function(){return c.force_experimetals_off?!1:void this.enableFeature(this.KEYS.EXPERIMENTAL)},f.disableExperimental=function(){this.disableFeature(this.KEYS.EXPERIMENTAL)},f.isFeatureEnabled=function(a){var c=require("modules/common/session_user").getInstance();return c.hasInitialized()?this.isExperimental()&&b.get(e(a)):!1},f}),define("modules/chat/views/chat_smart_preview",["modules/common/guardset","jquery","underscore"],function(a,b,c){var d=window.location.protocol,e=d+"//noembed.com/embed",f=d+"//noembed.com/providers",g=!1,h=!1,i=b.Deferred(),j=[],k={};return k._init=function(){var a=i.promise();return g||h?a:(b.ajax({url:f,jsonp:"callback",dataType:"jsonp",timeout:5e3,success:function(a){h=!0,g=!1,j=a,i.resolve(a)},error:function(){g=!1,i.reject("Failed to communicate with embed api server")}}),g=!0,a)},k._check_valid_url=function(a){var b=!1,d=null;return c.each(j,function(e){!b&&e.patterns&&c.isArray(e.patterns)&&c.each(e.patterns,function(c){if(!b){var f=new RegExp(c);b=f.test(a),b&&(d={pattern:c,name:e.name})}})}),b},k._get_embed_data=function(a){var c=b.Deferred();return b.ajax({url:e,jsonp:"callback",dataType:"jsonp",timeout:5e3,data:{url:a},success:function(a){c.resolve(a)},error:function(){c.reject("Failed to communicate with embed api server")}}),c.promise()},k.getEmbedData=function(c){if(!a.isFeatureEnabled(a.KEYS.EXPERIMENTAL))return!1;var d=b.Deferred(),e=this;return this._init().done(function(){e._check_valid_url(c)?e._get_embed_data(c).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}):d.reject("URL passed is not supported by the service")}).fail(function(a){d.reject(a)}),d.promise()},k}),define("modules/chat/views/chat_message_panel",["require","exports","../util/message_renderer","modules/chat/config/config_ts","underscore","jquery","backbone","handlebars","jquery.scrollTo","jquery.waypoints","jquery.mCustomScrollbar","modules/chat/util/avatar_cache","modules/chat/util/emoticon_cache","modules/chat/views/chat_smart_preview","modules/common/utility","hbs!modules/template/chat/image_message_block","hbs!modules/template/chat/chat_message"],function(a,b,c,d){var e=a("modules/common/utility"),f=a("modules/chat/views/chat_smart_preview"),g=(a("modules/chat/util/avatar_cache"),a("modules/chat/util/emoticon_cache")),h=a("handlebars"),i=h.compile("<li id='{{message_id}}'>{{{message_html}}}<div class='link_placeholder'></div></li>"),j=h.compile("<li><div class='message server timestamp-separator'>{{{dateStr}}}</div></li>"),k=h.compile("<div class='top-block load-more'>{{translate 'common|loading'}}...</div>"),l=h.compile("<div class='top-block load-more-error'><i class='glyphicon glyphicon-exclamation-sign'></i>&nbsp;{{translate 'chat|load-message-error'}}...</div>"),m=a("underscore"),n=a("jquery"),o=40,p=function(a){var b=n(this).data("roomname");b&&(a.preventDefault(),window.mig33.chatroom_manager.join_chatroom(b))},q=function(){function b(a,b){var c=this;this.$el=n(a),this.$message_container=this.$el.find("ul"),this.messages=[],this.messages_to_render=[],this.infocus=!1,this.chat_model=b,this.isLoadingMessages=!1,this.auto_retry=2,this.auto_delay=0,this.$loadingMessage=n(k()).hide(),this.$loadingErrorMessage=n(l()).hide(),this.$el.append(this.$loadingMessage),this.$el.append(this.$loadingErrorMessage),this.$loadingErrorMessage.on("click",function(a){a.preventDefault(),c.chat_model.fetchRecentMessages()}),this.debounced_show_message=m.debounce(this.show_message,50),m.defer(function(){c.listenToChatModel(b),c.displayChatMessages(b.getMessages()),c.chat_model.fetchRecentMessages()}),this.listen_to_scroll(),this.listen_to_app_events()}return b.prototype.listen_to_app_events=function(){var b=this,c=a("modules/mig33_app");c.vent.on(c.ApplicationEvents.CHAT_SESSION_CONNECTED,function(){b.chat_model.fetchRecentMessages()})},b.prototype.listen_to_scroll=function(){var a=this,b=m.debounce(function(b){a.$el.scrollTop()<10&&!a.isLoadingMessages&&(a.get_more_messages(a.chat_model.getFirstMessage()),a.$loadingErrorMessage.finish().delay(2e3).slideUp())},100);this.$el.on("scroll",b)},b.prototype.listenToChatModel=function(a){var b=this;a.on("chat_message_added",function(a){b.messages_to_render.push(a),b.debounced_show_message()}),a.on("pin_chat",function(a){b.$el.prev().addClass("active"),a.pinnedType=1;var d=c.render(a,b.chat_model);a.pinnedType=0,b.$el.prev().find(".content").html(d),b.$el.prev().find(".pindrop").removeClass("hidden"),a.get("emoticons")?b.fetch_emoticons(a.get("emoticons"),a):"application/vnd.migme.gift"===a.mime_type&&b.fetch_emoticons(JSON.parse(a.mime_type_data).hotkey,a)}),a.on("send_pin_chat",function(a){b.send_pin_msg(a)}),a.on("fetch_messages_start",function(){b.isLoadingMessages=!0,b.$loadingErrorMessage.slideUp(),b.$loadingMessage.finish().slideDown()}),a.on("fetch_messages_stop",function(){b.isLoadingMessages=!1,b.$loadingMessage.finish().delay(2e3).slideUp()}),a.on("fetch_messages_error",function(){var a=b;b.$loadingErrorMessage.show(),b.auto_retry>0&&(b.auto_retry--,setTimeout(function(){a.chat_model.fetchRecentMessages()},b.auto_delay),0===b.auto_delay?b.auto_delay=1e3:b.auto_delay*=1.5)})},b.prototype.displayChatMessages=function(a){var b=this;this.$el.scroll(function(){n("li",b.$el).removeClass("top-visible").each(function(){return n(this).position().top>=0?(n(this).addClass("top-visible"),!1):void 0})}),a.each(function(a){b.messages_to_render.push(a)}),this.debounced_show_message()},b.prototype.get_top_visible_message=function(){var a=null;return n("li",this.$el).each(function(){return null===a&&n(this).position().top>=0?void(a=n(this)):void 0}),a},b.prototype.set_infocus=function(a){this.infocus=a,a?m.delay(function(){n.waypoints("refresh")},1e3):this.show_unread_divider()},b.prototype.is_scrollbar_at_bottom=function(){var a=this.$el.height(),b=this.$el.prop("scrollHeight"),c=this.$el.scrollTop(),d=a>=b,e=a+c>=b-o;return d||e},b.prototype.get_more_messages=function(a){if(!a)return void this.chat_model.fetchRecentMessages();var b,c,e,f;c=a.time.getTime(),e=this.chat_model.get_prev_message(a),m.isEmpty(e)?f=this.chat_model.fetchMessages(0,c,d.config.message_fetch_count):(b=e.time.getTime(),f=this.chat_model.fetchMessages(b,c,d.config.message_fetch_count))},b.prototype.parse_embedable_links=function(a){var b=this,c=[];n("a.parsed_link",a).each(function(){c.push(n(b).attr("href"))}),m.each(c,function(b){var c=f.getEmbedData(b);c&&c.done(function(b){n(".link_placeholder",a).append(b.html)})})},b.prototype.show_message=function(){var a=this,b=this.get_top_visible_message(),d=this.is_scrollbar_at_bottom();this.scroller_placeholder&&(this.scroller_placeholder.remove(),this.scroller_placeholder=null),this.messages_to_render=m.sortBy(this.messages_to_render,function(a){return-a.timestamp}),m.each(this.messages_to_render,function(b){1===b.pinnedType&&(a.chat_model.trigger("pin_chat",b),b.pinnedType=1);var d=c.render(b,a.chat_model);if(d){var e=n(a.build_message_el(d,b));1===b.pinnedType&&e.addClass("hidden"),e.on("mouseover",function(a){n(".icon-wb_music_unpin",e).removeClass("noshow")}),e.on("mouseout",function(a){n(".icon-wb_music_unpin",e).addClass("noshow")}),n(".icon-wb_music_unpin",e).on("click",function(c){c.preventDefault(),a.chat_model.trigger("pin_chat",b),a.chat_model.trigger("send_pin_chat",b)}),a.messages.push(e);var f,g,h,i,j=!1;if(g=a.chat_model.get_next_message(b),f=a.chat_model.get_prev_message(b),g&&0!==n("#"+g.message_id,a.$message_container).length){var k=new Date(+g.timestamp),l=new Date(+b.timestamp);if(h=n("#"+g.message_id,a.$message_container),h.before(e),j=g.source===b.source,k.getDay()!==l.getDay()){var m=n(a.build_timestamp_separator(l));h.before(m)}else b.is_plain_message()&&j&&n(".message-source",h).hide()}else f&&0!==n("#"+f.message_id,a.$message_container).length?(i=n("#"+f.message_id,a.$message_container),i.after(e)):a.$message_container.append(e)}a.listen_to_message_model(b)}),m.each(this.messages_to_render,function(b){var c,d=n("#"+b.message_id,a.$message_container);if(a.chat_model.is_prev_message_contiguous(b)){if(c=a.chat_model.get_prev_message(b)){var f=c.source===b.source;c.is_plain_message()&&f&&n(".message-source",d).hide()}}else;e.createFancyBox(n(".fancybox",d)),d.waypoint(function(c){a.chat_model.set_last_read_message(b)},{context:a.$el,triggerOnce:!0,offset:function(){return a.infocus?a.$el.height()-d.height():-9e4}}),a.fetch_emoticons(b.get("emoticons"),b),n("a",d).click(p),a.parse_embedable_links(d),e.parse_profile_hovercard(d)}),this.messages_to_render=[],this.scroller_placeholder=n("<li>&nbsp;</li>").css({height:"5px",width:"100%"}),this.$message_container.append(this.scroller_placeholder),this.is_scrollbar_at_bottom()&&this.infocus&&this.remove_unread_divider(),d&&(this.infocus||this.chat_model.is_chat_room())?(!this.infocus&&this.chat_model.is_chat_room()&&this.show_unread_divider(),this.$el.scrollTo(this.scroller_placeholder)):(b&&b.length>0&&this.$el.scrollTop(this.$el.scrollTop()+b.position().top),this.infocus||this.show_unread_divider())},b.prototype.listen_to_message_model=function(a){var b=this;a.on("change:message_status",function(){console.log("message status was changed"),console.log(a.message_status),n("#"+a.message_id,b.$el).find(".self-msg").removeClass("msg-sent").removeClass("msg-sent-ok").removeClass("msg-received").addClass(c.get_message_status_class(a,b.chat_model))})},b.prototype.fetch_emoticons=function(a,b){if(a=n.trim(a),!m.isUndefined(a)&&null!==a&&"undefined"!=a){var d=!1,e=this;g.get_emoticons(a,function(){var a=e.$message_container.parent().parent().find(".emoticon-pending");a.each(function(a,e){var f=n(e),h=f.attr("emoticon:id"),i=g.get_cached_emoticon(h);if(i&&!b.is_gift())f.attr("src",i.url),f.removeClass("emoticon-pending"),"VIBRATION"==i.t&&(d=!0);else if(i){var j=c.render_gift_emoticon(i.a,i.url);f.replaceWith(n(j))}})},this)}},b.prototype.build_timestamp_separator=function(a){var b=["January","February","March","April","May","June","July","August","September","October","November","December"],c=b[a.getMonth()]+" "+a.getDay()+", "+a.getFullYear();return j({dateStr:c})},b.prototype.build_message_el=function(a,b){return i({message_id:b.message_id,message_html:a})},b.prototype.show_unread_divider=function(){var a=this.chat_model.get_last_read_message_id(),b=this.chat_model.getLastMessage();if(this.remove_unread_divider(),b&&a&&a!=b.message_id){var c=n("#"+a,this.$message_container);c.after("<li class='unreadmessage'>"+e.translate("chat|unread_message")+"</li>")}},b.prototype.remove_unread_divider=function(){n("li.unreadmessage",this.$message_container).remove()},b.prototype.send_pin_msg=function(a){var b,c=this.chat_model.attributes;c.destination?b=c.destination:c.destinationName&&(b=c.destinationName),b&&window.mig33.chatroom_manager.send_pin_item(b,a)},b}();b.MessagePanel=q}),define("modules/chat/views/emoticon_panel",["handlebars","modules/chat/util/emoticon_cache","modules/chat/models/user_session","backbone","underscore","jquery","qtip"],function(a,b,c,d,e){var f=c.Session.getInstance(),g=a.compile('<div class="emoticon"><a href="#" id="{{hk}}" data-hk="{{hk}}" hidefocus="on"><img src="{{url}}" border=0 height=16 width=16></a></div>'),h=function(){this.is_panel_rendered=!1,this.$el=$("<div class='emoticon-container'></div>")},i=h.prototype;return e.extend(i,d.Events),e.extend(i,{render:function(){return this.$el.append("<div>loading...</div>"),this.render_gift_content(),this.is_panel_rendered=!0,this.$el},getContent:function(){var a=this;return $("a",this.$el).off("click"),$("a",this.$el).on("click",function(b){b.preventDefault();var c=$(this).data("hk");a.trigger("select",c)}),this.$el},render_gift_content:function(){var a=this;b.get_emoticons(f.emoticon_hotkeys.join(" "),function(b){a.$el.empty(),e.each(b,function(b){var c=$(g(b));a.$el.append(c)})})}}),h}),function(a){a.fn.easyPaginate=function(b){function c(){clearTimeout(j),e=(p-1)*l,f=e+l,a(m).each(function(c){var d=a(this);d.hide(),c>=e&&f>c&&setTimeout(function(){d.fadeIn("fast")},(c-Math.floor(c/l)*l)*b.delay),b.nextprev&&(f>=n?h.fadeOut("fast"):h.fadeIn("fast"),e>=1?i.fadeIn("fast"):i.fadeOut("fast"))}),a("li","#"+b.controls).removeClass(b.current),a('li[data-index="'+p+'"]',"#"+b.controls).addClass(b.current),b.auto&&(b.clickstop&&q||(j=setTimeout(d,b.pause)))}function d(){b.loop&&f>=n&&(p=0,c()),n>f&&(p++,c())}var e,f,g,h,i,j,k={step:4,delay:100,numeric:!0,nextprev:!0,auto:!1,loop:!1,pause:4e3,clickstop:!0,controls:"pagination",current:"current",randomstart:!1},b=a.extend(k,b),l=b.step,m=a(this).children(),n=m.length,o=Math.floor(n/l),p=b.randomstart?Math.floor(Math.random()*o)+1:1,q=!1;this.each(function(){if(g=this,n>l){n/l>o&&o++;var d=a('<ol id="'+b.controls+'"></ol>').insertAfter(g);if(b.nextprev&&(i=a('<li class="prev">Previous</li>').hide().appendTo(d).click(function(){q=!0,p--,c()})),b.numeric)for(var e=1;o>=e;e++)a('<li data-index="'+e+'">'+e+"</li>").appendTo(d).click(function(){q=!0,p=a(this).attr("data-index"),c()});b.nextprev&&(h=a('<li class="next">Next</li>').hide().appendTo(d).click(function(){q=!0,p++,c()})),c()}})}}(jQuery),define("easypaginate",["jquery"],function(){}),define("modules/chat/views/sticker_panel",["handlebars","modules/chat/util/emoticon_cache","modules/chat/models/user_session","modules/common/utility","underscore","backbone","jquery","easypaginate","qtip"],function(a,b,c,d,e,f){var g=(c.Session.getInstance(),a.compile('<div class="emoticon sticker"><a href="#" data-alias="{{alias}}" id="{{hk}}" hidefocus="on" title="/sticker {{alias}}"><img src="{{url}}" border=0></a></div>')),h=a.compile('<div class="top"><div class="header">'+d.translate("chat|pick_sticker_title")+'</div><div class="instruction">'+d.translate("chat|pick_sticker_message")+"</div></div>"),i=function(){this.$el=$("<div class='emoticon-container'>"+h()+d.translate("common|loading")+"...</div>"),this.render_one=!1,this.sticker_dom_by_hk={}},j=i.prototype;return e.extend(j,f.Events),e.extend(j,{render:function(){return this.$el},getContent:function(){var a=this;return $("a",this.$el).off("click"),$("a",this.$el).on("click",function(b){b.preventDefault();var c=$(this).data("alias");a.trigger("select",c)}),this.$el},renderSticker:function(a){if(this.render_one||(this.$el.empty(),this.$el.append(h()),this.render_one=!0),!this.sticker_dom_by_hk[a.hotkey]){var b=$(g({hk:a.hotkey,url:a.url,alias:a.alias}));this.sticker_dom_by_hk[a.hotkey]=b,b.appendTo(this.$el)}}}),i}),define("modules/chat/views/gift_panel",["handlebars","modules/chat/models/user_session","modules/common/utility","backbone","underscore","jquery","qtip"],function(a,b,c,d,e){var f=b.Session.getInstance(),g={},h=a.compile('<div class="emoticon gift"><a href="#" id="{{hk}}" data-url="{{url}}" data-cost="{{cost}}" data-name="{{a}}" data-originalhk="{{hk}}" data-hk="{{a}}"  hidefocus="on" title="{{a}} - {{cost}}" style="width:100%;height:100%;"><img src="{{url}}" style="width:80%;" border=0></a></div>'),i=a.compile('<div class="top"><div class="header">'+c.translate("chat|pick_gift_title")+'</div><div class="instruction">'+c.translate("chat|pick_gift_message")+"</div></div>"),j=function(){this.is_panel_rendered=!1,this.$el=$("<div class='emoticon-container'></div>")},k=j.prototype;return e.extend(k,d.Events),e.extend(k,{render:function(){return this.$el.append(i()),this.$el.append("<br/><div>loading...</div>"),f.virtual_gifts?this.render_gift_content():f.on("virtual_gifts_loaded",function(){this.render_gift_content()},this),this.$el},getContent:function(){var a=this;return $("a",this.$el).off("click"),$("a",this.$el).on("click",function(b){b.preventDefault();var c=$(this).data("hk"),d=$(this).data("originalhk"),e=$(this).data("name"),f=$(this).data("url"),h=$(this).data("cost"),i=g[d];a.trigger("select",{hk:c,name:e,url:f,cost:h,giftmodel:i})}),this.$el},render_gift_content:function(){var a=f.virtual_gifts;if(a){var b=this;b.$el.empty(),this.$el.append(i()),a.each(function(a){g[a.get("referenceData").hotKey]=a;var c={hk:a.get("referenceData").hotKey,a:a.get("referenceData").name,cost:a.getLocalPrice(),url:a.getImageURL("64x64PNG")},d=$(h(c));b.$el.append(d)}),this.is_panel_rendered=!0}}}),j}),define("hbs!modules/template/chat/window/emote-footer",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+="<div>"+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"toybox|more_emoticons",g):i.call(b,"translate","toybox|more_emoticons",g)))+'</div>\n<a class="btn btn-xs btn-default dropdown-toggle goto_store" data-href="/store/category/3/new/" type="button">\n    <span class="icon-wb_store"></span>&nbsp;'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"toybox|goto_store",g):i.call(b,"translate","toybox|goto_store",g)))+"\n</a>"})}),define("modules/globals/session_user_settings",[],function(){var a=window.session_user_settings;return a||console.log("Warn: Session user settings is not found"),a}),function(a){"function"==typeof define&&define.amd?define("jquery.timeago",["jquery","modules/common/utility"],a):a(jQuery)}(function(a,b){function c(){var b=d(this),c=g.settings;return isNaN(b.datetime)||(0==c.cutoff||f(b.datetime)<c.cutoff)&&a(this).text(e(b.datetime)),this}function d(b){if(b=a(b),!b.data("timeago")){b.data("timeago",{datetime:g.datetime(b)});var c=a.trim(b.text());g.settings.localeTitle?b.attr("title",b.data("timeago").datetime.toLocaleString()):!(c.length>0)||g.isTime(b)&&b.attr("title")||b.attr("title",c)}return b.data("timeago")}function e(a){return g.inWords(f(a))}function f(a){return(new Date).getTime()-a.getTime()}a.timeago=function(b){return e(b instanceof Date?b:"string"==typeof b?a.timeago.parse(b):"number"==typeof b?new Date(b):a.timeago.datetime(b))};var g=a.timeago;a.extend(a.timeago,{settings:{refreshMillis:6e4,allowFuture:!1,localeTitle:!1,cutoff:0,strings:{prefixAgo:null,prefixFromNow:null,suffixAgo:null,suffixFromNow:null,seconds:b.translate("time|moments_ago"),minute:b.translate("time|1_minute_ago"),minutes:b.translate("time|x_minutes_ago").replace("$1","%d"),hour:b.translate("time|1_hour_ago"),hours:b.translate("time|x_hours_ago").replace("$1","%d"),day:b.translate("time|1_day_ago"),days:b.translate("time|x_days_ago").replace("$1","%d"),month:b.translate("time|1_month_ago"),months:b.translate("time|x_months_ago").replace("$1","%d"),year:b.translate("time|1_year_ago"),years:b.translate("time|x_years_ago").replace("$1","%d"),wordSeparator:" ",numbers:[]}},inWords:function(b){function c(c,e){var f=a.isFunction(c)?c(e,b):c,g=d.numbers&&d.numbers[e]||e;return f.replace(/%d/i,g)}var d=this.settings.strings,e=d.prefixAgo,f=d.suffixAgo;this.settings.allowFuture&&0>b&&(e=d.prefixFromNow,f=d.suffixFromNow);var g=Math.abs(b)/1e3,h=g/60,i=h/60,j=i/24,k=j/365,l=45>g&&c(d.seconds,Math.round(g))||90>g&&c(d.minute,1)||45>h&&c(d.minutes,Math.round(h))||90>h&&c(d.hour,1)||24>i&&c(d.hours,Math.round(i))||42>i&&c(d.day,1)||30>j&&c(d.days,Math.round(j))||45>j&&c(d.month,1)||365>j&&c(d.months,Math.round(j/30))||1.5>k&&c(d.year,1)||c(d.years,Math.round(k)),m=d.wordSeparator||"";return void 0===d.wordSeparator&&(m=" "),a.trim([e,l,f].join(m))},parse:function(b){var c=a.trim(b);return c=c.replace(/\.\d+/,""),c=c.replace(/-/,"/").replace(/-/,"/"),c=c.replace(/T/," ").replace(/Z/," UTC"),c=c.replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2"),new Date(c)},datetime:function(b){var c=g.isTime(b)?a(b).attr("datetime"):a(b).attr("title");return g.parse(c)},isTime:function(b){return"time"===a(b).get(0).tagName.toLowerCase()}});var h={init:function(){var b=a.proxy(c,this);b();var d=g.settings;d.refreshMillis>0&&setInterval(b,d.refreshMillis)},update:function(b){a(this).data("timeago",{datetime:g.parse(b)}),c.apply(this)},updateFromDOM:function(){a(this).data("timeago",{datetime:g.parse(g.isTime(this)?a(this).attr("datetime"):a(this).attr("title"))}),c.apply(this)}};a.fn.timeago=function(a,b){var c=a?h[a]:h.init;if(!c)throw new Error("Unknown function name '"+a+"' for timeago");return this.each(function(){c.call(this,b)}),this},document.createElement("abbr"),document.createElement("time")}),define("modules/template/helpers/general_helpers",["underscore","handlebars","modules/common/utility","modules/common/local_storage","modules/common/session_user","modules/common/config","modules/globals/variable","modules/globals/settings","modules/globals/url","modules/globals/session_user_settings","modules/globals/session_user","modules/chat/models/user_session","jquery.timeago"],function(a,b,c,d,e,f,g,h,i,j,k,l){b.registerHelper("translate",function(){return new b.SafeString(c.translate.apply(this,arguments))}),b.registerHelper("htmlSpecialChars",function(a){return c.htmlspecialchars(a)}),b.registerHelper("roundNumberDecimal",function(a,b){return c.round_number_decimal(a,b)}),b.registerHelper("addThousandsSeperator",function(a){return c.add_thousands_seperator(a)}),b.registerHelper("roundNumber",function(a,b){return c.round_number(a,b)}),b.registerHelper("ifIsSelf",function(a,b){return null==a&&(a=c.get_username()),e.getInstance().get("username")===a||e.getInstance().get("alias")===a?b.fn(this):b.inverse(this)}),b.registerHelper("ifExternalEmailNotVerified",function(a){return e.getInstance().get("external_email_verified")===!1?a.fn(this):void 0}),b.registerHelper("ifLoggedIn",function(a){return c.is_logged_in()?a.fn(this):a.inverse(this)}),b.registerHelper("isLoggedIn",function(){return c.is_logged_in()}),b.registerHelper("getVariable",function(a,b){return g[a][b]}),b.registerHelper("getGTMVariable",function(a,b){var d=c.get_gtm_var(a);return d?d:b}),b.registerHelper("getUrl",function(a){return i[a]}),b.registerHelper("getSessionUser",function(a){var b=e.getInstance();if(b.has(a)){var d=b.get(a);return $.isNumeric(d)?c.add_thousands_seperator(d):d}return b.toJSON()}),b.registerHelper("getSessionUserStats",function(a,b){var d=e.getInstance();if(d.has(a)){var f=d.get(a);if($.isNumeric(f)&&"undefined"!=typeof b)return c.round_number(f,b)}}),b.registerHelper("getSettings",function(a){return"undefined"==typeof a?h:h[a]}),b.registerHelper("ifSystemPropertyEnabled",function(a,b){return h[a].enabled?b.fn(this):b.inverse(this)}),b.registerHelper("mysqlDateFormat",function(b,d){"string"!=typeof d&&(d="fullDate");var e=new Date;if(!a.isUndefined(b)&&null!==b){var f=new RegExp("(\\d{4})-(\\d{2})-(\\d{2}) (\\d{2}):(\\d{2}):(\\d{2})"),g=b.match(f);e=new Date(parseInt(g[1],10),parseInt(g[2],10)-1,parseInt(g[3],10),parseInt(g[4],10),parseInt(g[5],10),parseInt(g[6],10),0)}return c.dateFormat(e,d)}),b.registerHelper("dateFormat",function(a,b){return c.dateFormat(parseInt(a,10),b)}),b.registerHelper("showCurrentDate",function(a){var b=new Date;return c.dateFormat(b.getTime(),a)}),b.registerHelper("characterLimiter",function(a,d,e){return new b.SafeString(c.character_limiter(a,d,e))}),b.registerHelper("ifStringExceedLength",function(b,c,d,e){return d=d||!1,d&&(b=a.escape(b)),b.length>c?e.fn(this):e.inverse(this)}),b.registerHelper("getProfileUrl",function(a){return c.get_profile_url(a)}),b.registerHelper("getDisplayPictureUrl",function(a,b,d,e){return c.get_display_picture_url(a,b,d,e)}),b.registerHelper("getDefaultFaceUrl",function(){return f.urls.default_face_url}),b.registerHelper("getSessionUserDisplayPictureUrl",function(a,b){return c.get_display_picture_url(k.username,k.display_picture_type,a,b)}),b.registerHelper("getBadgeImageUrl",function(a,b){return c.get_badge_image_url(a,b)}),b.registerHelper("getBadgeImageMonotoneUrl",function(a,b){return c.get_badge_image_monotone_url(a,b)}),b.registerHelper("getGiftImageUrl",function(a,b,d){return c.get_gift_image_url(a,b,d)}),b.registerHelper("getGender",function(a){return c.get_gender(a)}),b.registerHelper("ifCurrentUser",function(a){return c.is_owner()?a.fn(this):a.inverse(this)}),b.registerHelper("ifSessionUserSettingsThirdPartySite",function(a,b){var c=a.split("|");return j&&j.thirdpartysite[c[0]][c[1]]?b.fn(this):b.inverse(this)}),b.registerHelper("showLogoutMessage",function(){return c.translate("login|login_to_join_in_not_signed_up")}),b.registerHelper("getWindowLocationObject",function(a){return window.location[a]}),b.registerHelper("ifIsNumeric",function(a,b){return isNaN(a)?b.fn(this):b.inverse(this)}),b.registerHelper("log",function(a){console.log("\nCurrent Context"),console.log("===================="),console.log(this),console.log(arguments),arguments.length>1&&(console.log("Value"),console.log("===================="),console.log(a))}),b.registerHelper("iterator",function(b,c){var d=c.fn,e=c.inverse,f="";if(b&&b.length>0)for(var g=0,h=b.length;h>g;g++)f+=d(a.extend({},b[g],{i:g,iPlus1:g+1}));else f=e(this);return f}),b.registerHelper("key_value",function(a,b){var c,d="";for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&(d+=b.fn({key:c,value:a[c]}));return d}),b.registerHelper("isNotEmpty",function(a,b){var c=$.trim(a);return"undefined"==typeof c||""===c||null===c?b.inverse(this):b.fn(this)}),b.registerHelper("limit",function(a,b){var c="",d=parseInt(b.hash.offset,10)||0,e=parseInt(b.hash.limit,10)||5,f=d<a.length?d:0,g=e+d<a.length?e+d:a.length;for(g;g>f;f++)c+=b.fn(a[f]);return c}),b.registerHelper("compare",function(a,b,c){var d;if(arguments.length<3)throw new Error("Handlerbars Helper 'compare' needs 2 parameters");d=c.hash.operator||"==";var e={"==":function(a,b){return a==b},"===":function(a,b){return a===b},"!=":function(a,b){return a!=b},"<":function(a,b){return b>a},">":function(a,b){return a>b},"<=":function(a,b){return b>=a},">=":function(a,b){return a>=b},"%":function(a,b){return a%b===0},"%1":function(a,b){return a%b===b-1},"typeof":function(a,b){return typeof a==b}};if(!e[d])throw new Error("Handlerbars Helper 'compare' doesn't know the operator "+d);var f=e[d](a,b);return f?c.fn(this):c.inverse(this)}),b.registerHelper("withFirst",function(b,c){var d="";if(!a.isArray(b))throw new Error("Handlerbars Helper 'withFirst' needs an array to work with");return d+=c.fn(b[0])}),b.registerHelper("stripTags",function(b){return a.escape(b)}),b.registerHelper("removeEmpty",function(a){return"null"==a&&(a=""),a}),b.registerHelper("relationshipToName",function(a){var b="";switch(a){case 1:b="Single";break;case 2:b="In a Relationship";break;case 3:b="A domestic partner";break;case 4:b="Married";break;case 5:b="Complicated";break;default:b="Unspecified"}return b}),b.registerHelper("getRelativeTimestamp",function(a){var b=c.translate("time|now"),d=Math.round((new Date).getTime()/1e3),e=d-a/1e3,f={s_60:["time|moments_ago",0],s_120:["time|1_minute_ago",0],s_3600:["time|x_minutes_ago",60],s_7200:["time|1_hour_ago",0],s_86400:["time|x_hours_ago",3600],s_172800:["time|1_day_ago",0],s_604800:["time|x_days_ago",86400],s_1209600:["time|1_week_ago",0],s_2419200:["time|x_weeks_ago",604800],s_4838400:["time|1_month_ago",0],s_29030400:["time|x_months_ago",2592e3],s_58060800:["time|1_year_ago",0]};f["s_"+String(d)]=["time|x_years_ago",31536e3];for(var g in f)if(Object.prototype.hasOwnProperty.call(f,g)){var h=parseInt(g.slice(2),10),i=f[g];if(h>e){b=i[1]>0?c.translate(i[0],Math.floor(e/i[1])):c.translate(i[0]);break}}return b}),b.registerHelper("maths",function(a,b,c){var d;if(arguments.length<3)throw new Error("Handlerbars Helper 'maths' needs 2 parameters");d=c.hash.operator||"+";var e={"+":function(a,b){return a+b},"-":function(a,b){return a-b},"*":function(a,b){return a*b},"/":function(a,b){return a/b}};if(!e[d])throw new Error("Handlerbars Helper 'maths' doesn't know the operator "+d);return e[d](a,b)}),b.registerHelper("get_fb_id",function(){return g.fb_app_id}),b.registerHelper("get_fb_js_url",function(){return i.migcore_cdn+"/resources/migme/js/fbconnect.js"}),b.registerHelper("get_peekinside_id",function(){return g.ga_conversion.peekinside_id}),b.registerHelper("get_peekinside_label",function(){return g.ga_conversion.peekinside_label}),b.registerHelper("get_register_url",function(){return i.register}),b.registerHelper("get_fb_permissions",function(){return f.facebook.permissions}),b.registerHelper("get_account_balance",function(){var a=l.Session.getInstance();return a.get("account_balance")}),b.registerHelper("get_user_currency",function(){var a=l.Session.getInstance();return a.get("currency_code")}),b.registerHelper("get_email_merchant",function(){var a=f.email.merchant,b="<a href='mailto:"+a+"'>"+a+"</a>";return b}),b.registerHelper("getHttpsUrl",function(){return"https://"+document.location.hostname}),b.registerHelper("getUsernameFromUrl",function(){return c.get_username()}),window.AdjustIframeHeightOnLoad=function(a,b){if("undefined"==typeof a)return!1;"undefined"!=typeof b&&b===!1||(b="undefined"==typeof b?0:b,b++,b>3&&(b=!1),setTimeout(function(){window.AdjustIframeHeightOnLoad(a,b)},1e3));var c=document.getElementById(a);if(!c||c.src.indexOf("https://")>=0)return!1;c.style.height="auto";var d="undefined"!=typeof InstallTrigger;d?c.style.height=c.contentDocument.documentElement.scrollHeight+"px":c.style.height=c.contentWindow.document.body.scrollHeight+"px"}}),define("modules/chat/views/emote_menu",["modules/chat/views/emoticon_panel","modules/chat/views/sticker_panel","modules/chat/views/gift_panel","modules/chat/models/user_session","modules/common/utility","hbs!modules/template/chat/window/emote-footer","backbone","underscore","modules/template/helpers/general_helpers","handlebars","jquery","qtip"],function(a,b,c,d,e,f,g,h){var i=d.Session.getInstance(),j=document.location.protocol+"//"+document.location.host;j+="/store/category/3/new";var k='<div class="chat-window-toybox dropdown-menu"><div class="chat-window-toybox-content"></div><div class="chat-window-toybox-footer"><i class="ico ico-24 ico-emoticon"></i><i class="ico ico-24 ico-shopping-cart"></i></div></div>',l=function(){h.bindAll(this),this.current_target=null,this.current_chat=null,this.emoticon_panel=new a,this.emoticon_panel.on("select",this.send_emoticon_event),this.gift_panel=new c,this.toybox_footer_emoticon_btn=$(f({store_url:j})),this.$container=$(k),this.listen_to_session(),this.opened_once=!1},m=l.prototype;return h.extend(m,{send_emoticon_event:function(a){
if(this.current_target){var b=jQuery.Event("select",{value:a});$(this.current_btn).trigger(b),this.hide()}},show:function(a,b){this.opened_once||(this.opened_once=!0),this.$container.on("click",function(a){a.stopPropagation(),a.preventDefault()}),$("body").on("click",this.hide),$(a).before(this.$container),this.$container.show(),this.current_target=a,this.current_btn=b,this.attachButtons(this.$container),this.attachPanels(this.$container)},attachButtons:function(a){var b=$(".chat-window-toybox-footer",a);b.empty(),b.append(this.toybox_footer_emoticon_btn),this.attach_button_events()},attachPanels:function(a){var b=$(".chat-window-toybox-content",a);b.empty(),b.append(this.emoticon_panel.getContent()),this.show_element(this.emoticon_panel.getContent())},hide:function(){this.$container.off("click"),$("body").off("click"),this.current_target=null,this.$container.hide()},listen_to_session:function(){i.on("emoticon_hotkeys",function(){this.render_emoticon_panel()},this)},close_all:function(){this.emoticon_panel.getContent().hide()},show_element:function(a){this.close_all(),a.show()},render_emoticon_panel:function(){this.emoticon_panel.render()},attach_button_events:function(){this.toybox_footer_emoticon_btn.click(function(){var a=require("modules/mig33_app");a.navigate_to(j)})}}),new l}),define("hbs!modules/template/chat/gift-pick-participant-list",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="modal-header">\n    <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><i class="ico ico-32 ico-close"></i></button>\n    <h3 class="gift-title-area clearfix"></h3>\n    <input type="text" placeholder="'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"store|add_a_message",g):i.call(b,"translate","store|add_a_message",g)))+'" class="gift-participant-pick messagebox"/>\n</div>\n<div class="modal-body">\n	<p>'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"chat|gift_pick_user_prompt",g):i.call(b,"translate","chat|gift_pick_user_prompt",g)))+'</p>\n	<div class=\'send_all_btn_container\'>\n        <input type="button" name="send_everyone" class="btn btn-xs btn-default send-everyone" value="Send to everyone">\n	</div>\n    <ul class=\'user-list-container\'>\n\n    </ul>\n</div>'})}),define("hbs!modules/template/chat/gift-sent-success",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h,i="",j=c.helperMissing,k=this.escapeExpression,l="function";return i+='<div class="modal-header">\n    <button type="button" class="close" data-dismiss="modal" aria-hidden="true"><i class="ico ico-32 ico-close"></i></button>\n    <h3 class="gift-title-area clearfix">'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"chat|post_gift_title",h):j.call(b,"translate","chat|post_gift_title",h)))+'</h3>\n</div>\n<div class="modal-body">\n    <p>'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"chat|post_gift_message",b&&b.receiver_txt,h):j.call(b,"translate","chat|post_gift_message",b&&b.receiver_txt,h)))+'</p>\n    <div class=\'gift-fragment\'>\n        <div class="announce">\n            <img src="',(g=c.user_url)?f=g.call(b,{hash:{},data:e}):(g=b&&b.user_url,f=typeof g===l?g.call(b,{hash:{},data:e}):g),i+=k(f)+'" alt="'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"user|user_avatar",b&&b.username,h):j.call(b,"translate","user|user_avatar",b&&b.username,h)))+'" title="'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"user|user_avatar",b&&b.username,h):j.call(b,"translate","user|user_avatar",b&&b.username,h)))+'" />\n			',g=c.translate||b&&b.translate,h={hash:{},data:e},f=g?g.call(b,"chat|post_gift_sent",b&&b.username,h):j.call(b,"translate","chat|post_gift_sent",b&&b.username,h),(f||0===f)&&(i+=f),i+='\n        </div>\n		<div class="gift-box">\n			<div class="gift-box-fragment">\n                <div class="fragment-image">\n					<img src="',(g=c.gift_url)?f=g.call(b,{hash:{},data:e}):(g=b&&b.gift_url,f=typeof g===l?g.call(b,{hash:{},data:e}):g),i+=k(f)+'">\n                </div>\n				<div class="fragment-text">',(g=c.gift_name)?f=g.call(b,{hash:{},data:e}):(g=b&&b.gift_name,f=typeof g===l?g.call(b,{hash:{},data:e}):g),i+=k(f)+'</div>\n			</div>\n            <div class="gift-box-fragment">\n                <div class="fragment-image">\n                    <i class="ico ico-32 send-arrow"></i>\n                </div>\n                <div class="fragment-text">&nbsp;</div>\n            </div>\n            <div class="gift-box-fragment">\n                <div class="fragment-image">',(g=c.receiver_img_url)?f=g.call(b,{hash:{},data:e}):(g=b&&b.receiver_img_url,f=typeof g===l?g.call(b,{hash:{},data:e}):g),(f||0===f)&&(i+=f),i+='</div>\n                <div class="fragment-text">',(g=c.receiver_name)?f=g.call(b,{hash:{},data:e}):(g=b&&b.receiver_name,f=typeof g===l?g.call(b,{hash:{},data:e}):g),i+=k(f)+'</div>\n            </div>\n		</div>\n        <div class="message-text">',(g=c.message)?f=g.call(b,{hash:{},data:e}):(g=b&&b.message,f=typeof g===l?g.call(b,{hash:{},data:e}):g),(f||0===f)&&(i+=f),i+='</div>\n    </div>\n    <div class="help">\n		'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"chat|post_gift_chat_command",b&&b.gift_name,h):j.call(b,"translate","chat|post_gift_chat_command",b&&b.gift_name,h)))+'\n    </div>\n    <div class="buttons" style="text-align: center;">\n        <input type="button" name="btn_done" class="btn btn-xs btn-default done-btn" value="'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"chat|post_gift_send_done",h):j.call(b,"translate","chat|post_gift_send_done",h)))+'">\n    </div>\n	<div class="clear-fix"></div>\n</div>'})}),define("modules/view/chat/gift/participant_selection_view",["underscore","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/chat/gift-pick-participant-list","hbs!modules/template/chat/gift-sent-success","modules/chat/config/config_ts","modules/common/utility","modules/common/session_user","modules/common/local_storage","modules/globals/variable","modules/globals/url","modules/globals/session_user","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o,p=h.config,q=c.compile('<li><div class="pull-right"><input type="button" class="btn btn-xs btn-default" data-user="{{name}}" value="Send"></div><div class="pull-left"><img src="{{img_src}}" title="{{name}}" /><span>{{name}}</span></div><div class="clearfix"></div></li>'),r=c.compile('<li><div class="pull-right"><input type="button" title="{{getGiftShowerRestrictedSmallTooltip}}" class="btn btn-xs btn-default" data-user="{{name}}" value="Send" disabled=""></div><div class="pull-left"><img src="{{img_src}}" title="{{name}}" /><span>{{name}}</span></div><div class="clearfix"></div></li>'),s=c.compile('<div id="chat-gift-success" class="modal lean hide fade"></div>');return o=b.Marionette.Layout.extend({template:{type:"handlebars",template:f},id:"chatgiftbox-modal",className:"modal lean hide fade",regions:{},onRender:function(){var a=this,b=$(".send-everyone",this.$el);b.click(function(){a.callCallback()})},setChatModel:function(a){this.chat_model=a},setGift:function(a,b,c,d,e){this.gift_name=b,this.gift_model=e,$(".gift-title-area",this.$ul).html("<img src='"+c+"' width='32' height='32' title='"+b+"'/>&nbsp;<span>"+b+"</span>&nbsp;-&nbsp;<span class='price'>"+d+"</span>")},setParticipants:function(b){var c=$(".user-list-container",this.$el),d=this;c.empty(),d.gift_model.isGiftShowerItem()?$(".gift-participant-pick.messagebox").hide():$(".gift-participant-pick.messagebox").show(),a.each(b,function(a){var b=p.image_server+"/dp/"+a+"?w=32&h=32&c=1&a=1",e="";e=d.gift_model.isGiftShowerItem()?r({img_src:b,name:a}):q({img_src:b,name:a}),c.append(e)}),$(".btn-default",c).click(function(){d.callCallback($(this).data("user"))})},setSelectionCallback:function(a){this.cb_func=a},callCallback:function(a){var b=this;b.cb_func&&b.gift_name&&b.cb_func(a,b.gift_name,$.trim($(".gift-participant-pick.messagebox").val())),this.clearData(),this.$el.mask(i.translate("chat|gift_sending_message"),10)},showSuccess:function(a,b,c,d,e,f){this.$el.unmask();var h,k,l,m;a&&""!==a||!e.is_group_chat()&&!e.is_chat_room()?(m=k=a,l='<img src="'+i.get_display_picture_url(k,"a",64,64)+'" width="64" height="64"/>'):(m=i.translate("chat|post_gift_receiver_group"),h=e.is_chat_room()?"ico-chatroom-default":"ico-groupchat-default",k="All",l='<i class="chat-list-item-unread-msgs ico ico-32 '+h+'"></i>');var n={receiver_txt:m,username:j.getInstance().get("username"),user_url:i.get_display_picture_url(j.getInstance().get("username"),"u",32,32),gift_url:d.getImageURL("64x64PNG"),gift_name:b,receiver_img_url:l,receiver_name:k,message:c};if($("#chatgiftbox-modal").modal("hide"),0===$("#chat-gift-success").length){var o=s();$("body").append($(o))}$("#chat-gift-success").html(g(n)),$(".done-btn",$("#chat-gift-success")).click(function(){$("#chat-gift-success").modal("hide")}),$("#chat-gift-success").modal("show")},clearData:function(){this.$el.unmask(),this.cb_func=null,this.gift_name=null,this.gift_model=null,$(".gift-participant-pick.messagebox").val("")}}),o.__instance=null,o.getInstance=function(a){return o.__instance||(o.__instance=new o,$("#main-container").after(o.__instance.render().el)),o.__instance.setChatModel(a),o.__instance},o}),define("hbs!modules/template/chat/window/list_item",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f,i="";return i+=" | ",e=c.compare||a&&a.compare,f={hash:{},inverse:w.program(4,h,b),fn:w.program(2,g,b),data:b},d=e?e.call(a,a&&a.price,0,f):t.call(a,"compare",a&&a.price,0,f),(d||0===d)&&(i+=d),i}function g(a,b){var d,e;return u((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"store|free",e):t.call(a,"translate","store|free",e)))}function h(a,b){var d,e,f="";return(e=c.localPrice)?d=e.call(a,{hash:{},data:b}):(e=a&&a.localPrice,d=typeof e===v?e.call(a,{hash:{},data:b}):e),f+=u(d),(e=c.localCurrency)?d=e.call(a,{hash:{},data:b}):(e=a&&a.localCurrency,d=typeof e===v?e.call(a,{hash:{},data:b}):e),f+=u(d)}function i(a,b){var d,e,f,g="";return g+="\n        ",e=c.compare||a&&a.compare,f={hash:{},inverse:w.program(9,k,b),fn:w.program(7,j,b),data:b},d=e?e.call(a,a&&a.type,"STICKER",f):t.call(a,"compare",a&&a.type,"STICKER",f),(d||0===d)&&(g+=d),g+="\n    "}function j(a,b){var d,e,f="";return f+='\n            <img src="'+u((d=c.getStoreItemImage||a&&a.getStoreItemImage,e={hash:{},data:b},d?d.call(a,a,300,e):t.call(a,"getStoreItemImage",a,300,e)))+'" width="300" height="100" />\n        '}function k(a,b){var d,e,f="";return f+='\n            <img src="'+u((d=c.getStoreItemImage||a&&a.getStoreItemImage,e={hash:{},data:b},d?d.call(a,a,64,e):t.call(a,"getStoreItemImage",a,64,e)))+'" width="46" height="46" />\n        '}function l(a,b){var d,e,f="";return f+='\n        <img src="'+u((d=c.getStoreItemImage||a&&a.getStoreItemImage,e={hash:{},data:b},d?d.call(a,a,64,e):t.call(a,"getStoreItemImage",a,64,e)))+'" width="46" height="46" class="greyscale-image" />\n    '}function m(a,b){return'\n    <span class="wb wb-16 wb-premium item-qualifier"></span>\n'}function n(a,b){var d,e,f,g="";return g+="\n    ",f={hash:{},inverse:w.noop,fn:w.program(16,o,b),data:b},(e=c.ifIsGiftShowerItem)?d=e.call(a,f):(e=a&&a.ifIsGiftShowerItem,d=typeof e===v?e.call(a,f):e),c.ifIsGiftShowerItem||(d=x.call(a,d,{hash:{},inverse:w.noop,fn:w.program(16,o,b),data:b})),(d||0===d)&&(g+=d),g+="\n"}function o(a,b){return'\n        <span class="wb wb-16 wb-gift-shower item-qualifier"></span>\n    '}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var p,q,r,s="",t=c.helperMissing,u=this.escapeExpression,v="function",w=this,x=c.blockHelperMissing;return s+='<div class="image" title="',(q=c.name)?p=q.call(b,{hash:{},data:e}):(q=b&&b.name,p=typeof q===v?q.call(b,{hash:{},data:e}):q),s+=u(p),r={hash:{},inverse:w.noop,fn:w.program(1,f,e),data:e},(q=c.ifAllowedToBuyItemInChat)?p=q.call(b,r):(q=b&&b.ifAllowedToBuyItemInChat,p=typeof q===v?q.call(b,r):q),c.ifAllowedToBuyItemInChat||(p=x.call(b,p,{hash:{},inverse:w.noop,fn:w.program(1,f,e),data:e})),(p||0===p)&&(s+=p),s+='">\n    ',r={hash:{},inverse:w.program(11,l,e),fn:w.program(6,i,e),data:e},(q=c.ifAllowedToBuyItemInChat)?p=q.call(b,r):(q=b&&b.ifAllowedToBuyItemInChat,p=typeof q===v?q.call(b,r):q),c.ifAllowedToBuyItemInChat||(p=x.call(b,p,{hash:{},inverse:w.program(11,l,e),fn:w.program(6,i,e),data:e})),(p||0===p)&&(s+=p),s+="\n</div>\n",q=c.ifPremiumItem||b&&b.ifPremiumItem,r={hash:{},inverse:w.program(15,n,e),fn:w.program(13,m,e),data:e},p=q?q.call(b,b,r):t.call(b,"ifPremiumItem",b,r),(p||0===p)&&(s+=p),s})}),define("hbs!modules/template/chat/window/gift_list_view",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="content">\n\n</div>\n<div class="footer">\n    <div>'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"toybox|more_gift",g):i.call(b,"translate","toybox|more_gift",g)))+'</div>\n    <a class="btn btn-xs btn-default dropdown-toggle goto_store" data-href="/store/category/1/new/" type="button">\n        <span class="icon-wb_store"></span>&nbsp;'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"toybox|goto_store",g):i.call(b,"translate","toybox|goto_store",g)))+"\n    </a>\n</div>\n"})});var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};define("modules/chat/views/chat_window/gift_list_collection_view",["require","exports","../../../view/common/mig33_views","modules/export_marionette","backbone.marionette","hbs!modules/template/chat/window/list_item","hbs!modules/template/chat/window/gift_list_view","underscore","jquery","backbone"],function(a,b,c){var d=a("hbs!modules/template/chat/window/list_item"),e=a("hbs!modules/template/chat/window/gift_list_view"),f=a("underscore"),g=(a("jquery"),function(a){function b(b){this.className="store-item",this.template={type:"handlebars",template:d},this.events={click:"_click"},a.call(this,b)}return __extends(b,a),b.prototype.initialize=function(){f.bindAll(this)},b.prototype._click=function(a){a.preventDefault(),this.trigger("select",this.model)},b}(c.ItemView)),h=(function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b}(c.ItemView),function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b}(c.ItemView),function(a){function b(b){this.template={type:"handlebars",template:e},this.itemViewContainer=".content",this.className="store-list",this.itemView=g,a.call(this,b)}return __extends(b,a),b}(c.CompositeView));b.GiftCollectionView=h}),define("hbs!modules/template/chat/window/gift_summary_template",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){return"disabled"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var g,h,i,j="",k=c.helperMissing,l=this.escapeExpression,m="function",n=this;return j+='<div class="navigation header text-uppercase font-size-12">\n    <span class="icon-wb_arrowLeft pull-left link"></span>\n	<div><span class="icon icon-wb_post"></span><span>'+l((h=c.translate||b&&b.translate,i={hash:{},data:e},h?h.call(b,"toybox|preview",i):k.call(b,"translate","toybox|preview",i)))+'</span></div>\n    <div class="font-size-12">',(h=c.currentStep)?g=h.call(b,{hash:{},data:e}):(h=b&&b.currentStep,g=typeof h===m?h.call(b,{hash:{},data:e}):h),j+=l(g)+" "+l((h=c.translate||b&&b.translate,i={hash:{},data:e},h?h.call(b,"toybox|of",i):k.call(b,"translate","toybox|of",i)))+" ",(h=c.totalSteps)?g=h.call(b,{hash:{},data:e}):(h=b&&b.totalSteps,g=typeof h===m?h.call(b,{hash:{},data:e}):h),j+=l(g)+'</div>\n</div>\n<div class="center-content">\n	<div class="row gift-block">\n		<div>'+l((h=c.translate||b&&b.translate,i={hash:{},data:e},h?h.call(b,"toybox|to",i):k.call(b,"translate","toybox|to",i)))+": ",(h=c.userName)?g=h.call(b,{hash:{},data:e}):(h=b&&b.userName,g=typeof h===m?h.call(b,{hash:{},data:e}):h),j+=l(g)+'</div>\n        <div class="image"><img src="',(h=c.giftImageUrl)?g=h.call(b,{hash:{},data:e}):(h=b&&b.giftImageUrl,g=typeof h===m?h.call(b,{hash:{},data:e}):h),j+=l(g)+'"/></div>\n        <div class="summary giftname col-xs-6 no-padding">',(h=c.giftName)?g=h.call(b,{hash:{},data:e}):(h=b&&b.giftName,g=typeof h===m?h.call(b,{hash:{},data:e}):h),j+=l(g)+'</div>\n        <div class="summary giftprice col-xs-6 no-padding">\n            <div class="info">',(h=c.giftPriceTotalLocal)?g=h.call(b,{hash:{},data:e}):(h=b&&b.giftPriceTotalLocal,g=typeof h===m?h.call(b,{hash:{},data:e}):h),j+=l(g)+'</div>\n        </div>\n        <div class="summary font-size-12">'+l((h=c.translate||b&&b.translate,i={hash:{},data:e},h?h.call(b,"toybox|catch_text",i):k.call(b,"translate","toybox|catch_text",i)))+'</div>\n	</div>\n</div>\n<div class="row font-size-12">\n	'+l((h=c.translate||b&&b.translate,i={hash:{},data:e},h?h.call(b,"toybox|add_note",i):k.call(b,"translate","toybox|add_note",i)))+'\n</div>\n<div class="row">\n    <input placeholder="'+l((h=c.translate||b&&b.translate,i={hash:{},data:e},h?h.call(b,"toybox|message_optional",i):k.call(b,"translate","toybox|message_optional",i)))+'" value="',(h=c.message)?g=h.call(b,{hash:{},data:e}):(h=b&&b.message,g=typeof h===m?h.call(b,{hash:{},data:e}):h),j+=l(g)+'" class="message" type="text"/>\n</div>\n<div class="row buttons">\n    <input type="button" name="purchase_item" class="btn btn-xs btn-default send-button" value="'+l((h=c.translate||b&&b.translate,i={hash:{},data:e},h?h.call(b,"common|send",i):k.call(b,"translate","common|send",i)))+" ",(h=c.giftPriceTotalLocal)?g=h.call(b,{hash:{},data:e}):(h=b&&b.giftPriceTotalLocal,g=typeof h===m?h.call(b,{hash:{},data:e}):h),j+=l(g)+'" ',g=c.unless.call(b,b&&b.isAllowedToBuy,{hash:{},inverse:n.noop,fn:n.program(1,f,e),data:e}),(g||0===g)&&(j+=g),j+=">\n</div>"})});var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};define("modules/chat/views/chat_window/gift_summary_view",["require","exports","../../../view/common/mig33_views","modules/export_marionette","backbone.marionette","hbs!modules/template/chat/window/gift_summary_template","underscore","jquery","backbone"],function(a,b,c){var d=a("hbs!modules/template/chat/window/gift_summary_template"),e=a("underscore"),f=a("jquery"),g=function(a){function b(b){this.className="gift-summary",this.template={type:"handlebars",template:d},this.events={"click .navigation.header":"_emitBack","click input[type=button].send-button":"_emitSend","change input[type=text]":"_handleMessageChange","change input[type=checkbox]":"_handlePostToMigboChange"},a.call(this,b)}return __extends(b,a),b.prototype.initialize=function(){e.bindAll(this)},b.prototype._emitBack=function(a){a.preventDefault(),a.stopPropagation(),this.trigger("click_back")},b.prototype._emitSend=function(a){this.trigger("send_gift",this.model)},b.prototype._handlePostToMigboChange=function(a){var b=f(".row input[type=checkbox]",this.$el).is(":checked");this.model.isPostToMigbo=b},b.prototype._handleMessageChange=function(a){var b=f(".row input[type=text]",this.$el).val();this.model.message=b},b}(c.ItemView);b.GiftSummaryView=g}),define("hbs!modules/template/chat/window/gift_user_select_template",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){return"disabled"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var g,h,i,j="",k=c.helperMissing,l=this.escapeExpression,m="function",n=this;return j+='<div class="navigation header text-uppercase font-size-12">\n    <span class="icon-wb_arrowLeft pull-left link"></span>\n    <div><span class="icon icon-wb_me"></span><span>'+l((h=c.translate||b&&b.translate,i={hash:{},data:e},h?h.call(b,"toybox|select_friends",i):k.call(b,"translate","toybox|select_friends",i)))+'</span></div>\n    <div class="font-size-12">',(h=c.currentStep)?g=h.call(b,{hash:{},data:e}):(h=b&&b.currentStep,g=typeof h===m?h.call(b,{hash:{},data:e}):h),j+=l(g)+" "+l((h=c.translate||b&&b.translate,i={hash:{},data:e},h?h.call(b,"toybox|of",i):k.call(b,"translate","toybox|of",i)))+" ",(h=c.totalSteps)?g=h.call(b,{hash:{},data:e}):(h=b&&b.totalSteps,g=typeof h===m?h.call(b,{hash:{},data:e}):h),j+=l(g)+'</div>\n</div>\n<div class="center-content-user-list">\n	    <div class="row usernames" >\n\n	    </div>\n</div>\n<div class="row buttons">\n	<div class="price col-xs-6">'+l((h=c.translate||b&&b.translate,i={hash:{},data:e},h?h.call(b,"common|total",i):k.call(b,"translate","common|total",i)))+'<span class="val">',(h=c.giftPriceTotalLocal)?g=h.call(b,{hash:{},data:e}):(h=b&&b.giftPriceTotalLocal,g=typeof h===m?h.call(b,{hash:{},data:e}):h),j+=l(g)+'</span></div>\n	<div class="nextBtn col-xs-6"><input type="button" name="purchase_item" class="btn btn-xs btn-default send-button" value="'+l((h=c.translate||b&&b.translate,i={hash:{},data:e},h?h.call(b,"common|next",i):k.call(b,"translate","common|next",i)))+'" ',g=c.unless.call(b,b&&b.isAllowedToBuy,{hash:{},inverse:n.noop,fn:n.program(1,f,e),data:e}),(g||0===g)&&(j+=g),j+="></div>\n</div>"})}),define("hbs!modules/template/chat/window/gift_user_select_item_template",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){return'\n        <span class="wb wb-36 wb-chatp-groupchat"></span>\n	'}function g(a,b){var d,e,f="";return f+='\n        <img src="',(e=c.display_pic)?d=e.call(a,{hash:{},data:b}):(e=a&&a.display_pic,d=typeof e===l?e.call(a,{hash:{},data:b}):e),f+=m(d)+'" width="36" height="36"\n             class="img-circle"/>\n	'}function h(a,b){return"checked"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var i,j,k="",l="function",m=this.escapeExpression,n=this;return k+='<a class="user-item">\n	',i=c["if"].call(b,b&&b.groupItem,{hash:{},inverse:n.program(3,g,e),fn:n.program(1,f,e),data:e}),(i||0===i)&&(k+=i),k+='\n    <span class="username">',(j=c.name)?i=j.call(b,{hash:{},data:e}):(j=b&&b.name,i=typeof j===l?j.call(b,{hash:{},data:e}):j),k+=m(i)+'</span>\n	<span class="radio-btn pull-right" >\n		<input ',i=c["if"].call(b,b&&b.groupItem,{hash:{},inverse:n.noop,fn:n.program(5,h,e),data:e}),(i||0===i)&&(k+=i),k+=' type="radio" name="',(j=c.rg)?i=j.call(b,{hash:{},data:e}):(j=b&&b.rg,i=typeof j===l?j.call(b,{hash:{},data:e}):j),k+=m(i)+'" id="',(j=c.id)?i=j.call(b,{hash:{},data:e}):(j=b&&b.id,i=typeof j===l?j.call(b,{hash:{},data:e}):j),k+=m(i)+'" value="',(j=c.name)?i=j.call(b,{hash:{},data:e}):(j=b&&b.name,i=typeof j===l?j.call(b,{hash:{},data:e}):j),k+=m(i)+'"><label for="',(j=c.id)?i=j.call(b,{hash:{},data:e}):(j=b&&b.id,i=typeof j===l?j.call(b,{hash:{},data:e}):j),k+=m(i)+'" class="css-label radGroup"></label>\n	</span>\n</a>\n'})});var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};define("modules/chat/views/chat_window/gift_user_select_view",["require","exports","../../../view/common/mig33_views","modules/export_marionette","backbone.marionette","hbs!modules/template/chat/window/gift_user_select_template","hbs!modules/template/chat/window/gift_user_select_item_template","underscore","jquery","backbone"],function(a,b,c){var d=a("hbs!modules/template/chat/window/gift_user_select_template"),e=a("hbs!modules/template/chat/window/gift_user_select_item_template"),f=a("underscore"),g=a("jquery"),h=function(a){function b(b){this.className="user-select-item",this.template={type:"handlebars",template:e},this.events={"click label.radGroup":"_onclick"},a.call(this,b)}return __extends(b,a),b.prototype.initialize=function(){f.bindAll(this)},b.prototype._onclick=function(a){g(a.target);this.trigger("userselect",this.model)},b}(c.ItemView);b.GiftUserSelectItem=h;var i=function(a){function b(b){this.itemView=h,this.itemViewContainer=".row.usernames",this.className="user-select",this.template={type:"handlebars",template:d},this.events={"click .navigation.header":"_headerclick","click .send-button":"_next"},a.call(this,b)}return __extends(b,a),b.prototype.initialize=function(){f.bindAll(this)},b.prototype.updateData=function(a){this.$el.find("div.price>.val").html(a.giftPriceTotalLocal)},b.prototype._headerclick=function(a){a.preventDefault(),this.trigger("click_back",this.model)},b.prototype._next=function(a){a.preventDefault(),this.trigger("click_next",this.model)},b}(c.CompositeView);b.GiftUserSelect=i});var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};define("modules/chat/views/chat_window/gift_summary_view_model",["require","exports","underscore","jquery","backbone"],function(a,b){var c=function(b){function c(){b.apply(this,arguments)}return __extends(c,b),Object.defineProperty(c.prototype,"giftName",{get:function(){return this.get("giftName")},set:function(a){this.set("giftName",a)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"giftImageUrl",{get:function(){return this.get("giftImageUrl")},set:function(a){this.set("giftImageUrl",a)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"giftPriceLocal",{get:function(){return this.get("giftPriceLocal")},set:function(a){this.set("giftPriceLocal",a)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"giftCommandBasic",{get:function(){return this.get("giftCommandBasic")},set:function(a){this.set("giftCommandBasic",a)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"message",{get:function(){return this.get("message")},set:function(a){this.set("message",a)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"isGiftShower",{get:function(){return this.get("isGiftShower")},set:function(a){this.set("isGiftShower",a)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"isPostToMigbo",{get:function(){return this.get("isPostToMigbo")},set:function(a){this.set("isPostToMigbo",a)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"isAllowedToBuy",{get:function(){return this.get("isAllowedToBuy")},set:function(a){this.set("isAllowedToBuy",a)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"isOnlyGiftShower",{get:function(){return this.get("isOnlyGiftShower")},set:function(a){this.set("isOnlyGiftShower",a)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"explanation",{get:function(){return this.get("explanation")},set:function(a){this.set("explanation",a)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"singleUser",{get:function(){return this.get("singleUser")},set:function(a){this.set("singleUser",a)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"giftPriceTotalLocal",{get:function(){return this.get("giftPriceTotalLocal")},set:function(a){this.set("giftPriceTotalLocal",a)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"userCount",{get:function(){return this.get("userCount")},set:function(a){this.set("userCount",a)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"totalSteps",{get:function(){return this.get("totalSteps")},set:function(a){this.set("totalSteps",a)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"currentStep",{get:function(){return this.get("currentStep")},set:function(a){this.set("currentStep",a)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"userName",{get:function(){return this.get("userName")},set:function(a){this.set("userName",a)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"giftPrice",{get:function(){return this.get("giftPrice")},set:function(a){this.set("giftPrice",a)},enumerable:!0,configurable:!0}),c.prototype.getBalanceFromSession=function(){var b=a("modules/chat/models/user_session").Session.getInstance();return b.get("account_balance")},c.prototype.allowedToBuyItemFromBalance=function(){var b=a("modules/chat/models/user_session").Session.getInstance();if(null!==b.get("account_balance")){var c=this.isGiftShower?this.giftPrice*this.userCount:this.giftPrice;return b.get("account_balance")>=c}return!0},c.prototype.getCommand=function(a){var b="";return this.message&&(b=" -m "+this.message),"/gift "+a+" "+this.get("giftName")+b},c.prototype.getCommandShower=function(){return this.getCommand("all")},c.prototype.getCommandUser=function(a){return this.getCommand(a)},c}(Backbone.Model);b.GiftSummaryModel=c}),define("hbs!modules/template/chat/window/toybox_gift_layout",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="header text-uppercase font-size-12">\n    <div><span class="icon icon-wb_gift"></span><span>'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"toybox|select_gift",g):i.call(b,"translate","toybox|select_gift",g)))+'</span></div>\n    <div class="font-size-12 subtitle"></div>\n</div>\n<ul class="nav nav-tabs nav-justified">\n    <li class="active popular-tab">\n        <a data-category="popular" href="#popular">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"toybox|popular",g):i.call(b,"translate","toybox|popular",g)))+'</a>\n    </li>\n    <li class="new-tab">\n        <a data-category="new" href="#new">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"toybox|new",g):i.call(b,"translate","toybox|new",g)))+'</a>\n    </li>\n    <li class="hilighted-tab">\n        <a class="" href="/store/category/1/new/">\n            <span class="icon-wb_store"></span>\n        </a>\n    </li>\n</ul>\n<div class="content-area gift-nav">\n    <div class="popular-panel">\n    </div>\n    <div class="new-panel hidden">\n    </div>\n</div>\n<div class="flow-overlay">\n\n</div>\n<div class="payment-overlay font-size-14">\n    <div class="icon-wb_closepopup close-credit"></div>\n	<div class="wb wb-140 wb-pig-credit-big"></div>\n	<div class="text">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"toybox|low_credit",g):i.call(b,"translate","toybox|low_credit",g)))+'</div>\n    <div class="buttons">\n        <a href="/credit" class="btn btn-xs btn-default text-uppercase font-size-12">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"toybox|recharge_now",g):i.call(b,"translate","toybox|recharge_now",g)))+"</a>\n    </div>\n</div>"})}),define("modules/model/store/store_item_model",["underscore","backbone","modules/mig33_app","modules/common/config","modules/common/utility","modules/common/session_user","modules/globals/url"],function(a,b,c,d,e,f,g){var h=b.Model.extend({initialize:function(a,b){this.options=b},url:function(){return e.format(d.urls.store_item,this.options.item_id)},allowedToBuyItemFromGroup:function(){return null!==this.get("groupName")?!!this.get("isGroupMember"):!0},allowedToBuyItemFromMigLevel:function(){var a=f.getInstance();return a.get("mig_level")?!(this.get("migLevelMin")>a.get("mig_level")):!1},isGiftShowerItem:function(){return"VIRTUAL_GIFT"===this.get("type")&&this.get("price")<=d.store.gift_shower_price},allowedToBuyItem:function(){return!(!this.allowedToBuyItemFromGroup()||!this.allowedToBuyItemFromMigLevel()||this.isGiftShowerItem())},goToStoreItem:function(){"undefined"!=typeof this.options.collection&&""!==this.options.collection.username?b.history.navigate("store/item/"+this.get("id")+"/?username="+this.options.collection.username,{trigger:!0
}):b.history.navigate("store/item/"+this.get("id"),{trigger:!0})},goToBuyItem:function(){"undefined"!=typeof this.options.collection&&""!==this.options.collection.username?b.history.navigate("store/item/"+this.get("id")+"/?username="+this.options.collection.username+"&action=buy",{trigger:!0}):b.history.navigate("store/item/"+this.get("id")+"/?action=buy",{trigger:!0})},purchase:function(a){var b=this,c=$.ajax({type:"post",dataType:"json",url:e.format(d.urls.store_item_purchase,this.get("id")),data:$.toJSON(a)});return c.done(function(a){e.send_event_to_ga("Store","Purchase","Category "+b.get("storeCategoryID")),e.send_event_to_ga("Store","Purchase","Item "+b.get("id"))}),c.fail(function(a,b,c){e.show_error(c)}),c},getTypeNiceNameSingular:function(){var a="";switch(this.get("type")){case"VIRTUAL_GIFT":a=e.translate("user|gift");break;case"AVATAR":a=e.translate("user|avatar");break;case"EMOTICON":a=e.translate("chat|emoticon");break;case"STICKER":a=e.translate("chat|sticker");break;case"APP_ITEM":a=e.translate("store|applications_item");break;case"GAME_ITEM":a=e.translate("store|games_item")}return a},getTypePurchaseAdjective:function(){var a="";switch(this.get("type")){case"VIRTUAL_GIFT":a=e.translate("common|send");break;case"AVATAR":a=e.translate("common|download");break;case"EMOTICON":a=e.translate("common|download");break;case"STICKER":a=e.translate("common|download");break;case"APP_ITEM":a=e.translate("common|send");break;case"GAME_ITEM":a=e.translate("common|send")}return a},getLocalPrice:function(){return this.get("localCurrency")+" "+e.round_number_decimal(this.get("localPrice"),2)},getImageURL:function(a){a=a||"64x64PNG";var b;return(b=this.get("referenceData"))&&b["location"+a]?g.site+b["location"+a].replace("/usr/fusion/","images/"):""}});return h}),define("modules/model/store/store_item_collection",["underscore","modules/model/common/mig33_collection","modules/mig33_app","modules/common/config","modules/common/utility","modules/model/store/store_item_model","modules/common/session_user"],function(a,b,c,d,e,f,g){var h=b.extend({model:f,totalResults:0,by:"category",featured:!1,searchType:1,searchQuery:"",searchCategoryId:0,minPrice:-1,maxPrice:-1,sortBy:"name",sortOrder:"asc",limit:0,username:"",initialize:function(a,b){this.options=b},url:function(){var b="";return"category"===this.by?b=e.format(d.urls.store_category_items,this.options.category_id):"type"===this.by?b=e.format(d.urls.store_type_items,this.options.category_id):"search"===this.by&&(b=d.urls.store_search_items),b+"?sortby="+this.sortBy+"&sortorder="+this.sortOrder+"&featured="+this.featured+"&offset="+(this.currentPage-1)*this.getLimit()+"&limit="+this.getLimit()+("search"===this.by?"&type="+this.searchType+(this.searchCategoryId>a.size(d.store.type_to_category)?"&categoryId="+this.searchCategoryId:"")+"&query="+this.searchQuery+"&minPrice="+this.minPrice+"&maxPrice="+this.maxPrice:"")},parse:function(b,c){return b.data&&!a.isUndefined(b.data.listData)&&null!==b.data.listData?(this.totalResults=b.data.totalResults,b.data.listData):[]},setByCategory:function(){this.by="category"},setByType:function(){this.by="type"},setBySearch:function(){this.by="search"},setLimit:function(a){a>0&&(this.limit=a)},sortByPopular:function(){this.sortBy="featured,numsold",this.sortOrder="desc,desc"},sortByNumsold:function(){this.sortBy="numsold"},sortByDate:function(){this.sortBy="datelisted"},sortByName:function(){this.sortBy="name"},sortByPrice:function(){this.sortBy="price"},sortOrderAsc:function(){this.sortOrder="asc"},sortOrderDesc:function(){this.sortOrder="desc"},featuredOnly:function(){this.featured=!0},setSearchType:function(a){this.searchType=a},setSearchCategoryId:function(a){this.searchCategoryId=a},setSearchQuery:function(a){this.searchQuery=a},setMinPrice:function(a){this.minPrice=a},setMaxPrice:function(a){this.maxPrice=a},getLimit:function(){return this.limit>0?this.limit:d.store.items.limit},setUsername:function(a){this.username=a}});return h});var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};define("modules/chat/views/chat_window/toybox_gift_region",["require","exports","./gift_list_collection_view","../../../view/common/mig33_views","./gift_summary_view","./gift_user_select_view","./gift_summary_view_model","modules/export_marionette","backbone.marionette","hbs!modules/template/chat/window/toybox_gift_layout","modules/common/utility","modules/common/config","modules/globals/url","underscore","jquery","backbone","modules/model/store/store_item_collection"],function(a,b,c,d,e,f,g){var h=a("hbs!modules/template/chat/window/toybox_gift_layout"),i=a("modules/common/utility"),j=a("modules/common/config"),k=a("underscore"),l=a("jquery"),m=a("modules/model/store/store_item_collection"),n=a("modules/globals/url"),o=1,p=64,q=36,r=a("handlebars");!function(a){a[a.newest=0]="newest",a[a.featured=1]="featured",a[a.popular=2]="popular"}(b.CategoryType||(b.CategoryType={}));var s=(b.CategoryType,r.compile('<a href="#" class="close"><span class="icon-wb_close font-size-16"></span></a>')),t=function(b){function d(a){this.chatwindow=a.chatwindow,this.className="gift-layout",this.template={type:"handlebars",template:h},this.regions={popular_region:".popular-panel",new_region:".new-panel",gift_extra:".flow-overlay"},this.events={"click ul.nav-tabs>li>a":"_tabChange","click .close":"closePanel","click .close-credit":"_hideBalanceError","click a.goto_store":"_hide_mobile_chat"},this.isRendered=!1,b.call(this,a)}return __extends(d,b),d.prototype.initialize=function(){k.bindAll(this)},d.prototype._tabChange=function(a){var b=l(a.currentTarget).data("category"),c=b+"-panel",d=b+"-tab";b&&(this.$el.find("ul.nav-tabs>li.active").removeClass("active"),this.$el.find(".content-area.gift-nav>div").addClass("hidden"),l("ul.nav-tabs>li."+d,this.$el).addClass("active"),l("."+c,this.$el).removeClass("hidden"))},d.prototype._hide_mobile_chat=function(b){if(l(window).width()<768&&(i.hide_mobile_chat(),this.closePanel(),this.chatwindow.close()),b){b.preventDefault(),b.stopPropagation();var c="",d=this.model.getParticipants();if(!this.model.is_group_chat()&&!this.model.is_chat_room()&&d){var e=this;d=l.grep(d,function(a){return a!=e.model.session_user}),c="?username="+d[0]}if(l(b.target).closest(".goto_store").length>0&&l(b.target).closest(".goto_store").data("href")){var f=l(b.target).closest(".goto_store").data("href"),g=a("modules/mig33_app");g.navigate_to(window.location.protocol+"//"+window.location.hostname+f+c,b)}}},d.prototype.closePanel=function(a){a&&a.preventDefault(),this.hideGiftExtras(),this._hideBalanceError(),this.$el.hide()},d.prototype.openPanel=function(){this.$el.show();var a=20;l(window).width()<768&&(a=60);var b=l(".chat-window-messages",this.$el.parents(".mig-window-content"));if(this.$el.height()+a>b.height()){var c=this.$el.height()-b.height()+a,d=l(".content",this.$el);this.$el.height(this.$el.height()-c),d.height(d.height()-c)}if(this.$el.width()+a>b.width()){var c=this.$el.width()-b.width()+a;this.$el.width(this.$el.width()-c)}},d.prototype._showBalanceError=function(a){a=this.giftModel.get("localCurrency")+a,this.$el.find(".payment-overlay>.text").html(i.translate("toybox|low_credit",a)),this.$el.find(".payment-overlay").show()},d.prototype._hideBalanceError=function(){this.$el.find(".payment-overlay").hide()},d.prototype._showGiftSummary=function(a){var b=this;a.currentStep=a.singleUser?2:3;var c=new e.GiftSummaryView({model:a});c.on("click_back",function(){a.singleUser?b.hideGiftExtras():b._showGiftUserSelection(a)}),c.on("send_gift",function(a){if(!a.allowedToBuyItemFromBalance())return void b._showBalanceError(""+a.getBalanceFromSession());var c;b.hideGiftExtras(),c=a.isGiftShower?"undefined"!=typeof b.model.is_group_chat&&(b.model.is_group_chat()||b.model.is_chat_room())?"all":b.model.get("destination"):a.userName;var d=a.getCommandUser(c);b.trigger("send_gift",d)}),this.showGiftExtras(c),this.trigger("post_gift",a)},d.prototype._showGiftUserSelection=function(a){var b=this,c=this.model.getParticipants(),d=new Backbone.Collection;a.currentStep=2,a.isGiftShower=!0,a.giftPriceTotalLocal=this.giftModel.get("localCurrency")+(i.round_number_decimal(this.giftModel.get("localPrice"))*a.userCount).toFixed(2);var e="_"+Date.now(),g=k.map(c,function(a,b){return{name:a,display_pic:n.image+"/dp/"+a+"?w="+q+"&h="+q+"&a=1&c=1",id:b+"_"+Date.now(),rg:e,groupItem:!1}}),h=i.translate("toybox|everyone")+" ("+c.length+")";g=k.union([{name:h,display_pic:d,id:"-1",rg:e,groupItem:!0}],g),a.userName=h,d.reset(g);var j=new f.GiftUserSelect({model:a,collection:d});j.on("click_back",function(a){b.hideGiftExtras()}),j.on("click_next",function(){a.allowedToBuyItemFromBalance()?(b.hideGiftExtras(),b._showGiftSummary(a)):b._showBalanceError(""+a.getBalanceFromSession())}),j.on("itemview:userselect",function(c,d){"-1"===d.get("id")?(a.isGiftShower=!0,a.giftPriceTotalLocal=b.giftModel.get("localCurrency")+(i.round_number_decimal(b.giftModel.get("localPrice"))*a.userCount).toFixed(2),a.userName=h):(a.isGiftShower=!1,a.giftPriceTotalLocal=b.giftModel.get("localCurrency")+i.round_number_decimal(b.giftModel.get("localPrice")).toFixed(2),a.userName=d.get("name")),j.updateData(a)}),j.updateData(a),this.showGiftExtras(j)},d.prototype.prepareModel=function(){var a="undefined"!=typeof this.model.is_group_chat&&(this.model.is_group_chat()||this.model.is_chat_room())?this.model.getParticipants().length:1,b="undefined"!=typeof this.model.is_group_chat&&(this.model.is_group_chat()||this.model.is_chat_room())&&a>1,c={giftName:"",giftImageUrl:"",giftPriceLocal:"",giftPrice:0,isAllowedToBuy:!1,isOnlyGiftShower:!1,giftCommandBasic:"",message:"",isPostToMigbo:!1,giftPriceTotalLocal:"",singleUser:!b,explanation:null,totalSteps:b?3:2,currentStep:1,userName:b?i.translate("toybox|everyone"):"function"==typeof this.model.getTitle?this.model.getTitle():this.model.get("destination"),userCount:a,isGiftShower:!1};return new g.GiftSummaryModel(c)},d.prototype.updateModelWithGift=function(a,b){this.giftModel=b;var c=this.model.is_group_chat()||this.model.is_chat_room()?this.model.getParticipants().length:1,d=(i.round_number_decimal(b.get("localPrice"))*c).toFixed(2),e=i.isGiftShowerItem(b.attributes),f=i.storeItemAllowedToBuyItemFromMigLevel(b.attributes),g=i.storeItemAllowedToBuyItemFromGroup(b.attributes),h=2>=c,k="";b.get("price")>=j.store.premium_price&&(k=i.translate("store|this_is_a_premium_item","gift",i.round_number_decimal(.2*b.get("localPrice"))+" "+b.get("localCurrency")));var l=f&&g;return f?g||(k=i.translate("store|restricted_group_item",'<a href="/group/'+b.get("groupId")+'">'+b.get("groupName")+"</a>")):k=i.translate("store|restricted_miglevel_item",b.get("migLevelMin"),"gift"),h&&(l=!e&&l,e&&(k=i.translate("store|restricted_giftshower"))),a.giftName=b.get("name"),a.giftImageUrl=n.site+"images/emoticons/virtualgifts/"+b.get("catalogImage")+"_"+p+".png",a.giftPriceLocal=b.get("localCurrency")+""+i.round_number_decimal(b.get("localPrice"),2),a.giftPrice=b.get("localPrice"),a.isAllowedToBuy=l,a.isOnlyGiftShower=e,a.giftCommandBasic="/gift "+b.get("name"),a.message="",a.isPostToMigbo=!1,a.giftPriceTotalLocal=b.get("localCurrency")+d,a.explanation=k,a.userCount=c,a},d.prototype.onRender=function(){var a=this;this.isRendered=!0,this.$el.append(s());var b=this.prepareModel();this.$el.find(".subtitle").html(r.compile('1 {{translate "toybox|of"}}')()+" "+b.totalSteps);var d=function(c,d){a.model.is_group_chat()||a.model.is_chat_room()?a.model.getParticipants().length:1;b=a.updateModelWithGift(b,d),b.singleUser?a._showGiftSummary(b):a._showGiftUserSelection(b)},e=new c.GiftCollectionView({collection:this._getCollection(2)}),f=new c.GiftCollectionView({collection:this._getCollection(0)});e.on("itemview:select",d),f.on("itemview:select",d),this.popular_region.show(e),this.new_region.show(f),this.hideGiftExtras()},d.prototype.hideGiftExtras=function(){this.gift_extra.close(),this.$el.find(this.gift_extra.el).hide()},d.prototype.showGiftExtras=function(a){this.$el.find(this.gift_extra.el).show(),this.gift_extra.show(a)},d.prototype._getCollection=function(a){var b=new m([],{category_id:o});switch(b.setByType(),a){case 2:b.sortByNumsold();break;case 1:b.featuredOnly(),b.sortByDate();break;case 0:b.sortByDate();break;default:b.sortByDate()}return b.sortOrderDesc(),b.fetch(),b},d.prototype._makeTabActive=function(a){},d}(d.Layout);b.ToyBoxGiftRegion=t}),define("hbs!modules/template/chat/window/sticker-thumb-view",["handlebars"],function(a){return a.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},'<div class="nav nav-tabs nav-justified snug-nav">\n    <div class="arrows">\n        <a href="#" class="collapse-mode-toggle-btn move-left">\n            <span class="icon-wb_arrowLeft"></span>\n        </a>\n    </div>\n    <div class="thumbnails"></div>\n    <div class="arrows">\n        <a href="#" class="collapse-mode-toggle-btn move-right">\n            <span class="icon-wb_arrowRight"></span>\n        </a>\n    </div>\n    <div class="hilighted-tab">\n        <a class="" href="/store/category/6/new/">\n            <span class="icon-wb_store"></span>\n        </a>\n    </div>\n</div>'})}),define("hbs!modules/template/chat/window/sticker-thumb-item",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i="function",j=this.escapeExpression;return h+='<i id="sthumb_',(g=c.stickerpackid)?f=g.call(b,{hash:{},data:e}):(g=b&&b.stickerpackid,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'" class="ico ico-24" style="\n		background-size:24px 24px; background-image:url(\'',(g=c.stickerpackiconurl)?f=g.call(b,{hash:{},data:e}):(g=b&&b.stickerpackiconurl,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'\');background-repeat: no-repeat;" data-packid="',(g=c.stickerpackid)?f=g.call(b,{hash:{},data:e}):(g=b&&b.stickerpackid,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'">\n</i>'})});var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};define("modules/chat/views/chat_window/sticker_thumbail_view",["require","exports","../../../view/common/mig33_views","modules/export_marionette","backbone.marionette","hbs!modules/template/chat/window/sticker-thumb-view","hbs!modules/template/chat/window/sticker-thumb-item","underscore","jquery","backbone"],function(a,b,c){var d=a("hbs!modules/template/chat/window/sticker-thumb-view"),e=a("hbs!modules/template/chat/window/sticker-thumb-item"),f=a("underscore"),g=a("jquery"),h=function(a){function b(b){this.tagName="div",this.className="thumb",this.template={type:"handlebars",template:e},this.events={click:"onclick"},a.call(this,b)}return __extends(b,a),b.prototype.activate=function(){this.$el.addClass("active")},b.prototype.deactivate=function(){this.$el.removeClass("active")},b.prototype.onclick=function(a){a.preventDefault(),this.trigger("select",this.model)},b}(c.ItemView);b.ThumbItemView=h;var i=function(a){function b(b){this.thumbPosition=0,this.itemViewContainer=".thumbnails",this.itemView=h,this.template={type:"handlebars",template:d},this.events={"click .arrows .move-left":"_moveThumbLeft","click .arrows .move-right":"_moveThumbRight"},a.call(this,b)}return __extends(b,a),b.prototype._moveThumbLeft=function(a){this.thumb_size=g(this.$thumbnail_area.children()[0]).width()+3,this.thumbPosition<=0||(this.thumbPosition-=this.thumb_size,this.thumbPosition<0&&(this.thumbPosition=0),g(".thumbnails",this.$el).scrollTo(this.thumbPosition,100))},b.prototype._moveThumbRight=function(a){this.thumb_size=g(this.$thumbnail_area.children()[0]).width()+3;var b=this.$thumbnail_area.children(),c=b.length*this.thumb_size-this.$thumbnail_area.width();this.thumbPosition>=c||(this.thumbPosition+=this.thumb_size,this.thumbPosition>c&&(this.thumbPosition-=this.thumb_size),this.$thumbnail_area.scrollTo(this.thumbPosition,100))},b.prototype.initialize=function(){f.bindAll(this)},b.prototype.setActiveThumb=function(a){var b=this.children.findByModel(a);this.activeThumb&&this.activeThumb.deactivate(),this.activeThumb=b,this.activeThumb.activate()},b.prototype.onRender=function(){this.$thumbnail_area=g(".thumbnails",this.$el)},b}(c.CompositeView);b.StickerThumbView=i}),define("hbs!modules/template/chat/window/sticker-list-view",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="content">\n\n</div>\n<div class="footer">\n    <div>'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"toybox|more_stickers",g):i.call(b,"translate","toybox|more_stickers",g)))+'</div>\n    <a class="btn btn-xs btn-default dropdown-toggle goto_store" data-href="/store/category/6/new/">\n        <span class="icon-wb_store"></span>&nbsp;'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"toybox|goto_store",g):i.call(b,"translate","toybox|goto_store",g)))+"\n    </a>\n</div>\n"})}),define("hbs!modules/template/chat/window/sticker-list-item",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i="function",j=this.escapeExpression;return h+='<a href="#" data-alias="',(g=c.alias)?f=g.call(b,{hash:{},data:e}):(g=b&&b.alias,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'" id="',(g=c.hk)?f=g.call(b,{hash:{},data:e}):(g=b&&b.hk,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'" hidefocus="on" title="/sticker ',(g=c.alias)?f=g.call(b,{hash:{},data:e}):(g=b&&b.alias,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'"><img src="',(g=c.url)?f=g.call(b,{hash:{},data:e}):(g=b&&b.url,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'" border=0></a>'})});var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};define("modules/chat/views/chat_window/sticker_collection_view",["require","exports","../../../view/common/mig33_views","modules/export_marionette","backbone.marionette","hbs!modules/template/chat/window/sticker-list-view","hbs!modules/template/chat/window/sticker-list-item","underscore","jquery","backbone"],function(a,b,c){var d=a("hbs!modules/template/chat/window/sticker-list-view"),e=a("hbs!modules/template/chat/window/sticker-list-item"),f=a("underscore"),g=(a("jquery"),function(a){function b(b){this.className="emoticon sticker",this.template={type:"handlebars",template:e},this.events={click:"onclick"},a.call(this,b)}return __extends(b,a),b.prototype.initialize=function(){f.bindAll(this)},b.prototype.onclick=function(a){a.preventDefault(),this.trigger("sticker_select",this.model)},b}(c.ItemView));b.StickerItemView=g;var h=function(a){function b(b){this.itemView=g,this.itemViewContainer=".content",this.template={type:"handlebars",template:d},a.call(this,b)}return __extends(b,a),b.prototype.initialize=function(){f.bindAll(this)},b.prototype.onRender=function(){},b}(c.CompositeView);b.StickerListView=h}),define("hbs!modules/template/chat/window/sticker-layout",["handlebars"],function(a){return a.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},'<div class="sticker-thumb-region">\n</div>\n<div class="sticker-list-region">\n</div>'})});var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};define("modules/chat/views/chat_window/sticker_layout",["require","exports","../../../view/common/mig33_views","../../models/user_session","./sticker_thumbail_view","./sticker_collection_view","modules/export_marionette","backbone.marionette","hbs!modules/template/chat/window/sticker-layout","underscore","jquery","backbone"],function(a,b,c,d,e,f){var g=a("hbs!modules/template/chat/window/sticker-layout"),h=a("modules/common/utility"),i=a("underscore"),j=a("jquery"),k=a("handlebars"),l=d.Session.getInstance(),m=!1,n=function(a){function b(b){a.call(this,b)}return __extends(b,a),b}(Backbone.Model);b.StickerModel=n,n.prototype.idAttribute="hotkey";var o=function(a){function b(b){this.model=n,a.call(this,b)}return __extends(b,a),b}(Backbone.Collection);b.StickerCollection=o;var p={},q=function(a){function b(b){a.call(this,b)}return __extends(b,a),b}(Backbone.Model);b.StickerPackModel=q,q.prototype.idAttribute="stickerpackid";var r=function(a){function b(b){this.model=q,a.call(this,b)}return __extends(b,a),b}(Backbone.Collection);b.StickerPackCollection=r;var s=new r;l.on("sticker_pack_received",function(a){var b=p[a.stickerpackid];b||(b=new o,p[a.stickerpackid]=b),s.add(a)}),l.on("sticker_received",function(a,b){if(b){var c=p[b.stickerpackid];c&&c.add(a)}});var t=k.compile('<a href="#" class="close"><span class="icon-wb_close font-size-16"></span></a>'),u=function(b){function c(a){this.chatwindow=a.chatwindow,this.selectedOnce=!1,this.className="content-area-sticker",this.template={type:"handlebars",template:g},this.events={"click .close":"closePanel","click a.goto_store":"_hide_mobile_chat"},this.regions={thumb_region:".sticker-thumb-region",list_region:".sticker-list-region"},this.isRendered=!1,b.call(this,a)}return __extends(c,b),c.prototype._hide_mobile_chat=function(b){if(j(window).width()<768&&(b&&b.preventDefault(),h.hide_mobile_chat(),this.closePanel(),this.chatwindow.close()),j(b.target).closest(".goto_store").length>0&&j(b.target).closest(".goto_store").data("href")){var c=j(b.target).closest(".goto_store").data("href"),d=a("modules/mig33_app");d.navigate_to(window.location.protocol+"//"+window.location.hostname+c,b)}},c.prototype.initialize=function(){i.bindAll(this)},c.prototype.closePanel=function(a){a&&a.preventDefault(),this.$el.hide()},c.prototype.openPanel=function(){this.$el.show()},c.prototype.showStickerPack=function(a){var b=this,c=p[a];if(c){var d=s.get(a);this.thumb_view.setActiveThumb(d);var e=new f.StickerListView({collection:c,"class":"sticker-container"});this.list_region.show(e),e.on("itemview:sticker_select",function(a,c){b.trigger("sticker_select",c)})}},c.prototype.showFirstPack=function(){s.first()&&this.showStickerPack(s.first().get("stickerpackid"))},c.prototype.onRender=function(){var a=this;m||l.fetch_sticker_pack_list(),m=!0,this.thumb_view=new e.StickerThumbView({collection:s}),this.thumb_view.on("itemview:select",function(b,c){var d=c.get("stickerpackid");a.showStickerPack(d)}),this.thumb_view.on("after:item:added",function(b){var c=b.model;if(!a.selectedOnce){var d=c.get("stickerpackid");a.showStickerPack(d),a.selectedOnce=!0}});var b=new f.StickerListView({collection:new Backbone.Collection});this.thumb_region.show(this.thumb_view),this.list_region.show(b),this.$el.append(t()),this.showFirstPack(),this.isRendered=!0},c}(c.Layout);b.StickerLayout=u}),define("modules/chat/views/chat_window/toybox_event_store",["require","exports","modules/export_marionette","backbone.marionette","modules/common/utility","modules/common/config","modules/globals/url","underscore","jquery","backbone"],function(a,b){var c=a("underscore"),d=function(){function a(){c.extend(this,Backbone.Events)}return a.prototype.onStickerSelect=function(b,c){this.on(a.EVENTS.STICKER_SELECT,b,c)},a.prototype.onImageSelect=function(b,c){this.on(a.EVENTS.IMAGE_SELECT,b,c)},a.prototype.onGiftCommand=function(b,c){this.on(a.EVENTS.GIFT_COMMAND,b,c)},a.prototype.onStickerButtonPress=function(b,c){this.on(a.EVENTS.STICKER_BUTTON_PRESS,b,c)},a.prototype.onGiftButtonPress=function(b,c){this.on(a.EVENTS.GIFT_BUTTON_PRESS,b,c)},a.EVENTS={STICKER_SELECT:"STICKER_SELECT",IMAGE_SELECT:"IMAGE_SELECT",GIFT_COMMAND:"GIFT_COMMAND",STICKER_BUTTON_PRESS:"STICKER_BUTTON_PRESS",GIFT_BUTTON_PRESS:"GIFT_BUTTON_PRESS"},a}();b.ToyBoxEventStore=d}),define("hbs!modules/template/chat/window/toybox_layout",["handlebars"],function(a){return a.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},'<div class="nav-nugget">\n	<ul class="nav navbar-nav">\n	    <li>\n	        <a href="#" data-type="gift" class="gift-icon">\n	            <span class="wb wb-48 icon-wb_gift_big"></span>\n	        </a>\n	    </li>\n	    <li>\n	        <a href="#" data-type="sticker" class="sticker-icon">\n	            <span class="wb wb-48 icon-wb_sticker_big"></span>\n	        </a>\n	    </li>\n	    <li>\n            <input type="file" name="media" accept="image/*" class="toybox-media-upload" style="display: none;" />\n            <a href="#" data-type="camera" class="camera-icon">\n                <span class="wb wb-48 icon-wb_camera_big"></span>\n            </a>\n	    </li>\n	</ul>\n	<div></div>\n</div>'})});var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};define("modules/chat/views/chat_window/toybox_view",["require","exports","../../../view/common/mig33_views","./toybox_gift_region","./sticker_layout","./toybox_event_store","modules/export_marionette","backbone.marionette","hbs!modules/template/chat/window/toybox_layout","modules/globals/url","underscore","jquery","backbone","modules/common/utility","modules/common/config","modules/common/session_user"],function(a,b,c,d,e,f){var g=(a("modules/common/utility"),a("hbs!modules/template/chat/window/toybox_layout")),h=a("underscore"),i=a("jquery"),j=function(b){function c(a){this.chatwindow=a.chatwindow,this.template={type:"handlebars",template:g},this.events={"click a":"_handleAllClicks",click:"_handleAllClicks","click .nav-nugget>ul>li>a.gift-icon":"_clickGiftTab","click .nav-nugget>ul>li>a.sticker-icon":"_clickStickerTab","click .nav-nugget>ul>li>a.camera-icon":"_clickFileSelect","change .nav-nugget>ul>li>.toybox-media-upload":"_onFileSelect"},this.eventStore=new f.ToyBoxEventStore,this.$toggle_btn=null,b.call(this,a)}return __extends(c,b),c.prototype.initialize=function(){this.initializeStickerView(),this.initializeGiftView(),h.bindAll(this)},c.prototype.initializeStickerView=function(){var a=this;this.sticker_view=new e.StickerLayout({chatwindow:this.chatwindow}),this.sticker_view.on("sticker_select",function(b){a.sticker_view.closePanel(),a.eventStore.trigger(f.ToyBoxEventStore.EVENTS.STICKER_SELECT,b.get("alias"))})},c.prototype.initializeGiftView=function(){var a=this;this.gift_view=new d.ToyBoxGiftRegion({chatwindow:this.chatwindow,model:this.model}),this.gift_view.on("send_gift",function(b){a.gift_view.closePanel(),a.eventStore.trigger(f.ToyBoxEventStore.EVENTS.GIFT_COMMAND,b)})},c.prototype.getEventStore=function(){return this.eventStore},c.prototype._handleAllClicks=function(b){if(b.stopPropagation(),i(b.target).closest(".goto_store").length>0&&i(b.target).closest(".goto_store").data("href")){var c=i(b.target).closest(".goto_store").data("href"),d=a("modules/mig33_app");d.navigate_to(window.location.protocol+"//"+window.location.hostname+c,b)}},c.prototype._clickFileSelect=function(a){a.stopPropagation(),a.preventDefault(),i(".toybox-media-upload",this.$el).click()},c.prototype._onFileSelect=function(a){var b=a.currentTarget;if(0!==b.files.length){var c=b.files[0];this.eventStore.trigger(f.ToyBoxEventStore.EVENTS.IMAGE_SELECT,c),this.closeMenu()}},c.prototype.closeMenu=function(){this.$toggle_btn&&this.$toggle_btn.length||(this.$toggle_btn=this.$el.closest(".chat-window-adduser")),this.$toggle_btn.removeClass("open")},c.prototype._clickGiftTab=function(a){this.sticker_view.closePanel(),this.eventStore.trigger(f.ToyBoxEventStore.EVENTS.GIFT_BUTTON_PRESS,a),this.gift_view.isRendered||this.gift_view.render();var b=this.$el.closest(".mig-window-chat-content");b.append(this.gift_view.$el),this.gift_view.openPanel(),a.preventDefault(),this.closeMenu()},c.prototype._clickStickerTab=function(a){this.gift_view.closePanel(),this.eventStore.trigger(f.ToyBoxEventStore.EVENTS.STICKER_BUTTON_PRESS,a),this.sticker_view.isRendered||this.sticker_view.render();var b=this.$el.closest(".mig-window-chat-content");b.append(this.sticker_view.$el),this.sticker_view.openPanel(),a.preventDefault(),this.closeMenu()},c.prototype._tabChange=function(a){var b=i(a.currentTarget).data("type"),c=b+"-panel",d=b+"-icon";"camera"!==b&&(this.$el.find(".nav-nugget>ul>li.active").removeClass("active"),this.$el.find(".content-area.toybox-nav>div").addClass("hidden"),i(".nav-nugget>ul>li ."+d,this.$el).parent().addClass("active"),i("."+c,this.$el).removeClass("hidden"))},c.prototype.onRender=function(){},c}(c.Layout);b.ToyBoxView=j}),function(){var a=[].slice,b={}.hasOwnProperty,c=function(a,c){function d(){this.constructor=a}for(var e in c)b.call(c,e)&&(a[e]=c[e]);return d.prototype=c.prototype,a.prototype=new d,a.__super__=c.prototype,a};!function(a){return"function"==typeof define&&define.amd?define("jquery.mentions",["jquery"],a):a(window.jQuery)}(function(b){var d,e,f,g,h,i,j,k;return f={BACKSPACE:8,TAB:9,ENTER:13,ESC:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,COMMA:188,SPACE:32,HOME:36,END:35},j={triggerChar:"@",matchFields:"name",valueField:"name",data:[],displayLimit:5,matchLength:20,matchCase:!1,elastic:!0,at:"bottom",autoCompleteItemActive:"cur",tpl_wrapper:_.template('<div class="mentions-autocomplete atwho-view"></div>'),tpl_autocompleteList:_.template("<ul><%= items %></ul>"),tpl_autocompleteListItem:_.template("<li><%= name %></li>")},k={htmlEncode:function(a){return _.escape(a)},isFocusable:function(a){return null!=a&&(a.focus||a.selectionStart||a.createTextRange)},highlightTerm:function(a,b){return!(null!=b?b.length:void 0),a.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+b+")(?![^<>]*>)(?![^&;]+;)","gi"),"<b>$1</b>")},setCaratPosition:function(a,b){var c;null==b&&(b=0),!a&&!this.isFocusable(a),a.createTextRange?(c=a.createTextRange(),c.move("character",b),c.select()):a.selectionStart?(a.focus(),a.setSelectionRange(b,b)):a.focus()},rtrim:function(a){return null==a&&(a=""),a.replace(/\s+$/,"")},indexOfWithCase:function(a,b,c){var d;try{return c||(a=a.toLowerCase(),b=b.toLowerCase()),a.indexOf(b)}catch(e){return d=e,-1}}},e=function(){function b(){this.events={}}return b.prototype.emit=function(){var b,c,d,e,f,g;if(c=arguments[0],b=2<=arguments.length?a.call(arguments,1):[],!this.events[c])return!1;for(g=this.events[c],e=0,f=g.length;f>e;e++)d=g[e],d.apply(null,b);return!0},b.prototype.addListener=function(a,b){return this.emit("newListener",a,b),this.events[a]=this.events[a]||[],this.events[a].push(b),this},b.prototype.on=b.prototype.addListener,b.prototype.once=function(a,b){var c,d=this;return c=function(){return d.removeListener(a,c),b.apply(null,arguments)},this.on(a,c),this},b.prototype.removeListener=function(a,b){var c;return this.events[a]?(this.events[a]=function(){var d,e,f,g;for(f=this.events[a],g=[],d=0,e=f.length;e>d;d++)c=f[d],c!==b&&g.push(c);return g}.call(this),this):this},b.prototype.removeAllListeners=function(a){return delete this.events[a],this},b}(),d=function(a){function d(a,b,c,e){this.key=a,this.$input=c,this.model=new h(b,e),this.view=new i(c,e),this.settings=e,this.listenToModel(),this.listenToView(),d.__super__.constructor.call(this,a,b,c)}return c(d,a),d.prototype.listenToView=function(){var a=this;this.view.on("shown",function(){return a.$input.trigger("jqm_shown",[a.key,a])}),this.view.on("mention",function(b){var c,d,e,f,g;b&&(a.$input.trigger("jqm_selected",[a.key,b[a.settings.valueField],a]),c=a.$input.val(),e=c.substring(a.query.start,a.query.end),g=c.substring(0,a.query.start),f=c.substring(a.query.end),d=g+b[a.settings.valueField],a.$input.val(d+" "+f),k.setCaratPosition(a.$input.get(0),d.length+1))})},d.prototype.listenToModel=function(){var a=this;this.model.on("match",function(b,c){return console.log(b,c),a.view.render(b);
})},d.prototype.activate=function(){},d.prototype.hide=function(){this.view.hide()},d.prototype.show=function(){return this.find_match()},d.prototype.rejectController=function(){this.view.removeView(),this.emit("reject_controller")},d.prototype.reload=function(a){this.model.reload(a)},d.prototype.handle_keydown=function(a){switch(a.keyCode){case f.ESC:a.preventDefault(),this.rejectController();break;case f.UP:a.preventDefault(),this.view.selectPrevious();break;case f.DOWN:a.preventDefault(),this.view.selectNext();break;case f.TAB:case f.ENTER:null!==this.view.getCurrentIndex()&&(a.preventDefault(),a.stopPropagation(),a.stopImmediatePropagation(),this.view.chooseCurrent()),this.rejectController();break;default:b.noop()}},d.prototype.handle_keyup=function(a){switch(a.keyCode){case f.ESC:return a.preventDefault(),void this.rejectController();case f.UP:case f.DOWN:return void a.preventDefault();case f.TAB:case f.ENTER:return null!==this.view.getCurrentIndex()&&(a.preventDefault(),a.stopPropagation(),a.stopImmediatePropagation(),this.view.chooseCurrent()),void this.rejectController();default:b.noop()}this.find_match()},d.prototype.find_match=function(){var a;a=this.matcher(this.$input.val(),this.$input[0].selectionStart),null===a?this.rejectController():this.model.get_matches(a)},d.prototype.matcher=function(a,b,c){var d,e,f,g;return null==b&&(b=(null!=a?a.length:void 0)||0),null==c&&(c=!1),a?(g=a.substr(0,b),e=this.extract_after_match(this.key,g,!1),this.query=null,"string"==typeof e&&e.length<=this.settings.matchLength?(e.toLowerCase(),f=b-e.length,d=f+e.length,this.query={text:e,start:f,end:d},e):null):void 0},d.prototype.extract_after_match=function(a,b,c){var d,e;return a=a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),c&&(a="(?:^|\\s)"+a),e=new RegExp(a+"([A-Za-z0-9_+-]*)$|"+a+"([^\\x00-\\xff]*)$","gi"),d=e.exec(b),d?d[2]||d[1]:null},d}(e),h=function(a){function d(a,b){_.isArray(b.matchFields)?this.matchFields=b.matchFields:this.matchFields=[b.matchFields],this.settings=b,this.isSaved=!1,this.data=a,this.saved_data=null,d.__super__.constructor.call(this,a)}return c(d,a),d.prototype.get_matches=function(a,b){var c,d=this;return this.data?(this.isSaved||this.load(this.data,function(){return d.get_matches(a,b)}),this.isSaved&&(c=this._get_matches(a),"function"==typeof b&&b(c,a),this.emit("match",c,a)),!0):b([],a)},d.prototype.load=function(a,c){var d=this;"string"==typeof a?b.ajax(a,{dataType:"json"}).done(function(a){return d.save(a,c)}):this.save(a,c)},d.prototype.reload=function(a){null==a&&(a=this.data),this.data=a,this.isSaved=!1,this.saved_data=null},d.prototype.save=function(a,b){this.saved_data=a,this.isSaved=!0,b()},d.prototype._get_matches=function(a){var b,c=this;return b=[],"undefined"!=typeof a&&a.toLowerCase?(_.each(this.saved_data,function(d){var e;e=!1,_.each(c.matchFields,function(b){_.isString(d[b])&&-1!==k.indexOfWithCase(d[b],a,c.settings.matchCase)&&(e=!0)}),e&&b.length<c.settings.displayLimit&&b.push(d)}),b):b},d}(e),i=function(a){function d(a,b){this.item_map={},this.items=[],this.isInDom=!1,this.isShown=!1,this.settings=b,this.index=0,this.limit=5,this.$input=a,this.$dom=null,d.__super__.constructor.call(this,a)}return c(d,a),d.prototype.hide=function(){var a;this.isShown=!1,this.index=null,null!=(a=this.$dom)&&a.hide()},d.prototype.show=function(){var a;null!=(a=this.$dom)&&a.show(),this.isShown||this.emit("shown"),this.isShown=!0},d.prototype.setPosition=function(){var a,b,c;c=this.$input.offset(),b=c.top,a=c.left,b="top"===this.settings.at?0-(this.$dom.height()+this.$input.height()+15):0,this.$dom.css({position:"relative",top:b+"px",left:"0px"})},d.prototype.setDimension=function(){this.$dom.css({width:this.$input.width+"px"})},d.prototype.setView=function(){var a;this.$dom=b("function"==typeof(a=this.settings).tpl_wrapper?a.tpl_wrapper():void 0),this.$input.parent().append(this.$dom),this.isInDom=!0},d.prototype.removeView=function(){var a;this.hide(),null!=(a=this.$dom)&&a.remove(),this.$dom=null,this.isInDom=!1},d.prototype.render=function(a,c){var d,e=this;return a&&a.length?(this.isInDom||this.setView(),this.isShown||this.show(),this.item_map={},this.items=a,this.$dom.html(this.settings.tpl_autocompleteList({items:"<div class='place_holder'></div>"})),d=[],_.each(a,function(a,c){var d,f;d=b("function"==typeof(f=e.settings).tpl_autocompleteListItem?f.tpl_autocompleteListItem(a):void 0),d.insertBefore(b(".place_holder",e.$dom)),d.on("click",function(a){a.preventDefault(),e.choose(c)}).on("mouseover",function(a){e.select(c)}),e.item_map[c]=d}),b(".place_holder",this.$dom).remove(),this.setDimension(),this.setPosition(),this.selectFirst(),this.isShow=!0):this.hide()},d.prototype.getCurrentIndex=function(){return this.index},d.prototype.chooseCurrent=function(){return this.choose(this.index)},d.prototype.choose=function(a){return null===a&&this.emit("mention"),this.emit("mention",this.items[a])},d.prototype.selectFirst=function(){this.select(0)},d.prototype.select=function(a){var b,c;this.isInDom&&this.isShown&&(a>=(null!=(c=this.items)?c.length:void 0)||0>a||(b=this.item_map[this.index||0],null!=b&&b.removeClass(this.settings.autoCompleteItemActive),this.index=a,b=this.item_map[this.index||0],null!=b&&b.addClass(this.settings.autoCompleteItemActive)))},d.prototype.selectNext=function(){return this.select(this.index+1)},d.prototype.selectPrevious=function(){return this.select(this.index-1)},d}(e),g=function(){function a(a,c){this.$input=b(c),this.key_controllers={},this.active_controller=null,this.attachInputEvents()}return a.prototype.attachInputEvents=function(){var a=this;return this.$input.on("keyup",function(b){return a.on_keyup(b)}).on("keydown",function(b){return a.on_keydown(b)}).on("scroll",function(b){return a.hide()}).on("blur",function(b){return setTimeout(function(){return a.hide()},1e3)}).on("focus",function(b){return setTimeout(function(){return a.show()},100)})},a.prototype.on_keyup=function(a){var b;return this.getActiveController()||this.setActiveController(this.detect_controller_trigger()),null!=(b=this.getActiveController())&&b.handle_keyup(a),!0},a.prototype.on_keydown=function(a){var b;return(b=this.getActiveController())?b.handle_keydown(a):void 0},a.prototype.show=function(){var a;return this.getActiveController()||this.setActiveController(this.detect_controller_trigger()),null!=(a=this.getActiveController())&&a.show(),!0},a.prototype.setData=function(a,b){var c;return c=this.getController(a),c?c.reload(b):null},a.prototype.hide=function(){var a,b,c;c=this.key_controllers;for(b in c)a=c[b],a.hide()},a.prototype.reset=function(){return this.hide()},a.prototype.detect_controller_trigger=function(){var a,b,c;c=this.key_controllers;for(b in c)if(a=c[b],null!==a.matcher(this.$input.val(),this.$input[0].selectionStart))return a},a.prototype.getMentions=function(){},a.prototype.init=function(a,b){var c,e;b=_.defaults(b||{},j),e=b.triggerChar,c=this.getController(e),c||(c=new d(e,b.data,this.$input,b),this.setController(e,c))},a.prototype.listen=function(){},a.prototype.getActiveController=function(){return this.active_controller},a.prototype.setActiveController=function(a){return a?this.active_controller=a:void 0},a.prototype.unsetActiveController=function(){return this.active_controller=null},a.prototype.hasController=function(a){return null!=this.key_controllers[a]},a.prototype.setController=function(a,b){var c=this;return b.on("reject_controller",function(){return c.active_controller===b?c.unsetActiveController():void 0}),this.key_controllers[a]=b},a.prototype.getController=function(a){return this.key_controllers[a]},a.api={init:function(a,b){return a.init(a,b)},reset:function(a,b){return a.reset.apply(a,b)},getMentions:function(a,b){return a.getMentions.apply(a,b)},show:function(a,b){return a.show.apply(a,b)},data:function(a,b,c){return a.setData.call(a,b,c)}},a}(),b.fn.mentionsInput=function(){var c,d,e;return c=arguments[0],e=2<=arguments.length?a.call(arguments,1):[],d=e,e="object"!=typeof c&&c?e[0]:c,this.each(function(){var a;return a=b.data(this,"mentionsInput")||b.data(this,"mentionsInput",new g(e,this)),d.unshift(a),_.isFunction(g.api[c])?g.api[c].apply(this,d):"object"!=typeof c&&c?b.error("Method "+c+" does not exist"):g.api.init.call(this,a,c)})},g})}.call(this),define("modules/chat/views/chat_input_panel",["modules/chat/models/user_session","modules/chat/views/emote_menu","modules/view/chat/gift/participant_selection_view","modules/chat/views/chat_window/toybox_view","modules/chat/views/chat_window/toybox_event_store","modules/common/utility","underscore","backbone","jquery.scrollTo","jquery.mentions","jquery"],function(a,b,c,d,e,f,g,h){var i=(a.Session.getInstance(),function(a){var b;if(""!==a.cssText)return a.cssText;b="";for(var c=0;c<a.length;c++)b+=a[c]+": "+a.getPropertyValue(a[c])+"; ";return b}),j=function(a,b,c,d){var e=8,f=1,h=20,j=a,k=c||1,l=d||4,m=5;j.style.paddingTop=e+"px";var n=g.debounce(function(a){var c=document.createElement("div");c.style.padding="0",getComputedStyle&&(c.style.cssText=i(getComputedStyle(a,null))),a.currentStyle&&(c.style=a.currentStyle),c.style.height="",c.style.width=c.clientWidth-m,c.style.position="absolute",c.innerHTML=a.value.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;").replace(/ /g,"&nbsp;"),a.parentNode.appendChild(c);var d=c.clientHeight;c.parentNode.removeChild(c);var j=parseInt($(c).css("lineHeight").replace(/[^-\d\.]/g,""),10);g.isNaN(j)&&(j=h);var n=Math.floor(d/j);n=n>l?l:n,n=k>n?k:n,a.rows=n,n>k?a.style.paddingTop="0px":n===k&&(a.style.paddingTop=e+"px"),n!=f&&(b._triggerResizeEvent(),f=n)},20);j.onkeypress=j.onkeydown=j.onkeyup=function(){var a=this;n(a)}},k=function(a,b,c,e){var f=this;this.$el=$(a),this.$toy_box=$(c),this.$message_input=this.$el.find("textarea.messagebox"),this.$message_input_container=this.$el.find(".chat-window-messagebox-container"),this.$message_input_container.on("touchstart",function(a){a.preventDefault(),f.$message_input.is(":focus")&&f.$message_input.blur(),f.$message_input.focus(),a.stopPropagation()}),this.$message_input.length&&j(this.$message_input.get(0),this),this.$send_btn=this.$el.find("button.sendbutton"),this.$emoticon_btn=this.$el.find(".chat-window-emoticon"),this.$toybox_btn=this.$el.find(".chat-window-adduser"),this.toybox_layout=new d.ToyBoxView({chatwindow:e,model:b}),this.toybox_event_store=this.toybox_layout.getEventStore(),this.$el.find(".toybox-menu").html(this.toybox_layout.render().$el),this.$chat_window=this.$el.parent().find(".chat-window-messages"),this.chat_model=b,this.init()};return g.extend(k.prototype,h.Events),g.extend(k.prototype,{_triggerResizeEvent:function(){var a=this;g.delay(function(){a.trigger("inputResize")},50)},setupMentionsAutocomplete:function(){var a=this.chat_model;(a.is_chat_room()||a.is_group_chat())&&($(this.$message_input).mentionsInput({triggerChar:"/gift ",displayLimit:7,templates:{autocompleteListItem:'<li data-value="${name}">${name}</li>'},at:"top",data:[{name:"all"}]}),$(this.$message_input).mentionsInput({triggerChar:"@",displayLimit:7,templates:{autocompleteListItem:'<li data-value="${name}">${name}</li>'},at:"top",data:null}),$(this.$message_input).on("jqm_shown",function(a){"/gift "===a?f.send_event_to_ga("Chat","Gift","Show Gift Auto Complete"):f.send_event_to_ga("Chat","Mentions","Show Mentions Auto Complete")}).on("jqm_selected",function(a){"/gift "===a?f.send_event_to_ga("Chat","Gift","Select Gift User"):f.send_event_to_ga("Chat","Mentions","Select Mention User")}),this.chat_model.on("participant_added",function(){this.setUserAutoComplete(this.chat_model.getParticipants())},this),this.setUserAutoComplete(this.chat_model.getParticipants()))},init:function(){var a=this;this.toy_box_shown=!1,this.setupMentionsAutocomplete();var c=function(){a.send_message(a.$message_input.val()),a.$message_input.val(""),a.$chat_window.scrollTo("120%",100)};this.$message_input.on("keydown",function(a){13==a.which&&(c(),a.preventDefault())}),this.$emoticon_btn.on("click",function(c){c.preventDefault(),c.stopPropagation(),a.$toybox_btn.removeClass("open"),f.send_event_to_ga("Chat","Emoticon Panel"),b.show(a.$el,a.$emoticon_btn)}),this.$emoticon_btn.on("select",function(b){var c=a.$message_input.val();f.send_event_to_ga("Chat","Emoticon Inserted"),a.$message_input.val(c+b.value+" ").focus()}),this.listenToToyBoxEvents()},_stickerSelect:function(a){this.send_message("/sticker "+a),this.$message_input.focus(),f.send_event_to_ga("Chat","Toybox","Sticker Sent")},_fileSelect:function(a){this.send_image_message(a),this.$message_input.focus()},_giftSelect:function(a){this.send_message(a),this.$message_input.focus(),f.send_event_to_ga("Chat","Toybox","Gift Sent")},listenToToyBoxEvents:function(){this.toybox_event_store.onStickerSelect(g.bind(this._stickerSelect,this)),this.toybox_event_store.onImageSelect(g.bind(this._fileSelect,this)),this.toybox_event_store.onGiftCommand(g.bind(this._giftSelect,this))},setUserAutoComplete:function(a){var b=g(a).map(function(a){return{name:a}});$(this.$message_input).mentionsInput("data","@",b.slice(0)),b.splice(0,0,{name:"all"}),$(this.$message_input).mentionsInput("data","/gift ",b.slice(0))},on_gift_selection:function(a,b,c,d,e){this.chat_model.is_chat_room()||this.chat_model.is_group_chat()?this.public_chat_gift_selection(b,c,d,e,a):this.private_chat_gift_selection(b)},private_chat_gift_selection:function(a){var b="/gift ",c=this.chat_model.get("destination"),d=b+c+" "+a;this.send_message(d);var e=this.$message_input.get(0);e.focus()},public_chat_gift_selection:function(a,b,d,e,f){var h=this,i=c.getInstance(),j=$("#chatgiftbox-modal");i.clearData(),j.modal("show"),i.setGift(a,b,d,e,f),i.setParticipants(this.chat_model.getParticipants()),i.setSelectionCallback(g.once(function(a,b,c){var d=h.send_gift(a,b,c);d&&(d.on("error",function(){j.modal("hide")}),d.on("send_failed",function(){j.modal("hide")}),d.on("response",function(d){var e=d.response_packet;e&&console.log(e),i.showSuccess(a,b,c,f,h.chat_model)}))}))},send_gift:function(a,b,c){if(b){a=a||"all";var d="/gift "+a+" "+b+(c?" -m "+c:"");return this.send_message(d)}},send_image_message:function(a){var b=this,c=new FileReader;c.onload=function(a){b.chat_model.addUserImageMessage(a.target.result)},c.readAsDataURL(a)},send_message:function(a){return a=$.trim(a),""!==a?(this.trigger("user_entered_message",a),this.chat_model.addUserTextMessage(a)):void 0}}),k}),define("hbs!modules/template/user/user_detail",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+='\n	<div class="user-header',d=c["if"].call(a,(d=a&&a.relationship,null==d||d===!1?d:d.is_self),{hash:{},inverse:K.noop,fn:K.program(2,g,b),data:b}),(d||0===d)&&(f+=d),f+='" style="background-image: url(\'',(e=c.cover_photo_url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.cover_photo_url,d=typeof e===L?e.call(a,{hash:{},data:b}):e),f+=M(d)+"');\">\n"}function g(a,b){return" self"}function h(a,b){var d,e,f,h="";return h+='\n	<div class="user-header',d=c["if"].call(a,(d=a&&a.relationship,null==d||d===!1?d:d.is_self),{hash:{},inverse:K.noop,fn:K.program(2,g,b),data:b}),(d||0===d)&&(h+=d),h+='" style="background-image: url(\''+M((e=c.getUrl||a&&a.getUrl,f={hash:{},data:b},e?e.call(a,"jsclient",f):N.call(a,"getUrl","jsclient",f)))+"/app/images/profile_image_03.png');\">\n"}function i(a,b){var d,e="";return e+="\n		",d=c["if"].call(a,(d=a&&a.relationship,null==d||d===!1?d:d.is_self),{hash:{},inverse:K.program(9,k,b),fn:K.program(7,j,b),data:b}),(d||0===d)&&(e+=d),e+="\n	"}function j(a,b){return"\n		"}function k(a,b){var d,e,f,g="";return g+='\n			<div class="user-actions-more">\n				<div class="btn-group">\n					<a class="btn btn-xs btn-default dropdown-toggle" data-toggle="dropdown" href="#">\n						<span class="icon-wb_more"></span>\n					</a>\n					<ul class="dropdown-menu text-left">\n						<li>\n							<a href="/sites/ajax/account/transfer_credit?win_id=account-window&recipient_username=',(e=c.username)?d=e.call(a,{hash:{},data:b}):(e=a&&a.username,d=typeof e===L?e.call(a,{hash:{},data:b}):e),g+=M(d)+'" class="transfer-credit" title="'+M((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|transfer_credit",f):N.call(a,"translate","user|transfer_credit",f)))+'">'+M((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|transfer_credit",f):N.call(a,"translate","user|transfer_credit",f)))+"</a>\n						</li>\n						",d=c["if"].call(a,(d=a&&a.relationship,null==d||d===!1?d:d.is_blocked_by),{hash:{},inverse:K.program(12,m,b),fn:K.program(10,l,b),data:b}),(d||0===d)&&(g+=d),g+='\n						<li>\n							<a href="/sites/ajax/report/report_abuse?win_id=report_abuse&type=2&offender=',(e=c.username)?d=e.call(a,{hash:{},data:b}):(e=a&&a.username,d=typeof e===L?e.call(a,{hash:{},data:b}):e),g+=M(d)+'&subject=Profile%20Abuse&subject_id=undefined" title="'+M((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"common|report",f):N.call(a,"translate","common|report",f)))+'">'+M((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"common|report",f):N.call(a,"translate","common|report",f)))+"</a>\n						</li>\n					</ul>\n				</div>\n			</div>\n		"}function l(a,b){var d,e,f="";return f+='\n							<li><a href="#" onclick="return false;" title="'+M((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"user|unblock",e):N.call(a,"translate","user|unblock",e)))+'" class="user-unblock">'+M((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"user|unblock",e):N.call(a,"translate","user|unblock",e)))+"</a></li>\n						"}function m(a,b){var d,e,f="";return f+='\n							<li><a href="#" onclick="return false;" title="'+M((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"user|block",e):N.call(a,"translate","user|block",e)))+'" class="user-block">'+M((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"user|block",e):N.call(a,"translate","user|block",e)))+"</a></li>\n						"}function n(a,b){var d,e,f="";return(e=c.first_name)?d=e.call(a,{hash:{},data:b}):(e=a&&a.first_name,d=typeof e===L?e.call(a,{hash:{},data:b}):e),f+=M(d)+" "}function o(a,b){var d,e;return(e=c.last_name)?d=e.call(a,{hash:{},data:b}):(e=a&&a.last_name,d=typeof e===L?e.call(a,{hash:{},data:b}):e),M(d)}function p(a,b){var d,e;return(e=c.country)?d=e.call(a,{hash:{},data:b}):(e=a&&a.country,d=typeof e===L?e.call(a,{hash:{},data:b}):e),M(d)}function q(a,b){var d,e,f="";return f+=", "+M((d=c.userGetGender||a&&a.userGetGender,e={hash:{},data:b},d?d.call(a,a,e):N.call(a,"userGetGender",a,e)))}function r(a,b){var d,e,f;return e=c.ifUserCanShowAge||a&&a.ifUserCanShowAge,f={hash:{},inverse:K.noop,fn:K.program(23,s,b),data:b},d=e?e.call(a,a,f):N.call(a,"ifUserCanShowAge",a,f),d||0===d?d:""}function s(a,b){var d,e,f="";return f+=", "+M((d=c.userGetAge||a&&a.userGetAge,e={hash:{},data:b},d?d.call(a,a,e):N.call(a,"userGetAge",a,e)))}function t(a,b){var d,e="";return e+="\n		",d=c["if"].call(a,(d=a&&a.relationship,null==d||d===!1?d:d.is_self),{hash:{},inverse:K.program(26,u,b),fn:K.program(7,j,b),data:b}),(d||0===d)&&(e+=d),e+="\n	"}function u(a,b){var d,e,f,g="";return g+='\n			<button class="btn btn-xs btn-friends chat hidden" type="button">\n				<span class="icon-wb_friend"></span>&nbsp;'+M((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|friends",f):N.call(a,"translate","user|friends",f)))+'\n			</button>\n			<a href="#"\n			   class="btn btn-xs btn-following following hidden"\n			   data-toggle="clickover"\n			   data-placement="top"\n			   data-html="true"\n			   data-title="'+M((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|be_friends_to_chat",f):N.call(a,"translate","user|be_friends_to_chat",f)))+'"\n			   data-content="'+M((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|sweeten_the_invite",f):N.call(a,"translate","user|sweeten_the_invite",f)))+"<div class='padding-4px'></div><a href='/store/category/1/new/?username=",(e=c.username)?d=e.call(a,{hash:{},data:b}):(e=a&&a.username,d=typeof e===L?e.call(a,{hash:{},data:b}):e),g+=M(d)+"' class='btn btn-xs btn-default'>"+M((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|send_gift",f):N.call(a,"translate","user|send_gift",f)))+'</a>"\n			>\n				<span class="icon-wb_fanof"></span>&nbsp;'+M((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|i_m_a_fan",f):N.call(a,"translate","user|i_m_a_fan",f)))+'\n			</a>\n			<button class="btn btn-xs btn-following follow-pending hidden" type="button">\n				<span class="icon-wb_recent"></span>&nbsp;'+M((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|pending",f):N.call(a,"translate","user|pending",f)))+'\n			</button>\n			<button class="btn btn-xs btn-default follow hidden" type="button">\n				<span class="icon-wb_add"></span>&nbsp;'+M((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|add",f):N.call(a,"translate","user|add",f)))+"\n			</button>\n		"}function v(a,b){var d,e,f,g="";return g+='\n	<div class="user-stats font-size-12 clearfix">\n		<div class="col-xs-3 user-stat">\n			',e=c.compare||a&&a.compare,f={hash:{operator:">"},inverse:K.program(31,x,b),fn:K.program(29,w,b),data:b},d=e?e.call(a,a&&a.num_posts,1,f):N.call(a,"compare",a&&a.num_posts,1,f),(d||0===d)&&(g+=d),g+='\n		</div>\n		<div class="col-xs-3 user-stat">\n			',e=c.compare||a&&a.compare,f={hash:{operator:">"},inverse:K.program(35,z,b),fn:K.program(33,y,b),data:b},d=e?e.call(a,a&&a.num_followers,1,f):N.call(a,"compare",a&&a.num_followers,1,f),(d||0===d)&&(g+=d),g+='\n		</div>\n		<div class="col-xs-3 user-stat">\n			',e=c.compare||a&&a.compare,f={hash:{operator:">"},inverse:K.program(39,B,b),fn:K.program(37,A,b),data:b},d=e?e.call(a,a&&a.num_gifts_received,1,f):N.call(a,"compare",a&&a.num_gifts_received,1,f),(d||0===d)&&(g+=d),g+='\n		</div>\n		<div class="col-xs-3 user-stat">\n			',e=c.compare||a&&a.compare,f={hash:{operator:">"},inverse:K.program(43,D,b),fn:K.program(41,C,b),data:b},d=e?e.call(a,a&&a.num_badges_unlocked,1,f):N.call(a,"compare",a&&a.num_badges_unlocked,1,f),(d||0===d)&&(g+=d),g+="\n		</div>\n	</div>\n"}function w(a,b){var d,e,f,g="";return g+='\n				<a href="',(e=c.personalized_url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.personalized_url,d=typeof e===L?e.call(a,{hash:{},data:b}):e),g+=M(d)+'" title="',(e=c.num_posts)?d=e.call(a,{hash:{},data:b}):(e=a&&a.num_posts,d=typeof e===L?e.call(a,{hash:{},data:b}):e),g+=M(d)+" "+M((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"homefeed|posts",f):N.call(a,"translate","homefeed|posts",f)))+'">'+M((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"homefeed|posts",f):N.call(a,"translate","homefeed|posts",f)))+'<br /><span class="count font-size-14">'+M((e=c.roundNumber||a&&a.roundNumber,f={hash:{},data:b},e?e.call(a,a&&a.num_posts,5e3,f):N.call(a,"roundNumber",a&&a.num_posts,5e3,f)))+"</span></a>\n			"}function x(a,b){var d,e,f,g="";return g+='\n				<a href="',(e=c.personalized_url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.personalized_url,d=typeof e===L?e.call(a,{hash:{},data:b}):e),g+=M(d)+'" title="',(e=c.num_posts)?d=e.call(a,{hash:{},data:b}):(e=a&&a.num_posts,d=typeof e===L?e.call(a,{hash:{},data:b}):e),g+=M(d)+" "+M((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"homefeed|post",f):N.call(a,"translate","homefeed|post",f)))+'">'+M((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"homefeed|post",f):N.call(a,"translate","homefeed|post",f)))+'<br /><span class="count font-size-14">',(e=c.num_posts)?d=e.call(a,{hash:{},data:b}):(e=a&&a.num_posts,d=typeof e===L?e.call(a,{hash:{},data:b}):e),g+=M(d)+"</span></a>\n			"}function y(a,b){var d,e,f,g="";return g+='\n				<a href="',(e=c.personalized_url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.personalized_url,d=typeof e===L?e.call(a,{hash:{},data:b}):e),g+=M(d)+'/fans" title="',(e=c.num_followers)?d=e.call(a,{hash:{},data:b}):(e=a&&a.num_followers,d=typeof e===L?e.call(a,{hash:{},data:b}):e),g+=M(d)+" "+M((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|fans",f):N.call(a,"translate","user|fans",f)))+'">'+M((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|fans",f):N.call(a,"translate","user|fans",f)))+'<br /><span class="count font-size-14">'+M((e=c.roundNumber||a&&a.roundNumber,f={hash:{},data:b},e?e.call(a,a&&a.num_followers,5e3,f):N.call(a,"roundNumber",a&&a.num_followers,5e3,f)))+"</span></a>\n			"}function z(a,b){var d,e,f,g="";return g+='\n				<a href="',(e=c.personalized_url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.personalized_url,d=typeof e===L?e.call(a,{hash:{},data:b}):e),g+=M(d)+'/fans" title="',(e=c.num_followers)?d=e.call(a,{hash:{},data:b}):(e=a&&a.num_followers,d=typeof e===L?e.call(a,{hash:{},data:b}):e),g+=M(d)+" "+M((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|fan",f):N.call(a,"translate","user|fan",f)))+'">'+M((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|fan",f):N.call(a,"translate","user|fan",f)))+'<br /><span class="count font-size-14">',(e=c.num_followers)?d=e.call(a,{hash:{},data:b}):(e=a&&a.num_followers,d=typeof e===L?e.call(a,{hash:{},data:b}):e),g+=M(d)+"</span></a>\n			"}function A(a,b){var d,e,f,g="";return g+='\n				<a href="',(e=c.personalized_url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.personalized_url,d=typeof e===L?e.call(a,{hash:{},data:b}):e),g+=M(d)+'/gifts" title="',(e=c.num_gifts_received)?d=e.call(a,{hash:{},data:b}):(e=a&&a.num_gifts_received,d=typeof e===L?e.call(a,{hash:{},data:b}):e),g+=M(d)+" "+M((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|gifts",f):N.call(a,"translate","user|gifts",f)))+'">'+M((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|gifts",f):N.call(a,"translate","user|gifts",f)))+'<br /><span class="count font-size-14">'+M((e=c.roundNumber||a&&a.roundNumber,f={hash:{},data:b},e?e.call(a,a&&a.num_gifts_received,5e3,f):N.call(a,"roundNumber",a&&a.num_gifts_received,5e3,f)))+"</span></a>\n			"}function B(a,b){var d,e,f,g="";return g+='\n				<a href="',(e=c.personalized_url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.personalized_url,d=typeof e===L?e.call(a,{hash:{},data:b}):e),g+=M(d)+'/gifts" title="',(e=c.num_gifts_received)?d=e.call(a,{hash:{},data:b}):(e=a&&a.num_gifts_received,d=typeof e===L?e.call(a,{hash:{},data:b}):e),g+=M(d)+" "+M((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|gift",f):N.call(a,"translate","user|gift",f)))+'">'+M((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|gift",f):N.call(a,"translate","user|gift",f)))+'<br /><span class="count font-size-14">',(e=c.num_gifts_received)?d=e.call(a,{hash:{},data:b}):(e=a&&a.num_gifts_received,d=typeof e===L?e.call(a,{hash:{},data:b}):e),g+=M(d)+"</span></a>\n			"}function C(a,b){var d,e,f,g="";return g+='\n				<a href="',(e=c.personalized_url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.personalized_url,d=typeof e===L?e.call(a,{hash:{},data:b}):e),g+=M(d)+'/badges" title="',(e=c.num_badges_unlocked)?d=e.call(a,{hash:{},data:b}):(e=a&&a.num_badges_unlocked,d=typeof e===L?e.call(a,{hash:{},data:b}):e),g+=M(d)+" "+M((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|badges",f):N.call(a,"translate","user|badges",f)))+'">'+M((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|badges",f):N.call(a,"translate","user|badges",f)))+'<br /><span class="count font-size-14">'+M((e=c.roundNumber||a&&a.roundNumber,f={hash:{},data:b},e?e.call(a,a&&a.num_badges_unlocked,5e3,f):N.call(a,"roundNumber",a&&a.num_badges_unlocked,5e3,f)))+"</span></a>\n			"}function D(a,b){var d,e,f,g="";return g+='\n				<a href="',(e=c.personalized_url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.personalized_url,d=typeof e===L?e.call(a,{hash:{},data:b}):e),g+=M(d)+'/badges" title="',(e=c.num_badges_unlocked)?d=e.call(a,{hash:{},data:b}):(e=a&&a.num_badges_unlocked,d=typeof e===L?e.call(a,{hash:{},data:b}):e),g+=M(d)+" "+M((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|badge",f):N.call(a,"translate","user|badge",f)))+'">'+M((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|badge",f):N.call(a,"translate","user|badge",f)))+'<br /><span class="count font-size-14">',(e=c.num_badges_unlocked)?d=e.call(a,{hash:{},data:b}):(e=a&&a.num_badges_unlocked,d=typeof e===L?e.call(a,{hash:{},data:b}):e),g+=M(d)+"</span></a>\n			"}function E(a,b){var d,e="";return e+="\n		",d=c["if"].call(a,(d=a&&a.relationship,null==d||d===!1?d:d.is_self),{hash:{},inverse:K.program(46,F,b),fn:K.program(7,j,b),data:b}),(d||0===d)&&(e+=d),e+="\n	"}function F(a,b){var d,e,f,g="";return g+='\n			<a href="#" class="chat"><span class="icon-wb_chat"></span></a>\n			&nbsp;&nbsp;\n			<a href="/store/category/1/new/?username=',(e=c.username)?d=e.call(a,{hash:{},data:b}):(e=a&&a.username,d=typeof e===L?e.call(a,{hash:{},data:b}):e),g+=M(d)+'" title="'+M((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|send_gift",f):N.call(a,"translate","user|send_gift",f)))+'"><span class="icon-wb_gift"></span></a>\n			&nbsp;&nbsp;\n		'}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var G,H,I,J="",K=this,L="function",M=this.escapeExpression,N=c.helperMissing,O=c.blockHelperMissing;return G=c["if"].call(b,b&&b.cover_photo_url,{hash:{},inverse:K.program(4,h,e),fn:K.program(1,f,e),data:e}),(G||0===G)&&(J+=G),J+="\n	",I={hash:{},inverse:K.noop,fn:K.program(6,i,e),data:e},(H=c.ifLoggedIn)?G=H.call(b,I):(H=b&&b.ifLoggedIn,G=typeof H===L?H.call(b,I):H),c.ifLoggedIn||(G=O.call(b,G,{hash:{},inverse:K.noop,fn:K.program(6,i,e),data:e})),(G||0===G)&&(J+=G),J+='\n	<div class="user-avatar">\n		<a href="',(H=c.personalized_url)?G=H.call(b,{hash:{},data:e}):(H=b&&b.personalized_url,G=typeof H===L?H.call(b,{hash:{},data:e}):H),J+=M(G)+'" class="profile-hovercard" data-username="',(H=c.username)?G=H.call(b,{hash:{},data:e}):(H=b&&b.username,G=typeof H===L?H.call(b,{hash:{},data:e}):H),J+=M(G)+'">\n			<img src="'+M((H=c.userGetDisplayPictureUrl||b&&b.userGetDisplayPictureUrl,I={hash:{},data:e},H?H.call(b,60,60,b,I):N.call(b,"userGetDisplayPictureUrl",60,60,b,I)))+'" width="60" height="60" class="img-circle" />\n		</a>\n	</div>\n</div>\n\n<div class="user-username font-size-14 text-center">\n	<a href="',(H=c.personalized_url)?G=H.call(b,{hash:{},data:e}):(H=b&&b.personalized_url,G=typeof H===L?H.call(b,{hash:{},data:e}):H),J+=M(G)+'" class="profile-hovercard" data-username="',(H=c.username)?G=H.call(b,{hash:{},data:e}):(H=b&&b.username,G=typeof H===L?H.call(b,{hash:{},data:e}):H),J+=M(G)+'">',(H=c.username)?G=H.call(b,{hash:{},data:e}):(H=b&&b.username,G=typeof H===L?H.call(b,{hash:{},data:e}):H),J+=M(G)+'</a>\n	<span class="user-label">'+M((H=c.userGetLabels||b&&b.userGetLabels,I={hash:{},data:e},H?H.call(b,b,I):N.call(b,"userGetLabels",b,I)))+'</span>\n	&nbsp;\n	<span class="user-name">',H=c.isNotEmpty||b&&b.isNotEmpty,I={hash:{},inverse:K.noop,fn:K.program(14,n,e),data:e},G=H?H.call(b,b&&b.first_name,I):N.call(b,"isNotEmpty",b&&b.first_name,I),(G||0===G)&&(J+=G),H=c.isNotEmpty||b&&b.isNotEmpty,I={hash:{},inverse:K.noop,fn:K.program(16,o,e),data:e},G=H?H.call(b,b&&b.last_name,I):N.call(b,"isNotEmpty",b&&b.last_name,I),(G||0===G)&&(J+=G),J+='</span>\n</div>\n<div class="user-about font-size-12 text-center">\n	<span class="user-miglevel">'+M((H=c.translate||b&&b.translate,I={hash:{},data:e},H?H.call(b,"user|miglevel_with_level",b&&b.mig_level,I):N.call(b,"translate","user|miglevel_with_level",b&&b.mig_level,I)))+'</span>\n	&nbsp;\n	<span class="user-profile">\n		',H=c.isNotEmpty||b&&b.isNotEmpty,I={hash:{},inverse:K.noop,fn:K.program(18,p,e),data:e},G=H?H.call(b,b&&b.country,I):N.call(b,"isNotEmpty",b&&b.country,I),(G||0===G)&&(J+=G),H=c.isNotEmpty||b&&b.isNotEmpty,I={hash:{},inverse:K.noop,fn:K.program(20,q,e),data:e},G=H?H.call(b,b&&b.gender,I):N.call(b,"isNotEmpty",b&&b.gender,I),(G||0===G)&&(J+=G),H=c.isNotEmpty||b&&b.isNotEmpty,I={hash:{},inverse:K.noop,fn:K.program(22,r,e),data:e},G=H?H.call(b,b&&b.date_of_birth,I):N.call(b,"isNotEmpty",b&&b.date_of_birth,I),
(G||0===G)&&(J+=G),J+='\n	</span>\n</div>\n<div class="user-actions-follow text-center">\n	',I={hash:{},inverse:K.noop,fn:K.program(25,t,e),data:e},(H=c.ifLoggedIn)?G=H.call(b,I):(H=b&&b.ifLoggedIn,G=typeof H===L?H.call(b,I):H),c.ifLoggedIn||(G=O.call(b,G,{hash:{},inverse:K.noop,fn:K.program(25,t,e),data:e})),(G||0===G)&&(J+=G),J+="\n</div>\n\n",H=c.isNotEmpty||b&&b.isNotEmpty,I={hash:{},inverse:K.noop,fn:K.program(28,v,e),data:e},G=H?H.call(b,b&&b.num_posts,I):N.call(b,"isNotEmpty",b&&b.num_posts,I),(G||0===G)&&(J+=G),J+='\n\n<div class="user-actions text-center">\n	',I={hash:{},inverse:K.noop,fn:K.program(45,E,e),data:e},(H=c.ifLoggedIn)?G=H.call(b,I):(H=b&&b.ifLoggedIn,G=typeof H===L?H.call(b,I):H),c.ifLoggedIn||(G=O.call(b,G,{hash:{},inverse:K.noop,fn:K.program(45,E,e),data:e})),(G||0===G)&&(J+=G),J+='\n\n	<a href="#" class="show-miniprof-share" title="'+M((H=c.translate||b&&b.translate,I={hash:{},data:e},H?H.call(b,"common|share",I):N.call(b,"translate","common|share",I)))+'">\n		<span class="icon-wb_mb_share"></span>\n	</a>\n</div>'})}),define("modules/view/user/user_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/user/user_detail","modules/common/config","modules/common/utility","modules/chat/models/chats","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j){var k=e.ItemView.extend({template:{type:"handlebars",template:g},className:"user",initialize:function(){a.bindAll(this)},events:{"click .follow":"follow","click .unfollow":"unfollow","click .user-block":"block","click .user-unblock":"unblock","click .chat":"chat","click .mention":"mention","click .show-miniprof-share":"showMiniProfShare"},onRender:function(){var a=this.model.get("userRelationship");a=this._parseData(a),this._parseRelationship(a),b(".following",this.$el).clickover({width:250,global_close:!0}),b(".user-stat a[title]",this.$el).qtip({position:{my:"bottom center",at:"top center"},style:{classes:"qtip-user",def:!1},hide:{event:"click mouseleave"}})},follow:function(a){a.preventDefault();var b=this,c=this.model.follow();c.done(function(a){a=i.parse_ajax_response(a),a.error||b._parseRelationship(a.user.relationship)})},unfollow:function(a){a.preventDefault();var b=this,c=this.model.unfollow();c.done(function(a){a=i.parse_ajax_response(a),a.error||b._parseRelationship(a.user.relationship)})},block:function(){this.model.block()},unblock:function(){this.model.unblock()},chat:function(){this.model.get("id")&&this.model.get("username")&&j.ChatStoreModel.getInstance().startPrivateChat(this.model.get("id"),this.model.get("username"),null,this.model.get("username"))},mention:function(a){a.preventDefault();var c=this,d=b("#sharebox-modal");b('textarea[name="body"]',d).focus().val("@"+c.model.get("username")+" "),d.modal("show")},sendGift:function(a){i.show_gift_selection("profile");var c=b("#gift-modal").find("input#to");c.tagit("removeAll").tagit("createTag",this.model.get("username"))},showMiniProfShare:function(a){null!==a&&a.preventDefault(),i.show_share_dialog("user",this.model)},_parseRelationship:function(a){if(b(".chat, .following, .follow, .unfollow-link, .follow-pending",this.$el).addClass("hidden"),b(".user-relationship",this.$el).addClass("hidden"),"undefined"!=typeof a&&null!==a){var c="undefined"==typeof a.isFriend?a.is_friend:a.isFriend,d="undefined"==typeof a.isFollower?a.is_follower:a.isFollower,e="undefined"==typeof a.isFollowedBy?a.is_followed_by:a.isFollowedBy,f="undefined"==typeof a.isFollowerPendingApproval?a.is_follower_pending:a.isFollowerPendingApproval;b(".btn-friends",this.$el).addClass("hidden"),c||d&&e?(this._allowChat(),b(".btn-friends",this.$el).removeClass("hidden"),b(".user-relationship",this.$el).removeClass("hidden"),b(".user-relationship",this.$el).html('<span class="icon-wb_friend green" title="'+i.translate("user|friends")+'"></span>&nbsp;'),b(".unfollow-link",this.$el).html('<span class="icon-wb_fanof"></span>&nbsp;'+i.translate("user|remove_as_friend")).removeClass("hidden follow follow-pending following")):d?(b(".user-relationship",this.$el).removeClass("hidden"),b(".user-relationship",this.$el).html('<span class="icon-wb_following green" title="'+i.translate("user|fan")+'"></span>&nbsp;'),b(".unfollow-link",this.$el).html('<span class="icon-wb_fanof"></span>&nbsp;'+i.translate("user|remove_as_fan")).removeClass("hidden follow follow-pending following")):f?(b(".user-relationship",this.$el).removeClass("hidden"),b(".user-relationship",this.$el).html('<span class="icon-wb_following green" title="'+i.translate("user|fan")+'"></span>'),b(".follow-pending",this.$el).html('<span class="icon-wb_fanof"></span>&nbsp;'+i.translate("user|group|pending_approval")).removeClass("hidden follow unfollow-link following")):b(".follow",this.$el).html('<span class="icon-wb_add" title="'+i.translate("user|add")+'"></span>&nbsp;').removeClass("hidden unfollow-link follow-pending following");var g=this.model.get("privacy"),h=this.model.get("chatPrivacy");if("undefined"!=typeof h&&null!==h&&("undefined"==typeof g||null===g))switch(g={},h){case"EVERYONE":g.chat=1;break;case"FRIEND_ONLY":g.chat=2;break;case"FOLLOWER_ONLY":g.chat=3}"undefined"!=typeof g&&null!==g&&"undefined"!=typeof g.chat&&null!==g.chat&&(1==g.chat?this._allowChat():3==g.chat&&e&&this._allowChat())}else b(".user-relationship",this.$el).parent().addClass("hidden")},_allowChat:function(){b(".chat",this.$el).not(".btn-friends").addClass("cursorPointer").removeClass("hidden")},_parseData:function(a){if(void 0===a||"undefined"===a||null===a)a=this.model.get("relationship");else if("undefined"!=typeof this.model.get("userRelationshipData")){var b=this.model.get("userRelationshipData");"undefined"==typeof a.isFollower&&(a.isFollower=b.follower),"undefined"==typeof a.isFollowedBy&&(a.isFollowedBy=b.followedBy),"undefined"==typeof a.isFollowerPendingApproval&&(a.isFollowerPendingApproval=b.followerPendingApproval)}var c=!1;return"undefined"==typeof this.model.get("personalized_url")&&(this.model.set("personalized_url","/u/"+this.model.get("username")),c=!0),c=this._copyData("mig_level","migLevel")?!0:c,c=this._copyData("num_posts","numOfPosts")?!0:c,c=this._copyData("num_followers","numOfFollowers")?!0:c,c=this._copyData("num_gifts_received","numOfGiftsReceived")?!0:c,c=this._copyData("num_badges_unlocked","numOfBadgesUnlocked")?!0:c,c===!0&&this.render(),a},_copyData:function(a,b){return"undefined"==typeof this.model.get(a)&&"undefined"!=typeof this.model.get(b)?(this.model.set(a,this.model.get(b)),!0):!1}});return k}),define("modules/chat/views/chat_participant_list",["modules/chat/models/user_session","modules/chat/models/contacts","modules/chat/config/config_ts","modules/common/utility","modules/model/user/user_model","modules/view/user/user_view","underscore","backbone","modules/globals/url","modules/mig33_app","jquery"],function(a,b,c,d,e,f,g,h,i,j){var k=c.config,l=(a.Session.getInstance(),{ONLINE:"0",AWAY:"1",BUSY:"2",OFFLINE:"3",UNKNOWN:"4"}),m=function(a){var b=require("modules/mig33_app"),c=d.get_profile_url(a);b.navigate_to(c)},n=function(a,b){this.random_seed=(new Date).getTime(),this.$el=$(a),this.$el.addClass("participant-list"),this.chat_model=b;return b.is_chat_room()||b.is_group_chat()?(this.chat_model.on("participant_added",function(){this.renderParticipants()},this),this.chat_model.on("participant_removed",function(){this.renderParticipants()},this),this.chat_model.on("chatroom_joined",function(){this.chat_model.getParticipants()},this),void this.renderParticipants()):void this.clearParticipants()};return g.extend(n.prototype,h.Events),g.extend(n.prototype,{renderParticipants:function(){var a;if(!(this.$el.length<=0)){this.clearParticipants();var b=this.chat_model.getParticipants(),c=this;a=document.createDocumentFragment(),g.each(b,function(b){var d=c.getParticipantDOM(b.toString());a.appendChild(d)}),this.$el.get(0).appendChild(a),this.sort(),this.attachEventListeners(),d.parse_profile_hovercard(this.$el.get(0))}},clickEvent:function(a,b){a.preventDefault();var c=b.data("name");m(c)},attachEventListeners:function(){var a=this;this.$el.find("div").on("click",function(b){b.target=b.currentTarget,a.clickEvent(b,$(this))})},removeEventListeners:function(){this.$el.find("div").off("click"),this.$el.find("div").off("mouseover")},comparator:function(a,b){var c=a.getAttribute("data-sortdetail"),d=b.getAttribute("data-sortdetail");return c?d?c.localeCompare(d):1:-1},sort:function(){var a=this.$el.get(0),b=a.querySelectorAll("div");if(b&&!(b.length<=0)){b=Array.prototype.slice.call(b,0),b.sort(this.comparator);for(var c=0;c<b.length;c++)b[c].parentNode.appendChild(b[c])}},getParticipantDOM:function(a){var b,c,d=a.replace(/\./gi,"--").replace(/@/gi,""),e=d+"_"+this.random_seed,f=this.chat_model.is_admin(a)?"admin":"";f+=" x-tree-node-leaf participant participant_"+this.random_seed;var g=this.chat_model.is_admin(a)?'<span class="icon-wb_admin user-label-admin" title="Admin"></span>':"";b=this.getContact(a),c=this.getOnlineStatus(b);var h=document.createElement("div");return h.innerHTML="<span class='status small fusion-unknown'></span><a class='profile-hovercard "+f+"' href='#' data-adjust-method='flip shift' data-at='middle left' data-my='middle right' data-username='"+a+"'>"+a+"</a>"+g,h.setAttribute("data-name",a),h.setAttribute("id",e),h.setAttribute("class","participant-item text-truncate"),this.updateSortString(h,c,a),this.updateStatusNode(h,c),this.updateUsernameColor(h,a),this.listenToContact(h,b,a),h},listenToContact:function(a,b,c){b&&b.on("change",function(){var d=this.getOnlineStatus(b);this.updateSortString(a,d,c),this.updateStatusNode(a,d),this.sort()},this)},updateStatusNode:function(a,b){var c=a.querySelector("span.status"),d="status small ";switch(b){case l.ONLINE:d+="fusion-online";break;case l.AWAY:d+="fusion-away";break;case l.BUSY:d+="fusion-busy";break;case l.OFFLINE:d+="fusion-offline";break;default:d+="fusion-unknown"}c.setAttribute("class",d)},updateUsernameColor:function(a,b){var c=a.querySelector("a.profile-hovercard");if("undefined"==typeof j&&(j=require("modules/mig33_app")),j.cache.user[b])c.classList.add(d.get_userlabel_color(j.cache.user[b].get("label")));else{var f=new e({username:b});f.fetch(),f.on("change",function(){j.cache.user[b]=f,c.classList.add(d.get_userlabel_color(j.cache.user[b].get("label")))})}},updateSortString:function(a,b,c){var d=this.getSortString(c,b);a.setAttribute("data-sortdetail",d)},getOnlineStatusFromContact:function(a){var b,c=a.getPresence();switch(c){case k.Presence.online:b=l.ONLINE;break;case k.Presence.away:b=l.AWAY;break;case k.Presence.busy:b=l.BUSY;break;case k.Presence.offline:b=l.OFFLINE;break;default:b=l.UNKNOWN}return b},getContact:function(a){var b=require("modules/chat/models/contacts").ContactGroupStore.getInstance();return b.find_contact_by_name(a)},getOnlineStatus:function(a){var b;return b=a?this.getOnlineStatusFromContact(a):l.UNKNOWN},getSortString:function(a,b){var c;return c=this.chat_model.is_admin(a)?"0":"1",c+=b,c+="-"+a},clearParticipants:function(){this.removeEventListeners(),this.$el.empty()}}),n}),define("modules/chat/views/more_options_menu",["handlebars","modules/chat/models/user_session","modules/chat/config/config_ts","modules/common/utility","underscore","modules/chat/models/chatrooms","modules/model/user/user_model","jquery","backbone"],function(a,b,c,d,e,f,g){var h=(c.config,b.Session.getInstance(),f.ChatRoomCategoryStore.getInstance()),i=function(){},j=function(a){var b=document.location.protocol+"//"+document.location.host;b+="/sites/ajax/account/transfer_credit?"+$.param({win_id:"account-window",recipient_username:a});var c=require("modules/mig33_app");c.navigate_to(b)},k=function(a,b){var c=3,d=b.get("destination"),e=document.location.protocol+"//"+document.location.host;e+="/sites/ajax/report/report_abuse?win_id=report_abuse&type="+c+"&offender="+a+"&subject="+d+"&subject_id="+d;var f=require("modules/mig33_app");f.navigate_to(e)},l=function(a){var b=d.translate("chat|are_you_sure_block_mute",a),c=window.confirm(b);if(c){var e=new g({username:a});e.fetch(),e.on("change",function(){var a=e.get("relationship");if(a){var b=a.is_blocked_by;b||e.block()}})}},m=i.prototype;return e.extend(m,{build_html:function(a,b,c){var e,f=this;this.current_chat=b,this.current_chat_window=a;var g=f.current_chat,i="";if(g.is_chat_room()){var m="/chatroom/"+g.get("name"),n="";if(g.get("group_id")){var o="/group/"+g.get("group_id");n='<li><a href="'+o+'" class="ico-chatroom-info">'+d.translate("chat|goto_group")+"</a></li>"}var p='<li><a href="#" class="ico-fav-chat">'+d.translate("chat|add_to_favourites")+"</a></li>";h.is_chatroom_favourite(g.get("name"))&&(p='<li><a href="#" class="ico-fav-chat">'+d.translate("chat|remove_from_favourites")+"</a></li>"),i='<li><a href="#" class="add-people">'+d.translate("chat|add_people")+'</a></li><li><a href="#" data-chatroom-name="'+g.get("name")+'" class="share-chatroom">'+d.translate("chat|share_chatroom")+'</a></li><li><a href="'+m+'" class="ico-chatroom-info">'+d.translate("chat|chatroom_info")+"</a></li>"+n+p+'<li><a href="#" class="leave-chat">'+d.translate("chat|leave_chat")+"</a></li>"}else if(g.is_group_chat())i='<li><a href="#" class="add-people">'+d.translate("chat|add_people")+'</a></li><li><a href="#" class="rename-chat">'+d.translate("chat|rename_group_chat")+'</a></li><li><a href="#" class="leave-chat">'+d.translate("chat|leave_chat")+"</a></li>";else{var q=g.get("destination");i='<li><a href="#" class="add-people">'+d.translate("chat|add_people")+'</a></li><li><a href="#" data-username='+q+' class="transfer-credit">'+d.translate("user|transfer_credit")+'</a></li><li><a href="#" data-username='+q+' class="user-block">'+d.translate("user|block")+'</a></li><li><a href="#" data-username='+q+' class="report-abuse">'+d.translate("common|report_abuse")+"</a></li>"}e=c.find("ul.title-menu"),e.html(i);var r=e.find(".ico-fav-chat");r.on("click",function(a){a.preventDefault(),h.is_chatroom_favourite(g.get("name"))?h.remove_favourite_chatroom(g.get("name")):h.add_favourite_chatroom(g.get("name"))}),h.on("add_favourite_chatroom_success",function(a){r.text(d.translate("chat|remove_from_favourites"))}),h.on("remove_favourite_chatroom_success",function(a){r.text(d.translate("chat|add_to_favourites"))}),e.find(".add-people").on("click",function(a){a.preventDefault();var b=f.current_chat_window.getChatModel();d.show_chat_invite_dialog(b)}),e.find(".rename-chat").on("click",function(a){a.preventDefault(),f.current_chat_window.show_rename_chat()}),e.find(".leave-chat").on("click",function(a){a.preventDefault(),f.current_chat_window.leave_chat()}),e.find(".transfer-credit").on("click",function(a){a.preventDefault();var b=$(this).data("username");j(b),d.hide_mobile_chat(),f.current_chat_window.close()}),e.find(".user-block").on("click",function(a){a.preventDefault();var b=$(this).data("username");l(b)}),e.find(".report-abuse").on("click",function(a){a.preventDefault();var b=$(this).data("username"),c=f.current_chat_window.getChatModel();k(b,c),d.hide_mobile_chat(),f.current_chat_window.close()}),e.find(".share-chatroom").on("click",function(a){a.preventDefault();var b={chatroom_name:$(this).data("chatroom-name")};d.show_share_dialog("chatroom",b)})}}),i}),define("hbs!modules/template/chat/window/window",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e="";return e+="\n                ",d=c["if"].call(a,a&&a.isPrivateChat,{hash:{},inverse:v.program(4,h,b),fn:v.program(2,g,b),data:b}),(d||0===d)&&(e+=d),e+="\n            "}function g(a,b){var d,e,f="";return f+='\n                    <a class="profile-hovercard" data-username="',(e=c.chat_title)?d=e.call(a,{hash:{},data:b}):(e=a&&a.chat_title,d=typeof e===t?e.call(a,{hash:{},data:b}):e),f+=u(d)+'" href="/u/',(e=c.chat_title)?d=e.call(a,{hash:{},data:b}):(e=a&&a.chat_title,d=typeof e===t?e.call(a,{hash:{},data:b}):e),f+=u(d)+'"><span ',(e=c.displayPicture)?d=e.call(a,{hash:{},data:b}):(e=a&&a.displayPicture,d=typeof e===t?e.call(a,{hash:{},data:b}):e),(d||0===d)&&(f+=d),f+='\n                         class="wb wb-36 inline-block img-circle title-avatar-pic"/></a>\n                '}function h(a,b){var d,e="";return e+="\n                    ",d=c["if"].call(a,a&&a.isGroupChat,{hash:{},inverse:v.program(7,j,b),fn:v.program(5,i,b),data:b}),(d||0===d)&&(e+=d),e+="\n                "}function i(a,b){return'\n                        <span class="inline-block wb wb-36 wb-chatp-groupchat title-avatar-pic"></span>\n                    '}function j(a,b){return'\n                        <span class="inline-block wb wb-36 wb-chatp-chatrm title-avatar-pic"></span>\n                    '}function k(a,b){var d,e="";return e+="\n			            ",d=c["if"].call(a,a&&a.isMultiUserChat,{hash:{},inverse:v.noop,fn:v.program(10,l,b),data:b}),(d||0===d)&&(e+=d),e+="\n		            "}function l(a,b){var d,e,f="";return f+="\n				            "+u((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"chat|participant-count",a&&a.participantCount,e):w.call(a,"translate","chat|participant-count",a&&a.participantCount,e)))+"\n			            "}function m(a,b){return"col-xs-12"}function n(a,b){return"col-xs-9"}function o(a,b){return"hidden"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var p,q,r,s="",t="function",u=this.escapeExpression,v=this,w=c.helperMissing,x=c.blockHelperMissing;return s+='<div class="row no-margin mig-window-header">\n    <div class="col-xs-9 no-padding">\n        <span class="unread-chats-badge badge font-size-12 hidden">0</span>\n        <div class="mig-window-title">\n            ',p=c["if"].call(b,b&&b.isFusionChat,{hash:{},inverse:v.noop,fn:v.program(1,f,e),data:e}),(p||0===p)&&(s+=p),s+='\n            <span class="title-text text-truncate" title="',(q=c.chat_title)?p=q.call(b,{hash:{},data:e}):(q=b&&b.chat_title,p=typeof q===t?q.call(b,{hash:{},data:e}):q),(p||0===p)&&(s+=p),s+='">\n	            <div class="main">',(q=c.chat_title)?p=q.call(b,{hash:{},data:e}):(q=b&&b.chat_title,p=typeof q===t?q.call(b,{hash:{},data:e}):q),(p||0===p)&&(s+=p),s+='</div>\n	            <div class="subtitle">\n		            ',p=c["if"].call(b,b&&b.isFusionChat,{hash:{},inverse:v.noop,fn:v.program(9,k,e),data:e}),(p||0===p)&&(s+=p),s+='\n	            </div>\n            </span>\n	    <a href="#" data-toggle="dropdown" class="title-btn participant-count dropdown-toggle">\n                <span class="icon-wb_more font-size-12" ></span>\n            </a>\n            <ul class="title-menu dropdown-menu">\n            </ul>\n        </div>\n    </div>\n    <div class="col-xs-3 title-btn text-right no-padding mig-window-actions">\n        <div class="mig-window-option">\n            <a href="#" class="toggle-min-max-mig-window padding-right-6px font-size-12" title="'+u((q=c.translate||b&&b.translate,r={hash:{},data:e},q?q.call(b,"chat|minimize_window",r):w.call(b,"translate","chat|minimize_window",r)))+'">\n                <span class="icon-wb_chatminimize"></span>\n            </a>\n            <a href="#" class="close-mig-window font-size-12" title="'+u((q=c.translate||b&&b.translate,r={hash:{},data:e},q?q.call(b,"chat|close_window",r):w.call(b,"translate","chat|close_window",r)))+'">\n                <span class="icon-wb_closepopup"></span>\n            </a>\n        </div>\n    </div>\n</div>\n<div class="',r={hash:{},inverse:v.noop,fn:v.program(12,m,e),data:e},(q=c.isPrivateChat)?p=q.call(b,r):(q=b&&b.isPrivateChat,p=typeof q===t?q.call(b,r):q),c.isPrivateChat||(p=x.call(b,p,{hash:{},inverse:v.noop,fn:v.program(12,m,e),data:e})),(p||0===p)&&(s+=p),r={hash:{},inverse:v.noop,fn:v.program(14,n,e),data:e},(q=c.isMultiUserChat)?p=q.call(b,r):(q=b&&b.isMultiUserChat,p=typeof q===t?q.call(b,r):q),c.isMultiUserChat||(p=x.call(b,p,{hash:{},inverse:v.noop,fn:v.program(14,n,e),data:e})),(p||0===p)&&(s+=p),s+=' no-padding row no-margin mig-window-content mig-window-chat-content">\n    <div class="pin-container col-xs-12 no-padding"></div>\n    <div class="chat-window-messages">\n        <ul class="list list-unstyled"></ul>\n    </div>\n    <div class="row no-margin mig-window-footer">\n	    <div>\n	        <div class="toybox-container">\n	            <div class="chat-window-adduser">\n	                <a href="#" data-toggle="dropdown" class="gray-anchor dropdown-toggle insert-chat-adduser">\n	                    <span class="icon-wb_plus icon-padding font-size-24"></span>\n	                </a>\n	                <div class="toybox-menu dropdown-menu">\n	                </div>\n	            </div>\n	        </div>\n        <div class="chat-window-messagebox-container">\n            <div class="chat-window-messagebox">\n                <textarea class="messagebox" rows="1" type="text" placeholder="'+u((q=c.translate||b&&b.translate,r={hash:{},data:e},q?q.call(b,"chat|send_message",r):w.call(b,"translate","chat|send_message",r)))+'"></textarea>\n            </div>\n        </div>\n        <div class="chat-window-emoticon-container">\n            <div class="chat-window-emoticon">\n                <a href="#" class="gray-anchor insert-chat-emoticon"><span class="icon-wb_emoticon icon-padding font-size-24"></span></a>\n            </div>\n        </div>\n    </div>\n    </div>\n</div>\n<div class="col-xs-3 parent-chat-window-participants no-padding ',r={hash:{},inverse:v.noop,fn:v.program(16,o,e),data:e},(q=c.isPrivateChat)?p=q.call(b,r):(q=b&&b.isPrivateChat,p=typeof q===t?q.call(b,r):q),c.isPrivateChat||(p=x.call(b,p,{hash:{},inverse:v.noop,fn:v.program(16,o,e),data:e})),(p||0===p)&&(s+=p),s+='">\n    <div class="chat-window-participants no-padding">\n        <div><a href="#"><span class="icon-wb_refresh"></span></a></div>\n        <ul class="list list-unstyled"></ul>\n    </div>\n</div>\n'})}),define("hbs!modules/template/chat/window/user-subtitle",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<span class="user-miglevel">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"user|miglevel_with_level",b&&b.mig_level,g):i.call(b,"translate","user|miglevel_with_level",b&&b.mig_level,g)))+'</span><span class="user-label">'+j((f=c.userGetLabels||b&&b.userGetLabels,g={hash:{},data:e},f?f.call(b,b,g):i.call(b,"userGetLabels",b,g)))+"</span>"})});var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};define("modules/chat/views/chatwindow",["require","exports","../../view/common/mig33_views","./chat_sidebar/add_participant_window","./chat_window/chat_pinned_view","../views/chat_message_panel","../data/offline","modules/export_marionette","backbone.marionette","underscore","jquery","backbone","modules/chat/views/chat_input_panel","modules/chat/views/chat_message_panel","modules/chat/views/chat_participant_list","modules/chat/views/chat_window/chat_pinned_view","modules/chat/views/more_options_menu","modules/common/utility","hbs!modules/template/chat/window/window","hbs!modules/template/chat/window/user-subtitle","modules/globals/url","modules/model/user/user_model"],function(a,b,c,d,e,f,g){function h(){return++r}var i=a("modules/chat/views/chat_input_panel"),j=a("modules/chat/views/chat_participant_list"),k=a("modules/chat/views/more_options_menu"),l=a("modules/common/utility"),m=a("hbs!modules/template/chat/window/window"),n=a("hbs!modules/template/chat/window/user-subtitle"),o=a("modules/globals/url"),p=(a("modules/model/user/user_model"),a("underscore")),q=f.MessagePanel,r=2e3,s=function(a){function b(b){a.call(this,b)}return __extends(b,a),Object.defineProperty(b.prototype,"chat_id",{get:function(){return this.get("chat_id")},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"chat_title",{get:function(){return this.get("chat_title")},set:function(a){this.set("chat_title",a)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"full_title",{get:function(){return this.get("full_title")},set:function(a){this.set("full_title",a)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"isMultiUserChat",{get:function(){return this.get("isMultiUserChat")},set:function(a){this.set("isMultiUserChat",a)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"isGroupChat",{get:function(){return this.get("isGroupChat")},set:function(a){this.set("isGroupChat",a)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"isPrivateChat",{get:function(){return this.get("isPrivateChat")},set:function(a){this.set("isPrivateChat",a)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"isFusionChat",{get:function(){return this.get("isPrivateChat")},set:function(a){this.set("isPrivateChat",a)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"displayPicture",{get:function(){return this.get("displayPicture")},set:function(a){this.set("displayPicture",a)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"participantCount",{get:function(){return this.get("participantCount")},set:function(a){this.set("participantCount",a)},enumerable:!0,configurable:!0}),b.createChatViewModel=function(a){var c=!(a.is_chat_room()||a.is_group_chat()),d=c?'style="background-image: url('+o.image+"/dp/"+a.getTitle()+'?w=36&h=36&a=1&c=1);"':a.is_group_chat()?"ico-groupchat-default":"ico-chatroom-default";return new b({chat_id:a.chatHandle,chat_title:a.getTitle(),full_title:a.getTitle(),participantCount:a.getParticipantCount(),isMultiUserChat:!c,isPrivateChat:c,isGroupChat:a.is_group_chat(),displayPicture:d,isFusionChat:a.is_fusion_chat()})},b}(Backbone.Model);b.ChatViewModel=s,s.prototype.idAttribute="chat_id";var t='<div class="input-container"><input type="text" style="" autocomplete="off" /></div>',u=function(b){function c(a){if(!a.model||!a.chat_model)throw"Missing expected options";this.regions={pin_container:".pin-container"},this._isWindowRendered=!1,this._isWindowClosed=!1,this._isWindowActive=!1,this._isWindowShown=!1,this._isWindowResizable=!1,this._isWindowDraggable=!1,this._isWindowMinimized=!1,this._isWindowPositioned=!1,this._isWindowFloating=!1,this.chat_model=a.chat_model,this.template={type:"handlebars",template:m},this.className="mig-window",b.call(this,a),p.bindAll(this),this.isWindowMinimized?this._chatWindowWidth=c.MINIMIZED_WIDTH:this.model.isMultiUserChat?this._chatWindowWidth=c.CHAT_GROUP_WINDOW_WIDTH_PERCENT:this._chatWindowWidth=c.CHAT_WINDOW_WIDTH_PERCENT,this.model.on("change",this.model_listener),this.listen_to_app_events()}return __extends(c,b),Object.defineProperty(c.prototype,"isWindowShown",{get:function(){return this._isWindowShown},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"isWindowActive",{get:function(){return this._isWindowActive},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"isWindowRendered",{get:function(){return this._isWindowRendered},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"isWindowClosed",{get:function(){return this._isWindowClosed},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"isWindowMinimized",{get:function(){return this._isWindowMinimized},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"isWindowPositioned",{get:function(){return this._isWindowPositioned},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"getChatWindowWidth",{get:function(){return this._chatWindowWidth},enumerable:!0,configurable:!0}),c.prototype.getChatModel=function(){return this.chat_model},c.prototype.model_listener=function(){console.log(arguments)},c.prototype.onRender=function(){var b=this;this._isWindowRendered=!0,this.$el.attr("id",this.model.chat_id),this.initTitleBar(),this.initTitleMenu(),this.initTitleButtons(),this.initParticipantList(),this.initMessagePanel(),this.initInputPanel(),this.setupModelEvents(),this.addParticipantView=new d.AddParticipantView,this.addParticipantView.on("ContactSelected",function(a){var c=a.contacts;b.chat_model.addParticipants(c)}),this.$el.find(".mig-window-chat-content").append(this.addParticipantView.render().$el),this.chat_model.getParticipants(!0),p.delay(function(){b.resetSize(),b.trigger("chat_window_rendered",b)},0),p.defer(function(){}),this.$el.on("click",function(){b._isWindowMinimized&&b.maximize(),b._isWindowActive||b.trigger("chat_window_accessed",b)}),this.$el.find(".title-avatar-pic").on("click",function(){if(b.chat_model.is_private_chat()){var c=b.chat_model.get("destination"),d=l.get_profile_url(c),e=a("modules/mig33_app");e.navigate_to(d)}}),this.$el.find(".mig-window-title a.profile-hovercard").on("click",function(){l.hide_mobile_chat(),b.close()}),this.chat_model.is_fusion_chat()||this.$el.find(".title-btn.dropdown-toggle").hide(),this.attachOfflineNotification()},c.prototype.listen_to_app_events=function(){var b=this,c=a("modules/mig33_app");c.vent.on(c.ApplicationEvents.CHAT_SESSION_CONNECTED,function(){b.chat_model.getParticipants(!0),b.chat_model.getUserDetails()})},c.prototype.attachOfflineNotification=function(){var a=new g.OfflineView;this.$el.append(a.getElement())},c.prototype.maximize=function(){this.toggleDraggable(this._isWindowFloating),this.toggleResizeable(this._isWindowFloating),this.setPosition(this.lastKnownX,this.lastKnownY,!1),this.resizeWindow(this.lastKnownHeight,this.lastKnownWidth)},c.prototype.minimize=function(){if(!this._isWindowMinimized){this.lastKnownHeight=this.$el.height(),this.lastKnownWidth=this.$el.width();var a=this.getPosition();this.lastKnownX=a.x,this.lastKnownY=a.y,this.$el.height(c.MINIMIZED_HEIGHT),this.$el.width(c.MINIMIZED_WIDTH),this.$el.addClass("minimized"),this._isWindowMinimized=!0,this.toggleDraggable(!1),this.toggleResizeable(!1),this.trigger("chat_window_minimized",this)}},c.prototype.resetSize=function(){var a=$(window).width()*this._chatWindowWidth;a=a>c.CHAT_WINDOW_MINIMUM_WIDTH?a:c.CHAT_WINDOW_MINIMUM_WIDTH,this.resizeWindow($(window).height()*c.CHAT_WINDOW_HEIGHT_PERCENT,a)},c.prototype.resizeAddParticipant=function(a,b){var c="98%",d="98%",e=$(".chat-item-add-participant",this.$el);e.css({width:c,height:d,top:"1%",left:"1%"})},c.prototype.resizeWindow=function(a,b){var d=b>c.CHAT_WINDOW_MINIMUM_WIDTH?b:c.CHAT_WINDOW_MINIMUM_WIDTH;d>$(window).width()&&(d=$(window).width()),this.$el.height(a),this.$el.width(d),this.resizeContent(a,d),this.resizeAddParticipant(a,d),this.lastKnownHeight=a,this.lastKnownWidth=d,this._isWindowMinimized=!1,this.$el.removeClass("minimized")},c.prototype.resizeTitleBarContent=function(a,b){var c=32,d=48,e=70;$(".mig-window-title",this.$el).parent().width(b-(d+c)),$(".title-text",this.$el).css({"max-width":b-(d+c+e)})},c.prototype.resizeContent=function(a,b){var d=this;this.resizeTitleBarContent(a,b),a-=$(".mig-window-header",this.$el).height()+c.DECORATION_HEIGHT;var e=this.$el.find(".mig-window-content"),f=this.$el.find(".chat-window-participants");e.height(a),f.height(a),this.$el.find(".mig-window-content .chat-window-messages").height(a-$(".mig-window-footer",this.$el).height()),this.$el.find(".input-container").width(b-c.TITLE_DECORATION_WIDTH),p.defer(function(){d.resizeFooter(a,b)})},c.prototype.resizeFooter=function(a,b){if(!this.chat_model.is_private_chat()){var c=$(".chat-window-participants",this.$el).width();b-=c}var d=72,e=15;$(".chat-window-messagebox-container",this.$el).width(b-(d+e))},c.prototype.initTitleMenu=function(){var a=new k;a.build_html(this,this.chat_model,this.$el)},c.prototype.show_add_people=function(){this.addParticipantView.showPanel("INVITE",this.chat_model.getParticipants())},c.prototype.initTitleButtons=function(){var a=this,b=$(".close-mig-window",this.$el),c=$(".toggle-min-max-mig-window",this.$el);b.on("click",function(b){b.stopPropagation(),b.preventDefault(),a.close()}),c.on("click",function(b){b.preventDefault(),
a._isWindowMinimized||(b.stopPropagation(),a.minimize())})},c.prototype.initTitleBar=function(){var a=this;if(this.model.isGroupChat){var b=$(".mig-window-title",this.$el);$(t).appendTo(b).hide();var c=$("input",b);c.on("keyup",function(b){var d=!1,e=!1,f=c.val();27==b.keyCode&&(d=!0,e=!1),13==b.keyCode&&(d=!0,e=!0),d&&($(b.currentTarget).val(""),a.hide_rename_chat(),e&&a.update_chat_name(f))}),c.on("blur",function(){var b=c.val();c.val(""),a.hide_rename_chat(),a.update_chat_name(b)}),c.on("click",function(a){a.stopPropagation(),a.preventDefault()})}},c.prototype.initPinnedArea=function(){var a=this;this.pinned_area=new e.ChatItemView({model:new Backbone.Model}),this.pinned_area.on("display_pinitem",function(){a.chat_model.display_pinitem(a.chat_model.get("destination"),a.chat_model.get("destinationType"))}),this.pin_container.show(this.pinned_area),$(".pulltag",this.$el).on("click",function(b){b.preventDefault(),a.pinned_area.activate()})},c.prototype.initParticipantList=function(){if(!this.model.isPrivateChat){var a=this.$el.find(".chat-window-participants");new j(a,this.chat_model);l.isolate_scroll($(a))}},c.prototype.initMessagePanel=function(){var a=this.$el.find(".chat-window-messages");this.messages_pane_instance=new q(a,this.chat_model),l.isolate_scroll($(a))},c.prototype.initInputPanel=function(){var a=this,b=this.$el.find(".mig-window-footer"),c=new i(b,this.chat_model,$(".chat-window-toybox",this.$el),this);c.on("inputResize",function(){a.resizeContent(a.lastKnownHeight,a.lastKnownWidth)})},c.prototype.leave_chat=function(){var a=!(this.chat_model.is_chat_room()||this.chat_model.is_group_chat());a||(a=window.confirm(l.translate("chat|confirm_group_chat_close"))),a&&this.chat_model.leave_chatroom()},c.prototype.show_rename_chat=function(){var a=$(".mig-window-title",this.$el);$(".participant-count, .title-text",a).hide(),$(".input-container",a).show(),$("input",a).val(this.chat_model.getTitle()),$("input",a).select().focus()},c.prototype.hide_rename_chat=function(){var a=$(".mig-window-title",this.$el);$("a, .title-text",a).show(),$(".input-container",a).hide()},c.prototype.update_chat_name=function(a){this.chat_model.rename_chat(a)},c.prototype.setupModelEvents=function(){var a,b=this,c=$(".mig-window-title",this.$el),d=$(".mig-window-header>.unread-chats-badge",this.$el);this.chat_model.is_private_chat()||(a=function(){var a=b.chat_model.getTitle(),d=b.chat_model.getParticipantCount();c.find(".title-text>.main").text(a),c.find(".title-text>.subtitle").text(l.translate("chat|participant-count",d))},this.chat_model.on("participant_added",a),this.chat_model.on("change:destinationName",a)),this.chat_model.on("display_invite_friends",function(){b.show_add_people()}),this.chat_model.on("user_details",function(a){c.find(".title-text>.subtitle").html(n(a.attributes))}),this.chat_model.getUserDetails(),this.chat_model.on("unread_message_count_changed",function(){var a=b.chat_model.get_unread_message_count();d.text(a),a?d.removeClass("hidden"):d.addClass("hidden")},this)},c.prototype.deactivate=function(){this.$el.removeClass("active"),this.messages_pane_instance.set_infocus(!1),this._isWindowActive=!1},c.prototype.activate=function(){this.bringToTop(),this.$el.addClass("active").find("input.messagebox").focus(),"undefined"!=typeof this.messages_pane_instance&&this.messages_pane_instance.set_infocus(!0),this._isWindowActive=!0},c.prototype.setPosition=function(a,b,c){a&&this.$el.css({left:a+"px"}),(b||c)&&(c?this.$el.css({bottom:b+"px",top:"auto"}):this.$el.css({top:b+"px",bottom:"auto"})),this._isWindowPositioned=!0},c.prototype.getPosition=function(){var a=this.$el.position();return{x:a.left,y:a.top}},c.prototype.getWindowWidth=function(){return this.$el.width()},c.prototype.getWindowHeight=function(){return this.$el.height()},c.prototype.show=function(a){this._isWindowRendered||$("body").append(this.render().$el),this.$el.show(),this.toggleFloat(a),this._isWindowShown=!0},c.prototype.hide=function(){this.$el.hide(),this._isWindowShown=!1,this._isWindowActive=!1},c.prototype.close=function(){this._isWindowClosed=!0,this._isWindowRendered=!1,this.trigger("chat_window_closed",this),this.remove(),this.unbind(),this.model.off("change",this.model_listener)},c.prototype.setZIndex=function(a){this.$el.css({zIndex:a})},c.prototype.toggleFloat=function(a){a!==this._isWindowFloating&&(this.toggleResizeable(a),this.toggleDraggable(a),this.resetSize(),a?this.$el.addClass("floating-mode"):this.$el.removeClass("floating-mode"),this._isWindowFloating=a)},c.prototype.toggleResizeable=function(a){var b=this;"undefined"==typeof a&&(a=!this._isWindowResizable),this._isWindowResizable!==a&&(a?this.$el.resizable({minWidth:390*$(window).width()/1e3,minHeight:410*$(window).height()/1e3,handles:"n, e, s, w, se, ne, nw, sw",resize:function(a,c){b.resizeContent(c.size.height-2,c.size.width)},start:function(){b.bringToTop()}}):this.$el.resizable("destroy"),this._isWindowResizable=!1)},c.prototype.bringToTop=function(){this.setZIndex(h())},c.prototype.toggleDraggable=function(a){var b=this;"undefined"==typeof a&&(a=!this._isWindowDraggable),a!==this._isWindowDraggable&&(a?this.$el.draggable({containment:"parent",cancel:"a",handle:".mig-window-header",start:function(){b.bringToTop()}}):this.$el.draggable("destroy"),this._isWindowDraggable=a)},c.CHAT_WINDOW_MINIMUM_WIDTH=400,c.CHAT_GROUP_WINDOW_WIDTH_PERCENT=.4,c.CHAT_WINDOW_WIDTH_PERCENT=.3,c.CHAT_WINDOW_HEIGHT_PERCENT=.75,c.DECORATION_CHAT_WINDOW_PADDING=8,c.TITLE_DECORATION_WIDTH=124,c.DECORATION_HEIGHT=0,c.MINIMIZED_HEIGHT=43,c.MINIMIZED_WIDTH=250,c.DECORATION_INPUT_WIDTH=28,c}(c.Layout);b.ChatWindow=u}),define("hbs!modules/template/chat/expanded/user-profile",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="row">\n    <div class="col-xs-1">\n        <div class="toggle-chat-sidebar">\n            <a href="#" class="collapse-mode-toggle-btn">\n                <span class="icon-wb_arrowRight"></span>\n            </a>\n        </div>\n    </div>\n    <div class="col-xs-3">\n        <div class="chat-user-avatar">\n	        <a href="'+j((f=c.getSessionUser||b&&b.getSessionUser,g={hash:{},data:e},f?f.call(b,"personalized_url",g):i.call(b,"getSessionUser","personalized_url",g)))+'"><img src="'+j((f=c.getSessionUserDisplayPictureUrl||b&&b.getSessionUserDisplayPictureUrl,g={hash:{},data:e},f?f.call(b,48,48,g):i.call(b,"getSessionUserDisplayPictureUrl",48,48,g)))+'" width="48" height="48" class="img-circle" /></a>\n        </div>\n    </div>\n    <div class="col-xs-7 no-padding">\n        <div class="chat-user-username">\n            <a href="'+j((f=c.getSessionUser||b&&b.getSessionUser,g={hash:{},data:e},f?f.call(b,"personalized_url",g):i.call(b,"getSessionUser","personalized_url",g)))+'" data-username="'+j((f=c.getSessionUser||b&&b.getSessionUser,g={hash:{},data:e},f?f.call(b,"username",g):i.call(b,"getSessionUser","username",g)))+'">'+j((f=c.getSessionUser||b&&b.getSessionUser,g={hash:{},data:e},f?f.call(b,"username",g):i.call(b,"getSessionUser","username",g)))+'</a>\n        </div>\n	    <div class="chat-user-miglevel font-size-12">\n		    '+j((f=c.userGetLabels||b&&b.userGetLabels,g={hash:{},data:e},f?f.call(b,"session_user",g):i.call(b,"userGetLabels","session_user",g)))+'\n		    <span class="chat-user-miglevel">\n             '+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"user|miglevel",g):i.call(b,"translate","user|miglevel",g)))+' <span class="level font-size-12">'+j((f=c.getSessionUser||b&&b.getSessionUser,g={hash:{},data:e},f?f.call(b,"mig_level",g):i.call(b,"getSessionUser","mig_level",g)))+"</span>\n         </span>\n		</div>\n    </div>\n</div>"})}),define("modules/chat/views/chat_sidebar/profile_header",["modules/chat/models/user_session","modules/globals/session_user","modules/chat/config/config_ts","underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/chat/expanded/user-profile","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=c.config,n=a.Session.getInstance(),o={};for(var p in m.Presence)Object.prototype.hasOwnProperty.call(m.Presence,p)&&(o[m.Presence[p]]=p);var q=h.ItemView.extend({template:{type:"handlebars",template:j},className:"chat-profile-area-inner",initialize:function(){d.bindAll(this),n.on("change:presence",this.set_presence,this)},onRender:function(){this.$status_input=this.$el.find(".chat-user-status>.input-group input"),this.$status_input.val(b.status_message);var a=this;this.$status_input.keyup(function(c){13==c.keyCode&&(a.set_status_message(),a.$status_input.blur()),27==c.keyCode&&(a.$status_input.val(b.status_message),a.$status_input.blur())}),this.$status_input.on("focus",function(b){d.delay(function(){a.$status_input.select()},0),b.preventDefault(),b.stopPropagation()}),this.$status_input.on("blur",function(){a.set_status_message()})},events:{"click .collapse-mode-toggle-btn":"_doToggleExpand","click a.presence-btn":"_presenceClick","keyup .chat-user-status>.input-group input":"_keyupInput","blur .chat-user-status>.input-group input":"_blurInput","focus .chat-user-status>.input-group input":"_focusInput","click .chat-user-avatar a":"hideMobileChat"},_keyupInput:function(a){13==a.keyCode&&(this.set_status_message(),this.$status_input.blur()),27==a.keyCode&&(this.$status_input.val(b.status_message),this.$status_input.blur())},_blurInput:function(a){this.set_status_message()},_focusInput:function(a){var b=this;d.delay(function(){b.$status_input.select()},0),a.preventDefault(),a.stopPropagation()},_presenceClick:function(a){a.preventDefault();var b=a.currentTarget;n.setPresence(m.Presence[e(b).data("presence")])},_doToggleExpand:function(a){a.preventDefault(),this.trigger("toggleCollapse")},set_presence:function(a,b){e(".chat-user-status button>span.status",this.$el).removeAttr("class").addClass("status fusion-"+o[b])},set_status_message:function(){var a=this.$status_input.val();a=e.trim(a),""!==a&&a!==n.get("status_message")&&(l.send_event_to_ga("Chat","Sidebar","Set Status Message"),n.set_status_message(a))},hideMobileChat:function(){l.hide_mobile_chat()}});return q}),define("hbs!modules/template/chat/collapsed/user-profile",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="row">\n    <div class="col-md-3 no-padding-right">\n        <div class="toggle-chat-sidebar">\n            <a href="#" class="collapse-mode-toggle-btn">\n                <span class="icon-wb_arrowLeft"></span>\n            </a>\n        </div>\n    </div>\n    <div class="col-md-8 no-padding-left">\n        <div class="chat-user-avatar text-center">\n            <a href="'+j((f=c.getSessionUser||b&&b.getSessionUser,g={hash:{},data:e},f?f.call(b,"personalized_url",g):i.call(b,"getSessionUser","personalized_url",g)))+'"><img src="'+j((f=c.getSessionUserDisplayPictureUrl||b&&b.getSessionUserDisplayPictureUrl,g={hash:{},data:e},f?f.call(b,64,64,g):i.call(b,"getSessionUserDisplayPictureUrl",64,64,g)))+'" width="64" height="64" class="img-circle" /></a>\n        </div>\n    </div>\n</div>'})}),define("modules/chat/views/chat_sidebar/collapsed_profile_header",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/chat/collapsed/user-profile","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i){var j=e.ItemView.extend({template:{type:"handlebars",template:g},initialize:function(){a.bindAll(this)},events:{"click .collapse-mode-toggle-btn":"_doToggleExpand"},_doToggleExpand:function(a){a.preventDefault(),this.trigger("toggleCollapse")}});return j}),define("hbs!modules/template/chat/expanded/chat-list",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="chat-participant-container">\n\n</div>\n<div class="chat-item-list chat-recent-list list-container">\n  \n</div>\n<div class="chat-footer chat-panel-footer font-size-14 padding-8px">\n    <div class="row">\n        <span>\n            <a href="#"><span class="icon-wb_plus"></span>&nbsp;'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"chat|start_a_new_chat",g):i.call(b,"translate","chat|start_a_new_chat",g)))+"</a>\n        </span>\n    </div>\n</div>"})}),define("hbs!modules/template/chat/expanded/chatlist-item",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+='\n                <img src="',(e=c.display_pic)?d=e.call(a,{hash:{},data:b}):(e=a&&a.display_pic,d=typeof e===n?e.call(a,{hash:{},data:b}):e),f+=o(d)+'" width="36" height="36"\n                     class="img-circle"/>\n                <span class="status ',(e=c.status)?d=e.call(a,{hash:{},data:b}):(e=a&&a.status,d=typeof e===n?e.call(a,{hash:{},data:b}):e),f+=o(d)+'"></span>\n            '}function g(a,b){var d,e="";return e+="\n	            ",d=c["if"].call(a,a&&a.is_chatroom,{hash:{},inverse:p.program(6,i,b),fn:p.program(4,h,b),data:b}),(d||0===d)&&(e+=d),e+="\n            "}function h(a,b){return'\n                    <span class="wb wb-36 wb-chatp-chatrm"></span>\n	            '}function i(a,b){var d,e="";return e+="\n		            ",d=c["if"].call(a,a&&a.is_group_chat,{hash:{},inverse:p.noop,fn:p.program(7,j,b),data:b}),(d||0===d)&&(e+=d),e+="\n	            "}function j(a,b){return'\n                        <span class="wb wb-36 wb-chatp-groupchat"></span>\n		            '}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var k,l,m="",n="function",o=this.escapeExpression,p=this;return m+='<div class="padding-4px chat-item-row row">\n    <div class="first-col col-xs-3 no-padding-right">\n        <div class="chat-list-avatar">\n            ',k=c["if"].call(b,b&&b.is_private_chat,{hash:{},inverse:p.program(3,g,e),fn:p.program(1,f,e),data:e}),(k||0===k)&&(m+=k),m+='\n        </div>\n    </div>\n    <div class="middle-col col-xs-7 text-truncate no-padding-right">\n        <div class="text-truncate chat-list-title">\n            <a href="#">',(l=c.chatname)?k=l.call(b,{hash:{},data:e}):(l=b&&b.chatname,k=typeof l===n?l.call(b,{hash:{},data:e}):l),m+=o(k)+'</a>\n        </div>\n        <div class="text-truncate chat-list-subtitle font-size-12">',(l=c.lastMessage)?k=l.call(b,{hash:{},data:e}):(l=b&&b.lastMessage,k=typeof l===n?l.call(b,{hash:{},data:e}):l),m+=o(k)+'</div>\n    </div>\n    <div class="last-col col-xs-2 no-padding-left chatlist-lastcol">\n		<div class="hover-hide">\n            <div class="badge font-size-12">',(l=c.unreadCount)?k=l.call(b,{hash:{},data:e}):(l=b&&b.unreadCount,k=typeof l===n?l.call(b,{hash:{},data:e}):l),m+=o(k)+'</div>\n            <div title="',(l=c.fullTime)?k=l.call(b,{hash:{},data:e}):(l=b&&b.fullTime,k=typeof l===n?l.call(b,{hash:{},data:e}):l),m+=o(k)+'" class="chat-list-time font-color-grey font-size-10">',(l=c.displayTime)?k=l.call(b,{hash:{},data:e}):(l=b&&b.displayTime,k=typeof l===n?l.call(b,{hash:{},data:e}):l),m+=o(k)+'</div>\n		</div>\n        <span class="hover-show close-chat-btn icon-wb_close padding-4px"></span>\n    </div>\n</div>'})}),define("hbs!modules/template/chat/collapsed/chatlist-item",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+='\n        <img src="',(e=c.display_pic)?d=e.call(a,{hash:{},data:b}):(e=a&&a.display_pic,d=typeof e===n?e.call(a,{hash:{},data:b}):e),f+=o(d)+'" width="42" height="42"\n             class="img-circle"/>\n    '}function g(a,b){var d,e="";return e+="\n    ",d=c["if"].call(a,a&&a.is_chatroom,{hash:{},inverse:p.program(6,i,b),fn:p.program(4,h,b),data:b}),(d||0===d)&&(e+=d),e+="\n    "}function h(a,b){return'\n        <span class="wb wb-36 wb-chatp-chatrm"></span>\n        '}function i(a,b){var d,e="";return e+="\n            ",d=c["if"].call(a,a&&a.is_group_chat,{hash:{},inverse:p.noop,fn:p.program(7,j,b),data:b}),(d||0===d)&&(e+=d),e+="\n        "}function j(a,b){return'\n                <span class="wb wb-36 wb-chatp-groupchat"></span>\n            '}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var k,l,m="",n="function",o=this.escapeExpression,p=this;return m+='<div class="chat-recent-list-item padding-4px text-center">\n    ',k=c["if"].call(b,b&&b.is_private_chat,{hash:{},inverse:p.program(3,g,e),fn:p.program(1,f,e),data:e}),(k||0===k)&&(m+=k),m+='\n    <span class="status"></span>\n    <span class="badge">',(l=c.unreadCount)?k=l.call(b,{hash:{},data:e}):(l=b&&b.unreadCount,k=typeof l===n?l.call(b,{hash:{},data:e}):l),m+=o(k)+"</span>\n</div>"})}),define("modules/template/helpers/chat_helpers",["underscore","handlebars","modules/common/utility","jquery.timeago"],function(a,b,c){var d=function(a){var b=new Date;if(b.setHours(0,0,0,0),a>b)return"Today";if(b.setDate(b.getDate()-1),a>b)return"Yesterday";var d=c.translate("time|now"),e=Math.round((new Date).getTime()/1e3),f=e-a/1e3,g={s_60:["time|moments_ago",0],s_120:["time|1_minute_ago",0],s_3600:["time|x_minutes_ago",60],s_7200:["time|1_hour_ago",0],s_86400:["time|x_hours_ago",3600],s_172800:["time|1_day_ago",0],s_604800:["time|x_days_ago",86400],s_1209600:["time|1_week_ago",0],s_2419200:["time|x_weeks_ago",604800],s_4838400:["time|1_month_ago",0],s_29030400:["time|x_months_ago",2592e3],s_58060800:["time|1_year_ago",0]};g["s_"+String(e)]=["time|x_years_ago",31536e3];for(var h in g)if(Object.prototype.hasOwnProperty.call(g,h)){var i=parseInt(h.slice(2),10),j=g[h];if(i>f){d=j[1]>0?c.translate(j[0],Math.floor(f/j[1])):c.translate(j[0]);break}}return d};b.registerHelper("getTimeAgo",function(){var a=this.timeInt;return d(a)}),b.registerHelper("timeAgoFormat",function(a){return d(a)}),b.registerHelper("getTimeAgoClass",function(){var a=this.timeInt,b=d(a);return b.split(" ").join("_")})}),define("modules/chat/views/chat_sidebar/chat_list_collapsed_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/chat/collapsed/chatlist-item","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers","modules/template/helpers/chat_helpers"],function(a,b,c,d,e,f,g,h,i){var j=e.ItemView.extend({template:{type:"handlebars",template:g},initialize:function(){a.bindAll(this)},modelEvents:{change:"fieldsChanged"},fieldsChanged:function(){this.render()},getModel:function(){return this.model},events:{"click .close-chat-btn":"onCloseClick"},onCloseClick:function(a){a.preventDefault(),a.stopPropagation();var b=this.model.get("is_chatroom")?i.translate("chat|confirm_group_chat_close"):i.translate("chat|clear-chat"),c=window.confirm(b);c&&this.model.trigger("chat_list_close_click")}});return j}),define("modules/chat/views/chat_sidebar/chat_list_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/chat/expanded/chatlist-item","modules/chat/views/chat_sidebar/chat_list_collapsed_item_view","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j){var k=h.extend({template:{type:"handlebars",template:g},getModel:function(){return this.model},initialize:function(){a.bindAll(this)},onRender:function(){this.trigger("item_render")}});return k}),define("hbs!modules/template/chat/collapsed/chat-list",["handlebars"],function(a){return a.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},'<div class="chat-recent-list list-container">\n\n</div>'})}),define("modules/chat/views/chat_sidebar/collapsed_recent_chat_area",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/chat/collapsed/chat-list","modules/chat/views/chat_sidebar/chat_list_collapsed_item_view","modules/chat/views/chat_sidebar/add_participant_window","modules/chat/models/chats","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=i.AddParticipantView,n=j.ChatStoreModel.getInstance(),o=e.CompositeView.extend({itemView:h,itemViewContainer:".list-container",template:{type:"handlebars",template:g},initialize:function(){this.decorator_height=0,this.decorator_width=0,a.bindAll(this),this.collection&&this._listenToCollectionEvents()},_listenToCollectionEvents:function(){this.collection.on("chat_became_latest",function(a){var b=this.children.findByModel(a);b&&this.$el.find(".mCSB_container").prepend(b.$el)},this)},onRender:function(){this.$el.find(".chat-recent-list").mCustomScrollbar({scrollInertia:150,advanced:{updateOnContentResize:!0},autoHideScrollbar:!0}),this.addParticpantWindow=new m;var a=this.addParticpantWindow.render().$el;b(".chat-participant-container",this.$el).html(a),a.on("ContactSelected",function(a){n.startGroupChat(a.contacts)})},appendHtml:function(a,b,c){var d,e=this.$el.find(".mCSB_container");0===c?e.prepend(b.$el):(d=e.children().eq(c),d.length?d.before(b.$el):e.append(b.$el));return b.$el.click(function(a){a.preventDefault(),a.stopPropagation();var c=b.getModel();c.trigger("chat_list_click",c)}),this.$el},events:{"click .chat-footer":"_showAddParticipant"},_showAddParticipant:function(a){a.preventDefault(),l.show_chat_invite_dialog()},resize:function(a,c){this.decorator_height=b(".chat-footer",this.$el).height()+30,(!b(".chat-footer",this.$el)||b(".chat-footer",this.$el).height()<0)&&(this.decorator_height=140),a&&b(".list-container",this.$el).height(a-this.decorator_height),c&&b(".list-container",this.$el).width(c-this.decorator_width)}});return o}),define("modules/chat/views/chat_sidebar/recent_chat_area",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/chat/expanded/chat-list","modules/chat/views/chat_sidebar/chat_list_item_view","modules/chat/views/chat_sidebar/collapsed_recent_chat_area","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j,k){var l=d.compile('<div class="empty-template"><div class="text-center margin-top-half">{{translate "search|add_friends_start_chatting"}}</div><a href="/search/users/" class="find-more-people">+ {{translate "chat|find-more-people"}}</a></div>'),m=i.extend({itemView:h,itemViewContainer:".list-container",template:{type:"handlebars",template:g},initialize:function(){this.listenTo(this.collection,"add",this.checkEmpty),this.listenTo(this.collection,"remove",this.checkEmpty),this.checkEmpty(),m.__super__.initialize.apply(this,arguments)},checkEmpty:function(){this.collection.length<=0?b(".empty-template",this.$el).length<=0&&b(this.itemViewContainer,this.$el).prepend(l()):b(".empty-template",this.$el).remove()}});return m}),define("hbs!modules/template/chat/expanded/chat-contact-area",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h,i="",j=c.helperMissing,k=this.escapeExpression,l="function";return i+='<div class="chat-search">\n    <div class="row">\n        <div class="col-xs-10 no-padding-right">\n            <div class="input-group">\n                <input type="text" class="search-text form-control input-xs" placeholder="Search">\n                <div class="input-group-btn">\n                    <button type="button" class="btn btn-xs btn-default btn-default-white">\n                        <span class="icon-wb_search font-color-grey"></span>\n                    </button>\n                </div>\n            </div>\n        </div>\n        <div class="col-xs-2 no-padding-left">\n            <div class="chat-settings text-center">\n                <a class="dropdown-toggle" data-toggle="dropdown"  href="#">\n	                <span class="icon-wb_setting"></span>\n                </a>\n                <ul class="dropdown-menu" role="menu">\n                    <li>\n                        <a href="#" class="add-contact-group">'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"chat|contact-menu-new-group",h):j.call(b,"translate","chat|contact-menu-new-group",h)))+'</a>\n                    </li>\n                    \n                    <li>\n                        <a href="#" class="show-offline-contacts">'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"chat|contact-show-offline",h):j.call(b,"translate","chat|contact-show-offline",h)))+'</a>\n                    </li>\n                    <!--<li class="dropdown-submenu">\n                        <a href="#">'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"chat|contact-menu-add-im",h):j.call(b,"translate","chat|contact-menu-add-im",h)))+'</a>\n                        <ul class="dropdown-menu">\n                            <li><a tabindex="-1" href="#">'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"chat|contact-menu-fb",h):j.call(b,"translate","chat|contact-menu-fb",h)))+'</a></li>\n                            <li><a href="#">'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"chat|contact-menu-gtalk",h):j.call(b,"translate","chat|contact-menu-gtalk",h)))+'</a></li>\n                            <li><a href="#">'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"chat|contact-menu-yahoo",h):j.call(b,"translate","chat|contact-menu-yahoo",h)))+'</a></li>\n                            <li><a href="#">'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"chat|contact-menu-msn",h):j.call(b,"translate","chat|contact-menu-msn",h)))+'</a></li>\n                        </ul>\n                    </li>-->\n                </ul>\n            </div>\n        </div>\n    </div>\n</div>\n<div class="chat-item contact-list">\n\n</div>\n<div class="chat-footer chat-panel-footer font-size-14 padding-8px">\n    <div class="row hideMobileChat">\n        <span>\n            <a href="',(g=c.recommend_url)?f=g.call(b,{hash:{},data:e}):(g=b&&b.recommend_url,f=typeof g===l?g.call(b,{hash:{},data:e}):g),i+=k(f)+'"><span class="icon-wb_add">&nbsp;'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"chat|find-more-people",h):j.call(b,"translate","chat|find-more-people",h)))+"</a>\n        </span>\n    </div>\n</div>"})}),define("hbs!modules/template/chat/expanded/contact-menu",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+='\n                <li><a tabindex="-1" data-action="move_group" data-param="',(e=c.id)?d=e.call(a,{hash:{},data:b}):(e=a&&a.id,d=typeof e===k?e.call(a,{hash:{},data:b}):e),f+=l(d)+'" href="#">',(e=c.name)?d=e.call(a,{hash:{},data:b}):(e=a&&a.name,d=typeof e===k?e.call(a,{hash:{},data:b}):e),f+=l(d)+"</a></li>\n            "}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var g,h,i,j="",k="function",l=this.escapeExpression,m=this,n=c.helperMissing;return j+='<ul class="dropdown-menu shared-contact-menu">\n    <li>\n        <a href="#" data-action="start_chat" data-param="',(h=c.username)?g=h.call(b,{hash:{},data:e}):(h=b&&b.username,g=typeof h===k?h.call(b,{hash:{},data:e}):h),j+=l(g)+'">Start chat</a>\n    </li>\n    <li>\n        <a href="#" data-action="view_profile" data-param="',(h=c.username)?g=h.call(b,{hash:{},data:e}):(h=b&&b.username,g=typeof h===k?h.call(b,{hash:{},data:e}):h),j+=l(g)+'">View profile</a>\n    </li>\n    <li class="dropdown-submenu">\n        <a href="#">Move to contact group</a>\n        <ul class="dropdown-menu start-right contact-groups">\n            ',g=c.each.call(b,b&&b.groups,{hash:{},inverse:m.noop,fn:m.program(1,f,e),data:e}),(g||0===g)&&(j+=g),j+='\n        </ul>\n    </li>\n    <li>\n        <a href="#" data-action="block" data-param="',(h=c.username)?g=h.call(b,{hash:{},data:e}):(h=b&&b.username,g=typeof h===k?h.call(b,{hash:{},data:e}):h),j+=l(g)+'">Block</a>\n    </li>\n    <li>\n        <a href="#" data-action="transfer_credit" data-param="',(h=c.username)?g=h.call(b,{hash:{},data:e}):(h=b&&b.username,g=typeof h===k?h.call(b,{hash:{},data:e}):h),j+=l(g)+'">'+l((h=c.translate||b&&b.translate,i={hash:{},data:e},h?h.call(b,"user|transfer_credit",i):n.call(b,"translate","user|transfer_credit",i)))+'</a>\n    </li>\n    <li>\n        <a href="#" data-action="remove_friend" data-username="',(h=c.username)?g=h.call(b,{hash:{},data:e}):(h=b&&b.username,g=typeof h===k?h.call(b,{hash:{},data:e}):h),j+=l(g)+'">Remove from friend list</a>\n    </li>\n</ul>'})}),function(a){function b(b){var c=a(this),d=null,e=[],f=null,g=null,h=a.extend({rowSelector:"> li",submenuSelector:"*",submenuDirection:"right",tolerance:75,enter:a.noop,exit:a.noop,activate:a.noop,deactivate:a.noop,exitMenu:a.noop},b),i=3,j=300,k=function(a){e.push({x:a.pageX,y:a.pageY}),e.length>i&&e.shift()},l=function(){g&&clearTimeout(g),h.exitMenu(this)&&(d&&h.deactivate(d),d=null)},m=function(){g&&clearTimeout(g),h.enter(this),q(this)},n=function(){h.exit(this)},o=function(){p(this)},p=function(a){a!=d&&(d&&h.deactivate(d),h.activate(a),d=a)},q=function(a){var b=r();b?g=setTimeout(function(){q(a)},b):p(a)},r=function(){function b(a,b){return(b.y-a.y)/(b.x-a.x)}if(!d||!a(d).is(h.submenuSelector))return 0;var g=c.offset(),i={x:g.left,y:g.top-h.tolerance},k={x:g.left+c.outerWidth(),y:i.y},l={x:g.left,y:g.top+c.outerHeight()+h.tolerance},m={x:g.left+c.outerWidth(),y:l.y},n=e[e.length-1],o=e[0];if(!n)return 0;if(o||(o=n),o.x<g.left||o.x>m.x||o.y<g.top||o.y>m.y)return 0;if(f&&n.x==f.x&&n.y==f.y)return 0;var p=k,q=m;"left"==h.submenuDirection?(p=l,q=i):"below"==h.submenuDirection?(p=m,q=l):"above"==h.submenuDirection&&(p=i,q=k);var r=b(n,p),s=b(n,q),t=b(o,p),u=b(o,q);return t>r&&s>u?(f=n,j):(f=null,0)};c.mouseleave(l).find(h.rowSelector).mouseenter(m).mouseleave(n).click(o),a(document).mousemove(k)}a.fn.menuAim=function(a){return this.each(function(){b.call(this,a)}),this}}(jQuery),define("jquery.menuaim",["jquery"],function(){}),define("modules/chat/views/chat_sidebar/contact_dropdown",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/chat/expanded/contact-menu","jquery.menuaim"],function(a,b,c,d,e,f,g,h){var i=c.View.extend({tagName:"div",className:"contact-menu-dropdown",initialize:function(c){this.scroll_parent=c.scrollParent,this.groups=c.groups,this.$target=c.$target,a.bindAll(this),b(this.scroll_parent).on("scroll",this.remove),b(window).on("resize",this.remove),b(window).on("scroll",this.remove),b(document).on("click",this.remove)},remove:function(a){a&&a.target===this.$target||(this.$target.removeClass("menu-open"),b(this.scroll_parent).off("scroll",this.remove),b(window).off("resize",this.remove),b(window).off("scroll",this.remove),b(document).off("click",this.remove),c.View.prototype.remove.call(this))},position:function(c){var d=this;this.$el.show(),a.delay(function(){var a=b(c).offset().top+b(c).height(),e=b(window).height()+b(window).scrollTop(),f=d.$el.find("ul").height();a+f>e?d._positionAbove(c):d._positionBellow(c)},100)},_positionBellow:function(a){this.$el.css({position:"absolute",top:b(a).offset().top+b(a).height(),visibility:"visible"})},_positionAbove:function(a){b(window).height();this.$el.css({position:"absolute",top:b(a).offset().top-this.$el.find("ul").height(),visibility:"visible"})},events:{},afterRender:function(){var a=this;b(this.$el).click(function(a){a.stopPropagation()}),b("a",this.$el).click(function(c){c.preventDefault(),c.stopPropagation(),a.remove();var d=b(this).data("action"),e=b(this).data("param");return d?(console.log([d,e,a.model]),void a.trigger("menu_click",d,e,a.model)):void console.log("Anchor contains no action");
}),b(".shared-contact-menu",this.$el).menuAim({submenuDirection:"left",activate:function(a){if(b(a).hasClass("dropdown-submenu")){b(".dropdown-menu",b(a)).show();var c=b(".dropdown-menu",b(a)).height();b(".dropdown-menu",b(a)).css("bottom",-1*(c/2))}},deactivate:function(a){b(a).hasClass("dropdown-submenu")&&b(".dropdown-menu",b(a)).hide()}}),this.$target.addClass("menu-open")},render:function(){return this.$el.html(g({username:this.model.get("username"),groups:this.groups})),this.afterRender(),this}});return i}),function(a){"object"==typeof exports?module.exports=a(module.exports,require("underscore"),require("backbone")):"function"==typeof define&&define.amd?define("backgrid",["require","underscore","backbone"],a):a(this,this._,this.Backbone)}(function(a,b,c){function d(a,b,c){var d=b-(a+"").length;d=0>d?0:d;for(var e="",f=0;d>f;f++)e+=c;return e+a}var e="	\n\x0B\f\r   ᠎             　\u2028\u2029\ufeff";if(!String.prototype.trim||e.trim()){e="["+e+"]";var f=new RegExp("^"+e+e+"*"),g=new RegExp(e+e+"*$");String.prototype.trim=function(){if(void 0===this||null===this)throw new TypeError("can't convert "+this+" to object");return String(this).replace(f,"").replace(g,"")}}var h=c.$,i=a.Backgrid={Extension:{},resolveNameToClass:function(a,c){if(b.isString(a)){var d=b.map(a.split("-"),function(a){return a.slice(0,1).toUpperCase()+a.slice(1)}).join("")+c,e=i[d]||i.Extension[d];if(b.isUndefined(e))throw new ReferenceError("Class '"+d+"' not found");return e}return a},callByNeed:function(){var a=arguments[0];if(!b.isFunction(a))return a;var c=arguments[1],d=[].slice.call(arguments,2);return a.apply(c,d+""?d:[])}};b.extend(i,c.Events);var j=i.Command=function(a){b.extend(this,{altKey:!!a.altKey,"char":a["char"],charCode:a.charCode,ctrlKey:!!a.ctrlKey,key:a.key,keyCode:a.keyCode,locale:a.locale,location:a.location,metaKey:!!a.metaKey,repeat:!!a.repeat,shiftKey:!!a.shiftKey,which:a.which})};b.extend(j.prototype,{moveUp:function(){return 38==this.keyCode},moveDown:function(){return 40===this.keyCode},moveLeft:function(){return this.shiftKey&&9===this.keyCode},moveRight:function(){return!this.shiftKey&&9===this.keyCode},save:function(){return 13===this.keyCode},cancel:function(){return 27===this.keyCode},passThru:function(){return!(this.moveUp()||this.moveDown()||this.moveLeft()||this.moveRight()||this.save()||this.cancel())}});var k=i.CellFormatter=function(){};b.extend(k.prototype,{fromRaw:function(a,b){return a},toRaw:function(a,b){return a}});var l=i.NumberFormatter=function(a){if(b.extend(this,this.defaults,a||{}),this.decimals<0||this.decimals>20)throw new RangeError("decimals must be between 0 and 20")};l.prototype=new k,b.extend(l.prototype,{defaults:{decimals:2,decimalSeparator:".",orderSeparator:","},HUMANIZED_NUM_RE:/(\d)(?=(?:\d{3})+$)/g,fromRaw:function(a,c){if(b.isNull(a)||b.isUndefined(a))return"";a=a.toFixed(~~this.decimals);var d=a.split("."),e=d[0],f=d[1]?(this.decimalSeparator||".")+d[1]:"";return e.replace(this.HUMANIZED_NUM_RE,"$1"+this.orderSeparator)+f},toRaw:function(a,c){if(a=a.trim(),""===a)return null;for(var d="",e=a.split(this.orderSeparator),f=0;f<e.length;f++)d+=e[f];var g=d.split(this.decimalSeparator);d="";for(var f=0;f<g.length;f++)d=d+g[f]+".";"."===d[d.length-1]&&(d=d.slice(0,d.length-1));var h=1*(1*d).toFixed(~~this.decimals);return b.isNumber(h)&&!b.isNaN(h)?h:void 0}});var m=i.PercentFormatter=function(){i.NumberFormatter.apply(this,arguments)};m.prototype=new i.NumberFormatter,b.extend(m.prototype,{defaults:b.extend({},l.prototype.defaults,{multiplier:1,symbol:"%"}),fromRaw:function(a,b){var c=[].slice.call(arguments,1);return c.unshift(a*this.multiplier),(l.prototype.fromRaw.apply(this,c)||"0")+this.symbol},toRaw:function(a,c){var d=a.split(this.symbol);if(d&&d[0]&&""===d[1]||null==d[1]){var e=l.prototype.toRaw.call(this,d[0]);return b.isUndefined(e)?e:e/this.multiplier}}});var n=i.DatetimeFormatter=function(a){if(b.extend(this,this.defaults,a||{}),!this.includeDate&&!this.includeTime)throw new Error("Either includeDate or includeTime must be true")};n.prototype=new k,b.extend(n.prototype,{defaults:{includeDate:!0,includeTime:!0,includeMilli:!1},DATE_RE:/^([+\-]?\d{4})-(\d{2})-(\d{2})$/,TIME_RE:/^(\d{2}):(\d{2}):(\d{2})(\.(\d{3}))?$/,ISO_SPLITTER_RE:/T|Z| +/,_convert:function(a,c){if(""===(a+"").trim())return null;var e,f=null;if(b.isNumber(a)){var g=new Date(a);e=d(g.getUTCFullYear(),4,0)+"-"+d(g.getUTCMonth()+1,2,0)+"-"+d(g.getUTCDate(),2,0),f=d(g.getUTCHours(),2,0)+":"+d(g.getUTCMinutes(),2,0)+":"+d(g.getUTCSeconds(),2,0)}else{a=a.trim();var h=a.split(this.ISO_SPLITTER_RE)||[];e=this.DATE_RE.test(h[0])?h[0]:"",f=e&&h[1]?h[1]:this.TIME_RE.test(h[0])?h[0]:""}var i=this.DATE_RE.exec(e)||[],j=this.TIME_RE.exec(f)||[];if(c){if(this.includeDate&&b.isUndefined(i[0]))return;if(this.includeTime&&b.isUndefined(j[0]))return;if(!this.includeDate&&e)return;if(!this.includeTime&&f)return}var g=new Date(Date.UTC(1*i[1]||0,1*i[2]-1||0,1*i[3]||0,1*j[1]||null,1*j[2]||null,1*j[3]||null,1*j[5]||null)),k="";return this.includeDate&&(k=d(g.getUTCFullYear(),4,0)+"-"+d(g.getUTCMonth()+1,2,0)+"-"+d(g.getUTCDate(),2,0)),this.includeTime&&(k=k+(this.includeDate?"T":"")+d(g.getUTCHours(),2,0)+":"+d(g.getUTCMinutes(),2,0)+":"+d(g.getUTCSeconds(),2,0),this.includeMilli&&(k=k+"."+d(g.getUTCMilliseconds(),3,0))),this.includeDate&&this.includeTime&&(k+="Z"),k},fromRaw:function(a,c){return b.isNull(a)||b.isUndefined(a)?"":this._convert(a)},toRaw:function(a,b){return this._convert(a,!0)}});var o=i.StringFormatter=function(){};o.prototype=new k,b.extend(o.prototype,{fromRaw:function(a,c){return b.isUndefined(a)||b.isNull(a)?"":a+""}});var p=i.EmailFormatter=function(){};p.prototype=new k,b.extend(p.prototype,{toRaw:function(a,c){var d=a.trim().split("@");return 2===d.length&&b.all(d)?a:void 0}});var q=i.SelectFormatter=function(){};q.prototype=new k,b.extend(q.prototype,{fromRaw:function(a,c){return b.isArray(a)?a:null!=a?[a]:[]}});var r=i.CellEditor=c.View.extend({initialize:function(a){this.formatter=a.formatter,this.column=a.column,this.column instanceof C||(this.column=new C(this.column)),this.listenTo(this.model,"backgrid:editing",this.postRender)},postRender:function(a,b){return null!=b&&b.get("name")!=this.column.get("name")||this.$el.focus(),this}}),s=i.InputCellEditor=r.extend({tagName:"input",attributes:{type:"text"},events:{blur:"saveOrCancel",keydown:"saveOrCancel"},initialize:function(a){s.__super__.initialize.apply(this,arguments),a.placeholder&&this.$el.attr("placeholder",a.placeholder)},render:function(){var a=this.model;return this.$el.val(this.formatter.fromRaw(a.get(this.column.get("name")),a)),this},saveOrCancel:function(a){var c=this.formatter,d=this.model,e=this.column,f=new j(a),g="blur"===a.type;if(f.moveUp()||f.moveDown()||f.moveLeft()||f.moveRight()||f.save()||g){a.preventDefault(),a.stopPropagation();var h=this.$el.val(),i=c.toRaw(h,d);b.isUndefined(i)?d.trigger("backgrid:error",d,e,h):(d.set(e.get("name"),i),d.trigger("backgrid:edited",d,e,f))}else f.cancel()&&(a.stopPropagation(),d.trigger("backgrid:edited",d,e,f))},postRender:function(a,b){if(null==b||b.get("name")==this.column.get("name"))if("right"===this.$el.css("text-align")){var c=this.$el.val();this.$el.focus().val(null).val(c)}else this.$el.focus();return this}}),t=i.Cell=c.View.extend({tagName:"td",formatter:k,editor:s,events:{click:"enterEditMode"},initialize:function(a){this.column=a.column,this.column instanceof C||(this.column=new C(this.column));var c=this.column,d=this.model,e=this.$el,f=i.resolveNameToClass(c.get("formatter")||this.formatter,"Formatter");b.isFunction(f.fromRaw)||b.isFunction(f.toRaw)||(f=new f),this.formatter=f,this.editor=i.resolveNameToClass(this.editor,"CellEditor"),this.listenTo(d,"change:"+c.get("name"),function(){e.hasClass("editor")||this.render()}),this.listenTo(d,"backgrid:error",this.renderError),this.listenTo(c,"change:editable change:sortable change:renderable",function(a){var b=a.changedAttributes();for(var c in b)b.hasOwnProperty(c)&&e.toggleClass(c,b[c])}),i.callByNeed(c.editable(),c,d)&&e.addClass("editable"),i.callByNeed(c.sortable(),c,d)&&e.addClass("sortable"),i.callByNeed(c.renderable(),c,d)&&e.addClass("renderable")},render:function(){this.$el.empty();var a=this.model;return this.$el.text(this.formatter.fromRaw(a.get(this.column.get("name")),a)),this.delegateEvents(),this},enterEditMode:function(){var a=this.model,b=this.column,c=i.callByNeed(b.editable(),b,a);c&&(this.currentEditor=new this.editor({column:this.column,model:this.model,formatter:this.formatter}),a.trigger("backgrid:edit",a,b,this,this.currentEditor),this.undelegateEvents(),this.$el.empty(),this.$el.append(this.currentEditor.$el),this.currentEditor.render(),this.$el.addClass("editor"),a.trigger("backgrid:editing",a,b,this,this.currentEditor))},renderError:function(a,b){null!=b&&b.get("name")!=this.column.get("name")||this.$el.addClass("error")},exitEditMode:function(){this.$el.removeClass("error"),this.currentEditor.remove(),this.stopListening(this.currentEditor),delete this.currentEditor,this.$el.removeClass("editor"),this.render()},remove:function(){return this.currentEditor&&(this.currentEditor.remove.apply(this.currentEditor,arguments),delete this.currentEditor),t.__super__.remove.apply(this,arguments)}}),u=i.StringCell=t.extend({className:"string-cell",formatter:o}),v=i.UriCell=t.extend({className:"uri-cell",title:null,target:"_blank",initialize:function(a){v.__super__.initialize.apply(this,arguments),this.title=a.title||this.title,this.target=a.target||this.target},render:function(){this.$el.empty();var a=this.model.get(this.column.get("name")),b=this.formatter.fromRaw(a,this.model);return this.$el.append(h("<a>",{tabIndex:-1,href:a,title:this.title||b,target:this.target}).text(b)),this.delegateEvents(),this}}),w=(i.EmailCell=u.extend({className:"email-cell",formatter:p,render:function(){this.$el.empty();var a=this.model,b=this.formatter.fromRaw(a.get(this.column.get("name")),a);return this.$el.append(h("<a>",{tabIndex:-1,href:"mailto:"+b,title:b}).text(b)),this.delegateEvents(),this}}),i.NumberCell=t.extend({className:"number-cell",decimals:l.prototype.defaults.decimals,decimalSeparator:l.prototype.defaults.decimalSeparator,orderSeparator:l.prototype.defaults.orderSeparator,formatter:l,initialize:function(a){w.__super__.initialize.apply(this,arguments);var b=this.formatter;b.decimals=this.decimals,b.decimalSeparator=this.decimalSeparator,b.orderSeparator=this.orderSeparator}})),x=(i.IntegerCell=w.extend({className:"integer-cell",decimals:0}),i.PercentCell=w.extend({className:"percent-cell",multiplier:m.prototype.defaults.multiplier,symbol:m.prototype.defaults.symbol,formatter:m,initialize:function(){x.__super__.initialize.apply(this,arguments);var a=this.formatter;a.multiplier=this.multiplier,a.symbol=this.symbol}})),y=i.DatetimeCell=t.extend({className:"datetime-cell",includeDate:n.prototype.defaults.includeDate,includeTime:n.prototype.defaults.includeTime,includeMilli:n.prototype.defaults.includeMilli,formatter:n,initialize:function(a){y.__super__.initialize.apply(this,arguments);var c=this.formatter;c.includeDate=this.includeDate,c.includeTime=this.includeTime,c.includeMilli=this.includeMilli;var d=this.includeDate?"YYYY-MM-DD":"";d+=this.includeDate&&this.includeTime?"T":"",d+=this.includeTime?"HH:mm:ss":"",d+=this.includeTime&&this.includeMilli?".SSS":"",this.editor=this.editor.extend({attributes:b.extend({},this.editor.prototype.attributes,this.editor.attributes,{placeholder:d})})}}),z=(i.DateCell=y.extend({className:"date-cell",includeTime:!1}),i.TimeCell=y.extend({className:"time-cell",includeDate:!1}),i.BooleanCellEditor=r.extend({tagName:"input",attributes:{tabIndex:-1,type:"checkbox"},events:{mousedown:function(){this.mouseDown=!0},blur:"enterOrExitEditMode",mouseup:function(){this.mouseDown=!1},change:"saveOrCancel",keydown:"saveOrCancel"},render:function(){var a=this.model,b=this.formatter.fromRaw(a.get(this.column.get("name")),a);return this.$el.prop("checked",b),this},enterOrExitEditMode:function(a){if(!this.mouseDown){var b=this.model;b.trigger("backgrid:edited",b,this.column,new j(a))}},saveOrCancel:function(a){var b=this.model,c=this.column,d=this.formatter,e=new j(a);if(e.passThru()&&"change"!=a.type)return!0;e.cancel()&&(a.stopPropagation(),b.trigger("backgrid:edited",b,c,e));var f=this.$el;if(e.save()||e.moveLeft()||e.moveRight()||e.moveUp()||e.moveDown()){a.preventDefault(),a.stopPropagation();var g=d.toRaw(f.prop("checked"),b);b.set(c.get("name"),g),b.trigger("backgrid:edited",b,c,e)}else if("change"==a.type){var g=d.toRaw(f.prop("checked"),b);b.set(c.get("name"),g),f.focus()}}})),A=(i.BooleanCell=t.extend({className:"boolean-cell",editor:z,events:{click:"enterEditMode"},render:function(){this.$el.empty();var a=this.model,b=this.column,c=i.callByNeed(b.editable(),b,a);return this.$el.append(h("<input>",{tabIndex:-1,type:"checkbox",checked:this.formatter.fromRaw(a.get(b.get("name")),a),disabled:!c})),this.delegateEvents(),this}}),i.SelectCellEditor=r.extend({tagName:"select",events:{change:"save",blur:"close",keydown:"close"},template:b.template('<option value="<%- value %>" <%= selected ? \'selected="selected"\' : "" %>><%- text %></option>',null,{variable:null}),setOptionValues:function(a){this.optionValues=a,this.optionValues=b.result(this,"optionValues")},setMultiple:function(a){this.multiple=a,this.$el.prop("multiple",a)},_renderOptions:function(a,c){for(var d="",e=0;e<a.length;e++)d+=this.template({text:a[e][0],value:a[e][1],selected:b.indexOf(c,a[e][1])>-1});return d},render:function(){this.$el.empty();var a=b.result(this,"optionValues"),c=this.model,d=this.formatter.fromRaw(c.get(this.column.get("name")),c);if(!b.isArray(a))throw new TypeError("optionValues must be an array");for(var e=null,f=null,e=null,g=null,i=null,j=0;j<a.length;j++){var e=a[j];if(b.isArray(e))f=e[0],e=e[1],this.$el.append(this.template({text:f,value:e,selected:b.indexOf(d,e)>-1}));else{if(!b.isObject(e))throw new TypeError("optionValues elements must be a name-value pair or an object hash of { name: 'optgroup label', value: [option name-value pairs] }");g=e.name,i=h("<optgroup></optgroup>",{label:g}),i.append(this._renderOptions.call(this,e.values,d)),this.$el.append(i)}}return this.delegateEvents(),this},save:function(a){var b=this.model,c=this.column;b.set(c.get("name"),this.formatter.toRaw(this.$el.val(),b))},close:function(a){var b=this.model,c=this.column,d=new j(a);d.cancel()?(a.stopPropagation(),b.trigger("backgrid:edited",b,c,new j(a))):(d.save()||d.moveLeft()||d.moveRight()||d.moveUp()||d.moveDown()||"blur"==a.type)&&(a.preventDefault(),a.stopPropagation(),this.save(a),b.trigger("backgrid:edited",b,c,new j(a)))}})),B=i.SelectCell=t.extend({className:"select-cell",editor:A,multiple:!1,formatter:q,optionValues:void 0,delimiter:", ",initialize:function(a){B.__super__.initialize.apply(this,arguments),this.listenTo(this.model,"backgrid:edit",function(a,b,c,d){b.get("name")==this.column.get("name")&&(d.setOptionValues(this.optionValues),d.setMultiple(this.multiple))})},render:function(){this.$el.empty();var a=b.result(this,"optionValues"),c=this.model,d=this.formatter.fromRaw(c.get(this.column.get("name")),c),e=[];try{if(!b.isArray(a)||b.isEmpty(a))throw new TypeError;for(var f=0;f<d.length;f++)for(var g=d[f],h=0;h<a.length;h++){var i=a[h];if(b.isArray(i)){var j=i[0],i=i[1];i==g&&e.push(j)}else{if(!b.isObject(i))throw new TypeError;for(var k=i.values,l=0;l<k.length;l++){var m=k[l];m[1]==g&&e.push(m[0])}}}this.$el.append(e.join(this.delimiter))}catch(n){if(n instanceof TypeError)throw new TypeError("'optionValues' must be of type {Array.<Array>|Array.<{name: string, values: Array.<Array>}>}");throw n}return this.delegateEvents(),this}}),C=i.Column=c.Model.extend({defaults:{name:void 0,label:void 0,sortable:!0,editable:!0,renderable:!0,formatter:void 0,sortType:"cycle",sortValue:void 0,direction:null,cell:void 0,headerCell:void 0},initialize:function(){this.has("label")||this.set({label:this.get("name")},{silent:!0});var a=i.resolveNameToClass(this.get("headerCell"),"HeaderCell"),b=i.resolveNameToClass(this.get("cell"),"Cell");this.set({cell:b,headerCell:a},{silent:!0})},sortValue:function(){var a=this.get("sortValue");return b.isString(a)?this[a]:b.isFunction(a)?a:function(a,b){return a.get(b)}}});b.each(["sortable","renderable","editable"],function(a){C.prototype[a]=function(){var c=this.get(a);return b.isString(c)?this[c]:b.isFunction(c)?c:!!c}});var D=i.Columns=c.Collection.extend({model:C}),E=i.Row=c.View.extend({tagName:"tr",initialize:function(a){var b=this.columns=a.columns;b instanceof c.Collection||(b=this.columns=new D(b));for(var d=this.cells=[],e=0;e<b.length;e++)d.push(this.makeCell(b.at(e),a));this.listenTo(b,"add",function(b,c){var e=c.indexOf(b),f=this.makeCell(b,a);d.splice(e,0,f);var g=this.$el;0===e?g.prepend(f.render().$el):e===c.length-1?g.append(f.render().$el):g.children().eq(e).before(f.render().$el)}),this.listenTo(b,"remove",function(a,b,c){d[c.index].remove(),d.splice(c.index,1)})},makeCell:function(a){return new(a.get("cell"))({column:a,model:this.model})},render:function(){this.$el.empty();for(var a=document.createDocumentFragment(),b=0;b<this.cells.length;b++)a.appendChild(this.cells[b].render().el);return this.el.appendChild(a),this.delegateEvents(),this},remove:function(){for(var a=0;a<this.cells.length;a++){var b=this.cells[a];b.remove.apply(b,arguments)}return c.View.prototype.remove.apply(this,arguments)}}),F=i.EmptyRow=c.View.extend({tagName:"tr",emptyText:null,initialize:function(a){this.emptyText=a.emptyText,this.columns=a.columns},render:function(){this.$el.empty();var a=document.createElement("td");return a.setAttribute("colspan",this.columns.length),a.appendChild(document.createTextNode(b.result(this,"emptyText"))),this.el.className="empty",this.el.appendChild(a),this}}),G=i.HeaderCell=c.View.extend({tagName:"th",events:{"click a":"onClick"},initialize:function(a){this.column=a.column,this.column instanceof C||(this.column=new C(this.column));var b=this.column,c=this.collection,d=this.$el;this.listenTo(b,"change:editable change:sortable change:renderable",function(a){var b=a.changedAttributes();for(var c in b)b.hasOwnProperty(c)&&d.toggleClass(c,b[c])}),this.listenTo(b,"change:direction",this.setCellDirection),this.listenTo(b,"change:name change:label",this.render),i.callByNeed(b.editable(),b,c)&&d.addClass("editable"),i.callByNeed(b.sortable(),b,c)&&d.addClass("sortable"),i.callByNeed(b.renderable(),b,c)&&d.addClass("renderable"),this.listenTo(c.fullCollection||c,"sort",this.removeCellDirection)},removeCellDirection:function(){this.$el.removeClass("ascending").removeClass("descending"),this.column.set("direction",null)},setCellDirection:function(a,b){this.$el.removeClass("ascending").removeClass("descending"),a.cid==this.column.cid&&this.$el.addClass(b)},onClick:function(a){function b(a,b){"ascending"===d.get("direction")?e.trigger(f,b,"descending"):"descending"===d.get("direction")?e.trigger(f,b,null):e.trigger(f,b,"ascending")}function c(a,b){"ascending"===d.get("direction")?e.trigger(f,b,"descending"):e.trigger(f,b,"ascending")}a.preventDefault();var d=this.column,e=this.collection,f="backgrid:sort",g=i.callByNeed(d.sortable(),d,this.collection);if(g){var h=d.get("sortType");"toggle"===h?c(this,d):b(this,d)}},render:function(){this.$el.empty();var a,b=this.column,c=i.callByNeed(b.sortable(),b,this.collection);return a=c?h("<a>").text(b.get("label")).append("<b class='sort-caret'></b>"):document.createTextNode(b.get("label")),this.$el.append(a),this.$el.addClass(b.get("name")),this.$el.addClass(b.get("direction")),this.delegateEvents(),this}}),H=(i.HeaderRow=i.Row.extend({requiredOptions:["columns","collection"],initialize:function(){i.Row.prototype.initialize.apply(this,arguments)},makeCell:function(a,b){var c=a.get("headerCell")||b.headerCell||G;return c=new c({column:a,collection:this.collection})}}),i.Header=c.View.extend({tagName:"thead",initialize:function(a){this.columns=a.columns,this.columns instanceof c.Collection||(this.columns=new D(this.columns)),this.row=new i.HeaderRow({columns:this.columns,collection:this.collection})},render:function(){return this.$el.append(this.row.render().$el),this.delegateEvents(),this},remove:function(){return this.row.remove.apply(this.row,arguments),c.View.prototype.remove.apply(this,arguments)}})),I=i.Body=c.View.extend({tagName:"tbody",initialize:function(a){this.columns=a.columns,this.columns instanceof c.Collection||(this.columns=new D(this.columns)),this.row=a.row||E,this.rows=this.collection.map(function(a){var b=new this.row({columns:this.columns,model:a});return b},this),this.emptyText=a.emptyText,this._unshiftEmptyRowMayBe();var b=this.collection;this.listenTo(b,"add",this.insertRow),this.listenTo(b,"remove",this.removeRow),this.listenTo(b,"sort",this.refresh),this.listenTo(b,"reset",this.refresh),this.listenTo(b,"backgrid:sort",this.sort),this.listenTo(b,"backgrid:edited",this.moveToNextCell)},_unshiftEmptyRowMayBe:function(){0===this.rows.length&&null!=this.emptyText&&this.rows.unshift(new F({emptyText:this.emptyText,columns:this.columns}))},insertRow:function(a,b,d){if(this.rows[0]instanceof F&&this.rows.pop().remove(),!(b instanceof c.Collection||d))return void this.collection.add(a,d=b);var e=new this.row({columns:this.columns,model:a}),f=b.indexOf(a);this.rows.splice(f,0,e);var g=this.$el,h=g.children(),i=e.render().$el;return f>=h.length?g.append(i):h.eq(f).before(i),this},removeRow:function(a,c,d){return d?((b.isUndefined(d.render)||d.render)&&this.rows[d.index].remove(),this.rows.splice(d.index,1),this._unshiftEmptyRowMayBe(),this):(this.collection.remove(a,d=c),void this._unshiftEmptyRowMayBe())},refresh:function(){for(var a=0;a<this.rows.length;a++)this.rows[a].remove();return this.rows=this.collection.map(function(a){var b=new this.row({columns:this.columns,model:a});return b},this),this._unshiftEmptyRowMayBe(),this.render(),this.collection.trigger("backgrid:refresh",this),this},render:function(){this.$el.empty();for(var a=document.createDocumentFragment(),b=0;b<this.rows.length;b++){var c=this.rows[b];a.appendChild(c.render().el)}return this.el.appendChild(a),this.delegateEvents(),this},remove:function(){for(var a=0;a<this.rows.length;a++){var b=this.rows[a];b.remove.apply(b,arguments)}return c.View.prototype.remove.apply(this,arguments)},sort:function(a,d){if(!b.contains(["ascending","descending",null],d))throw new RangeError('direction must be one of "ascending", "descending" or `null`');b.isString(a)&&(a=this.columns.findWhere({name:a}));var e,f=this.collection;e="ascending"===d?-1:"descending"===d?1:null;var g=this.makeComparator(a.get("name"),e,e?a.sortValue():function(a){return 1*a.cid.replace("c","")});return c.PageableCollection&&f instanceof c.PageableCollection?(f.setSorting(e&&a.get("name"),e,{sortValue:a.sortValue()}),f.fullCollection?(null==f.fullCollection.comparator&&(f.fullCollection.comparator=g),f.fullCollection.sort(),f.trigger("backgrid:sorted",a,d,f)):f.fetch({reset:!0,success:function(){f.trigger("backgrid:sorted",a,d,f)}})):(f.comparator=g,f.sort(),f.trigger("backgrid:sorted",a,d,f)),a.set("direction",d),this},makeComparator:function(a,b,c){return function(d,e){var f,g=c(d,a),h=c(e,a);return 1===b&&(f=g,g=h,h=f),g===h?0:h>g?-1:1}},moveToNextCell:function(a,b,c){var d,e,f,g,h,j=this.collection.indexOf(a),k=this.columns.indexOf(b);if(this.rows[j].cells[k].exitEditMode(),c.moveUp()||c.moveDown()||c.moveLeft()||c.moveRight()||c.save()){var l=this.columns.length,m=l*this.collection.length;if(c.moveUp()||c.moveDown()){g=j+(c.moveUp()?-1:1);var n=this.rows[g];n?(d=n.cells[k],i.callByNeed(d.column.editable(),d.column,a)&&(d.enterEditMode(),a.trigger("backgrid:next",g,k,!1))):a.trigger("backgrid:next",g,k,!0)}else if(c.moveLeft()||c.moveRight()){for(var o=c.moveRight(),p=j*l+k+(o?1:-1);p>=0&&m>p;o?p++:p--)if(g=~~(p/l),h=p-g*l,d=this.rows[g].cells[h],e=i.callByNeed(d.column.renderable(),d.column,d.model),f=i.callByNeed(d.column.editable(),d.column,a),e&&f){d.enterEditMode(),a.trigger("backgrid:next",g,h,!1);break}p==m&&a.trigger("backgrid:next",~~(p/l),p-g*l,!0)}}return this}});i.Footer=c.View.extend({tagName:"tfoot",initialize:function(a){this.columns=a.columns,this.columns instanceof c.Collection||(this.columns=new i.Columns(this.columns))}}),i.Grid=c.View.extend({tagName:"table",className:"backgrid",header:H,body:I,footer:null,initialize:function(a){a.columns instanceof c.Collection||(a.columns=new D(a.columns)),this.columns=a.columns;var d=b.omit(a,["el","id","attributes","className","tagName","events"]);this.body=a.body||this.body,this.body=new this.body(d),this.header=a.header||this.header,this.header&&(this.header=new this.header(d)),this.footer=a.footer||this.footer,this.footer&&(this.footer=new this.footer(d)),this.listenTo(this.columns,"reset",function(){this.header&&(this.header=new(this.header.remove().constructor)(d)),this.body=new(this.body.remove().constructor)(d),this.footer&&(this.footer=new(this.footer.remove().constructor)(d)),this.render()})},insertRow:function(){return this.body.insertRow.apply(this.body,arguments),this},removeRow:function(){return this.body.removeRow.apply(this.body,arguments),this},insertColumn:function(){return this.columns.add.apply(this.columns,arguments),this},removeColumn:function(){return this.columns.remove.apply(this.columns,arguments),this},sort:function(){return this.body.sort.apply(this.body,arguments),this},render:function(){return this.$el.empty(),this.header&&this.$el.append(this.header.render().$el),this.footer&&this.$el.append(this.footer.render().$el),this.$el.append(this.body.render().$el),this.delegateEvents(),this.trigger("backgrid:rendered",this),this},remove:function(){return this.header&&this.header.remove.apply(this.header,arguments),this.body.remove.apply(this.body,arguments),this.footer&&this.footer.remove.apply(this.footer,arguments),c.View.prototype.remove.apply(this,arguments)}});return i}),define("modules/chat/views/chat_sidebar/contactgrid/body",["underscore","jquery","backgrid","backbone","handlebars"],function(a,b,c,d){var e=d.View.extend({tagName:"div",emptyText:null,initialize:function(a){this.emptyText=a.emptyText,this.columns=a.columns,this.isRendered=!1},render:function(){this.$el.empty();var c=document.createElement(this.tagName);return c.setAttribute("colspan",this.columns.length),b(c).html(a.result(this,"emptyText")),this.el.className="empty",this.el.appendChild(c),this.isRendered=!0,this}}),f=c.Body.extend({tagName:"div",className:"body chat-item-list padding-4px",resize:function(){},insertRow:function(a,b,c){var f,g;if(this.rows[0]instanceof e&&this.rows.pop().remove(),!(b instanceof d.Collection||c))return void this.collection.add(a,c=b);g=this.rows_by_model_id,g[a.id]?f=g[a.id]:(f=new this.row({columns:this.columns,model:a}),g[a.id]=f);var h=b.indexOf(a);this.rows.splice(h,0,f);var i=this.$el,j=i.children(),k=f.rendered?f.$el:f.render().$el;return h>=j.length?i.append(k):j.eq(h).before(k),f.reAttachEvents&&f.reAttachEvents(),this.collection.trigger("backgrid:insert_row",this),this},show:function(){this.$el.show()},hide:function(){this.$el.hide()},render:function(){this.$el.empty();for(var a=document.createDocumentFragment(),b=0;b<this.rows.length;b++){var c=this.rows[b],d=c.rendered?c.el:c.render().el;a.appendChild(d),c.reAttachEvents&&c.reAttachEvents()}return this.el.appendChild(a),this.delegateEvents(),this},initialize:function(a){var b;this.columns=a.columns,this.columns instanceof d.Collection||(this.columns=new c.Columns(this.columns)),this.rows_by_model_id=b={},this.row=a.row||c.Row,this.rows=this.collection.map(function(a){var c=new this.row({columns:this.columns,model:a});return b[a.id]=c,c},this),this.emptyText=a.emptyText,this._unshiftEmptyRowMayBe();var e=this.collection;this.listenTo(e,"add",this.insertRow),this.listenTo(e,"remove",this.removeRow),this.listenTo(e,"sort",this.refresh),this.listenTo(e,"reset",this.refresh),this.listenTo(e,"backgrid:sort",this.sort),this.listenTo(e,"backgrid:edited",this.moveToNextCell)},_unshiftEmptyRowMayBe:function(){0===this.rows.length&&null!==this.emptyText&&this.rows.unshift(new e({emptyText:this.emptyText,columns:this.columns}))},getItemAt:function(a){return this.rows[a]},removeRow:function(b,c,d){return d?((a.isUndefined(d.render)||d.render)&&this.rows[d.index].remove(),this.rows.splice(d.index,1),delete this.rows_by_model_id[b.id],this._unshiftEmptyRowMayBe(),this):(this.collection.remove(b,d=c),void this._unshiftEmptyRowMayBe())},refresh:function(){var a=this.rows_by_model_id;return this.rows=this.collection.map(function(b){var c=a[b.id];return c||(c=new this.row({columns:this.columns,model:b}),a[b.id]=c),c},this),this._unshiftEmptyRowMayBe(),this.render(),this.collection.trigger("backgrid:refresh",this),this},remove:function(){for(var a=0;a<this.rows.length;a++){var b=this.rows[a];b.remove.apply(b,arguments)}return d.View.prototype.remove.apply(this,arguments)}});return f}),define("hbs!modules/template/chat/expanded/contact-group",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h,i="",j="function",k=this.escapeExpression,l=c.helperMissing;return i+='<div class="row">\n    <div class="col-xs-10">\n        <b class="caret"></b>\n        &nbsp;\n        ',(g=c.name)?f=g.call(b,{hash:{},data:e}):(g=b&&b.name,f=typeof g===j?g.call(b,{hash:{},data:e}):g),i+=k(f)+'\n		<span class="chat-item-category-count">\n			(<span class="count">',(g=c.count)?f=g.call(b,{hash:{},data:e}):(g=b&&b.count,f=typeof g===j?g.call(b,{hash:{},data:e}):g),i+=k(f)+'</span>)\n		</span>\n    </div>\n    <div class="option-dropdown">\n        <div class="chat-settings text-center no-padding">\n            <a class="gray-anchor dropdown-toggle" href="#" data-toggle="dropdown"><span class="icon-wb_more"></span></a>\n            <ul class="dropdown-menu" role="menu">\n                <li>\n                    <a href="#" class="rename-group">'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"chat|rename_group",h):l.call(b,"translate","chat|rename_group",h)))+'</a>\n                </li>\n                <li>\n                    <a href="#" class="delete-group">'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"chat|delete_group",h):l.call(b,"translate","chat|delete_group",h)))+'</a>\n                </li>\n            </ul>\n        </div>\n        <div class="chat-settings-im text-center no-padding">\n            <a class="gray-anchor dropdown-toggle" href="#" data-toggle="dropdown"><span class="icon-wb_more"></span></a>\n            <ul class="dropdown-menu" role="menu">\n                <li class="im_login_btn">\n                    <a href="#" class="im_toggle_login">',(g=c.login_text)?f=g.call(b,{hash:{},data:e}):(g=b&&b.login_text,f=typeof g===j?g.call(b,{hash:{},data:e}):g),i+=k(f)+'</a>\n                </li>\n                <li>\n                    <a href="#" class="im_setup">'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"chat|setup_details",h):l.call(b,"translate","chat|setup_details",h)))+"</a>\n                </li>\n            </ul>\n        </div>\n    </div>\n</div>\n"})}),define("modules/chat/views/chat_sidebar/contactgrid/header",["underscore","jquery","backgrid","hbs!modules/template/chat/expanded/contact-group","modules/common/utility","backbone","handlebars"],function(a,b,c,d,e,f){var g=c.Header.extend({tagName:"div",className:"chat-item-category padding-4px font-size-12",events:{click:"_handleClick","click .chat-settings a":"_handleSettingsClick","click .chat-settings-im a":"_handleSettingsIMClick","click .rename-group":"_handleRenameClick","click .delete-group":"_handleDeleteClick","click .im_toggle_login":"_handleLoginClick","click .im_setup":"_handleSetupClick"},_handleClick:function(a){this.trigger("header_click")},_handleSettingsClick:function(a){a.stopPropagation(),a.preventDefault(),b(".chat-settings",this.$el).toggleClass("open");
},_handleSettingsIMClick:function(a){a.stopPropagation(),a.preventDefault(),b(".chat-settings-im",this.$el).toggleClass("open")},_handleRenameClick:function(a){a.preventDefault(),this.trigger("rename_click")},_handleDeleteClick:function(a){a.preventDefault(),this.trigger("delete_click")},_handleLoginClick:function(a){a.preventDefault(),this.collection.contact_group instanceof f.Collection||this.collection.contact_group.toggle_login()},_handleSetupClick:function(a){a.preventDefault(),this.collection.contact_group instanceof f.Collection||this.collection.contact_group.setup_im()},initialize:function(){var b=this;a.bindAll(this),this.isRendered=!1,c.Header.prototype.initialize.apply(this,arguments),this.collection.contact_group instanceof f.Collection||(this.collection.contact_group.on("change:name",function(){b.isRendered&&b.render()}),this.collection.contact_group.on("im_loggin_toggle",function(){b.isRendered&&b.render()}))},render:function(){return this.isRendered=!0,this.$el.html(d({name:this.collection.contact_group.get("name")||this.columns.at(0).get("label"),count:this.collection.size(),login_text:this.collection.contact_group.is_im_logged_in()?e.translate("chat|signout_3rd_party"):e.translate("chat|signin_3rd_party")})),this.collection.contact_group.is_im_setup()||b(".im_login_btn",this.$el).hide(),b(".chat-settings-im",this.$el).hide(),(this.collection.contact_group.id<0||a.isUndefined(this.collection.contact_group.id))&&(b(".chat-settings",this.$el).hide(),-1!=this.collection.contact_group.id&&b(".chat-settings-im",this.$el).show()),this.delegateEvents(),this}});return g}),define("hbs!modules/template/chat/expanded/chatroom-category-footer",["handlebars"],function(a){return a.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},"Show More\n"})}),define("modules/chat/views/chat_sidebar/contactgrid/grid",["underscore","jquery","backbone","backgrid","modules/chat/views/chat_sidebar/contactgrid/body","modules/chat/views/chat_sidebar/contactgrid/header","hbs!modules/template/chat/expanded/chatroom-category-footer","handlebars","modules/mig33_app"],function(a,b,c,d,e,f,g,h,i){var j=(d.Footer.extend({tagName:"div",className:"chat-item-list-more padding-4px text-center text-uppercase font-size-12",render:function(){return this.el.innerHTML=g(),this}}),d.Grid.extend({tagName:"div",className:"backgrid",body:e,header:f,initialize:function(a){var b=this;j.__super__.initialize.apply(this,arguments),this.optionalGridClass=a.gridClass,this.collapsed=!1,a.noHeader&&(this.header=null),a.collection&&(this.listenTo(a.collection,"show_contact_menu",this.triggerShowContactMenu),this.listenTo(a.collection,"main_trigger",this.triggerMain),this.listenTo(a.collection,"change_count",this.renderHeader),this.listenTo(a.collection,"backgrid:refresh",this.manipulateViews),this.listenTo(a.collection,"backgrid:insert_row",this.throttlesManipulateViews)),this._collection=a.collection,"undefined"==typeof i&&(i=require("modules/mig33_app")),i.vent.on("chat-contact:showAll",function(){b.showAll()})},throttlesManipulateViews:function(){},triggerRename:function(a){this.trigger("rename_group",a)},triggerDelete:function(a){this.trigger("delete_group",a)},triggerShowContactMenu:function(a){this.trigger("show_contact_menu",a)},triggerMain:function(a){this.trigger("main_trigger",a)},triggerProfile:function(a){this.trigger("profile_trigger",a)},renderHeader:function(){this.header&&this.header.render()},toggleCollapse:function(){this.collapsed=!this.collapsed,this.collapsed?this.collapse():this.expand()},collapse:function(){this.body.hide(),this.$el.addClass("grid-collapsed"),i.vent.trigger("chat-contact:showAll")},expand:function(){this.body.show(),this.$el.removeClass("grid-collapsed"),i.vent.trigger("chat-contact:showAll")},getCollection:function(){return this._collection},render:function(){var a=this;return this.$el.empty(),this.optionalGridClass&&this.$el.addClass(this.optionalGridClass),this.header&&(this.$el.append(this.header.render().$el),this.header.on("header_click",function(){this.toggleCollapse()},this),this.header.on("rename_click",function(b){a.triggerRename(b)}),this.header.on("delete_click",function(b){a.triggerDelete(b)})),this.$el.append(this.body.render().$el),this.footer&&this.$el.append(this.footer.render().$el),this.delegateEvents(),this.trigger("backgrid:rendered",this),this},setupScrollListener:function(b){var c=this;b.position().top;this.__scrollParent=b,this.inViewItems=[],this.throttlesManipulateViews=a.throttle(function(){c.manipulateViews()},100)},manipulateViews:function(){var c=this.__scrollParent.position().top,d=this.__scrollParent.closest(".mCustomScrollBox"),e=0-c,f=d.outerHeight()-c,g=b(".chat-item-row",this.$el).outerHeight(),h=b(".chat-item-category",this.$el).outerHeight(),i=this.$el.position().top+h,j=this.$el.height(),k=i+j;a.each(this.inViewItems,function(a){b(".row-inner",a.$el).addClass("hidden")}),this.inViewItems=[];var l=!0,m=0;for(i>=e&&f>=i?m=0:e>i&&k>=e?m=Math.floor((e-i)/g):l=!1;l;){var n=this.body.getItemAt(m);if(!n){l=!1;break}var o=h+m*g;if(f>=i+o){var p=b(".hidden",n.$el);p.removeClass("hidden"),this.inViewItems.push(n)}else l=!1;m++}},showAll:function(){b(".row-inner",this.body.$el).removeClass("hidden")}}));return j}),define("hbs!modules/template/chat/expanded/contact-item",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i="function",j=this.escapeExpression;return h+='    <div class="row-inner hidden">\n		<div class="col-xs-3">\n	        <div class="chat-list-avatar">\n	            <img src="',(g=c.avatar)?f=g.call(b,{hash:{},data:e}):(g=b&&b.avatar,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'" width="36" height="36" class="img-circle" />\n	            <span class="status ',(g=c.online_status)?f=g.call(b,{hash:{},data:e}):(g=b&&b.online_status,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'"></span>\n	        </div>\n	    </div>\n	    <div class="col-xs-7 no-padding-left no-padding-right">\n	        <div class="chat-list-title">\n	            <a href="#">',(g=c.username)?f=g.call(b,{hash:{},data:e}):(g=b&&b.username,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'</a>\n	        </div>\n	    </div>\n	    <div class="col-xs-2">\n	        <div class="chat-item-list-action">\n	            <a href="#">\n		            <span class="icon-wb_arrowRight font-color-grey"></span>\n	            </a>\n	        </div>\n	    </div>\n    </div>'})}),define("modules/chat/views/chat_sidebar/contactgrid/row",["underscore","jquery","backgrid","hbs!modules/template/chat/expanded/contact-item","backbone","handlebars"],function(a,b,c,d,e){var f=c.Row.extend({tagName:"div",className:"row chat-item-row padding-4px",events:{"click .chat-item-list-action a":"triggerShowContactMenu","click .chat-list-avatar":"triggerProfile",click:"triggerMain"},initialize:function(b){a.bindAll(this),this.rendered=!1;var d=b.model;d&&d.on("change",function(){this.render()},this),c.Row.prototype.initialize.apply(this,[b])},reAttachEvents:function(){var c=this;a.each(this.events,function(d,e){var f=e.split(" "),g=f[0],h=a(f).rest().join(" ");""!==b.trim(h)?b(h,c.$el).on(g,c[d]):b(c.$el).on(g,c[d])})},remove:function(){for(var a=0;a<this.cells.length;a++){var b=this.cells[a];b.remove.apply(b,arguments)}return this.model.off("change",null,this),e.View.prototype.remove.apply(this,arguments)},triggerShowContactMenu:function(a){a.preventDefault(),a.stopPropagation(),this.model.trigger("show_contact_menu",{originalEvent:a,target:b(a.target),model:this.model})},triggerProfile:function(a){a.preventDefault(),a.stopPropagation(),this.model.trigger("profile_trigger",{originalEvent:a,target:b(a.target),model:this.model})},triggerMain:function(a){a.preventDefault(),a.stopPropagation(),this.model.trigger("main_trigger",{originalEvent:a,target:b(a.target),model:this.model})},render:function(){return this.$el.html(d(this.model.attributes)),this.rendered=!0,this}});return f}),define("modules/chat/views/chat_sidebar/contactgrid/cell",["underscore","jquery","backgrid","backbone","handlebars"],function(a,b,c){var d=c.StringCell.extend({tagName:"div",className:"body",render:function(){this.model;return this.$el.val("hahaha"),this}});return d}),define("modules/chat/views/chat_sidebar/contact_collection_proxy",["modules/model/common/mig33_collection","modules/mig33_app","modules/common/config","modules/common/utility","underscore","underscore.string","backbone","modules/globals/url"],function(a,b,c,d,e,f,g,h){var i=g.Model.extend({idAttribute:"id"}),j=a.extend({model:i,comparator:"sort_attribute",initialize:function(a,b){this.resetFilterFn();var c=this.sort;this.debouncedSort=e.debounce(function(){var a,b=Date.now();c.apply(this,arguments),a=Date.now()-b,console.log("Time taken to sort - "+a)},1e3),this.contact_cache_array=[],this.contact_cache_by_id={},this.contact_group=b.contact_group,this.attachContactGroupEventListener(this.contact_group)},resetFilterFn:function(){this.filter_fn=function(a){return!0}},create_contact_data_model:function(a){return{id:a.get("contactId"),online_status:a.getPresenceIconCls(),presence:a.getPresence(),username:a.getDisplayName(),avatar:a.getDisplayPicture(36,36),group_id:a.get("groupId")+"",group_name:a.get("groupName"),status_message:a.get("statusMessage"),sort_attribute:a.getSortOrder(),message:"",button:""}},setFilter:function(a){this.filter_fn=a;this._filter(this.filter_fn);this.refreshModels(),this.trigger("change_count")},_filter:function(a){return e.filter(this.contact_cache_array,a)},resetFilter:function(){this.resetFilterFn();this.contact_group;this.refreshModels(),this.trigger("change_count")},refreshModels:function(a){a?this.__collection=a:a=this.__collection,this.reset([],{isSilent:!0});var b=this;this.__sort&&(this.sort=this.__sort);var c=function(a){b.addAndSetupContact(a,!0),b.setupContactEvents(a)};a.each?a.each(c):e.isArray(a)&&e.each(a,c),this.trigger("reset"),this.trigger("change_count"),this.__sort=this.sort,this.sort=this.debouncedSort},addAndSetupContact:function(a,b){var c=this.create_contact_data_model(a),d=this.contact_cache_by_id[c.id];d?d.set(c):(d=new i(c),d.on("show_contact_menu",function(a){this.trigger("show_contact_menu",a)},this),d.on("main_trigger",function(a){this.trigger("main_trigger",a)},this),d.on("profile_trigger",function(a){this.trigger("profile_trigger",a)},this),d.on("change:sort_attribute",function(){this.sort()},this),this.contact_cache_by_id[c.id]=d,this.contact_cache_array.push(d));var e=this.filter_fn(d);e&&(this.add(d,{silent:b,sort:!0}),b||this.trigger("change_count"))},removeContact:function(a){this.resetContactEvents(a);var b=this.get(a.get("contactId"));b&&(b.off("show_contact_menu",null,this),b.off("main_trigger",null,this),b.off("profile_trigger",null,this),b.off("change:sort_attribute",null,this),this.remove(b),this.contact_cache_by_id[b.get("id")]=null,this.contact_cache_array.splice(e(this.contact_cache_array).indexOf(b),1),this.trigger("change_count"))},resetContactEvents:function(a){a.off("change",null,this)},setupContactEvents:function(a){this.resetContactEvents(a),a.on("change",function(){var b=a.get("contactId"),c=this.get(b);c||(c=new i(this.create_contact_data_model(a))),c.set(this.create_contact_data_model(a));var d=this.filter_fn(c);d?this.addAndSetupContact(a):this.removeContact(a)},this)},attachContactGroupEventListener:function(a){var b=this,c=a instanceof g.Collection?"add":"contact_added",d=a instanceof g.Collection?"remove":"contact_removed";a.on(c,function(a){b.addAndSetupContact(a,!1),b.setupContactEvents(a)},this),a.on(d,function(a){b.removeContact(a)},this)}});return j}),function(a,b){function c(a){return a&&a.toLowerCase?a.toLowerCase():a}function d(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]==b)return!e;return e}var e=!1,f=null,g=parseFloat,h=Math.min,i=/(-?\d+\.?\d*)$/g,j=/(\d+\.?\d*)$/g,k=[],l=[],m=function(a){return"string"==typeof a},n=function(a,b){for(var c,d=a.length,e=d;e--;)c=d-e-1,b(a[c],c)},o=Array.prototype.indexOf||function(a){var b=this.length,c=Number(arguments[1])||0;for(c=0>c?Math.ceil(c):Math.floor(c),0>c&&(c+=b);b>c;c++)if(c in this&&this[c]===a)return c;return-1};a.tinysort={id:"TinySort",version:"1.5.6",copyright:"Copyright (c) 2008-2013 Ron Valstar",uri:"http://tinysort.sjeiti.com/",licensed:{MIT:"http://www.opensource.org/licenses/mit-license.php",GPL:"http://www.gnu.org/licenses/gpl.html"},plugin:function(){var a=function(a,b){k.push(a),l.push(b)};return a.indexOf=o,a}(),defaults:{order:"asc",attr:f,data:f,useVal:e,place:"start",returns:e,cases:e,forceStrings:e,ignoreDashes:e,sortFunction:f}},a.fn.extend({tinysort:function(){var p,q,r,s,t=this,u=[],v=[],w=[],x=[],y=0,z=[],A=[],B=function(a){n(k,function(b){b.call(b,a)})},C=function(a,b){return"string"==typeof b&&(a.cases||(b=c(b)),b=b.replace(/^\s*(.*?)\s*$/i,"$1")),b},D=function(a,b){var c=0;for(0!==y&&(y=0);0===c&&s>y;){var d=x[y],f=d.oSettings,h=f.ignoreDashes?j:i;if(B(f),f.sortFunction)c=f.sortFunction(a,b);else if("rand"==f.order)c=Math.random()<.5?1:-1;else{var k=e,o=C(f,a.s[y]),p=C(f,b.s[y]);if(!f.forceStrings){var q=m(o)?o&&o.match(h):e,r=m(p)?p&&p.match(h):e;if(q&&r){var t=o.substr(0,o.length-q[0].length),u=p.substr(0,p.length-r[0].length);t==u&&(k=!e,o=g(q[0]),p=g(r[0]))}}c=d.iAsc*(p>o?-1:o>p?1:0)}n(l,function(a){c=a.call(a,k,o,p,c)}),0===c&&y++}return c};for(p=0,r=arguments.length;r>p;p++){var E=arguments[p];m(E)?z.push(E)-1>A.length&&(A.length=z.length-1):A.push(E)>z.length&&(z.length=A.length)}for(z.length>A.length&&(A.length=z.length),s=z.length,0===s&&(s=z.length=1,A.push({})),p=0,r=s;r>p;p++){var F=z[p],G=a.extend({},a.tinysort.defaults,A[p]),H=!(!F||""===F),I=H&&":"===F[0];x.push({sFind:F,oSettings:G,bFind:H,bAttr:!(G.attr===f||""===G.attr),bData:G.data!==f,bFilter:I,$Filter:I?t.filter(F):t,fnSort:G.sortFunction,iAsc:"asc"==G.order?1:-1})}return t.each(function(c,d){var e,f=a(d),g=f.parent().get(0),h=[];for(q=0;s>q;q++){var i=x[q],j=i.bFind?i.bFilter?i.$Filter.filter(d):f.find(i.sFind):f;h.push(i.bData?j.data(i.oSettings.data):i.bAttr?j.attr(i.oSettings.attr):i.oSettings.useVal?j.val():j.text()),e===b&&(e=j)}var k=o.call(w,g);0>k&&(k=w.push(g)-1,v[k]={s:[],n:[]}),e.length>0?v[k].s.push({s:h,e:f,n:c}):v[k].n.push({e:f,n:c})}),n(v,function(a){a.s.sort(D)}),n(v,function(a){var b=a.s,c=a.n,f=b.length,g=c.length,i=f+g,j=[],k=i,l=[0,0];switch(G.place){case"first":n(b,function(a){k=h(k,a.n)});break;case"org":n(b,function(a){j.push(a.n)});break;case"end":k=g;break;default:k=0}for(p=0;i>p;p++){var m=d(j,p)?!e:p>=k&&k+f>p,o=m?0:1,q=(m?b:c)[l[o]].e;q.parent().append(q),!m&&G.returns||u.push(q.get(0)),l[o]++}}),t.length=0,Array.prototype.push.apply(t,u),t}}),a.fn.TinySort=a.fn.Tinysort=a.fn.tsort=a.fn.tinysort}(jQuery),define("jquery.tinysort",["jquery"],function(){}),define("modules/chat/views/chat_sidebar/contact_grid",["modules/chat/models/user_session","modules/chat/models/contacts","modules/chat/models/chats","handlebars","modules/common/utility","modules/chat/views/content_window_helper","modules/chat/views/chat_sidebar/contact_dropdown","backgrid","modules/chat/views/chat_sidebar/contactgrid/grid","modules/chat/views/chat_sidebar/contactgrid/row","modules/chat/views/chat_sidebar/contactgrid/cell","modules/chat/views/chat_sidebar/contact_collection_proxy","underscore","backbone","jquery","jquery.tinysort","jquery.mCustomScrollbar"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=(a.Session.getInstance(),"/credit/transfer?recipient_username="),p=c.ChatStoreModel.getInstance(),q=null,r={},s=b.ContactGroupStore.getInstance(),t=function(a){this.groupedContactMode=!0,this.$el=$(a),this.hasOfflineFilter=!1,this.hasTextFilter=!1,this.textFilterValue="",this.$el.mCustomScrollbar({scrollInertia:150,advanced:{updateOnContentResize:!0},autoHideScrollbar:!0,callbacks:{whileScrolling:function(){b.calculateAndRenderRows()}}}),this._groupLessContacts=null,this.setup_contact_group_store_events();var b=this;this.throttled_sort=m.throttle(function(){b.sortGroups()},1e3)},u=t.prototype;return m.extend(u,n.Events),m.extend(u,{calculateAndRenderRows:function(){var a=this;m.each(r,function(a){a.grid&&a.grid.throttlesManipulateViews()}),this._groupLessContacts&&a._groupLessContacts.throttlesManipulateViews()},getGroups:function(a){var b=s.get_contact_groups(),c=[];return b.each(function(b){b.get("groupId")>=-2&&a.get("groupId")!==b.get("groupId")&&c.push({id:b.get("groupId"),name:b.get("name")})}),c},showContactMenu:function(a,b){var c=a.target,d=a.model;q&&q.remove();var e=new g({model:d,groups:this.getGroups(b),scrollParent:this.$el.find(".mCSB_container"),$target:c}),f=e.render().$el;$("body").append(f),e.position(c),q=e,e.on("menu_click",this.onMenuClick,this)},viewProfile:function(a){var b=a.getUsername(),c=e.get_profile_url(b),d=require("modules/mig33_app");d.navigate_to(c)},block:function(a){var b=a.getUsername(),c=window.confirm(e.translate("user|confirm_block",b));c&&s.send_block_user(b)},transfer:function(a){var b=a.getUsername(),c=require("modules/mig33_app");c.navigate_to([document.location.protocol,"//",document.location.host,c.root,o,b].join(""))},remove:function(a){var b=a.getUsername(),c=window.confirm(e.translate("chat|are_you_sure_remove_friend",b));c&&s.send_remove_friend(a.get("contactId"))},moveGroup:function(a,b){s.send_move_contact(a.get("contactId"),b)},startChat:function(a){p.startPrivateChat(a.get("contactId"),a.getDisplayName(),a.getType(),a.getUsername())},onMenuClick:function(a,b,c){var d=s.find_contact_by_id(c.get("id"));switch(a){case"start_chat":this.startChat(d);break;case"view_profile":this.viewProfile(d);break;case"block":this.block(d);break;case"transfer_credit":this.transfer(d);break;case"remove_friend":this.remove(d);break;case"move_group":this.moveGroup(d,b)}},sortGroups:function(){var a=this.$el.find(".mCSB_container").find(".groupedGrid");a.tsort({data:"sortorder",order:"desc"})},hideAllGroupedContacts:function(){m.each(r,function(a,b){a.$ux.hide()},this)},showAllGroupedContacts:function(){m.each(r,function(a,b){a.$ux.show()},this)},createOrGetContactCollection:function(a){var b,c,d=a.get("groupId");return r[d]?b=r[d]:(c=new l([],{contact_group:a}),b={collection_proxy:c},r[d]=b),b},toggleContactGroupDisplay:function(a){this.groupedContactMode=a,a?this.showGroupedContacts():this.showGroupLessContacts()},toggleOfflineContactDisplay:function(a){a?this.hasOfflineFilter=!1:this.hasOfflineFilter=!0,this.createAndSetFilter()},setTextFilter:function(a){this.hasTextFilter=""!==a,this.textFilterValue=a,this.createAndSetFilter()},createAndSetFilter:function(){var a=this.hasTextFilter,b=this.hasOfflineFilter,c=this.textFilterValue,d=function(d){return b&&99==d.get("presence")?!1:!a||-1!==d.get("username").toLowerCase().indexOf(c.toLowerCase())};m.each(r,function(c,e){a||b?c.collection_proxy.setFilter(d):c.collection_proxy.resetFilter()},this),this._groupLessContacts&&this._groupLessContacts.getCollection()&&(a||b?this._groupLessContacts.getCollection().setFilter(d):this._groupLessContacts.getCollection().resetFilter())},showGroupLessContacts:function(){this.hideAllGroupedContacts(),this.setupGroupLessContact(),this._groupLessContacts.$el.show()},showGroupedContacts:function(){this.showAllGroupedContacts(),this._groupLessContacts&&(this._groupLessContacts.remove(),this._groupLessContacts.$el.remove(),this._groupLessContacts=null)},setupGroupLessContact:function(){if(!this._groupLessContacts){var a=new l([],{contact_group:s.all_contacts});this._groupLessContacts=new i({row:j,columns:[{name:"name",label:e.translate("chat|all-contacts"),emptyText:e.translate("chat|empty-group"),editable:!1,cell:k}],noHeader:!1,gridClass:"unGroupedGrid",collection:a}),this.$el.find(".mCSB_container").append(this._groupLessContacts.render().$el),this._groupLessContacts.setupScrollListener(this.$el.find(".mCSB_container")),this._groupLessContacts.on("show_contact_menu",this.showContactMenu,this),a.refreshModels(s.all_contacts)}},get_empty_text_for_contact_group:function(a){var b;return!a.is_im()||a.is_im_logged_in()?e.translate("chat|empty-group"):a.is_im_setup()?(b=$('<div style="margin-top:-10px;"></div>').html(e.translate("chat|empty-group")+"<br/><a href='#'>"+e.translate("chat|empty-group-connect")+"</a>"),b.find("a").on("click",function(b){a.login_im(),b.preventDefault()}),b):(b=$("<div></div>").html('<a href="#">'+e.translate("chat|empty-group-import",a.get("name"))+"</a>"),b.find("a").on("click",function(b){a.setup_im(),b.preventDefault()}),b)},setupGroup:function(a){var b=this,c=a.get("name"),d=this.createOrGetContactCollection(a),g=function(){return b.get_empty_text_for_contact_group(a)};if(!d.$ux||this.$el.find("#"+d.$ux[0].id).length<=0){var h=new i({row:j,columns:[{name:"name",label:c,editable:!1,cell:k}],emptyText:g,noHeader:!1,gridClass:"groupedGrid",collection:d.collection_proxy});h.on("show_contact_menu",function(b){this.showContactMenu(b,a)},this),h.on("main_trigger",function(b){this.handleClickEvent(b,a)},this),h.on("profile_trigger",function(b){this.handleClickEvent(b,a)},this),h.on("rename_group",function(b){f.show_window("rename_contact_group",a.get("groupId"),a.get("name"))}),h.on("delete_group",function(b){var c=window.confirm(e.translate("chat|confirm_group_delete"));c&&s.send_delete_contact_group(a.get("groupId"),a.get("name"))}),h.setupScrollListener(this.$el.find(".mCSB_container"));var l=a.get("groupId");l=-1==l?Number.MAX_VALUE:10+parseInt(l,10),d.grid=h,d.$ux=$(h.render().$el).attr("id","id_"+a.get("groupId")).attr("data-sortorder",l),this.$el.find(".mCSB_container").append(d.$ux)}d.collection_proxy.refreshModels(a.get_contacts()),this.throttled_sort()},handleClickEvent:function(a,b){var c=(a.target,a.model),d=s.find_contact_by_id(c.get("id"));this.startChat(d)},handleProfileClickEvent:function(a,b){var c=(a.target,a.model),d=s.find_contact_by_id(c.get("id"));this.viewProfile(d)},removeGroup:function(a){var b=this.createOrGetContactCollection(a);b.grid&&b.grid.remove&&(b.grid.remove(),b.grid.$ux.remove()),r[a.get("groupId")]=null},resize:function(a,b){this.$el.height(a-20),this.calculateAndRenderRows()},initialize_with_data:function(a){var b=this,c=a.get_contact_groups();c.each(function(a){b.setupGroup(a)})},setup_contact_group_store_events:function(){s.on("contact_group_added",function(a){this.setupGroup(a)},this),s.on("contact_group_removed",function(a){var b=a.get("groupId");if(r[b]){var c=r[b];c.$ux&&c.grid.remove(),r[b]=null}},this),s.on("contacts_load_complete",function(){this.initialize_with_data(s)},this)}}),t}),define("modules/chat/views/chat_sidebar/contact_area",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/chat/expanded/chat-contact-area","modules/chat/views/chat_sidebar/contact_grid","modules/common/config","modules/common/utility","modules/globals/url","modules/chat/views/content_window_helper","modules/template/helpers/general_helpers","jquery.menuaim"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=14,n=e.ItemView.extend({template:{type:"handlebars",template:g},initialize:function(){a.bindAll(this),this._contact_list_view=null,this._showingOffline=!0,this._showingGroup=!0,this.model||(this.model=new c.Model({})),this.model.set("recommend_url",k.site+"search/users/")},events:{},onRender:function(){var c=this;a.delay(function(){c._contact_list_view=new h(b(".contact-list",c.$el))},100),this.initialize_setting_dropdown(),this.search_txt=b(".search-text",this.$el),this.search_txt.on("keyup",a.debounce(function(){c.setTextFilter(b(".search-text",this.$el).val())},500)),b(".hideMobileChat a",this.$el).on("click",function(a){j.hide_mobile_chat()})},setTextFilter:function(a){this._contact_list_view.setTextFilter(a)},initialize_setting_dropdown:function(){var a=this;b("a.add-contact-group",this.$el).on("click",function(a){a.preventDefault(),l.show_window("add_contact_group")}),a.updateShowContactGroupText(),b("a.show-contact-group",this.$el).on("click",function(b){b.preventDefault(),a._showingGroup=!a._showingGroup,a._contact_list_view.toggleContactGroupDisplay(a._showingGroup),a.updateShowContactGroupText()}),a.updateShowOfflineContactsText(),b("a.show-offline-contacts",this.$el).on("click",function(b){b.preventDefault(),a._showingOffline=!a._showingOffline,a._contact_list_view.toggleOfflineContactDisplay(a._showingOffline),a.updateShowOfflineContactsText()})},resize:function(a,b){this._contact_list_view&&(a=a-this.$el.find(".chat-search").height()-this.$el.find(".chat-footer").height()-m,this._contact_list_view.resize(a,b))},updateShowContactGroupText:function(){b("a.show-contact-group",this.$el).text(this._showingGroup?j.translate("chat|contact-hide-contact-group"):j.translate("chat|contact-show-contact-group"))},updateShowOfflineContactsText:function(){b("a.show-offline-contacts",this.$el).text(this._showingOffline?j.translate("chat|contact-hide-offline"):j.translate("chat|contact-show-offline"))}});return n}),define("hbs!modules/template/chat/expanded/chat-room-area",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="chat-search">\n    <div class="row">\n        <div class="col-xs-11 no-padding-right">\n            <div class="input-group">\n                <input type="text" class="form-control input-xs search-input" placeholder="Search Chat Rooms">\n                <div class="input-group-btn">\n                    <button type="button" class="btn btn-xs btn-default btn-default-white search-btn">\n                        <span class="icon-wb_search font-color-grey"></span>\n                    </button>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n\n<div class="chat-item chatroom-list">\n    <div class="row font-size-12 user-stats">\n        <div class="col-xs-4 text-center user-stat">\n            <span class="user-count count">35.6k</span>\n            <br />\n            Users\n        </div>\n        <div class="col-xs-4 text-center user-stat">\n            <span class="rooms-count count">35.6k</span>\n            <br />\n            Rooms\n        </div>\n        <div class="col-xs-4 text-center user-stat">\n            <span class="groups-count count">35.6k</span>\n            <br />\n            Groups\n        </div>\n    </div>\n</div>\n<div class="chat-footer chat-panel-footer font-size-14 padding-8px">\n    <div class="row create-chatroom-btn">\n        <span>\n            <a href="#"><span class="icon-wb_plus">&nbsp;'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"chat|contact-menu-create-chatroom",g):i.call(b,"translate","chat|contact-menu-create-chatroom",g)))+"</a>\n        </span>\n    </div>\n</div>"})}),define("hbs!modules/template/chat/expanded/chat-room-item",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+='\n        <div class="text-truncate chat-list-subtitle font-size-12">\n            <span class="count">',(e=c.stats)?d=e.call(a,{hash:{},data:b}):(e=a&&a.stats,d=typeof e===j?e.call(a,{hash:{},data:b}):e),f+=k(d)+"</span>\n        </div>\n        "}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var g,h,i="",j="function",k=this.escapeExpression,l=this;return i+='    <div class="col-xs-2">\n        <div class="chat-list-avatar">\n            <span class="wb wb-36 wb-chatp-chatrm"></span>\n        </div>\n    </div>\n    <div class="col-xs-10">\n        <div data-id="',(h=c.id)?g=h.call(b,{hash:{},data:e}):(h=b&&b.id,g=typeof h===j?h.call(b,{hash:{},data:e}):h),i+=k(g)+'" class="chat-list-title">\n            <a href="#">',(h=c.name)?g=h.call(b,{hash:{},data:e}):(h=b&&b.name,g=typeof h===j?h.call(b,{hash:{},data:e}):h),i+=k(g)+"</a>\n        </div>\n        ",g=c["if"].call(b,b&&b.show_count,{hash:{},inverse:l.noop,fn:l.program(1,f,e),data:e}),(g||0===g)&&(i+=g),i+="\n    </div>\n"})}),define("modules/chat/views/chat_sidebar/backgrid/body",["underscore","jquery","backgrid","backbone","handlebars"],function(a,b,c){var d=c.Body.extend({tagName:"div",className:"body chat-item-list padding-4px",resize:function(){},show:function(){this.$el.show()},hide:function(){this.$el.hide()}});return d}),define("hbs!modules/template/chat/expanded/chat-room-item-category",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){return'\n                <span class="chat-item-category-count">\n                (<span class="count">30</span>)\n            </span>\n	        '}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var g,h,i="",j="function",k=this.escapeExpression,l=this;return i+='    <div class="row">\n        <div class="col-xs-10">\n            <b class="caret"></b>\n            &nbsp;\n	        ',(h=c.title)?g=h.call(b,{hash:{},data:e}):(h=b&&b.title,g=typeof h===j?h.call(b,{hash:{},data:e}):h),i+=k(g)+"\n	        ",g=c["if"].call(b,b&&b.show_count,{hash:{},inverse:l.noop,fn:l.program(1,f,e),data:e}),(g||0===g)&&(i+=g),i+='\n        </div>\n        <div class="col-xs-2 text-center font-color-grey">\n            <a class="chatroom-refresh-btn" href="#">\n	            <span class="icon-wb_refresh font-color-grey"></span>\n            </a>\n        </div>\n    </div>\n'})}),define("modules/chat/views/chat_sidebar/backgrid/header",["underscore","jquery","backgrid","hbs!modules/template/chat/expanded/chat-room-item-category","backbone","handlebars"],function(a,b,c,d){var e=c.Header.extend({tagName:"div",className:"chat-item-category padding-4px font-size-12",render:function(){var a=this;return this.$el.append(d({title:this.columns.at(0).get("label")})),this.$el.on("click",function(){a.trigger("header_click")}),b(".chatroom-refresh-btn",this.$el).on("click",function(b){b.preventDefault(),b.stopPropagation(),a.trigger("refresh_click")}),this.delegateEvents(),this}});return e}),define("modules/chat/views/chat_sidebar/backgrid/grid",["underscore","jquery","backbone","backgrid","modules/chat/views/chat_sidebar/backgrid/body","modules/chat/views/chat_sidebar/backgrid/header","hbs!modules/template/chat/expanded/chatroom-category-footer","handlebars"],function(a,b,c,d,e,f,g,h){var i=d.Footer.extend({tagName:"div",className:"chat-item-list-more padding-4px text-center text-uppercase font-size-12",render:function(){var a=this;return this.$el.html(g()),this.$el.click(function(b){b.stopPropagation(),b.preventDefault(),a.trigger("footer_click")}),this},show:function(){this.$el.show()},hide:function(){this.$el.hide()}}),j=d.Grid.extend({tagName:"div",className:"backgrid",body:e,header:f,footer:i,resize:function(){},initialize:function(a){j.__super__.initialize.apply(this,arguments),this.optionalGridClass=a.gridClass,this.collapsed=!1,a.noHeader&&(this.header=null),a.collection&&this.listenTo(a.collection,"add",this.showIfRecent),this._collection=a.collection},showFooter:function(){this.footer&&(this._collection.length?this.footer.show():this.footer.hide())},hideFooter:function(){this.footer&&this.footer.hide()},showIfRecent:function(){this._collection.isRecentCategory()&&this.$el.show(),this.collapsed||this.showFooter()},toggleCollapse:function(){this.collapsed=!this.collapsed,this.collapsed?this.collapse():this.expand()},collapse:function(){this.body.hide(),this.$el.addClass("grid-collapsed"),this.hideFooter()},expand:function(){this.body.show(),this.$el.removeClass("grid-collapsed"),this.showFooter()},removeLoadMore:function(){b(".chat-item-list-more",this.$el).hide(),b(".chat-item-list-more",this.$el).addClass("hidden")},render:function(){return this.$el.empty(),this.header&&(this.$el.append(this.header.render().$el),this.header.on("header_click",function(){this.toggleCollapse()},this),this.header.on("refresh_click",function(){this.trigger("refresh_click")},this),this.header.on("rename_click",function(){this.trigger("rename_group")},this),this.header.on("delete_click",function(){
this.trigger("delete_group")},this)),this.$el.append(this.body.render().$el),this.footer&&(this.$el.append(this.footer.render().$el),this.showFooter(),this.footer.on("footer_click",function(){this.trigger("get_more_click")},this)),this.delegateEvents(),this.trigger("backgrid:rendered",this),this}});return j}),define("modules/chat/views/chat_sidebar/backgrid/row",["underscore","jquery","backgrid","hbs!modules/template/chat/expanded/chat-room-item","backbone","handlebars"],function(a,b,c,d){var e=c.Row.extend({tagName:"div",className:"row chat-item-row padding-4px",render:function(){var a=this.model;return this.$el.append(d({name:a.get("name"),id:a.get("id"),stats:a.get("stats"),show_count:!0})),this.$el.click(function(b){b.stopPropagation(),b.preventDefault(),a.trigger("join_chatroom")}),this.delegateEvents(),this}});return e}),define("modules/chat/views/chat_sidebar/backgrid/cell",["underscore","jquery","backgrid","backbone","handlebars"],function(a,b,c){var d=c.StringCell.extend({tagName:"div",className:"body",render:function(){this.model;return this.$el.val("hahaha"),this}});return d}),define("modules/chat/views/chat_sidebar/chatroom_collection_proxy",["modules/model/common/mig33_collection","modules/mig33_app","modules/common/config","modules/common/utility","underscore","underscore.string","backbone","modules/globals/url"],function(a,b,c,d,e,f,g,h){var i=g.Model.extend({idAttribute:"id"}),j=a.extend({model:i,comparator:function(a){return a.get("name")},initialize:function(a,b){this.chat_room_category=b.chatroom_category,this.attachCategoryEventListener(this.chat_room_category)},isRecentCategory:function(){return this.chat_room_category.isRecentCategory()},addChatRoom:function(a){var b=a.get("chatRoomId");this.add({id:b,name:a.getDisplayName(),stats:a.getDisplayCount()});var c=this.get(b);c&&c.on("join_chatroom",function(){a.join_chatroom()},this)},removeChatRoom:function(a){var b=this.get(a.get("chatRoomId"));b&&this.remove(b)},attachCategoryEventListener:function(a){a.on("chatroom_added",function(a){this.addChatRoom(a)},this),a.on("chatroom_removed",function(a){this.removeChatRoom(a)},this),a.on("reset",function(){var b=this;this.reset([]),a.chatRooms.each(function(a){b.addChatRoom(a)})},this)}});return j}),define("modules/chat/views/chat_sidebar/chatroom_grid",["modules/chat/models/user_session","modules/chat/models/chatrooms","handlebars","modules/common/utility","modules/chat/views/content_window_helper","hbs!modules/template/chat/expanded/chat-room-item","backgrid","modules/chat/views/chat_sidebar/backgrid/grid","modules/chat/views/chat_sidebar/backgrid/row","modules/chat/views/chat_sidebar/backgrid/cell","modules/chat/views/chat_sidebar/chatroom_collection_proxy","underscore","backbone","jquery","jquery.mCustomScrollbar"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=32,o=(a.Session.getInstance(),b.ChatRoomCategoryStore.getInstance()),p=function(a){this.$el=$(a),this.$el.mCustomScrollbar({scrollInertia:150,advanced:{updateOnContentResize:!0},autoHideScrollbar:!0}),this.grids={},this.setup_chatroom_category_store_events()},q=p.prototype;return l.extend(q,m.Events),l.extend(q,{setupCategory:function(a){var b=a.get("name"),c=a.get("categoryId"),e=new k([],{chatroom_category:a}),f=new h({row:i,columns:[{name:"name",label:b,editable:!1,cell:j}],emptyText:a.isFavouriteCategory()?d.translate("chat|empty-chatroom-category"):null,collection:e});f.on("refresh_click",function(){o.refresh_chatroom_category(c,!0)}),f.on("get_more_click",function(){o.refresh_chatroom_category(c,!1)}),a.on("refresh_start",function(a){this.$el.addClass("loading-chatroom")},this),a.on("empty_refresh",function(a){f.removeLoadMore()},this),a.on("refresh_stop",function(a){this.$el.removeClass("loading-chatroom")},this);var g=f.render().$el;this.$el.find(".mCSB_container").append(g),a.isRecentCategory()&&g.hide()},removeCategory:function(a){},resize:function(a,b){this.$el.height(a-n)},setup_chatroom_category_store_events:function(){var a=this;o.on("chatroom_category_added",function(b){a.setupCategory(b)},this),o.on("chatroom_category_removed",function(b){a.removeCategory(b)},this),o.on("chatroom_load_complete",function(){},this)}}),p}),define("modules/chat/views/chat_sidebar/chatroom_area",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/chat/expanded/chat-room-area","modules/chat/views/chat_sidebar/chatroom_grid","modules/chat/views/content_window_helper","modules/common/config","modules/common/utility","modules/chat/models/chatrooms","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m="on",n=!1,o="",p=l.ChatRoomCategoryStore.getInstance(),q=e.ItemView.extend({template:{type:"handlebars",template:g},initialize:function(){a.bindAll(this),this._chatroom_list_view=null,this.listenToChatRoomCategory()},listenToChatRoomCategory:function(){p.on("chatroom_notification",function(a){n=!0,this.chatroom_stat=o=a,this.showChatRoomStat()},this)},events:{"click .create-chatroom-btn":"_doShowCreateChatRoom","keyup .search-input":"_searchKeyUp","click .search-btn":"_doSearchChatRoom"},_doShowCreateChatRoom:function(a){a.preventDefault(),i.show_window("create_new_chatroom")},_searchKeyUp:function(a){var c=b(".search-input",this.$el),d=!1;13==a.keyCode&&(this._doSearchChatRoom(),d=!0),27==a.keyCode&&(d=!0),d&&(c.val(""),c.blur())},_doSearchChatRoom:function(a){a&&a.preventDefault();var c=b.trim(b(".search-input",this.$el).val());""!==c?i.show_window("search_chat_room_w_param",c,k.getLanguage(),m):i.show_window("search_chat_room")},onRender:function(){this._chatroom_list_view=new h(b(".chatroom-list",this.$el)),n&&(this.chatroom_stat=o,this.showChatRoomStat())},showChatRoomStat:function(){this.chatroom_stat=o;var a,c,d,e;a=this.chatroom_stat.split(" users. "),c=a[0],a[1]&&(a=a[1].split(" rooms. "),d=a[0]),a[1]&&(a=a[1].split(" groups."),e=a[0]),c&&d&&e&&(b(".user-count",this.$el).text(c),b(".rooms-count",this.$el).text(d),b(".groups-count",this.$el).text(e))},resize:function(a,b){this._chatroom_list_view&&(a-=this.$el.find(".chat-search").height()+this.$el.find(".chat-footer").height()+5,this._chatroom_list_view.resize(a,b))}});return(a.isUndefined(window.mig33)||a.isNull(window.mig33))&&(window.mig33={}),window.mig33.chatroom_manager||(window.mig33.chatroom_manager={}),window.mig33.chatroom_manager.join_chatroom=function(a,b){"undefined"==typeof b&&(b=!1),i.close_window(),p.join_chatroom_by_name(a,!1,b)},window.mig33.chatroom_manager.send_pin_item=function(a,b){p.send_pin_item(a,b)},window.mig33.facebook_auth=function(a){window.open(a,"FacebookAuthentication","status=no,height=500,width=500,resizable=yes,left="+(screen.width-500)/2+",top="+(screen.height-500)/2+",toolbar=no,menubar=no,scrollbars=no,location=no,directories=no").focus()},q}),define("hbs!modules/template/chat/expanded/tabs",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<ul class="nav nav-tabs nav-justified chat-tabs">\n    <li class="active">\n        <a href="#chat-recent-tab" data-toggle="tab" title="'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"chat|side_bar_recents_tab",g):i.call(b,"translate","chat|side_bar_recents_tab",g)))+'">\n            <span class="icon-wb_recent"></span>\n            <span class="unread-chats-badge badge font-size-12 hidden">0</span>\n        </a>\n    </li>\n    <li>\n        <a href="#chat-contacts-tab" data-toggle="tab" title="'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"chat|side_bar_contacts_tab",g):i.call(b,"translate","chat|side_bar_contacts_tab",g)))+'">\n            <span class="icon-wb_friend"></span>\n        </a>\n    </li>\n    <li>\n        <a href="#chat-chatrooms-tab" data-toggle="tab" title="'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"chat|side_bar_chatrooms_tab",g):i.call(b,"translate","chat|side_bar_chatrooms_tab",g)))+'">\n            <span class="icon-wb_chat"></span>\n        </a>\n    </li>\n</ul>\n<div class="tab-content">\n<div class="tab-pane active" id="chat-recent-tab">\n    <div class="chat-item">\n\n    </div>\n    <div class="chat-footer font-size-12 padding-8px">\n        <div class="row">\n            <div class="col-xs-10">\n                <a href="#">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"chat|start_a_new_chat",g):i.call(b,"translate","chat|start_a_new_chat",g)))+'</a>\n            </div>\n            <div class="col-xs-2 text-right">\n                <a href="#"><span class="icon-wb_addchat"></span></a>\n            </div>\n        </div>\n    </div>\n</div>\n<div class="tab-pane" id="chat-chatrooms-tab">\n    <div class="chat-search">\n        <div class="row">\n            <div class="col-xs-10 no-padding-right">\n                <div class="input-group">\n                    <input type="text" class="form-control input-xs" placeholder="Search Chat Rooms">\n\n                    <div class="input-group-btn">\n                        <button type="button" class="btn btn-xs btn-default btn-default-white">\n                            <span class="icon-wb_search font-color-grey"></span>\n                        </button>\n                    </div>\n                </div>\n            </div>\n            <div class="col-xs-2 no-padding-left">\n                <div class="chat-settings text-center">\n                    <a href="#"><span class="icon-wb_setting font-color-grey"></span></a>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class="row font-size-12 user-stats">\n        <div class="col-xs-4 text-center user-stat">\n            <span class="count">--</span>\n            &nbsp;\n            Users\n        </div>\n        <div class="col-xs-4 text-center user-stat">\n            <span class="count">--</span>\n            &nbsp;\n            Rooms\n        </div>\n        <div class="col-xs-4 text-center user-stat">\n            <span class="count">--</span>\n            &nbsp;\n            Groups\n        </div>\n    </div>\n    <div class="chat-item">\n\n    </div>\n    <div class="chat-footer font-size-12 padding-8px">\n        <div class="row">\n            <div class="col-xs-10">\n                <a href="#">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"chat|contact-menu-create-chatroom",g):i.call(b,"translate","chat|contact-menu-create-chatroom",g)))+'</a>\n            </div>\n            <div class="col-xs-2 text-right">\n                <a href="#"><span class="icon-wb_addchats"></span></a>\n            </div>\n        </div>\n    </div>\n</div>\n<div class="tab-pane" id="chat-contacts-tab">\n    <div class="chat-search">\n        <div class="row">\n            <div class="col-xs-10 no-padding-right">\n                <div class="input-group">\n                    <input type="text" class="form-control input-xs" placeholder="Search">\n\n                    <div class="input-group-btn">\n                        <button type="button" class="btn btn-xs btn-default">\n                            <span class="icon-wb_search font-color-grey"></span>\n                        </button>\n                    </div>\n                </div>\n            </div>\n            <div class="col-xs-2 no-padding-left">\n                <div class="chat-settings text-center">\n                    <a href="#"><span class="icon-wb_setting font-color-grey"></span></a>\n                </div>\n            </div>\n        </div>\n    </div>\n    <div class="chat-item">\n\n    </div>\n    <div class="chat-footer font-size-12 padding-8px">\n        <div class="row">\n            <div class="col-xs-10">\n                <a href="#">Find Friends</a>\n            </div>\n            <div class="col-xs-2 text-right">\n                <a href="#"><span class="icon-wb_addppl"></span></a>\n            </div>\n        </div>\n    </div>\n</div>\n</div>'})}),define("modules/chat/views/chat_sidebar/tab_area",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/chat/expanded/tabs","modules/common/config","modules/common/utility","modules/chat/data/offline","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j){var k=e.ItemView.extend({template:{type:"handlebars",template:g},initialize:function(){a.bindAll(this)},events:{},onRender:function(){this.bindTabEvents(),console.log("Tab got rendered"),b("ul.chat-tabs li a",this.$el).qtip({content:{text:function(){return b(this).data("title")?b(this).data("title"):b(this).attr("title")}},position:{my:"bottom center",viewport:b(window),at:"top center",adjust:{method:"shift none"}},style:{classes:"qtip-post",def:!1},overwrite:!1}),this.attachOfflineNotification()},attachOfflineNotification:function(){var a=new j.OfflineView;this.$el.find(".tab-content").append(a.getElement())},setUnreadCount:function(a){b(".unread-chats-badge",this.$el).text(a+""),a=parseInt(a,10),0===a?b(".unread-chats-badge",this.$el).addClass("hidden"):b(".unread-chats-badge",this.$el).removeClass("hidden")},bindTabEvents:function(){var a=this;b('a[data-toggle="tab"]',this.$el).on("shown.bs.tab",function(b){a.trigger("tabSelect")})}});return k}),define("modules/chat/views/chat_summary",["modules/chat/config/config_ts","modules/chat/models/user_session","modules/common/utility","underscore","backbone","modules/globals/session_user","jquery"],function(a,b,c,d,e,f){var g=a.config,h=b.Session.getInstance(),i=30,j={};for(var k in g.Presence)Object.prototype.hasOwnProperty.call(g.Presence,k)&&(j[g.Presence[k]]=k);var l=function(a){this.$el=a,this.$status_input=$(".status-msg",a),this.$presence_change_links=$("ul#presence-list span.status",a).parent(),this.init()};return d.extend(l.prototype,e.Events),d.extend(l.prototype,{init:function(){if(f){this.$status_input.val(f.status_message);var a=this;this.$status_input.keyup(function(b){13==b.keyCode&&(a.set_status_message(),a.$status_input.blur()),27==b.keyCode&&(a.$status_input.val(f.status_message),a.$status_input.blur())}),this.$status_input.on("focus",function(b){d.delay(function(){a.$status_input.select()},0),b.preventDefault(),b.stopPropagation()}),this.$status_input.on("blur",function(){a.set_status_message()}),this.$presence_change_links.click(function(a){a.preventDefault();var b=$("span.status",this).attr("class"),c=b.match(/(fusion-(\S+))/);c&&h.setPresence(g.Presence[c[2]])}),h.on("change:presence",this.set_presence,this)}},set_presence:function(a,b){$(".current-presence .status",this.$el).removeAttr("class").addClass("status fusion-"+j[b])},set_status_message:function(){var a=this.$status_input.val();a=$.trim(a),""!==a&&a!==f.status_message&&(c.send_event_to_ga("Chat","Sidebar","Set Status Message"),h.set_status_message(a),c.show_success(c.translate("chat|status_message_set")))},resize:function(a){this.$status_input.width(a-i)},resetResize:function(){this.$status_input.removeAttr("style")}}),l}),define("modules/model/badge/badge_model",["underscore","backbone","modules/mig33_app","modules/common/config","modules/common/utility"],function(a,b){var c=b.Model.extend({});return c}),define("modules/chat/views/chat_sidebar/chat_list_item_model",["modules/model/common/mig33_collection","modules/mig33_app","modules/common/config","modules/common/utility","modules/model/badge/badge_model","underscore","underscore.string","backbone","modules/globals/url","modules/chat/models/chats","modules/chat/models/chatrooms"],function(a,b,c,d,e,f,g,h,i,j,k){var l=k.ChatRoomCategoryStore.getInstance(),m=j.ChatStoreModel.getInstance(),n=36,o=36,p=h.Model.extend({idAttribute:"chat_handle"}),q=a.extend({model:p,comparator:function(a){return-1*a.get("sortOrder")},initialize:function(){m.on("chat_added",function(a){this.addFromChatModel(a),this.listenToChatModel(a)},this),m.on("chat_left",function(a){this.remove(a.get("chatHandle"))},this),m.on("chat_updated",function(a){console.log("A chat was updated")},this),l.on("chatroom_joined",function(a){this.addFromChatModel(a),this.listenToChatModel(a)},this),l.on("chatroom_display",function(a){this.addFromChatModel(a),this.listenToChatModel(a),this.trigger("focus_chat",a)},this),l.on("chatroom_left",function(a){this.remove(a.get("chatHandle"))},this)},addFromChatModel:function(a){var b=a.getTitle(),c=a.getDigestMessgeTimeStamp(),d=a.is_fusion_chat()?a.getTitle():"default";this.add({chatname:g.truncate(b,40),is_chatroom:a.is_chat_room(),is_group_chat:a.is_group_chat(),is_private_chat:!(a.is_chat_room()||a.is_group_chat()),chat_handle:a.get("chatHandle"),display_pic:i.image+"/dp/"+d+"?w="+n+"&h="+o+"&a=1&c=1",sortOrder:a.getSortOrder(),unreadCount:this._getUnreadCount(a),displayTime:this._parseTime(c),fullTime:this._parseFullTime(c),lastMessage:this._parseLastMessage(a.getDigestMessageString()),timeInt:c});var e=this.get(a.get("chatHandle"));e.off("chat_list_click"),e.off("chat_list_close_click"),e.on("chat_list_click",function(b){this.trigger("focus_chat",a)},this),e.on("chat_list_close_click",function(){a.leave_chatroom()},this)},_getViewModel:function(a){return this.get(a.get("chatHandle"))},updateTitle:function(a){var b=a.getTitle();b=g.truncate(b,40);var c=this._getViewModel(a);c&&c.set({chatname:b})},_getUnreadCount:function(a){var b=a.get_unread_message_count();return b>0&&99>b?b+"":b>99?"99+":a.is_chat_synched()?"":"1+"},setUnreadCount:function(a){var b=this._getViewModel(a);b&&(b.set({unreadCount:this._getUnreadCount(a)}),this.trigger("unread_message_count_changed",this.get_unread_chat_count()))},get_unread_chat_count:function(){var a=0;return this.each(function(b){b&&b.get("unreadCount")&&(a+=1)}),a},setSyncStatus:function(a){var b=this._getViewModel(a);b&&b.setUnreadCount(a)},numDaysBetween:function(a,b){var c=Math.abs(a.getTime()-b.getTime());return c/864e5},_parseFullTime:function(a){var b="ddd mmm dd yyyy HH:MM:ss",c=d.dateFormat(a,b);return c},_parseTime:function(a){if(!f.isUndefined(a)&&!f.isNull(a)){var b=new Date(+a),c=new Date;c.setHours(0,0,0,0);var e="dd mmm";b>c?e="HH:MM":this.numDaysBetween(c,b)<=7&&(e="ddd");var g=d.dateFormat(a,e);return g}},setMessageTime:function(a,b){a.set({timeInt:b,displayTime:this._parseTime(b),fullTime:this._parseFullTime(b)})},_parseLastMessage:function(a){return a=d.htmlDecode(a)},setLastMessage:function(a,b){a.set({lastMessage:this._parseLastMessage(b)})},listenToChatModel:function(a){a.on("chat_became_latest",function(){var b=this._getViewModel(a)?this._getViewModel(a):a;this.trigger("chat_became_latest",b)},this),a.is_group_chat()&&(a.on("participant_added",function(){this.updateTitle(a)},this),a.on("change:destinationName",function(){this.updateTitle(a)},this)),a.on("unread_message_count_changed",function(){this.setUnreadCount(a)},this),a.on("update_sync_status",function(b){this.setSyncStatus(a)},this),a.on("chat_message_added",function(){var b=this._getViewModel(a);this.setMessageTime(b,a.getDigestMessgeTimeStamp()),this.setLastMessage(b,a.getDigestMessageString())},this),a.on("digest_change",function(){var b=this._getViewModel(a);this.setMessageTime(b,a.getDigestMessgeTimeStamp()),this.setLastMessage(b,a.getDigestMessageString())},this)}});return new q}),define("hbs!modules/template/chat/chat-panel",["handlebars"],function(a){return a.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},'\n<div class="chat-collapsed">\n	<div class="chat-profile-collapsed">\n\n    </div>\n    <div class="chat-recent padding-4px text-center">\n        <span class="icon-wb_chatbubble"></span>\n    </div>\n	<div id="chat-recent-tab-collapsed">\n\n    </div>\n</div>\n<div class="chat-expanded">\n<div class="chat-profile-area">\n</div>\n<div class="tab-area">\n</div>\n<div class="tab-content">\n    <div class="tab-pane active" id="chat-recent-tab">\n    </div>\n    <div class="tab-pane" id="chat-chatrooms-tab">\n    </div>\n    <div class="tab-pane" id="chat-contacts-tab">\n    </div>\n</div>\n</div>'})}),function(a){a.fn.mask=function(b,c){a(this).each(function(){if(void 0!==c&&c>0){var d=a(this);d.data("_mask_timeout",setTimeout(function(){a.maskElement(d,b)},c))}else a.maskElement(a(this),b)})},a.fn.unmask=function(){a(this).each(function(){a.unmaskElement(a(this))})},a.fn.isMasked=function(){return this.hasClass("masked")},a.maskElement=function(b,c){void 0!==b.data("_mask_timeout")&&(clearTimeout(b.data("_mask_timeout")),b.removeData("_mask_timeout")),b.isMasked()&&a.unmaskElement(b),"static"==b.css("position")&&b.addClass("masked-relative"),b.addClass("masked");var d=a('<div class="loadmask"></div>');if(navigator.userAgent.toLowerCase().indexOf("msie")>-1&&(d.height(b.height()+parseInt(b.css("padding-top"))+parseInt(b.css("padding-bottom"))),d.width(b.width()+parseInt(b.css("padding-left"))+parseInt(b.css("padding-right")))),navigator.userAgent.toLowerCase().indexOf("msie 6")>-1&&b.find("select").addClass("masked-hidden"),b.append(d),void 0!==c){var e=a('<div class="loadmask-msg" style="display:none;"></div>');e.append("<div>"+c+"</div>"),b.append(e),e.css("top",Math.round(b.height()/2-(e.height()-parseInt(e.css("padding-top"))-parseInt(e.css("padding-bottom")))/2)+"px"),e.css("left",Math.round(b.width()/2-(e.width()-parseInt(e.css("padding-left"))-parseInt(e.css("padding-right")))/2)+"px"),e.show()}},a.unmaskElement=function(a){void 0!==a.data("_mask_timeout")&&(clearTimeout(a.data("_mask_timeout")),a.removeData("_mask_timeout")),a.find(".loadmask-msg,.loadmask").remove(),a.removeClass("masked"),a.removeClass("masked-relative"),a.find("select").removeClass("masked-hidden")}}(jQuery),define("jquery.loadmask",["jquery"],function(){});var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};define("modules/chat/views/chat_view",["require","exports","modules/chat/config/config_ts","modules/chat/views/chat_sidebar/profile_header","modules/chat/views/chat_sidebar/collapsed_profile_header","modules/chat/views/chat_sidebar/recent_chat_area","modules/chat/views/chat_sidebar/collapsed_recent_chat_area","modules/chat/views/chat_sidebar/contact_area","modules/chat/views/chat_sidebar/chatroom_area","modules/chat/views/chat_sidebar/tab_area","modules/chat/views/chat_summary","modules/chat/views/chat_sidebar/chat_list_item_model","modules/common/config","modules/common/utility","hbs!modules/template/chat/chat-panel","backbone.marionette","jquery.loadmask"],function(a,b,c){var d=a("underscore"),e=a("jquery"),f=(a("modules/common/utility"),a("handlebars")),g=a("modules/chat/views/chat_sidebar/profile_header"),h=a("modules/chat/views/chat_sidebar/collapsed_profile_header"),i=a("modules/chat/views/chat_sidebar/recent_chat_area"),j=a("modules/chat/views/chat_sidebar/collapsed_recent_chat_area"),k=a("modules/chat/views/chat_sidebar/contact_area"),l=a("modules/chat/views/chat_sidebar/chatroom_area"),m=a("modules/chat/views/chat_sidebar/tab_area"),n=(a("modules/chat/views/chat_summary"),a("modules/chat/views/chat_sidebar/chat_list_item_model")),o=a("hbs!modules/template/chat/chat-panel"),p=c.config,q=10,r="#main-header",s='<div class="offline-ui offline-ui-down offline-ui-disconnect"><div class="offline-ui-content-empty">{{message}}</div><a href="" class="btn btn-xs btn-default login-btn">LOGIN</a></div>',t=f.compile(s),u=function(b){function c(a){this.regions={profile_header:".chat-profile-area",collapsed_profile_header:".chat-profile-collapsed",collapsed_counter_area:".chat-recent",collapsed_recent_chat_area:"#chat-recent-tab-collapsed",recent_chat_area:"#chat-recent-tab",chatroom_area:"#chat-chatrooms-tab",contact_area:"#chat-contacts-tab",tab_area:".tab-area"},this.template={type:"handlebars",template:o},this.events={"click .chat-recent":"expand","click #chat-recent-tab-collapsed":"expand"},b.call(this,a)}return __extends(c,b),c.prototype.initialize=function(){d.bindAll(this),this.model=new Backbone.Model({}),this._bindSessionEvents(),this.showing_force_logout_dialog=!1,this.render(),this._initProfileHeader(),this._initTabArea(),this._initRecentChatArea(),this._initChatRoomArea(),this._initContactArea()},c.prototype._initProfileHeader=function(){var a=new g({model:null});this.profile_header.show(a);var b=new h({model:null});this.collapsed_profile_header.show(b),a.on("toggleCollapse",this.collapse),b.on("toggleCollapse",this.expand)},c.prototype.collapse=function(){e(".chat-expanded",e("#chat")).hide(),e(".chat-collapsed",e("#chat")).show(),this.trigger("chat_view_expanded"),d.delay(d.bind(this.resize,this),10)},c.prototype.expand=function(){e(".chat-collapsed",e("#chat")).hide(),e(".chat-expanded",e("#chat")).show(),this.trigger("chat_view_collapsed"),d.delay(d.bind(this.resize,this),10)},c.prototype._resize_chat_area=function(){},c.prototype._initTabArea=function(){var a=new m({model:null});this._tab_area=a,this.tab_area.show(a),a.on("tabSelect",function(){this.debouncedResize&&this.debouncedResize()},this)},c.prototype._initRecentChatArea=function(){var a=new j({model:new Backbone.Model,collection:n});this.collapsed_recent_chat_area.show(a);var b=new i({model:new Backbone.Model,collection:n});n.on("unread_message_count_changed",function(a){this._tab_area.setUnreadCount(a)},this),this.recent_chat_area.show(b);this.on("resize",function(c,d,e){a.resize(e,d),b.resize(c,d)},this);var c=function(a){this.trigger("focus_chat",a)};n.on("focus_chat",c,this)},c.prototype._getCollapsedDecoratorHeight=function(){var a=e(".chat-recent",this.$el).height()||0;return(this.collapsed_profile_header.$el.height()||0)+a},c.prototype._getDecoratorHeight=function(){return this.profile_header.$el.height()+e(".chat-tabs",this.tab_area.$el).height()+10||0},c.prototype._initChatRoomArea=function(){var a=new l;this.chatroom_area.show(a);this.on("resize",function(b,c){a.resize(b,c)},this)},c.prototype._initContactArea=function(){var a=new k;this.contact_area.show(a);this.on("resize",function(b,c){a.resize(b,c)},this)},c.prototype._bindSessionEvents=function(){var b=a("modules/chat/models/user_session"),c=b.Session.getInstance();c.on("session_created",function(){this.listenToChatListEvents()},this),c.on("session_startup_completed",function(){e("#chat-bar").unmask()},this),c.on("logout_forced",function(a){c.user_logout(!0)},this)},c.prototype._showForcedLogoutMessage=function(a){if(!this.showing_force_logout_dialog){this.showing_force_logout_dialog=!0;var b=t({message:a}),c=e(b),d=c.find(".login-btn");d.click(function(a){a.preventDefault(),window.location=p.logout_url}),c.appendTo(e("body")),c.show()}},c.prototype.onRender=function(){this.text_area=e(".add-participant-input",this.$el),this.is_rendered=!0,this.trigger("after_render"),this.debouncedResize=d.debounce(d.bind(this.resize,this),100),e(window).on("resize",this.debouncedResize);var a=this;d.defer(function(){a.resize(),a.trigger("chat_view_ready")})},c.prototype.getHeight=function(){return e(window).height()-q},c.prototype.resize=function(){var a=null,b=e(window).height()-e(r).height()-40,c=b-this._getDecoratorHeight(),d=e(window).height()-this._getCollapsedDecoratorHeight();this.trigger("resize",c,a,d)},c.prototype.bringToTop=function(){},c.prototype.setZIndex=function(a){this.$el.css({zIndex:a})},c.prototype.getSideBarWidth=function(){return this.$el.width()},c.prototype._isPanelMinimized=function(){return!1},c.prototype._showChatHistoryTab=function(){var a=this.$(".nav-tabs li.messages a").first().attr("href");this.toggleTabs(a)},c.prototype.toggleTabs=function(a){var b=this.$(a);b.is(":visible")||(this.$(".nav-tabs li").removeClass("active"),this.$(".tab-pane").not(b).removeClass("active"),b.addClass("active"),this.$(a+"-tab").addClass("active"),this.trigger("show_tab"))},c.prototype.get$Element=function(){return this.$el},c.prototype.resizeChat=function(a,b){},c.prototype.listenToChatListEvents=function(){},c.prototype.showMessagesTab=function(){},c}(Marionette.Layout);b.ChatView=u});var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};define("modules/window_manager",["require","exports","./chat/models/user_session","./chat/models/chatrooms","./chat/models/chats","./chat/views/chatwindow","modules/chat/views/chat_view","modules/export_marionette","backbone.marionette","underscore","jquery","backbone"],function(a,b,c,d,e,f,g){function h(a){l+=20,m+=20;var b=$(window).width(),c=$(window).height();return l>b-$(window).width()*a.getChatWindowWidth&&(l=n),m>c-$(window).height()*f.ChatWindow.CHAT_WINDOW_HEIGHT_PERCENT&&(m=o),{x:l,y:m}}var i=a("underscore"),j=(c.Session.getInstance(),e.ChatStoreModel.getInstance()),k=d.ChatRoomCategoryStore.getInstance(),l=50,m=80,n=l,o=m;!function(a){a[a.MODE_DOCK=1]="MODE_DOCK",a[a.MODE_TEARAWAY=2]="MODE_TEARAWAY"}(b.WINDOW_MODE||(b.WINDOW_MODE={}));var p=(b.WINDOW_MODE,function(a){function b(){a.apply(this,arguments)}return __extends(b,a),Object.defineProperty(b.prototype,"id",{get:function(){return this.get("id")},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"model",{get:function(){return this.get("model")},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"window_model",{get:function(){return this.get("window_model")},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"window",{get:function(){return this.get("window")},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"creation_time",{get:function(){return this.get("creation_time")},enumerable:!0,configurable:!0}),b}(Backbone.Model)),q=function(a){function b(){a.apply(this,arguments),this.model=p}return __extends(b,a),b}(Backbone.Collection),r=8,s=function(){function b(a){if(b._instance)throw"Error: singleton use getInstance()";b._instance=this,i.extend(this,Backbone.Events),this.initialize()}return b.getInstance=function(){return b._instance||(this._instance=new b),this._instance},b.prototype.initialize=function(){this.window_mode=1,this.chat_window_cache=new q([],{comparator:"creation_time"}),this.listenChatWindowResize()},b.prototype.init=function(){this.initChatView(),this.attachAppEvents(),this.attachWindowEvents(),this.attachModelEvents()},b.prototype.attachWindowEvents=function(){var a=this;$(window).resize(function(){a.position_windows()})},b.prototype.attachModelEvents=function(){j.on("user_initiated_chat",this.handleUserInitiatedChat,this),j.on("chat_left",this.handleChatLeave,this),k.on("chatroom_joined",this.handleChatRoomJoined,this)},b.prototype.handleUserInitiatedChat=function(a){var b=this.createOrGetChatWindow(a);this.activateWindow(b)},b.prototype.handleChatRoomJoined=function(a,b){var c=this.createOrGetChatWindow(a);b||this.activateWindow(c),this.attachChatRoomEvents(a)},b.prototype.handleChatLeave=function(a){var b=this.chat_window_cache.get(a.chatHandle);b&&(b.window.close(),this.chat_window_cache.remove(b))},b.prototype.handleChatRoomLeft=function(a){this.detachChatRoomEvents(a);var b=this.chat_window_cache.get(a.chatHandle);b&&(b.window.close(),this.chat_window_cache.remove(b))},b.prototype.attachChatRoomEvents=function(a){var b=this;a.on("chat_activate",function(){var c=b.createOrGetChatWindow(a);b.activateWindow(c)},this),a.on("chatroom_left",this.handleChatRoomLeft,this)},b.prototype.detachChatRoomEvents=function(a){a.off("chat_activate",null,this)},b.prototype.attachChatWindowEvents=function(a){var b=this;a.on("chat_window_accessed",function(a){b.setActiveWindow(a),b.position_windows()}),a.on("chat_window_minimized",function(a){a===b.active_window&&b.setActiveWindow(null),b.position_windows()}),a.on("chat_window_closed",function(a){b.cleanUpAfterClose(a)},this)},b.prototype.cleanUpAfterClose=function(a){a===this.active_window&&this.setActiveWindow(null),a===this.top_window&&(this.top_window=null);var b=a.getChatModel(),c=b.chatHandle;this.chat_window_cache.remove(this.chat_window_cache.get(c)),
this.position_windows()},b.prototype.createOrGetChatWindow=function(a){var b=a.chatHandle,c=this.chat_window_cache.get(b);if(!c){var d=f.ChatViewModel.createChatViewModel(a),e=new f.ChatWindow({model:d,chat_model:a});e.on("chat_window_rendered",i.bind(this.position_windows,this)),this.attachChatWindowEvents(e),this.chat_window_cache.add({id:b,model:a,window_model:f.ChatViewModel.createChatViewModel(a),window:e,creation_time:Date.now()}),c=this.chat_window_cache.get(b)}return c.window},b.prototype.activateWindow=function(a){var b=!1;a.isWindowShown||(this.top_window=a,b=!0,this.showChatWindow(a)),a.isWindowMinimized&&(a.maximize(),b=!0),this.setActiveWindow(a),b&&this.position_windows()},b.prototype.showChatWindow=function(a){if(a.show(this.isTearAwayMode()),this.isTearAwayMode()&&!a.isWindowPositioned){var b=h(a);a.setPosition(b.x,b.y,!1)}},b.prototype.setActiveWindow=function(a){this.active_window&&this.active_window.deactivate(),a&&a.activate(),this.active_window=a},b.prototype.initChatView=function(){var a=this,b=$('<div id="chat" class="hidden-xs"></div>');$("#main-container").prepend(b),this.chat_view=new g.ChatView({el:b}),this.chat_view.on("focus_chat",i.bind(this.focusChatWindow,this)),this.chat_view.on("chat_view_expanded",i.bind(this.position_windows,this)),this.chat_view.on("chat_view_collapsed",i.bind(this.position_windows,this)),this.chat_view.on("chat_view_ready",function(){a.trigger("window_manager_ready")})},b.prototype.attachAppEvents=function(){var b=a("modules/mig33_app");b.vent.on(b.ApplicationEvents.TOGGLE_TEARAWAY,i.bind(this.checkAndActivateTearAway,this))},b.prototype.checkAndActivateTearAway=function(a){a=a?!this.isTearAwayMode():a,a?this.activateTearAwayMode():this.closeTearAwayMode()},b.prototype.activateTearAwayMode=function(){this.window_mode=2,this.trigger("before_enter_tearaway_mode"),this.tearAwayChatWindows(),this.trigger("enter_tearaway_mode"),this.trigger("state_change")},b.prototype.closeTearAwayMode=function(){this.window_mode=1,this.dockChatWindows(),this.trigger("enter_dock_mode"),this.trigger("state_change")},b.prototype.tearAwayChatWindows=function(){this.chat_window_cache.each(function(a){var b=a.window;b.toggleFloat(!0);var c=b.getPosition();b.setPosition(c.x,c.y-30,!1)})},b.prototype.dockChatWindows=function(){this.chat_window_cache.each(function(a){var b=a.window;b.toggleFloat(!1)}),this.position_windows()},b.prototype.focusChatWindow=function(a){this.handleUserInitiatedChat(a)},b.prototype.closeChat=function(){},b.prototype.minimizeChat=function(){},b.prototype.position_windows=function(){var a=this;if("undefined"!=typeof this.chat_view&&null!==this.chat_view){var b=this.chat_view.getSideBarWidth(),c=0;this.isTearAwayMode()||(c=this.top_window?$(window).width()*this.top_window.getChatWindowWidth+r:0);var d=this.get_chat_stack_width(),e=$(window).width()-(b+c+d),g=$(window).width()-(e+b),h=$(window).width()-b,i=0,j=0;if(this.chat_window_cache.each(function(b){var c=b.window;c.isWindowMinimized?j=f.ChatWindow.MINIMIZED_WIDTH:(j=c.getWindowWidth(),j=j>f.ChatWindow.CHAT_WINDOW_MINIMUM_WIDTH?j:f.ChatWindow.CHAT_WINDOW_MINIMUM_WIDTH),a.isTearAwayMode()&&!c.isWindowMinimized||(c.isWindowMinimized||c.resetSize(),a.showChatWindow(c),h-j-r>g?(h=h-j-r,c.setPosition(h,i,!0)):c.hide())}),!this.isTearAwayMode()&&this.top_window&&!this.top_window.isWindowShown){var k=0;k=this.top_window.isWindowMinimized?f.ChatWindow.MINIMIZED_WIDTH:$(window).width()*this.top_window.getChatWindowWidth,this.showChatWindow(this.top_window),h=h-j-r,this.top_window.setPosition(h,i,!0)}}},b.prototype.listenChatWindowResize=function(){var a=this;$(window).on("resize",function(){a.position_windows()})},b.prototype.isTearAwayMode=function(){return 2===this.window_mode},b.prototype.getWindowMode=function(){return this.window_mode},b.prototype.get_chat_stack_width=function(){return 40},b}();b.WindowManager=s}),define("modules/chat/chat_loader",["backbone","modules/chat/config/config_ts","modules/chat/data/ftransport","modules/chat/models/user_session","modules/window_manager","modules/globals/settings","underscore","jquery"],function(a,b,c,d,e,f){var g=(b.config,d.Session.getInstance()),h=c.Transport.getInstance(),i=e.WindowManager.getInstance(),j={};return j.initializeChatClient=function(){$("#chat-container").removeClass("visible-desktop").addClass("hidden"),f.is_chat_supported&&$(function(){i.on("window_manager_ready",function(){g.init()}),h.initialize(),i.init(),$(".action-logout").on("click",function(a){a.preventDefault(),g.user_logout(!0)})})},j}),define("hbs!modules/template/common/header-layout",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){return"\n		"}function g(a,b){var d,e,f="";return f+='\n			<a href="" title="'+q((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"login|signup",e):p.call(a,"translate","login|signup",e)))+'" class="navbar-brand navbar-right-link navbar-signup"><span class="">'+q((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"login|signup",e):p.call(a,"translate","login|signup",e)))+'</span></a>\n			<a href="" title="'+q((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"login|signin",e):p.call(a,"translate","login|signin",e)))+'" class="navbar-brand navbar-right-link navbar-signin"><span class="">'+q((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"login|signin",e):p.call(a,"translate","login|signin",e)))+"</span></a>\n		"}function h(a,b){var d,e,f="";return f+='\n				<!-- <div class="dropdown-container dropdown">\n\n					//migalert \n					<a href="#" class="migalerts-dropdown dropdown-toggle" data-toggle="dropdown" title="'+q((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"migalert|migalerts",e):p.call(a,"translate","migalert|migalerts",e)))+'">\n						<span class="icon-wb_alert"></span>\n						<span class="badge migalerts-unread-count"></span>\n					</a>\n					<div id="migalertsMobile" class="dropdown-menu"></div>\n\n					//invite friends\n					<a href="#" id="invite-friends-trigger" class="invite-friends-modal dropdown-toggle" data-toggle="modal" data-target="#invite-friends-modal" title="'+q((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"invite|invite",e):p.call(a,"translate","invite|invite",e)))+'">\n						<span class="icon-wb_userinvite"></span>\n					</a>\n					<div id="inviteFriendsMobile" class="dropdown-menu"></div> \n				</div>-->\n				<a id="home-logo" class="navbar-brand" href="/home" title="mig.me"><span class="icon-wb_home logo"></span></a>\n			'}function i(a,b){return'\n				<a href="/home" title="mig.me" class="navbar-brand"><span class="logo bypass-login"></span></a>\n			'}function j(a,b){var d,e,f="";return f+='\n			<li class="more-options-dropdown dropdown">\n				<a href="#" class="dropdown-toggle icon-wb_more" data-toggle="dropdown" title="'+q((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"chat|more_options",e):p.call(a,"translate","chat|more_options",e)))+'">\n					<span class="hidden-xs"></span>\n					<img class="img-inline visible-xs img-circle" src="'+q((d=c.getSessionUserDisplayPictureUrl||a&&a.getSessionUserDisplayPictureUrl,e={hash:{},data:b},d?d.call(a,40,40,e):p.call(a,"getSessionUserDisplayPictureUrl",40,40,e)))+'"/>\n				</a>\n				<ul class="dropdown-menu normal-dropdown-menu">\n					<li class="visible-xs">\n						<a href="'+q((d=c.getSessionUser||a&&a.getSessionUser,e={hash:{},data:b},d?d.call(a,"personalized_url",e):p.call(a,"getSessionUser","personalized_url",e)))+'" title="'+q((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"common|me",e):p.call(a,"translate","common|me",e)))+'">\n							<span class="icon-wb_account"></span>\n							&nbsp;\n							'+q((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"user|view_profile",e):p.call(a,"translate","user|view_profile",e)))+'\n						</a>\n					</li>\n					<li>\n						<a href="/search/users/">\n							<span class="icon-wb_add"></span>\n							&nbsp;\n							'+q((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"chat|find-more-people",e):p.call(a,"translate","chat|find-more-people",e)))+'\n						</a>\n					</li>\n					<li>\n						<a href="/credit">\n							<span class="icon-wb_credit"></span>\n							&nbsp;\n							'+q((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"store|credits",e):p.call(a,"translate","store|credits",e)))+' (<span class="header-account-balance">$0.00</span>)\n						</a>\n					</li>\n					<li class="hidden-xs">\n						<a href="/sites/corporate/merchant/dashboard" data-bypass="true">\n							<span class="icon-wb_merchant"></span>\n							&nbsp;\n							'+q((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"user|label_merchant",e):p.call(a,"translate","user|label_merchant",e)))+'\n						</a>\n					</li>\n					<li>\n						<a href="/sites/ajax/settings/account_profile">\n							<span class="icon-wb_setting"></span>\n							&nbsp;\n							'+q((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"common|settings",e):p.call(a,"translate","common|settings",e)))+'\n						</a>\n					</li>\n					<li>\n						<a href="'+q((d=c.getUrl||a&&a.getUrl,e={hash:{},data:b},d?d.call(a,"site",e):p.call(a,"getUrl","site",e)))+'faq/">\n							<span class="icon-wb_help"></span>\n							&nbsp;\n							'+q((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"common|help",e):p.call(a,"translate","common|help",e)))+'\n						</a>\n					</li>\n					<li class="action-logout">\n						<a href="#" data-bypass="true">\n							<span class="icon-wb_logout"></span>\n							&nbsp;\n							'+q((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"login|logout",e):p.call(a,"translate","login|logout",e)))+'\n						</a>\n					</li>\n				</ul>\n			</li>\n			<li class="nav-profile hidden-xs">\n				<a href="'+q((d=c.getSessionUser||a&&a.getSessionUser,e={hash:{},data:b},d?d.call(a,"personalized_url",e):p.call(a,"getSessionUser","personalized_url",e)))+'" title="'+q((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"common|me",e):p.call(a,"translate","common|me",e)))+'">\n					<img src="'+q((d=c.getSessionUserDisplayPictureUrl||a&&a.getSessionUserDisplayPictureUrl,e={hash:{},data:b},d?d.call(a,40,40,e):p.call(a,"getSessionUserDisplayPictureUrl",40,40,e)))+'" width="40"height="40" class="img-circle" />\n				</a>\n			</li>\n			<li class="chat-mobile-toggle visible-xs">\n				<a href="#">\n					<span class="icon-wb_chatbubble"></span>\n				</a>\n			</li>\n			<li class="migalerts-dropdown dropdown">\n				<a href="#" class="dropdown-toggle" data-toggle="dropdown" title="'+q((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"migalert|migalerts",e):p.call(a,"translate","migalert|migalerts",e)))+'">\n					<span class="icon-wb_alert nav-line-height"></span>\n					<span class="badge migalerts-unread-count"></span>\n					<!-- <span class="navbar-visible-xs">&nbsp;'+q((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"migalert|migalerts",e):p.call(a,"translate","migalert|migalerts",e)))+'</span> -->\n				</a>\n				<div id="migalerts" class="dropdown-menu"></div>\n			</li>\n			'}function k(a,b){return'\n					<li class="store_tag">\n						<a href="/store/">\n							<h3>Store</h3>\n							<p>Buy stickers and gifts!</p>\n						</a>\n					</li>\n					'}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var l,m,n,o="",p=c.helperMissing,q=this.escapeExpression,r=this,s="function",t=c.blockHelperMissing;return o+='<div class="navbar navbar-default navbar-fixed-top" role="navigation">\n	<div class="container">\n		',n={hash:{},inverse:r.program(3,g,e),fn:r.program(1,f,e),data:e},(m=c.ifLoggedIn)?l=m.call(b,n):(m=b&&b.ifLoggedIn,l=typeof m===s?m.call(b,n):m),c.ifLoggedIn||(l=t.call(b,l,{hash:{},inverse:r.program(3,g,e),fn:r.program(1,f,e),data:e})),(l||0===l)&&(o+=l),o+='\n\n		<div class="navbar-header navbar-default left">\n			',n={hash:{},inverse:r.program(7,i,e),fn:r.program(5,h,e),data:e},(m=c.ifLoggedIn)?l=m.call(b,n):(m=b&&b.ifLoggedIn,l=typeof m===s?m.call(b,n):m),c.ifLoggedIn||(l=t.call(b,l,{hash:{},inverse:r.program(7,i,e),fn:r.program(5,h,e),data:e})),(l||0===l)&&(o+=l),o+='\n		</div>\n		<ul class="nav navbar-nav right">\n			',n={hash:{},inverse:r.noop,fn:r.program(9,j,e),data:e},(m=c.ifLoggedIn)?l=m.call(b,n):(m=b&&b.ifLoggedIn,l=typeof m===s?m.call(b,n):m),c.ifLoggedIn||(l=t.call(b,l,{hash:{},inverse:r.noop,fn:r.program(9,j,e),data:e})),(l||0===l)&&(o+=l),o+='\n			\n			<li id="discover-dropdown" class="dropdown">\n				<a href="#" class="dropdown-toggle" data-toggle="dropdown">\n					<span class="icon-wb_world nav-line-height">\n				</a>\n				<ul class="dropdown-menu mega-dropdown-menu discover-mega-dropdown-menu">\n					<li class="discover_tag">\n						<a href="/discover/migworld/" data-silent="true">\n							<h3>Discover</h3>\n							<p>Read interesting stories and share your thoughts</p>\n						</a>\n					</li>\n					<li class="music_tag">\n						<a href="/music">\n							<h3>Music</h3>\n							<p>Listen to our radio channels for the perfect mood</p>\n						</a>\n					</li>\n					<li class="games_tag">\n						<a href="/games">\n							<h3>Games</h3>\n							<p>Check out our list of really fun games</p>\n						</a>\n					</li>\n					',n={hash:{},inverse:r.noop,fn:r.program(11,k,e),data:e},(m=c.ifLoggedIn)?l=m.call(b,n):(m=b&&b.ifLoggedIn,l=typeof m===s?m.call(b,n):m),c.ifLoggedIn||(l=t.call(b,l,{hash:{},inverse:r.noop,fn:r.program(11,k,e),data:e})),(l||0===l)&&(o+=l),o+='\n					<li class="chatroom_tag">\n						<a href="#">\n							<h3>Chatroom</h3>\n							<p>Meet new people and make new friends</p>\n						</a>\n					</li>\n				</ul>\n			</li>\n		</ul>\n		<form class="search-form navbar-form" action="/search" method="get" onsubmit="return false;" role="search">\n			<input type="hidden" name="location" value="posts" />\n				<div class="form-group">\n					<div class="search-form-btn">\n						<span class="icon-wb_search font-size-16"></span>\n					</div>\n					<input type="text" name="search-form-query" placeholder="'+q((m=c.translate||b&&b.translate,n={hash:{},data:e},m?m.call(b,"header|search",n):p.call(b,"translate","header|search",n)))+'" value="" class="form-control" />\n				</div>\n		</form>\n	</div>\n</div>\n'})}),define("modules/model/migalert/migalert_model",["underscore","backbone","modules/mig33_app","modules/common/config","modules/common/utility"],function(a,b,c,d,e){return b.Model.extend({})}),define("modules/common/polyfill",[],function(){var a={};return a.assign=function(){return"function"!=typeof Object.assign?function(a){if(void 0===a||null===a)throw new TypeError("Cannot convert undefined or null to object");for(var b=Object(a),c=1;c<arguments.length;c++){var d=arguments[c];if(void 0!==d&&null!==d)for(var e in d)d.hasOwnProperty(e)&&(b[e]=d[e])}return b}:Object.assign}(),a}),define("modules/model/migalert/migalert_collection",["underscore","modules/model/common/mig33_collection","modules/mig33_app","modules/common/config","modules/common/utility","modules/common/polyfill","modules/model/migalert/migalert_model","modules/common/session_user"],function(a,b,c,d,e,f,g,h){var i=b.extend({model:g,type:"",more:!1,comparator:function(a){return-a.get("timestamp")},url:function(){return e.format(d.urls.alerts_url,h.getInstance().get("id"))+"?offset="+(this.currentPage-1)*d.migalerts.limit+"&limit="+d.migalerts.limit},parse:function(b){return b.data&&!a.isUndefined(b.data.alerts)&&null!==b.data.alerts?(this.more=b.data.alerts.length>=this.limit,this.triggerDisplayAchievementLabelsInHomefeed(b.data.alerts),b.data.alerts):(b.data&&!a.isUndefined(b.data.notification_destinations)&&null!==b.data.notification_destinations&&a.each(b.data.notification_destinations,function(a){return a.type===d.notification_destinations.MIGALERT_TYPE?a.alerts:void 0}),this.more=!1,[])},triggerDisplayAchievementLabelsInHomefeed:function(a){var b=a.filter(function(a){return"NEW_LABEL_ALERT"===a.type}).filter(function(a){var b=864e5,c=new Date(+a.timestamp),d=(new Date).getTime()-b,e=new Date(d);return c>e}).filter(function(a){return!e.isNewLabelAchievementFeedDismissed(a.id)}),c=require("modules/mig33_app");c.vent.trigger(c.ApplicationEvents.NEW_ACHIEVEMENT_LABELS,b)},hasMore:function(){return this.more},setHeader:function(a){a.setRequestHeader("Content-Type","application/vnd.mig33api-v1.5+json;charset=utf-8")}});return i}),define("hbs!modules/template/migalert/migalert-item",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f,h="";return h+='\n	<div class="right no-padding">\n		',e=c.compare||a&&a.compare,f={hash:{},inverse:t.program(10,l,b),fn:t.program(2,g,b),data:b},d=e?e.call(a,a&&a.type,"FOLLOWING_REQUEST",f):q.call(a,"compare",a&&a.type,"FOLLOWING_REQUEST",f),(d||0===d)&&(h+=d),h+="\n	</div>\n"}function g(a,b){var d,e="";return e+="\n			",d=c["if"].call(a,(d=a&&a.variables,d=null==d||d===!1?d:d[0],d=null==d||d===!1?d:d.content,null==d||d===!1?d:d.migLevel),{hash:{},inverse:t.noop,fn:t.program(3,h,b),data:b}),(d||0===d)&&(e+=d),e+="\n		"}function h(a,b){var d,e,f,g="";return g+='\n				<div class="alert-secondary-box text-center text-uppercase">\n					<div class="alert-level padding-4px">\n						'+r((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|miglevel_with_level",(d=a&&a.variables,d=null==d||d===!1?d:d[0],d=null==d||d===!1?d:d.content,null==d||d===!1?d:d.migLevel),f):q.call(a,"translate","user|miglevel_with_level",(d=a&&a.variables,d=null==d||d===!1?d:d[0],d=null==d||d===!1?d:d.content,null==d||d===!1?d:d.migLevel),f)))+'\n					</div>\n					<div class="padding-4px">\n						',d=c["if"].call(a,(d=a&&a.variables,d=null==d||d===!1?d:d[0],d=null==d||d===!1?d:d.content,null==d||d===!1?d:d.gender),{hash:{},inverse:t.noop,fn:t.program(4,i,b),data:b}),(d||0===d)&&(g+=d),g+="\n						",e=c.ifUserCanShowAge||a&&a.ifUserCanShowAge,f={hash:{},inverse:t.noop,fn:t.program(6,j,b),data:b},d=e?e.call(a,(d=a&&a.variables,d=null==d||d===!1?d:d[0],null==d||d===!1?d:d.content),f):q.call(a,"ifUserCanShowAge",(d=a&&a.variables,d=null==d||d===!1?d:d[0],null==d||d===!1?d:d.content),f),(d||0===d)&&(g+=d),g+="\n						",d=c["if"].call(a,(d=a&&a.variables,d=null==d||d===!1?d:d[0],d=null==d||d===!1?d:d.content,null==d||d===!1?d:d.country),{hash:{},inverse:t.noop,fn:t.program(8,k,b),data:b}),(d||0===d)&&(g+=d),g+="\n					</div>\n				</div>\n			"}function i(a,b){var d,e,f,g="";return g+="\n							"+r((e=c.userGetGender||a&&a.userGetGender,f={hash:{},data:b},e?e.call(a,(d=a&&a.variables,d=null==d||d===!1?d:d[0],null==d||d===!1?d:d.content),f):q.call(a,"userGetGender",(d=a&&a.variables,d=null==d||d===!1?d:d[0],null==d||d===!1?d:d.content),f)))+"\n						"}function j(a,b){var d,e,f,g="";return g+="\n							, "+r((e=c.userGetAge||a&&a.userGetAge,f={hash:{},data:b},e?e.call(a,(d=a&&a.variables,d=null==d||d===!1?d:d[0],null==d||d===!1?d:d.content),f):q.call(a,"userGetAge",(d=a&&a.variables,d=null==d||d===!1?d:d[0],null==d||d===!1?d:d.content),f)))+"\n						"}function k(a,b){var c,d="";return d+="\n							<div>"+r((c=a&&a.variables,c=null==c||c===!1?c:c[0],c=null==c||c===!1?c:c.content,c=null==c||c===!1?c:c.country,typeof c===s?c.apply(a):c))+"</div>\n						"}function l(a,b){var d,e,f="";return f+='\n			<div class="alert-secondary-image text-right">\n				',(e=c.alertParseSecondaryImage)?d=e.call(a,{hash:{},data:b}):(e=a&&a.alertParseSecondaryImage,d=typeof e===s?e.call(a,{hash:{},data:b}):e),f+=r(d)+"\n			</div>\n		"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var m,n,o,p="",q=c.helperMissing,r=this.escapeExpression,s="function",t=this,u=c.blockHelperMissing;return p+='<div class="left no-padding">\n	<div class="alert-image">\n		'+r((n=c.alertParseImage||b&&b.alertParseImage,o={hash:{},data:e},n?n.call(b,64,64,o):q.call(b,"alertParseImage",64,64,o)))+"\n	</div>\n</div>\n",o={hash:{},inverse:t.noop,fn:t.program(1,f,e),data:e},(n=c.ifHasSecondaryImage)?m=n.call(b,o):(n=b&&b.ifHasSecondaryImage,m=typeof n===s?n.call(b,o):n),c.ifHasSecondaryImage||(m=u.call(b,m,{hash:{},inverse:t.noop,fn:t.program(1,f,e),data:e})),(m||0===m)&&(p+=m),p+='\n<div class="alert-content no-padding-right">\n	<div ',n=c.alertParseActionURL||b&&b.alertParseActionURL,o={hash:{},data:e},m=n?n.call(b,"web",o):q.call(b,"alertParseActionURL","web",o),(m||0===m)&&(p+=m),p+='>\n		<span class="alert-title font-size-14">',n=c.alertParseMessage||b&&b.alertParseMessage,o={hash:{},data:e},m=n?n.call(b,"web",o):q.call(b,"alertParseMessage","web",o),(m||0===m)&&(p+=m),p+='</span>\n		<span class="alert-time font-size-12"><time class="timeago" datetime="'+r((n=c.dateFormat||b&&b.dateFormat,o={hash:{},data:e},n?n.call(b,b&&b.timestamp,"isoUtcDateTime",o):q.call(b,"dateFormat",b&&b.timestamp,"isoUtcDateTime",o)))+'">'+r((n=c.getRelativeTimestamp||b&&b.getRelativeTimestamp,o={hash:{},data:e},n?n.call(b,b&&b.timestamp,o):q.call(b,"getRelativeTimestamp",b&&b.timestamp,o)))+'</time></span>\n	</div>\n	<span class="alert-actions font-size-14">',n=c.alertParseAction||b&&b.alertParseAction,o={hash:{},data:e},m=n?n.call(b,"web",o):q.call(b,"alertParseAction","web",o),(m||0===m)&&(p+=m),p+="</span>\n</div>"})}),define("modules/view/migalert/migalert_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/migalert/migalert-item","modules/common/config","modules/common/utility","modules/chat/models/chats","modules/template/helpers/general_helpers","jquery.timeago"],function(a,b,c,d,e,f,g,h,i,j){var k=e.ItemView.extend({template:{type:"handlebars",template:g},initialize:function(){a.bindAll(this)},id:function(){return"alert-"+this.model.get("id")},tagName:"li",className:"clearfix migalert",events:{'click a[data-type="API"]':"callApi","click a":"overwrite",'click div[data-type="REDIRECT"]':"redirectTo",'click div[data-type="URL"]':"navigateTo",'click div[data-type="CHAT"]':"chat",'click div[data-type="CHATROOM"]':"joinChatroom"},overwrite:function(a){a.stopPropagation()},onRender:function(){b("time.timeago",this.$el).timeago()},redirectTo:function(a){if(b(a.currentTarget).attr("href"))return!1;a.preventDefault(),a.stopPropagation();var c=b(a.currentTarget).data("url");window.location=c},navigateTo:function(a){var d=b(a.currentTarget).data("url");d.indexOf(window.location.protocol+"//"+window.location.hostname)>-1?(d=d.replace(window.location.protocol+"//"+window.location.hostname,""),c.history.navigate(d,{trigger:!0})):window.location=d},callApi:function(a){a.preventDefault(),a.stopPropagation();var c=b(a.currentTarget),d=b.ajax({type:"post",dataType:"json",url:c.attr("href"),beforeSend:function(a){a.setRequestHeader("Content-Type","application/vnd.mig33api-v1.5+json;charset=utf-8")}});d.done(function(a){a=i.parse_ajax_response(a),a.error?i.show_error(a.error):(a.desc&&i.show_success(a.desc),c.parents(".migalert").fadeOut())}),d.fail(function(a,b,c){i.show_error(c)})},chat:function(a){a.preventDefault(),a.stopPropagation(),j.ChatStoreModel.getInstance().startPrivateChat(0,b(a.currentTarget).data("username"),null,b(a.currentTarget).data("username"))},joinChatroom:function(a){a.preventDefault(),a.stopPropagation(),mig33.chatroom_manager.join_chatroom(b(a.currentTarget).data("name"))}});return k}),define("hbs!modules/template/migalert/migalert-collection",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="migalert-title">\n	'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"migalert|migalerts",g):i.call(b,"translate","migalert|migalerts",g)))+'\n	<div class="migalert-setting pull-right">\n		<a href="#"\n		   data-toggle="clickover"\n		   data-placement="bottom"\n		   data-html="true"\n		   data-animation="false"\n		   data-content="<label><input type=\'checkbox\' name=\'sound_notification\' value=\'1\' />&nbsp;'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"migalert|sound_notifications",g):i.call(b,"translate","migalert|sound_notifications",g)))+'</label>"\n				>\n			<span class="icon-wb_setting"></span>\n		</a>\n	</div>\n</div>\n<ul id="migalerts-list" class="list-unstyled"></ul>\n<div class="migalert-showmore">\n	<a id="migalert-showmore-link" href="/migalert">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"notification|showmore",g):i.call(b,"translate","notification|showmore",g)))+"</a>	\n</div>\n\n"})}),define("modules/template/helpers/migalert_helpers",["underscore","handlebars","modules/common/config","modules/common/utility","modules/globals/session_user","modules/globals/url"],function(a,b,c,d,e,f){var g=/^mig33\:.*/g,h=/^mig33\:(.*)\((.*)\)/im;b.registerHelper("alertParseTitle",function(){var a="";return a="undefined"==typeof this.title||""===this.title?d.translate("chat|notification"):this.title,new b.SafeString(a)}),b.registerHelper("alertParseAction",function(c){if("undefined"==typeof this.actions)return null;var d=this,e="undefined"!=typeof this.invalidateType?this.invalidateType:"",f=[];return this.actions.length>1&&"API"===this.actions[0].type&&"API"===this.actions[1].type&&a.each(this.actions,function(b){var g="";g=b.isDefault?"alert-button alert-button-default":"alert-button alert-button-secondary",a.each(b.url,function(a){a.view===c&&f.push('<a href="'+a.url+'" data-invalidate-type="'+e+'" data-alerttype="'+d.type+'" data-type="'+b.type+'" title="'+b.label.text+'" class="btn btn-xs '+g+'">'+b.label.text+"</a>")})}),new b.SafeString(f.join("&nbsp;&nbsp;"))}),b.registerHelper("alertParseActionURL",function(c){if("undefined"==typeof this.actions||this.actions.length<1)return null;var f=this,i=("undefined"!=typeof this.invalidateType?this.invalidateType:"",[]);if("MUTUAL_FOLLOWING_ALERT"===this.type)i.push('data-type="URL" data-url="'+d.get_profile_url(this.user.username)+'"');else if("ACCUMULATED_NEW_FOLLOWER_ALERT"===this.type)i.push('data-type="URL" data-url="'+e.get("personalized_url")+'/fans"');else if("ACCUMULATED_VIRTUALGIFT_ALERT"===this.type)i.push('data-type="URL" data-url="'+e.get("personalized_url")+'/gifts/recent"');else if("ACCUMULATED_MENTIONED_IN_MIGBO_POST_ALERT"===this.type)i.push('data-type="URL" data-url="'+e.get("personalized_url")+'/mentions"');else{var j=this.actions[0];a.each(j.url,function(a){if(a.view===c){var b=a.url.match(g);if(b){var d=a.url.match(h),k=d[2].replace(/'/g,"");"privateChat"===d[1]&&i.push('data-type="CHAT" title="'+j.label.text+'" data-username="'+k+'"'),"joinChatroom"===d[1]&&i.push('data-type="CHATROOM" data-name="'+k+'"'),"showGifts"===d[1]&&i.push('data-type="URL" data-url="'+e.get("personalized_url")+'/gifts/recent"'),"showFollowers"===d[1]&&i.push('data-type="URL" data-url="'+e.get("personalized_url")+'/fans"'),"mentions"===d[1]&&i.push('data-type="URL" data-url="'+e.get("personalized_url")+'/mentions"'),"showPost"===d[1]&&i.push('data-type="URL" data-url="'+e.get("personalized_url")+"/post/"+k+'"')}else f.actions.length>1&&"API"===f.actions[0].type&&"API"===f.actions[1].type||i.push('data-type="URL" data-url="'+a.url+'"')}})}return new b.SafeString(i.join("&nbsp;&nbsp;"))}),b.registerHelper("alertParseImage",function(c,d){if("undefined"==typeof this.image)return null;var e=this,f="";return a.each(this.image.url,function(a){a.size===c+"x"+d&&(f='<img src="'+a.url+'" width="'+c+'" height="'+d+'" alt="" title="'+e.image.title+'" class="img-circle" />')}),new b.SafeString(f)}),b.registerHelper("alertParseMessage",function(d){if("undefined"==typeof this.message||"undefined"==typeof this.variables)return null;var e="",f=a.escape(this.message);return a.each(this.variables,function(b){var g="";a.each(b.link,function(a){a.view===d&&(g=a.url)}),b.label.text=a.escape(b.label.text);var h=b.label.text;h.length<1&&"undefined"!=typeof b.content&&"undefined"!=typeof b.content.photo&&null!==b.content.photo&&(h=b.content.photo.url),h.length>c.migalerts.char_limit&&(h=h.substring(0,c.migalerts.char_limit-1)+"..."),e=b.label.text,f=f.replace("%{"+b.name+"}",e)}),new b.SafeString(f)}),b.registerHelper("alertParseSecondaryImage",function(){var c=a(this.variables).last(),d="";return c&&"BADGE"===c.type&&a.each(c.label.image.url,function(a){"64x64"===a.size&&(d=a.url)}),c&&""===d&&"undefined"!=typeof c.label.image.url[0].url&&(d=c.label.image.url[0].url),new b.SafeString('<img src="'+d+'" />')}),b.registerHelper("ifHasSecondaryImage",function(b){var c=a(this.variables).last();if(c){if("FOLLOWING_REQUEST"===this.type)return b.fn(this);if(("RIGHT_IMAGE"===c.type||"BADGE"===c.type)&&"undefined"!=typeof c.label.image.url[0].url)return b.fn(this)}return b.inverse(this)})}),define("modules/view/migalert/migalert_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/common/local_storage","modules/view/migalert/migalert_item_view","hbs!modules/template/migalert/migalert-collection","modules/view/common/mig33_views","modules/template/helpers/general_helpers","modules/template/helpers/migalert_helpers"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=d.compile('{{translate "migalert|empty"}}'),n=d.compile('{{translate "common|loading"}}...'),o=e.ItemView.extend({template:{type:"handlebars",template:m},tagName:"li",className:"migalert-error"}),p=e.ItemView.extend({template:{type:"handlebars",template:n},className:"loading"}),q=l.CompositeView.extend({itemView:j,emptyView:o,loadingView:p,itemViewContainer:"#migalerts-list",prevScrollY:0,template:{type:"handlebars",template:k},className:"migalerts",initialize:function(){a.bindAll(this)},onRender:function(){b("#migalerts-list",this.$el).css("max-height",b(window).height()-84);var a="bottom";b(window).width()<768&&(a="left"),b(".migalert-setting a",this.$el).clickover({width:140,global_close:!0,placement:a,onShown:function(){null!==h.get_user_data("sound_notification")&&1!==parseInt(h.get_user_data("sound_notification"),10)||b('input[name="sound_notification"]').prop("checked",!0)}})},appendHtml:function(a,b,c){0===c?a.$("#migalerts-list").prepend(b.el):a.$("#migalerts-list").append(b.el)},events:{"click .next":"fetchNextMigAlerts","click label":"migalertSettings"},fetchNextMigAlerts:function(b){b.preventDefault(),b.stopPropagation();var c,d=this;d.hideMore(),d.collection.nextPage(),c=d.collection.fetch({remove:!1,beforeSend:d.collection.setHeader}),c.done(function(b){!a.isUndefined(b.data.alerts)&&b.data.alerts&&d.appendMore()})},migalertSettings:function(a){b('input[name="sound_notification"]',a.currentTarget).is(":checked")?h.set_user_data("sound_notification",1):h.set_user_data("sound_notification",0),a.stopPropagation()},hideMore:function(){b(this.itemViewContainer).find("li.alert-next").remove()},appendMore:function(){b(this.itemViewContainer).find("li.alert-next").remove().end().append('<li class="migalert alert-next"><a href="#" class="next">'+h.translate("common|load_more")+"</a></li>")}});return q}),define("hbs!modules/template/migalert/notification-list",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f,i="";return i+='\n	<span class="wb wb-mbot-announce"></span>\n	<a href="#" class="close" data-dismiss="alert"><span class="icon-wb_close"></span></a>\n	<h4>'+q((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"notification|announcement",f):r.call(a,"translate","notification|announcement",f)))+'</h4>\n	<div class="body">',(e=c.message)?d=e.call(a,{hash:{},data:b}):(e=a&&a.message,d=typeof e===p?e.call(a,{hash:{},data:b}):e),(d||0===d)&&(i+=d),i+="</div>\n	",d=c["if"].call(a,a&&a.url,{hash:{},inverse:s.program(4,h,b),fn:s.program(2,g,b),data:b}),(d||0===d)&&(i+=d),i+="\n"}function g(a,b){var d,e,f,g="";return g+='\n		<div class="image"><a href="',(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===p?e.call(a,{hash:{},data:b}):e),g+=q(d)+'" class="btn btn-xs btn-default" data-bypass="true">'+q((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"common|more",f):r.call(a,"translate","common|more",f)))+"</a></div>\n	";
}function h(a,b){var d,e,f="";return f+='\n		<div class="image"><a href="/sites/ajax/migworld/get_wappage" class="btn btn-xs btn-default">'+q((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"common|more",e):r.call(a,"translate","common|more",e)))+"</a></div>\n	"}function i(a,b){var d,e,f,g="";return g+='\n	<div class="body"><strong>'+q((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"notification|success",f):r.call(a,"translate","notification|success",f)))+"</strong>&nbsp;",(e=c.message)?d=e.call(a,{hash:{},data:b}):(e=a&&a.message,d=typeof e===p?e.call(a,{hash:{},data:b}):e),(d||0===d)&&(g+=d),g+="</div>\n"}function j(a,b){var d,e,f,g="";return g+='\n	<div class="body"><strong>'+q((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"notification|error",f):r.call(a,"translate","notification|error",f)))+"</strong>&nbsp;",(e=c.message)?d=e.call(a,{hash:{},data:b}):(e=a&&a.message,d=typeof e===p?e.call(a,{hash:{},data:b}):e),(d||0===d)&&(g+=d),g+="</div>\n"}function k(a,b){var d,e,f,g="";return g+='\n	<div class="body">',e=c.htmlSpecialChars||a&&a.htmlSpecialChars,f={hash:{},data:b},d=e?e.call(a,a&&a.message,f):r.call(a,"htmlSpecialChars",a&&a.message,f),(d||0===d)&&(g+=d),g+="</div>\n"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var l,m,n,o="",p="function",q=this.escapeExpression,r=c.helperMissing,s=this;return m=c.compare||b&&b.compare,n={hash:{},inverse:s.noop,fn:s.program(1,f,e),data:e},l=m?m.call(b,b&&b.type,"MARKETING_MESSAGE_ALERT",n):r.call(b,"compare",b&&b.type,"MARKETING_MESSAGE_ALERT",n),(l||0===l)&&(o+=l),o+="\n",m=c.compare||b&&b.compare,n={hash:{},inverse:s.noop,fn:s.program(6,i,e),data:e},l=m?m.call(b,b&&b.type,"MESSAGE_SUCCESS",n):r.call(b,"compare",b&&b.type,"MESSAGE_SUCCESS",n),(l||0===l)&&(o+=l),o+="\n",m=c.compare||b&&b.compare,n={hash:{},inverse:s.noop,fn:s.program(8,j,e),data:e},l=m?m.call(b,b&&b.type,"MESSAGE_ERROR",n):r.call(b,"compare",b&&b.type,"MESSAGE_ERROR",n),(l||0===l)&&(o+=l),o+="\n",m=c.compare||b&&b.compare,n={hash:{},inverse:s.noop,fn:s.program(10,k,e),data:e},l=m?m.call(b,b&&b.type,"MESSAGE_INFO",n):r.call(b,"compare",b&&b.type,"MESSAGE_INFO",n),(l||0===l)&&(o+=l),o})}),define("modules/view/migalert/notification_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/migalert/notification-list","modules/common/config","modules/common/utility","modules/view/migalert/migalert_item_view","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j){var k=j.extend({template:{type:"handlebars",template:g},id:function(){return"notification-"+this.model.get("id")},events:{"click a.close":"close"},tagName:"li",className:function(){var a="hidden";switch(this.model.get("type")){case"MARKETING_MESSAGE_ALERT":a="alert alert-announcement";break;case"MESSAGE_SUCCESS":a="alert alert-success";break;case"MESSAGE_ERROR":a="alert alert-danger";break;case"MESSAGE_INFO":a="alert alert-info"}return a},onRender:function(){var a=this;switch(this.model.get("type")){case"MESSAGE_SUCCESS":case"MESSAGE_ERROR":case"MESSAGE_INFO":case"MARKETING_MESSAGE_ALERT":window.setTimeout(function(){b("#notification-"+a.model.get("id")).fadeOut("fast",function(){b(this).remove()})},5e3)}},close:function(a){b(a.currentTarget).parent().remove()}});return k}),define("modules/view/migalert/notification_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/view/migalert/notification_item_view","modules/view/common/mig33_views","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j){var k=j.CollectionView.extend({itemView:i,id:"notifications",className:"list-unstyled",tagName:"ul",initialize:function(){a.bindAll(this)}});return k}),define("hbs!modules/template/migalert/popup-list",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e="";return e+="\n	",d=c.each.call(a,a&&a.alerts,{hash:{},inverse:s.noop,fn:s.program(2,g,b),data:b}),(d||0===d)&&(e+=d),e+="\n"}function g(a,b){var d,e,f,g="";return g+='\n		<div class="alert">\n			<a href="#" class="close" data-dismiss="alert"><span class="icon-wb_close"></span></a>\n			<h4>',(e=c.alertParseTitle)?d=e.call(a,{hash:{},data:b}):(e=a&&a.alertParseTitle,d=typeof e===r?e.call(a,{hash:{},data:b}):e),g+=q(d)+'</h4>\n			<div class="image">\n				',e=c.compare||a&&a.compare,f={hash:{},inverse:s.program(5,i,b),fn:s.program(3,h,b),data:b},d=e?e.call(a,a&&a.type,"MUTUAL_FOLLOWING_ALERT",f):p.call(a,"compare",a&&a.type,"MUTUAL_FOLLOWING_ALERT",f),(d||0===d)&&(g+=d),g+='\n			</div>\n			<div class="body">\n				',e=c.alertParseMessage||a&&a.alertParseMessage,f={hash:{},data:b},d=e?e.call(a,"web",f):p.call(a,"alertParseMessage","web",f),(d||0===d)&&(g+=d),g+='\n			</div>\n			<div class="action">',e=c.alertParseAction||a&&a.alertParseAction,f={hash:{},data:b},d=e?e.call(a,"web",f):p.call(a,"alertParseAction","web",f),(d||0===d)&&(g+=d),g+="</div>\n		</div>\n	"}function h(a,b){var d,e,f,g="";return g+='\n					<img src="'+q((e=c.getSessionUserDisplayPictureUrl||a&&a.getSessionUserDisplayPictureUrl,f={hash:{},data:b},e?e.call(a,48,48,f):p.call(a,"getSessionUserDisplayPictureUrl",48,48,f)))+'" class="img-circle" width="48" height="48" />\n					&nbsp;&nbsp;<span class="icon-wb_friend font-size-24"></span>&nbsp;&nbsp;\n					<img src="'+q((e=c.getDisplayPictureUrl||a&&a.getDisplayPictureUrl,f={hash:{},data:b},e?e.call(a,(d=a&&a.image,null==d||d===!1?d:d.title),2,48,48,f):p.call(a,"getDisplayPictureUrl",(d=a&&a.image,null==d||d===!1?d:d.title),2,48,48,f)))+'" class="img-circle" width="48" height="48" />\n				'}function i(a,b){var d,e,f="";return f+="\n					",(e=c.alertParseSecondaryImage)?d=e.call(a,{hash:{},data:b}):(e=a&&a.alertParseSecondaryImage,d=typeof e===r?e.call(a,{hash:{},data:b}):e),f+=q(d)+"\n				"}function j(a,b){var d,e="";return e+="\n	",d=c.each.call(a,a&&a.alerts,{hash:{},inverse:s.noop,fn:s.program(8,k,b),data:b}),(d||0===d)&&(e+=d),e+="\n"}function k(a,b){var d,e,f,g="";return g+='\n		<div class="alert">\n			<a href="#" class="close" data-dismiss="alert"><span class="icon-wb_close"></span></a>\n			<div class="body">',e=c.alertParseMessage||a&&a.alertParseMessage,f={hash:{},data:b},d=e?e.call(a,"web",f):p.call(a,"alertParseMessage","web",f),(d||0===d)&&(g+=d),g+=" ",e=c.alertParseAction||a&&a.alertParseAction,f={hash:{},data:b},d=e?e.call(a,"web",f):p.call(a,"alertParseAction","web",f),(d||0===d)&&(g+=d),g+="</div>\n		</div>\n	"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var l,m,n,o="",p=c.helperMissing,q=this.escapeExpression,r="function",s=this;return m=c.compare||b&&b.compare,n={hash:{},inverse:s.noop,fn:s.program(1,f,e),data:e},l=m?m.call(b,b&&b.type,"2",n):p.call(b,"compare",b&&b.type,"2",n),(l||0===l)&&(o+=l),o+="\n",m=c.compare||b&&b.compare,n={hash:{},inverse:s.noop,fn:s.program(7,j,e),data:e},l=m?m.call(b,b&&b.type,"3",n):p.call(b,"compare",b&&b.type,"3",n),(l||0===l)&&(o+=l),o})}),define("modules/view/migalert/popup_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/migalert/popup-list","modules/common/config","modules/common/utility","modules/common/session_user","modules/view/migalert/migalert_item_view","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j,k){var l=k.extend({template:{type:"handlebars",template:g},id:function(){return"undefined"==typeof this.model.get("id")&&this.model.set("id",Date.now()),"popup-"+this.model.get("id")},tagName:"li",className:function(){var a=parseInt(this.model.get("type"),10),b="hidden";switch(a){case 2:b="popup";break;case 3:b="sticky"}return b},events:{'click a[data-type="API"]':"callApi",'click a[data-type="URL"]':"navigateTo",'click a[data-type="CHAT"]':"chat"},navigateTo:function(a){a.preventDefault();var d=b(a.currentTarget).data("invalidate-type");""!==d&&b.ajax({type:"post",dataType:"json",url:i.format(h.urls.user_alert_response,j.getInstance().get("id"))+"/?alertType="+d+"&responseType=6"}),b("#popup-"+this.model.get("id")).fadeOut("fast",function(){b(this).remove()});var e=b(a.currentTarget).attr("href").replace(window.location.protocol+"//"+window.location.hostname,"");c.history.navigate(e,{trigger:!0})},onRender:function(){var a=this;window.setTimeout(function(){b("#popup-"+a.model.get("id")).fadeOut("fast",function(){b(this).remove()})},h.timer.poll-3e3)}});return l}),define("modules/view/migalert/popup_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/view/migalert/popup_item_view","modules/view/common/mig33_views","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j){var k=j.CollectionView.extend({itemView:i,id:"popups",className:"list-unstyled",tagName:"ul",initialize:function(){a.bindAll(this)}});return k}),define("modules/view/common/header_layout",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/common/header-layout","modules/model/migalert/migalert_model","modules/model/migalert/migalert_collection","modules/view/migalert/migalert_collection_view","modules/view/migalert/notification_collection_view","modules/view/migalert/popup_collection_view","modules/globals/url","modules/common/config","modules/common/utility","modules/common/session_user","modules/chat/models/user_session","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){var r=q.Session.getInstance(),s=c.Marionette.Layout.extend({template:{type:"handlebars",template:g},regions:{migalerts:"#migalerts",migalertsMobile:"#migalertsMobile"},id:"navbar-inner",className:"navbar-inner",events:{"click .chat-mobile-toggle":"triggerMobileChat","click #home-logo":"triggerHome","click #discover-dropdown a.dropdown-toggle":"triggerDiscoverDropdown","click .migalerts-dropdown":"triggerMigalertsDropdown","click .hidePopUp-btn":"hidePopUp","click .search-form-btn":"doSearch",'keyup input[name="search-form-query"]':"searchEnter","click .mega-dropdown-menu > li > a":"hidePopUp","click .dropdown-menu > li > a":"hidePopUp","click .navbar-brand":"showLogin","click .navbar-signup":"show_signup_popup"},counterMigalerts:0,initialize:function(){this.migalert_collection=new i,a.bindAll(this),this.isTearAway=!1},onRender:function(){var c=this,d=require("modules/mig33_app");if(this.$el.data("navbarLayoutObject",this),o.is_logged_in()){null!=r.get("account_balance")&&c.updateAccountBalance(o.add_thousands_seperator(r.get("account_balance"))+" "+r.get("currency_code")),d.vent.on(d.ApplicationEvents.ACCOUNT_BALANCE,function(a){c.updateAccountBalance(a)});var e=new Audio(m.jsclient+"/app/sound/notification.mp3"),f=new i,g=new l({collection:f}),h=new i,j=new k({collection:h});b("body").append(g.$el).append(j.$el),d.vent.on(d.ApplicationEvents.NEW_MIGALERT,function(a){0===a?c.resetAndHideMigalertCount():c.incrementAndShowMigalertCount(a)});var p=this;d.vent.on(d.ApplicationEvents.NEW_NOTIFICATIONS,function(b,c){a.each(b,function(a){switch(a.type){case n.notification_destinations.MARKETING_TYPE:h.add(a.alerts),null!==o.get_user_data("sound_notification")&&1!==parseInt(o.get_user_data("sound_notification"),10)||e.play();break;case n.notification_destinations.MIGALERT_TYPE:if(c>0){var b=require("modules/mig33_app");b.vent.trigger(b.ApplicationEvents.NEW_MIGALERT,c),p.migalert_collection.length>0&&p.migalert_collection.add(a.alerts),null!==o.get_user_data("sound_notification")&&1!==parseInt(o.get_user_data("sound_notification"),10)||e.play()}}})}),b(".migalerts-dropdown",this.$el).on("hide.bs.dropdown",function(){c.resetAndHideMigalertCount()}),this.migalert_collection.fetch({beforeSend:this.migalert_collection.setHeader})}else b(".container",this.$el).addClass("non-logged-in"),b("ul.nav.navbar-nav",this.$el).addClass("non-logged-in"),b(".more-options-dropdown",this.$el).hide()},resetAndHideMigalertCount:function(){this.counterMigalerts=0,o.show_document_title("",0),b("li","#migalerts-list").removeClass("is-unread"),b(".migalerts-unread-count",this.$el).html(""),this.migalert_collection.fetch({beforeSend:this.migalert_collection.setHeader})},incrementAndShowMigalertCount:function(a){this.counterMigalerts=a,o.show_document_title("",a),b(".migalerts-unread-count",this.$el).text(this.counterMigalerts)},searchEnter:function(a){13==a.keyCode&&(a.stopPropagation(),this.doSearch(a))},doSearch:function(a){a.preventDefault();var d=b(".search-form",this.$el),e=b('input[name="location"]',d).val(),f=b('input[name="search-form-query"]',d),g=b.trim(f.val());return g.length<=0&&b(window).width()>=768?(f.focus(),!1):(this.send_event("Top Navigation","Search"),void c.history.navigate("search/"+e+"/?query="+encodeURIComponent(g),{trigger:!0}))},removeActiveState:function(){b("#home-logo",this.$el).removeClass("active"),b(".search-form",this.$el).removeClass("active"),b(".chat-mobile-toggle",this.$el).removeClass("active")},triggerMobileChat:function(a){return a.preventDefault(),b(a.currentTarget).hasClass("open")?void this.hidePopUp():(this.hidePopUp(),this.send_event("Top Navigation","mobile chat"),this.animate(a.currentTarget),b(".chat-mobile-toggle",this.$el).addClass("open"),b("#main").addClass("hidden-xs"),void b("#chat").removeClass("hidden-xs"))},triggerHome:function(a){this.hideMobileChat(),this.send_event("Top Navigation","Logo"),"undefined"!=typeof window.location&&"undefined"!=typeof window.location.pathname&&"/home"===window.location.pathname&&(a.preventDefault(),b.scrollTo(0,1e3))},triggerDiscoverDropdown:function(a){o.send_event_to_ga("Top Navigation","Discover"),this.animate(a.currentTarget)},triggerMigalertsDropdown:function(a){var c=this;require("modules/mig33_app");c.send_event("Top Navigation","migAlerts");var d=new j({collection:this.migalert_collection}),e=new j({collection:this.migalert_collection});this.migalerts.show(d),this.migalertsMobile.show(e),this.migalert_collection.length<1?this.migalert_collection.fetch({beforeSend:this.migalert_collection.setHeader}):b("li","#migalerts-list").slice(0,this.counterMigalerts).addClass("is-unread"),this.triggerMigalertsDropdown.bound||(this.migalert_collection.on("fetch:done",function(e){d.render(),b("li","#migalerts-list").slice(0,c.counterMigalerts).addClass("is-unread"),c.animate(a.currentTarget),c.hideMobileChat()}),this.triggerMigalertsDropdown.bound=!0)},hidePopUp:function(){this.hideMobileChat(),b(".navbar-collapse").removeClass("in"),b(".navbar-toggle").addClass("collapsed")},send_event:function(a,b){this.hidePopUp(),o.send_event_to_ga(a,b)},hideMobileChat:function(a){b("#main").removeClass("hidden-xs"),b("#chat").addClass("hidden-xs"),b(".chat-mobile-toggle",this.$el).removeClass("open")},updateAccountBalance:function(a){b(".header-account-balance",this.$el).text(a)},animate:function(a){var c=b('span[class^="icon-"]',a);c.hasClass("bounce")?b('span[class^="icon-"]',a).first().removeClass("bounce"):b('span[class^="icon-"]',a).first().addClass("bounce")},showLogin:function(a){a.preventDefault(),!a.target.classList.contains("bypass-login")&&o.show_login_dialog()&&a.stopPropagation()},show_signup_popup:function(){var a=document.location.origin.replace(/http[s]?:\/\//,""),b=encodeURIComponent(document.location.href),c="https://register."+a+"?return_url="+b+"&popup=1",d=screen.width/2-175,e=screen.height/2-200;window.open(c,"registrationPopup","width=350,height=555,location=0,menubar=0,toolbar=0,left="+d+",top="+e);return!1}});return s}),define("hbs!modules/template/common/login-modal",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h,i="",j=c.helperMissing,k=this.escapeExpression,l="function";return i+='<div class="modal-dialog signin-modal-dialog">\n	<div class="modal-title">\n		'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"login|login_to_join_in_not_signed_up_1",h):j.call(b,"translate","login|login_to_join_in_not_signed_up_1",h)))+'\n		<div class="signin-modal-close btn-expand close" aria-hidden="true"></div>\n	</div>\n	<div class="modal-content">\n		<div class="desc_text">\n			'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"login|login_to_join_in_not_signed_up_2",h):j.call(b,"translate","login|login_to_join_in_not_signed_up_2",h)))+'\n		</div>\n		\n		<div class="row padding-12-15px signin-content">\n			<form id="signin-modal-form" class="col-xs-12 col-sm-5 signin-modal" action="'+k((g=c.getUrl||b&&b.getUrl,h={hash:{},data:e},g?g.call(b,"login",h):j.call(b,"getUrl","login",h)))+'" method="post" accept-charset="utf-8" target="_top">\n				<input type="hidden" name="return_url" value="'+k((g=c.getWindowLocationObject||b&&b.getWindowLocationObject,h={hash:{},data:e},g?g.call(b,"href",h):j.call(b,"getWindowLocationObject","href",h)))+'">\n				\n				<div class="login-fields ">\n					<div class="signin-modal-padding">\n						<input type="text" class="signin-modal-field" id="mig33-username" name="mig33-username" placeholder="'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"login|username",h):j.call(b,"translate","login|username",h)))+'" value="">\n					</div>\n\n					<div class="signin-modal-padding">\n						<input type="password" class="signin-modal-field" name="mig33-password" id="mig33-password" placeholder="'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"login|password",h):j.call(b,"translate","login|password",h)))+'">\n					</div>\n\n					<div class="signin-modal-padding signin-modal-forgot">\n						<a href="https://login.mig.me/forgotpassword" target="_top">'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"login|forgot_password",h):j.call(b,"translate","login|forgot_password",h)))+'</a> \n					</div>\n\n					<div class="signin-modal-padding">\n						<input class="signin-modal-field signin-modal-orangebtn" type="submit" value="'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"login|signin",h):j.call(b,"translate","login|signin",h)))+'">\n					</div>\n				</div>\n			</form>\n\n			<div class="col-sm-2 hidden-xs signin-or">\n				<div class="signin-modal-table vertical-line-text">'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"common|or",h):j.call(b,"translate","common|or",h)))+'</div>\n				<div class="vertical-line vertical-line-top"></div>\n				<div class="vertical-line vertical-line-bottom"></div>\n			</div>\n\n			<div class="col-xs-12 visible-xs padding-12-15px">\n				<div>OR</div>\n				<hr class="hr-line hr-line-left">\n				<hr class="hr-line hr-line-right">\n			</div>\n\n			<div class="col-xs-12 col-sm-5 signin-modal-table">\n				<div class="row signin-modal-columns">\n					<div class="col-xs-6 col-sm-12 signin-modal-split">\n						<a id="fb_connect_redirect" href="https://login.mig.me/web/facebook/login" target="_top" class="noUnderline display-block-force">\n							<div class="signin-modal-button signin-modal-button-fb text-uppercase" alt="Facebook Logo">\n								<div class="sign-in-text">\n									<div class="ico-fb-hollow"></div>\n									<span class="hidden-xs">'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"login|connect_to_facebook",h):j.call(b,"translate","login|connect_to_facebook",h)))+'</span>\n									<span class="navbar-visible-xs">'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"login|connect",h):j.call(b,"translate","login|connect",h)))+'</span>\n								</div>\n							</div>\n						</a>\n\n						<a id="fb_connect_popup" class="cursorPointer noUnderline hidden" onclick="fb_login();" target="_top">\n							<div class="signin-modal-button signin-modal-button-fb text-uppercase" alt="Facebook Logo">\n								<div class="sign-in-text">\n									<div class="ico-fb-hollow"></div>\n									<span class="hidden-xs">'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"login|connect_to_facebook",h):j.call(b,"translate","login|connect_to_facebook",h)))+'</span>\n									<span class="navbar-visible-xs">'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"login|connect",h):j.call(b,"translate","login|connect",h)))+'</span>\n								</div>\n							</div>\n						</a>\n					</div>\n\n					<div class="col-xs-6 col-sm-12 signin-modal-split spacing">\n						<a id="signin-modal-signup" href="',(g=c.get_register_url)?f=g.call(b,{hash:{},data:e}):(g=b&&b.get_register_url,f=typeof g===l?g.call(b,{hash:{},data:e}):g),i+=k(f)+'" target="_top" style="cursor: pointer;">\n							<div class="signin-modal-button signin-modal-hollow text-uppercase" alt="Sign Up">\n								<div class="sign-in-text">\n									<span>'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"login|signup",h):j.call(b,"translate","login|signup",h)))+"</span>\n								</div>\n							</div>\n						</a>\n					</div>			\n				</div>\n\n				<script>\n					var appId = '",(g=c.get_fb_id)?f=g.call(b,{hash:{},data:e}):(g=b&&b.get_fb_id,f=typeof g===l?g.call(b,{hash:{},data:e}):g),i+=k(f)+"';\n					var fb_permissions = '",(g=c.get_fb_permissions)?f=g.call(b,{hash:{},data:e}):(g=b&&b.get_fb_permissions,f=typeof g===l?g.call(b,{hash:{},data:e}):g),i+=k(f)+'\';\n				</script>\n				<script language="javascript" type="text/javascript" src="',(g=c.get_fb_js_url)?f=g.call(b,{hash:{},data:e}):(g=b&&b.get_fb_js_url,f=typeof g===l?g.call(b,{hash:{},data:e}):g),i+=k(f)+'"></script>\n			</div>\n\n		</div>\n	</div>\n</div>'})}),define("modules/view/common/login_modal_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/common/login-modal","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g){var h=e.ItemView.extend({template:{type:"handlebars",template:g},id:"login-modal",className:"signin-bottom-layover",events:{"click .signin-modal-close.btn-expand":"expandModal","click .modal-title":"expandModal","click .signin-modal-close.btn-collapse":"collapseModal"},init:function(){b("#main-container").css("margin-bottom",b("#login-modal").height()+"px"),b("#login-modal").slideDown(500)},onRender:function(){this.$el.data("loginModalViewObject",this),setTimeout(this.init,5e3)},updateReturnURL:function(){var a=this.changeURL(b("#signin-modal-signup").attr("href"));b("#signin-modal-signup").attr("href",a);var c=this.changeURL(b("form.signin-modal").attr("action"));b("form.signin-modal",this.$el).attr("action",c),b('form.signin-modal input[name="return_url"]',this.$el).val(document.location.href);var d=this.changeURL(b("#fb_connect_redirect").attr("href"));b("#fb_connect_redirect").attr("href",d)},changeURL:function(a){var b=document.location.href,c=a.indexOf("?return_url=");return c>0&&(a=a.substring(0,c)),a+="?return_url="+encodeURIComponent(b)},expandModal:function(a){a.preventDefault(),a.stopPropagation(),this.showModal()},showModal:function(){this.updateReturnURL(),b(".modal-content",this.$el).slideDown(500),b(".btn-expand",this.$el).toggleClass("btn-expand btn-collapse")},collapseModal:function(a){a.preventDefault(),a.stopPropagation(),b(".modal-content",this.$el).slideUp(500),b(".btn-collapse",this.$el).toggleClass("btn-expand btn-collapse")}});return h}),define("hbs!modules/template/common/download-modal",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='\n<div id="login-modal" class="signin-top-layover" style="display: none;"><div class="modal-dialog signin-modal-dialog">\n	<div class="modal-title">\n		Try our mobile app\n		<div class="download-modal-close close btn-collapse" aria-hidden="true"></div>\n		<div><span class="launcher"></span>&nbsp;<a class="download_link" href="'+j((f=c.getUrl||b&&b.getUrl,g={hash:{},data:e},f?f.call(b,"corporate",g):i.call(b,"getUrl","corporate",g)))+'/download" style="color: white;" data-bypass="true"><b style="vertical-align:17%;">Download here</b></a></div>\n	</div>\n</div></div>'})}),define("modules/view/common/download_modal_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/common/download-modal"],function(a,b,c,d,e,f,g){var h=e.ItemView.extend({template:{type:"handlebars",template:g},events:{"click .download-modal-close.btn-collapse":"collapseModal"},collapseModal:function(a){a.preventDefault(),a.stopPropagation(),b("#login-modal",this.$el).slideUp(500)}});return h}),define("hbs!modules/template/common/share-modal",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="modal-dialog">\n	<div class="modal-content">\n		<div class="modal-header">\n			<div class="col-sm-12">\n				<h4 id="share-modal-title" class="pull-left modal-title">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"share|title",g):i.call(b,"translate","share|title",g)))+'</h4>\n				<span class="icon-wb_closepopup close pull-right font-color-grey visible-xs" data-dismiss="modal"></span>\n			</div>\n			<div class="clear"></div>\n		</div>\n		<div class="modal-body">\n			<label class="col-sm-12 share-label control-label">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"share|share_message",g):i.call(b,"translate","share|share_message",g)))+'</label>\n			\n			<div class="col-sm-10 text-capitalize text-center font-size-12">\n				<div class="col-sm-2 share-button-box">\n					<a href="#" id="share-modal-to-miniblog">\n						<div class="btn btn-sm btn-share btn-share-miniblog"></div>\n						<div class="font-color-darkgrey">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"common|feed",g):i.call(b,"translate","common|feed",g)))+'</div>\n					</a>\n				</div>\n				<div class="col-sm-2 share-button-box">\n					<a href="#" id="share-modal-to-chat">\n						<div class="btn btn-sm btn-share btn-share-chat"></div>\n						<div class="font-color-darkgrey">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"chat|chat",g):i.call(b,"translate","chat|chat",g)))+'</div>\n					</a>\n				</div>\n				<div class="col-sm-2 share-button-box">\n					<a href="#" id="share-modal-to-email">\n						<div class="btn btn-sm btn-share btn-share-email"></div>\n						<div class="font-color-darkgrey">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"email|email",g):i.call(b,"translate","email|email",g)))+'</div>\n					</a>\n				</div>\n				<div class="col-sm-2 share-button-box">\n					<a href="#" id="share-modal-to-facebook">\n						<div class="btn btn-sm btn-share btn-share-facebook"></div>\n						<div class="font-color-darkgrey">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"common|facebook",g):i.call(b,"translate","common|facebook",g)))+'</div>\n					</a>\n				</div>\n				<div class="col-sm-2 share-button-box">\n					<a href="#" id="share-modal-to-twitter">\n						<div class="btn btn-sm btn-share btn-share-twitter"></div>\n						<div class="font-color-darkgrey">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"common|twitter",g):i.call(b,"translate","common|twitter",g)))+'</div>\n					</a>\n				</div>\n			</div>\n			<div class="share-modal-spacing clear"></div>\n\n			<label class="col-sm-12 share-label control-label">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"share|copy_link",g):i.call(b,"translate","share|copy_link",g)))+'</label>\n			<div class="col-sm-12">\n				<input id="share-modal-url" type="text" class="form-control"  name="share_url" value="" title="'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"share|title_link",g):i.call(b,"translate","share|title_link",g)))+'" readonly="readonly">\n			</div>\n			<div class="share-modal-spacing clear"></div>\n		</div>\n	</div>\n</div>\n'})}),define("modules/view/common/share_modal_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/common/share-modal","modules/common/config","modules/globals/variable","modules/globals/url","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j,k){var l={facebook:1,email:2,twitter:3,chat:4,miniblog:5,others:6},m={post:"100",user:"101",music:"102",chatroom:"103"},n=e.ItemView.extend({template:{type:"handlebars",template:g},id:"share-modal",className:"modal fade",events:{'click input[name="share_url"]':"selectPostPermalink","click #share-modal-to-miniblog":"shareToMiniblog","click #share-modal-to-chat":"shareToChat","click #share-modal-to-email":"shareToEmail","click #share-modal-to-facebook":"shareToFacebook","click #share-modal-to-twitter":"shareToTwitter"},mimeObject:{},setMimeType:function(a){a&&(this.mimeObject=Object.assign({},a))},setMimetypeInPostboxView:function(){b("#postbox-view").data("postboxViewObject").setMimeType(this.mimeObject)},onRender:function(){this.$el.data("shareModalViewObject",this)},serializeData:function(){var a={share_action:this.share_action};return a},updateShareURL:function(a,c){this.share_action=a,this.model=c;var d=k.translate("share|"+a),e=k.translate("share|title",d);b("#share-modal-title").text(e);var f=this._get_url_parameters(a),g=this._get_sessionuser_username();this.share_url=window.url.site+"share/"+a+"/"+f+"?referrer="+g+"&source=web",this.setShareURL(),this.hide_option()},setShareURL:function(){b("#share-modal-url",this.$el).val(this.share_url+this._get_utm_parameters())},getShareURL:function(a){var b=this.share_url;return b+=this._get_utm_parameters(a)},selectPostPermalink:function(a){a.preventDefault(),b(a.currentTarget).select()},shareToMiniblog:function(a){if(!this._check_logged_in())return!1;var c=b("#sharebox-modal"),d=b(".postbox-content",c),e=b('.postbox-content input[name="originality"]',c),f=b('.postbox-content input[name="root_post_id"]',c),g=b('.postbox-content input[name="parent_post_id"]',c),h=this._get_copy_message("miniblog");b("#share-modal").modal("hide"),c.modal("show"),this.model.data&&this.model.id&&(e.length>0?e.val(3):d.append('<input type="hidden" name="originality" value="3" />')),this.model.data&&this.model.data.root_post&&this.model.data.root_post.id&&(f.length>0?f.val(this.model.data.root_post.id):d.append('<input type="hidden" name="root_post_id" value="'+this.model.data.root_post.id+'" />')),this.model.data&&this.model.data.parent_post&&this.model.data.parent_post.id&&(g.length>0?g.val(this.model.data.parent_post.id):d.append('<input type="hidden" name="parent_post_id" value="'+this.model.data.parent_post.id+'" />')),b('textarea[name="body"]',c).focus().val(this._unencode_uri_andeq(decodeURIComponent(h.message))),this.setMimetypeInPostboxView()},shareToChat:function(a){if(!this._check_logged_in())return!1;var c=this._get_copy_message("chat");c.message=this._unencode_uri_andeq(c.message);var d;d=b("#share-to-chat-modal").data("shareToChatModalViewObject"),d.populate(this.share_action,c),b("#share-modal").modal("hide"),b("#share-to-chat-modal").modal("show")},shareToEmail:function(a){a.preventDefault();var c=this._get_copy_message("email");b("#share-modal").modal("hide"),window.location.href="mailto:?Subject="+c.title+"&Body="+c.message},shareToFacebook:function(a){a.preventDefault(),b("#share-modal").modal("hide"),k.shareToFacebook(this.getShareURL("facebook"))},shareToTwitter:function(a){a.preventDefault();var c=this._get_copy_message("twitter"),d=h.urls.twitter_share_url+this._uri_safe(this.getShareURL("twitter"))+"&text="+c.message;b("#share-modal").modal("hide"),this._openPopupWindow(d)},hide_option:function(){"post"==this.share_action},_sendShareData:function(a){if(!this._check_logged_in())return!1;var c="",d={shareChannelType:l[a],shareItemActionType:"2",referrerUsername:this._get_sessionuser_username(),
sessionId:this._get_sessionuser_id(),cookieId:this._get_gen_cookie_id(),userAgent:navigator.userAgent,platformSource:"web",sharedUrl:this.getShareURL(a)};switch(this.utm&&(d.utmMedium=this.utm.medium,d.utmCampaign=this.utm.campaign,d.utmSource=this.utm.source),this.share_action){case"repost":d.dataType=m[this.share_action],d.username=this.model.data.author.username,d.postId=this.model.data.id;break;case"post":d.dataType=m[this.share_action],d.username=this.model.data.author.username,d.postId=this.model.data.id;break;case"user":c=h.urls.share_engagement_activity,d.dataType=m[this.share_action],d.username=this.model.get("username");break;case"music":c=h.urls.share_engagement_activity,d.dataType=m[this.share_action],d.providerName=this.model.provider,d.objectType=this.model.type,d.objectId=this.model.id;break;default:return!1}var e=b.ajax({type:"POST",dataType:"json",url:c,beforeSend:function(a){a.setRequestHeader("Content-Type","application/json")},data:JSON.stringify(d)});return e.done(function(a){console.log("Sending share data success "+JSON.stringify(a))}),e.fail(function(a){console.log("Failed to send share data ...")}),!0},_openPopupWindow:function(a){var b,c,d=600,e=450;b=window.screen.width/2-(d/2+10),c=window.screen.height/2-(e/2+50),window.open(a,"migme-new-window","height="+e+",width="+d+",left="+b+",top="+c+",screenX="+b+",screenY="+c+",toolbar=no,menubar=no,directories=no")},_get_sessionuser_username:function(){var a="";return window.session_user&&window.session_user.username&&(a=window.session_user.username),a},_get_sessionuser_id:function(){var a="";return window.session_user&&window.session_user.id&&(a=window.session_user.id),a},_get_url_parameters:function(a){var b="";switch(a){case"user":b=this.model.get("username");break;case"post":b=this.model.get("author").username+"/"+this.model.id;break;case"chatroom":b=encodeURIComponent(this.model.chatroom_name);break;case"music":b=this.model.provider+"/"+this.model.type+"/"+this.model.id;break;case"gift_received":b=this.model.get("username")+"/"+this.model.type+"/"+this.model.id;break;case"badge":b=this.model.collection.options.username+"/"+this.model.id;break;case"label":b=this.model.get("username")+"/"+this.model.id}return b},_get_copy_message:function(a){var c=this._get_sessionuser_username();c||(c="your friend");var d="",e=this.getShareURL(a),f={title:k.translate("email|subject_template",c),message:k.translate("email|body_template",this._get_sessionuser_username())};switch("twitter"===a&&(e=""),f.message+=" ","email"===a&&(f.message+="\n \n"+e),f.message+=e,this.share_action){case"user":d=this.model.get("num_followers"),f.title=k.translate("share|"+a+"_"+this.share_action+"_title",e,this.model.get("username"),d,c),f.message=k.translate("share|"+a+"_"+this.share_action+"_message",e,this.model.get("username"),d,c),f.title=encodeURIComponent(f.title),f.message=encodeURIComponent(f.message);break;case"post":var g=b("<div/>").html(this.model.get("body_snippet")).text();d=g.substring(0,59),g.length>60&&(d+="..."),f.title=k.translate("share|"+a+"_"+this.share_action+"_title",e,this.model.get("author").username,d,c),f.message=k.translate("share|"+a+"_"+this.share_action+"_message",e,this.model.get("author").username,d,c),f.title=encodeURIComponent(f.title),f.message=encodeURIComponent(f.message);break;case"music":f.title=k.translate("share|"+a+"_"+this.share_action+"_title",e,this.model.username,d,c),f.message=k.translate("share|"+a+"_"+this.share_action+"_message",e,c,d,c),f.title=encodeURIComponent(f.title),f.message=encodeURIComponent(f.message);break;case"chatroom":f.title=k.translate("share|"+a+"_"+this.share_action+"_title",e,this.model.chatroom_name,d,c),f.message=k.translate("share|"+a+"_"+this.share_action+"_message",e,c,d,c),f.title=encodeURIComponent(f.title),f.message=encodeURIComponent(f.message)}return f},_check_logged_in:function(){return k.is_logged_in()?!0:(b("#share-modal").modal("hide"),k.show_login_dialog(),!1)},_get_utm_parameters:function(a){var b="migshares";void 0===a&&(a="others");var c=this.share_action;("post"==this.share_action&&this.model.data.author.label.verified!==!1||"user"==this.share_action&&this.model.get("label").verified!==!1)&&(c="artist_"+c);var d="";return d+="&utm_source="+a,d+="&utm_medium="+b,d+="&utm_campaign="+c,this.utm={},this.utm.source=a,this.utm.medium=b,this.utm.campaign=c,d},_get_gen_cookie_id:function(){return b.cookie("_ga")?b.cookie("_ga"):""},_uri_safe:function(a){return a=a.replace(/%20/g,"%2520"),a=a.replace(/&/g,"%26"),a=a.replace(/=/g,"%3D")},_unencode_uri_andeq:function(a){return a=a.replace(/%26/g,"&"),a=a.replace(/%3D/g,"=")},_unencode_uri_perc:function(a){return a=a.replace(/%25/g,"%")}});return n}),define("hbs!modules/template/chat/share/share-to-chat-modal",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="modal-dialog">\n	<div class="modal-content">\n		<div class="modal-header">\n			<div class="col-xs-12">\n				<h4 id="share-chat-modal-title" class="pull-left modal-title">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"share|title",g):i.call(b,"translate","share|title",g)))+'</h4>\n				<span class="icon-wb_closepopup close pull-right font-color-grey visible-xs" data-dismiss="modal"></span>\n			</div>\n			<div class="clear"></div>\n		</div>\n		<div class="modal-body share-chat-modal">\n			<ul class="nav nav-tabs nav-justified tab-share">\n				<li class="tab-share-chat col-xs-6">\n					<span class="icon-wb_recent"></span>\n				</li>\n				<li class="tab-share-contact col-xs-6">\n					<span class="icon-wb_friend"></span>\n				</li>\n			</ul>\n\n			<div class="share-chat-list"></div>\n			<div class="share-contact-list"></div>\n\n		</div>\n	</div>\n</div>\n'})}),define("hbs!modules/template/chat/share/chat-list",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="mig-share-window">\n    <div class="row chat-search">\n        <div class="col-xs-12">\n            <div class="input-group">\n                <div class="input-group-btn">\n                    <div type="button" class="btn btn-s btn-default-grey">\n                        <span class="icon-wb_search font-color-grey"></span>\n                    </div>\n                </div>\n                <input type="text" class="search-text form-control input-s" placeholder="Search">\n            </div>\n        </div>\n    </div>\n\n    <div class="chat-item-list chat-recent-list share-list-container">\n\n    </div>\n\n    <div class="share-send-button">\n\n    </div>\n\n    <div class="row no-margin no-padding mig-window-footer">\n        <div class="col-xs-12 no-padding-right">\n            <div class="col-xs-10 chat-window-messagebox-container">\n                <div class="col-xs-12 chat-window-messagebox">\n                    <textarea class="messagebox" rows="1" type="text" placeholder="'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"chat|send_message",g):i.call(b,"translate","chat|send_message",g)))+'"></textarea>\n                </div>\n            </div>\n            <div class="col-xs-2 no-padding-right pull-right">\n                <div class="btn btn-sm btn-default share-send-button text-uppercase">Send</div>\n            </div>\n        </div>\n    </div>\n</div>'})}),define("hbs!modules/template/chat/share/chatlist-item",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+='\n                <img src="',(e=c.display_pic)?d=e.call(a,{hash:{},data:b}):(e=a&&a.display_pic,d=typeof e===n?e.call(a,{hash:{},data:b}):e),f+=o(d)+'" width="36" height="36"\n                     class="img-circle"/>\n            '}function g(a,b){var d,e="";return e+="\n	            ",d=c["if"].call(a,a&&a.is_chatroom,{hash:{},inverse:p.program(6,i,b),fn:p.program(4,h,b),data:b}),(d||0===d)&&(e+=d),e+="\n            "}function h(a,b){return'\n                    <span class="wb wb-36 wb-chatp-chatrm"></span>\n	            '}function i(a,b){var d,e="";return e+="\n		            ",d=c["if"].call(a,a&&a.is_group_chat,{hash:{},inverse:p.noop,fn:p.program(7,j,b),data:b}),(d||0===d)&&(e+=d),e+="\n	            "}function j(a,b){return'\n                        <span class="wb wb-36 wb-chatp-groupchat"></span>\n		            '}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var k,l,m="",n="function",o=this.escapeExpression,p=this;return m+='<div class="padding-12-15px chat-item-row">\n    <div class="first-col padding-right-6px v-top inline-block">\n        <div class="chat-list-avatar">\n            ',k=c["if"].call(b,b&&b.is_private_chat,{hash:{},inverse:p.program(3,g,e),fn:p.program(1,f,e),data:e}),(k||0===k)&&(m+=k),m+='\n        </div>\n    </div>\n    <div class="middle-col text-truncate v-top inline-block">\n        <div class="text-truncate chat-list-title">\n            <a href="#">',(l=c.chatname)?k=l.call(b,{hash:{},data:e}):(l=b&&b.chatname,k=typeof l===n?l.call(b,{hash:{},data:e}):l),m+=o(k)+'</a>\n        </div>\n        <div class="text-truncate chat-list-subtitle font-size-12">',(l=c.lastMessage)?k=l.call(b,{hash:{},data:e}):(l=b&&b.lastMessage,k=typeof l===n?l.call(b,{hash:{},data:e}):l),m+=o(k)+'</div>\n    </div>\n    <div class="pull-right share-tick-ico">\n        <span class="icon-wb_tick_white_16px font-color-celadon"></span>\n    </div>\n</div>'})}),define("modules/chat/views/share/chat_list_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/chat/share/chatlist-item","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers","modules/template/helpers/chat_helpers"],function(a,b,c,d,e,f,g,h,i){var j=e.ItemView.extend({template:{type:"handlebars",template:g},initialize:function(){a.bindAll(this)},onRender:function(){this.trigger("item_render")},modelEvents:{change:"fieldsChanged"},fieldsChanged:function(){this.render()},getModel:function(){return this.model},events:{"click .close-chat-btn":"onCloseClick"},onCloseClick:function(a){a.preventDefault(),a.stopPropagation();var b=this.model.get("is_chatroom")?i.translate("chat|confirm_group_chat_close"):i.translate("chat|clear-chat"),c=window.confirm(b);c&&this.model.trigger("chat_list_close_click")}});return j}),define("modules/chat/views/share/share_to_recent_chat",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/chat/share/chat-list","modules/chat/views/share/chat_list_item_view","modules/chat/models/chats","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j,k){var l=(i.ChatStoreModel.getInstance(),e.CompositeView.extend({itemView:h,itemViewContainer:".share-list-container",className:"",template:{type:"handlebars",template:g},initialize:function(){this.decorator_height=0,this.decorator_width=0,this.hasTextFilter=!1,this.textFilterValue="",this.itemDiv="chat-item-row",this.message_input=null,this.message={title:"",message:""},a.bindAll(this),this.collection&&this._listenToCollectionEvents()},_listenToCollectionEvents:function(){this.collection.on("chat_became_latest",function(a){var b=this.children.findByModel(a)},this)},onRender:function(){var c=this;this.$el.find(".chat-recent-list").mCustomScrollbar({scrollInertia:150,advanced:{updateOnContentResize:!0},autoHideScrollbar:!0}),this.search_txt=b(".search-text",this.$el),this.search_txt.on("keyup",a.debounce(function(){c.setTextFilter(b(".search-text",c.$el).val())},200)),this.message_input=this.$el.find("textarea.messagebox"),this.message_input.on("keydown",function(a){13==a.which&&(c._sendMessage(a),a.preventDefault())})},appendHtml:function(a,c,d){var e,f=this.$el.find(".share-list-container");c.$el.addClass("col-xs-12"),c.getModel().get("selected")===!0&&c.$el.addClass("share-highlight"),this.hasTextFilter===!0&&(this.setFilter(),b(".search-text",this.$el).val(this.textFilterValue)),0!==this.$el.find(".share-list-container .mCSB_container").length&&(f=this.$el.find(".share-list-container .mCSB_container")),0===d?f.prepend(c.$el):(e=f.children().eq(d),e.length?e.before(c.$el):f.append(c.$el));var g=this;return c.$el.click(function(a){a.preventDefault(),a.stopPropagation();var b=c.getModel();b.set("selected",!b.get("selected")),b.get("selected")===!0?this.className+=" share-highlight":this.className=this.className.replace(/share-highlight/gi,""),g.on("share_via_chat_sending",function(){this.resetSelection()})}),this.$el},events:{"click .share-send-button":"_sendMessage","click .icon-wb_search":"_filter"},_sendMessage:function(c){this.message_input||(this.message_input=this.$el.find("textarea.messagebox"));var d=a.escape(this.message_input.val()),e=b("#share-modal-url").val();""===d?d=decodeURIComponent(this.message.message):d+=" "+e;var f=this.collection.sendMessageToSelected(d);f>0&&(this.trigger("share_via_chat_sending"),b("#share-to-chat-modal").modal("hide"))},_showAddParticipant:function(a){a.preventDefault(),b(".chat-item-add-participant",this.$el).removeClass("hidden")},_filter:function(a){this.setTextFilter(b(".search-text",this.$el).val())},resize:function(a,c){this.decorator_height=b(".chat-footer",this.$el).height()+30,a&&b(".list-container",this.$el).height(a-this.decorator_height),c&&b(".list-container",this.$el).width(c-this.decorator_width)},setTextFilter:function(a){this.hasTextFilter=""!==a,this.textFilterValue=a,this.collection.sort(),this.render(),this.hasTextFilter?this.setFilter():this.resetFilter(),b(".search-text",this.$el).focus()},setFilter:function(){this.hideAll(),this.$el.find("."+this.itemDiv+":containsIgnoreCase('"+this.textFilterValue.toLowerCase()+"')").show(),this.$el.find(".share-highlight").children().show()},setMessage:function(a){this.message=a},hideAll:function(){this.$el.find("."+this.itemDiv).hide()},resetFilter:function(){this.$el.find("."+this.itemDiv).show()},resetSelection:function(){this.message_input||(this.message_input=this.$el.find("textarea.messagebox")),this.message_input.val(""),b(".share-highlight",this.$el).removeClass("share-highlight"),a.each(this.collection.models,function(a){a.set("selected",!1)})}}));return l}),define("modules/chat/views/share/share_contact_area",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/chat/expanded/chat-contact-area","modules/chat/views/chat_sidebar/contact_grid","modules/chat/models/contacts","modules/common/config","modules/common/utility","modules/globals/url","modules/chat/views/content_window_helper","modules/template/helpers/general_helpers","jquery.menuaim"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=14,o=e.ItemView.extend({template:{type:"handlebars",template:g},initialize:function(){a.bindAll(this),this._contact_list_view=null,this._showingOffline=!0,this._showingGroup=!0,this.model||(this.model=new c.Model({})),this.model.set("recommend_url",l.site+"search/users/")},events:{},onRender:function(){var c=this;a.delay(function(){c._contact_list_view=new h(b(".contact-list",c.$el)),c._contact_list_view.initialize_with_data(i.ContactGroupStore.getInstance())},100),this.initialize_setting_dropdown(),this.search_txt=b(".search-text",this.$el),this.search_txt.on("keyup",a.debounce(function(){c.setTextFilter(b(".search-text",this.$el).val())},500))},setTextFilter:function(a){this._contact_list_view.setTextFilter(a)},initialize_setting_dropdown:function(){var a=this;b("a.add-contact-group",this.$el).on("click",function(a){a.preventDefault(),m.show_window("add_contact_group")}),a.updateShowContactGroupText(),b("a.show-contact-group",this.$el).on("click",function(b){b.preventDefault(),a._showingGroup=!a._showingGroup,a._contact_list_view.toggleContactGroupDisplay(a._showingGroup),a.updateShowContactGroupText()}),a.updateShowOfflineContactsText(),b("a.show-offline-contacts",this.$el).on("click",function(b){b.preventDefault(),a._showingOffline=!a._showingOffline,a._contact_list_view.toggleOfflineContactDisplay(a._showingOffline),a.updateShowOfflineContactsText()})},resize:function(a,b){this._contact_list_view&&(a=a-this.$el.find(".chat-search").height()-this.$el.find(".chat-footer").height()-n,this._contact_list_view.resize(a,b))},updateShowContactGroupText:function(){b("a.show-contact-group",this.$el).text(this._showingGroup?k.translate("chat|contact-hide-contact-group"):k.translate("chat|contact-show-contact-group"))},updateShowOfflineContactsText:function(){b("a.show-offline-contacts",this.$el).text(this._showingOffline?k.translate("chat|contact-hide-offline"):k.translate("chat|contact-show-offline"))}});return o}),define("modules/chat/views/share/recent_chat_list_item_model",["modules/model/common/mig33_collection","modules/mig33_app","modules/common/config","modules/common/utility","modules/model/badge/badge_model","underscore","underscore.string","backbone","modules/globals/url","modules/chat/models/chats","modules/chat/models/chatrooms","modules/chat/models/contacts"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=k.ChatRoomCategoryStore.getInstance(),n=j.ChatStoreModel.getInstance(),o=36,p=36,q=h.Model.extend({idAttribute:"chat_handle"}),r=a.extend({model:q,comparator:function(a,b){return a.get("selected")===!0&&b.get("selected")===!1?-1:b.get("selected")===!0&&a.get("selected")===!1?1:-1*a.get("sortOrder")},initialize:function(){f.bindAll(this),n.on("chat_added",function(a){this.addFromChatModel(a),this.listenToChatModel(a)},this),n.on("chat_left",function(a){this.remove(a.get("chatHandle"))},this),n.on("chat_updated",function(a){console.log("A chat was updated")},this),m.on("chatroom_joined",function(a){this.addFromChatModel(a),this.listenToChatModel(a)},this),m.on("chatroom_display",function(a){this.addFromChatModel(a),this.listenToChatModel(a),this.trigger("focus_chat",a)},this),m.on("chatroom_left",function(a){this.remove(a.get("chatHandle"))},this)},addFromChatModel:function(a){var b=a.getTitle(),c=a.getDigestMessgeTimeStamp(),d=a.is_fusion_chat()?a.getTitle():"default";this.add({chatname:g.truncate(b,40),is_chatroom:a.is_chat_room(),is_group_chat:a.is_group_chat(),is_private_chat:!(a.is_chat_room()||a.is_group_chat()),chat_handle:a.get("chatHandle"),display_pic:i.image+"/dp/"+d+"?w="+o+"&h="+p+"&a=1&c=1",sortOrder:a.getSortOrder(),unreadCount:this._getUnreadCount(a),displayTime:this._parseTime(c),fullTime:this._parseFullTime(c),lastMessage:this._parseLastMessage(a.getDigestMessageString()),timeInt:c,selected:!1});var e=this.get(a.get("chatHandle"));e.off("chat_list_click"),e.off("chat_list_close_click")},_getViewModel:function(a){return this.get(a.get("chatHandle"))},updateTitle:function(a){var b=a.getTitle();b=g.truncate(b,40);var c=this._getViewModel(a);c&&c.set({chatname:b})},_getUnreadCount:function(a){var b=a.get_unread_message_count();return b>0&&99>b?b+"":b>99?"99+":a.is_chat_synched()?"":"1+"},numDaysBetween:function(a,b){var c=Math.abs(a.getTime()-b.getTime());return c/864e5},_parseFullTime:function(a){var b="ddd mmm dd yyyy HH:MM:ss",c=d.dateFormat(a,b);return c},_parseTime:function(a){var b=new Date(a),c=new Date;c.setHours(0,0,0,0);var e="dd mmm";b>c?e="HH:MM":this.numDaysBetween(c,b)<=7&&(e="ddd");var f=d.dateFormat(a,e);return f},_parseLastMessage:function(a){return a=d.htmlDecode(a),a&&a.length>48&&(a=g.truncate(a,48),a+="..."),a},setLastMessage:function(a,b){a.set({lastMessage:this._parseLastMessage(b)})},sendMessageToSelected:function(a){var b=0;return f.each(this.models,function(c){c.get("selected")===!0&&(b++,c.get("is_chatroom")?m.get_chatroom_by_name(c.get("chatname")).addUserTextMessage(a):n.getChat(c.get("chat_handle")).addUserTextMessage(a))}),b},listenToChatModel:function(a){a.is_group_chat()&&(a.on("participant_added",function(){this.updateTitle(a)},this),a.on("change:destinationName",function(){this.updateTitle(a)},this)),a.on("chat_message_added",function(){var b=this._getViewModel(a);this.setLastMessage(b,a.getDigestMessageString())},this),a.on("digest_change",function(){var b=this._getViewModel(a);this.setLastMessage(b,a.getDigestMessageString())},this)}});return new r}),define("modules/chat/views/share/contact_list_item_model",["modules/model/common/mig33_collection","modules/mig33_app","modules/common/config","modules/common/utility","modules/model/badge/badge_model","underscore","underscore.string","backbone","modules/globals/url","modules/chat/models/chats","modules/chat/models/chatrooms","modules/chat/models/contacts"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=(k.ChatRoomCategoryStore.getInstance(),j.ChatStoreModel.getInstance()),n=l.ContactGroupStore.getInstance(),o=36,p=36,q=h.Model.extend({idAttribute:"contact_id"}),r=a.extend({model:q,comparator:function(a,b){return a.get("selected")===!0&&b.get("selected")===!1?-1:b.get("selected")===!0&&a.get("selected")===!1?1:a.get("display_name")>b.get("display_name")?1:b.get("display_name")>a.get("display_name")?-1:0},initialize:function(){f.bindAll(this),n.on("contact_added",function(a){this.addFromContactModel(a),this.listenToContactModel(a)},this),n.on("contacts_load_complete",function(a){this.addFromContactsCollection(a)},this),n.on("contact_removed",function(a){this.remove(a.get("contactId"))},this),n.on("contact_updated",function(a){console.log("A contact was updated")},this)},addFromContactsCollection:function(a){var b=this;f.each(a.models,function(a){b.addFromContactModel(a),b.listenToContactModel(a)})},addFromContactModel:function(a){this.add({chatname:g.truncate(a.getDisplayName(),40),is_chatroom:!1,is_group_chat:!1,is_private_chat:!0,chat_handle:a.get("contactId"),contact_id:a.get("contactId"),display_name:a.getDisplayName(),username:a.getUsername(),type:a.getType(),lastMessage:this._parseLastMessage(a.get("statusMessage")),display_pic:i.image+"/dp/"+a.getDisplayName()+"?w="+o+"&h="+p+"&a=1&c=1",sortOrder:a.getDisplayName(),unreadCount:0,displayTime:"",fullTime:"",timeInt:0,selected:!1})},_parseLastMessage:function(a){return a=d.htmlDecode(a),a&&a.length>48&&(a=g.truncate(a,48),a+="..."),a},sendMessageToSelected:function(a){var b=0;return f.each(this.models,function(c){if(c.get("selected")===!0){b++;var d=m.startPrivateChat(c.get("contact_id"),c.get("chatname"),c.get("type"),c.get("username"),!0);d.addUserTextMessage(a)}}),b},listenToContactModel:function(a){}});return new r}),define("modules/view/common/share_to_chat_modal_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/chat/share/share-to-chat-modal","modules/chat/views/share/share_to_recent_chat","modules/chat/views/share/share_contact_area","modules/chat/views/share/recent_chat_list_item_model","modules/chat/views/share/contact_list_item_model","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=!1,o=null,p=null,q=e.ItemView.extend({template:{type:"handlebars",template:g},id:"share-to-chat-modal",className:"modal fade",events:{"click .tab-share-chat":"_showShareChat","click .tab-share-contact":"_showShareContact"},onRender:function(){this.$el.data("shareToChatModalViewObject",this),this.delegateEvents(),this.init()},init:function(){o=new h({model:new c.Model,collection:j}),p=new h({model:new c.Model,collection:k}),this._showShareChat()},populate:function(a,c){var d=m.translate("share|"+a),e=m.translate("share|chat_title",d);b("#share-chat-modal-title").text(e),o.setMessage(c),p.setMessage(c),n!==!0&&(n=!0,b(".share-chat-list",this.$el).append(o.render().el),b(".share-contact-list",this.$el).append(p.render().el))},_showShareChat:function(){b(".tab-share-chat",this.$el).addClass("active"),b(".tab-share-contact",this.$el).removeClass("active"),b(".share-chat-list",this.$el).removeClass("hidden"),b(".share-contact-list",this.$el).addClass("hidden")},_showShareContact:function(){b(".tab-share-contact",this.$el).addClass("active"),b(".tab-share-chat",this.$el).removeClass("active"),b(".share-contact-list",this.$el).removeClass("hidden"),b(".share-chat-list",this.$el).addClass("hidden")}});return q}),define("hbs!modules/template/common/sharebox-modal",["handlebars"],function(a){return a.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},'<div class="modal-dialog">\n	<div class="modal-content">\n		<div class="modal-body postbox"></div>\n	</div>\n</div>\n'})}),define("hbs!modules/template/common/postbox-modal",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+="<a href='#' class='font-color-grey insert-emoticon' data-emoticon='",(e=c.hotkey)?d=e.call(a,{hash:{},data:b}):(e=a&&a.hotkey,d=typeof e===t?e.call(a,{hash:{},data:b}):e),f+=u(d)+"'><img width='16' height='16' title='",(e=c.name)?d=e.call(a,{hash:{},data:b}):(e=a&&a.name,d=typeof e===t?e.call(a,{hash:{},data:b}):e),f+=u(d)+"' alt='",(e=c.name)?d=e.call(a,{hash:{},data:b}):(e=a&&a.name,d=typeof e===t?e.call(a,{hash:{},data:b}):e),f+=u(d)+"' src='",(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===t?e.call(a,{hash:{},data:b}):e),f+=u(d)+"' /></a>"}function g(a,b){var c,d="";return d+="\n					"+u((c=a&&a.variables,c=null==c||c===!1?c:c.characters_count,c=null==c||c===!1?c:c.long_post,typeof c===t?c.apply(a):c))+"\n				"}function h(a,b){var c,d="";return d+="\n					"+u((c=a&&a.variables,c=null==c||c===!1?c:c.characters_count,c=null==c||c===!1?c:c.normal_post,typeof c===t?c.apply(a):c))+"\n				"}function i(a,b){var d,e,f,g="";return g+='\n					<div class="postbox-facebook-field">\n				    ',e=c.ifSessionUserSettingsThirdPartySite||a&&a.ifSessionUserSettingsThirdPartySite,f={hash:{},inverse:w.program(10,k,b),fn:w.program(8,j,b),data:b},d=e?e.call(a,"linked|facebook",f):v.call(a,"ifSessionUserSettingsThirdPartySite","linked|facebook",f),(d||0===d)&&(g+=d),g+="\n					</div>\n				"}function j(a,b){return'\n							<input type="checkbox" name="post_to_facebook" />\n							<span class="icon-wb_facebook post-to-facebook">Facebook</span>\n						'}function k(a,b){var d,e,f="";return f+='\n							<input type="checkbox" name="post_to_facebook" value="0" disabled />\n							<a href="'+u((d=c.getUrl||a&&a.getUrl,e={hash:{},data:b},d?d.call(a,"settings",e):v.call(a,"getUrl","settings",e)))+'/connect_apps" title="'+u((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"homefeed|postbox_to_facebook",e):v.call(a,"translate","homefeed|postbox_to_facebook",e)))+'">\n								<span class="icon-wb_facebook icon--disabled">Facebook</span>\n							</a>\n						'}function l(a,b){var d,e,f,g="";return g+='\n					<div class="postbox-twitter-field">\n					',e=c.ifSessionUserSettingsThirdPartySite||a&&a.ifSessionUserSettingsThirdPartySite,f={hash:{},inverse:w.program(15,n,b),fn:w.program(13,m,b),data:b},d=e?e.call(a,"linked|twitter",f):v.call(a,"ifSessionUserSettingsThirdPartySite","linked|twitter",f),(d||0===d)&&(g+=d),g+="\n					</div>\n				"}function m(a,b){return'\n						<input type="checkbox" name="post_to_twitter" />\n						<span class="icon-wb_twitter post-to-twitter">Twitter</span>\n					'}function n(a,b){var d,e,f="";return f+='\n						<input type="checkbox" name="post_to_twitter" value="0" disabled />\n						<a href="'+u((d=c.getUrl||a&&a.getUrl,e={hash:{},data:b},d?d.call(a,"settings",e):v.call(a,"getUrl","settings",e)))+'/connect_apps" title="'+u((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"homefeed|postbox_to_twitter",e):v.call(a,"translate","homefeed|postbox_to_twitter",e)))+'">\n							<span class="icon-wb_twitter icon--disabled">Twitter</span>\n						</a>\n					'}function o(a,b){var d,e,f="";return f+='\n			<li>\n				<input type="checkbox" id="postbox_allow_replies" name="reply_permission" value="0" checked="checked" />\n				<label for="postbox_allow_replies" class="postbox-post-privacy-type" >'+u((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"homefeed|postbox_allow_replies",e):v.call(a,"translate","homefeed|postbox_allow_replies",e)))+"</label>\n			</li>\n	        "}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var p,q,r,s="",t="function",u=this.escapeExpression,v=c.helperMissing,w=this,x=c.blockHelperMissing;return s+='<div class="postbox-content">\n	<div class="row postbox-body-media">\n		<div class="col-xs-12">\n			<div class="right postbox-media-option">\n				<div class="postbox-submit">\n					<a class="font-color-grey" href="#" class="text-center">\n						<span class="icon-wb_send" title="'+u((q=c.translate||b&&b.translate,r={hash:{},data:e},q?q.call(b,"common|share",r):v.call(b,"translate","common|share",r)))+'"></span>\n					</a>\n				</div>\n			</div>\n			<div class="postbox-body-wrapper">\n				<div class="postbox-content-sample">\n					<img src="'+u((q=c.getSessionUserDisplayPictureUrl||b&&b.getSessionUserDisplayPictureUrl,r={hash:{},data:e},q?q.call(b,150,150,r):v.call(b,"getSessionUserDisplayPictureUrl",150,150,r)))+'" width="24"height="24" class="img-circle" />\n					<span class="username">'+u((p=b&&b.session_user,p=null==p||p===!1?p:p.username,typeof p===t?p.apply(b):p))+'</span>\n					<div class="postbox">\n						<div class="postbox-dragdrop-text">'+u((q=c.translate||b&&b.translate,r={hash:{},data:e},q?q.call(b,"homefeed|postbox_drop_image",r):v.call(b,"translate","homefeed|postbox_drop_image",r)))+'</div>\n					</div>\n				</div>\n				<div class="postbox-media-wrapper sample">\n					<a href="#" class="close hidden">&times;</a>\n					<input type="file" name="media" accept="image/*" class="postbox-media-upload" style="display: none;" />\n					<img class="postbox-media hidden" />\n					<div class="clear"></div>\n				</div>\n				<textarea rows=\'1\' cols=\'50\' style=\'overflow:auto\' class="postbox-textarea form-control" name="body" placeholder="'+u((q=c.translate||b&&b.translate,r={hash:{},data:e},q?q.call(b,"homefeed|say_something_user",(p=b&&b.session_user,null==p||p===!1?p:p.username),r):v.call(b,"translate","homefeed|say_something_user",(p=b&&b.session_user,null==p||p===!1?p:p.username),r)))+'"></textarea>\n\n                <div class="achievement-reshare">\n                </div>\n			</div>\n		</div>\n	</div>\n	\n	<div class="postbox-footer">\n		<div class="left ">\n			<div class="postbox-media-option">\n				<span>\n					<a href="#" class="insert-photo font-color-grey text-center">\n						<span class="icon-wb_image icon-postupload" title="'+u((q=c.translate||b&&b.translate,r={hash:{},data:e},q?q.call(b,"homefeed|postbox_attach_image",r):v.call(b,"translate","homefeed|postbox_attach_image",r)))+'"></span>\n					</a>\n				</span>\n				<span>\n					<a href="#"\n					class="insert-emoticons font-color-grey"\n					data-toggle="clickover"\n					data-placement="bottom"\n					data-html="true"\n					data-animation="false"\n					data-content="',p=b&&b.variables,p=null==p||p===!1?p:p.emoticons,p=typeof p===t?p.apply(b):p,p=x.call(b,p,{hash:{},inverse:w.noop,fn:w.program(1,f,e),data:e}),(p||0===p)&&(s+=p),s+='">\n					<span class="icon-wb_emoticon" title="'+u((q=c.translate||b&&b.translate,r={hash:{},data:e},q?q.call(b,"homefeed|emotions",r):v.call(b,"translate","homefeed|emotions",r)))+'"></span>\n					</a>\n				</span>\n			</div>\n		</div>\n	    <div class="repost-media-options">\n			<div class="right postbox-media-option">\n				<span class="postbox-advance-option">\n				...\n				</span>\n			</div>\n		</div>\n	    <div class="repost-media-options">\n			<div class="right postbox-media-option">\n				<span class="postbox-charcount">\n				',p=c["if"].call(b,(p=b&&b.session_user,p=null==p||p===!1?p:p.label,null==p||p===!1?p:p.verified),{hash:{},inverse:w.program(5,h,e),fn:w.program(3,g,e),data:e}),(p||0===p)&&(s+=p),s+='\n				</span>\n			</div>\n		</div>\n	</div>\n	<div class="postbox-footer-sub hidden">\n		<h3>\n			ALSO SHARE ON\n		</h3>\n		<ul>\n			<li>\n				',
q=c.ifSessionUserSettingsThirdPartySite||b&&b.ifSessionUserSettingsThirdPartySite,r={hash:{},inverse:w.noop,fn:w.program(7,i,e),data:e},p=q?q.call(b,"status|facebook",r):v.call(b,"ifSessionUserSettingsThirdPartySite","status|facebook",r),(p||0===p)&&(s+=p),s+="\n			</li>\n			<li>\n				",q=c.ifSessionUserSettingsThirdPartySite||b&&b.ifSessionUserSettingsThirdPartySite,r={hash:{},inverse:w.noop,fn:w.program(12,l,e),data:e},p=q?q.call(b,"status|twitter",r):v.call(b,"ifSessionUserSettingsThirdPartySite","status|twitter",r),(p||0===p)&&(s+=p),s+='\n			</li>\n		</ul>\n		<h3>\n			SHOW TO\n		</h3>\n		<ul>\n			<li>\n				<input type="radio" id="public" name="privacy" value="0" checked="checked" />\n				<label for="public" class="postbox-post-privacy-type postbox-post-privacy-select">'+u((q=c.translate||b&&b.translate,r={hash:{},data:e},q?q.call(b,"common|public",r):v.call(b,"translate","common|public",r)))+'</label>\n			</li>\n			<li>\n				<input type="radio" id="postbox_friends_only" name="privacy" value="1" />\n				<label for="postbox_friends_only" class="postbox-post-privacy-type postbox-post-privacy-select">'+u((q=c.translate||b&&b.translate,r={hash:{},data:e},q?q.call(b,"homefeed|postbox_friends_only",r):v.call(b,"translate","homefeed|postbox_friends_only",r)))+'</label>\n			</li>\n			<li>\n				<input type="radio" id="myself" name="privacy" value="2" />\n				<label for="myself" class="postbox-post-privacy-type postbox-post-privacy-select">'+u((q=c.translate||b&&b.translate,r={hash:{},data:e},q?q.call(b,"user|myself",r):v.call(b,"translate","user|myself",r)))+"</label>\n			</li>\n	        ",q=c.ifSystemPropertyEnabled||b&&b.ifSystemPropertyEnabled,r={hash:{},inverse:w.noop,fn:w.program(17,o,e),data:e},p=q?q.call(b,"post_reply_permission",r):v.call(b,"ifSystemPropertyEnabled","post_reply_permission",r),(p||0===p)&&(s+=p),s+="\n		</ul>\n	</div>\n</div>"})}),define("hbs!modules/template/common/postbox",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+="<a href='#' class=' font-color-grey insert-emoticon' data-emoticon='",(e=c.hotkey)?d=e.call(a,{hash:{},data:b}):(e=a&&a.hotkey,d=typeof e===k?e.call(a,{hash:{},data:b}):e),f+=l(d)+"'><img width='16' height='16' title='",(e=c.name)?d=e.call(a,{hash:{},data:b}):(e=a&&a.name,d=typeof e===k?e.call(a,{hash:{},data:b}):e),f+=l(d)+"' alt='",(e=c.name)?d=e.call(a,{hash:{},data:b}):(e=a&&a.name,d=typeof e===k?e.call(a,{hash:{},data:b}):e),f+=l(d)+"' src='",(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===k?e.call(a,{hash:{},data:b}):e),f+=l(d)+"' /></a>"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var g,h,i,j="",k="function",l=this.escapeExpression,m=c.helperMissing,n=this,o=c.blockHelperMissing;return j+='<div class="col-xs-12">\n	<div class="postbox">\n		<form action="post" method="post" accept-charset="utf-8" enctype="multipart/form-data">\n			<input type="hidden" name="originality" value="1" />\n			\n			<div class="postbox-progress-wrapper">\n				<div class="row">\n					<div class="col-xs-12">\n						<div class="bar"></div>\n					</div>\n				</div>\n			</div>\n			\n			<div class="postbox-content">\n				<div class="row postbox-body-media">\n					<div class="col-xs-12">\n						<div class="left">\n							<div class="postbox-media-option">\n								<span>\n									<a href="#" class="insert-photo font-color-grey text-center">\n										<span class="icon-wb_image icon-postupload" title="'+l((h=c.translate||b&&b.translate,i={hash:{},data:e},h?h.call(b,"homefeed|postbox_attach_image",i):m.call(b,"translate","homefeed|postbox_attach_image",i)))+'"></span>\n									</a>\n								</span>\n								<span>\n									<a href="#"\n									class="insert-emoticons font-color-grey"\n									data-toggle="clickover"\n									data-placement="bottom"\n									data-html="true"\n									data-animation="false"\n									data-content="',g=b&&b.variables,g=null==g||g===!1?g:g.emoticons,g=typeof g===k?g.apply(b):g,g=o.call(b,g,{hash:{},inverse:n.noop,fn:n.program(1,f,e),data:e}),(g||0===g)&&(j+=g),j+='">\n									<span class="icon-wb_emoticon" title="'+l((h=c.translate||b&&b.translate,i={hash:{},data:e},h?h.call(b,"homefeed|emotions",i):m.call(b,"translate","homefeed|emotions",i)))+'"></span>\n									</a>\n								</span>\n							</div>\n							<div class="postbox-media-wrapper">\n								<a href="#" class="close hidden">&times;</a>\n								<input type="file" name="media" accept="image/*" class="postbox-media-upload" style="display: none;" />\n								<img class="postbox-media hidden" />\n								<div class="clear"></div>\n							</div>\n						</div>\n						<div class="right postbox-media-option post-reaction-gift">\n							<a href="#" class="btn-send-gift" title="'+l((h=c.translate||b&&b.translate,i={hash:{},data:e},h?h.call(b,"post|send_gift",i):m.call(b,"translate","post|send_gift",i)))+'">\n								<span class="icon-wb_gift"></span>\n							</a>\n						</div>\n						<div class="right postbox-media-option post-reaction-submit hidden">\n							<div class="postbox-submit">\n								<a href="#" class="text-center">\n									<span class="icon-wb_send" title="'+l((h=c.translate||b&&b.translate,i={hash:{},data:e},h?h.call(b,"common|share",i):m.call(b,"translate","common|share",i)))+'"></span>\n								</a>\n							</div>\n						</div>\n						<div class="postbox-body-wrapper">\n							<textarea rows=\'1\' cols=\'50\' style=\'overflow:auto\' class="postbox-textarea form-control" name="body" placeholder="'+l((h=c.translate||b&&b.translate,i={hash:{},data:e},h?h.call(b,"homefeed|say_something_user",(g=b&&b.session_user,null==g||g===!1?g:g.username),i):m.call(b,"translate","homefeed|say_something_user",(g=b&&b.session_user,null==g||g===!1?g:g.username),i)))+'"></textarea>\n						</div>\n					</div>\n				</div>\n			</div>\n        </form>\n    </div>\n</div>'})}),define("modules/common/nue",["require","exports","underscore","jquery","modules/globals/url","modules/common/config","modules/common/utility"],function(a,b){var c=(a("underscore"),a("jquery")),d=(a("modules/globals/url"),a("modules/common/config")),e=a("modules/common/utility"),f=a("modules/common/local_storage"),g=function(){function b(){if(null!==b.instance)throw"Please use nue.getInstance() to get the nue instance"}return b.getInstance=function(){return null===b.instance&&(b.instance=new b),b.instance},b.prototype.send_post=function(b){console.log("posting post before user login/register");var f=this;c.ajax({type:"post",cache:!1,contentType:!1,processData:!1,dataType:"json",url:d.urls.create_post_url,data:b}).done(function(b){var d;f.clear_nue_local_storage();var g=e.parse_ajax_response(b);if(g.error)return void e.show_error(g.error);if(g.permalink){var h=g.permalink.replace(/^(?:\/\/|[^\/]+)*\//,"");Backbone.history.navigate(h,{trigger:!0})}d=g.group&&g.group.id?g.group.id:0;var i=a("modules/mig33_app");d?(c(window).trigger("resize"),g.from_group_id&&(e.show_success(e.translate("post|success_post")),i.vent.trigger(e.format(i.ApplicationEvents.GROUP_POST_ADDED,d),g))):2===g.originality?(e.show_success(e.translate("post|success_reply")),i.vent.trigger(i.ApplicationEvents.POST_REPLY_ADDED,g)):3===g.originality?(e.show_success(e.translate("post|success_share")),i.vent.trigger(i.ApplicationEvents.POST_REPLY_ADDED,g)):(e.show_success(e.translate("post|success_post")),i.vent.trigger(i.ApplicationEvents.POST_ADDED,g),c(window).trigger("resize")),i.vent.trigger(i.ApplicationEvents.POST_ADDED_DONE,g)}).fail(function(a,b,c){e.show_error(c)})},b.prototype.clear_nue_local_storage=function(){f.remove("nue_data"),f.remove("nue_action"),f.remove("nue_expiry")},b.prototype.startChecking=function(){var a=f.get("nue_action"),b=f.get("nue_expiry"),c=f.get("nue_data");if(null!==c&&e.is_logged_in()){var d=new Date;if(null===b||b<d.getTime())this.clear_nue_local_storage();else if(null!==a&&"post"==a){var g=new FormData;for(var h in c)if(g.append(h,c[h]),"media"==h){var i=e.dataURItoBlob(c[h]);g.append(h,i)}this.send_post(g)}}},b.prototype.store_nue_action=function(a,b){var c=new Date,d=72e5;f.set("nue_expiry",c.getTime()+d),f.set("nue_action",a),f.set("nue_data",b)},b.instance=null,b}();b.nue=g}),function(){!function(a){return a(window.jQuery)}(function(a){var b,c,d,e;return e="caret",b=function(){function b(a){this.$inputor=a,this.domInputor=this.$inputor[0]}return b.prototype.getPos=function(){var a,b,c,d,e,f,g,h,i;return c=this.domInputor,c.focus(),document.selection?(g=document.selection.createRange(),f=0,g&&g.parentElement()===c&&(e=c.value.replace(/\r\n/g,"\n"),d=e.length,i=c.createTextRange(),i.moveToBookmark(g.getBookmark()),b=c.createTextRange(),b.collapse(!1),i.compareEndPoints("StartToEnd",b)>-1?h=a=d:(h=-i.moveStart("character",-d),a=-i.moveEnd("character",-d)))):h=c.selectionStart,h},b.prototype.setPos=function(a){var b,c;return b=this.domInputor,document.selection?(c=b.createTextRange(),c.move("character",a),c.select()):b.setSelectionRange(a,a)},b.prototype.getPosition=function(a){var b,d,e,f,g,h,i,j,k;return b=this.$inputor,e=function(a){return a.replace(/</g,"&lt").replace(/>/g,"&gt").replace(/`/g,"&#96").replace(/"/g,"&quot").replace(/\r\n|\r|\n/g,"<br />")},a=a||this.getPos(),i=b.val().slice(0,a),g="<span>"+e(i)+"</span>",g+="<span id='caret'>|</span>",h=new c(b),d=h.create(g).rect(),j=d.left-b.scrollLeft(),k=d.top-b.scrollTop(),f=d.height,{left:j,top:k,height:f}},b.prototype.getOffset=function(b){var c,d,e,f,g,h,i;return c=this.$inputor,document.selection?(g=this.domInputor.createTextRange(),b&&g.move("character",b),h=g.boundingLeft+c.scrollLeft(),i=g.boundingTop+a(window).scrollTop()+c.scrollTop(),d=g.boundingHeight):(e=c.offset(),f=this.getPosition(b),h=e.left+f.left,i=e.top+f.top,d=f.height),{left:h,top:i,height:d}},b}(),c=function(){function b(a){this.$inputor=a}return b.prototype.css_attr=["overflowY","height","width","paddingTop","paddingLeft","paddingRight","paddingBottom","marginTop","marginLeft","marginRight","marginBottom","fontFamily","borderStyle","borderWidth","wordWrap","fontSize","lineHeight","overflowX","text-align"],b.prototype.mirrorCss=function(){var b,c=this;return b={position:"absolute",left:-9999,top:0,zIndex:-2e4,"white-space":"pre-wrap"},a.each(this.css_attr,function(a,d){return b[d]=c.$inputor.css(d)}),b},b.prototype.create=function(b){return this.$mirror=a("<div></div>"),this.$mirror.css(this.mirrorCss()),this.$mirror.html(b),this.$inputor.after(this.$mirror),this},b.prototype.rect=function(){var a,b,c;return a=this.$mirror.find("#caret"),b=a.position(),c={left:b.left,top:b.top,height:a.height()},this.$mirror.remove(),c},b}(),d={pos:function(a){return a?this.setPos(a):this.getPos()},position:function(a){return this.getPosition(a)},offset:function(a){return this.getOffset(a)}},a.fn.caret=function(c){var e;return e=new b(this),d[c]?d[c].apply(e,Array.prototype.slice.call(arguments,1)):a.error("Method "+c+" does not exist on jQuery.caret")}})}.call(this),define("jquery.caret",["jquery"],function(){}),function(){!function(a){return"function"==typeof define&&define.amd?define("jquery.atwho",["jquery"],a):a(window.jQuery)}(function(a){var b,c,d,e,f,g,h,i,j,k=[].slice;d=function(){function b(b){this.current_flag=null,this.controllers={},this.alias_maps={},this.$inputor=a(b),this.listen()}return b.prototype.controller=function(a){return this.controllers[this.alias_maps[a]||a||this.current_flag]},b.prototype.set_context_for=function(a){return this.current_flag=a,this},b.prototype.reg=function(a,b){var c,d;return c=(d=this.controllers)[a]||(d[a]=new f(this,a)),b.alias&&(this.alias_maps[b.alias]=a),c.init(b),this},b.prototype.listen=function(){return this.$inputor.on("keyup.atwhoInner",function(a){return function(b){return a.on_keyup(b)}}(this)).on("keydown.atwhoInner",function(a){return function(b){return a.on_keydown(b)}}(this)).on("scroll.atwhoInner",function(a){return function(b){var c;return null!=(c=a.controller())?c.view.hide():void 0}}(this)).on("blur.atwhoInner",function(a){return function(b){var c;return(c=a.controller())?c.view.hide(c.get_opt("display_timeout")):void 0}}(this))},b.prototype.shutdown=function(){var a,b,c;c=this.controllers;for(b in c)a=c[b],a.destroy();return this.$inputor.off(".atwhoInner")},b.prototype.dispatch=function(){return a.map(this.controllers,function(a){return function(b){return b.look_up()?a.set_context_for(b.at):void 0}}(this))},b.prototype.on_keyup=function(b){var c;switch(b.keyCode){case h.ESC:b.preventDefault(),null!=(c=this.controller())&&c.view.hide();break;case h.DOWN:case h.UP:a.noop();break;default:this.dispatch()}},b.prototype.on_keydown=function(b){var c,d;if(c=null!=(d=this.controller())?d.view:void 0,c&&c.visible())switch(b.keyCode){case h.ESC:b.preventDefault(),c.hide();break;case h.UP:b.preventDefault(),c.prev();break;case h.DOWN:b.preventDefault(),c.next();break;case h.TAB:case h.ENTER:if(!c.visible())return;b.preventDefault(),c.choose();break;default:a.noop()}},b}(),f=function(){function c(c,e){this.app=c,this.at=e,this.$inputor=this.app.$inputor,this.oDocument=this.$inputor[0].ownerDocument,this.oWindow=this.oDocument.defaultView||this.oDocument.parentWindow,this.id=this.$inputor[0].id||d(),this.setting=null,this.query=null,this.pos=0,this.cur_rect=null,this.range=null,b.append(this.$el=a("<div id='atwho-ground-"+this.id+"'></div>")),this.model=new i(this),this.view=new j(this)}var d,e;return e=0,d=function(){return e+=1},c.prototype.init=function(b){return this.setting=a.extend({},this.setting||a.fn.atwho["default"],b),this.view.init(),this.model.reload(this.setting.data)},c.prototype.destroy=function(){return this.trigger("beforeDestroy"),this.model.destroy(),this.view.destroy()},c.prototype.call_default=function(){var b,c,d;d=arguments[0],b=2<=arguments.length?k.call(arguments,1):[];try{return g[d].apply(this,b)}catch(e){return c=e,a.error(""+c+" Or maybe At.js doesn't have function "+d)}},c.prototype.trigger=function(a,b){var c,d;return null==b&&(b=[]),b.push(this),c=this.get_opt("alias"),d=c?""+a+"-"+c+".atwho":""+a+".atwho",this.$inputor.trigger(d,b)},c.prototype.callbacks=function(a){return this.get_opt("callbacks")[a]||g[a]},c.prototype.get_opt=function(a,b){var c;try{return this.setting[a]}catch(d){return c=d,null}},c.prototype.content=function(){return this.$inputor.is("textarea, input")?this.$inputor.val():this.$inputor.text()},c.prototype.catch_query=function(){var a,b,c,d,e,f;return b=this.content(),a=this.$inputor.caret("pos"),f=b.slice(0,a),d=this.callbacks("matcher").call(this,this.at,f,this.get_opt("start_with_space")),"string"==typeof d&&d.length<=this.get_opt("max_len",20)?(e=a-d.length,c=e+d.length,this.pos=e,d={text:d.toLowerCase(),head_pos:e,end_pos:c},this.trigger("matched",[this.at,d.text])):this.view.hide(),this.query=d},c.prototype.rect=function(){var a,b;if(a=this.$inputor.caret("offset",this.pos-1))return"true"===this.$inputor.attr("contentEditable")&&(a=this.cur_rect||(this.cur_rect=a)||a),b=document.selection?0:2,{left:a.left,top:a.top,bottom:a.top+a.height+b}},c.prototype.reset_rect=function(){return"true"===this.$inputor.attr("contentEditable")?this.cur_rect=null:void 0},c.prototype.mark_range=function(){return"true"===this.$inputor.attr("contentEditable")&&(this.oWindow.getSelection&&(this.range=this.oWindow.getSelection().getRangeAt(0)),this.oDocument.selection)?this.ie8_range=this.oDocument.selection.createRange():void 0},c.prototype.insert_content_for=function(b){var c,d,e;return d=b.data("value"),e=this.get_opt("insert_tpl"),this.$inputor.is("textarea, input")||!e?d:(c=a.extend({},b.data("item-data"),{"atwho-data-value":d,"atwho-at":this.at}),this.callbacks("tpl_eval").call(this,e,c))},c.prototype.insert=function(b,c){var d,e,f,g,h,i,j,k,l,m,n;return d=this.$inputor,"true"===d.attr("contentEditable")&&(f="atwho-view-flag atwho-view-flag-"+(this.get_opt("alias")||this.at),g=""+b+"<span contenteditable='false'>&nbsp;<span>",h="<span contenteditable='false' class='"+f+"'>"+g+"</span>",e=a(h,this.oDocument).data("atwho-data-item",c.data("item-data")),this.oDocument.selection&&(e=a("<span contenteditable='true'></span>",this.oDocument).html(e))),d.is("textarea, input")?(b=""+b,l=d.val(),m=l.slice(0,Math.max(this.query.head_pos-this.at.length,0)),n=""+m+b+" "+l.slice(this.query.end_pos||0),d.val(n),d.caret("pos",m.length+b.length+1)):(j=this.range)?(i=j.startOffset-(this.query.end_pos-this.query.head_pos)-this.at.length,j.setStart(j.endContainer,Math.max(i,0)),j.setEnd(j.endContainer,j.endOffset),j.deleteContents(),j.insertNode(e[0]),j.collapse(!1),k=this.oWindow.getSelection(),k.removeAllRanges(),k.addRange(j)):(j=this.ie8_range)&&(j.moveStart("character",this.query.end_pos-this.query.head_pos-this.at.length),j.pasteHTML(g),j.collapse(!1),j.select()),d.is(":focus")||d.focus(),d.change()},c.prototype.render_view=function(a){var b;return b=this.get_opt("search_key"),a=this.callbacks("sorter").call(this,this.query.text,a.slice(0,1001),b),this.view.render(a.slice(0,this.get_opt("limit")))},c.prototype.look_up=function(){var b,c;if(b=this.catch_query())return c=function(a){return a&&a.length>0?this.render_view(a):this.view.hide()},this.model.query(b.text,a.proxy(c,this)),b},c}(),i=function(){function b(a){this.context=a,this.at=this.context.at,this.storage=this.context.$inputor}return b.prototype.destroy=function(){return this.storage.data(this.at,null)},b.prototype.saved=function(){return this.fetch()>0},b.prototype.query=function(a,b){var c,d,e;return c=this.fetch(),d=this.context.get_opt("search_key"),c=this.context.callbacks("filter").call(this.context,a,c,d)||[],e=this.context.callbacks("remote_filter"),c.length>0||!e&&0===c.length?b(c):e.call(this.context,a,b)},b.prototype.fetch=function(){return this.storage.data(this.at)||[]},b.prototype.save=function(a){return this.storage.data(this.at,this.context.callbacks("before_save").call(this.context,a||[]))},b.prototype.load=function(a){return!this.saved()&&a?this._load(a):void 0},b.prototype.reload=function(a){return this._load(a)},b.prototype._load=function(b){return"string"==typeof b?a.ajax(b,{dataType:"json"}).done(function(a){return function(b){return a.save(b)}}(this)):this.save(b)},b}(),j=function(){function b(b){this.context=b,this.$el=a("<div class='atwho-view'><ul class='atwho-view-ul'></ul></div>"),this.timeout_id=null,this.context.$el.append(this.$el),this.bind_event()}return b.prototype.init=function(){var a;return a=this.context.get_opt("alias")||this.context.at.charCodeAt(0),this.$el.attr({id:"at-view-"+a})},b.prototype.destroy=function(){return this.$el.remove()},b.prototype.bind_event=function(){var b;return b=this.$el.find("ul"),b.on("mouseenter.atwho-view","li",function(c){return b.find(".cur").removeClass("cur"),a(c.currentTarget).addClass("cur")}).on("click",function(a){return function(b){return a.choose(),b.preventDefault()}}(this))},b.prototype.visible=function(){return this.$el.is(":visible")},b.prototype.choose=function(){var a,b;return a=this.$el.find(".cur"),b=this.context.insert_content_for(a),this.context.insert(this.context.callbacks("before_insert").call(this.context,b,a),a),this.context.trigger("inserted",[a]),this.hide()},b.prototype.reposition=function(b){var c;return b.bottom+this.$el.height()-a(window).scrollTop()>a(window).height()&&(b.bottom=b.top-this.$el.height()),c={left:b.left,top:b.bottom},this.$el.offset(c),this.context.trigger("reposition",[c])},b.prototype.next=function(){var a,b;return a=this.$el.find(".cur").removeClass("cur"),b=a.next(),b.length||(b=this.$el.find("li:first")),b.addClass("cur")},b.prototype.prev=function(){var a,b;return a=this.$el.find(".cur").removeClass("cur"),b=a.prev(),b.length||(b=this.$el.find("li:last")),b.addClass("cur")},b.prototype.show=function(){var a;return this.context.mark_range(),this.visible()||this.$el.show(),(a=this.context.rect())?this.reposition(a):void 0},b.prototype.hide=function(a){var b;return isNaN(a&&this.visible())?(this.context.reset_rect(),this.$el.hide()):(b=function(a){return function(){return a.hide()}}(this),clearTimeout(this.timeout_id),this.timeout_id=setTimeout(b,a))},b.prototype.render=function(b){var c,d,e,f,g,h,i;if(!(a.isArray(b)&&b.length>0))return void this.hide();for(this.$el.find("ul").empty(),d=this.$el.find("ul"),g=this.context.get_opt("tpl"),h=0,i=b.length;i>h;h++)e=b[h],e=a.extend({},e,{"atwho-at":this.context.at}),f=this.context.callbacks("tpl_eval").call(this.context,g,e),c=a(this.context.callbacks("highlighter").call(this.context,f,this.context.query.text)),c.data("item-data",e),d.append(c);return this.show(),d.find("li:first").addClass("cur")},b}(),h={DOWN:40,UP:38,ESC:27,TAB:9,ENTER:13},g={before_save:function(b){var c,d,e,f;if(!a.isArray(b))return b;for(f=[],d=0,e=b.length;e>d;d++)c=b[d],a.isPlainObject(c)?f.push(c):f.push({name:c});return f},matcher:function(a,b,c){var d,e;return a=a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),c&&(a="(?:^|\\s)"+a),e=new RegExp(a+"([A-Za-z0-9_+-]*)$|"+a+"([^\\x00-\\xff]*)$","gi"),d=e.exec(b),d?d[2]||d[1]:null},filter:function(a,b,c){var d,e,f,g;for(g=[],e=0,f=b.length;f>e;e++)d=b[e],~d[c].toLowerCase().indexOf(a)&&g.push(d);return g},remote_filter:null,sorter:function(a,b,c){var d,e,f,g;if(!a)return b;for(g=[],e=0,f=b.length;f>e;e++)d=b[e],d.atwho_order=d[c].toLowerCase().indexOf(a),d.atwho_order>-1&&g.push(d);return g.sort(function(a,b){return a.atwho_order-b.atwho_order})},tpl_eval:function(a,b){var c;try{return a.replace(/\$\{([^\}]*)\}/g,function(a,c,d){return b[c]})}catch(d){return c=d,""}},highlighter:function(a,b){var c;return b?(c=new RegExp(">\\s*(\\w*)("+b.replace("+","\\+")+")(\\w*)\\s*<","ig"),a.replace(c,function(a,b,c,d){return"> "+b+"<strong>"+c+"</strong>"+d+" <"})):a},before_insert:function(a,b){return a}},c={load:function(a,b){var c;return(c=this.controller(a))?c.model.load(b):void 0},getInsertedItemsWithIDs:function(b){var c,d,e;return(c=this.controller(b))?(b&&(b="-"+(c.get_opt("alias")||c.at)),d=[],e=a.map(this.$inputor.find("span.atwho-view-flag"+(b||"")),function(b){var c;return c=a(b).data("atwho-data-item"),d.indexOf(c.id)>-1?void 0:(c.id&&(d.push=c.id),c)}),[d,e]):[null,null]},getInsertedItems:function(a){return c.getInsertedItemsWithIDs.apply(this,[a])[1]},getInsertedIDs:function(a){return c.getInsertedItemsWithIDs.apply(this,[a])[0]},run:function(){return this.dispatch()},destroy:function(){return this.shutdown(),this.$inputor.data("atwho",null)}},e={init:function(b){var c,e;return e=(c=a(this)).data("atwho"),e||c.data("atwho",e=new d(this)),e.reg(b.at,b),this}},b=a("<div id='atwho-container'></div>"),a.fn.atwho=function(d){var f,g;return g=arguments,a("body").append(b),f=null,this.filter("textarea, input, [contenteditable=true]").each(function(){var b;return"object"!=typeof d&&d?c[d]?(b=a(this).data("atwho"))?f=c[d].apply(b,Array.prototype.slice.call(g,1)):void 0:a.error("Method "+d+" does not exist on jQuery.caret"):e.init.apply(this,g)}),f||this},a.fn.atwho["default"]={at:void 0,alias:void 0,data:null,tpl:"<li data-value='${atwho-at}${name}'>${name}</li>",insert_tpl:"<span>${atwho-data-value}</span>",callbacks:g,search_key:"name",start_with_space:!0,limit:5,max_len:20,display_timeout:300}})}.call(this),function(a){function b(a,b){var c=typeof a[b];return"function"===c||!("object"!=c||!a[b])||"unknown"==c}function c(a,b,c){return 0>b&&(b+=a.value.length),"undefined"==typeof c&&(c=b),0>c&&(c+=a.value.length),{start:b,end:c}}function d(){return"object"==typeof document.body&&document.body?document.body:document.getElementsByTagName("body")[0]}var e,f,g,h,i,j,k,l,m;a(document).ready(function(){function n(a,b){return function(){var c=this.jquery?this[0]:this,d=c.nodeName.toLowerCase();return 1!=c.nodeType||"textarea"!=d&&("input"!=d||"text"!=c.type)||(c=[c].concat(Array.prototype.slice.call(arguments)),c=a.apply(this,c),b)?b?this:void 0:c}}var o=document.createElement("textarea");if(d().appendChild(o),"undefined"!=typeof o.selectionStart&&"undefined"!=typeof o.selectionEnd)e=function(a){return{start:a.selectionStart,end:a.selectionEnd,length:a.selectionEnd-a.selectionStart,text:a.value.slice(a.selectionStart,a.selectionEnd)}},f=function(a,b,d){b=c(a,b,d),a.selectionStart=b.start,a.selectionEnd=b.end},m=function(a,b){b?a.selectionEnd=a.selectionStart:a.selectionStart=a.selectionEnd};else{if(!(b(o,"createTextRange")&&"object"==typeof document.selection&&document.selection&&b(document.selection,"createRange")))return d().removeChild(o),void(window.console&&window.console.log&&window.console.log("TextInputs module for Rangy not supported in your browser. Reason: No means of finding text input caret position"));e=function(a){var b,c,d,e=0,f=0;return(d=document.selection.createRange())&&d.parentElement()==a&&(c=a.value.length,b=a.value.replace(/\r\n/g,"\n"),f=a.createTextRange(),f.moveToBookmark(d.getBookmark()),d=a.createTextRange(),d.collapse(!1),f.compareEndPoints("StartToEnd",d)>-1?e=f=c:(e=-f.moveStart("character",-c),e+=b.slice(0,e).split("\n").length-1,f.compareEndPoints("EndToEnd",d)>-1?f=c:(f=-f.moveEnd("character",-c),f+=b.slice(0,f).split("\n").length-1))),{start:e,end:f,length:f-e,text:a.value.slice(e,f)}},f=function(a,b,d){b=c(a,b,d),d=a.createTextRange();var e=b.start-(a.value.slice(0,b.start).split("\r\n").length-1);d.collapse(!0),b.start==b.end?d.move("character",e):(d.moveEnd("character",b.end-(a.value.slice(0,b.end).split("\r\n").length-1)),d.moveStart("character",e)),d.select()},m=function(a,b){var c=document.selection.createRange();c.collapse(b),c.select()}}d().removeChild(o),h=function(a,b,c,d){var e;b!=c&&(e=a.value,a.value=e.slice(0,b)+e.slice(c)),d&&f(a,b,b)},g=function(a){var b=e(a);h(a,b.start,b.end,!0)},l=function(a){var b,c=e(a);return c.start!=c.end&&(b=a.value,a.value=b.slice(0,c.start)+b.slice(c.end)),f(a,c.start,c.start),c.text},i=function(a,b,c,d){var e=a.value;a.value=e.slice(0,c)+b+e.slice(c),d&&(b=c+b.length,f(a,b,b))},j=function(a,b){var c=e(a),d=a.value;a.value=d.slice(0,c.start)+b+d.slice(c.end),c=c.start+b.length,f(a,c,c)},k=function(a,b,c){var d=e(a),g=a.value;a.value=g.slice(0,d.start)+b+d.text+c+g.slice(d.end),b=d.start+b.length,f(a,b,b+d.length)},a.fn.extend({getSelection:n(e,!1),setSelection:n(f,!0),collapseSelection:n(m,!0),deleteSelectedText:n(g,!0),deleteText:n(h,!0),extractSelectedText:n(l,!1),insertText:n(i,!0),replaceSelectedText:n(j,!0),surroundSelectedText:n(k,!0)})})}(jQuery),define("jquery.textinputs",["jquery"],function(){}),!function(a){var b,c={className:"autosizejs",id:"autosizejs",append:"\n",callback:!1,resizeDelay:10,placeholder:!0},d='<textarea tabindex="-1" style="position:absolute; top:-999px; left:0; right:auto; bottom:auto; border:0; padding: 0; -moz-box-sizing:content-box; -webkit-box-sizing:content-box; box-sizing:content-box; word-wrap:break-word; height:0 !important; min-height:0 !important; overflow:hidden; transition:none; -webkit-transition:none; -moz-transition:none;"/>',e=["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing","textIndent","whiteSpace"],f=a(d).data("autosize",!0)[0];f.style.lineHeight="99px","99px"===a(f).css("lineHeight")&&e.push("lineHeight"),f.style.lineHeight="",a.fn.autosize=function(d){return this.length?(d=a.extend({},c,d||{}),f.parentNode!==document.body&&a(document.body).append(f),this.each(function(){function c(){var b,c=window.getComputedStyle?window.getComputedStyle(m,null):null;c?(b=parseFloat(c.width),("border-box"===c.boxSizing||"border-box"===c.webkitBoxSizing||"border-box"===c.mozBoxSizing)&&a.each(["paddingLeft","paddingRight","borderLeftWidth","borderRightWidth"],function(a,d){b-=parseFloat(c[d])})):b=n.width(),f.style.width=Math.max(b,0)+"px"}function g(){var g={};if(b=m,f.className=d.className,f.id=d.id,j=parseFloat(n.css("maxHeight")),a.each(e,function(a,b){g[b]=n.css(b)}),a(f).css(g).attr("wrap",n.attr("wrap")),c(),window.chrome){var h=m.style.width;m.style.width="0px",m.offsetWidth,m.style.width=h}}function h(){var a,e;b!==m?g():c(),f.value=!m.value&&d.placeholder?n.attr("placeholder")||"":m.value,f.value+=d.append||"",f.style.overflowY=m.style.overflowY,e=parseFloat(m.style.height)||0,f.scrollTop=0,f.scrollTop=9e4,a=f.scrollTop,j&&a>j?(m.style.overflowY="scroll",a=j):(m.style.overflowY="hidden",k>a&&(a=k)),a+=o,Math.abs(e-a)>.01&&(m.style.height=a+"px",f.className=f.className,p&&d.callback.call(m,m),n.trigger("autosize.resized"))}function i(){clearTimeout(l),l=setTimeout(function(){var a=n.width();a!==r&&(r=a,h())},parseInt(d.resizeDelay,10))}var j,k,l,m=this,n=a(m),o=0,p=a.isFunction(d.callback),q={height:m.style.height,overflow:m.style.overflow,overflowY:m.style.overflowY,wordWrap:m.style.wordWrap,resize:m.style.resize},r=n.width(),s=n.css("resize");n.data("autosize")||(n.data("autosize",!0),("border-box"===n.css("box-sizing")||"border-box"===n.css("-moz-box-sizing")||"border-box"===n.css("-webkit-box-sizing"))&&(o=n.outerHeight()-n.height()),k=Math.max(parseFloat(n.css("minHeight"))-o||0,n.height()),n.css({overflow:"hidden",overflowY:"hidden",wordWrap:"break-word"}),"vertical"===s?n.css("resize","none"):"both"===s&&n.css("resize","horizontal"),"onpropertychange"in m?"oninput"in m?n.on("input.autosize keyup.autosize",h):n.on("propertychange.autosize",function(){"value"===event.propertyName&&h()}):n.on("input.autosize",h),d.resizeDelay!==!1&&a(window).on("resize.autosize",i),n.on("autosize.resize",h),n.on("autosize.resizeIncludeStyle",function(){b=null,h()}),n.on("autosize.destroy",function(){b=null,clearTimeout(l),a(window).off("resize",i),n.off("autosize").off(".autosize").css(q).removeData("autosize")}),h())})):this}}(jQuery||$),define("jquery.autosize",["jquery"],function(){}),function(a){function b(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)},h=c&&!d;clearTimeout(d),d=setTimeout(g,b),h&&a.apply(e,f)}}function c(a){var b=++j;return String(null==a?"rmjs-":a)+b}function d(a){var b=a.clone().css({height:"auto",width:a.width(),maxHeight:"none",overflow:"hidden"}).insertAfter(a),c=b.outerHeight(),d=parseInt(b.css({maxHeight:""}).css("max-height").replace(/[^-\d\.]/g,""),10),e=a.data("defaultHeight");b.remove();var f=a.data("collapsedHeight")||e;d?d>f&&(f=d):f=e,a.data({expandedHeight:c,maxHeight:d,collapsedHeight:f}).css({maxHeight:"none"})}function e(a){if(!i[a.selector]){var b=" ";a.embedCSS&&""!==a.blockCSS&&(b+=a.selector+" + [data-readmore-toggle], "+a.selector+"[data-readmore]{"+a.blockCSS+"}"),b+=a.selector+"[data-readmore]{transition: height "+a.speed+"ms;overflow: hidden;}",function(a,b){var c=a.createElement("style");c.type="text/css",c.styleSheet?c.styleSheet.cssText=b:c.appendChild(a.createTextNode(b)),a.getElementsByTagName("head")[0].appendChild(c)}(document,b),i[a.selector]=!0}}function f(b,c){var d=this;this.element=b,this.options=a.extend({},h,c),a(this.element).data({defaultHeight:this.options.collapsedHeight,heightMargin:this.options.heightMargin}),e(this.options),this._defaults=h,this._name=g,d.init()}var g="readmore",h={speed:100,collapsedHeight:200,heightMargin:16,moreLink:'<a href="#">Read More</a>',lessLink:'<a href="#">Close</a>',embedCSS:!0,blockCSS:"display: block; width: 100%;",startOpen:!1,beforeToggle:function(){},afterToggle:function(){}},i={},j=0,k=b(function(){a("[data-readmore]").each(function(){var b=a(this),c="true"===b.attr("aria-expanded");d(b),b.css({height:b.data(c?"expandedHeight":"collapsedHeight")})})},100);f.prototype={init:function(){var b=this;a(this.element).each(function(){var e=a(this);d(e);var f=e.data("collapsedHeight"),g=e.data("heightMargin");if(e.outerHeight(!0)<=f+g)return!0;var h=e.attr("id")||c(),i=b.options.startOpen?b.options.lessLink:b.options.moreLink;e.attr({"data-readmore":"","aria-expanded":!1,id:h}),e.after(a(i).on("click",function(a){b.toggle(this,e[0],a)}).attr({"data-readmore-toggle":"","aria-controls":h})),b.options.startOpen||e.css({height:f})}),window.addEventListener("resize",function(){k()})},toggle:function(b,c,d){d&&d.preventDefault(),b||(b=a('[aria-controls="'+this.element.id+'"]')[0]),c||(c=this.element);var e=this,f=a(c),g="",h="",i=!1,j=f.data("collapsedHeight");
f.height()<=j?(g=f.data("expandedHeight")+"px",h="lessLink",i=!0):(g=j,h="moreLink"),e.options.beforeToggle(b,c,!i),f.css({height:g}),f.on("transitionend",function(){e.options.afterToggle(b,c,i),a(this).attr({"aria-expanded":i}).off("transitionend")}),a(b).replaceWith(a(e.options[h]).on("click",function(a){e.toggle(this,c,a)}).attr({"data-readmore-toggle":"","aria-controls":f.attr("id")}))},destroy:function(){a(this.element).each(function(){var b=a(this);b.attr({"data-readmore":null,"aria-expanded":null}).css({maxHeight:"",height:""}).next("[data-readmore-toggle]").remove(),b.removeData()})}},a.fn.readmore=function(b){var c=arguments,d=this.selector;return b=b||{},"object"==typeof b?this.each(function(){if(a.data(this,"plugin_"+g)){var c=a.data(this,"plugin_"+g);c.destroy.apply(c)}b.selector=d,a.data(this,"plugin_"+g,new f(this,b))}):"string"==typeof b&&"_"!==b[0]&&"init"!==b?this.each(function(){var d=a.data(this,"plugin_"+g);d instanceof f&&"function"==typeof d[b]&&d[b].apply(d,Array.prototype.slice.call(c,1))}):void 0}}(jQuery),define("jquery.readmore",["jquery"],function(){}),define("modules/view/common/postbox_view",["underscore","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/common/postbox","modules/common/config","modules/common/polyfill","modules/common/utility","modules/common/session_user","modules/common/local_storage","modules/common/nue","modules/globals/variable","modules/globals/url","modules/globals/session_user","modules/mig33_app","modules/template/helpers/general_helpers","jquery.atwho","jquery.textinputs","jquery.autosize","jquery.readmore"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=/https?:\/\/([a-z0-9]([a-z0-9_\-]*[a-z0-9])?\.)*([a-z0-9]([a-z0-9\-]*[a-z0-9])?\.)[a-z]{2,4}(:[0-9]{1,4})?(\$|(\?|\/)\S+)?/gi,q={post_btn:'input[name="post"]',repost_btn:'.input-group-btn input[value="'+i.translate("post|share")+'"]',body_txtarea:'textarea[name="body"]',body_content:".postbox-content",char_counter:".postbox-charcount",advance_option:".postbox-advance-option",advance_option_container:".postbox-footer-sub",postbox:".postbox",insert_photo:".insert-photo",insert_photo_upload:".postbox-media-upload",insert_photo_close:".postbox-media-wrapper > .close",insert_photo_wrapper:".postbox-media-wrapper",insert_photo_media:".postbox-media",insert_emoticon:".insert-emoticon",post_to_twitter:".postbox-twitter-field",post_to_facebook:".postbox-facebook-field",post_to_twitter_input:'input[name="post_to_twitter"]',post_to_facebook_input:'input[name="post_to_facebook"]',post_privacy:".postbox-post-privacy",post_privacy_select:".postbox-post-privacy-select",postbox_progress_wrapper:".postbox-progress-wrapper",postbox_showreplyinfeed:".postbox-showreplyinfeed",postbox_showreplyinfeed_input:'input[name="show_reply_in_feed"]',collapsed_button:'.input-group-btn input[type="button"]',post_button:".postbox-submit a",gift_button:".post-reaction-gift a.btn-send-gift",post_button_grp:".post-reaction-submit",gift_button_grp:".post-reaction-gift"},r={};r["click "+q.body_content]="stopPropagation",r["click "+q.post_btn]="send_post",r["click "+q.repost_btn]="send_post",r["click "+q.post_button]="send_post",r["click "+q.gift_button]="send_gift",r["click "+q.body_txtarea]="focusPostBox",r["keypress "+q.body_txtarea]="update_char_count",r["keyup "+q.body_txtarea]="update_char_count",r["keydown "+q.body_txtarea]="update_char_count",r["paste "+q.body_txtarea]="update_char_count",r["mouseover "+q.body_txtarea]="update_char_count",r["change "+q.insert_photo_upload]="insert_photo",r["click "+q.insert_photo]="insert_photo_open",r["click "+q.insert_photo_close]="insert_photo_close",r["click "+q.insert_emoticon]="insert_emoticon",r["click "+q.post_to_twitter]="post_to_twitter",r["click "+q.post_to_facebook]="post_to_facebook",r["click "+q.post_privacy+" > A"]="setPostPrivacy",r["click "+q.post_privacy_select]="selectPostPrivacy",r["dragenter "+q.postbox]="dragEnter",r["dragleave "+q.postbox]="dragLeave",r["dragover "+q.postbox]="dragOver",r["click "+q.advance_option]="toggleAdvanceOptions";var s={group:"!"},t={autocomplete_users:null,autocomplete_groups:null},u=!1,v=d.ItemView.extend({events:r,uploadedImage:null,uploadedImageBlob:null,trigger_char:s,className:"row",id:"postbox-view",mimeObject:{},initialize:function(a){this.options=a,this.options.originality=a.originality||1,this.options.defaultText=a.defaultText||"",this.options.parent_post=a.parent_post||null,this.options.top=a.top||!1;var b=this;b.$el},setMimeType:function(a){this.mimeObject=h.assign({},a),console.warn(this.mimeObject)},focusPostBox:function(){$(q.body_txtarea,this.$el).focus(),$(".postbox-post-privacy",this.$el).removeClass("open"),this._closeEmoticons()},readyPostBox:function(b,c){if(0===$('input[name="root_post_id"]',this.$el).length){var d=$(".postbox form",this.$el),e=this.$el,f="";$('input[name="originality"]',d).val(c),f=a.isUndefined(b.get("root_post"))||null===b.get("root_post")?b.get("id"):b.get("root_post").id;var g=$("<input>").attr("name","root_post_id").attr("type","hidden").val(f);d.append(g);var h=$("<input>").attr("name","parent_post_id").attr("type","hidden").val(b.get("id"));if(d.append(h),this._isReplyPostBox()){$(".postbox-twitter-field",d).addClass("hidden"),$(".postbox-facebook-field",d).addClass("hidden"),$('input[name="post_to_twitter"]').prop("checked",!1),$('input[name="post_to_facebook"]').prop("checked",!1),$(q.post_btn,d).val(i.translate("post|reply")),$(q.collapsed_button,d).val(i.translate("post|reply"));var j=$("<input>").attr("name","reply_to_root").attr("type","hidden").val("1");d.append(j),$(".postbox-post-privacy",d).addClass("hidden"),$('input[name="privacy"]',d).filter('[value="0"]').prop("checked",!0),b.get("group")||($('input[name="show_reply_in_feed"]',d).on("click",function(){k.set("_also_post_miniblog",$(this).is(":checked"))}),k.hasKey("_also_post_miniblog")?$('input[name="show_reply_in_feed"]',d).prop("checked",k.get("_also_post_miniblog")):k.set("_also_post_miniblog",!0),$(q.postbox_showreplyinfeed,e).removeClass("hidden")),$(q.body_txtarea,d).attr("placeholder",i.translate("homefeed|postbox_any_thoughts"))}else this._isResharePostBox()&&($(q.post_btn,d).val(i.translate("post|share")),$(q.collapsed_button,d).val(i.translate("post|share")),$(q.body_txtarea,d).attr("placeholder",i.translate("homefeed|postbox_share_it")));0!==b.get("privacy")&&($(q.postbox_showreplyinfeed_input,e).attr("checked",!1),$(q.postbox_showreplyinfeed,e).addClass("hidden"))}},reset:function(){$(q.body_txtarea,this.$el).prop("disabled",!1).val(this.options.defaultText),$(q.post_btn,this.$el).prop("disabled",!1),$(q.insert_photo_upload,this.$el).prop("disabled",!1),$(q.char_counter,this.$el).text(m.characters_count.max),$('input[name="originality"]',this.$el).val(this.options.originality),null===this.options.parent_post&&($('input[name="root_post_id"]',this.$el).length>0&&$('input[name="root_post_id"]',this.$el).remove(),$('input[name="parent_post_id"]',this.$el).length>0&&$('input[name="parent_post_id"]',this.$el).remove()),this.reset_placeholder(),this.hideProgressBar(),this.setProgressBarPercentage(0),this.insert_photo_close(),this._closeEmoticons()},half_reset:function(){$(q.body_txtarea,this.$el).prop("disabled",!1),$(q.post_btn,this.$el).prop("disabled",!1),$(q.insert_photo_upload,this.$el).prop("disabled",!1),this.hideProgressBar(),this.setProgressBarPercentage(0),this._closeEmoticons()},reset_placeholder:function(){this._isReplyPostBox()?$(q.body_txtarea,this.$el).attr("placeholder",i.translate("homefeed|postbox_any_thoughts")):this._isResharePostBox()?$(q.body_txtarea,this.$el).attr("placeholder",i.translate("homefeed|postbox_share_it")):$(q.body_txtarea,this.$el).attr("placeholder",i.translate("homefeed|say_something_user",o.username))},onRender:function(){var b=this;this.$el.data("postboxViewObject",this),this.options.top&&$(".insert-emoticons",this.$el).attr("data-placement","top"),$(q.body_txtarea,this.$el).val(this.options.defaultText),$(q.body_txtarea,this.$el).atwho({at:":",limit:7,tpl:'<li data-value="${hotkey}"><img src="${url}" width="16" height="16" />&nbsp;${name}</li>',search_key:"hotkey",data:m.emoticons}),null!==this.options.parent_post&&this.readyPostBox(this.options.parent_post,this.options.originality),$(q.body_txtarea,this.$el).autosize();var c=$("a.insert-emoticons",this.$el);c.clickover({width:256,global_close:!0,onShown:function(){$(".icon-wb_emoticon",c).toggleClass("font-color-celadon font-color-grey")},onHidden:function(){$(".icon-wb_emoticon",c).toggleClass("font-color-celadon font-color-grey")}}),a.delay(function(){var a=b.$el.get(0).querySelector(q.postbox);null!==a&&a.addEventListener("drop",function(a){i.send_event_to_ga("Post Box","Drag & Drop Photo"),a.preventDefault(),a.stopPropagation();var c=a.dataTransfer;$(q.insert_photo_close,b.$el).removeClass("hidden"),$(q.insert_photo_media,b.$el).removeClass("hidden"),$(q.insert_photo,b.$el).addClass("hidden"),b.processThumbnail(c.files[0],b.$el)},!1)},100),null===t.autocomplete_users&&i.is_logged_in()?$.get(g.urls.autocomplete_users,function(a){null!==a.data&&(t.autocomplete_users=a.data.users),b.loadAtWhoUsernames()}):b.loadAtWhoUsernames(),null===t.autocomplete_groups&&i.is_logged_in()?$.get(g.urls.autocomplete_groups,function(a){null!==a.data&&(t.autocomplete_groups=a.data),b.loadAtWhoGroups()}):b.loadAtWhoGroups(),$("#atwho-container").off("click").on("click",function(a){a.stopPropagation()})},send_gift:function(a){null!==a&&a.preventDefault(),this.options.parent_post&&i.show_gift_selection("post",this.options.parent_post)},send_post:function(b){if(b&&b.preventDefault(),!u)return i.show_error(i.translate("post|error_post")),this.half_reset(),!1;var c=this,d=this.$el,e=new FormData,f={},h=$(q.post_btn,d),j=$(q.insert_photo_upload,d),k=$(q.body_txtarea,d);if(k.prop("disabled"))return!1;this._closeEmoticons(),this._formDataPopulation(f,e,d);var m=f.from_group_id;if((1==f.originality||2==f.originality)&&null===this.uploadedImage&&""===f.body)return i.show_error(i.translate("homefeed|postbox_error_body_empty")),!1;if(h.prop("disabled",!0),k.prop("disabled",!0),j.prop("disabled",!0),c.showProgressBar(),!i.is_logged_in()){var n=l.nue.getInstance();return n.store_nue_action("post",f),i.show_login_dialog(),void c.half_reset()}c._sendNewPostEventToGoogleAnalytics(f.originality,f),$.ajax({type:"post",cache:!1,contentType:!1,processData:!1,dataType:"json",url:g.urls.create_post_url,data:e,xhr:function(){var a=$.ajaxSettings.xhr();return a.upload&&a.upload.addEventListener("progress",function(a){if(a.lengthComputable){var b=Math.floor(100*a.loaded/a.total)-Math.floor(10*Math.random());c.setProgressBarPercentage(b)}},!1),a}}).done(function(a){if(c.setProgressBarPercentage(100),a=i.parse_ajax_response(a),a.error)return i.show_error(a.error),void c.reset();var b=a.group&&a.group.id?a.group.id:0,d=require("modules/mig33_app");b?($(window).trigger("resize"),m&&(i.show_success(i.translate("post|success_post")),d.vent.trigger(i.format(d.ApplicationEvents.GROUP_POST_ADDED,b),a),$(q.body_txtarea,c.$el).val(s.group+b+" "))):2===a.originality?(i.show_success(i.translate("post|success_reply")),d.vent.trigger(d.ApplicationEvents.POST_REPLY_ADDED,a)):3===a.originality?(i.show_success(i.translate("post|success_repost")),d.vent.trigger(d.ApplicationEvents.POST_REPLY_ADDED,a)):(i.show_success(i.translate("post|success_post")),d.vent.trigger(d.ApplicationEvents.POST_ADDED,a),$(window).trigger("resize")),c.reset(),$("#sharebox-modal").modal("hide"),d.vent.trigger(d.ApplicationEvents.POST_ADDED_DONE,a)}).fail(function(b,d,e){a.isUndefined(b.responseJSON.error)||a.isUndefined(b.responseJSON.error.message)?i.show_error(e):i.show_error(b.responseJSON.error.message),c.reset()})},_formDataPopulation:function(a,b,c){var d=$('input[name="root_post_id"]',c),e=$('input[name="parent_post_id"]',c),f=$('input[name="reply_to_root"]',c),g=$('input[name="show_reply_in_feed"]',c),h=$('input[name="post_to_twitter"]',c),j=$('input[name="post_to_facebook"]',c),k=$('input[name="reply_permission"]',c),l=$('input[name="group_id"]',c),m=$('input[name="privacy"]:radio:checked',c),n=$('input[name="mimeType"]',c),o=$('input[name="mimeData"]',c),p=$('input[name="originality"]',c).val();n.length||this.$el.append('<input type="hidden" name="mimeType" value="" />'),b.append("mimeType",this.mimeObject.mimeType),o.length||this.$el.append('<input type="hidden" name="mimeData" value="{}" />');var q={};q[this.mimeObject.mimeType]=this.mimeObject.mimeData,b.append("mimeData",JSON.stringify(q)),a.root_post_id=d.length?d.val():"",b.append("root_post_id",a.root_post_id),a.parent_post_id=e.length?e.val():"",b.append("parent_post_id",a.parent_post_id),a.reply_to_root=f.is(":checked")?1:0,b.append("reply_to_root",a.reply_to_root),a.originality=p?p:1,b.append("originality",a.originality),a.show_reply_in_feed=g.is(":checked")?1:0,b.append("show_reply_in_feed",a.show_reply_in_feed),a.post_to_twitter=h.prop("checked")?1:0,b.append("post_to_twitter",a.post_to_twitter),a.post_to_facebook=j.prop("checked")?1:0,b.append("post_to_facebook",a.post_to_facebook);var r=0;k.length>0&&!k.is(":checked")&&i.is_logged_in()&&(r=1),a.reply_permission=r,b.append("reply_permission",r);var t=parseInt(m.val(),10);a.privacy=1===t?t:0,b.append("privacy",t);var u=$.trim($('[name="body"]',c).val());null!==this.uploadedImage&&(a.media=this.uploadedImageBlob,b.append("media",this.uploadedImage));var v=parseInt(l.val(),10);isNaN(v)||1>v?(v=0,a.body=u,b.append("body",u)):(t=0,u=u.replace("^("+s.group+v+")",""),a.body=s.group+v+" "+u,b.append("body",s.group+v+" "+u)),a.from_group_id=v},_sendNewPostEventToGoogleAnalytics:function(a,b){var c="new";switch(a){case 2:c="reply";break;case 3:c="reshare";break;default:c="new"}i.send_event_to_ga("New Post",c,b.parent_post_id)},update_char_count:function(){var a,b=$(q.body_txtarea,this.$el).val(),c=b.length,d=b.match(p),e=0,f=0;this.checkEmptyPost(),f=null!==o&&(o.label.verified||o.label.mig137)?m.characters_count.long_post:m.characters_count.normal_post,null!==d&&($.each(d,function(a,b){e+=b.length}),e-=d.length*m.characters_count.link),a=f-c+e,0>a?($(q.post_btn,this.$el).prop("disabled",!0),$(q.postbox,this.$el).addClass("error"),$(q.char_counter,this.$el).addClass("font-color-red"),u=!1):($(q.post_btn,this.$el).prop("disabled",!1),$(q.postbox,this.$el).removeClass("error"),$(q.char_counter,this.$el).removeClass("font-color-red"),u=!0),this.checkEmptyPost(),$(q.char_counter,this.$el).text(a);$(".postbox-body-wrapper textarea")},insert_emoticon:function(a){a.preventDefault(),i.send_event_to_ga("Post Box","Inserted Emoticon");var b=$(q.body_txtarea,this.$el).getSelection().start;$(q.body_txtarea,this.$el).focus().insertText($(a.currentTarget,this.$el).data("emoticon"),b),$("a.insert-emoticons",this.$el).click(),this.checkEmptyPost()},insert_photo:function(){i.send_event_to_ga("Post Box","Insert Photo");var a=$(q.insert_photo_upload,this.$el);this.processThumbnail(a[0].files[0],this.$el),this.checkEmptyPost()},insert_photo_open:function(a){a.preventDefault(),i.send_event_to_ga("Post Box","Open Inserted Photo"),$(q.insert_photo_upload,this.$el).click()},insert_photo_close:function(a){a&&a.preventDefault(),i.send_event_to_ga("Post Box","Remove Inserted Photo");var b=$(q.insert_photo_upload,this.$el);$(q.insert_photo_close,this.$el).addClass("hidden"),$(q.insert_photo_media,this.$el).addClass("hidden"),b.replaceWith(b.clone(!0)),this.checkEmptyPost(),this.uploadedImage=null},dragEnter:function(a){this._isResharePostBox()||(a.preventDefault(),$(q.postbox,this.$el).addClass("postbox-dragdrop"))},dragLeave:function(b){if(!this._isResharePostBox()){var c=$(q.postbox,this.$el).get(0).getBoundingClientRect(),d=function(b){var c,d;return a.isUndefined(event.clientX)||null===event.clientX?(c=event.pageX+document.documentElement.scrollLeft,d=event.pageY+document.documentElement.scrollTop):(c=event.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,d=event.clientY+document.body.scrollTop+document.documentElement.scrollTop),{x:c,y:d}},e=d(event.originalEvent);(e.x>c.left+c.width-1||e.x<c.left||e.y>c.top+c.height-1||e.y<c.top)&&$(q.postbox,this.$el).removeClass("postbox-dragdrop")}},dragOver:function(a){a.preventDefault(),a.originalEvent.dataTransfer.dropEffect="copy"},processThumbnail:function(b,c){if(a.isUndefined(b)||null===b)return void $(q.postbox,this.$el).removeClass("postbox-dragdrop");if(!b.type.match(/image.*/))return $(q.postbox,this.$el).removeClass("postbox-dragdrop"),void i.show_error(i.translate("homefeed|postbox_error_not_image"));if(b.size>g.variable.max_media_size)return $(q.postbox,this.$el).removeClass("postbox-dragdrop"),void i.show_error(i.translate("homefeed|postbox_error_size_exceeded"));var d=window.URL.createObjectURL(b),e=this;$(q.insert_photo_media,c).attr("src",d).load(function(){window.URL.revokeObjectURL(this.src)});var f=new Image;f.onload=function(){e.uploadedImageBlob=i.getBase64Image(this)},f.src=window.URL.createObjectURL(b),this.uploadedImage=b,$(q.postbox,this.$el).removeClass("postbox-dragdrop"),$(q.insert_photo_close,this.$el).removeClass("hidden"),$(q.insert_photo_media,this.$el).removeClass("hidden")},post_to_twitter:function(){this._closeEmoticons(),$(q.post_to_twitter_input,this.$el).prop("disabled")||($(q.post_to_twitter+" span",this.$el).toggleClass("font-color-twitter font-color-grey"),$(q.post_to_twitter+" span",this.$el).hasClass("font-color-grey")?(i.send_event_to_ga("Post Box","Twitter On"),$(q.post_to_twitter_input,this.$el).prop("checked",!0)):(i.send_event_to_ga("Post Box","Twitter Off"),$(q.post_to_twitter_input,this.$el).prop("checked",!1)))},post_to_facebook:function(){this._closeEmoticons(),$(q.post_to_facebook_input,this.$el).prop("disabled")||($(q.post_to_facebook+" span",this.$el).toggleClass("font-color-facebook font-color-grey"),$(q.post_to_facebook+" span",this.$el).hasClass("font-color-grey")?(i.send_event_to_ga("Post Box","Facebook","On"),$(q.post_to_facebook_input,this.$el).prop("checked",!0)):(i.send_event_to_ga("Post Box","Facebook Off"),$(q.post_to_facebook_input,this.$el).prop("checked",!1)))},loadAtWhoUsernames:function(){$(q.body_txtarea,this.$el).atwho({at:"@",limit:7,search_key:"username",tpl:'<li data-value="@${username}"><img src="'+i.get_display_picture_url("${username}","${display_picture_type}",24,24)+'" width="24" height="24" />&nbsp;${username}</li>',data:t.autocomplete_users})},loadAtWhoGroups:function(){$(q.body_txtarea,this.$el).atwho({at:"!",limit:7,tpl:'<li data-value="!${id}">${name}</li>',data:t.autocomplete_groups})},stopPropagation:function(a){$(a.target).is(".ico-lock")||a.stopPropagation()},setPostPrivacy:function(a){a.preventDefault(),a.stopPropagation(),this._closeEmoticons(),i.send_event_to_ga("Post Box","Set Post Privacy"),$(a.currentTarget).dropdown("toggle")},selectPostPrivacy:function(a){var b=i.translate("common|public");switch(parseInt($('> INPUT[type="radio"]',a.currentTarget).val(),10)){case 1:b=i.translate("user|friends");break;case 2:b=i.translate("user|myself");break;default:b=i.translate("common|public")}$(".postbox-post-privacy-selected",this.$el).text(b)},showProgressBar:function(){$(q.postbox_progress_wrapper+" .bar ",this.$el).css("visibility","visible"),$(q.postbox_progress_wrapper+" .bar ",this.$el).css("display","block")},hideProgressBar:function(){$(q.postbox_progress_wrapper+" .bar ",this.$el).css("visibility","hidden"),$(q.postbox_progress_wrapper+" .bar ",this.$el).css("display","none")},setProgressBarPercentage:function(a){$(q.postbox_progress_wrapper+" .bar ",this.$el).width(a+"%")},_isReplyPostBox:function(){return 2===this.options.originality},_isResharePostBox:function(){return 3===this.options.originality},_closeEmoticons:function(){$("a.insert-emoticons",this.$el).clickover("hide").removeAttr("data-clickover-open")},setContent:function(a){a&&$('[name="body"]',this.$el).val(a)},setToReshare:function(a){var b=this.options.originality;this.options.originality=3,this.readyPostBox(a,this.options.originality),this.options.originality=b},template:function(){return f({avatar_url:i.is_logged_in()?i.get_display_picture_url(o.username):"",session_user:o,variables:m,trigger_char:s})},toggleAdvanceOptions:function(){$(q.advance_option_container,this.$el).toggleClass("hidden")},checkEmptyPost:function(){var a=$(q.body_txtarea,this.$el).val(),b=a.length;this.uploadedImage||b>0?($(q.post_button,this.$el).removeClass("font-color-grey"),$(q.post_button,this.$el).addClass("font-color-celadon"),$(q.post_button_grp,this.$el).removeClass("hidden"),$(q.gift_button_grp,this.$el).addClass("hidden")):($(q.post_button,this.$el).addClass("font-color-grey"),$(q.post_button,this.$el).removeClass("font-color-celadon"),$(q.post_button_grp,this.$el).addClass("hidden"),$(q.gift_button_grp,this.$el).removeClass("hidden"))}});return v}),define("modules/view/common/postbox_view-new",["underscore","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/common/postbox-modal","modules/view/common/postbox_view","modules/common/utility","modules/globals/session_user","modules/globals/variable","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j){var k=g.extend({initialize:function(){a.bindAll(this),k.__super__.initialize.apply(this,arguments)},template:function(){var a=this;return f({avatar_url:h.is_logged_in()?h.get_display_picture_url(i.username):"",session_user:i,variables:j,trigger_char:a.trigger_char})}});return k}),define("modules/view/common/sharebox_modal_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/common/sharebox-modal","modules/view/common/postbox_view-new","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j){var k=c.Marionette.Layout.extend({template:{type:"handlebars",template:g},id:"sharebox-modal",className:"modal fade",regions:{sharebox:".modal-body.postbox"},onRender:function(){var a=this;this.$el.data("shareModalViewObject",this),this.postbox=new h({}),this.sharebox.show(this.postbox),b(".postbox",this.$el).removeClass("postbox-collapsed"),this.$el.on("shown.bs.modal",function(){b(".postbox-textarea",a.$el).focus()})},getPostbox:function(){return this.postbox}});return k}),define("hbs!modules/template/common/invite-friends-modal",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="modal-dialog">\n	<div class="modal-content">\n		<div class="modal-header">\n			<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>\n			<h4 class="modal-title">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"homefeed|postbox_invite_friends_modal_title",g):i.call(b,"translate","homefeed|postbox_invite_friends_modal_title",g)))+'</h4>\n		</div>\n		<div class="modal-body"></div>\n	</div>\n</div>\n'})}),define("hbs!modules/template/common/invite-friends-postbox",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="col-xs-12">\n	<div class="postbox">\n		<div class="postbox-content">\n			<div class="row no-margin postbox-body-media">\n				<div class="col-sm-2 share-button-box email-invite-box">\n					<div  class="btn btn-sm btn-share btn-share-email"></div>\n					<div class="font-color-grey">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"email|email",g):i.call(b,"translate","email|email",g)))+'</div>\n				</div>\n\n				<div class="col-sm-2 share-button-box facebook-invite-box">\n					<div class="btn btn-sm btn-share btn-share-facebook"></div>\n					<div class="font-color-grey">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"common|facebook",g):i.call(b,"translate","common|facebook",g)))+'</div>\n				</div>\n			</div>\n			<div class="share-modal-spacing clear"></div>\n\n			<label class="col-sm-12 share-label control-label">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"share|copy_link",g):i.call(b,"translate","share|copy_link",g)))+'</label>\n			<div class="col-sm-12">\n				<input id="share-modal-url" type="text" class="form-control"  name="share_url" value="" title="'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"share|title_link",g):i.call(b,"translate","share|title_link",g)))+'" readonly="readonly">\n			</div>\n			<div class="share-modal-spacing clear"></div>\n		</div>\n	</div>\n</div>'})}),define("modules/view/common/invite_friend_postbox_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/common/invite-friends-postbox","modules/common/config","modules/common/utility","modules/common/session_user","modules/common/local_storage","modules/common/nue","modules/globals/variable","modules/globals/url","modules/globals/session_user","modules/mig33_app","modules/template/helpers/general_helpers","jquery.atwho","jquery.textinputs","jquery.autosize","jquery.readmore"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=e.ItemView.extend({template:{type:"handlebars",template:g},id:"invite-friends-postbox",className:"row",ui:{fbInvite:".facebook-invite-box",emailInvite:".email-invite-box",destinationsBox:"input#mobile-destinations",messageBox:"textarea#mobile-custom-message",wordCountBox:"span#mobile-postbox-charcount",submitButton:'input[name="invite_friends"]'},events:{'click input[name="share_url"]':"selectPostPermalink","click   @ui.fbInvite":"fBInviteDialog","click   @ui.emailInvite":"emailInviteDialog","click   @ui.submitButton":"postInvite","keydown @ui.messageBox":"updateWordCount","press   @ui.messageBox":"updateWordCount","keyup   @ui.messageBox":"updateWordCount"},onRender:function(){var a=this;this.ui.destinationsBox.tagit({placeholderText:i.translate("discover|enter_email"),fieldName:"mobile-destinations-content",caseSensitive:!1,tagLimit:5,onTagLimitExceeded:function(){i.show_error(i.translate("discover|error_emails_exceeded",5))},beforeTagAdded:function(c,d){var e=/^(([^<>()\[\]\\.,;:\s@\"]+(\.[^<>()\[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,f=b(d.tag[0]).text(),g=f.substr(0,f.length-1),h=e.test(g);return a.ui.destinationsBox.data("emailLists",g),h?void 0:(i.show_error(i.translate("discover|error_valid_email",g)),a.ui.submitButton.prop("disabled",!0),!1)},afterTagAdded:function(){a.ui.submitButton.prop("disabled",!1)}}),this.ui.wordCountBox.text(this._getMaxWordCount()),this.ui.messageBox.attr("placeholder",i.translate("discover|enter_message")),this.updateShareURL()},updateWordCount:function(a){var b=this.ui.destinationsBox.data("emailLists"),c=this._getMaxWordCount(),d=a.target.value,e=c-d.length;0>e&&(this.ui.wordCountBox.attr("style","color:#C95075"),this.ui.submitButton.prop("disabled",!0)),e>=0&&(this.ui.wordCountBox.removeAttr("style"),"undefined"!=typeof b&&this.ui.submitButton.prop("disabled",!1)),this.ui.wordCountBox.text(e.toString())},postInvite:function(a){a.preventDefault();var c=this,d=this.ui.destinationsBox.val(),e=b("#invite-friends-modal"),f=this.ui.messageBox.val(),g={data:{channel:1,type:1,destinations:d.split(","),invitationMetadata:{joinInvitationSubtype:"15",chatInvitationMessage:f}}},k=b.ajax({type:"POST",contentType:"application/json",data:b.toJSON(g),url:i.format(h.urls.invite,j.getInstance().get("id"))});return k.done(function(a){a=i.parse_ajax_response(a);var b=[],d=[];for(var f in a)if(a.hasOwnProperty(f)){var g=a[f];g>0?b.push(f):d.push(f)}b.length>0&&(c.ui.destinationsBox.tagit("removeAll"),c.ui.messageBox.val(""),e.modal("toggle"),i.show_success(i.translate("discover|success_emails_invited",b.join(", ")))),d.length>0&&i.show_error(i.translate("discover|error_sending_email",d.join(", ")))}),k.fail(function(a,b,c){i.show_error(c)}),!0},fBInviteDialog:function(a){a.preventDefault();var c=j.getInstance().get("personalized_url");n.site+"/sites/ajax/invite/refer_friend_facebook_submit?noredir=1";i.shareToFacebook(c,null,null),b("#invite-friends-modal").modal("hide")},emailInviteDialog:function(){b("#invite-friends-modal").modal("hide"),b("#chat-invite-modal-email").modal("show")},_getMaxWordCount:function(){return h.invite_friends.message_char_limit},updateShareURL:function(){var a=this._get_sessionuser_username(),c=/^http.:\/\/[\w|\.]*\//gi.exec(window.url.register);this.share_url=c+"register/referral/?referrer=Web&source=invite_copy&invitationUser="+a,b("#share-modal-url",this.$el).val(this.share_url)},_get_sessionuser_username:function(){var a="";return window.session_user&&window.session_user.username&&(a=window.session_user.username),a},selectPostPermalink:function(a){a.preventDefault(),b(a.currentTarget).select()}});return p}),define("modules/view/common/invite_friends_modal_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/common/invite-friends-modal","modules/view/common/invite_friend_postbox_view","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j){var k=c.Marionette.Layout.extend({template:{type:"handlebars",template:g},id:"invite-friends-modal",className:"modal fade",regions:{inviteFriendsBox:".modal-body"},onRender:function(){this.inviteFriendsPostbox=new h,this.inviteFriendsBox.show(this.inviteFriendsPostbox)}});return k}),define("hbs!modules/template/common/gift-modal",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){return"\n				"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var g,h,i,j="",k=c.helperMissing,l=this.escapeExpression,m=this;return j+='<div class="modal-dialog">\n	<div class="modal-content">\n		<div class="modal-header hidden">\n			<div class="col-sm-12">\n				<h4 id="gift-modal-title" class="pull-left modal-title">'+l((h=c.translate||b&&b.translate,i={hash:{},data:e},h?h.call(b,"gift|title",i):k.call(b,"translate","gift|title",i)))+'</h4>\n				<span class="icon-wb_closepopup close pull-right font-color-grey visible-xs" data-dismiss="modal"></span>\n			</div>\n			<div class="clear"></div>\n		</div>\n		<div class="modal-body">\n			<div class="col-sm-12 gift-container">\n			</div>\n\n			<div class="col-sm-12 gift-complete text-center">\n				',h=c.compare||b&&b.compare,i={hash:{},inverse:m.noop,fn:m.program(1,f,e),data:e},g=h?h.call(b,b&&b.type,"VIRTUAL_GIFT",i):k.call(b,"compare",b&&b.type,"VIRTUAL_GIFT",i),(g||0===g)&&(j+=g),j+='\n\n				<h3 class="font-color-darkgrey text-center font-light">'+l((h=c.translate||b&&b.translate,i={hash:{},data:e},h?h.call(b,"gift|sent",i):k.call(b,"translate","gift|sent",i)))+'</h4>\n				\n				<div class="success_content">\n					<i class="success_img">\n						<img src="'+l((h=c.getStoreItemImage||b&&b.getStoreItemImage,i={hash:{},data:e},h?h.call(b,b,64,i):k.call(b,"getStoreItemImage",b,64,i)))+'" width="64" height="64" />\n					</i>\n				</div>\n				\n				\n				<input type="button" class="btn btn-button btn-inverse-default" value="'+l((h=c.translate||b&&b.translate,i={hash:{},data:e},h?h.call(b,"store|continue_shopping",i):k.call(b,"translate","store|continue_shopping",i)))+'" data-dismiss="modal" />\n\n			</div>\n\n			<div class="col-sm-12 buy-complete text-center">\n				<h3 class="text-center font-light">'+l((h=c.translate||b&&b.translate,i={hash:{},data:e},h?h.call(b,"store|success_buy_title",i):k.call(b,"translate","store|success_buy_title",i)))+'</h4>\n				\n				<div class="success_content">\n					<i class="success_img">\n						<img src="'+l((h=c.getStoreItemImage||b&&b.getStoreItemImage,i={hash:{},data:e},h?h.call(b,b,64,i):k.call(b,"getStoreItemImage",b,64,i)))+'" width="64" height="64" />\n					</i>\n					<div class="success_text font-color-darkgrey">'+l((h=c.translate||b&&b.translate,
i={hash:{},data:e},h?h.call(b,"store|success_buy_text",i):k.call(b,"translate","store|success_buy_text",i)))+'</div>\n				</div>\n				\n				<input type="button" class="btn btn-button btn-inverse-default" value="'+l((h=c.translate||b&&b.translate,i={hash:{},data:e},h?h.call(b,"store|continue_shopping",i):k.call(b,"translate","store|continue_shopping",i)))+'" data-dismiss="modal" />\n\n			</div>\n\n			<div class="share-modal-spacing clear"></div>\n		</div>\n	</div>\n</div>\n'})}),define("modules/view/store/store_item_detail_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","modules/mig33_app","marionette_handlebars","modules/common/config","modules/common/utility","modules/chat/models/user_session","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j){var k=j.Session.getInstance(),l=e.ItemView.extend({toUsername:"",campaignId:"",id:function(){return"store-item-details-"+this.model.get("id")},className:function(){return this.model.get("type").toLowerCase()},allowedToBuyItemFromBalance:function(){return null!=k.get("account_balance")?k.get("account_balance")>=this.model.get("localPrice"):!0},owned:function(){return null!==this.model.get("referenceData")&&this.model.get("referenceData").owned},checkAllowedToBuy:function(){var a=b(".body",this.$el);this.allowedToBuyItemFromBalance()?(this.hideRecharge(),this.enablePurchase()):this.allowedToBuyItemFromBalance()?1===b(".error-title",a).length&&this.render():(this.showRecharge(),this.disablePurchase()),this.owned()&&(this.disablePurchase(),b('input[name="purchase_item"]',this.$el).attr("value",i.translate("common|owned")))},disablePurchase:function(){b('input[name="purchase_item"]',this.$el).prop("disabled",!0)},enablePurchase:function(){b('input[name="purchase_item"]',this.$el).prop("disabled",!1)},showRecharge:function(){b(".account-recharge",this.$el).removeClass("hidden"),b(".account-balance-amount",this.$el).removeClass("font-color-green").addClass("font-color-red")},hideRecharge:function(){b(".account-recharge",this.$el).addClass("hidden"),b(".account-balance-amount",this.$el).addClass("font-color-green").removeClass("font-color-red")},setToUsername:function(a){""!==a&&(this.toUsername=a)},setCampaignId:function(a){""!==a&&(this.campaignId=a)}});return l}),define("hbs!modules/template/store/store-item-virtualgift-detail",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var c,d="";return d+='\n	<div class="image app-ico-header">\n		<img src="'+A((c=a&&a.storePartner,c=null==c||c===!1?c:c.content_data,c=null==c||c===!1?c:c.logo_image,typeof c===z?c.apply(a):c))+'" height="32" />\n		<span class="app-title padding-8px display-inline-block">\n			<div class="app-name">'+A((c=a&&a.storePartner,c=null==c||c===!1?c:c.store_category_name,typeof c===z?c.apply(a):c))+'</div>\n			<div class="company-name">'+A((c=a&&a.storePartner,c=null==c||c===!1?c:c.name,typeof c===z?c.apply(a):c))+"</div>\n		</span>\n	</div>\n"}function g(a,b){return"app-item-img"}function h(a,b){var d,e,f="";return f+='\n				<img src="'+A((d=c.getStoreItemImage||a&&a.getStoreItemImage,e={hash:{},data:b},d?d.call(a,a,64,e):B.call(a,"getStoreItemImage",a,64,e)))+'" width="64" height="64" />\n			'}function i(a,b){var d,e,f="";return f+='\n				<img src="'+A((d=c.getStoreItemImage||a&&a.getStoreItemImage,e={hash:{},data:b},d?d.call(a,a,64,e):B.call(a,"getStoreItemImage",a,64,e)))+'" width="64" height="64" class="greyscale-image" />\n			'}function j(a,b){var d,e,f="";return f+='\n					<span class="price font-color-caption">'+A((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"store|free",e):B.call(a,"translate","store|free",e)))+"</span>\n				"}function k(a,b){var d,e,f="";return f+='\n					<span class="price font-color-caption">',(e=c.localPrice)?d=e.call(a,{hash:{},data:b}):(e=a&&a.localPrice,d=typeof e===z?e.call(a,{hash:{},data:b}):e),f+=A(d)+" ",(e=c.localCurrency)?d=e.call(a,{hash:{},data:b}):(e=a&&a.localCurrency,d=typeof e===z?e.call(a,{hash:{},data:b}):e),f+=A(d)+"</span>\n				"}function l(a,b){var d,e,f,g="";return g+='\n		<div class="premium"><span class="wb wb-16 wb-premium"></span> ',e=c.getPremiumItemMessage||a&&a.getPremiumItemMessage,f={hash:{},data:b},d=e?e.call(a,a,f):B.call(a,"getPremiumItemMessage",a,f),(d||0===d)&&(g+=d),g+="</div>\n	"}function m(a,b){var d,e,f="";return f+='\n		<div class="store-message font-color-caption">',(e=c.getCXBMessage)?d=e.call(a,{hash:{},data:b}):(e=a&&a.getCXBMessage,d=typeof e===z?e.call(a,{hash:{},data:b}):e),(d||0===d)&&(f+=d),f+="</div>\n	"}function n(a,b){var d,e,f,g="";return g+='\n	<div class="body allowed-to-buy">\n		<form class="purchase-form" action="/store/item/',(e=c.id)?d=e.call(a,{hash:{},data:b}):(e=a&&a.id,d=typeof e===z?e.call(a,{hash:{},data:b}):e),g+=A(d)+'/purchase" method="post">\n			<div class="to">\n				<input type="text" id="to" value="" disabled />\n			</div>\n			<div class="message">\n				<textarea name="message" rows="1" cols="100" placeholder="'+A((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"store|enter_message",f):B.call(a,"translate","store|enter_message",f)))+'"></textarea>\n			</div>\n			<div class="options">\n				<div class="row">\n					',e=c.compare||a&&a.compare,f={hash:{},inverse:C.noop,fn:C.program(18,o,b),data:b},d=e?e.call(a,a&&a.type,"VIRTUAL_GIFT",f):B.call(a,"compare",a&&a.type,"VIRTUAL_GIFT",f),(d||0===d)&&(g+=d),g+="\n\n					",e=c.compare||a&&a.compare,f={hash:{},inverse:C.noop,fn:C.program(20,p,b),data:b},d=e?e.call(a,a&&a.type,"APP_ITEM_WHEN_FUSION_READY.add post to miniblog to all as well",f):B.call(a,"compare",a&&a.type,"APP_ITEM_WHEN_FUSION_READY.add post to miniblog to all as well",f),(d||0===d)&&(g+=d),g+='\n				</div>\n			</div>\n			<div class="send text-center">\n				',e=c.compare||a&&a.compare,f={hash:{},inverse:C.program(24,r,b),fn:C.program(22,q,b),data:b},d=e?e.call(a,a&&a.type,"APP_ITEM",f):B.call(a,"compare",a&&a.type,"APP_ITEM",f),(d||0===d)&&(g+=d),g+="\n			</div>\n		</form>\n	</div>\n"}function o(a,b){var d,e,f="";return f+='\n						<div class="col-xs-6 col-sm-3">\n							<label>\n								<input type="checkbox" name="private" value="1" />&nbsp;&nbsp;'+A((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"store|private_gift",e):B.call(a,"translate","store|private_gift",e)))+'\n							</label>\n						</div><div class="col-xs-6 col-sm-5">\n							<label>\n								<input type="checkbox" name="post_to_miniblog" value="1" />&nbsp;&nbsp;'+A((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"store|post_to_miniblog",e):B.call(a,"translate","store|post_to_miniblog",e)))+"\n							</label>\n						</div>\n					"}function p(a,b){var d,e,f="";return f+='\n						<div class="col-xs-3">\n							<label>\n								<input type="checkbox" name="private" value="1" />&nbsp;&nbsp;'+A((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"store|private_gift",e):B.call(a,"translate","store|private_gift",e)))+"\n							</label>\n						</div>\n					"}function q(a,b){var d,e,f,g="";return g+='\n				<input type="button" name="purchase_item" class="btn btn-button btn-default" value="',(e=c.sendItemButton)?d=e.call(a,{hash:{},data:b}):(e=a&&a.sendItemButton,d=typeof e===z?e.call(a,{hash:{},data:b}):e),g+=A(d)+" "+A((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"store|item",f):B.call(a,"translate","store|item",f)))+'" disabled />\n				'}function r(a,b){var d,e,f,g="";return g+="\n				",e=c.compare||a&&a.compare,f={hash:{},inverse:C.program(25,s,b),fn:C.program(22,q,b),data:b},d=e?e.call(a,a&&a.type,"GAME_ITEM",f):B.call(a,"compare",a&&a.type,"GAME_ITEM",f),(d||0===d)&&(g+=d),g+="\n				"}function s(a,b){var d,e,f="";return f+='\n				<input type="button" name="purchase_item" class="btn btn-button btn-default" value="'+A((d=c.sendItemButton||a&&a.sendItemButton,e={hash:{},data:b},d?d.call(a,a,e):B.call(a,"sendItemButton",a,e)))+'" disabled />\n				'}function t(a,b){var d,e,f="";return f+='\n	<div class="body">\n		<div class="error-title">',(e=c.getNotAllowedToPurchaseItemTitle)?d=e.call(a,{hash:{},data:b}):(e=a&&a.getNotAllowedToPurchaseItemTitle,d=typeof e===z?e.call(a,{hash:{},data:b}):e),f+=A(d)+'</div>\n		<div class="error-message">',(e=c.getNotAllowedToPurchaseItemMessage)?d=e.call(a,{hash:{},data:b}):(e=a&&a.getNotAllowedToPurchaseItemMessage,d=typeof e===z?e.call(a,{hash:{},data:b}):e),(d||0===d)&&(f+=d),f+="</div>\n	</div>\n"}function u(a,b){var d,e,f="";return f+='\n	<div class="sticker-preview"><img src="'+A((d=c.getStoreItemImage||a&&a.getStoreItemImage,e={hash:{},data:b},d?d.call(a,a,650,e):B.call(a,"getStoreItemImage",a,650,e)))+'" /></div>\n'}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var v,w,x,y="",z="function",A=this.escapeExpression,B=c.helperMissing,C=this,D=c.blockHelperMissing;return y+='<span class="icon-wb_closepopup close pull-right font-color-grey visible-xs" data-dismiss="modal"></span>\n\n',w=c.isNotEmpty||b&&b.isNotEmpty,x={hash:{},inverse:C.noop,fn:C.program(1,f,e),data:e},v=w?w.call(b,(v=b&&b.storePartner,v=null==v||v===!1?v:v.content_data,null==v||v===!1?v:v.logo_image),x):B.call(b,"isNotEmpty",(v=b&&b.storePartner,v=null==v||v===!1?v:v.content_data,null==v||v===!1?v:v.logo_image),x),(v||0===v)&&(y+=v),y+='\n\n<h3 class="store-item-title text-center font-light">'+A((w=c.translate||b&&b.translate,x={hash:{},data:e},w?w.call(b,"store|send_item_gift",x):B.call(b,"translate","store|send_item_gift",x)))+'</h3>\n<div class="text-center font-color-caption">\n	<span class="font-bold">'+A((w=c.translate||b&&b.translate,x={hash:{},data:e},w?w.call(b,"store|credit_balance",x):B.call(b,"translate","store|credit_balance",x)))+'</span>\n	&nbsp;&nbsp;\n	<span class="font-color-green account-balance-amount">\n		<span class="loading">Loading...</span>\n	</span>\n	&nbsp;&nbsp;\n	<a href="/credit" class="hidden font-color-link font-bold account-recharge" data-dismiss="modal">'+A((w=c.translate||b&&b.translate,x={hash:{},data:e},w?w.call(b,"store|recharge",x):B.call(b,"translate","store|recharge",x)))+'</a>\n</div>\n\n<div class="detail">\n	<div class="store-item-icon">\n		<div class="item-details ',w=c.compare||b&&b.compare,x={hash:{},inverse:C.noop,fn:C.program(3,g,e),data:e},v=w?w.call(b,b&&b.type,"APP_ITEM",x):B.call(b,"compare",b&&b.type,"APP_ITEM",x),(v||0===v)&&(y+=v),y+=" ",w=c.compare||b&&b.compare,x={hash:{},inverse:C.noop,fn:C.program(3,g,e),data:e},v=w?w.call(b,b&&b.type,"GAME_ITEM",x):B.call(b,"compare",b&&b.type,"GAME_ITEM",x),(v||0===v)&&(y+=v),y+='">\n			',x={hash:{},inverse:C.program(7,i,e),fn:C.program(5,h,e),data:e},(w=c.ifAllowedToBuyItem)?v=w.call(b,x):(w=b&&b.ifAllowedToBuyItem,v=typeof w===z?w.call(b,x):w),c.ifAllowedToBuyItem||(v=D.call(b,v,{hash:{},inverse:C.program(7,i,e),fn:C.program(5,h,e),data:e})),(v||0===v)&&(y+=v),y+='\n			<div class="details">\n				<div class="title font-bold">',(w=c.name)?v=w.call(b,{hash:{},data:e}):(w=b&&b.name,v=typeof w===z?w.call(b,{hash:{},data:e}):w),y+=A(v)+"</div>\n				",w=c.compare||b&&b.compare,x={hash:{},inverse:C.program(11,k,e),fn:C.program(9,j,e),data:e},v=w?w.call(b,b&&b.price,0,x):B.call(b,"compare",b&&b.price,0,x),(v||0===v)&&(y+=v),y+='\n			</div>\n		</div>\n	</div>\n\n	<div class="quantity font-size-14 padding-12-15px hidden">\n		'+A((w=c.translate||b&&b.translate,x={hash:{},data:e},w?w.call(b,"store|number_with_colon",x):B.call(b,"translate","store|number_with_colon",x)))+' <span class="total-quantity">-</span>\n		<br/>\n		<b>'+A((w=c.translate||b&&b.translate,x={hash:{},data:e},w?w.call(b,"store|total_price_with_colon",x):B.call(b,"translate","store|total_price_with_colon",x)))+'</b> <span class="total-price">-</span>\n	</div>\n\n	',w=c.ifPremiumItem||b&&b.ifPremiumItem,x={hash:{},inverse:C.noop,fn:C.program(13,l,e),data:e},v=w?w.call(b,b,x):B.call(b,"ifPremiumItem",b,x),(v||0===v)&&(y+=v),y+="\n	",w=c.compare||b&&b.compare,x={hash:{},inverse:C.noop,fn:C.program(15,m,e),data:e},v=w?w.call(b,b&&b.type,"APP_ITEM",x):B.call(b,"compare",b&&b.type,"APP_ITEM",x),(v||0===v)&&(y+=v),y+="\n	",w=c.compare||b&&b.compare,x={hash:{},inverse:C.noop,fn:C.program(15,m,e),data:e},v=w?w.call(b,b&&b.type,"GAME_ITEM",x):B.call(b,"compare",b&&b.type,"GAME_ITEM",x),(v||0===v)&&(y+=v),y+="\n</div>\n\n",x={hash:{},inverse:C.program(27,t,e),fn:C.program(17,n,e),data:e},(w=c.ifAllowedToBuyItem)?v=w.call(b,x):(w=b&&b.ifAllowedToBuyItem,v=typeof w===z?w.call(b,x):w),c.ifAllowedToBuyItem||(v=D.call(b,v,{hash:{},inverse:C.program(27,t,e),fn:C.program(17,n,e),data:e})),(v||0===v)&&(y+=v),y+="\n\n",w=c.compare||b&&b.compare,x={hash:{},inverse:C.noop,fn:C.program(29,u,e),data:e},v=w?w.call(b,b&&b.type,"STICKER",x):B.call(b,"compare",b&&b.type,"STICKER",x),(v||0===v)&&(y+=v),y})}),function(a,b){function c(b,c){var e,f,g,h=b.nodeName.toLowerCase();return"area"===h?(e=b.parentNode,f=e.name,b.href&&f&&"map"===e.nodeName.toLowerCase()?(g=a("img[usemap=#"+f+"]")[0],!!g&&d(g)):!1):(/input|select|textarea|button|object/.test(h)?!b.disabled:"a"===h?b.href||c:c)&&d(b)}function d(b){return a.expr.filters.visible(b)&&!a(b).parents().addBack().filter(function(){return"hidden"===a.css(this,"visibility")}).length}var e=0,f=/^ui-id-\d+$/;a.ui=a.ui||{},a.extend(a.ui,{version:"1.10.3",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),a.fn.extend({focus:function(b){return function(c,d){return"number"==typeof c?this.each(function(){var b=this;setTimeout(function(){a(b).focus(),d&&d.call(b)},c)}):b.apply(this,arguments)}}(a.fn.focus),scrollParent:function(){var b;return b=a.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.css(this,"position"))&&/(auto|scroll)/.test(a.css(this,"overflow")+a.css(this,"overflow-y")+a.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(a.css(this,"overflow")+a.css(this,"overflow-y")+a.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!b.length?a(document):b},zIndex:function(c){if(c!==b)return this.css("zIndex",c);if(this.length)for(var d,e,f=a(this[0]);f.length&&f[0]!==document;){if(d=f.css("position"),("absolute"===d||"relative"===d||"fixed"===d)&&(e=parseInt(f.css("zIndex"),10),!isNaN(e)&&0!==e))return e;f=f.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})},removeUniqueId:function(){return this.each(function(){f.test(this.id)&&a(this).removeAttr("id")})}}),a.extend(a.expr[":"],{data:a.expr.createPseudo?a.expr.createPseudo(function(b){return function(c){return!!a.data(c,b)}}):function(b,c,d){return!!a.data(b,d[3])},focusable:function(b){return c(b,!isNaN(a.attr(b,"tabindex")))},tabbable:function(b){var d=a.attr(b,"tabindex"),e=isNaN(d);return(e||d>=0)&&c(b,!e)}}),a("<a>").outerWidth(1).jquery||a.each(["Width","Height"],function(c,d){function e(b,c,d,e){return a.each(f,function(){c-=parseFloat(a.css(b,"padding"+this))||0,d&&(c-=parseFloat(a.css(b,"border"+this+"Width"))||0),e&&(c-=parseFloat(a.css(b,"margin"+this))||0)}),c}var f="Width"===d?["Left","Right"]:["Top","Bottom"],g=d.toLowerCase(),h={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+d]=function(c){return c===b?h["inner"+d].call(this):this.each(function(){a(this).css(g,e(this,c)+"px")})},a.fn["outer"+d]=function(b,c){return"number"!=typeof b?h["outer"+d].call(this,b):this.each(function(){a(this).css(g,e(this,b,!0,c)+"px")})}}),a.fn.addBack||(a.fn.addBack=function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}),a("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(a.fn.removeData=function(b){return function(c){return arguments.length?b.call(this,a.camelCase(c)):b.call(this)}}(a.fn.removeData)),a.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),a.support.selectstart="onselectstart"in document.createElement("div"),a.fn.extend({disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),a.extend(a.ui,{plugin:{add:function(b,c,d){var e,f=a.ui[b].prototype;for(e in d)f.plugins[e]=f.plugins[e]||[],f.plugins[e].push([c,d[e]])},call:function(a,b,c){var d,e=a.plugins[b];if(e&&a.element[0].parentNode&&11!==a.element[0].parentNode.nodeType)for(d=0;e.length>d;d++)a.options[e[d][0]]&&e[d][1].apply(a.element,c)}},hasScroll:function(b,c){if("hidden"===a(b).css("overflow"))return!1;var d=c&&"left"===c?"scrollLeft":"scrollTop",e=!1;return b[d]>0?!0:(b[d]=1,e=b[d]>0,b[d]=0,e)}})}(jQuery),function(a,b){var c=0,d=Array.prototype.slice,e=a.cleanData;a.cleanData=function(b){for(var c,d=0;null!=(c=b[d]);d++)try{a(c).triggerHandler("remove")}catch(f){}e(b)},a.widget=function(c,d,e){var f,g,h,i,j={},k=c.split(".")[0];c=c.split(".")[1],f=k+"-"+c,e||(e=d,d=a.Widget),a.expr[":"][f.toLowerCase()]=function(b){return!!a.data(b,f)},a[k]=a[k]||{},g=a[k][c],h=a[k][c]=function(a,c){return this._createWidget?(arguments.length&&this._createWidget(a,c),b):new h(a,c)},a.extend(h,g,{version:e.version,_proto:a.extend({},e),_childConstructors:[]}),i=new d,i.options=a.widget.extend({},i.options),a.each(e,function(c,e){return a.isFunction(e)?(j[c]=function(){var a=function(){return d.prototype[c].apply(this,arguments)},b=function(a){return d.prototype[c].apply(this,a)};return function(){var c,d=this._super,f=this._superApply;return this._super=a,this._superApply=b,c=e.apply(this,arguments),this._super=d,this._superApply=f,c}}(),b):(j[c]=e,b)}),h.prototype=a.widget.extend(i,{widgetEventPrefix:g?i.widgetEventPrefix:c},j,{constructor:h,namespace:k,widgetName:c,widgetFullName:f}),g?(a.each(g._childConstructors,function(b,c){var d=c.prototype;a.widget(d.namespace+"."+d.widgetName,h,c._proto)}),delete g._childConstructors):d._childConstructors.push(h),a.widget.bridge(c,h)},a.widget.extend=function(c){for(var e,f,g=d.call(arguments,1),h=0,i=g.length;i>h;h++)for(e in g[h])f=g[h][e],g[h].hasOwnProperty(e)&&f!==b&&(c[e]=a.isPlainObject(f)?a.isPlainObject(c[e])?a.widget.extend({},c[e],f):a.widget.extend({},f):f);return c},a.widget.bridge=function(c,e){var f=e.prototype.widgetFullName||c;a.fn[c]=function(g){var h="string"==typeof g,i=d.call(arguments,1),j=this;return g=!h&&i.length?a.widget.extend.apply(null,[g].concat(i)):g,h?this.each(function(){var d,e=a.data(this,f);return e?a.isFunction(e[g])&&"_"!==g.charAt(0)?(d=e[g].apply(e,i),d!==e&&d!==b?(j=d&&d.jquery?j.pushStack(d.get()):d,!1):b):a.error("no such method '"+g+"' for "+c+" widget instance"):a.error("cannot call methods on "+c+" prior to initialization; attempted to call method '"+g+"'")}):this.each(function(){var b=a.data(this,f);b?b.option(g||{})._init():a.data(this,f,new e(g,this))}),j}},a.Widget=function(){},a.Widget._childConstructors=[],a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(b,d){d=a(d||this.defaultElement||this)[0],this.element=a(d),this.uuid=c++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=a.widget.extend({},this.options,this._getCreateOptions(),b),this.bindings=a(),this.hoverable=a(),this.focusable=a(),d!==this&&(a.data(d,this.widgetFullName,this),this._on(!0,this.element,{remove:function(a){a.target===d&&this.destroy()}}),this.document=a(d.style?d.ownerDocument:d.document||d),this.window=a(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:a.noop,_getCreateEventData:a.noop,_create:a.noop,_init:a.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(a.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:a.noop,widget:function(){return this.element},option:function(c,d){var e,f,g,h=c;if(0===arguments.length)return a.widget.extend({},this.options);if("string"==typeof c)if(h={},e=c.split("."),c=e.shift(),e.length){for(f=h[c]=a.widget.extend({},this.options[c]),g=0;e.length-1>g;g++)f[e[g]]=f[e[g]]||{},f=f[e[g]];if(c=e.pop(),d===b)return f[c]===b?null:f[c];f[c]=d}else{if(d===b)return this.options[c]===b?null:this.options[c];h[c]=d}return this._setOptions(h),this},_setOptions:function(a){var b;for(b in a)this._setOption(b,a[b]);return this},_setOption:function(a,b){return this.options[a]=b,"disabled"===a&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!b).attr("aria-disabled",b),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(c,d,e){var f,g=this;"boolean"!=typeof c&&(e=d,d=c,c=!1),e?(d=f=a(d),this.bindings=this.bindings.add(d)):(e=d,d=this.element,f=this.widget()),a.each(e,function(e,h){function i(){return c||g.options.disabled!==!0&&!a(this).hasClass("ui-state-disabled")?("string"==typeof h?g[h]:h).apply(g,arguments):b}"string"!=typeof h&&(i.guid=h.guid=h.guid||i.guid||a.guid++);var j=e.match(/^(\w+)\s*(.*)$/),k=j[1]+g.eventNamespace,l=j[2];l?f.delegate(l,k,i):d.bind(k,i)})},_off:function(a,b){b=(b||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,a.unbind(b).undelegate(b)},_delay:function(a,b){function c(){return("string"==typeof a?d[a]:a).apply(d,arguments)}var d=this;return setTimeout(c,b||0)},_hoverable:function(b){this.hoverable=this.hoverable.add(b),this._on(b,{mouseenter:function(b){a(b.currentTarget).addClass("ui-state-hover")},mouseleave:function(b){a(b.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(b){this.focusable=this.focusable.add(b),this._on(b,{focusin:function(b){a(b.currentTarget).addClass("ui-state-focus")},focusout:function(b){a(b.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(b,c,d){var e,f,g=this.options[b];if(d=d||{},c=a.Event(c),c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase(),c.target=this.element[0],f=c.originalEvent)for(e in f)e in c||(c[e]=f[e]);return this.element.trigger(c,d),!(a.isFunction(g)&&g.apply(this.element[0],[c].concat(d))===!1||c.isDefaultPrevented())}},a.each({show:"fadeIn",hide:"fadeOut"},function(b,c){a.Widget.prototype["_"+b]=function(d,e,f){"string"==typeof e&&(e={effect:e});var g,h=e?e===!0||"number"==typeof e?c:e.effect||c:b;e=e||{},"number"==typeof e&&(e={duration:e}),g=!a.isEmptyObject(e),e.complete=f,e.delay&&d.delay(e.delay),g&&a.effects&&a.effects.effect[h]?d[b](e):h!==b&&d[h]?d[h](e.duration,e.easing,f):d.queue(function(c){a(this)[b](),f&&f.call(d[0]),c()})}})}(jQuery),function(a){var b=!1;a(document).mouseup(function(){b=!1}),a.widget("ui.mouse",{version:"1.10.3",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var b=this;this.element.bind("mousedown."+this.widgetName,function(a){return b._mouseDown(a)}).bind("click."+this.widgetName,function(c){return!0===a.data(c.target,b.widgetName+".preventClickEvent")?(a.removeData(c.target,b.widgetName+".preventClickEvent"),c.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(c){if(!b){this._mouseStarted&&this._mouseUp(c),this._mouseDownEvent=c;var d=this,e=1===c.which,f="string"==typeof this.options.cancel&&c.target.nodeName?a(c.target).closest(this.options.cancel).length:!1;return e&&!f&&this._mouseCapture(c)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){d.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(c)&&this._mouseDelayMet(c)&&(this._mouseStarted=this._mouseStart(c)!==!1,!this._mouseStarted)?(c.preventDefault(),!0):(!0===a.data(c.target,this.widgetName+".preventClickEvent")&&a.removeData(c.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(a){return d._mouseMove(a)},this._mouseUpDelegate=function(a){return d._mouseUp(a)},a(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),c.preventDefault(),b=!0,!0)):!0}},_mouseMove:function(b){return a.ui.ie&&(!document.documentMode||9>document.documentMode)&&!b.button?this._mouseUp(b):this._mouseStarted?(this._mouseDrag(b),b.preventDefault()):(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,b)!==!1,this._mouseStarted?this._mouseDrag(b):this._mouseUp(b)),!this._mouseStarted)},_mouseUp:function(b){return a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,b.target===this._mouseDownEvent.target&&a.data(b.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(b)),!1},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),function(a){a.widget("ui.draggable",a.ui.mouse,{version:"1.10.3",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(b){var c=this.options;return this.helper||c.disabled||a(b.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(b),this.handle?(a(c.iframeFix===!0?"iframe":c.iframeFix).each(function(){a("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(a(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(b){var c=this.options;return this.helper=this._createHelper(b),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),a.ui.ddmanager&&(a.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(b),this.originalPageX=b.pageX,this.originalPageY=b.pageY,c.cursorAt&&this._adjustOffsetFromHelper(c.cursorAt),this._setContainment(),this._trigger("start",b)===!1?(this._clear(),!1):(this._cacheHelperProportions(),a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this._mouseDrag(b,!0),a.ui.ddmanager&&a.ui.ddmanager.dragStart(this,b),!0)},_mouseDrag:function(b,c){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(b),this.positionAbs=this._convertPositionTo("absolute"),!c){var d=this._uiHash();if(this._trigger("drag",b,d)===!1)return this._mouseUp({}),!1;this.position=d.position}return this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),!1},_mouseStop:function(b){var c=this,d=!1;return a.ui.ddmanager&&!this.options.dropBehaviour&&(d=a.ui.ddmanager.drop(this,b)),this.dropped&&(d=this.dropped,this.dropped=!1),"original"!==this.options.helper||a.contains(this.element[0].ownerDocument,this.element[0])?("invalid"===this.options.revert&&!d||"valid"===this.options.revert&&d||this.options.revert===!0||a.isFunction(this.options.revert)&&this.options.revert.call(this.element,d)?a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){c._trigger("stop",b)!==!1&&c._clear()}):this._trigger("stop",b)!==!1&&this._clear(),!1):!1},_mouseUp:function(b){return a("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),a.ui.ddmanager&&a.ui.ddmanager.dragStop(this,b),a.ui.mouse.prototype._mouseUp.call(this,b)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(b){return this.options.handle?!!a(b.target).closest(this.element.find(this.options.handle)).length:!0},_createHelper:function(b){var c=this.options,d=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[b])):"clone"===c.helper?this.element.clone().removeAttr("id"):this.element;return d.parents("body").length||d.appendTo("parent"===c.appendTo?this.element[0].parentNode:c.appendTo),d[0]===this.element[0]||/(fixed|absolute)/.test(d.css("position"))||d.css("position","absolute"),d},_adjustOffsetFromHelper:function(b){"string"==typeof b&&(b=b.split(" ")),a.isArray(b)&&(b={left:+b[0],top:+b[1]||0}),"left"in b&&(this.offset.click.left=b.left+this.margins.left),"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left),"top"in b&&(this.offset.click.top=b.top+this.margins.top),"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){var b=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&a.ui.ie)&&(b={top:0,left:0}),{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var a=this.element.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){
this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b,c,d,e=this.options;return e.containment?"window"===e.containment?void(this.containment=[a(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,a(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,a(window).scrollLeft()+a(window).width()-this.helperProportions.width-this.margins.left,a(window).scrollTop()+(a(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===e.containment?void(this.containment=[0,0,a(document).width()-this.helperProportions.width-this.margins.left,(a(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):e.containment.constructor===Array?void(this.containment=e.containment):("parent"===e.containment&&(e.containment=this.helper[0].parentNode),c=a(e.containment),d=c[0],void(d&&(b="hidden"!==c.css("overflow"),this.containment=[(parseInt(c.css("borderLeftWidth"),10)||0)+(parseInt(c.css("paddingLeft"),10)||0),(parseInt(c.css("borderTopWidth"),10)||0)+(parseInt(c.css("paddingTop"),10)||0),(b?Math.max(d.scrollWidth,d.offsetWidth):d.offsetWidth)-(parseInt(c.css("borderRightWidth"),10)||0)-(parseInt(c.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(b?Math.max(d.scrollHeight,d.offsetHeight):d.offsetHeight)-(parseInt(c.css("borderBottomWidth"),10)||0)-(parseInt(c.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=c))):void(this.containment=null)},_convertPositionTo:function(b,c){c||(c=this.position);var d="absolute"===b?1:-1,e="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent;return this.offset.scroll||(this.offset.scroll={top:e.scrollTop(),left:e.scrollLeft()}),{top:c.top+this.offset.relative.top*d+this.offset.parent.top*d-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top)*d,left:c.left+this.offset.relative.left*d+this.offset.parent.left*d-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)*d}},_generatePosition:function(b){var c,d,e,f,g=this.options,h="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,i=b.pageX,j=b.pageY;return this.offset.scroll||(this.offset.scroll={top:h.scrollTop(),left:h.scrollLeft()}),this.originalPosition&&(this.containment&&(this.relative_container?(d=this.relative_container.offset(),c=[this.containment[0]+d.left,this.containment[1]+d.top,this.containment[2]+d.left,this.containment[3]+d.top]):c=this.containment,b.pageX-this.offset.click.left<c[0]&&(i=c[0]+this.offset.click.left),b.pageY-this.offset.click.top<c[1]&&(j=c[1]+this.offset.click.top),b.pageX-this.offset.click.left>c[2]&&(i=c[2]+this.offset.click.left),b.pageY-this.offset.click.top>c[3]&&(j=c[3]+this.offset.click.top)),g.grid&&(e=g.grid[1]?this.originalPageY+Math.round((j-this.originalPageY)/g.grid[1])*g.grid[1]:this.originalPageY,j=c?e-this.offset.click.top>=c[1]||e-this.offset.click.top>c[3]?e:e-this.offset.click.top>=c[1]?e-g.grid[1]:e+g.grid[1]:e,f=g.grid[0]?this.originalPageX+Math.round((i-this.originalPageX)/g.grid[0])*g.grid[0]:this.originalPageX,i=c?f-this.offset.click.left>=c[0]||f-this.offset.click.left>c[2]?f:f-this.offset.click.left>=c[0]?f-g.grid[0]:f+g.grid[0]:f)),{top:j-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top),left:i-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(b,c,d){return d=d||this._uiHash(),a.ui.plugin.call(this,b,[c,d]),"drag"===b&&(this.positionAbs=this._convertPositionTo("absolute")),a.Widget.prototype._trigger.call(this,b,c,d)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),a.ui.plugin.add("draggable","connectToSortable",{start:function(b,c){var d=a(this).data("ui-draggable"),e=d.options,f=a.extend({},c,{item:d.element});d.sortables=[],a(e.connectToSortable).each(function(){var c=a.data(this,"ui-sortable");c&&!c.options.disabled&&(d.sortables.push({instance:c,shouldRevert:c.options.revert}),c.refreshPositions(),c._trigger("activate",b,f))})},stop:function(b,c){var d=a(this).data("ui-draggable"),e=a.extend({},c,{item:d.element});a.each(d.sortables,function(){this.instance.isOver?(this.instance.isOver=0,d.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(b),this.instance.options.helper=this.instance.options._helper,"original"===d.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",b,e))})},drag:function(b,c){var d=a(this).data("ui-draggable"),e=this;a.each(d.sortables,function(){var f=!1,g=this;this.instance.positionAbs=d.positionAbs,this.instance.helperProportions=d.helperProportions,this.instance.offset.click=d.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(f=!0,a.each(d.sortables,function(){return this.instance.positionAbs=d.positionAbs,this.instance.helperProportions=d.helperProportions,this.instance.offset.click=d.offset.click,this!==g&&this.instance._intersectsWith(this.instance.containerCache)&&a.contains(g.instance.element[0],this.instance.element[0])&&(f=!1),f})),f?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=a(e).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return c.helper[0]},b.target=this.instance.currentItem[0],this.instance._mouseCapture(b,!0),this.instance._mouseStart(b,!0,!0),this.instance.offset.click.top=d.offset.click.top,this.instance.offset.click.left=d.offset.click.left,this.instance.offset.parent.left-=d.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=d.offset.parent.top-this.instance.offset.parent.top,d._trigger("toSortable",b),d.dropped=this.instance.element,d.currentItem=d.element,this.instance.fromOutside=d),this.instance.currentItem&&this.instance._mouseDrag(b)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",b,this.instance._uiHash(this.instance)),this.instance._mouseStop(b,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),d._trigger("fromSortable",b),d.dropped=!1)})}}),a.ui.plugin.add("draggable","cursor",{start:function(){var b=a("body"),c=a(this).data("ui-draggable").options;b.css("cursor")&&(c._cursor=b.css("cursor")),b.css("cursor",c.cursor)},stop:function(){var b=a(this).data("ui-draggable").options;b._cursor&&a("body").css("cursor",b._cursor)}}),a.ui.plugin.add("draggable","opacity",{start:function(b,c){var d=a(c.helper),e=a(this).data("ui-draggable").options;d.css("opacity")&&(e._opacity=d.css("opacity")),d.css("opacity",e.opacity)},stop:function(b,c){var d=a(this).data("ui-draggable").options;d._opacity&&a(c.helper).css("opacity",d._opacity)}}),a.ui.plugin.add("draggable","scroll",{start:function(){var b=a(this).data("ui-draggable");b.scrollParent[0]!==document&&"HTML"!==b.scrollParent[0].tagName&&(b.overflowOffset=b.scrollParent.offset())},drag:function(b){var c=a(this).data("ui-draggable"),d=c.options,e=!1;c.scrollParent[0]!==document&&"HTML"!==c.scrollParent[0].tagName?(d.axis&&"x"===d.axis||(c.overflowOffset.top+c.scrollParent[0].offsetHeight-b.pageY<d.scrollSensitivity?c.scrollParent[0].scrollTop=e=c.scrollParent[0].scrollTop+d.scrollSpeed:b.pageY-c.overflowOffset.top<d.scrollSensitivity&&(c.scrollParent[0].scrollTop=e=c.scrollParent[0].scrollTop-d.scrollSpeed)),d.axis&&"y"===d.axis||(c.overflowOffset.left+c.scrollParent[0].offsetWidth-b.pageX<d.scrollSensitivity?c.scrollParent[0].scrollLeft=e=c.scrollParent[0].scrollLeft+d.scrollSpeed:b.pageX-c.overflowOffset.left<d.scrollSensitivity&&(c.scrollParent[0].scrollLeft=e=c.scrollParent[0].scrollLeft-d.scrollSpeed))):(d.axis&&"x"===d.axis||(b.pageY-a(document).scrollTop()<d.scrollSensitivity?e=a(document).scrollTop(a(document).scrollTop()-d.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<d.scrollSensitivity&&(e=a(document).scrollTop(a(document).scrollTop()+d.scrollSpeed))),d.axis&&"y"===d.axis||(b.pageX-a(document).scrollLeft()<d.scrollSensitivity?e=a(document).scrollLeft(a(document).scrollLeft()-d.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<d.scrollSensitivity&&(e=a(document).scrollLeft(a(document).scrollLeft()+d.scrollSpeed)))),e!==!1&&a.ui.ddmanager&&!d.dropBehaviour&&a.ui.ddmanager.prepareOffsets(c,b)}}),a.ui.plugin.add("draggable","snap",{start:function(){var b=a(this).data("ui-draggable"),c=b.options;b.snapElements=[],a(c.snap.constructor!==String?c.snap.items||":data(ui-draggable)":c.snap).each(function(){var c=a(this),d=c.offset();this!==b.element[0]&&b.snapElements.push({item:this,width:c.outerWidth(),height:c.outerHeight(),top:d.top,left:d.left})})},drag:function(b,c){var d,e,f,g,h,i,j,k,l,m,n=a(this).data("ui-draggable"),o=n.options,p=o.snapTolerance,q=c.offset.left,r=q+n.helperProportions.width,s=c.offset.top,t=s+n.helperProportions.height;for(l=n.snapElements.length-1;l>=0;l--)h=n.snapElements[l].left,i=h+n.snapElements[l].width,j=n.snapElements[l].top,k=j+n.snapElements[l].height,h-p>r||q>i+p||j-p>t||s>k+p||!a.contains(n.snapElements[l].item.ownerDocument,n.snapElements[l].item)?(n.snapElements[l].snapping&&n.options.snap.release&&n.options.snap.release.call(n.element,b,a.extend(n._uiHash(),{snapItem:n.snapElements[l].item})),n.snapElements[l].snapping=!1):("inner"!==o.snapMode&&(d=p>=Math.abs(j-t),e=p>=Math.abs(k-s),f=p>=Math.abs(h-r),g=p>=Math.abs(i-q),d&&(c.position.top=n._convertPositionTo("relative",{top:j-n.helperProportions.height,left:0}).top-n.margins.top),e&&(c.position.top=n._convertPositionTo("relative",{top:k,left:0}).top-n.margins.top),f&&(c.position.left=n._convertPositionTo("relative",{top:0,left:h-n.helperProportions.width}).left-n.margins.left),g&&(c.position.left=n._convertPositionTo("relative",{top:0,left:i}).left-n.margins.left)),m=d||e||f||g,"outer"!==o.snapMode&&(d=p>=Math.abs(j-s),e=p>=Math.abs(k-t),f=p>=Math.abs(h-q),g=p>=Math.abs(i-r),d&&(c.position.top=n._convertPositionTo("relative",{top:j,left:0}).top-n.margins.top),e&&(c.position.top=n._convertPositionTo("relative",{top:k-n.helperProportions.height,left:0}).top-n.margins.top),f&&(c.position.left=n._convertPositionTo("relative",{top:0,left:h}).left-n.margins.left),g&&(c.position.left=n._convertPositionTo("relative",{top:0,left:i-n.helperProportions.width}).left-n.margins.left)),!n.snapElements[l].snapping&&(d||e||f||g||m)&&n.options.snap.snap&&n.options.snap.snap.call(n.element,b,a.extend(n._uiHash(),{snapItem:n.snapElements[l].item})),n.snapElements[l].snapping=d||e||f||g||m)}}),a.ui.plugin.add("draggable","stack",{start:function(){var b,c=this.data("ui-draggable").options,d=a.makeArray(a(c.stack)).sort(function(b,c){return(parseInt(a(b).css("zIndex"),10)||0)-(parseInt(a(c).css("zIndex"),10)||0)});d.length&&(b=parseInt(a(d[0]).css("zIndex"),10)||0,a(d).each(function(c){a(this).css("zIndex",b+c)}),this.css("zIndex",b+d.length))}}),a.ui.plugin.add("draggable","zIndex",{start:function(b,c){var d=a(c.helper),e=a(this).data("ui-draggable").options;d.css("zIndex")&&(e._zIndex=d.css("zIndex")),d.css("zIndex",e.zIndex)},stop:function(b,c){var d=a(this).data("ui-draggable").options;d._zIndex&&a(c.helper).css("zIndex",d._zIndex)}})}(jQuery),function(a){function b(a,b,c){return a>b&&b+c>a}a.widget("ui.droppable",{version:"1.10.3",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var b=this.options,c=b.accept;this.isover=!1,this.isout=!0,this.accept=a.isFunction(c)?c:function(a){return a.is(c)},this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight},a.ui.ddmanager.droppables[b.scope]=a.ui.ddmanager.droppables[b.scope]||[],a.ui.ddmanager.droppables[b.scope].push(this),b.addClasses&&this.element.addClass("ui-droppable")},_destroy:function(){for(var b=0,c=a.ui.ddmanager.droppables[this.options.scope];c.length>b;b++)c[b]===this&&c.splice(b,1);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(b,c){"accept"===b&&(this.accept=a.isFunction(c)?c:function(a){return a.is(c)}),a.Widget.prototype._setOption.apply(this,arguments)},_activate:function(b){var c=a.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),c&&this._trigger("activate",b,this.ui(c))},_deactivate:function(b){var c=a.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),c&&this._trigger("deactivate",b,this.ui(c))},_over:function(b){var c=a.ui.ddmanager.current;c&&(c.currentItem||c.element)[0]!==this.element[0]&&this.accept.call(this.element[0],c.currentItem||c.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",b,this.ui(c)))},_out:function(b){var c=a.ui.ddmanager.current;c&&(c.currentItem||c.element)[0]!==this.element[0]&&this.accept.call(this.element[0],c.currentItem||c.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",b,this.ui(c)))},_drop:function(b,c){var d=c||a.ui.ddmanager.current,e=!1;return d&&(d.currentItem||d.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var b=a.data(this,"ui-droppable");return b.options.greedy&&!b.options.disabled&&b.options.scope===d.options.scope&&b.accept.call(b.element[0],d.currentItem||d.element)&&a.ui.intersect(d,a.extend(b,{offset:b.element.offset()}),b.options.tolerance)?(e=!0,!1):void 0}),e?!1:this.accept.call(this.element[0],d.currentItem||d.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",b,this.ui(d)),this.element):!1):!1},ui:function(a){return{draggable:a.currentItem||a.element,helper:a.helper,position:a.position,offset:a.positionAbs}}}),a.ui.intersect=function(a,c,d){if(!c.offset)return!1;var e,f,g=(a.positionAbs||a.position.absolute).left,h=g+a.helperProportions.width,i=(a.positionAbs||a.position.absolute).top,j=i+a.helperProportions.height,k=c.offset.left,l=k+c.proportions.width,m=c.offset.top,n=m+c.proportions.height;switch(d){case"fit":return g>=k&&l>=h&&i>=m&&n>=j;case"intersect":return g+a.helperProportions.width/2>k&&l>h-a.helperProportions.width/2&&i+a.helperProportions.height/2>m&&n>j-a.helperProportions.height/2;case"pointer":return e=(a.positionAbs||a.position.absolute).left+(a.clickOffset||a.offset.click).left,f=(a.positionAbs||a.position.absolute).top+(a.clickOffset||a.offset.click).top,b(f,m,c.proportions.height)&&b(e,k,c.proportions.width);case"touch":return(i>=m&&n>=i||j>=m&&n>=j||m>i&&j>n)&&(g>=k&&l>=g||h>=k&&l>=h||k>g&&h>l);default:return!1}},a.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(b,c){var d,e,f=a.ui.ddmanager.droppables[b.options.scope]||[],g=c?c.type:null,h=(b.currentItem||b.element).find(":data(ui-droppable)").addBack();a:for(d=0;f.length>d;d++)if(!(f[d].options.disabled||b&&!f[d].accept.call(f[d].element[0],b.currentItem||b.element))){for(e=0;h.length>e;e++)if(h[e]===f[d].element[0]){f[d].proportions.height=0;continue a}f[d].visible="none"!==f[d].element.css("display"),f[d].visible&&("mousedown"===g&&f[d]._activate.call(f[d],c),f[d].offset=f[d].element.offset(),f[d].proportions={width:f[d].element[0].offsetWidth,height:f[d].element[0].offsetHeight})}},drop:function(b,c){var d=!1;return a.each((a.ui.ddmanager.droppables[b.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&a.ui.intersect(b,this,this.options.tolerance)&&(d=this._drop.call(this,c)||d),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],b.currentItem||b.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,c)))}),d},dragStart:function(b,c){b.element.parentsUntil("body").bind("scroll.droppable",function(){b.options.refreshPositions||a.ui.ddmanager.prepareOffsets(b,c)})},drag:function(b,c){b.options.refreshPositions&&a.ui.ddmanager.prepareOffsets(b,c),a.each(a.ui.ddmanager.droppables[b.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var d,e,f,g=a.ui.intersect(b,this,this.options.tolerance),h=!g&&this.isover?"isout":g&&!this.isover?"isover":null;h&&(this.options.greedy&&(e=this.options.scope,f=this.element.parents(":data(ui-droppable)").filter(function(){return a.data(this,"ui-droppable").options.scope===e}),f.length&&(d=a.data(f[0],"ui-droppable"),d.greedyChild="isover"===h)),d&&"isover"===h&&(d.isover=!1,d.isout=!0,d._out.call(d,c)),this[h]=!0,this["isout"===h?"isover":"isout"]=!1,this["isover"===h?"_over":"_out"].call(this,c),d&&"isout"===h&&(d.isout=!1,d.isover=!0,d._over.call(d,c)))}})},dragStop:function(b,c){b.element.parentsUntil("body").unbind("scroll.droppable"),b.options.refreshPositions||a.ui.ddmanager.prepareOffsets(b,c)}}}(jQuery),function(a){function b(a){return parseInt(a,10)||0}function c(a){return!isNaN(parseInt(a,10))}a.widget("ui.resizable",a.ui.mouse,{version:"1.10.3",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_create:function(){var b,c,d,e,f,g=this,h=this.options;if(this.element.addClass("ui-resizable"),a.extend(this,{_aspectRatio:!!h.aspectRatio,aspectRatio:h.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:h.helper||h.ghost||h.animate?h.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i)&&(this.element.wrap(a("<div class='ui-wrapper' style='overflow: hidden;'></div>").css({position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),this.element=this.element.parent().data("ui-resizable",this.element.data("ui-resizable")),this.elementIsWrapper=!0,this.element.css({marginLeft:this.originalElement.css("marginLeft"),marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom")}),this.originalElement.css({marginLeft:0,marginTop:0,marginRight:0,marginBottom:0}),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",zoom:1,display:"block"})),this.originalElement.css({margin:this.originalElement.css("margin")}),this._proportionallyResize()),this.handles=h.handles||(a(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),b=this.handles.split(","),this.handles={},c=0;b.length>c;c++)d=a.trim(b[c]),f="ui-resizable-"+d,e=a("<div class='ui-resizable-handle "+f+"'></div>"),e.css({zIndex:h.zIndex}),"se"===d&&e.addClass("ui-icon ui-icon-gripsmall-diagonal-se"),this.handles[d]=".ui-resizable-"+d,this.element.append(e);this._renderAxis=function(b){var c,d,e,f;b=b||this.element;for(c in this.handles)this.handles[c].constructor===String&&(this.handles[c]=a(this.handles[c],this.element).show()),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/textarea|input|select|button/i)&&(d=a(this.handles[c],this.element),f=/sw|ne|nw|se|n|s/.test(c)?d.outerHeight():d.outerWidth(),e=["padding",/ne|nw|n/.test(c)?"Top":/se|sw|s/.test(c)?"Bottom":/^e$/.test(c)?"Right":"Left"].join(""),b.css(e,f),this._proportionallyResize()),a(this.handles[c]).length},this._renderAxis(this.element),this._handles=a(".ui-resizable-handle",this.element).disableSelection(),this._handles.mouseover(function(){g.resizing||(this.className&&(e=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),g.axis=e&&e[1]?e[1]:"se")}),h.autoHide&&(this._handles.hide(),a(this.element).addClass("ui-resizable-autohide").mouseenter(function(){h.disabled||(a(this).removeClass("ui-resizable-autohide"),g._handles.show())}).mouseleave(function(){h.disabled||g.resizing||(a(this).addClass("ui-resizable-autohide"),g._handles.hide())})),this._mouseInit()},_destroy:function(){this._mouseDestroy();var b,c=function(b){a(b).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").removeData("ui-resizable").unbind(".resizable").find(".ui-resizable-handle").remove()};return this.elementIsWrapper&&(c(this.element),b=this.element,this.originalElement.css({position:b.css("position"),width:b.outerWidth(),height:b.outerHeight(),top:b.css("top"),left:b.css("left")}).insertAfter(b),b.remove()),this.originalElement.css("resize",this.originalResizeStyle),c(this.originalElement),this},_mouseCapture:function(b){var c,d,e=!1;for(c in this.handles)d=a(this.handles[c])[0],(d===b.target||a.contains(d,b.target))&&(e=!0);return!this.options.disabled&&e},_mouseStart:function(c){var d,e,f,g=this.options,h=this.element.position(),i=this.element;return this.resizing=!0,/absolute/.test(i.css("position"))?i.css({position:"absolute",top:i.css("top"),left:i.css("left")}):i.is(".ui-draggable")&&i.css({position:"absolute",top:h.top,left:h.left}),this._renderProxy(),d=b(this.helper.css("left")),e=b(this.helper.css("top")),g.containment&&(d+=a(g.containment).scrollLeft()||0,e+=a(g.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:d,top:e},this.size=this._helper?{width:i.outerWidth(),height:i.outerHeight()}:{width:i.width(),height:i.height()},this.originalSize=this._helper?{width:i.outerWidth(),height:i.outerHeight()}:{width:i.width(),height:i.height()},this.originalPosition={left:d,top:e},this.sizeDiff={width:i.outerWidth()-i.width(),height:i.outerHeight()-i.height()},this.originalMousePosition={left:c.pageX,top:c.pageY},this.aspectRatio="number"==typeof g.aspectRatio?g.aspectRatio:this.originalSize.width/this.originalSize.height||1,f=a(".ui-resizable-"+this.axis).css("cursor"),a("body").css("cursor","auto"===f?this.axis+"-resize":f),i.addClass("ui-resizable-resizing"),this._propagate("start",c),!0},_mouseDrag:function(b){var c,d=this.helper,e={},f=this.originalMousePosition,g=this.axis,h=this.position.top,i=this.position.left,j=this.size.width,k=this.size.height,l=b.pageX-f.left||0,m=b.pageY-f.top||0,n=this._change[g];return n?(c=n.apply(this,[b,l,m]),this._updateVirtualBoundaries(b.shiftKey),(this._aspectRatio||b.shiftKey)&&(c=this._updateRatio(c,b)),c=this._respectSize(c,b),this._updateCache(c),this._propagate("resize",b),this.position.top!==h&&(e.top=this.position.top+"px"),this.position.left!==i&&(e.left=this.position.left+"px"),this.size.width!==j&&(e.width=this.size.width+"px"),this.size.height!==k&&(e.height=this.size.height+"px"),d.css(e),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),a.isEmptyObject(e)||this._trigger("resize",b,this.ui()),!1):!1},_mouseStop:function(b){this.resizing=!1;var c,d,e,f,g,h,i,j=this.options,k=this;return this._helper&&(c=this._proportionallyResizeElements,d=c.length&&/textarea/i.test(c[0].nodeName),e=d&&a.ui.hasScroll(c[0],"left")?0:k.sizeDiff.height,f=d?0:k.sizeDiff.width,g={width:k.helper.width()-f,height:k.helper.height()-e},h=parseInt(k.element.css("left"),10)+(k.position.left-k.originalPosition.left)||null,i=parseInt(k.element.css("top"),10)+(k.position.top-k.originalPosition.top)||null,j.animate||this.element.css(a.extend(g,{top:i,left:h})),k.helper.height(k.size.height),k.helper.width(k.size.width),this._helper&&!j.animate&&this._proportionallyResize()),a("body").css("cursor","auto"),this.element.removeClass("ui-resizable-resizing"),this._propagate("stop",b),this._helper&&this.helper.remove(),!1},_updateVirtualBoundaries:function(a){var b,d,e,f,g,h=this.options;g={minWidth:c(h.minWidth)?h.minWidth:0,maxWidth:c(h.maxWidth)?h.maxWidth:1/0,minHeight:c(h.minHeight)?h.minHeight:0,maxHeight:c(h.maxHeight)?h.maxHeight:1/0},(this._aspectRatio||a)&&(b=g.minHeight*this.aspectRatio,e=g.minWidth/this.aspectRatio,d=g.maxHeight*this.aspectRatio,f=g.maxWidth/this.aspectRatio,b>g.minWidth&&(g.minWidth=b),e>g.minHeight&&(g.minHeight=e),g.maxWidth>d&&(g.maxWidth=d),g.maxHeight>f&&(g.maxHeight=f)),this._vBoundaries=g},_updateCache:function(a){this.offset=this.helper.offset(),c(a.left)&&(this.position.left=a.left),c(a.top)&&(this.position.top=a.top),c(a.height)&&(this.size.height=a.height),c(a.width)&&(this.size.width=a.width)},_updateRatio:function(a){var b=this.position,d=this.size,e=this.axis;return c(a.height)?a.width=a.height*this.aspectRatio:c(a.width)&&(a.height=a.width/this.aspectRatio),"sw"===e&&(a.left=b.left+(d.width-a.width),a.top=null),"nw"===e&&(a.top=b.top+(d.height-a.height),a.left=b.left+(d.width-a.width)),a},_respectSize:function(a){var b=this._vBoundaries,d=this.axis,e=c(a.width)&&b.maxWidth&&b.maxWidth<a.width,f=c(a.height)&&b.maxHeight&&b.maxHeight<a.height,g=c(a.width)&&b.minWidth&&b.minWidth>a.width,h=c(a.height)&&b.minHeight&&b.minHeight>a.height,i=this.originalPosition.left+this.originalSize.width,j=this.position.top+this.size.height,k=/sw|nw|w/.test(d),l=/nw|ne|n/.test(d);return g&&(a.width=b.minWidth),h&&(a.height=b.minHeight),e&&(a.width=b.maxWidth),f&&(a.height=b.maxHeight),g&&k&&(a.left=i-b.minWidth),e&&k&&(a.left=i-b.maxWidth),h&&l&&(a.top=j-b.minHeight),f&&l&&(a.top=j-b.maxHeight),a.width||a.height||a.left||!a.top?a.width||a.height||a.top||!a.left||(a.left=null):a.top=null,a},_proportionallyResize:function(){if(this._proportionallyResizeElements.length){var a,b,c,d,e,f=this.helper||this.element;for(a=0;this._proportionallyResizeElements.length>a;a++){if(e=this._proportionallyResizeElements[a],!this.borderDif)for(this.borderDif=[],c=[e.css("borderTopWidth"),e.css("borderRightWidth"),e.css("borderBottomWidth"),e.css("borderLeftWidth")],d=[e.css("paddingTop"),e.css("paddingRight"),e.css("paddingBottom"),e.css("paddingLeft")],b=0;c.length>b;b++)this.borderDif[b]=(parseInt(c[b],10)||0)+(parseInt(d[b],10)||0);e.css({height:f.height()-this.borderDif[0]-this.borderDif[2]||0,width:f.width()-this.borderDif[1]-this.borderDif[3]||0})}}},_renderProxy:function(){var b=this.element,c=this.options;this.elementOffset=b.offset(),this._helper?(this.helper=this.helper||a("<div style='overflow:hidden;'></div>"),this.helper.addClass(this._helper).css({width:this.element.outerWidth()-1,height:this.element.outerHeight()-1,position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++c.zIndex}),this.helper.appendTo("body").disableSelection()):this.helper=this.element},_change:{e:function(a,b){return{width:this.originalSize.width+b}},w:function(a,b){var c=this.originalSize,d=this.originalPosition;return{left:d.left+b,width:c.width-b}},n:function(a,b,c){var d=this.originalSize,e=this.originalPosition;return{top:e.top+c,height:d.height-c}},s:function(a,b,c){return{height:this.originalSize.height+c}},se:function(b,c,d){return a.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[b,c,d]))},sw:function(b,c,d){return a.extend(this._change.s.apply(this,arguments),this._change.w.apply(this,[b,c,d]))},ne:function(b,c,d){return a.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[b,c,d]))},nw:function(b,c,d){return a.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[b,c,d]))}},_propagate:function(b,c){a.ui.plugin.call(this,b,[c,this.ui()]),"resize"!==b&&this._trigger(b,c,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),a.ui.plugin.add("resizable","animate",{stop:function(b){var c=a(this).data("ui-resizable"),d=c.options,e=c._proportionallyResizeElements,f=e.length&&/textarea/i.test(e[0].nodeName),g=f&&a.ui.hasScroll(e[0],"left")?0:c.sizeDiff.height,h=f?0:c.sizeDiff.width,i={width:c.size.width-h,height:c.size.height-g},j=parseInt(c.element.css("left"),10)+(c.position.left-c.originalPosition.left)||null,k=parseInt(c.element.css("top"),10)+(c.position.top-c.originalPosition.top)||null;c.element.animate(a.extend(i,k&&j?{top:k,left:j}:{}),{duration:d.animateDuration,easing:d.animateEasing,step:function(){var d={width:parseInt(c.element.css("width"),10),height:parseInt(c.element.css("height"),10),top:parseInt(c.element.css("top"),10),left:parseInt(c.element.css("left"),10)};e&&e.length&&a(e[0]).css({width:d.width,height:d.height}),c._updateCache(d),c._propagate("resize",b)}})}}),a.ui.plugin.add("resizable","containment",{start:function(){var c,d,e,f,g,h,i,j=a(this).data("ui-resizable"),k=j.options,l=j.element,m=k.containment,n=m instanceof a?m.get(0):/parent/.test(m)?l.parent().get(0):m;n&&(j.containerElement=a(n),/document/.test(m)||m===document?(j.containerOffset={left:0,top:0},j.containerPosition={left:0,top:0},j.parentData={element:a(document),left:0,top:0,width:a(document).width(),height:a(document).height()||document.body.parentNode.scrollHeight}):(c=a(n),d=[],a(["Top","Right","Left","Bottom"]).each(function(a,e){d[a]=b(c.css("padding"+e))}),j.containerOffset=c.offset(),j.containerPosition=c.position(),j.containerSize={height:c.innerHeight()-d[3],width:c.innerWidth()-d[1]},e=j.containerOffset,f=j.containerSize.height,g=j.containerSize.width,h=a.ui.hasScroll(n,"left")?n.scrollWidth:g,i=a.ui.hasScroll(n)?n.scrollHeight:f,j.parentData={element:n,left:e.left,top:e.top,width:h,height:i}))},resize:function(b){var c,d,e,f,g=a(this).data("ui-resizable"),h=g.options,i=g.containerOffset,j=g.position,k=g._aspectRatio||b.shiftKey,l={top:0,left:0},m=g.containerElement;m[0]!==document&&/static/.test(m.css("position"))&&(l=i),j.left<(g._helper?i.left:0)&&(g.size.width=g.size.width+(g._helper?g.position.left-i.left:g.position.left-l.left),k&&(g.size.height=g.size.width/g.aspectRatio),g.position.left=h.helper?i.left:0),j.top<(g._helper?i.top:0)&&(g.size.height=g.size.height+(g._helper?g.position.top-i.top:g.position.top),k&&(g.size.width=g.size.height*g.aspectRatio),g.position.top=g._helper?i.top:0),g.offset.left=g.parentData.left+g.position.left,g.offset.top=g.parentData.top+g.position.top,c=Math.abs((g._helper?g.offset.left-l.left:g.offset.left-l.left)+g.sizeDiff.width),d=Math.abs((g._helper?g.offset.top-l.top:g.offset.top-i.top)+g.sizeDiff.height),e=g.containerElement.get(0)===g.element.parent().get(0),f=/relative|absolute/.test(g.containerElement.css("position")),e&&f&&(c-=g.parentData.left),c+g.size.width>=g.parentData.width&&(g.size.width=g.parentData.width-c,k&&(g.size.height=g.size.width/g.aspectRatio)),
d+g.size.height>=g.parentData.height&&(g.size.height=g.parentData.height-d,k&&(g.size.width=g.size.height*g.aspectRatio))},stop:function(){var b=a(this).data("ui-resizable"),c=b.options,d=b.containerOffset,e=b.containerPosition,f=b.containerElement,g=a(b.helper),h=g.offset(),i=g.outerWidth()-b.sizeDiff.width,j=g.outerHeight()-b.sizeDiff.height;b._helper&&!c.animate&&/relative/.test(f.css("position"))&&a(this).css({left:h.left-e.left-d.left,width:i,height:j}),b._helper&&!c.animate&&/static/.test(f.css("position"))&&a(this).css({left:h.left-e.left-d.left,width:i,height:j})}}),a.ui.plugin.add("resizable","alsoResize",{start:function(){var b=a(this).data("ui-resizable"),c=b.options,d=function(b){a(b).each(function(){var b=a(this);b.data("ui-resizable-alsoresize",{width:parseInt(b.width(),10),height:parseInt(b.height(),10),left:parseInt(b.css("left"),10),top:parseInt(b.css("top"),10)})})};"object"!=typeof c.alsoResize||c.alsoResize.parentNode?d(c.alsoResize):c.alsoResize.length?(c.alsoResize=c.alsoResize[0],d(c.alsoResize)):a.each(c.alsoResize,function(a){d(a)})},resize:function(b,c){var d=a(this).data("ui-resizable"),e=d.options,f=d.originalSize,g=d.originalPosition,h={height:d.size.height-f.height||0,width:d.size.width-f.width||0,top:d.position.top-g.top||0,left:d.position.left-g.left||0},i=function(b,d){a(b).each(function(){var b=a(this),e=a(this).data("ui-resizable-alsoresize"),f={},g=d&&d.length?d:b.parents(c.originalElement[0]).length?["width","height"]:["width","height","top","left"];a.each(g,function(a,b){var c=(e[b]||0)+(h[b]||0);c&&c>=0&&(f[b]=c||null)}),b.css(f)})};"object"!=typeof e.alsoResize||e.alsoResize.nodeType?i(e.alsoResize):a.each(e.alsoResize,function(a,b){i(a,b)})},stop:function(){a(this).removeData("resizable-alsoresize")}}),a.ui.plugin.add("resizable","ghost",{start:function(){var b=a(this).data("ui-resizable"),c=b.options,d=b.size;b.ghost=b.originalElement.clone(),b.ghost.css({opacity:.25,display:"block",position:"relative",height:d.height,width:d.width,margin:0,left:0,top:0}).addClass("ui-resizable-ghost").addClass("string"==typeof c.ghost?c.ghost:""),b.ghost.appendTo(b.helper)},resize:function(){var b=a(this).data("ui-resizable");b.ghost&&b.ghost.css({position:"relative",height:b.size.height,width:b.size.width})},stop:function(){var b=a(this).data("ui-resizable");b.ghost&&b.helper&&b.helper.get(0).removeChild(b.ghost.get(0))}}),a.ui.plugin.add("resizable","grid",{resize:function(){var b=a(this).data("ui-resizable"),c=b.options,d=b.size,e=b.originalSize,f=b.originalPosition,g=b.axis,h="number"==typeof c.grid?[c.grid,c.grid]:c.grid,i=h[0]||1,j=h[1]||1,k=Math.round((d.width-e.width)/i)*i,l=Math.round((d.height-e.height)/j)*j,m=e.width+k,n=e.height+l,o=c.maxWidth&&m>c.maxWidth,p=c.maxHeight&&n>c.maxHeight,q=c.minWidth&&c.minWidth>m,r=c.minHeight&&c.minHeight>n;c.grid=h,q&&(m+=i),r&&(n+=j),o&&(m-=i),p&&(n-=j),/^(se|s|e)$/.test(g)?(b.size.width=m,b.size.height=n):/^(ne)$/.test(g)?(b.size.width=m,b.size.height=n,b.position.top=f.top-l):/^(sw)$/.test(g)?(b.size.width=m,b.size.height=n,b.position.left=f.left-k):(b.size.width=m,b.size.height=n,b.position.top=f.top-l,b.position.left=f.left-k)}})}(jQuery),function(a){a.widget("ui.selectable",a.ui.mouse,{version:"1.10.3",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var b,c=this;this.element.addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){b=a(c.options.filter,c.element[0]),b.addClass("ui-selectee"),b.each(function(){var b=a(this),c=b.offset();a.data(this,"selectable-item",{element:this,$element:b,left:c.left,top:c.top,right:c.left+b.outerWidth(),bottom:c.top+b.outerHeight(),startselected:!1,selected:b.hasClass("ui-selected"),selecting:b.hasClass("ui-selecting"),unselecting:b.hasClass("ui-unselecting")})})},this.refresh(),this.selectees=b.addClass("ui-selectee"),this._mouseInit(),this.helper=a("<div class='ui-selectable-helper'></div>")},_destroy:function(){this.selectees.removeClass("ui-selectee").removeData("selectable-item"),this.element.removeClass("ui-selectable ui-selectable-disabled"),this._mouseDestroy()},_mouseStart:function(b){var c=this,d=this.options;this.opos=[b.pageX,b.pageY],this.options.disabled||(this.selectees=a(d.filter,this.element[0]),this._trigger("start",b),a(d.appendTo).append(this.helper),this.helper.css({left:b.pageX,top:b.pageY,width:0,height:0}),d.autoRefresh&&this.refresh(),this.selectees.filter(".ui-selected").each(function(){var d=a.data(this,"selectable-item");d.startselected=!0,b.metaKey||b.ctrlKey||(d.$element.removeClass("ui-selected"),d.selected=!1,d.$element.addClass("ui-unselecting"),d.unselecting=!0,c._trigger("unselecting",b,{unselecting:d.element}))}),a(b.target).parents().addBack().each(function(){var d,e=a.data(this,"selectable-item");return e?(d=!b.metaKey&&!b.ctrlKey||!e.$element.hasClass("ui-selected"),e.$element.removeClass(d?"ui-unselecting":"ui-selected").addClass(d?"ui-selecting":"ui-unselecting"),e.unselecting=!d,e.selecting=d,e.selected=d,d?c._trigger("selecting",b,{selecting:e.element}):c._trigger("unselecting",b,{unselecting:e.element}),!1):void 0}))},_mouseDrag:function(b){if(this.dragged=!0,!this.options.disabled){var c,d=this,e=this.options,f=this.opos[0],g=this.opos[1],h=b.pageX,i=b.pageY;return f>h&&(c=h,h=f,f=c),g>i&&(c=i,i=g,g=c),this.helper.css({left:f,top:g,width:h-f,height:i-g}),this.selectees.each(function(){var c=a.data(this,"selectable-item"),j=!1;c&&c.element!==d.element[0]&&("touch"===e.tolerance?j=!(c.left>h||f>c.right||c.top>i||g>c.bottom):"fit"===e.tolerance&&(j=c.left>f&&h>c.right&&c.top>g&&i>c.bottom),j?(c.selected&&(c.$element.removeClass("ui-selected"),c.selected=!1),c.unselecting&&(c.$element.removeClass("ui-unselecting"),c.unselecting=!1),c.selecting||(c.$element.addClass("ui-selecting"),c.selecting=!0,d._trigger("selecting",b,{selecting:c.element}))):(c.selecting&&((b.metaKey||b.ctrlKey)&&c.startselected?(c.$element.removeClass("ui-selecting"),c.selecting=!1,c.$element.addClass("ui-selected"),c.selected=!0):(c.$element.removeClass("ui-selecting"),c.selecting=!1,c.startselected&&(c.$element.addClass("ui-unselecting"),c.unselecting=!0),d._trigger("unselecting",b,{unselecting:c.element}))),c.selected&&(b.metaKey||b.ctrlKey||c.startselected||(c.$element.removeClass("ui-selected"),c.selected=!1,c.$element.addClass("ui-unselecting"),c.unselecting=!0,d._trigger("unselecting",b,{unselecting:c.element})))))}),!1}},_mouseStop:function(b){var c=this;return this.dragged=!1,a(".ui-unselecting",this.element[0]).each(function(){var d=a.data(this,"selectable-item");d.$element.removeClass("ui-unselecting"),d.unselecting=!1,d.startselected=!1,c._trigger("unselected",b,{unselected:d.element})}),a(".ui-selecting",this.element[0]).each(function(){var d=a.data(this,"selectable-item");d.$element.removeClass("ui-selecting").addClass("ui-selected"),d.selecting=!1,d.selected=!0,d.startselected=!0,c._trigger("selected",b,{selected:d.element})}),this._trigger("stop",b),this.helper.remove(),!1}})}(jQuery),function(a){function b(a,b,c){return a>b&&b+c>a}function c(a){return/left|right/.test(a.css("float"))||/inline|table-cell/.test(a.css("display"))}a.widget("ui.sortable",a.ui.mouse,{version:"1.10.3",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_create:function(){var a=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?"x"===a.axis||c(this.items[0].item):!1,this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var a=this.items.length-1;a>=0;a--)this.items[a].item.removeData(this.widgetName+"-item");return this},_setOption:function(b,c){"disabled"===b?(this.options[b]=c,this.widget().toggleClass("ui-sortable-disabled",!!c)):a.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(b,c){var d=null,e=!1,f=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(b),a(b.target).parents().each(function(){return a.data(this,f.widgetName+"-item")===f?(d=a(this),!1):void 0}),a.data(b.target,f.widgetName+"-item")===f&&(d=a(b.target)),d&&(!this.options.handle||c||(a(this.options.handle,d).find("*").addBack().each(function(){this===b.target&&(e=!0)}),e))?(this.currentItem=d,this._removeCurrentsFromItems(),!0):!1)},_mouseStart:function(b,c,d){var e,f,g=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(b),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(b),this.originalPageX=b.pageX,this.originalPageY=b.pageY,g.cursorAt&&this._adjustOffsetFromHelper(g.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),g.containment&&this._setContainment(),g.cursor&&"auto"!==g.cursor&&(f=this.document.find("body"),this.storedCursor=f.css("cursor"),f.css("cursor",g.cursor),this.storedStylesheet=a("<style>*{ cursor: "+g.cursor+" !important; }</style>").appendTo(f)),g.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",g.opacity)),g.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",g.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",b,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!d)for(e=this.containers.length-1;e>=0;e--)this.containers[e]._trigger("activate",b,this._uiHash(this));return a.ui.ddmanager&&(a.ui.ddmanager.current=this),a.ui.ddmanager&&!g.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(b),!0},_mouseDrag:function(b){var c,d,e,f,g=this.options,h=!1;for(this.position=this._generatePosition(b),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-b.pageY<g.scrollSensitivity?this.scrollParent[0].scrollTop=h=this.scrollParent[0].scrollTop+g.scrollSpeed:b.pageY-this.overflowOffset.top<g.scrollSensitivity&&(this.scrollParent[0].scrollTop=h=this.scrollParent[0].scrollTop-g.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-b.pageX<g.scrollSensitivity?this.scrollParent[0].scrollLeft=h=this.scrollParent[0].scrollLeft+g.scrollSpeed:b.pageX-this.overflowOffset.left<g.scrollSensitivity&&(this.scrollParent[0].scrollLeft=h=this.scrollParent[0].scrollLeft-g.scrollSpeed)):(b.pageY-a(document).scrollTop()<g.scrollSensitivity?h=a(document).scrollTop(a(document).scrollTop()-g.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<g.scrollSensitivity&&(h=a(document).scrollTop(a(document).scrollTop()+g.scrollSpeed)),b.pageX-a(document).scrollLeft()<g.scrollSensitivity?h=a(document).scrollLeft(a(document).scrollLeft()-g.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<g.scrollSensitivity&&(h=a(document).scrollLeft(a(document).scrollLeft()+g.scrollSpeed))),h!==!1&&a.ui.ddmanager&&!g.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),c=this.items.length-1;c>=0;c--)if(d=this.items[c],e=d.item[0],f=this._intersectsWithPointer(d),f&&d.instance===this.currentContainer&&e!==this.currentItem[0]&&this.placeholder[1===f?"next":"prev"]()[0]!==e&&!a.contains(this.placeholder[0],e)&&("semi-dynamic"===this.options.type?!a.contains(this.element[0],e):!0)){if(this.direction=1===f?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(d))break;this._rearrange(b,d),this._trigger("change",b,this._uiHash());break}return this._contactContainers(b),a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),this._trigger("sort",b,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(b,c){if(b){if(a.ui.ddmanager&&!this.options.dropBehaviour&&a.ui.ddmanager.drop(this,b),this.options.revert){var d=this,e=this.placeholder.offset(),f=this.options.axis,g={};f&&"x"!==f||(g.left=e.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),f&&"y"!==f||(g.top=e.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,a(this.helper).animate(g,parseInt(this.options.revert,10)||500,function(){d._clear(b)})}else this._clear(b,c);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var b=this.containers.length-1;b>=0;b--)this.containers[b]._trigger("deactivate",null,this._uiHash(this)),this.containers[b].containerCache.over&&(this.containers[b]._trigger("out",null,this._uiHash(this)),this.containers[b].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),a.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?a(this.domPosition.prev).after(this.currentItem):a(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(b){var c=this._getItemsAsjQuery(b&&b.connected),d=[];return b=b||{},a(c).each(function(){var c=(a(b.item||this).attr(b.attribute||"id")||"").match(b.expression||/(.+)[\-=_](.+)/);c&&d.push((b.key||c[1]+"[]")+"="+(b.key&&b.expression?c[1]:c[2]))}),!d.length&&b.key&&d.push(b.key+"="),d.join("&")},toArray:function(b){var c=this._getItemsAsjQuery(b&&b.connected),d=[];return b=b||{},c.each(function(){d.push(a(b.item||this).attr(b.attribute||"id")||"")}),d},_intersectsWith:function(a){var b=this.positionAbs.left,c=b+this.helperProportions.width,d=this.positionAbs.top,e=d+this.helperProportions.height,f=a.left,g=f+a.width,h=a.top,i=h+a.height,j=this.offset.click.top,k=this.offset.click.left,l="x"===this.options.axis||d+j>h&&i>d+j,m="y"===this.options.axis||b+k>f&&g>b+k,n=l&&m;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>a[this.floating?"width":"height"]?n:b+this.helperProportions.width/2>f&&g>c-this.helperProportions.width/2&&d+this.helperProportions.height/2>h&&i>e-this.helperProportions.height/2},_intersectsWithPointer:function(a){var c="x"===this.options.axis||b(this.positionAbs.top+this.offset.click.top,a.top,a.height),d="y"===this.options.axis||b(this.positionAbs.left+this.offset.click.left,a.left,a.width),e=c&&d,f=this._getDragVerticalDirection(),g=this._getDragHorizontalDirection();return e?this.floating?g&&"right"===g||"down"===f?2:1:f&&("down"===f?2:1):!1},_intersectsWithSides:function(a){var c=b(this.positionAbs.top+this.offset.click.top,a.top+a.height/2,a.height),d=b(this.positionAbs.left+this.offset.click.left,a.left+a.width/2,a.width),e=this._getDragVerticalDirection(),f=this._getDragHorizontalDirection();return this.floating&&f?"right"===f&&d||"left"===f&&!d:e&&("down"===e&&c||"up"===e&&!c)},_getDragVerticalDirection:function(){var a=this.positionAbs.top-this.lastPositionAbs.top;return 0!==a&&(a>0?"down":"up")},_getDragHorizontalDirection:function(){var a=this.positionAbs.left-this.lastPositionAbs.left;return 0!==a&&(a>0?"right":"left")},refresh:function(a){return this._refreshItems(a),this.refreshPositions(),this},_connectWith:function(){var a=this.options;return a.connectWith.constructor===String?[a.connectWith]:a.connectWith},_getItemsAsjQuery:function(b){var c,d,e,f,g=[],h=[],i=this._connectWith();if(i&&b)for(c=i.length-1;c>=0;c--)for(e=a(i[c]),d=e.length-1;d>=0;d--)f=a.data(e[d],this.widgetFullName),f&&f!==this&&!f.options.disabled&&h.push([a.isFunction(f.options.items)?f.options.items.call(f.element):a(f.options.items,f.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),f]);for(h.push([a.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):a(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),c=h.length-1;c>=0;c--)h[c][0].each(function(){g.push(this)});return a(g)},_removeCurrentsFromItems:function(){var b=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=a.grep(this.items,function(a){for(var c=0;b.length>c;c++)if(b[c]===a.item[0])return!1;return!0})},_refreshItems:function(b){this.items=[],this.containers=[this];var c,d,e,f,g,h,i,j,k=this.items,l=[[a.isFunction(this.options.items)?this.options.items.call(this.element[0],b,{item:this.currentItem}):a(this.options.items,this.element),this]],m=this._connectWith();if(m&&this.ready)for(c=m.length-1;c>=0;c--)for(e=a(m[c]),d=e.length-1;d>=0;d--)f=a.data(e[d],this.widgetFullName),f&&f!==this&&!f.options.disabled&&(l.push([a.isFunction(f.options.items)?f.options.items.call(f.element[0],b,{item:this.currentItem}):a(f.options.items,f.element),f]),this.containers.push(f));for(c=l.length-1;c>=0;c--)for(g=l[c][1],h=l[c][0],d=0,j=h.length;j>d;d++)i=a(h[d]),i.data(this.widgetName+"-item",g),k.push({item:i,instance:g,width:0,height:0,left:0,top:0})},refreshPositions:function(b){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var c,d,e,f;for(c=this.items.length-1;c>=0;c--)d=this.items[c],d.instance!==this.currentContainer&&this.currentContainer&&d.item[0]!==this.currentItem[0]||(e=this.options.toleranceElement?a(this.options.toleranceElement,d.item):d.item,b||(d.width=e.outerWidth(),d.height=e.outerHeight()),f=e.offset(),d.left=f.left,d.top=f.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(c=this.containers.length-1;c>=0;c--)f=this.containers[c].element.offset(),this.containers[c].containerCache.left=f.left,this.containers[c].containerCache.top=f.top,this.containers[c].containerCache.width=this.containers[c].element.outerWidth(),this.containers[c].containerCache.height=this.containers[c].element.outerHeight();return this},_createPlaceholder:function(b){b=b||this;var c,d=b.options;d.placeholder&&d.placeholder.constructor!==String||(c=d.placeholder,d.placeholder={element:function(){var d=b.currentItem[0].nodeName.toLowerCase(),e=a("<"+d+">",b.document[0]).addClass(c||b.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===d?b.currentItem.children().each(function(){a("<td>&#160;</td>",b.document[0]).attr("colspan",a(this).attr("colspan")||1).appendTo(e)}):"img"===d&&e.attr("src",b.currentItem.attr("src")),c||e.css("visibility","hidden"),e},update:function(a,e){(!c||d.forcePlaceholderSize)&&(e.height()||e.height(b.currentItem.innerHeight()-parseInt(b.currentItem.css("paddingTop")||0,10)-parseInt(b.currentItem.css("paddingBottom")||0,10)),e.width()||e.width(b.currentItem.innerWidth()-parseInt(b.currentItem.css("paddingLeft")||0,10)-parseInt(b.currentItem.css("paddingRight")||0,10)))}}),b.placeholder=a(d.placeholder.element.call(b.element,b.currentItem)),b.currentItem.after(b.placeholder),d.placeholder.update(b,b.placeholder)},_contactContainers:function(d){var e,f,g,h,i,j,k,l,m,n,o=null,p=null;for(e=this.containers.length-1;e>=0;e--)if(!a.contains(this.currentItem[0],this.containers[e].element[0]))if(this._intersectsWith(this.containers[e].containerCache)){if(o&&a.contains(this.containers[e].element[0],o.element[0]))continue;o=this.containers[e],p=e}else this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",d,this._uiHash(this)),this.containers[e].containerCache.over=0);if(o)if(1===this.containers.length)this.containers[p].containerCache.over||(this.containers[p]._trigger("over",d,this._uiHash(this)),this.containers[p].containerCache.over=1);else{for(g=1e4,h=null,n=o.floating||c(this.currentItem),i=n?"left":"top",j=n?"width":"height",k=this.positionAbs[i]+this.offset.click[i],f=this.items.length-1;f>=0;f--)a.contains(this.containers[p].element[0],this.items[f].item[0])&&this.items[f].item[0]!==this.currentItem[0]&&(!n||b(this.positionAbs.top+this.offset.click.top,this.items[f].top,this.items[f].height))&&(l=this.items[f].item.offset()[i],m=!1,Math.abs(l-k)>Math.abs(l+this.items[f][j]-k)&&(m=!0,l+=this.items[f][j]),g>Math.abs(l-k)&&(g=Math.abs(l-k),h=this.items[f],this.direction=m?"up":"down"));if(!h&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[p])return;h?this._rearrange(d,h,null,!0):this._rearrange(d,null,this.containers[p].element,!0),this._trigger("change",d,this._uiHash()),this.containers[p]._trigger("change",d,this._uiHash(this)),this.currentContainer=this.containers[p],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[p]._trigger("over",d,this._uiHash(this)),this.containers[p].containerCache.over=1}},_createHelper:function(b){var c=this.options,d=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[b,this.currentItem])):"clone"===c.helper?this.currentItem.clone():this.currentItem;return d.parents("body").length||a("parent"!==c.appendTo?c.appendTo:this.currentItem[0].parentNode)[0].appendChild(d[0]),d[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!d[0].style.width||c.forceHelperSize)&&d.width(this.currentItem.width()),(!d[0].style.height||c.forceHelperSize)&&d.height(this.currentItem.height()),d},_adjustOffsetFromHelper:function(b){"string"==typeof b&&(b=b.split(" ")),a.isArray(b)&&(b={left:+b[0],top:+b[1]||0}),"left"in b&&(this.offset.click.left=b.left+this.margins.left),"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left),"top"in b&&(this.offset.click.top=b.top+this.margins.top),"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&a.ui.ie)&&(b={top:0,left:0}),{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var a=this.currentItem.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b,c,d,e=this.options;"parent"===e.containment&&(e.containment=this.helper[0].parentNode),("document"===e.containment||"window"===e.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,a("document"===e.containment?document:window).width()-this.helperProportions.width-this.margins.left,(a("document"===e.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(e.containment)||(b=a(e.containment)[0],c=a(e.containment).offset(),d="hidden"!==a(b).css("overflow"),this.containment=[c.left+(parseInt(a(b).css("borderLeftWidth"),10)||0)+(parseInt(a(b).css("paddingLeft"),10)||0)-this.margins.left,c.top+(parseInt(a(b).css("borderTopWidth"),10)||0)+(parseInt(a(b).css("paddingTop"),10)||0)-this.margins.top,c.left+(d?Math.max(b.scrollWidth,b.offsetWidth):b.offsetWidth)-(parseInt(a(b).css("borderLeftWidth"),10)||0)-(parseInt(a(b).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,c.top+(d?Math.max(b.scrollHeight,b.offsetHeight):b.offsetHeight)-(parseInt(a(b).css("borderTopWidth"),10)||0)-(parseInt(a(b).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(b,c){c||(c=this.position);var d="absolute"===b?1:-1,e="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,f=/(html|body)/i.test(e[0].tagName);return{top:c.top+this.offset.relative.top*d+this.offset.parent.top*d-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():f?0:e.scrollTop())*d,left:c.left+this.offset.relative.left*d+this.offset.parent.left*d-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():f?0:e.scrollLeft())*d}},_generatePosition:function(b){var c,d,e=this.options,f=b.pageX,g=b.pageY,h="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,i=/(html|body)/i.test(h[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(b.pageX-this.offset.click.left<this.containment[0]&&(f=this.containment[0]+this.offset.click.left),b.pageY-this.offset.click.top<this.containment[1]&&(g=this.containment[1]+this.offset.click.top),b.pageX-this.offset.click.left>this.containment[2]&&(f=this.containment[2]+this.offset.click.left),b.pageY-this.offset.click.top>this.containment[3]&&(g=this.containment[3]+this.offset.click.top)),e.grid&&(c=this.originalPageY+Math.round((g-this.originalPageY)/e.grid[1])*e.grid[1],g=this.containment?c-this.offset.click.top>=this.containment[1]&&c-this.offset.click.top<=this.containment[3]?c:c-this.offset.click.top>=this.containment[1]?c-e.grid[1]:c+e.grid[1]:c,d=this.originalPageX+Math.round((f-this.originalPageX)/e.grid[0])*e.grid[0],f=this.containment?d-this.offset.click.left>=this.containment[0]&&d-this.offset.click.left<=this.containment[2]?d:d-this.offset.click.left>=this.containment[0]?d-e.grid[0]:d+e.grid[0]:d)),{top:g-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():i?0:h.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():i?0:h.scrollLeft())}},_rearrange:function(a,b,c,d){c?c[0].appendChild(this.placeholder[0]):b.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?b.item[0]:b.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var e=this.counter;this._delay(function(){e===this.counter&&this.refreshPositions(!d)})},_clear:function(a,b){this.reverting=!1;var c,d=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(c in this._storedCSS)("auto"===this._storedCSS[c]||"static"===this._storedCSS[c])&&(this._storedCSS[c]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!b&&d.push(function(a){this._trigger("receive",a,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||b||d.push(function(a){this._trigger("update",a,this._uiHash())}),this!==this.currentContainer&&(b||(d.push(function(a){this._trigger("remove",a,this._uiHash())}),d.push(function(a){return function(b){a._trigger("receive",b,this._uiHash(this))}}.call(this,this.currentContainer)),d.push(function(a){return function(b){a._trigger("update",b,this._uiHash(this))}}.call(this,this.currentContainer)))),c=this.containers.length-1;c>=0;c--)b||d.push(function(a){return function(b){a._trigger("deactivate",b,this._uiHash(this))}}.call(this,this.containers[c])),this.containers[c].containerCache.over&&(d.push(function(a){return function(b){a._trigger("out",b,this._uiHash(this))}}.call(this,this.containers[c])),this.containers[c].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!b){for(this._trigger("beforeStop",a,this._uiHash()),c=0;d.length>c;c++)d[c].call(this,a);this._trigger("stop",a,this._uiHash())}return this.fromOutside=!1,!1}if(b||this._trigger("beforeStop",a,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null,!b){for(c=0;d.length>c;c++)d[c].call(this,a);this._trigger("stop",a,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){a.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(b){var c=b||this;return{helper:c.helper,placeholder:c.placeholder||a([]),position:c.position,originalPosition:c.originalPosition,offset:c.positionAbs,item:c.currentItem,sender:b?b.element:null}}})}(jQuery),function(a,b){var c="ui-effects-";a.effects={effect:{}},function(a,b){function c(a,b,c){var d=l[b.type]||{};return null==a?c||!b.def?null:b.def:(a=d.floor?~~a:parseFloat(a),isNaN(a)?b.def:d.mod?(a+d.mod)%d.mod:0>a?0:a>d.max?d.max:a)}function d(c){var d=j(),e=d._rgba=[];return c=c.toLowerCase(),o(i,function(a,f){var g,h=f.re.exec(c),i=h&&f.parse(h),j=f.space||"rgba";return i?(g=d[j](i),d[k[j].cache]=g[k[j].cache],e=d._rgba=g._rgba,!1):b}),e.length?("0,0,0,0"===e.join()&&a.extend(e,f.transparent),d):f[c]}function e(a,b,c){return c=(c+1)%1,1>6*c?a+6*(b-a)*c:1>2*c?b:2>3*c?a+6*(b-a)*(2/3-c):a}var f,g="backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor",h=/^([\-+])=\s*(\d+\.?\d*)/,i=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,
parse:function(a){return[a[1],a[2],a[3],a[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(a){return[2.55*a[1],2.55*a[2],2.55*a[3],a[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(a){return[a[1],a[2]/100,a[3]/100,a[4]]}}],j=a.Color=function(b,c,d,e){return new a.Color.fn.parse(b,c,d,e)},k={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},l={"byte":{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},m=j.support={},n=a("<p>")[0],o=a.each;n.style.cssText="background-color:rgba(1,1,1,.5)",m.rgba=n.style.backgroundColor.indexOf("rgba")>-1,o(k,function(a,b){b.cache="_"+a,b.props.alpha={idx:3,type:"percent",def:1}}),j.fn=a.extend(j.prototype,{parse:function(e,g,h,i){if(e===b)return this._rgba=[null,null,null,null],this;(e.jquery||e.nodeType)&&(e=a(e).css(g),g=b);var l=this,m=a.type(e),n=this._rgba=[];return g!==b&&(e=[e,g,h,i],m="array"),"string"===m?this.parse(d(e)||f._default):"array"===m?(o(k.rgba.props,function(a,b){n[b.idx]=c(e[b.idx],b)}),this):"object"===m?(e instanceof j?o(k,function(a,b){e[b.cache]&&(l[b.cache]=e[b.cache].slice())}):o(k,function(b,d){var f=d.cache;o(d.props,function(a,b){if(!l[f]&&d.to){if("alpha"===a||null==e[a])return;l[f]=d.to(l._rgba)}l[f][b.idx]=c(e[a],b,!0)}),l[f]&&0>a.inArray(null,l[f].slice(0,3))&&(l[f][3]=1,d.from&&(l._rgba=d.from(l[f])))}),this):b},is:function(a){var c=j(a),d=!0,e=this;return o(k,function(a,f){var g,h=c[f.cache];return h&&(g=e[f.cache]||f.to&&f.to(e._rgba)||[],o(f.props,function(a,c){return null!=h[c.idx]?d=h[c.idx]===g[c.idx]:b})),d}),d},_space:function(){var a=[],b=this;return o(k,function(c,d){b[d.cache]&&a.push(c)}),a.pop()},transition:function(a,b){var d=j(a),e=d._space(),f=k[e],g=0===this.alpha()?j("transparent"):this,h=g[f.cache]||f.to(g._rgba),i=h.slice();return d=d[f.cache],o(f.props,function(a,e){var f=e.idx,g=h[f],j=d[f],k=l[e.type]||{};null!==j&&(null===g?i[f]=j:(k.mod&&(j-g>k.mod/2?g+=k.mod:g-j>k.mod/2&&(g-=k.mod)),i[f]=c((j-g)*b+g,e)))}),this[e](i)},blend:function(b){if(1===this._rgba[3])return this;var c=this._rgba.slice(),d=c.pop(),e=j(b)._rgba;return j(a.map(c,function(a,b){return(1-d)*e[b]+d*a}))},toRgbaString:function(){var b="rgba(",c=a.map(this._rgba,function(a,b){return null==a?b>2?1:0:a});return 1===c[3]&&(c.pop(),b="rgb("),b+c.join()+")"},toHslaString:function(){var b="hsla(",c=a.map(this.hsla(),function(a,b){return null==a&&(a=b>2?1:0),b&&3>b&&(a=Math.round(100*a)+"%"),a});return 1===c[3]&&(c.pop(),b="hsl("),b+c.join()+")"},toHexString:function(b){var c=this._rgba.slice(),d=c.pop();return b&&c.push(~~(255*d)),"#"+a.map(c,function(a){return a=(a||0).toString(16),1===a.length?"0"+a:a}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),j.fn.parse.prototype=j.fn,k.hsla.to=function(a){if(null==a[0]||null==a[1]||null==a[2])return[null,null,null,a[3]];var b,c,d=a[0]/255,e=a[1]/255,f=a[2]/255,g=a[3],h=Math.max(d,e,f),i=Math.min(d,e,f),j=h-i,k=h+i,l=.5*k;return b=i===h?0:d===h?60*(e-f)/j+360:e===h?60*(f-d)/j+120:60*(d-e)/j+240,c=0===j?0:.5>=l?j/k:j/(2-k),[Math.round(b)%360,c,l,null==g?1:g]},k.hsla.from=function(a){if(null==a[0]||null==a[1]||null==a[2])return[null,null,null,a[3]];var b=a[0]/360,c=a[1],d=a[2],f=a[3],g=.5>=d?d*(1+c):d+c-d*c,h=2*d-g;return[Math.round(255*e(h,g,b+1/3)),Math.round(255*e(h,g,b)),Math.round(255*e(h,g,b-1/3)),f]},o(k,function(d,e){var f=e.props,g=e.cache,i=e.to,k=e.from;j.fn[d]=function(d){if(i&&!this[g]&&(this[g]=i(this._rgba)),d===b)return this[g].slice();var e,h=a.type(d),l="array"===h||"object"===h?d:arguments,m=this[g].slice();return o(f,function(a,b){var d=l["object"===h?a:b.idx];null==d&&(d=m[b.idx]),m[b.idx]=c(d,b)}),k?(e=j(k(m)),e[g]=m,e):j(m)},o(f,function(b,c){j.fn[b]||(j.fn[b]=function(e){var f,g=a.type(e),i="alpha"===b?this._hsla?"hsla":"rgba":d,j=this[i](),k=j[c.idx];return"undefined"===g?k:("function"===g&&(e=e.call(this,k),g=a.type(e)),null==e&&c.empty?this:("string"===g&&(f=h.exec(e),f&&(e=k+parseFloat(f[2])*("+"===f[1]?1:-1))),j[c.idx]=e,this[i](j)))})})}),j.hook=function(b){var c=b.split(" ");o(c,function(b,c){a.cssHooks[c]={set:function(b,e){var f,g,h="";if("transparent"!==e&&("string"!==a.type(e)||(f=d(e)))){if(e=j(f||e),!m.rgba&&1!==e._rgba[3]){for(g="backgroundColor"===c?b.parentNode:b;(""===h||"transparent"===h)&&g&&g.style;)try{h=a.css(g,"backgroundColor"),g=g.parentNode}catch(i){}e=e.blend(h&&"transparent"!==h?h:"_default")}e=e.toRgbaString()}try{b.style[c]=e}catch(i){}}},a.fx.step[c]=function(b){b.colorInit||(b.start=j(b.elem,c),b.end=j(b.end),b.colorInit=!0),a.cssHooks[c].set(b.elem,b.start.transition(b.end,b.pos))}})},j.hook(g),a.cssHooks.borderColor={expand:function(a){var b={};return o(["Top","Right","Bottom","Left"],function(c,d){b["border"+d+"Color"]=a}),b}},f=a.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery),function(){function c(b){var c,d,e=b.ownerDocument.defaultView?b.ownerDocument.defaultView.getComputedStyle(b,null):b.currentStyle,f={};if(e&&e.length&&e[0]&&e[e[0]])for(d=e.length;d--;)c=e[d],"string"==typeof e[c]&&(f[a.camelCase(c)]=e[c]);else for(c in e)"string"==typeof e[c]&&(f[c]=e[c]);return f}function d(b,c){var d,e,g={};for(d in c)e=c[d],b[d]!==e&&(f[d]||(a.fx.step[d]||!isNaN(parseFloat(e)))&&(g[d]=e));return g}var e=["add","remove","toggle"],f={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};a.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(b,c){a.fx.step[c]=function(a){("none"!==a.end&&!a.setAttr||1===a.pos&&!a.setAttr)&&(jQuery.style(a.elem,c,a.end),a.setAttr=!0)}}),a.fn.addBack||(a.fn.addBack=function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}),a.effects.animateClass=function(b,f,g,h){var i=a.speed(f,g,h);return this.queue(function(){var f,g=a(this),h=g.attr("class")||"",j=i.children?g.find("*").addBack():g;j=j.map(function(){var b=a(this);return{el:b,start:c(this)}}),f=function(){a.each(e,function(a,c){b[c]&&g[c+"Class"](b[c])})},f(),j=j.map(function(){return this.end=c(this.el[0]),this.diff=d(this.start,this.end),this}),g.attr("class",h),j=j.map(function(){var b=this,c=a.Deferred(),d=a.extend({},i,{queue:!1,complete:function(){c.resolve(b)}});return this.el.animate(this.diff,d),c.promise()}),a.when.apply(a,j.get()).done(function(){f(),a.each(arguments,function(){var b=this.el;a.each(this.diff,function(a){b.css(a,"")})}),i.complete.call(g[0])})})},a.fn.extend({addClass:function(b){return function(c,d,e,f){return d?a.effects.animateClass.call(this,{add:c},d,e,f):b.apply(this,arguments)}}(a.fn.addClass),removeClass:function(b){return function(c,d,e,f){return arguments.length>1?a.effects.animateClass.call(this,{remove:c},d,e,f):b.apply(this,arguments)}}(a.fn.removeClass),toggleClass:function(c){return function(d,e,f,g,h){return"boolean"==typeof e||e===b?f?a.effects.animateClass.call(this,e?{add:d}:{remove:d},f,g,h):c.apply(this,arguments):a.effects.animateClass.call(this,{toggle:d},e,f,g)}}(a.fn.toggleClass),switchClass:function(b,c,d,e,f){return a.effects.animateClass.call(this,{add:c,remove:b},d,e,f)}})}(),function(){function d(b,c,d,e){return a.isPlainObject(b)&&(c=b,b=b.effect),b={effect:b},null==c&&(c={}),a.isFunction(c)&&(e=c,d=null,c={}),("number"==typeof c||a.fx.speeds[c])&&(e=d,d=c,c={}),a.isFunction(d)&&(e=d,d=null),c&&a.extend(b,c),d=d||c.duration,b.duration=a.fx.off?0:"number"==typeof d?d:d in a.fx.speeds?a.fx.speeds[d]:a.fx.speeds._default,b.complete=e||c.complete,b}function e(b){return!b||"number"==typeof b||a.fx.speeds[b]?!0:"string"!=typeof b||a.effects.effect[b]?a.isFunction(b)?!0:"object"==typeof b&&!b.effect:!0}a.extend(a.effects,{version:"1.10.3",save:function(a,b){for(var d=0;b.length>d;d++)null!==b[d]&&a.data(c+b[d],a[0].style[b[d]])},restore:function(a,d){var e,f;for(f=0;d.length>f;f++)null!==d[f]&&(e=a.data(c+d[f]),e===b&&(e=""),a.css(d[f],e))},setMode:function(a,b){return"toggle"===b&&(b=a.is(":hidden")?"show":"hide"),b},getBaseline:function(a,b){var c,d;switch(a[0]){case"top":c=0;break;case"middle":c=.5;break;case"bottom":c=1;break;default:c=a[0]/b.height}switch(a[1]){case"left":d=0;break;case"center":d=.5;break;case"right":d=1;break;default:d=a[1]/b.width}return{x:d,y:c}},createWrapper:function(b){if(b.parent().is(".ui-effects-wrapper"))return b.parent();var c={width:b.outerWidth(!0),height:b.outerHeight(!0),"float":b.css("float")},d=a("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),e={width:b.width(),height:b.height()},f=document.activeElement;try{f.id}catch(g){f=document.body}return b.wrap(d),(b[0]===f||a.contains(b[0],f))&&a(f).focus(),d=b.parent(),"static"===b.css("position")?(d.css({position:"relative"}),b.css({position:"relative"})):(a.extend(c,{position:b.css("position"),zIndex:b.css("z-index")}),a.each(["top","left","bottom","right"],function(a,d){c[d]=b.css(d),isNaN(parseInt(c[d],10))&&(c[d]="auto")}),b.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),b.css(e),d.css(c).show()},removeWrapper:function(b){var c=document.activeElement;return b.parent().is(".ui-effects-wrapper")&&(b.parent().replaceWith(b),(b[0]===c||a.contains(b[0],c))&&a(c).focus()),b},setTransition:function(b,c,d,e){return e=e||{},a.each(c,function(a,c){var f=b.cssUnit(c);f[0]>0&&(e[c]=f[0]*d+f[1])}),e}}),a.fn.extend({effect:function(){function b(b){function d(){a.isFunction(f)&&f.call(e[0]),a.isFunction(b)&&b()}var e=a(this),f=c.complete,h=c.mode;(e.is(":hidden")?"hide"===h:"show"===h)?(e[h](),d()):g.call(e[0],c,d)}var c=d.apply(this,arguments),e=c.mode,f=c.queue,g=a.effects.effect[c.effect];return a.fx.off||!g?e?this[e](c.duration,c.complete):this.each(function(){c.complete&&c.complete.call(this)}):f===!1?this.each(b):this.queue(f||"fx",b)},show:function(a){return function(b){if(e(b))return a.apply(this,arguments);var c=d.apply(this,arguments);return c.mode="show",this.effect.call(this,c)}}(a.fn.show),hide:function(a){return function(b){if(e(b))return a.apply(this,arguments);var c=d.apply(this,arguments);return c.mode="hide",this.effect.call(this,c)}}(a.fn.hide),toggle:function(a){return function(b){if(e(b)||"boolean"==typeof b)return a.apply(this,arguments);var c=d.apply(this,arguments);return c.mode="toggle",this.effect.call(this,c)}}(a.fn.toggle),cssUnit:function(b){var c=this.css(b),d=[];return a.each(["em","px","%","pt"],function(a,b){c.indexOf(b)>0&&(d=[parseFloat(c),b])}),d}})}(),function(){var b={};a.each(["Quad","Cubic","Quart","Quint","Expo"],function(a,c){b[c]=function(b){return Math.pow(b,a+2)}}),a.extend(b,{Sine:function(a){return 1-Math.cos(a*Math.PI/2)},Circ:function(a){return 1-Math.sqrt(1-a*a)},Elastic:function(a){return 0===a||1===a?a:-Math.pow(2,8*(a-1))*Math.sin((80*(a-1)-7.5)*Math.PI/15)},Back:function(a){return a*a*(3*a-2)},Bounce:function(a){for(var b,c=4;((b=Math.pow(2,--c))-1)/11>a;);return 1/Math.pow(4,3-c)-7.5625*Math.pow((3*b-2)/22-a,2)}}),a.each(b,function(b,c){a.easing["easeIn"+b]=c,a.easing["easeOut"+b]=function(a){return 1-c(1-a)},a.easing["easeInOut"+b]=function(a){return.5>a?c(2*a)/2:1-c(-2*a+2)/2}})}()}(jQuery),function(a){var b=0,c={},d={};c.height=c.paddingTop=c.paddingBottom=c.borderTopWidth=c.borderBottomWidth="hide",d.height=d.paddingTop=d.paddingBottom=d.borderTopWidth=d.borderBottomWidth="show",a.widget("ui.accordion",{version:"1.10.3",options:{active:0,animate:{},collapsible:!1,event:"click",header:"> li > :first-child,> :not(li):even",heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},_create:function(){var b=this.options;this.prevShow=this.prevHide=a(),this.element.addClass("ui-accordion ui-widget ui-helper-reset").attr("role","tablist"),b.collapsible||b.active!==!1&&null!=b.active||(b.active=0),this._processPanels(),0>b.active&&(b.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():a(),content:this.active.length?this.active.next():a()}},_createIcons:function(){var b=this.options.icons;b&&(a("<span>").addClass("ui-accordion-header-icon ui-icon "+b.header).prependTo(this.headers),this.active.children(".ui-accordion-header-icon").removeClass(b.header).addClass(b.activeHeader),this.headers.addClass("ui-accordion-icons"))},_destroyIcons:function(){this.headers.removeClass("ui-accordion-icons").children(".ui-accordion-header-icon").remove()},_destroy:function(){var a;this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"),this.headers.removeClass("ui-accordion-header ui-accordion-header-active ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-selected").removeAttr("aria-controls").removeAttr("tabIndex").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),this._destroyIcons(),a=this.headers.next().css("display","").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-labelledby").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-state-disabled").each(function(){/^ui-accordion/.test(this.id)&&this.removeAttribute("id")}),"content"!==this.options.heightStyle&&a.css("height","")},_setOption:function(a,b){return"active"===a?void this._activate(b):("event"===a&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(b)),this._super(a,b),"collapsible"!==a||b||this.options.active!==!1||this._activate(0),"icons"===a&&(this._destroyIcons(),b&&this._createIcons()),void("disabled"===a&&this.headers.add(this.headers.next()).toggleClass("ui-state-disabled",!!b)))},_keydown:function(b){if(!b.altKey&&!b.ctrlKey){var c=a.ui.keyCode,d=this.headers.length,e=this.headers.index(b.target),f=!1;switch(b.keyCode){case c.RIGHT:case c.DOWN:f=this.headers[(e+1)%d];break;case c.LEFT:case c.UP:f=this.headers[(e-1+d)%d];break;case c.SPACE:case c.ENTER:this._eventHandler(b);break;case c.HOME:f=this.headers[0];break;case c.END:f=this.headers[d-1]}f&&(a(b.target).attr("tabIndex",-1),a(f).attr("tabIndex",0),f.focus(),b.preventDefault())}},_panelKeyDown:function(b){b.keyCode===a.ui.keyCode.UP&&b.ctrlKey&&a(b.currentTarget).prev().focus()},refresh:function(){var b=this.options;this._processPanels(),b.active===!1&&b.collapsible===!0||!this.headers.length?(b.active=!1,this.active=a()):b.active===!1?this._activate(0):this.active.length&&!a.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(b.active=!1,this.active=a()):this._activate(Math.max(0,b.active-1)):b.active=this.headers.index(this.active),this._destroyIcons(),this._refresh()},_processPanels:function(){this.headers=this.element.find(this.options.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all"),this.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").filter(":not(.ui-accordion-content-active)").hide()},_refresh:function(){var c,d=this.options,e=d.heightStyle,f=this.element.parent(),g=this.accordionId="ui-accordion-"+(this.element.attr("id")||++b);this.active=this._findActive(d.active).addClass("ui-accordion-header-active ui-state-active ui-corner-top").removeClass("ui-corner-all"),this.active.next().addClass("ui-accordion-content-active").show(),this.headers.attr("role","tab").each(function(b){var c=a(this),d=c.attr("id"),e=c.next(),f=e.attr("id");d||(d=g+"-header-"+b,c.attr("id",d)),f||(f=g+"-panel-"+b,e.attr("id",f)),c.attr("aria-controls",f),e.attr("aria-labelledby",d)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false",tabIndex:-1}).next().attr({"aria-expanded":"false","aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true",tabIndex:0}).next().attr({"aria-expanded":"true","aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(d.event),"fill"===e?(c=f.height(),this.element.siblings(":visible").each(function(){var b=a(this),d=b.css("position");"absolute"!==d&&"fixed"!==d&&(c-=b.outerHeight(!0))}),this.headers.each(function(){c-=a(this).outerHeight(!0)}),this.headers.next().each(function(){a(this).height(Math.max(0,c-a(this).innerHeight()+a(this).height()))}).css("overflow","auto")):"auto"===e&&(c=0,this.headers.next().each(function(){c=Math.max(c,a(this).css("height","").height())}).height(c))},_activate:function(b){var c=this._findActive(b)[0];c!==this.active[0]&&(c=c||this.active[0],this._eventHandler({target:c,currentTarget:c,preventDefault:a.noop}))},_findActive:function(b){return"number"==typeof b?this.headers.eq(b):a()},_setupEvents:function(b){var c={keydown:"_keydown"};b&&a.each(b.split(" "),function(a,b){c[b]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,c),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(b){var c=this.options,d=this.active,e=a(b.currentTarget),f=e[0]===d[0],g=f&&c.collapsible,h=g?a():e.next(),i=d.next(),j={oldHeader:d,oldPanel:i,newHeader:g?a():e,newPanel:h};b.preventDefault(),f&&!c.collapsible||this._trigger("beforeActivate",b,j)===!1||(c.active=g?!1:this.headers.index(e),this.active=f?a():e,this._toggle(j),d.removeClass("ui-accordion-header-active ui-state-active"),c.icons&&d.children(".ui-accordion-header-icon").removeClass(c.icons.activeHeader).addClass(c.icons.header),f||(e.removeClass("ui-corner-all").addClass("ui-accordion-header-active ui-state-active ui-corner-top"),c.icons&&e.children(".ui-accordion-header-icon").removeClass(c.icons.header).addClass(c.icons.activeHeader),e.next().addClass("ui-accordion-content-active")))},_toggle:function(b){var c=b.newPanel,d=this.prevShow.length?this.prevShow:b.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=c,this.prevHide=d,this.options.animate?this._animate(c,d,b):(d.hide(),c.show(),this._toggleComplete(b)),d.attr({"aria-expanded":"false","aria-hidden":"true"}),d.prev().attr("aria-selected","false"),c.length&&d.length?d.prev().attr("tabIndex",-1):c.length&&this.headers.filter(function(){return 0===a(this).attr("tabIndex")}).attr("tabIndex",-1),c.attr({"aria-expanded":"true","aria-hidden":"false"}).prev().attr({"aria-selected":"true",tabIndex:0})},_animate:function(a,b,e){var f,g,h,i=this,j=0,k=a.length&&(!b.length||a.index()<b.index()),l=this.options.animate||{},m=k&&l.down||l,n=function(){i._toggleComplete(e)};return"number"==typeof m&&(h=m),"string"==typeof m&&(g=m),g=g||m.easing||l.easing,h=h||m.duration||l.duration,b.length?a.length?(f=a.show().outerHeight(),b.animate(c,{duration:h,easing:g,step:function(a,b){b.now=Math.round(a)}}),void a.hide().animate(d,{duration:h,easing:g,complete:n,step:function(a,c){c.now=Math.round(a),"height"!==c.prop?j+=c.now:"content"!==i.options.heightStyle&&(c.now=Math.round(f-b.outerHeight()-j),j=0)}})):b.animate(c,h,g,n):a.animate(d,h,g,n)},_toggleComplete:function(a){var b=a.oldPanel;b.removeClass("ui-accordion-content-active").prev().removeClass("ui-corner-top").addClass("ui-corner-all"),b.length&&(b.parent()[0].className=b.parent()[0].className),this._trigger("activate",null,a)}})}(jQuery),function(a){var b=0;a.widget("ui.autocomplete",{version:"1.10.3",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},pending:0,_create:function(){var b,c,d,e=this.element[0].nodeName.toLowerCase(),f="textarea"===e,g="input"===e;this.isMultiLine=f?!0:g?!1:this.element.prop("isContentEditable"),this.valueMethod=this.element[f||g?"val":"text"],this.isNewMenu=!0,this.element.addClass("ui-autocomplete-input").attr("autocomplete","off"),this._on(this.element,{keydown:function(e){if(this.element.prop("readOnly"))return b=!0,d=!0,void(c=!0);b=!1,d=!1,c=!1;var f=a.ui.keyCode;switch(e.keyCode){case f.PAGE_UP:b=!0,this._move("previousPage",e);break;case f.PAGE_DOWN:b=!0,this._move("nextPage",e);break;case f.UP:b=!0,this._keyEvent("previous",e);break;case f.DOWN:b=!0,this._keyEvent("next",e);break;case f.ENTER:case f.NUMPAD_ENTER:this.menu.active&&(b=!0,e.preventDefault(),this.menu.select(e));break;case f.TAB:this.menu.active&&this.menu.select(e);break;case f.ESCAPE:this.menu.element.is(":visible")&&(this._value(this.term),this.close(e),e.preventDefault());break;default:c=!0,this._searchTimeout(e)}},keypress:function(d){if(b)return b=!1,void((!this.isMultiLine||this.menu.element.is(":visible"))&&d.preventDefault());if(!c){var e=a.ui.keyCode;switch(d.keyCode){case e.PAGE_UP:this._move("previousPage",d);break;case e.PAGE_DOWN:this._move("nextPage",d);break;case e.UP:this._keyEvent("previous",d);break;case e.DOWN:this._keyEvent("next",d)}}},input:function(a){return d?(d=!1,void a.preventDefault()):void this._searchTimeout(a)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(a){return this.cancelBlur?void delete this.cancelBlur:(clearTimeout(this.searching),this.close(a),void this._change(a))}}),this._initSource(),this.menu=a("<ul>").addClass("ui-autocomplete ui-front").appendTo(this._appendTo()).menu({role:null}).hide().data("ui-menu"),this._on(this.menu.element,{mousedown:function(b){b.preventDefault(),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur});var c=this.menu.element[0];a(b.target).closest(".ui-menu-item").length||this._delay(function(){var b=this;this.document.one("mousedown",function(d){d.target===b.element[0]||d.target===c||a.contains(c,d.target)||b.close()})})},menufocus:function(b,c){if(this.isNewMenu&&(this.isNewMenu=!1,b.originalEvent&&/^mouse/.test(b.originalEvent.type)))return this.menu.blur(),void this.document.one("mousemove",function(){a(b.target).trigger(b.originalEvent)});var d=c.item.data("ui-autocomplete-item");!1!==this._trigger("focus",b,{item:d})?b.originalEvent&&/^key/.test(b.originalEvent.type)&&this._value(d.value):this.liveRegion.text(d.value)},menuselect:function(a,b){var c=b.item.data("ui-autocomplete-item"),d=this.previous;this.element[0]!==this.document[0].activeElement&&(this.element.focus(),this.previous=d,this._delay(function(){this.previous=d,this.selectedItem=c})),!1!==this._trigger("select",a,{item:c})&&this._value(c.value),this.term=this._value(),this.close(a),this.selectedItem=c}}),this.liveRegion=a("<span>",{role:"status","aria-live":"polite"}).addClass("ui-helper-hidden-accessible").insertBefore(this.element),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(a,b){this._super(a,b),"source"===a&&this._initSource(),"appendTo"===a&&this.menu.element.appendTo(this._appendTo()),"disabled"===a&&b&&this.xhr&&this.xhr.abort()},_appendTo:function(){var b=this.options.appendTo;return b&&(b=b.jquery||b.nodeType?a(b):this.document.find(b).eq(0)),b||(b=this.element.closest(".ui-front")),b.length||(b=this.document[0].body),b},_initSource:function(){var b,c,d=this;a.isArray(this.options.source)?(b=this.options.source,this.source=function(c,d){d(a.ui.autocomplete.filter(b,c.term))}):"string"==typeof this.options.source?(c=this.options.source,this.source=function(b,e){d.xhr&&d.xhr.abort(),d.xhr=a.ajax({url:c,data:b,dataType:"json",success:function(a){e(a)},error:function(){e([])}})}):this.source=this.options.source},_searchTimeout:function(a){clearTimeout(this.searching),this.searching=this._delay(function(){this.term!==this._value()&&(this.selectedItem=null,this.search(null,a))},this.options.delay)},search:function(a,b){return a=null!=a?a:this._value(),this.term=this._value(),a.length<this.options.minLength?this.close(b):this._trigger("search",b)!==!1?this._search(a):void 0},_search:function(a){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:a},this._response())},_response:function(){var a=this,c=++b;return function(d){c===b&&a.__response(d),a.pending--,a.pending||a.element.removeClass("ui-autocomplete-loading")}},__response:function(a){a&&(a=this._normalize(a)),this._trigger("response",null,{content:a}),!this.options.disabled&&a&&a.length&&!this.cancelSearch?(this._suggest(a),this._trigger("open")):this._close()},close:function(a){this.cancelSearch=!0,this._close(a)},_close:function(a){this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",a))},_change:function(a){this.previous!==this._value()&&this._trigger("change",a,{item:this.selectedItem})},_normalize:function(b){return b.length&&b[0].label&&b[0].value?b:a.map(b,function(b){return"string"==typeof b?{label:b,value:b}:a.extend({label:b.label||b.value,value:b.value||b.label},b)})},_suggest:function(b){var c=this.menu.element.empty();this._renderMenu(c,b),this.isNewMenu=!0,this.menu.refresh(),c.show(),this._resizeMenu(),c.position(a.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next()},_resizeMenu:function(){var a=this.menu.element;a.outerWidth(Math.max(a.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(b,c){var d=this;a.each(c,function(a,c){d._renderItemData(b,c)})},_renderItemData:function(a,b){return this._renderItem(a,b).data("ui-autocomplete-item",b)},_renderItem:function(b,c){return a("<li>").append(a("<a>").text(c.label)).appendTo(b)},_move:function(a,b){return this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(a)||this.menu.isLastItem()&&/^next/.test(a)?(this._value(this.term),void this.menu.blur()):void this.menu[a](b):void this.search(null,b)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(a,b){(!this.isMultiLine||this.menu.element.is(":visible"))&&(this._move(a,b),b.preventDefault())}}),a.extend(a.ui.autocomplete,{escapeRegex:function(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(b,c){var d=RegExp(a.ui.autocomplete.escapeRegex(c),"i");return a.grep(b,function(a){return d.test(a.label||a.value||a)})}}),a.widget("ui.autocomplete",a.ui.autocomplete,{options:{messages:{noResults:"No search results.",results:function(a){return a+(a>1?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(a){var b;this._superApply(arguments),this.options.disabled||this.cancelSearch||(b=a&&a.length?this.options.messages.results(a.length):this.options.messages.noResults,this.liveRegion.text(b))}})}(jQuery),function(a){var b,c,d,e,f="ui-button ui-widget ui-state-default ui-corner-all",g="ui-state-hover ui-state-active ",h="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",i=function(){var b=a(this);setTimeout(function(){b.find(":ui-button").button("refresh")},1)},j=function(b){var c=b.name,d=b.form,e=a([]);return c&&(c=c.replace(/'/g,"\\'"),e=d?a(d).find("[name='"+c+"']"):a("[name='"+c+"']",b.ownerDocument).filter(function(){return!this.form})),e};a.widget("ui.button",{version:"1.10.3",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset"+this.eventNamespace).bind("reset"+this.eventNamespace,i),"boolean"!=typeof this.options.disabled?this.options.disabled=!!this.element.prop("disabled"):this.element.prop("disabled",this.options.disabled),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var g=this,h=this.options,k="checkbox"===this.type||"radio"===this.type,l=k?"":"ui-state-active",m="ui-state-focus";null===h.label&&(h.label="input"===this.type?this.buttonElement.val():this.buttonElement.html()),this._hoverable(this.buttonElement),this.buttonElement.addClass(f).attr("role","button").bind("mouseenter"+this.eventNamespace,function(){h.disabled||this===b&&a(this).addClass("ui-state-active")}).bind("mouseleave"+this.eventNamespace,function(){h.disabled||a(this).removeClass(l)}).bind("click"+this.eventNamespace,function(a){h.disabled&&(a.preventDefault(),a.stopImmediatePropagation())}),this.element.bind("focus"+this.eventNamespace,function(){g.buttonElement.addClass(m)}).bind("blur"+this.eventNamespace,function(){g.buttonElement.removeClass(m)}),k&&(this.element.bind("change"+this.eventNamespace,function(){e||g.refresh()}),this.buttonElement.bind("mousedown"+this.eventNamespace,function(a){h.disabled||(e=!1,c=a.pageX,d=a.pageY)}).bind("mouseup"+this.eventNamespace,function(a){h.disabled||(c!==a.pageX||d!==a.pageY)&&(e=!0)})),"checkbox"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){return h.disabled||e?!1:void 0}):"radio"===this.type?this.buttonElement.bind("click"+this.eventNamespace,function(){if(h.disabled||e)return!1;a(this).addClass("ui-state-active"),g.buttonElement.attr("aria-pressed","true");var b=g.element[0];j(b).not(b).map(function(){return a(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown"+this.eventNamespace,function(){return h.disabled?!1:(a(this).addClass("ui-state-active"),b=this,void g.document.one("mouseup",function(){b=null}))}).bind("mouseup"+this.eventNamespace,function(){return h.disabled?!1:void a(this).removeClass("ui-state-active")}).bind("keydown"+this.eventNamespace,function(b){return h.disabled?!1:void((b.keyCode===a.ui.keyCode.SPACE||b.keyCode===a.ui.keyCode.ENTER)&&a(this).addClass("ui-state-active"))}).bind("keyup"+this.eventNamespace+" blur"+this.eventNamespace,function(){a(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(b){b.keyCode===a.ui.keyCode.SPACE&&a(this).click()})),this._setOption("disabled",h.disabled),this._resetButton()},_determineButtonType:function(){var a,b,c;this.type=this.element.is("[type=checkbox]")?"checkbox":this.element.is("[type=radio]")?"radio":this.element.is("input")?"input":"button","checkbox"===this.type||"radio"===this.type?(a=this.element.parents().last(),b="label[for='"+this.element.attr("id")+"']",this.buttonElement=a.find(b),this.buttonElement.length||(a=a.length?a.siblings():this.element.siblings(),this.buttonElement=a.filter(b),this.buttonElement.length||(this.buttonElement=a.find(b))),this.element.addClass("ui-helper-hidden-accessible"),c=this.element.is(":checked"),c&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",c)):this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(f+" "+g+" "+h).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title");
},_setOption:function(a,b){return this._super(a,b),"disabled"===a?void(b?this.element.prop("disabled",!0):this.element.prop("disabled",!1)):void this._resetButton()},refresh:function(){var b=this.element.is("input, button")?this.element.is(":disabled"):this.element.hasClass("ui-button-disabled");b!==this.options.disabled&&this._setOption("disabled",b),"radio"===this.type?j(this.element[0]).each(function(){a(this).is(":checked")?a(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):a(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):"checkbox"===this.type&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if("input"===this.type)return void(this.options.label&&this.element.val(this.options.label));var b=this.buttonElement.removeClass(h),c=a("<span></span>",this.document[0]).addClass("ui-button-text").html(this.options.label).appendTo(b.empty()).text(),d=this.options.icons,e=d.primary&&d.secondary,f=[];d.primary||d.secondary?(this.options.text&&f.push("ui-button-text-icon"+(e?"s":d.primary?"-primary":"-secondary")),d.primary&&b.prepend("<span class='ui-button-icon-primary ui-icon "+d.primary+"'></span>"),d.secondary&&b.append("<span class='ui-button-icon-secondary ui-icon "+d.secondary+"'></span>"),this.options.text||(f.push(e?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||b.attr("title",a.trim(c)))):f.push("ui-button-text-only"),b.addClass(f.join(" "))}}),a.widget("ui.buttonset",{version:"1.10.3",options:{items:"button, input[type=button], input[type=submit], input[type=reset], input[type=checkbox], input[type=radio], a, :data(ui-button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(a,b){"disabled"===a&&this.buttons.button("option",a,b),this._super(a,b)},refresh:function(){var b="rtl"===this.element.css("direction");this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(b?"ui-corner-right":"ui-corner-left").end().filter(":last").addClass(b?"ui-corner-left":"ui-corner-right").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})}(jQuery),function(a,b){function c(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:""},this._defaults={showOn:"focus",showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,numberOfMonths:1,showCurrentAtPos:0,stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},a.extend(this._defaults,this.regional[""]),this.dpDiv=d(a("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function d(b){var c="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";return b.delegate(c,"mouseout",function(){a(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&a(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&a(this).removeClass("ui-datepicker-next-hover")}).delegate(c,"mouseover",function(){a.datepicker._isDisabledDatepicker(f.inline?b.parent()[0]:f.input[0])||(a(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),a(this).addClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&a(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&a(this).addClass("ui-datepicker-next-hover"))})}function e(b,c){a.extend(b,c);for(var d in c)null==c[d]&&(b[d]=c[d]);return b}a.extend(a.ui,{datepicker:{version:"1.10.3"}});var f,g="datepicker";a.extend(c.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(a){return e(this._defaults,a||{}),this},_attachDatepicker:function(b,c){var d,e,f;d=b.nodeName.toLowerCase(),e="div"===d||"span"===d,b.id||(this.uuid+=1,b.id="dp"+this.uuid),f=this._newInst(a(b),e),f.settings=a.extend({},c||{}),"input"===d?this._connectDatepicker(b,f):e&&this._inlineDatepicker(b,f)},_newInst:function(b,c){var e=b[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1");return{id:e,input:b,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:c,dpDiv:c?d(a("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):this.dpDiv}},_connectDatepicker:function(b,c){var d=a(b);c.append=a([]),c.trigger=a([]),d.hasClass(this.markerClassName)||(this._attachments(d,c),d.addClass(this.markerClassName).keydown(this._doKeyDown).keypress(this._doKeyPress).keyup(this._doKeyUp),this._autoSize(c),a.data(b,g,c),c.settings.disabled&&this._disableDatepicker(b))},_attachments:function(b,c){var d,e,f,g=this._get(c,"appendText"),h=this._get(c,"isRTL");c.append&&c.append.remove(),g&&(c.append=a("<span class='"+this._appendClass+"'>"+g+"</span>"),b[h?"before":"after"](c.append)),b.unbind("focus",this._showDatepicker),c.trigger&&c.trigger.remove(),d=this._get(c,"showOn"),("focus"===d||"both"===d)&&b.focus(this._showDatepicker),("button"===d||"both"===d)&&(e=this._get(c,"buttonText"),f=this._get(c,"buttonImage"),c.trigger=a(this._get(c,"buttonImageOnly")?a("<img/>").addClass(this._triggerClass).attr({src:f,alt:e,title:e}):a("<button type='button'></button>").addClass(this._triggerClass).html(f?a("<img/>").attr({src:f,alt:e,title:e}):e)),b[h?"before":"after"](c.trigger),c.trigger.click(function(){return a.datepicker._datepickerShowing&&a.datepicker._lastInput===b[0]?a.datepicker._hideDatepicker():a.datepicker._datepickerShowing&&a.datepicker._lastInput!==b[0]?(a.datepicker._hideDatepicker(),a.datepicker._showDatepicker(b[0])):a.datepicker._showDatepicker(b[0]),!1}))},_autoSize:function(a){if(this._get(a,"autoSize")&&!a.inline){var b,c,d,e,f=new Date(2009,11,20),g=this._get(a,"dateFormat");g.match(/[DM]/)&&(b=function(a){for(c=0,d=0,e=0;a.length>e;e++)a[e].length>c&&(c=a[e].length,d=e);return d},f.setMonth(b(this._get(a,g.match(/MM/)?"monthNames":"monthNamesShort"))),f.setDate(b(this._get(a,g.match(/DD/)?"dayNames":"dayNamesShort"))+20-f.getDay())),a.input.attr("size",this._formatDate(a,f).length)}},_inlineDatepicker:function(b,c){var d=a(b);d.hasClass(this.markerClassName)||(d.addClass(this.markerClassName).append(c.dpDiv),a.data(b,g,c),this._setDate(c,this._getDefaultDate(c),!0),this._updateDatepicker(c),this._updateAlternate(c),c.settings.disabled&&this._disableDatepicker(b),c.dpDiv.css("display","block"))},_dialogDatepicker:function(b,c,d,f,h){var i,j,k,l,m,n=this._dialogInst;return n||(this.uuid+=1,i="dp"+this.uuid,this._dialogInput=a("<input type='text' id='"+i+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.keydown(this._doKeyDown),a("body").append(this._dialogInput),n=this._dialogInst=this._newInst(this._dialogInput,!1),n.settings={},a.data(this._dialogInput[0],g,n)),e(n.settings,f||{}),c=c&&c.constructor===Date?this._formatDate(n,c):c,this._dialogInput.val(c),this._pos=h?h.length?h:[h.pageX,h.pageY]:null,this._pos||(j=document.documentElement.clientWidth,k=document.documentElement.clientHeight,l=document.documentElement.scrollLeft||document.body.scrollLeft,m=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[j/2-100+l,k/2-150+m]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),n.settings.onSelect=d,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),this._showDatepicker(this._dialogInput[0]),a.blockUI&&a.blockUI(this.dpDiv),a.data(this._dialogInput[0],g,n),this},_destroyDatepicker:function(b){var c,d=a(b),e=a.data(b,g);d.hasClass(this.markerClassName)&&(c=b.nodeName.toLowerCase(),a.removeData(b,g),"input"===c?(e.append.remove(),e.trigger.remove(),d.removeClass(this.markerClassName).unbind("focus",this._showDatepicker).unbind("keydown",this._doKeyDown).unbind("keypress",this._doKeyPress).unbind("keyup",this._doKeyUp)):("div"===c||"span"===c)&&d.removeClass(this.markerClassName).empty())},_enableDatepicker:function(b){var c,d,e=a(b),f=a.data(b,g);e.hasClass(this.markerClassName)&&(c=b.nodeName.toLowerCase(),"input"===c?(b.disabled=!1,f.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):("div"===c||"span"===c)&&(d=e.children("."+this._inlineClass),d.children().removeClass("ui-state-disabled"),d.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!1)),this._disabledInputs=a.map(this._disabledInputs,function(a){return a===b?null:a}))},_disableDatepicker:function(b){var c,d,e=a(b),f=a.data(b,g);e.hasClass(this.markerClassName)&&(c=b.nodeName.toLowerCase(),"input"===c?(b.disabled=!0,f.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):("div"===c||"span"===c)&&(d=e.children("."+this._inlineClass),d.children().addClass("ui-state-disabled"),d.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",!0)),this._disabledInputs=a.map(this._disabledInputs,function(a){return a===b?null:a}),this._disabledInputs[this._disabledInputs.length]=b)},_isDisabledDatepicker:function(a){if(!a)return!1;for(var b=0;this._disabledInputs.length>b;b++)if(this._disabledInputs[b]===a)return!0;return!1},_getInst:function(b){try{return a.data(b,g)}catch(c){throw"Missing instance data for this datepicker"}},_optionDatepicker:function(c,d,f){var g,h,i,j,k=this._getInst(c);return 2===arguments.length&&"string"==typeof d?"defaults"===d?a.extend({},a.datepicker._defaults):k?"all"===d?a.extend({},k.settings):this._get(k,d):null:(g=d||{},"string"==typeof d&&(g={},g[d]=f),k&&(this._curInst===k&&this._hideDatepicker(),h=this._getDateDatepicker(c,!0),i=this._getMinMaxDate(k,"min"),j=this._getMinMaxDate(k,"max"),e(k.settings,g),null!==i&&g.dateFormat!==b&&g.minDate===b&&(k.settings.minDate=this._formatDate(k,i)),null!==j&&g.dateFormat!==b&&g.maxDate===b&&(k.settings.maxDate=this._formatDate(k,j)),"disabled"in g&&(g.disabled?this._disableDatepicker(c):this._enableDatepicker(c)),this._attachments(a(c),k),this._autoSize(k),this._setDate(k,h),this._updateAlternate(k),this._updateDatepicker(k)),b)},_changeDatepicker:function(a,b,c){this._optionDatepicker(a,b,c)},_refreshDatepicker:function(a){var b=this._getInst(a);b&&this._updateDatepicker(b)},_setDateDatepicker:function(a,b){var c=this._getInst(a);c&&(this._setDate(c,b),this._updateDatepicker(c),this._updateAlternate(c))},_getDateDatepicker:function(a,b){var c=this._getInst(a);return c&&!c.inline&&this._setDateFromField(c,b),c?this._getDate(c):null},_doKeyDown:function(b){var c,d,e,f=a.datepicker._getInst(b.target),g=!0,h=f.dpDiv.is(".ui-datepicker-rtl");if(f._keyEvent=!0,a.datepicker._datepickerShowing)switch(b.keyCode){case 9:a.datepicker._hideDatepicker(),g=!1;break;case 13:return e=a("td."+a.datepicker._dayOverClass+":not(."+a.datepicker._currentClass+")",f.dpDiv),e[0]&&a.datepicker._selectDay(b.target,f.selectedMonth,f.selectedYear,e[0]),c=a.datepicker._get(f,"onSelect"),c?(d=a.datepicker._formatDate(f),c.apply(f.input?f.input[0]:null,[d,f])):a.datepicker._hideDatepicker(),!1;case 27:a.datepicker._hideDatepicker();break;case 33:a.datepicker._adjustDate(b.target,b.ctrlKey?-a.datepicker._get(f,"stepBigMonths"):-a.datepicker._get(f,"stepMonths"),"M");break;case 34:a.datepicker._adjustDate(b.target,b.ctrlKey?+a.datepicker._get(f,"stepBigMonths"):+a.datepicker._get(f,"stepMonths"),"M");break;case 35:(b.ctrlKey||b.metaKey)&&a.datepicker._clearDate(b.target),g=b.ctrlKey||b.metaKey;break;case 36:(b.ctrlKey||b.metaKey)&&a.datepicker._gotoToday(b.target),g=b.ctrlKey||b.metaKey;break;case 37:(b.ctrlKey||b.metaKey)&&a.datepicker._adjustDate(b.target,h?1:-1,"D"),g=b.ctrlKey||b.metaKey,b.originalEvent.altKey&&a.datepicker._adjustDate(b.target,b.ctrlKey?-a.datepicker._get(f,"stepBigMonths"):-a.datepicker._get(f,"stepMonths"),"M");break;case 38:(b.ctrlKey||b.metaKey)&&a.datepicker._adjustDate(b.target,-7,"D"),g=b.ctrlKey||b.metaKey;break;case 39:(b.ctrlKey||b.metaKey)&&a.datepicker._adjustDate(b.target,h?-1:1,"D"),g=b.ctrlKey||b.metaKey,b.originalEvent.altKey&&a.datepicker._adjustDate(b.target,b.ctrlKey?+a.datepicker._get(f,"stepBigMonths"):+a.datepicker._get(f,"stepMonths"),"M");break;case 40:(b.ctrlKey||b.metaKey)&&a.datepicker._adjustDate(b.target,7,"D"),g=b.ctrlKey||b.metaKey;break;default:g=!1}else 36===b.keyCode&&b.ctrlKey?a.datepicker._showDatepicker(this):g=!1;g&&(b.preventDefault(),b.stopPropagation())},_doKeyPress:function(c){var d,e,f=a.datepicker._getInst(c.target);return a.datepicker._get(f,"constrainInput")?(d=a.datepicker._possibleChars(a.datepicker._get(f,"dateFormat")),e=String.fromCharCode(null==c.charCode?c.keyCode:c.charCode),c.ctrlKey||c.metaKey||" ">e||!d||d.indexOf(e)>-1):b},_doKeyUp:function(b){var c,d=a.datepicker._getInst(b.target);if(d.input.val()!==d.lastVal)try{c=a.datepicker.parseDate(a.datepicker._get(d,"dateFormat"),d.input?d.input.val():null,a.datepicker._getFormatConfig(d)),c&&(a.datepicker._setDateFromField(d),a.datepicker._updateAlternate(d),a.datepicker._updateDatepicker(d))}catch(e){}return!0},_showDatepicker:function(b){if(b=b.target||b,"input"!==b.nodeName.toLowerCase()&&(b=a("input",b.parentNode)[0]),!a.datepicker._isDisabledDatepicker(b)&&a.datepicker._lastInput!==b){var c,d,f,g,h,i,j;c=a.datepicker._getInst(b),a.datepicker._curInst&&a.datepicker._curInst!==c&&(a.datepicker._curInst.dpDiv.stop(!0,!0),c&&a.datepicker._datepickerShowing&&a.datepicker._hideDatepicker(a.datepicker._curInst.input[0])),d=a.datepicker._get(c,"beforeShow"),f=d?d.apply(b,[b,c]):{},f!==!1&&(e(c.settings,f),c.lastVal=null,a.datepicker._lastInput=b,a.datepicker._setDateFromField(c),a.datepicker._inDialog&&(b.value=""),a.datepicker._pos||(a.datepicker._pos=a.datepicker._findPos(b),a.datepicker._pos[1]+=b.offsetHeight),g=!1,a(b).parents().each(function(){return g|="fixed"===a(this).css("position"),!g}),h={left:a.datepicker._pos[0],top:a.datepicker._pos[1]},a.datepicker._pos=null,c.dpDiv.empty(),c.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),a.datepicker._updateDatepicker(c),h=a.datepicker._checkOffset(c,h,g),c.dpDiv.css({position:a.datepicker._inDialog&&a.blockUI?"static":g?"fixed":"absolute",display:"none",left:h.left+"px",top:h.top+"px"}),c.inline||(i=a.datepicker._get(c,"showAnim"),j=a.datepicker._get(c,"duration"),c.dpDiv.zIndex(a(b).zIndex()+1),a.datepicker._datepickerShowing=!0,a.effects&&a.effects.effect[i]?c.dpDiv.show(i,a.datepicker._get(c,"showOptions"),j):c.dpDiv[i||"show"](i?j:null),a.datepicker._shouldFocusInput(c)&&c.input.focus(),a.datepicker._curInst=c))}},_updateDatepicker:function(b){this.maxRows=4,f=b,b.dpDiv.empty().append(this._generateHTML(b)),this._attachHandlers(b),b.dpDiv.find("."+this._dayOverClass+" a").mouseover();var c,d=this._getNumberOfMonths(b),e=d[1],g=17;b.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),e>1&&b.dpDiv.addClass("ui-datepicker-multi-"+e).css("width",g*e+"em"),b.dpDiv[(1!==d[0]||1!==d[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),b.dpDiv[(this._get(b,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),b===a.datepicker._curInst&&a.datepicker._datepickerShowing&&a.datepicker._shouldFocusInput(b)&&b.input.focus(),b.yearshtml&&(c=b.yearshtml,setTimeout(function(){c===b.yearshtml&&b.yearshtml&&b.dpDiv.find("select.ui-datepicker-year:first").replaceWith(b.yearshtml),c=b.yearshtml=null},0))},_shouldFocusInput:function(a){return a.input&&a.input.is(":visible")&&!a.input.is(":disabled")&&!a.input.is(":focus")},_checkOffset:function(b,c,d){var e=b.dpDiv.outerWidth(),f=b.dpDiv.outerHeight(),g=b.input?b.input.outerWidth():0,h=b.input?b.input.outerHeight():0,i=document.documentElement.clientWidth+(d?0:a(document).scrollLeft()),j=document.documentElement.clientHeight+(d?0:a(document).scrollTop());return c.left-=this._get(b,"isRTL")?e-g:0,c.left-=d&&c.left===b.input.offset().left?a(document).scrollLeft():0,c.top-=d&&c.top===b.input.offset().top+h?a(document).scrollTop():0,c.left-=Math.min(c.left,c.left+e>i&&i>e?Math.abs(c.left+e-i):0),c.top-=Math.min(c.top,c.top+f>j&&j>f?Math.abs(f+h):0),c},_findPos:function(b){for(var c,d=this._getInst(b),e=this._get(d,"isRTL");b&&("hidden"===b.type||1!==b.nodeType||a.expr.filters.hidden(b));)b=b[e?"previousSibling":"nextSibling"];return c=a(b).offset(),[c.left,c.top]},_hideDatepicker:function(b){var c,d,e,f,h=this._curInst;!h||b&&h!==a.data(b,g)||this._datepickerShowing&&(c=this._get(h,"showAnim"),d=this._get(h,"duration"),e=function(){a.datepicker._tidyDialog(h)},a.effects&&(a.effects.effect[c]||a.effects[c])?h.dpDiv.hide(c,a.datepicker._get(h,"showOptions"),d,e):h.dpDiv["slideDown"===c?"slideUp":"fadeIn"===c?"fadeOut":"hide"](c?d:null,e),c||e(),this._datepickerShowing=!1,f=this._get(h,"onClose"),f&&f.apply(h.input?h.input[0]:null,[h.input?h.input.val():"",h]),this._lastInput=null,this._inDialog&&(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),a.blockUI&&(a.unblockUI(),a("body").append(this.dpDiv))),this._inDialog=!1)},_tidyDialog:function(a){a.dpDiv.removeClass(this._dialogClass).unbind(".ui-datepicker-calendar")},_checkExternalClick:function(b){if(a.datepicker._curInst){var c=a(b.target),d=a.datepicker._getInst(c[0]);(c[0].id!==a.datepicker._mainDivId&&0===c.parents("#"+a.datepicker._mainDivId).length&&!c.hasClass(a.datepicker.markerClassName)&&!c.closest("."+a.datepicker._triggerClass).length&&a.datepicker._datepickerShowing&&(!a.datepicker._inDialog||!a.blockUI)||c.hasClass(a.datepicker.markerClassName)&&a.datepicker._curInst!==d)&&a.datepicker._hideDatepicker()}},_adjustDate:function(b,c,d){var e=a(b),f=this._getInst(e[0]);this._isDisabledDatepicker(e[0])||(this._adjustInstDate(f,c+("M"===d?this._get(f,"showCurrentAtPos"):0),d),this._updateDatepicker(f))},_gotoToday:function(b){var c,d=a(b),e=this._getInst(d[0]);this._get(e,"gotoCurrent")&&e.currentDay?(e.selectedDay=e.currentDay,e.drawMonth=e.selectedMonth=e.currentMonth,e.drawYear=e.selectedYear=e.currentYear):(c=new Date,e.selectedDay=c.getDate(),e.drawMonth=e.selectedMonth=c.getMonth(),e.drawYear=e.selectedYear=c.getFullYear()),this._notifyChange(e),this._adjustDate(d)},_selectMonthYear:function(b,c,d){var e=a(b),f=this._getInst(e[0]);f["selected"+("M"===d?"Month":"Year")]=f["draw"+("M"===d?"Month":"Year")]=parseInt(c.options[c.selectedIndex].value,10),this._notifyChange(f),this._adjustDate(e)},_selectDay:function(b,c,d,e){var f,g=a(b);a(e).hasClass(this._unselectableClass)||this._isDisabledDatepicker(g[0])||(f=this._getInst(g[0]),f.selectedDay=f.currentDay=a("a",e).html(),f.selectedMonth=f.currentMonth=c,f.selectedYear=f.currentYear=d,this._selectDate(b,this._formatDate(f,f.currentDay,f.currentMonth,f.currentYear)))},_clearDate:function(b){var c=a(b);this._selectDate(c,"")},_selectDate:function(b,c){var d,e=a(b),f=this._getInst(e[0]);c=null!=c?c:this._formatDate(f),f.input&&f.input.val(c),this._updateAlternate(f),d=this._get(f,"onSelect"),d?d.apply(f.input?f.input[0]:null,[c,f]):f.input&&f.input.trigger("change"),f.inline?this._updateDatepicker(f):(this._hideDatepicker(),this._lastInput=f.input[0],"object"!=typeof f.input[0]&&f.input.focus(),this._lastInput=null)},_updateAlternate:function(b){var c,d,e,f=this._get(b,"altField");f&&(c=this._get(b,"altFormat")||this._get(b,"dateFormat"),d=this._getDate(b),e=this.formatDate(c,d,this._getFormatConfig(b)),a(f).each(function(){a(this).val(e)}))},noWeekends:function(a){var b=a.getDay();return[b>0&&6>b,""]},iso8601Week:function(a){var b,c=new Date(a.getTime());return c.setDate(c.getDate()+4-(c.getDay()||7)),b=c.getTime(),c.setMonth(0),c.setDate(1),Math.floor(Math.round((b-c)/864e5)/7)+1},parseDate:function(c,d,e){if(null==c||null==d)throw"Invalid arguments";if(d="object"==typeof d?""+d:d+"",""===d)return null;var f,g,h,i,j=0,k=(e?e.shortYearCutoff:null)||this._defaults.shortYearCutoff,l="string"!=typeof k?k:(new Date).getFullYear()%100+parseInt(k,10),m=(e?e.dayNamesShort:null)||this._defaults.dayNamesShort,n=(e?e.dayNames:null)||this._defaults.dayNames,o=(e?e.monthNamesShort:null)||this._defaults.monthNamesShort,p=(e?e.monthNames:null)||this._defaults.monthNames,q=-1,r=-1,s=-1,t=-1,u=!1,v=function(a){var b=c.length>f+1&&c.charAt(f+1)===a;return b&&f++,b},w=function(a){var b=v(a),c="@"===a?14:"!"===a?20:"y"===a&&b?4:"o"===a?3:2,e=RegExp("^\\d{1,"+c+"}"),f=d.substring(j).match(e);if(!f)throw"Missing number at position "+j;return j+=f[0].length,parseInt(f[0],10)},x=function(c,e,f){var g=-1,h=a.map(v(c)?f:e,function(a,b){return[[b,a]]}).sort(function(a,b){return-(a[1].length-b[1].length)});if(a.each(h,function(a,c){var e=c[1];return d.substr(j,e.length).toLowerCase()===e.toLowerCase()?(g=c[0],j+=e.length,!1):b}),-1!==g)return g+1;throw"Unknown name at position "+j},y=function(){if(d.charAt(j)!==c.charAt(f))throw"Unexpected literal at position "+j;j++};for(f=0;c.length>f;f++)if(u)"'"!==c.charAt(f)||v("'")?y():u=!1;else switch(c.charAt(f)){case"d":s=w("d");break;case"D":x("D",m,n);break;case"o":t=w("o");break;case"m":r=w("m");break;case"M":r=x("M",o,p);break;case"y":q=w("y");break;case"@":i=new Date(w("@")),q=i.getFullYear(),r=i.getMonth()+1,s=i.getDate();break;case"!":i=new Date((w("!")-this._ticksTo1970)/1e4),q=i.getFullYear(),r=i.getMonth()+1,s=i.getDate();break;case"'":v("'")?y():u=!0;break;default:y()}if(d.length>j&&(h=d.substr(j),!/^\s+/.test(h)))throw"Extra/unparsed characters found in date: "+h;if(-1===q?q=(new Date).getFullYear():100>q&&(q+=(new Date).getFullYear()-(new Date).getFullYear()%100+(l>=q?0:-100)),t>-1)for(r=1,s=t;g=this._getDaysInMonth(q,r-1),!(g>=s);)r++,s-=g;if(i=this._daylightSavingAdjust(new Date(q,r-1,s)),i.getFullYear()!==q||i.getMonth()+1!==r||i.getDate()!==s)throw"Invalid date";return i},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:864e9*(718685+Math.floor(492.5)-Math.floor(19.7)+Math.floor(4.925)),formatDate:function(a,b,c){if(!b)return"";var d,e=(c?c.dayNamesShort:null)||this._defaults.dayNamesShort,f=(c?c.dayNames:null)||this._defaults.dayNames,g=(c?c.monthNamesShort:null)||this._defaults.monthNamesShort,h=(c?c.monthNames:null)||this._defaults.monthNames,i=function(b){var c=a.length>d+1&&a.charAt(d+1)===b;return c&&d++,c},j=function(a,b,c){var d=""+b;if(i(a))for(;c>d.length;)d="0"+d;return d},k=function(a,b,c,d){return i(a)?d[b]:c[b]},l="",m=!1;if(b)for(d=0;a.length>d;d++)if(m)"'"!==a.charAt(d)||i("'")?l+=a.charAt(d):m=!1;else switch(a.charAt(d)){case"d":l+=j("d",b.getDate(),2);break;case"D":l+=k("D",b.getDay(),e,f);break;case"o":l+=j("o",Math.round((new Date(b.getFullYear(),b.getMonth(),b.getDate()).getTime()-new Date(b.getFullYear(),0,0).getTime())/864e5),3);break;case"m":l+=j("m",b.getMonth()+1,2);break;case"M":l+=k("M",b.getMonth(),g,h);break;case"y":l+=i("y")?b.getFullYear():(10>b.getYear()%100?"0":"")+b.getYear()%100;break;case"@":l+=b.getTime();break;case"!":l+=1e4*b.getTime()+this._ticksTo1970;break;case"'":i("'")?l+="'":m=!0;break;default:l+=a.charAt(d)}return l},_possibleChars:function(a){var b,c="",d=!1,e=function(c){var d=a.length>b+1&&a.charAt(b+1)===c;return d&&b++,d};for(b=0;a.length>b;b++)if(d)"'"!==a.charAt(b)||e("'")?c+=a.charAt(b):d=!1;else switch(a.charAt(b)){case"d":case"m":case"y":case"@":c+="0123456789";break;case"D":case"M":return null;case"'":e("'")?c+="'":d=!0;break;default:c+=a.charAt(b)}return c},_get:function(a,c){return a.settings[c]!==b?a.settings[c]:this._defaults[c]},_setDateFromField:function(a,b){if(a.input.val()!==a.lastVal){var c=this._get(a,"dateFormat"),d=a.lastVal=a.input?a.input.val():null,e=this._getDefaultDate(a),f=e,g=this._getFormatConfig(a);try{f=this.parseDate(c,d,g)||e}catch(h){d=b?"":d}a.selectedDay=f.getDate(),a.drawMonth=a.selectedMonth=f.getMonth(),a.drawYear=a.selectedYear=f.getFullYear(),a.currentDay=d?f.getDate():0,a.currentMonth=d?f.getMonth():0,a.currentYear=d?f.getFullYear():0,this._adjustInstDate(a)}},_getDefaultDate:function(a){return this._restrictMinMax(a,this._determineDate(a,this._get(a,"defaultDate"),new Date))},_determineDate:function(b,c,d){var e=function(a){var b=new Date;return b.setDate(b.getDate()+a),b},f=function(c){try{return a.datepicker.parseDate(a.datepicker._get(b,"dateFormat"),c,a.datepicker._getFormatConfig(b))}catch(d){}for(var e=(c.toLowerCase().match(/^c/)?a.datepicker._getDate(b):null)||new Date,f=e.getFullYear(),g=e.getMonth(),h=e.getDate(),i=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,j=i.exec(c);j;){switch(j[2]||"d"){case"d":case"D":h+=parseInt(j[1],10);break;case"w":case"W":h+=7*parseInt(j[1],10);break;case"m":case"M":g+=parseInt(j[1],10),h=Math.min(h,a.datepicker._getDaysInMonth(f,g));break;case"y":case"Y":f+=parseInt(j[1],10),h=Math.min(h,a.datepicker._getDaysInMonth(f,g))}j=i.exec(c)}return new Date(f,g,h)},g=null==c||""===c?d:"string"==typeof c?f(c):"number"==typeof c?isNaN(c)?d:e(c):new Date(c.getTime());return g=g&&"Invalid Date"==""+g?d:g,g&&(g.setHours(0),g.setMinutes(0),g.setSeconds(0),g.setMilliseconds(0)),this._daylightSavingAdjust(g)},_daylightSavingAdjust:function(a){return a?(a.setHours(a.getHours()>12?a.getHours()+2:0),a):null},_setDate:function(a,b,c){var d=!b,e=a.selectedMonth,f=a.selectedYear,g=this._restrictMinMax(a,this._determineDate(a,b,new Date));a.selectedDay=a.currentDay=g.getDate(),a.drawMonth=a.selectedMonth=a.currentMonth=g.getMonth(),a.drawYear=a.selectedYear=a.currentYear=g.getFullYear(),e===a.selectedMonth&&f===a.selectedYear||c||this._notifyChange(a),this._adjustInstDate(a),a.input&&a.input.val(d?"":this._formatDate(a))},_getDate:function(a){var b=!a.currentYear||a.input&&""===a.input.val()?null:this._daylightSavingAdjust(new Date(a.currentYear,a.currentMonth,a.currentDay));return b},_attachHandlers:function(b){var c=this._get(b,"stepMonths"),d="#"+b.id.replace(/\\\\/g,"\\");b.dpDiv.find("[data-handler]").map(function(){var b={prev:function(){a.datepicker._adjustDate(d,-c,"M")},next:function(){a.datepicker._adjustDate(d,+c,"M")},hide:function(){a.datepicker._hideDatepicker()},today:function(){a.datepicker._gotoToday(d)},selectDay:function(){return a.datepicker._selectDay(d,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return a.datepicker._selectMonthYear(d,this,"M"),!1},selectYear:function(){return a.datepicker._selectMonthYear(d,this,"Y"),!1}};a(this).bind(this.getAttribute("data-event"),b[this.getAttribute("data-handler")])})},_generateHTML:function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O=new Date,P=this._daylightSavingAdjust(new Date(O.getFullYear(),O.getMonth(),O.getDate())),Q=this._get(a,"isRTL"),R=this._get(a,"showButtonPanel"),S=this._get(a,"hideIfNoPrevNext"),T=this._get(a,"navigationAsDateFormat"),U=this._getNumberOfMonths(a),V=this._get(a,"showCurrentAtPos"),W=this._get(a,"stepMonths"),X=1!==U[0]||1!==U[1],Y=this._daylightSavingAdjust(a.currentDay?new Date(a.currentYear,a.currentMonth,a.currentDay):new Date(9999,9,9)),Z=this._getMinMaxDate(a,"min"),$=this._getMinMaxDate(a,"max"),_=a.drawMonth-V,aa=a.drawYear;if(0>_&&(_+=12,aa--),$)for(b=this._daylightSavingAdjust(new Date($.getFullYear(),$.getMonth()-U[0]*U[1]+1,$.getDate())),b=Z&&Z>b?Z:b;this._daylightSavingAdjust(new Date(aa,_,1))>b;)_--,0>_&&(_=11,aa--);for(a.drawMonth=_,a.drawYear=aa,c=this._get(a,"prevText"),c=T?this.formatDate(c,this._daylightSavingAdjust(new Date(aa,_-W,1)),this._getFormatConfig(a)):c,d=this._canAdjustMonth(a,-1,aa,_)?"<a class='ui-datepicker-prev ui-corner-all' data-handler='prev' data-event='click' title='"+c+"'><span class='ui-icon ui-icon-circle-triangle-"+(Q?"e":"w")+"'>"+c+"</span></a>":S?"":"<a class='ui-datepicker-prev ui-corner-all ui-state-disabled' title='"+c+"'><span class='ui-icon ui-icon-circle-triangle-"+(Q?"e":"w")+"'>"+c+"</span></a>",e=this._get(a,"nextText"),e=T?this.formatDate(e,this._daylightSavingAdjust(new Date(aa,_+W,1)),this._getFormatConfig(a)):e,f=this._canAdjustMonth(a,1,aa,_)?"<a class='ui-datepicker-next ui-corner-all' data-handler='next' data-event='click' title='"+e+"'><span class='ui-icon ui-icon-circle-triangle-"+(Q?"w":"e")+"'>"+e+"</span></a>":S?"":"<a class='ui-datepicker-next ui-corner-all ui-state-disabled' title='"+e+"'><span class='ui-icon ui-icon-circle-triangle-"+(Q?"w":"e")+"'>"+e+"</span></a>",g=this._get(a,"currentText"),h=this._get(a,"gotoCurrent")&&a.currentDay?Y:P,g=T?this.formatDate(g,h,this._getFormatConfig(a)):g,i=a.inline?"":"<button type='button' class='ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all' data-handler='hide' data-event='click'>"+this._get(a,"closeText")+"</button>",j=R?"<div class='ui-datepicker-buttonpane ui-widget-content'>"+(Q?i:"")+(this._isInRange(a,h)?"<button type='button' class='ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all' data-handler='today' data-event='click'>"+g+"</button>":"")+(Q?"":i)+"</div>":"",k=parseInt(this._get(a,"firstDay"),10),k=isNaN(k)?0:k,l=this._get(a,"showWeek"),m=this._get(a,"dayNames"),n=this._get(a,"dayNamesMin"),o=this._get(a,"monthNames"),p=this._get(a,"monthNamesShort"),q=this._get(a,"beforeShowDay"),r=this._get(a,"showOtherMonths"),s=this._get(a,"selectOtherMonths"),t=this._getDefaultDate(a),u="",w=0;U[0]>w;w++){for(x="",this.maxRows=4,y=0;U[1]>y;y++){if(z=this._daylightSavingAdjust(new Date(aa,_,a.selectedDay)),A=" ui-corner-all",B="",X){if(B+="<div class='ui-datepicker-group",U[1]>1)switch(y){case 0:B+=" ui-datepicker-group-first",A=" ui-corner-"+(Q?"right":"left");break;case U[1]-1:B+=" ui-datepicker-group-last",A=" ui-corner-"+(Q?"left":"right");break;default:B+=" ui-datepicker-group-middle",A=""}B+="'>"}for(B+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+A+"'>"+(/all|left/.test(A)&&0===w?Q?f:d:"")+(/all|right/.test(A)&&0===w?Q?d:f:"")+this._generateMonthYearHeader(a,_,aa,Z,$,w>0||y>0,o,p)+"</div><table class='ui-datepicker-calendar'><thead><tr>",C=l?"<th class='ui-datepicker-week-col'>"+this._get(a,"weekHeader")+"</th>":"",v=0;7>v;v++)D=(v+k)%7,C+="<th"+((v+k+6)%7>=5?" class='ui-datepicker-week-end'":"")+"><span title='"+m[D]+"'>"+n[D]+"</span></th>";
for(B+=C+"</tr></thead><tbody>",E=this._getDaysInMonth(aa,_),aa===a.selectedYear&&_===a.selectedMonth&&(a.selectedDay=Math.min(a.selectedDay,E)),F=(this._getFirstDayOfMonth(aa,_)-k+7)%7,G=Math.ceil((F+E)/7),H=X&&this.maxRows>G?this.maxRows:G,this.maxRows=H,I=this._daylightSavingAdjust(new Date(aa,_,1-F)),J=0;H>J;J++){for(B+="<tr>",K=l?"<td class='ui-datepicker-week-col'>"+this._get(a,"calculateWeek")(I)+"</td>":"",v=0;7>v;v++)L=q?q.apply(a.input?a.input[0]:null,[I]):[!0,""],M=I.getMonth()!==_,N=M&&!s||!L[0]||Z&&Z>I||$&&I>$,K+="<td class='"+((v+k+6)%7>=5?" ui-datepicker-week-end":"")+(M?" ui-datepicker-other-month":"")+(I.getTime()===z.getTime()&&_===a.selectedMonth&&a._keyEvent||t.getTime()===I.getTime()&&t.getTime()===z.getTime()?" "+this._dayOverClass:"")+(N?" "+this._unselectableClass+" ui-state-disabled":"")+(M&&!r?"":" "+L[1]+(I.getTime()===Y.getTime()?" "+this._currentClass:"")+(I.getTime()===P.getTime()?" ui-datepicker-today":""))+"'"+(M&&!r||!L[2]?"":" title='"+L[2].replace(/'/g,"&#39;")+"'")+(N?"":" data-handler='selectDay' data-event='click' data-month='"+I.getMonth()+"' data-year='"+I.getFullYear()+"'")+">"+(M&&!r?"&#xa0;":N?"<span class='ui-state-default'>"+I.getDate()+"</span>":"<a class='ui-state-default"+(I.getTime()===P.getTime()?" ui-state-highlight":"")+(I.getTime()===Y.getTime()?" ui-state-active":"")+(M?" ui-priority-secondary":"")+"' href='#'>"+I.getDate()+"</a>")+"</td>",I.setDate(I.getDate()+1),I=this._daylightSavingAdjust(I);B+=K+"</tr>"}_++,_>11&&(_=0,aa++),B+="</tbody></table>"+(X?"</div>"+(U[0]>0&&y===U[1]-1?"<div class='ui-datepicker-row-break'></div>":""):""),x+=B}u+=x}return u+=j,a._keyEvent=!1,u},_generateMonthYearHeader:function(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o,p,q=this._get(a,"changeMonth"),r=this._get(a,"changeYear"),s=this._get(a,"showMonthAfterYear"),t="<div class='ui-datepicker-title'>",u="";if(f||!q)u+="<span class='ui-datepicker-month'>"+g[b]+"</span>";else{for(i=d&&d.getFullYear()===c,j=e&&e.getFullYear()===c,u+="<select class='ui-datepicker-month' data-handler='selectMonth' data-event='change'>",k=0;12>k;k++)(!i||k>=d.getMonth())&&(!j||e.getMonth()>=k)&&(u+="<option value='"+k+"'"+(k===b?" selected='selected'":"")+">"+h[k]+"</option>");u+="</select>"}if(s||(t+=u+(!f&&q&&r?"":"&#xa0;")),!a.yearshtml)if(a.yearshtml="",f||!r)t+="<span class='ui-datepicker-year'>"+c+"</span>";else{for(l=this._get(a,"yearRange").split(":"),m=(new Date).getFullYear(),n=function(a){var b=a.match(/c[+\-].*/)?c+parseInt(a.substring(1),10):a.match(/[+\-].*/)?m+parseInt(a,10):parseInt(a,10);return isNaN(b)?m:b},o=n(l[0]),p=Math.max(o,n(l[1]||"")),o=d?Math.max(o,d.getFullYear()):o,p=e?Math.min(p,e.getFullYear()):p,a.yearshtml+="<select class='ui-datepicker-year' data-handler='selectYear' data-event='change'>";p>=o;o++)a.yearshtml+="<option value='"+o+"'"+(o===c?" selected='selected'":"")+">"+o+"</option>";a.yearshtml+="</select>",t+=a.yearshtml,a.yearshtml=null}return t+=this._get(a,"yearSuffix"),s&&(t+=(!f&&q&&r?"":"&#xa0;")+u),t+="</div>"},_adjustInstDate:function(a,b,c){var d=a.drawYear+("Y"===c?b:0),e=a.drawMonth+("M"===c?b:0),f=Math.min(a.selectedDay,this._getDaysInMonth(d,e))+("D"===c?b:0),g=this._restrictMinMax(a,this._daylightSavingAdjust(new Date(d,e,f)));a.selectedDay=g.getDate(),a.drawMonth=a.selectedMonth=g.getMonth(),a.drawYear=a.selectedYear=g.getFullYear(),("M"===c||"Y"===c)&&this._notifyChange(a)},_restrictMinMax:function(a,b){var c=this._getMinMaxDate(a,"min"),d=this._getMinMaxDate(a,"max"),e=c&&c>b?c:b;return d&&e>d?d:e},_notifyChange:function(a){var b=this._get(a,"onChangeMonthYear");b&&b.apply(a.input?a.input[0]:null,[a.selectedYear,a.selectedMonth+1,a])},_getNumberOfMonths:function(a){var b=this._get(a,"numberOfMonths");return null==b?[1,1]:"number"==typeof b?[1,b]:b},_getMinMaxDate:function(a,b){return this._determineDate(a,this._get(a,b+"Date"),null)},_getDaysInMonth:function(a,b){return 32-this._daylightSavingAdjust(new Date(a,b,32)).getDate()},_getFirstDayOfMonth:function(a,b){return new Date(a,b,1).getDay()},_canAdjustMonth:function(a,b,c,d){var e=this._getNumberOfMonths(a),f=this._daylightSavingAdjust(new Date(c,d+(0>b?b:e[0]*e[1]),1));return 0>b&&f.setDate(this._getDaysInMonth(f.getFullYear(),f.getMonth())),this._isInRange(a,f)},_isInRange:function(a,b){var c,d,e=this._getMinMaxDate(a,"min"),f=this._getMinMaxDate(a,"max"),g=null,h=null,i=this._get(a,"yearRange");return i&&(c=i.split(":"),d=(new Date).getFullYear(),g=parseInt(c[0],10),h=parseInt(c[1],10),c[0].match(/[+\-].*/)&&(g+=d),c[1].match(/[+\-].*/)&&(h+=d)),(!e||b.getTime()>=e.getTime())&&(!f||b.getTime()<=f.getTime())&&(!g||b.getFullYear()>=g)&&(!h||h>=b.getFullYear())},_getFormatConfig:function(a){var b=this._get(a,"shortYearCutoff");return b="string"!=typeof b?b:(new Date).getFullYear()%100+parseInt(b,10),{shortYearCutoff:b,dayNamesShort:this._get(a,"dayNamesShort"),dayNames:this._get(a,"dayNames"),monthNamesShort:this._get(a,"monthNamesShort"),monthNames:this._get(a,"monthNames")}},_formatDate:function(a,b,c,d){b||(a.currentDay=a.selectedDay,a.currentMonth=a.selectedMonth,a.currentYear=a.selectedYear);var e=b?"object"==typeof b?b:this._daylightSavingAdjust(new Date(d,c,b)):this._daylightSavingAdjust(new Date(a.currentYear,a.currentMonth,a.currentDay));return this.formatDate(this._get(a,"dateFormat"),e,this._getFormatConfig(a))}}),a.fn.datepicker=function(b){if(!this.length)return this;a.datepicker.initialized||(a(document).mousedown(a.datepicker._checkExternalClick),a.datepicker.initialized=!0),0===a("#"+a.datepicker._mainDivId).length&&a("body").append(a.datepicker.dpDiv);var c=Array.prototype.slice.call(arguments,1);return"string"!=typeof b||"isDisabled"!==b&&"getDate"!==b&&"widget"!==b?"option"===b&&2===arguments.length&&"string"==typeof arguments[1]?a.datepicker["_"+b+"Datepicker"].apply(a.datepicker,[this[0]].concat(c)):this.each(function(){"string"==typeof b?a.datepicker["_"+b+"Datepicker"].apply(a.datepicker,[this].concat(c)):a.datepicker._attachDatepicker(this,b)}):a.datepicker["_"+b+"Datepicker"].apply(a.datepicker,[this[0]].concat(c))},a.datepicker=new c,a.datepicker.initialized=!1,a.datepicker.uuid=(new Date).getTime(),a.datepicker.version="1.10.3"}(jQuery),function(a){var b={buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},c={maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0};a.widget("ui.dialog",{version:"1.10.3",options:{appendTo:"body",autoOpen:!0,buttons:[],closeOnEscape:!0,closeText:"close",dialogClass:"",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(b){var c=a(this).css(b).offset().top;0>c&&a(this).css("top",b.top-c)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),this.options.title=this.options.title||this.originalTitle,this._createWrapper(),this.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(this.uiDialog),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&a.fn.draggable&&this._makeDraggable(),this.options.resizable&&a.fn.resizable&&this._makeResizable(),this._isOpen=!1},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var b=this.options.appendTo;return b&&(b.jquery||b.nodeType)?a(b):this.document.find(b||"body").eq(0)},_destroy:function(){var a,b=this.originalPosition;this._destroyOverlay(),this.element.removeUniqueId().removeClass("ui-dialog-content ui-widget-content").css(this.originalCss).detach(),this.uiDialog.stop(!0,!0).remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),a=b.parent.children().eq(b.index),a.length&&a[0]!==this.element[0]?a.before(this.element):b.parent.append(this.element)},widget:function(){return this.uiDialog},disable:a.noop,enable:a.noop,close:function(b){var c=this;this._isOpen&&this._trigger("beforeClose",b)!==!1&&(this._isOpen=!1,this._destroyOverlay(),this.opener.filter(":focusable").focus().length||a(this.document[0].activeElement).blur(),this._hide(this.uiDialog,this.options.hide,function(){c._trigger("close",b)}))},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(a,b){var c=!!this.uiDialog.nextAll(":visible").insertBefore(this.uiDialog).length;return c&&!b&&this._trigger("focus",a),c},open:function(){var b=this;return this._isOpen?void(this._moveToTop()&&this._focusTabbable()):(this._isOpen=!0,this.opener=a(this.document[0].activeElement),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this._show(this.uiDialog,this.options.show,function(){b._focusTabbable(),b._trigger("focus")}),void this._trigger("open"))},_focusTabbable:function(){var a=this.element.find("[autofocus]");a.length||(a=this.element.find(":tabbable")),a.length||(a=this.uiDialogButtonPane.find(":tabbable")),a.length||(a=this.uiDialogTitlebarClose.filter(":tabbable")),a.length||(a=this.uiDialog),a.eq(0).focus()},_keepFocus:function(b){function c(){var b=this.document[0].activeElement,c=this.uiDialog[0]===b||a.contains(this.uiDialog[0],b);c||this._focusTabbable()}b.preventDefault(),c.call(this),this._delay(c)},_createWrapper:function(){this.uiDialog=a("<div>").addClass("ui-dialog ui-widget ui-widget-content ui-corner-all ui-front "+this.options.dialogClass).hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._on(this.uiDialog,{keydown:function(b){if(this.options.closeOnEscape&&!b.isDefaultPrevented()&&b.keyCode&&b.keyCode===a.ui.keyCode.ESCAPE)return b.preventDefault(),void this.close(b);if(b.keyCode===a.ui.keyCode.TAB){var c=this.uiDialog.find(":tabbable"),d=c.filter(":first"),e=c.filter(":last");b.target!==e[0]&&b.target!==this.uiDialog[0]||b.shiftKey?b.target!==d[0]&&b.target!==this.uiDialog[0]||!b.shiftKey||(e.focus(1),b.preventDefault()):(d.focus(1),b.preventDefault())}},mousedown:function(a){this._moveToTop(a)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},_createTitlebar:function(){var b;this.uiDialogTitlebar=a("<div>").addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(this.uiDialog),this._on(this.uiDialogTitlebar,{mousedown:function(b){a(b.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.focus()}}),this.uiDialogTitlebarClose=a("<button></button>").button({label:this.options.closeText,icons:{primary:"ui-icon-closethick"},text:!1}).addClass("ui-dialog-titlebar-close").appendTo(this.uiDialogTitlebar),this._on(this.uiDialogTitlebarClose,{click:function(a){a.preventDefault(),this.close(a)}}),b=a("<span>").uniqueId().addClass("ui-dialog-title").prependTo(this.uiDialogTitlebar),this._title(b),this.uiDialog.attr({"aria-labelledby":b.attr("id")})},_title:function(a){this.options.title||a.html("&#160;"),a.text(this.options.title)},_createButtonPane:function(){this.uiDialogButtonPane=a("<div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"),this.uiButtonSet=a("<div>").addClass("ui-dialog-buttonset").appendTo(this.uiDialogButtonPane),this._createButtons()},_createButtons:function(){var b=this,c=this.options.buttons;return this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),a.isEmptyObject(c)||a.isArray(c)&&!c.length?void this.uiDialog.removeClass("ui-dialog-buttons"):(a.each(c,function(c,d){var e,f;d=a.isFunction(d)?{click:d,text:c}:d,d=a.extend({type:"button"},d),e=d.click,d.click=function(){e.apply(b.element[0],arguments)},f={icons:d.icons,text:d.showText},delete d.icons,delete d.showText,a("<button></button>",d).button(f).appendTo(b.uiButtonSet)}),this.uiDialog.addClass("ui-dialog-buttons"),void this.uiDialogButtonPane.appendTo(this.uiDialog))},_makeDraggable:function(){function b(a){return{position:a.position,offset:a.offset}}var c=this,d=this.options;this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(d,e){a(this).addClass("ui-dialog-dragging"),c._blockFrames(),c._trigger("dragStart",d,b(e))},drag:function(a,d){c._trigger("drag",a,b(d))},stop:function(e,f){d.position=[f.position.left-c.document.scrollLeft(),f.position.top-c.document.scrollTop()],a(this).removeClass("ui-dialog-dragging"),c._unblockFrames(),c._trigger("dragStop",e,b(f))}})},_makeResizable:function(){function b(a){return{originalPosition:a.originalPosition,originalSize:a.originalSize,position:a.position,size:a.size}}var c=this,d=this.options,e=d.resizable,f=this.uiDialog.css("position"),g="string"==typeof e?e:"n,e,s,w,se,sw,ne,nw";this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,maxWidth:d.maxWidth,maxHeight:d.maxHeight,minWidth:d.minWidth,minHeight:this._minHeight(),handles:g,start:function(d,e){a(this).addClass("ui-dialog-resizing"),c._blockFrames(),c._trigger("resizeStart",d,b(e))},resize:function(a,d){c._trigger("resize",a,b(d))},stop:function(e,f){d.height=a(this).height(),d.width=a(this).width(),a(this).removeClass("ui-dialog-resizing"),c._unblockFrames(),c._trigger("resizeStop",e,b(f))}}).css("position",f)},_minHeight:function(){var a=this.options;return"auto"===a.height?a.minHeight:Math.min(a.minHeight,a.height)},_position:function(){var a=this.uiDialog.is(":visible");a||this.uiDialog.show(),this.uiDialog.position(this.options.position),a||this.uiDialog.hide()},_setOptions:function(d){var e=this,f=!1,g={};a.each(d,function(a,d){e._setOption(a,d),a in b&&(f=!0),a in c&&(g[a]=d)}),f&&(this._size(),this._position()),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",g)},_setOption:function(a,b){var c,d,e=this.uiDialog;"dialogClass"===a&&e.removeClass(this.options.dialogClass).addClass(b),"disabled"!==a&&(this._super(a,b),"appendTo"===a&&this.uiDialog.appendTo(this._appendTo()),"buttons"===a&&this._createButtons(),"closeText"===a&&this.uiDialogTitlebarClose.button({label:""+b}),"draggable"===a&&(c=e.is(":data(ui-draggable)"),c&&!b&&e.draggable("destroy"),!c&&b&&this._makeDraggable()),"position"===a&&this._position(),"resizable"===a&&(d=e.is(":data(ui-resizable)"),d&&!b&&e.resizable("destroy"),d&&"string"==typeof b&&e.resizable("option","handles",b),d||b===!1||this._makeResizable()),"title"===a&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title")))},_size:function(){var a,b,c,d=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),d.minWidth>d.width&&(d.width=d.minWidth),a=this.uiDialog.css({height:"auto",width:d.width}).outerHeight(),b=Math.max(0,d.minHeight-a),c="number"==typeof d.maxHeight?Math.max(0,d.maxHeight-a):"none","auto"===d.height?this.element.css({minHeight:b,maxHeight:c,height:"auto"}):this.element.height(Math.max(0,d.height-a)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var b=a(this);return a("<div>").css({position:"absolute",width:b.outerWidth(),height:b.outerHeight()}).appendTo(b.parent()).offset(b.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(b){return a(b.target).closest(".ui-dialog").length?!0:!!a(b.target).closest(".ui-datepicker").length},_createOverlay:function(){if(this.options.modal){var b=this,c=this.widgetFullName;a.ui.dialog.overlayInstances||this._delay(function(){a.ui.dialog.overlayInstances&&this.document.bind("focusin.dialog",function(d){b._allowInteraction(d)||(d.preventDefault(),a(".ui-dialog:visible:last .ui-dialog-content").data(c)._focusTabbable())})}),this.overlay=a("<div>").addClass("ui-widget-overlay ui-front").appendTo(this._appendTo()),this._on(this.overlay,{mousedown:"_keepFocus"}),a.ui.dialog.overlayInstances++}},_destroyOverlay:function(){this.options.modal&&this.overlay&&(a.ui.dialog.overlayInstances--,a.ui.dialog.overlayInstances||this.document.unbind("focusin.dialog"),this.overlay.remove(),this.overlay=null)}}),a.ui.dialog.overlayInstances=0,a.uiBackCompat!==!1&&a.widget("ui.dialog",a.ui.dialog,{_position:function(){var b,c=this.options.position,d=[],e=[0,0];c?(("string"==typeof c||"object"==typeof c&&"0"in c)&&(d=c.split?c.split(" "):[c[0],c[1]],1===d.length&&(d[1]=d[0]),a.each(["left","top"],function(a,b){+d[a]===d[a]&&(e[a]=d[a],d[a]=b)}),c={my:d[0]+(0>e[0]?e[0]:"+"+e[0])+" "+d[1]+(0>e[1]?e[1]:"+"+e[1]),at:d.join(" ")}),c=a.extend({},a.ui.dialog.prototype.options.position,c)):c=a.ui.dialog.prototype.options.position,b=this.uiDialog.is(":visible"),b||this.uiDialog.show(),this.uiDialog.position(c),b||this.uiDialog.hide()}})}(jQuery),function(a){var b=/up|down|vertical/,c=/up|left|vertical|horizontal/;a.effects.effect.blind=function(d,e){var f,g,h,i=a(this),j=["position","top","bottom","left","right","height","width"],k=a.effects.setMode(i,d.mode||"hide"),l=d.direction||"up",m=b.test(l),n=m?"height":"width",o=m?"top":"left",p=c.test(l),q={},r="show"===k;i.parent().is(".ui-effects-wrapper")?a.effects.save(i.parent(),j):a.effects.save(i,j),i.show(),f=a.effects.createWrapper(i).css({overflow:"hidden"}),g=f[n](),h=parseFloat(f.css(o))||0,q[n]=r?g:0,p||(i.css(m?"bottom":"right",0).css(m?"top":"left","auto").css({position:"absolute"}),q[o]=r?h:g+h),r&&(f.css(n,0),p||f.css(o,h+g)),f.animate(q,{duration:d.duration,easing:d.easing,queue:!1,complete:function(){"hide"===k&&i.hide(),a.effects.restore(i,j),a.effects.removeWrapper(i),e()}})}}(jQuery),function(a){a.effects.effect.bounce=function(b,c){var d,e,f,g=a(this),h=["position","top","bottom","left","right","height","width"],i=a.effects.setMode(g,b.mode||"effect"),j="hide"===i,k="show"===i,l=b.direction||"up",m=b.distance,n=b.times||5,o=2*n+(k||j?1:0),p=b.duration/o,q=b.easing,r="up"===l||"down"===l?"top":"left",s="up"===l||"left"===l,t=g.queue(),u=t.length;for((k||j)&&h.push("opacity"),a.effects.save(g,h),g.show(),a.effects.createWrapper(g),m||(m=g["top"===r?"outerHeight":"outerWidth"]()/3),k&&(f={opacity:1},f[r]=0,g.css("opacity",0).css(r,s?2*-m:2*m).animate(f,p,q)),j&&(m/=Math.pow(2,n-1)),f={},f[r]=0,d=0;n>d;d++)e={},e[r]=(s?"-=":"+=")+m,g.animate(e,p,q).animate(f,p,q),m=j?2*m:m/2;j&&(e={opacity:0},e[r]=(s?"-=":"+=")+m,g.animate(e,p,q)),g.queue(function(){j&&g.hide(),a.effects.restore(g,h),a.effects.removeWrapper(g),c()}),u>1&&t.splice.apply(t,[1,0].concat(t.splice(u,o+1))),g.dequeue()}}(jQuery),function(a){a.effects.effect.clip=function(b,c){var d,e,f,g=a(this),h=["position","top","bottom","left","right","height","width"],i=a.effects.setMode(g,b.mode||"hide"),j="show"===i,k=b.direction||"vertical",l="vertical"===k,m=l?"height":"width",n=l?"top":"left",o={};a.effects.save(g,h),g.show(),d=a.effects.createWrapper(g).css({overflow:"hidden"}),e="IMG"===g[0].tagName?d:g,f=e[m](),j&&(e.css(m,0),e.css(n,f/2)),o[m]=j?f:0,o[n]=j?0:f/2,e.animate(o,{queue:!1,duration:b.duration,easing:b.easing,complete:function(){j||g.hide(),a.effects.restore(g,h),a.effects.removeWrapper(g),c()}})}}(jQuery),function(a){a.effects.effect.drop=function(b,c){var d,e=a(this),f=["position","top","bottom","left","right","opacity","height","width"],g=a.effects.setMode(e,b.mode||"hide"),h="show"===g,i=b.direction||"left",j="up"===i||"down"===i?"top":"left",k="up"===i||"left"===i?"pos":"neg",l={opacity:h?1:0};a.effects.save(e,f),e.show(),a.effects.createWrapper(e),d=b.distance||e["top"===j?"outerHeight":"outerWidth"](!0)/2,h&&e.css("opacity",0).css(j,"pos"===k?-d:d),l[j]=(h?"pos"===k?"+=":"-=":"pos"===k?"-=":"+=")+d,e.animate(l,{queue:!1,duration:b.duration,easing:b.easing,complete:function(){"hide"===g&&e.hide(),a.effects.restore(e,f),a.effects.removeWrapper(e),c()}})}}(jQuery),function(a){a.effects.effect.explode=function(b,c){function d(){t.push(this),t.length===l*m&&e()}function e(){n.css({visibility:"visible"}),a(t).remove(),p||n.hide(),c()}var f,g,h,i,j,k,l=b.pieces?Math.round(Math.sqrt(b.pieces)):3,m=l,n=a(this),o=a.effects.setMode(n,b.mode||"hide"),p="show"===o,q=n.show().css("visibility","hidden").offset(),r=Math.ceil(n.outerWidth()/m),s=Math.ceil(n.outerHeight()/l),t=[];for(f=0;l>f;f++)for(i=q.top+f*s,k=f-(l-1)/2,g=0;m>g;g++)h=q.left+g*r,j=g-(m-1)/2,n.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-g*r,top:-f*s}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:r,height:s,left:h+(p?j*r:0),top:i+(p?k*s:0),opacity:p?0:1}).animate({left:h+(p?0:j*r),top:i+(p?0:k*s),opacity:p?1:0},b.duration||500,b.easing,d)}}(jQuery),function(a){a.effects.effect.fade=function(b,c){var d=a(this),e=a.effects.setMode(d,b.mode||"toggle");d.animate({opacity:e},{queue:!1,duration:b.duration,easing:b.easing,complete:c})}}(jQuery),function(a){a.effects.effect.fold=function(b,c){var d,e,f=a(this),g=["position","top","bottom","left","right","height","width"],h=a.effects.setMode(f,b.mode||"hide"),i="show"===h,j="hide"===h,k=b.size||15,l=/([0-9]+)%/.exec(k),m=!!b.horizFirst,n=i!==m,o=n?["width","height"]:["height","width"],p=b.duration/2,q={},r={};a.effects.save(f,g),f.show(),d=a.effects.createWrapper(f).css({overflow:"hidden"}),e=n?[d.width(),d.height()]:[d.height(),d.width()],l&&(k=parseInt(l[1],10)/100*e[j?0:1]),i&&d.css(m?{height:0,width:k}:{height:k,width:0}),q[o[0]]=i?e[0]:k,r[o[1]]=i?e[1]:0,d.animate(q,p,b.easing).animate(r,p,b.easing,function(){j&&f.hide(),a.effects.restore(f,g),a.effects.removeWrapper(f),c()})}}(jQuery),function(a){a.effects.effect.highlight=function(b,c){var d=a(this),e=["backgroundImage","backgroundColor","opacity"],f=a.effects.setMode(d,b.mode||"show"),g={backgroundColor:d.css("backgroundColor")};"hide"===f&&(g.opacity=0),a.effects.save(d,e),d.show().css({backgroundImage:"none",backgroundColor:b.color||"#ffff99"}).animate(g,{queue:!1,duration:b.duration,easing:b.easing,complete:function(){"hide"===f&&d.hide(),a.effects.restore(d,e),c()}})}}(jQuery),function(a){a.effects.effect.pulsate=function(b,c){var d,e=a(this),f=a.effects.setMode(e,b.mode||"show"),g="show"===f,h="hide"===f,i=g||"hide"===f,j=2*(b.times||5)+(i?1:0),k=b.duration/j,l=0,m=e.queue(),n=m.length;for((g||!e.is(":visible"))&&(e.css("opacity",0).show(),l=1),d=1;j>d;d++)e.animate({opacity:l},k,b.easing),l=1-l;e.animate({opacity:l},k,b.easing),e.queue(function(){h&&e.hide(),c()}),n>1&&m.splice.apply(m,[1,0].concat(m.splice(n,j+1))),e.dequeue()}}(jQuery),function(a){a.effects.effect.puff=function(b,c){var d=a(this),e=a.effects.setMode(d,b.mode||"hide"),f="hide"===e,g=parseInt(b.percent,10)||150,h=g/100,i={height:d.height(),width:d.width(),outerHeight:d.outerHeight(),outerWidth:d.outerWidth()};a.extend(b,{effect:"scale",queue:!1,fade:!0,mode:e,complete:c,percent:f?g:100,from:f?i:{height:i.height*h,width:i.width*h,outerHeight:i.outerHeight*h,outerWidth:i.outerWidth*h}}),d.effect(b)},a.effects.effect.scale=function(b,c){var d=a(this),e=a.extend(!0,{},b),f=a.effects.setMode(d,b.mode||"effect"),g=parseInt(b.percent,10)||(0===parseInt(b.percent,10)?0:"hide"===f?0:100),h=b.direction||"both",i=b.origin,j={height:d.height(),width:d.width(),outerHeight:d.outerHeight(),outerWidth:d.outerWidth()},k={y:"horizontal"!==h?g/100:1,x:"vertical"!==h?g/100:1};e.effect="size",e.queue=!1,e.complete=c,"effect"!==f&&(e.origin=i||["middle","center"],e.restore=!0),e.from=b.from||("show"===f?{height:0,width:0,outerHeight:0,outerWidth:0}:j),e.to={height:j.height*k.y,width:j.width*k.x,outerHeight:j.outerHeight*k.y,outerWidth:j.outerWidth*k.x},e.fade&&("show"===f&&(e.from.opacity=0,e.to.opacity=1),"hide"===f&&(e.from.opacity=1,e.to.opacity=0)),d.effect(e)},a.effects.effect.size=function(b,c){var d,e,f,g=a(this),h=["position","top","bottom","left","right","width","height","overflow","opacity"],i=["position","top","bottom","left","right","overflow","opacity"],j=["width","height","overflow"],k=["fontSize"],l=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],m=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],n=a.effects.setMode(g,b.mode||"effect"),o=b.restore||"effect"!==n,p=b.scale||"both",q=b.origin||["middle","center"],r=g.css("position"),s=o?h:i,t={height:0,width:0,outerHeight:0,outerWidth:0};"show"===n&&g.show(),d={height:g.height(),width:g.width(),outerHeight:g.outerHeight(),outerWidth:g.outerWidth()},"toggle"===b.mode&&"show"===n?(g.from=b.to||t,g.to=b.from||d):(g.from=b.from||("show"===n?t:d),g.to=b.to||("hide"===n?t:d)),f={from:{y:g.from.height/d.height,x:g.from.width/d.width},to:{y:g.to.height/d.height,x:g.to.width/d.width}},("box"===p||"both"===p)&&(f.from.y!==f.to.y&&(s=s.concat(l),g.from=a.effects.setTransition(g,l,f.from.y,g.from),g.to=a.effects.setTransition(g,l,f.to.y,g.to)),f.from.x!==f.to.x&&(s=s.concat(m),g.from=a.effects.setTransition(g,m,f.from.x,g.from),g.to=a.effects.setTransition(g,m,f.to.x,g.to))),("content"===p||"both"===p)&&f.from.y!==f.to.y&&(s=s.concat(k).concat(j),g.from=a.effects.setTransition(g,k,f.from.y,g.from),g.to=a.effects.setTransition(g,k,f.to.y,g.to)),a.effects.save(g,s),g.show(),a.effects.createWrapper(g),g.css("overflow","hidden").css(g.from),q&&(e=a.effects.getBaseline(q,d),g.from.top=(d.outerHeight-g.outerHeight())*e.y,g.from.left=(d.outerWidth-g.outerWidth())*e.x,g.to.top=(d.outerHeight-g.to.outerHeight)*e.y,g.to.left=(d.outerWidth-g.to.outerWidth)*e.x),g.css(g.from),("content"===p||"both"===p)&&(l=l.concat(["marginTop","marginBottom"]).concat(k),m=m.concat(["marginLeft","marginRight"]),j=h.concat(l).concat(m),g.find("*[width]").each(function(){var c=a(this),d={height:c.height(),width:c.width(),outerHeight:c.outerHeight(),outerWidth:c.outerWidth()};o&&a.effects.save(c,j),c.from={height:d.height*f.from.y,width:d.width*f.from.x,outerHeight:d.outerHeight*f.from.y,outerWidth:d.outerWidth*f.from.x},c.to={height:d.height*f.to.y,width:d.width*f.to.x,outerHeight:d.height*f.to.y,outerWidth:d.width*f.to.x},f.from.y!==f.to.y&&(c.from=a.effects.setTransition(c,l,f.from.y,c.from),c.to=a.effects.setTransition(c,l,f.to.y,c.to)),f.from.x!==f.to.x&&(c.from=a.effects.setTransition(c,m,f.from.x,c.from),c.to=a.effects.setTransition(c,m,f.to.x,c.to)),c.css(c.from),c.animate(c.to,b.duration,b.easing,function(){o&&a.effects.restore(c,j)})})),g.animate(g.to,{queue:!1,duration:b.duration,easing:b.easing,complete:function(){0===g.to.opacity&&g.css("opacity",g.from.opacity),"hide"===n&&g.hide(),a.effects.restore(g,s),o||("static"===r?g.css({position:"relative",top:g.to.top,left:g.to.left}):a.each(["top","left"],function(a,b){g.css(b,function(b,c){var d=parseInt(c,10),e=a?g.to.left:g.to.top;return"auto"===c?e+"px":d+e+"px"})})),a.effects.removeWrapper(g),c()}})}}(jQuery),function(a){a.effects.effect.shake=function(b,c){var d,e=a(this),f=["position","top","bottom","left","right","height","width"],g=a.effects.setMode(e,b.mode||"effect"),h=b.direction||"left",i=b.distance||20,j=b.times||3,k=2*j+1,l=Math.round(b.duration/k),m="up"===h||"down"===h?"top":"left",n="up"===h||"left"===h,o={},p={},q={},r=e.queue(),s=r.length;for(a.effects.save(e,f),e.show(),a.effects.createWrapper(e),o[m]=(n?"-=":"+=")+i,p[m]=(n?"+=":"-=")+2*i,q[m]=(n?"-=":"+=")+2*i,e.animate(o,l,b.easing),d=1;j>d;d++)e.animate(p,l,b.easing).animate(q,l,b.easing);e.animate(p,l,b.easing).animate(o,l/2,b.easing).queue(function(){"hide"===g&&e.hide(),a.effects.restore(e,f),a.effects.removeWrapper(e),c()}),s>1&&r.splice.apply(r,[1,0].concat(r.splice(s,k+1))),e.dequeue()}}(jQuery),function(a){a.effects.effect.slide=function(b,c){var d,e=a(this),f=["position","top","bottom","left","right","width","height"],g=a.effects.setMode(e,b.mode||"show"),h="show"===g,i=b.direction||"left",j="up"===i||"down"===i?"top":"left",k="up"===i||"left"===i,l={};a.effects.save(e,f),e.show(),d=b.distance||e["top"===j?"outerHeight":"outerWidth"](!0),a.effects.createWrapper(e).css({overflow:"hidden"}),h&&e.css(j,k?isNaN(d)?"-"+d:-d:d),l[j]=(h?k?"+=":"-=":k?"-=":"+=")+d,e.animate(l,{queue:!1,duration:b.duration,easing:b.easing,complete:function(){"hide"===g&&e.hide(),a.effects.restore(e,f),a.effects.removeWrapper(e),c()}})}}(jQuery),function(a){a.effects.effect.transfer=function(b,c){var d=a(this),e=a(b.to),f="fixed"===e.css("position"),g=a("body"),h=f?g.scrollTop():0,i=f?g.scrollLeft():0,j=e.offset(),k={top:j.top-h,left:j.left-i,height:e.innerHeight(),width:e.innerWidth()},l=d.offset(),m=a("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(b.className).css({top:l.top-h,left:l.left-i,height:d.innerHeight(),width:d.innerWidth(),position:f?"fixed":"absolute"}).animate(k,b.duration,b.easing,function(){m.remove(),c()})}}(jQuery),function(a){a.widget("ui.menu",{version:"1.10.3",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-carat-1-e"},menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.element.uniqueId().addClass("ui-menu ui-widget ui-widget-content ui-corner-all").toggleClass("ui-menu-icons",!!this.element.find(".ui-icon").length).attr({role:this.options.role,tabIndex:0}).bind("click"+this.eventNamespace,a.proxy(function(a){this.options.disabled&&a.preventDefault()},this)),this.options.disabled&&this.element.addClass("ui-state-disabled").attr("aria-disabled","true"),this._on({"mousedown .ui-menu-item > a":function(a){a.preventDefault()},"click .ui-state-disabled > a":function(a){a.preventDefault()},"click .ui-menu-item:has(a)":function(b){var c=a(b.target).closest(".ui-menu-item");!this.mouseHandled&&c.not(".ui-state-disabled").length&&(this.mouseHandled=!0,this.select(b),c.has(".ui-menu").length?this.expand(b):this.element.is(":focus")||(this.element.trigger("focus",[!0]),this.active&&1===this.active.parents(".ui-menu").length&&clearTimeout(this.timer)))},"mouseenter .ui-menu-item":function(b){var c=a(b.currentTarget);c.siblings().children(".ui-state-active").removeClass("ui-state-active"),this.focus(b,c)},mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(a,b){var c=this.active||this.element.children(".ui-menu-item").eq(0);b||this.focus(a,c)},blur:function(b){this._delay(function(){a.contains(this.element[0],this.document[0].activeElement)||this.collapseAll(b)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(b){a(b.target).closest(".ui-menu").length||this.collapseAll(b),this.mouseHandled=!1}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all ui-menu-icons").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").removeAttr("aria-disabled").removeUniqueId().show(),this.element.find(".ui-menu-item").removeClass("ui-menu-item").removeAttr("role").removeAttr("aria-disabled").children("a").removeUniqueId().removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").children().each(function(){var b=a(this);b.data("ui-menu-submenu-carat")&&b.remove()}),this.element.find(".ui-menu-divider").removeClass("ui-menu-divider ui-widget-content")},_keydown:function(b){function c(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}var d,e,f,g,h,i=!0;switch(b.keyCode){case a.ui.keyCode.PAGE_UP:this.previousPage(b);break;case a.ui.keyCode.PAGE_DOWN:this.nextPage(b);break;case a.ui.keyCode.HOME:this._move("first","first",b);break;case a.ui.keyCode.END:this._move("last","last",b);break;case a.ui.keyCode.UP:this.previous(b);
break;case a.ui.keyCode.DOWN:this.next(b);break;case a.ui.keyCode.LEFT:this.collapse(b);break;case a.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(b);break;case a.ui.keyCode.ENTER:case a.ui.keyCode.SPACE:this._activate(b);break;case a.ui.keyCode.ESCAPE:this.collapse(b);break;default:i=!1,e=this.previousFilter||"",f=String.fromCharCode(b.keyCode),g=!1,clearTimeout(this.filterTimer),f===e?g=!0:f=e+f,h=RegExp("^"+c(f),"i"),d=this.activeMenu.children(".ui-menu-item").filter(function(){return h.test(a(this).children("a").text())}),d=g&&-1!==d.index(this.active.next())?this.active.nextAll(".ui-menu-item"):d,d.length||(f=String.fromCharCode(b.keyCode),h=RegExp("^"+c(f),"i"),d=this.activeMenu.children(".ui-menu-item").filter(function(){return h.test(a(this).children("a").text())})),d.length?(this.focus(b,d),d.length>1?(this.previousFilter=f,this.filterTimer=this._delay(function(){delete this.previousFilter},1e3)):delete this.previousFilter):delete this.previousFilter}i&&b.preventDefault()},_activate:function(a){this.active.is(".ui-state-disabled")||(this.active.children("a[aria-haspopup='true']").length?this.expand(a):this.select(a))},refresh:function(){var b,c=this.options.icons.submenu,d=this.element.find(this.options.menus);d.filter(":not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var b=a(this),d=b.prev("a"),e=a("<span>").addClass("ui-menu-icon ui-icon "+c).data("ui-menu-submenu-carat",!0);d.attr("aria-haspopup","true").prepend(e),b.attr("aria-labelledby",d.attr("id"))}),b=d.add(this.element),b.children(":not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation").children("a").uniqueId().addClass("ui-corner-all").attr({tabIndex:-1,role:this._itemRole()}),b.children(":not(.ui-menu-item)").each(function(){var b=a(this);/[^\-\u2014\u2013\s]/.test(b.text())||b.addClass("ui-widget-content ui-menu-divider")}),b.children(".ui-state-disabled").attr("aria-disabled","true"),this.active&&!a.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(a,b){"icons"===a&&this.element.find(".ui-menu-icon").removeClass(this.options.icons.submenu).addClass(b.submenu),this._super(a,b)},focus:function(a,b){var c,d;this.blur(a,a&&"focus"===a.type),this._scrollIntoView(b),this.active=b.first(),d=this.active.children("a").addClass("ui-state-focus"),this.options.role&&this.element.attr("aria-activedescendant",d.attr("id")),this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"),a&&"keydown"===a.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),c=b.children(".ui-menu"),c.length&&/^mouse/.test(a.type)&&this._startOpening(c),this.activeMenu=b.parent(),this._trigger("focus",a,{item:b})},_scrollIntoView:function(b){var c,d,e,f,g,h;this._hasScroll()&&(c=parseFloat(a.css(this.activeMenu[0],"borderTopWidth"))||0,d=parseFloat(a.css(this.activeMenu[0],"paddingTop"))||0,e=b.offset().top-this.activeMenu.offset().top-c-d,f=this.activeMenu.scrollTop(),g=this.activeMenu.height(),h=b.height(),0>e?this.activeMenu.scrollTop(f+e):e+h>g&&this.activeMenu.scrollTop(f+e-g+h))},blur:function(a,b){b||clearTimeout(this.timer),this.active&&(this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",a,{item:this.active}))},_startOpening:function(a){clearTimeout(this.timer),"true"===a.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(a)},this.delay))},_open:function(b){var c=a.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(b.parents(".ui-menu")).hide().attr("aria-hidden","true"),b.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(c)},collapseAll:function(b,c){clearTimeout(this.timer),this.timer=this._delay(function(){var d=c?this.element:a(b&&b.target).closest(this.element.find(".ui-menu"));d.length||(d=this.element),this._close(d),this.blur(b),this.activeMenu=d},this.delay)},_close:function(a){a||(a=this.active?this.active.parent():this.element),a.find(".ui-menu").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(a){var b=this.active&&this.active.parent().closest(".ui-menu-item",this.element);b&&b.length&&(this._close(),this.focus(a,b))},expand:function(a){var b=this.active&&this.active.children(".ui-menu ").children(".ui-menu-item").first();b&&b.length&&(this._open(b.parent()),this._delay(function(){this.focus(a,b)}))},next:function(a){this._move("next","first",a)},previous:function(a){this._move("prev","last",a)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(a,b,c){var d;this.active&&(d="first"===a||"last"===a?this.active["first"===a?"prevAll":"nextAll"](".ui-menu-item").eq(-1):this.active[a+"All"](".ui-menu-item").eq(0)),d&&d.length&&this.active||(d=this.activeMenu.children(".ui-menu-item")[b]()),this.focus(c,d)},nextPage:function(b){var c,d,e;return this.active?void(this.isLastItem()||(this._hasScroll()?(d=this.active.offset().top,e=this.element.height(),this.active.nextAll(".ui-menu-item").each(function(){return c=a(this),0>c.offset().top-d-e}),this.focus(b,c)):this.focus(b,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]()))):void this.next(b)},previousPage:function(b){var c,d,e;return this.active?void(this.isFirstItem()||(this._hasScroll()?(d=this.active.offset().top,e=this.element.height(),this.active.prevAll(".ui-menu-item").each(function(){return c=a(this),c.offset().top-d+e>0}),this.focus(b,c)):this.focus(b,this.activeMenu.children(".ui-menu-item").first()))):void this.next(b)},_hasScroll:function(){return this.element.outerHeight()<this.element.prop("scrollHeight")},select:function(b){this.active=this.active||a(b.target).closest(".ui-menu-item");var c={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(b,!0),this._trigger("select",b,c)}})}(jQuery),function(a,b){function c(a,b,c){return[parseFloat(a[0])*(n.test(a[0])?b/100:1),parseFloat(a[1])*(n.test(a[1])?c/100:1)]}function d(b,c){return parseInt(a.css(b,c),10)||0}function e(b){var c=b[0];return 9===c.nodeType?{width:b.width(),height:b.height(),offset:{top:0,left:0}}:a.isWindow(c)?{width:b.width(),height:b.height(),offset:{top:b.scrollTop(),left:b.scrollLeft()}}:c.preventDefault?{width:0,height:0,offset:{top:c.pageY,left:c.pageX}}:{width:b.outerWidth(),height:b.outerHeight(),offset:b.offset()}}a.ui=a.ui||{};var f,g=Math.max,h=Math.abs,i=Math.round,j=/left|center|right/,k=/top|center|bottom/,l=/[\+\-]\d+(\.[\d]+)?%?/,m=/^\w+/,n=/%$/,o=a.fn.position;a.position={scrollbarWidth:function(){if(f!==b)return f;var c,d,e=a("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),g=e.children()[0];return a("body").append(e),c=g.offsetWidth,e.css("overflow","scroll"),d=g.offsetWidth,c===d&&(d=e[0].clientWidth),e.remove(),f=c-d},getScrollInfo:function(b){var c=b.isWindow?"":b.element.css("overflow-x"),d=b.isWindow?"":b.element.css("overflow-y"),e="scroll"===c||"auto"===c&&b.width<b.element[0].scrollWidth,f="scroll"===d||"auto"===d&&b.height<b.element[0].scrollHeight;return{width:f?a.position.scrollbarWidth():0,height:e?a.position.scrollbarWidth():0}},getWithinInfo:function(b){var c=a(b||window),d=a.isWindow(c[0]);return{element:c,isWindow:d,offset:c.offset()||{left:0,top:0},scrollLeft:c.scrollLeft(),scrollTop:c.scrollTop(),width:d?c.width():c.outerWidth(),height:d?c.height():c.outerHeight()}}},a.fn.position=function(b){if(!b||!b.of)return o.apply(this,arguments);b=a.extend({},b);var f,n,p,q,r,s,t=a(b.of),u=a.position.getWithinInfo(b.within),v=a.position.getScrollInfo(u),w=(b.collision||"flip").split(" "),x={};return s=e(t),t[0].preventDefault&&(b.at="left top"),n=s.width,p=s.height,q=s.offset,r=a.extend({},q),a.each(["my","at"],function(){var a,c,d=(b[this]||"").split(" ");1===d.length&&(d=j.test(d[0])?d.concat(["center"]):k.test(d[0])?["center"].concat(d):["center","center"]),d[0]=j.test(d[0])?d[0]:"center",d[1]=k.test(d[1])?d[1]:"center",a=l.exec(d[0]),c=l.exec(d[1]),x[this]=[a?a[0]:0,c?c[0]:0],b[this]=[m.exec(d[0])[0],m.exec(d[1])[0]]}),1===w.length&&(w[1]=w[0]),"right"===b.at[0]?r.left+=n:"center"===b.at[0]&&(r.left+=n/2),"bottom"===b.at[1]?r.top+=p:"center"===b.at[1]&&(r.top+=p/2),f=c(x.at,n,p),r.left+=f[0],r.top+=f[1],this.each(function(){var e,j,k=a(this),l=k.outerWidth(),m=k.outerHeight(),o=d(this,"marginLeft"),s=d(this,"marginTop"),y=l+o+d(this,"marginRight")+v.width,z=m+s+d(this,"marginBottom")+v.height,A=a.extend({},r),B=c(x.my,k.outerWidth(),k.outerHeight());"right"===b.my[0]?A.left-=l:"center"===b.my[0]&&(A.left-=l/2),"bottom"===b.my[1]?A.top-=m:"center"===b.my[1]&&(A.top-=m/2),A.left+=B[0],A.top+=B[1],a.support.offsetFractions||(A.left=i(A.left),A.top=i(A.top)),e={marginLeft:o,marginTop:s},a.each(["left","top"],function(c,d){a.ui.position[w[c]]&&a.ui.position[w[c]][d](A,{targetWidth:n,targetHeight:p,elemWidth:l,elemHeight:m,collisionPosition:e,collisionWidth:y,collisionHeight:z,offset:[f[0]+B[0],f[1]+B[1]],my:b.my,at:b.at,within:u,elem:k})}),b.using&&(j=function(a){var c=q.left-A.left,d=c+n-l,e=q.top-A.top,f=e+p-m,i={target:{element:t,left:q.left,top:q.top,width:n,height:p},element:{element:k,left:A.left,top:A.top,width:l,height:m},horizontal:0>d?"left":c>0?"right":"center",vertical:0>f?"top":e>0?"bottom":"middle"};l>n&&n>h(c+d)&&(i.horizontal="center"),m>p&&p>h(e+f)&&(i.vertical="middle"),i.important=g(h(c),h(d))>g(h(e),h(f))?"horizontal":"vertical",b.using.call(this,a,i)}),k.offset(a.extend(A,{using:j}))})},a.ui.position={fit:{left:function(a,b){var c,d=b.within,e=d.isWindow?d.scrollLeft:d.offset.left,f=d.width,h=a.left-b.collisionPosition.marginLeft,i=e-h,j=h+b.collisionWidth-f-e;b.collisionWidth>f?i>0&&0>=j?(c=a.left+i+b.collisionWidth-f-e,a.left+=i-c):a.left=j>0&&0>=i?e:i>j?e+f-b.collisionWidth:e:i>0?a.left+=i:j>0?a.left-=j:a.left=g(a.left-h,a.left)},top:function(a,b){var c,d=b.within,e=d.isWindow?d.scrollTop:d.offset.top,f=b.within.height,h=a.top-b.collisionPosition.marginTop,i=e-h,j=h+b.collisionHeight-f-e;b.collisionHeight>f?i>0&&0>=j?(c=a.top+i+b.collisionHeight-f-e,a.top+=i-c):a.top=j>0&&0>=i?e:i>j?e+f-b.collisionHeight:e:i>0?a.top+=i:j>0?a.top-=j:a.top=g(a.top-h,a.top)}},flip:{left:function(a,b){var c,d,e=b.within,f=e.offset.left+e.scrollLeft,g=e.width,i=e.isWindow?e.scrollLeft:e.offset.left,j=a.left-b.collisionPosition.marginLeft,k=j-i,l=j+b.collisionWidth-g-i,m="left"===b.my[0]?-b.elemWidth:"right"===b.my[0]?b.elemWidth:0,n="left"===b.at[0]?b.targetWidth:"right"===b.at[0]?-b.targetWidth:0,o=-2*b.offset[0];0>k?(c=a.left+m+n+o+b.collisionWidth-g-f,(0>c||h(k)>c)&&(a.left+=m+n+o)):l>0&&(d=a.left-b.collisionPosition.marginLeft+m+n+o-i,(d>0||l>h(d))&&(a.left+=m+n+o))},top:function(a,b){var c,d,e=b.within,f=e.offset.top+e.scrollTop,g=e.height,i=e.isWindow?e.scrollTop:e.offset.top,j=a.top-b.collisionPosition.marginTop,k=j-i,l=j+b.collisionHeight-g-i,m="top"===b.my[1],n=m?-b.elemHeight:"bottom"===b.my[1]?b.elemHeight:0,o="top"===b.at[1]?b.targetHeight:"bottom"===b.at[1]?-b.targetHeight:0,p=-2*b.offset[1];0>k?(d=a.top+n+o+p+b.collisionHeight-g-f,a.top+n+o+p>k&&(0>d||h(k)>d)&&(a.top+=n+o+p)):l>0&&(c=a.top-b.collisionPosition.marginTop+n+o+p-i,a.top+n+o+p>l&&(c>0||l>h(c))&&(a.top+=n+o+p))}},flipfit:{left:function(){a.ui.position.flip.left.apply(this,arguments),a.ui.position.fit.left.apply(this,arguments)},top:function(){a.ui.position.flip.top.apply(this,arguments),a.ui.position.fit.top.apply(this,arguments)}}},function(){var b,c,d,e,f,g=document.getElementsByTagName("body")[0],h=document.createElement("div");b=document.createElement(g?"div":"body"),d={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},g&&a.extend(d,{position:"absolute",left:"-1000px",top:"-1000px"});for(f in d)b.style[f]=d[f];b.appendChild(h),c=g||document.documentElement,c.insertBefore(b,c.firstChild),h.style.cssText="position: absolute; left: 10.7432222px;",e=a(h).offset().left,a.support.offsetFractions=e>10&&11>e,b.innerHTML="",c.removeChild(b)}()}(jQuery),function(a,b){a.widget("ui.progressbar",{version:"1.10.3",options:{max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min}),this.valueDiv=a("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element),this._refreshValue()},_destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove()},value:function(a){return a===b?this.options.value:(this.options.value=this._constrainedValue(a),this._refreshValue(),b)},_constrainedValue:function(a){return a===b&&(a=this.options.value),this.indeterminate=a===!1,"number"!=typeof a&&(a=0),this.indeterminate?!1:Math.min(this.options.max,Math.max(this.min,a))},_setOptions:function(a){var b=a.value;delete a.value,this._super(a),this.options.value=this._constrainedValue(b),this._refreshValue()},_setOption:function(a,b){"max"===a&&(b=Math.max(this.min,b)),this._super(a,b)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var b=this.options.value,c=this._percentage();this.valueDiv.toggle(this.indeterminate||b>this.min).toggleClass("ui-corner-right",b===this.options.max).width(c.toFixed(0)+"%"),this.element.toggleClass("ui-progressbar-indeterminate",this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=a("<div class='ui-progressbar-overlay'></div>").appendTo(this.valueDiv))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":b}),this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==b&&(this.oldValue=b,this._trigger("change")),b===this.options.max&&this._trigger("complete")}})}(jQuery),function(a){var b=5;a.widget("ui.slider",a.ui.mouse,{version:"1.10.3",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var b,c,d=this.options,e=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),f="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",g=[];for(c=d.values&&d.values.length||1,e.length>c&&(e.slice(c).remove(),e=e.slice(0,c)),b=e.length;c>b;b++)g.push(f);this.handles=e.add(a(g.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(b){a(this).data("ui-slider-handle-index",b)})},_createRange:function(){var b=this.options,c="";b.range?(b.range===!0&&(b.values?b.values.length&&2!==b.values.length?b.values=[b.values[0],b.values[0]]:a.isArray(b.values)&&(b.values=b.values.slice(0)):b.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=a("<div></div>").appendTo(this.element),c="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(c+("min"===b.range||"max"===b.range?" ui-slider-range-"+b.range:""))):this.range=a([])},_setupEvents:function(){var a=this.handles.add(this.range).filter("a");this._off(a),this._on(a,this._handleEvents),this._hoverable(a),this._focusable(a)},_destroy:function(){this.handles.remove(),this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(b){var c,d,e,f,g,h,i,j,k=this,l=this.options;return l.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),c={x:b.pageX,y:b.pageY},d=this._normValueFromMouse(c),e=this._valueMax()-this._valueMin()+1,this.handles.each(function(b){var c=Math.abs(d-k.values(b));(e>c||e===c&&(b===k._lastChangedValue||k.values(b)===l.min))&&(e=c,f=a(this),g=b)}),h=this._start(b,g),h===!1?!1:(this._mouseSliding=!0,this._handleIndex=g,f.addClass("ui-state-active").focus(),i=f.offset(),j=!a(b.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=j?{left:0,top:0}:{left:b.pageX-i.left-f.width()/2,top:b.pageY-i.top-f.height()/2-(parseInt(f.css("borderTopWidth"),10)||0)-(parseInt(f.css("borderBottomWidth"),10)||0)+(parseInt(f.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(b,g,d),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(a){var b={x:a.pageX,y:a.pageY},c=this._normValueFromMouse(b);return this._slide(a,this._handleIndex,c),!1},_mouseStop:function(a){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(a,this._handleIndex),this._change(a,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(a){var b,c,d,e,f;return"horizontal"===this.orientation?(b=this.elementSize.width,c=a.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(b=this.elementSize.height,c=a.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),d=c/b,d>1&&(d=1),0>d&&(d=0),"vertical"===this.orientation&&(d=1-d),e=this._valueMax()-this._valueMin(),f=this._valueMin()+d*e,this._trimAlignValue(f)},_start:function(a,b){var c={handle:this.handles[b],value:this.value()};return this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._trigger("start",a,c)},_slide:function(a,b,c){var d,e,f;this.options.values&&this.options.values.length?(d=this.values(b?0:1),2===this.options.values.length&&this.options.range===!0&&(0===b&&c>d||1===b&&d>c)&&(c=d),c!==this.values(b)&&(e=this.values(),e[b]=c,f=this._trigger("slide",a,{handle:this.handles[b],value:c,values:e}),d=this.values(b?0:1),f!==!1&&this.values(b,c,!0))):c!==this.value()&&(f=this._trigger("slide",a,{handle:this.handles[b],value:c}),f!==!1&&this.value(c))},_stop:function(a,b){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._trigger("stop",a,c)},_change:function(a,b){if(!this._keySliding&&!this._mouseSliding){var c={handle:this.handles[b],value:this.value()};this.options.values&&this.options.values.length&&(c.value=this.values(b),c.values=this.values()),this._lastChangedValue=b,this._trigger("change",a,c)}},value:function(a){return arguments.length?(this.options.value=this._trimAlignValue(a),this._refreshValue(),void this._change(null,0)):this._value()},values:function(b,c){var d,e,f;if(arguments.length>1)return this.options.values[b]=this._trimAlignValue(c),this._refreshValue(),void this._change(null,b);if(!arguments.length)return this._values();if(!a.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(b):this.value();for(d=this.options.values,e=arguments[0],f=0;d.length>f;f+=1)d[f]=this._trimAlignValue(e[f]),this._change(null,f);this._refreshValue()},_setOption:function(b,c){var d,e=0;switch("range"===b&&this.options.range===!0&&("min"===c?(this.options.value=this._values(0),this.options.values=null):"max"===c&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),a.isArray(this.options.values)&&(e=this.options.values.length),a.Widget.prototype._setOption.apply(this,arguments),b){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),d=0;e>d;d+=1)this._change(null,d);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var a=this.options.value;return a=this._trimAlignValue(a)},_values:function(a){var b,c,d;if(arguments.length)return b=this.options.values[a],b=this._trimAlignValue(b);if(this.options.values&&this.options.values.length){for(c=this.options.values.slice(),d=0;c.length>d;d+=1)c[d]=this._trimAlignValue(c[d]);return c}return[]},_trimAlignValue:function(a){if(this._valueMin()>=a)return this._valueMin();if(a>=this._valueMax())return this._valueMax();var b=this.options.step>0?this.options.step:1,c=(a-this._valueMin())%b,d=a-c;return 2*Math.abs(c)>=b&&(d+=c>0?b:-b),parseFloat(d.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var b,c,d,e,f,g=this.options.range,h=this.options,i=this,j=this._animateOff?!1:h.animate,k={};this.options.values&&this.options.values.length?this.handles.each(function(d){c=100*((i.values(d)-i._valueMin())/(i._valueMax()-i._valueMin())),k["horizontal"===i.orientation?"left":"bottom"]=c+"%",a(this).stop(1,1)[j?"animate":"css"](k,h.animate),i.options.range===!0&&("horizontal"===i.orientation?(0===d&&i.range.stop(1,1)[j?"animate":"css"]({left:c+"%"},h.animate),1===d&&i.range[j?"animate":"css"]({width:c-b+"%"},{queue:!1,duration:h.animate})):(0===d&&i.range.stop(1,1)[j?"animate":"css"]({bottom:c+"%"},h.animate),1===d&&i.range[j?"animate":"css"]({height:c-b+"%"},{queue:!1,duration:h.animate}))),b=c}):(d=this.value(),e=this._valueMin(),f=this._valueMax(),c=f!==e?100*((d-e)/(f-e)):0,k["horizontal"===this.orientation?"left":"bottom"]=c+"%",this.handle.stop(1,1)[j?"animate":"css"](k,h.animate),"min"===g&&"horizontal"===this.orientation&&this.range.stop(1,1)[j?"animate":"css"]({width:c+"%"},h.animate),"max"===g&&"horizontal"===this.orientation&&this.range[j?"animate":"css"]({width:100-c+"%"},{queue:!1,duration:h.animate}),"min"===g&&"vertical"===this.orientation&&this.range.stop(1,1)[j?"animate":"css"]({height:c+"%"},h.animate),"max"===g&&"vertical"===this.orientation&&this.range[j?"animate":"css"]({height:100-c+"%"},{queue:!1,duration:h.animate}))},_handleEvents:{keydown:function(c){var d,e,f,g,h=a(c.target).data("ui-slider-handle-index");switch(c.keyCode){case a.ui.keyCode.HOME:case a.ui.keyCode.END:case a.ui.keyCode.PAGE_UP:case a.ui.keyCode.PAGE_DOWN:case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(c.preventDefault(),!this._keySliding&&(this._keySliding=!0,a(c.target).addClass("ui-state-active"),d=this._start(c,h),d===!1))return}switch(g=this.options.step,e=f=this.options.values&&this.options.values.length?this.values(h):this.value(),c.keyCode){case a.ui.keyCode.HOME:f=this._valueMin();break;case a.ui.keyCode.END:f=this._valueMax();break;case a.ui.keyCode.PAGE_UP:f=this._trimAlignValue(e+(this._valueMax()-this._valueMin())/b);break;case a.ui.keyCode.PAGE_DOWN:f=this._trimAlignValue(e-(this._valueMax()-this._valueMin())/b);break;case a.ui.keyCode.UP:case a.ui.keyCode.RIGHT:if(e===this._valueMax())return;f=this._trimAlignValue(e+g);break;case a.ui.keyCode.DOWN:case a.ui.keyCode.LEFT:if(e===this._valueMin())return;f=this._trimAlignValue(e-g)}this._slide(c,h,f)},click:function(a){a.preventDefault()},keyup:function(b){var c=a(b.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(b,c),this._change(b,c),a(b.target).removeClass("ui-state-active"))}}})}(jQuery),function(a){function b(a){return function(){var b=this.element.val();a.apply(this,arguments),this._refresh(),b!==this.element.val()&&this._trigger("change")}}a.widget("ui.spinner",{version:"1.10.3",defaultElement:"<input>",widgetEventPrefix:"spin",options:{culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var b={},c=this.element;return a.each(["min","max","step"],function(a,d){var e=c.attr(d);void 0!==e&&e.length&&(b[d]=e)}),b},_events:{keydown:function(a){this._start(a)&&this._keydown(a)&&a.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(a){return this.cancelBlur?void delete this.cancelBlur:(this._stop(),this._refresh(),void(this.previous!==this.element.val()&&this._trigger("change",a)))},mousewheel:function(a,b){if(b){if(!this.spinning&&!this._start(a))return!1;this._spin((b>0?1:-1)*this.options.step,a),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(a)},100),a.preventDefault()}},"mousedown .ui-spinner-button":function(b){function c(){var a=this.element[0]===this.document[0].activeElement;a||(this.element.focus(),this.previous=d,this._delay(function(){this.previous=d}))}var d;d=this.element[0]===this.document[0].activeElement?this.previous:this.element.val(),b.preventDefault(),c.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,c.call(this)}),this._start(b)!==!1&&this._repeat(null,a(b.currentTarget).hasClass("ui-spinner-up")?1:-1,b)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(b){return a(b.currentTarget).hasClass("ui-state-active")?this._start(b)===!1?!1:void this._repeat(null,a(b.currentTarget).hasClass("ui-spinner-up")?1:-1,b):void 0},"mouseleave .ui-spinner-button":"_stop"},_draw:function(){var a=this.uiSpinner=this.element.addClass("ui-spinner-input").attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml());this.element.attr("role","spinbutton"),this.buttons=a.find(".ui-spinner-button").attr("tabIndex",-1).button().removeClass("ui-corner-all"),this.buttons.height()>Math.ceil(.5*a.height())&&a.height()>0&&a.height(a.height()),this.options.disabled&&this.disable()},_keydown:function(b){var c=this.options,d=a.ui.keyCode;switch(b.keyCode){case d.UP:return this._repeat(null,1,b),!0;case d.DOWN:return this._repeat(null,-1,b),!0;case d.PAGE_UP:return this._repeat(null,c.page,b),!0;case d.PAGE_DOWN:return this._repeat(null,-c.page,b),!0}return!1},_uiSpinnerHtml:function(){return"<span class='ui-spinner ui-widget ui-widget-content ui-corner-all'></span>"},_buttonHtml:function(){return"<a class='ui-spinner-button ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icons.up+"'>&#9650;</span></a><a class='ui-spinner-button ui-spinner-down ui-corner-br'><span class='ui-icon "+this.options.icons.down+"'>&#9660;</span></a>"},_start:function(a){return this.spinning||this._trigger("start",a)!==!1?(this.counter||(this.counter=1),this.spinning=!0,!0):!1},_repeat:function(a,b,c){a=a||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,b,c)},a),this._spin(b*this.options.step,c)},_spin:function(a,b){var c=this.value()||0;this.counter||(this.counter=1),c=this._adjustValue(c+a*this._increment(this.counter)),this.spinning&&this._trigger("spin",b,{value:c})===!1||(this._value(c),this.counter++)},_increment:function(b){var c=this.options.incremental;return c?a.isFunction(c)?c(b):Math.floor(b*b*b/5e4-b*b/500+17*b/200+1):1},_precision:function(){var a=this._precisionOf(this.options.step);return null!==this.options.min&&(a=Math.max(a,this._precisionOf(this.options.min))),a},_precisionOf:function(a){var b=""+a,c=b.indexOf(".");return-1===c?0:b.length-c-1},_adjustValue:function(a){var b,c,d=this.options;return b=null!==d.min?d.min:0,c=a-b,c=Math.round(c/d.step)*d.step,a=b+c,a=parseFloat(a.toFixed(this._precision())),null!==d.max&&a>d.max?d.max:null!==d.min&&d.min>a?d.min:a},_stop:function(a){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",a))},_setOption:function(a,b){if("culture"===a||"numberFormat"===a){var c=this._parse(this.element.val());return this.options[a]=b,void this.element.val(this._format(c))}("max"===a||"min"===a||"step"===a)&&"string"==typeof b&&(b=this._parse(b)),"icons"===a&&(this.buttons.first().find(".ui-icon").removeClass(this.options.icons.up).addClass(b.up),this.buttons.last().find(".ui-icon").removeClass(this.options.icons.down).addClass(b.down)),this._super(a,b),"disabled"===a&&(b?(this.element.prop("disabled",!0),this.buttons.button("disable")):(this.element.prop("disabled",!1),this.buttons.button("enable")))},_setOptions:b(function(a){this._super(a),this._value(this.element.val())}),_parse:function(a){return"string"==typeof a&&""!==a&&(a=window.Globalize&&this.options.numberFormat?Globalize.parseFloat(a,10,this.options.culture):+a),""===a||isNaN(a)?null:a},_format:function(a){return""===a?"":window.Globalize&&this.options.numberFormat?Globalize.format(a,this.options.numberFormat,this.options.culture):a},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},_value:function(a,b){var c;""!==a&&(c=this._parse(a),null!==c&&(b||(c=this._adjustValue(c)),a=this._format(c))),this.element.val(a),this._refresh()},_destroy:function(){this.element.removeClass("ui-spinner-input").prop("disabled",!1).removeAttr("autocomplete").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.uiSpinner.replaceWith(this.element)},stepUp:b(function(a){this._stepUp(a)}),_stepUp:function(a){this._start()&&(this._spin((a||1)*this.options.step),this._stop())},stepDown:b(function(a){this._stepDown(a)}),_stepDown:function(a){this._start()&&(this._spin((a||1)*-this.options.step),this._stop())},pageUp:b(function(a){this._stepUp((a||1)*this.options.page)}),pageDown:b(function(a){this._stepDown((a||1)*this.options.page)}),value:function(a){return arguments.length?void b(this._value).call(this,a):this._parse(this.element.val())},widget:function(){return this.uiSpinner}})}(jQuery),function(a,b){function c(){return++e}function d(a){return a.hash.length>1&&decodeURIComponent(a.href.replace(f,""))===decodeURIComponent(location.href.replace(f,""))}var e=0,f=/#.*$/;a.widget("ui.tabs",{version:"1.10.3",delay:300,options:{active:null,collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_create:function(){var b=this,c=this.options;this.running=!1,this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all").toggleClass("ui-tabs-collapsible",c.collapsible).delegate(".ui-tabs-nav > li","mousedown"+this.eventNamespace,function(b){a(this).is(".ui-state-disabled")&&b.preventDefault()}).delegate(".ui-tabs-anchor","focus"+this.eventNamespace,function(){a(this).closest("li").is(".ui-state-disabled")&&this.blur();
}),this._processTabs(),c.active=this._initialActive(),a.isArray(c.disabled)&&(c.disabled=a.unique(c.disabled.concat(a.map(this.tabs.filter(".ui-state-disabled"),function(a){return b.tabs.index(a)}))).sort()),this.active=this.options.active!==!1&&this.anchors.length?this._findActive(c.active):a(),this._refresh(),this.active.length&&this.load(c.active)},_initialActive:function(){var c=this.options.active,d=this.options.collapsible,e=location.hash.substring(1);return null===c&&(e&&this.tabs.each(function(d,f){return a(f).attr("aria-controls")===e?(c=d,!1):b}),null===c&&(c=this.tabs.index(this.tabs.filter(".ui-tabs-active"))),(null===c||-1===c)&&(c=this.tabs.length?0:!1)),c!==!1&&(c=this.tabs.index(this.tabs.eq(c)),-1===c&&(c=d?!1:0)),!d&&c===!1&&this.anchors.length&&(c=0),c},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):a()}},_tabKeydown:function(c){var d=a(this.document[0].activeElement).closest("li"),e=this.tabs.index(d),f=!0;if(!this._handlePageNav(c)){switch(c.keyCode){case a.ui.keyCode.RIGHT:case a.ui.keyCode.DOWN:e++;break;case a.ui.keyCode.UP:case a.ui.keyCode.LEFT:f=!1,e--;break;case a.ui.keyCode.END:e=this.anchors.length-1;break;case a.ui.keyCode.HOME:e=0;break;case a.ui.keyCode.SPACE:return c.preventDefault(),clearTimeout(this.activating),this._activate(e),b;case a.ui.keyCode.ENTER:return c.preventDefault(),clearTimeout(this.activating),this._activate(e===this.options.active?!1:e),b;default:return}c.preventDefault(),clearTimeout(this.activating),e=this._focusNextTab(e,f),c.ctrlKey||(d.attr("aria-selected","false"),this.tabs.eq(e).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",e)},this.delay))}},_panelKeydown:function(b){this._handlePageNav(b)||b.ctrlKey&&b.keyCode===a.ui.keyCode.UP&&(b.preventDefault(),this.active.focus())},_handlePageNav:function(c){return c.altKey&&c.keyCode===a.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-1,!1)),!0):c.altKey&&c.keyCode===a.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):b},_findNextTab:function(b,c){function d(){return b>e&&(b=0),0>b&&(b=e),b}for(var e=this.tabs.length-1;-1!==a.inArray(d(),this.options.disabled);)b=c?b+1:b-1;return b},_focusNextTab:function(a,b){return a=this._findNextTab(a,b),this.tabs.eq(a).focus(),a},_setOption:function(a,c){return"active"===a?(this._activate(c),b):"disabled"===a?(this._setupDisabled(c),b):(this._super(a,c),"collapsible"===a&&(this.element.toggleClass("ui-tabs-collapsible",c),c||this.options.active!==!1||this._activate(0)),"event"===a&&this._setupEvents(c),"heightStyle"===a&&this._setupHeightStyle(c),b)},_tabId:function(a){return a.attr("aria-controls")||"ui-tabs-"+c()},_sanitizeSelector:function(a){return a?a.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var b=this.options,c=this.tablist.children(":has(a[href])");b.disabled=a.map(c.filter(".ui-state-disabled"),function(a){return c.index(a)}),this._processTabs(),b.active!==!1&&this.anchors.length?this.active.length&&!a.contains(this.tablist[0],this.active[0])?this.tabs.length===b.disabled.length?(b.active=!1,this.active=a()):this._activate(this._findNextTab(Math.max(0,b.active-1),!1)):b.active=this.tabs.index(this.active):(b.active=!1,this.active=a()),this._refresh()},_refresh:function(){this._setupDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-expanded":"false","aria-hidden":"true"}),this.active.length?(this.active.addClass("ui-tabs-active ui-state-active").attr({"aria-selected":"true",tabIndex:0}),this._getPanelForTab(this.active).show().attr({"aria-expanded":"true","aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var b=this;this.tablist=this._getList().addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").attr("role","tablist"),this.tabs=this.tablist.find("> li:has(a[href])").addClass("ui-state-default ui-corner-top").attr({role:"tab",tabIndex:-1}),this.anchors=this.tabs.map(function(){return a("a",this)[0]}).addClass("ui-tabs-anchor").attr({role:"presentation",tabIndex:-1}),this.panels=a(),this.anchors.each(function(c,e){var f,g,h,i=a(e).uniqueId().attr("id"),j=a(e).closest("li"),k=j.attr("aria-controls");d(e)?(f=e.hash,g=b.element.find(b._sanitizeSelector(f))):(h=b._tabId(j),f="#"+h,g=b.element.find(f),g.length||(g=b._createPanel(h),g.insertAfter(b.panels[c-1]||b.tablist)),g.attr("aria-live","polite")),g.length&&(b.panels=b.panels.add(g)),k&&j.data("ui-tabs-aria-controls",k),j.attr({"aria-controls":f.substring(1),"aria-labelledby":i}),g.attr("aria-labelledby",i)}),this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").attr("role","tabpanel")},_getList:function(){return this.element.find("ol,ul").eq(0)},_createPanel:function(b){return a("<div>").attr("id",b).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").data("ui-tabs-destroy",!0)},_setupDisabled:function(b){a.isArray(b)&&(b.length?b.length===this.anchors.length&&(b=!0):b=!1);for(var c,d=0;c=this.tabs[d];d++)b===!0||-1!==a.inArray(d,b)?a(c).addClass("ui-state-disabled").attr("aria-disabled","true"):a(c).removeClass("ui-state-disabled").removeAttr("aria-disabled");this.options.disabled=b},_setupEvents:function(b){var c={click:function(a){a.preventDefault()}};b&&a.each(b.split(" "),function(a,b){c[b]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(this.anchors,c),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(b){var c,d=this.element.parent();"fill"===b?(c=d.height(),c-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var b=a(this),d=b.css("position");"absolute"!==d&&"fixed"!==d&&(c-=b.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){c-=a(this).outerHeight(!0)}),this.panels.each(function(){a(this).height(Math.max(0,c-a(this).innerHeight()+a(this).height()))}).css("overflow","auto")):"auto"===b&&(c=0,this.panels.each(function(){c=Math.max(c,a(this).height("").height())}).height(c))},_eventHandler:function(b){var c=this.options,d=this.active,e=a(b.currentTarget),f=e.closest("li"),g=f[0]===d[0],h=g&&c.collapsible,i=h?a():this._getPanelForTab(f),j=d.length?this._getPanelForTab(d):a(),k={oldTab:d,oldPanel:j,newTab:h?a():f,newPanel:i};b.preventDefault(),f.hasClass("ui-state-disabled")||f.hasClass("ui-tabs-loading")||this.running||g&&!c.collapsible||this._trigger("beforeActivate",b,k)===!1||(c.active=h?!1:this.tabs.index(f),this.active=g?a():f,this.xhr&&this.xhr.abort(),j.length||i.length||a.error("jQuery UI Tabs: Mismatching fragment identifier."),i.length&&this.load(this.tabs.index(f),b),this._toggle(b,k))},_toggle:function(b,c){function d(){f.running=!1,f._trigger("activate",b,c)}function e(){c.newTab.closest("li").addClass("ui-tabs-active ui-state-active"),g.length&&f.options.show?f._show(g,f.options.show,d):(g.show(),d())}var f=this,g=c.newPanel,h=c.oldPanel;this.running=!0,h.length&&this.options.hide?this._hide(h,this.options.hide,function(){c.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),e()}):(c.oldTab.closest("li").removeClass("ui-tabs-active ui-state-active"),h.hide(),e()),h.attr({"aria-expanded":"false","aria-hidden":"true"}),c.oldTab.attr("aria-selected","false"),g.length&&h.length?c.oldTab.attr("tabIndex",-1):g.length&&this.tabs.filter(function(){return 0===a(this).attr("tabIndex")}).attr("tabIndex",-1),g.attr({"aria-expanded":"true","aria-hidden":"false"}),c.newTab.attr({"aria-selected":"true",tabIndex:0})},_activate:function(b){var c,d=this._findActive(b);d[0]!==this.active[0]&&(d.length||(d=this.active),c=d.find(".ui-tabs-anchor")[0],this._eventHandler({target:c,currentTarget:c,preventDefault:a.noop}))},_findActive:function(b){return b===!1?a():this.tabs.eq(b)},_getIndex:function(a){return"string"==typeof a&&(a=this.anchors.index(this.anchors.filter("[href$='"+a+"']"))),a},_destroy:function(){this.xhr&&this.xhr.abort(),this.element.removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible"),this.tablist.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all").removeAttr("role"),this.anchors.removeClass("ui-tabs-anchor").removeAttr("role").removeAttr("tabIndex").removeUniqueId(),this.tabs.add(this.panels).each(function(){a.data(this,"ui-tabs-destroy")?a(this).remove():a(this).removeClass("ui-state-default ui-state-active ui-state-disabled ui-corner-top ui-corner-bottom ui-widget-content ui-tabs-active ui-tabs-panel").removeAttr("tabIndex").removeAttr("aria-live").removeAttr("aria-busy").removeAttr("aria-selected").removeAttr("aria-labelledby").removeAttr("aria-hidden").removeAttr("aria-expanded").removeAttr("role")}),this.tabs.each(function(){var b=a(this),c=b.data("ui-tabs-aria-controls");c?b.attr("aria-controls",c).removeData("ui-tabs-aria-controls"):b.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(c){var d=this.options.disabled;d!==!1&&(c===b?d=!1:(c=this._getIndex(c),d=a.isArray(d)?a.map(d,function(a){return a!==c?a:null}):a.map(this.tabs,function(a,b){return b!==c?b:null})),this._setupDisabled(d))},disable:function(c){var d=this.options.disabled;if(d!==!0){if(c===b)d=!0;else{if(c=this._getIndex(c),-1!==a.inArray(c,d))return;d=a.isArray(d)?a.merge([c],d).sort():[c]}this._setupDisabled(d)}},load:function(b,c){b=this._getIndex(b);var e=this,f=this.tabs.eq(b),g=f.find(".ui-tabs-anchor"),h=this._getPanelForTab(f),i={tab:f,panel:h};d(g[0])||(this.xhr=a.ajax(this._ajaxSettings(g,c,i)),this.xhr&&"canceled"!==this.xhr.statusText&&(f.addClass("ui-tabs-loading"),h.attr("aria-busy","true"),this.xhr.success(function(a){setTimeout(function(){h.html(a),e._trigger("load",c,i)},1)}).complete(function(a,b){setTimeout(function(){"abort"===b&&e.panels.stop(!1,!0),f.removeClass("ui-tabs-loading"),h.removeAttr("aria-busy"),a===e.xhr&&delete e.xhr},1)})))},_ajaxSettings:function(b,c,d){var e=this;return{url:b.attr("href"),beforeSend:function(b,f){return e._trigger("beforeLoad",c,a.extend({jqXHR:b,ajaxSettings:f},d))}}},_getPanelForTab:function(b){var c=a(b).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+c))}})}(jQuery),function(a){function b(b,c){var d=(b.attr("aria-describedby")||"").split(/\s+/);d.push(c),b.data("ui-tooltip-id",c).attr("aria-describedby",a.trim(d.join(" ")))}function c(b){var c=b.data("ui-tooltip-id"),d=(b.attr("aria-describedby")||"").split(/\s+/),e=a.inArray(c,d);-1!==e&&d.splice(e,1),b.removeData("ui-tooltip-id"),d=a.trim(d.join(" ")),d?b.attr("aria-describedby",d):b.removeAttr("aria-describedby")}var d=0;a.widget("ui.tooltip",{version:"1.10.3",options:{content:function(){var b=a(this).attr("title")||"";return a("<a>").text(b).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,tooltipClass:null,track:!1,close:null,open:null},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.options.disabled&&this._disable()},_setOption:function(b,c){var d=this;return"disabled"===b?(this[c?"_disable":"_enable"](),void(this.options[b]=c)):(this._super(b,c),void("content"===b&&a.each(this.tooltips,function(a,b){d._updateContent(b)})))},_disable:function(){var b=this;a.each(this.tooltips,function(c,d){var e=a.Event("blur");e.target=e.currentTarget=d[0],b.close(e,!0)}),this.element.find(this.options.items).addBack().each(function(){var b=a(this);b.is("[title]")&&b.data("ui-tooltip-title",b.attr("title")).attr("title","")})},_enable:function(){this.element.find(this.options.items).addBack().each(function(){var b=a(this);b.data("ui-tooltip-title")&&b.attr("title",b.data("ui-tooltip-title"))})},open:function(b){var c=this,d=a(b?b.target:this.element).closest(this.options.items);d.length&&!d.data("ui-tooltip-id")&&(d.attr("title")&&d.data("ui-tooltip-title",d.attr("title")),d.data("ui-tooltip-open",!0),b&&"mouseover"===b.type&&d.parents().each(function(){var b,d=a(this);d.data("ui-tooltip-open")&&(b=a.Event("blur"),b.target=b.currentTarget=this,c.close(b,!0)),d.attr("title")&&(d.uniqueId(),c.parents[this.id]={element:this,title:d.attr("title")},d.attr("title",""))}),this._updateContent(d,b))},_updateContent:function(a,b){var c,d=this.options.content,e=this,f=b?b.type:null;return"string"==typeof d?this._open(b,a,d):(c=d.call(a[0],function(c){a.data("ui-tooltip-open")&&e._delay(function(){b&&(b.type=f),this._open(b,a,c)})}),void(c&&this._open(b,a,c)))},_open:function(c,d,e){function f(a){j.of=a,g.is(":hidden")||g.position(j)}var g,h,i,j=a.extend({},this.options.position);if(e){if(g=this._find(d),g.length)return void g.find(".ui-tooltip-content").html(e);d.is("[title]")&&(c&&"mouseover"===c.type?d.attr("title",""):d.removeAttr("title")),g=this._tooltip(d),b(d,g.attr("id")),g.find(".ui-tooltip-content").html(e),this.options.track&&c&&/^mouse/.test(c.type)?(this._on(this.document,{mousemove:f}),f(c)):g.position(a.extend({of:d},this.options.position)),g.hide(),this._show(g,this.options.show),this.options.show&&this.options.show.delay&&(i=this.delayedShow=setInterval(function(){g.is(":visible")&&(f(j.of),clearInterval(i))},a.fx.interval)),this._trigger("open",c,{tooltip:g}),h={keyup:function(b){if(b.keyCode===a.ui.keyCode.ESCAPE){var c=a.Event(b);c.currentTarget=d[0],this.close(c,!0)}},remove:function(){this._removeTooltip(g)}},c&&"mouseover"!==c.type||(h.mouseleave="close"),c&&"focusin"!==c.type||(h.focusout="close"),this._on(!0,d,h)}},close:function(b){var d=this,e=a(b?b.currentTarget:this.element),f=this._find(e);this.closing||(clearInterval(this.delayedShow),e.data("ui-tooltip-title")&&e.attr("title",e.data("ui-tooltip-title")),c(e),f.stop(!0),this._hide(f,this.options.hide,function(){d._removeTooltip(a(this))}),e.removeData("ui-tooltip-open"),this._off(e,"mouseleave focusout keyup"),e[0]!==this.element[0]&&this._off(e,"remove"),this._off(this.document,"mousemove"),b&&"mouseleave"===b.type&&a.each(this.parents,function(b,c){a(c.element).attr("title",c.title),delete d.parents[b]}),this.closing=!0,this._trigger("close",b,{tooltip:f}),this.closing=!1)},_tooltip:function(b){var c="ui-tooltip-"+d++,e=a("<div>").attr({id:c,role:"tooltip"}).addClass("ui-tooltip ui-widget ui-corner-all ui-widget-content "+(this.options.tooltipClass||""));return a("<div>").addClass("ui-tooltip-content").appendTo(e),e.appendTo(this.document[0].body),this.tooltips[c]=b,e},_find:function(b){var c=b.data("ui-tooltip-id");return c?a("#"+c):a()},_removeTooltip:function(a){a.remove(),delete this.tooltips[a.attr("id")]},_destroy:function(){var b=this;a.each(this.tooltips,function(c,d){var e=a.Event("blur");e.target=e.currentTarget=d[0],b.close(e,!0),a("#"+c).remove(),d.data("ui-tooltip-title")&&(d.attr("title",d.data("ui-tooltip-title")),d.removeData("ui-tooltip-title"))})}})}(jQuery),define("jqueryui",["jquery"],function(){}),function(a){a.widget("ui.tagit",{options:{allowDuplicates:!1,caseSensitive:!0,fieldName:"tags",placeholderText:null,readOnly:!1,removeConfirmation:!1,tagLimit:null,availableTags:[],autocomplete:{},showAutocompleteOnFocus:!1,allowSpaces:!1,singleField:!1,singleFieldDelimiter:",",singleFieldNode:null,animate:!0,tabIndex:null,beforeTagAdded:null,afterTagAdded:null,beforeTagRemoved:null,afterTagRemoved:null,onTagClicked:null,onTagLimitExceeded:null,onTagAdded:null,onTagRemoved:null,tagSource:null},_create:function(){var b=this;this.element.is("input")?(this.tagList=a("<ul></ul>").insertAfter(this.element),this.options.singleField=!0,this.options.singleFieldNode=this.element,this.element.css("display","none")):this.tagList=this.element.find("ul, ol").andSelf().last(),this.tagInput=a('<input type="text" />').addClass("ui-widget-content"),this.options.readOnly&&this.tagInput.attr("disabled","disabled"),this.options.tabIndex&&this.tagInput.attr("tabindex",this.options.tabIndex),this.options.placeholderText&&this.tagInput.attr("placeholder",this.options.placeholderText),this.options.autocomplete.source||(this.options.autocomplete.source=function(b,c){var d=b.term.toLowerCase(),e=a.grep(this.options.availableTags,function(a){return 0===a.toLowerCase().indexOf(d)});this.options.allowDuplicates||(e=this._subtractArray(e,this.assignedTags())),c(e)}),this.options.showAutocompleteOnFocus&&(this.tagInput.focus(function(a,c){b._showAutocomplete()}),"undefined"==typeof this.options.autocomplete.minLength&&(this.options.autocomplete.minLength=0)),a.isFunction(this.options.autocomplete.source)&&(this.options.autocomplete.source=a.proxy(this.options.autocomplete.source,this)),a.isFunction(this.options.tagSource)&&(this.options.tagSource=a.proxy(this.options.tagSource,this)),this.tagList.addClass("tagit").addClass("ui-widget ui-widget-content ui-corner-all").append(a('<li class="tagit-new"></li>').append(this.tagInput)).click(function(c){var d=a(c.target);if(d.hasClass("tagit-label")){var e=d.closest(".tagit-choice");e.hasClass("removed")||b._trigger("onTagClicked",c,{tag:e,tagLabel:b.tagLabel(e)})}else b.tagInput.focus()});var c=!1;if(this.options.singleField)if(this.options.singleFieldNode){var d=a(this.options.singleFieldNode),e=d.val().split(this.options.singleFieldDelimiter);d.val(""),a.each(e,function(a,d){b.createTag(d,null,!0),c=!0})}else this.options.singleFieldNode=a('<input type="hidden" style="display:none;" value="" name="'+this.options.fieldName+'" />'),this.tagList.after(this.options.singleFieldNode);if(c||this.tagList.children("li").each(function(){a(this).hasClass("tagit-new")||(b.createTag(a(this).text(),a(this).attr("class"),!0),a(this).remove())}),this.tagInput.keydown(function(c){if(c.which==a.ui.keyCode.BACKSPACE&&""===b.tagInput.val()){var d=b._lastTag();!b.options.removeConfirmation||d.hasClass("remove")?b.removeTag(d):b.options.removeConfirmation&&d.addClass("remove ui-state-highlight")}else b.options.removeConfirmation&&b._lastTag().removeClass("remove ui-state-highlight");(c.which===a.ui.keyCode.COMMA||c.which===a.ui.keyCode.ENTER||c.which==a.ui.keyCode.TAB&&""!==b.tagInput.val()||c.which==a.ui.keyCode.SPACE&&b.options.allowSpaces!==!0&&('"'!=a.trim(b.tagInput.val()).replace(/^s*/,"").charAt(0)||'"'==a.trim(b.tagInput.val()).charAt(0)&&'"'==a.trim(b.tagInput.val()).charAt(a.trim(b.tagInput.val()).length-1)&&a.trim(b.tagInput.val()).length-1!==0))&&(c.which===a.ui.keyCode.ENTER&&""===b.tagInput.val()||c.preventDefault(),b.tagInput.data("autocomplete-open")||b.createTag(b._cleanedInput()))}).blur(function(a){b.tagInput.data("autocomplete-open")||b.createTag(b._cleanedInput())}),this.options.availableTags||this.options.tagSource||this.options.autocomplete.source){var f={select:function(a,c){return b.createTag(c.item.value),!1}};a.extend(f,this.options.autocomplete),f.source=this.options.tagSource||f.source,this.tagInput.autocomplete(f).bind("autocompleteopen",function(a,c){b.tagInput.data("autocomplete-open",!0)}).bind("autocompleteclose",function(a,c){b.tagInput.data("autocomplete-open",!1)})}},_cleanedInput:function(){return a.trim(this.tagInput.val().replace(/^"(.*)"$/,"$1"))},_lastTag:function(){return this.tagList.find(".tagit-choice:last:not(.removed)")},_tags:function(){return this.tagList.find(".tagit-choice:not(.removed)")},assignedTags:function(){var b=this,c=[];return this.options.singleField?(c=a(this.options.singleFieldNode).val().split(this.options.singleFieldDelimiter),""===c[0]&&(c=[])):this._tags().each(function(){c.push(b.tagLabel(this))}),c},_updateSingleTagsField:function(b){a(this.options.singleFieldNode).val(b.join(this.options.singleFieldDelimiter)).trigger("change")},_subtractArray:function(b,c){for(var d=[],e=0;e<b.length;e++)-1==a.inArray(b[e],c)&&d.push(b[e]);return d},tagLabel:function(b){return this.options.singleField?a(b).find(".tagit-label:first").text():a(b).find("input:first").val()},_showAutocomplete:function(){this.tagInput.autocomplete("search","")},_findTagByLabel:function(b){var c=this,d=null;return this._tags().each(function(e){return c._formatStr(b)==c._formatStr(c.tagLabel(this))?(d=a(this),!1):void 0}),d},_isNew:function(a){return!this._findTagByLabel(a)},_formatStr:function(b){return this.options.caseSensitive?b:a.trim(b.toLowerCase())},_effectExists:function(b){return Boolean(a.effects&&(a.effects[b]||a.effects.effect&&a.effects.effect[b]))},createTag:function(b,c,d){var e=this;if(b=a.trim(b),this.options.preprocessTag&&(b=this.options.preprocessTag(b)),""===b)return!1;if(!this.options.allowDuplicates&&!this._isNew(b)){var f=this._findTagByLabel(b);return this._trigger("onTagExists",null,{existingTag:f,duringInitialization:d})!==!1&&this._effectExists("highlight")&&f.effect("highlight"),!1}if(this.options.tagLimit&&this._tags().length>=this.options.tagLimit)return this._trigger("onTagLimitExceeded",null,{duringInitialization:d}),!1;var g=a(this.options.onTagClicked?'<a class="tagit-label"></a>':'<span class="tagit-label"></span>').text(b),h=a("<li></li>").addClass("tagit-choice ui-widget-content ui-state-default ui-corner-all").addClass(c).append(g);if(this.options.readOnly)h.addClass("tagit-choice-read-only");else{h.addClass("tagit-choice-editable");var i=a("<span></span>").addClass("icon-wb_close"),j=a('<a><span class="text-icon">×</span></a>').addClass("tagit-close").append(i).click(function(a){e.removeTag(h)});h.append(j)}if(!this.options.singleField){var k=g.html();h.append('<input type="hidden" style="display:none;" value="'+k+'" name="'+this.options.fieldName+'" />')}if(this._trigger("beforeTagAdded",null,{tag:h,tagLabel:this.tagLabel(h),duringInitialization:d})!==!1){if(this.options.singleField){var l=this.assignedTags();l.push(b),this._updateSingleTagsField(l)}this._trigger("onTagAdded",null,h),this.tagInput.val(""),this.tagInput.parent().before(h),this._trigger("afterTagAdded",null,{tag:h,tagLabel:this.tagLabel(h),duringInitialization:d}),this.options.showAutocompleteOnFocus&&!d&&setTimeout(function(){e._showAutocomplete()},0)}},removeTag:function(b,c){if(c="undefined"==typeof c?this.options.animate:c,b=a(b),this._trigger("onTagRemoved",null,b),this._trigger("beforeTagRemoved",null,{tag:b,tagLabel:this.tagLabel(b)})!==!1){if(this.options.singleField){var d=this.assignedTags(),e=this.tagLabel(b);d=a.grep(d,function(a){return a!=e}),this._updateSingleTagsField(d)}if(c){b.addClass("removed");var f=this._effectExists("blind")?["blind",{direction:"horizontal"},"fast"]:["fast"],g=this;f.push(function(){b.remove(),g._trigger("afterTagRemoved",null,{tag:b,tagLabel:g.tagLabel(b)})}),b.fadeOut("fast").hide.apply(b,f).dequeue()}else b.remove(),this._trigger("afterTagRemoved",null,{tag:b,tagLabel:this.tagLabel(b)})}},removeTagByLabel:function(a,b){var c=this._findTagByLabel(a);if(!c)throw"No such tag exists with the name '"+a+"'";this.removeTag(c,b)},removeAll:function(){var a=this;this._tags().each(function(b,c){a.removeTag(c,!1)})}})}(jQuery),define("jquery.tag-it",["jquery","jqueryui"],function(){}),function($){var escape=/["\\\x00-\x1f\x7f-\x9f]/g,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},hasOwn=Object.prototype.hasOwnProperty;$.toJSON="object"==typeof JSON&&JSON.stringify?JSON.stringify:function(a){if(null===a)return"null";var b,c,d,e,f=$.type(a);if("undefined"!==f){if("number"===f||"boolean"===f)return String(a);if("string"===f)return $.quoteString(a);if("function"==typeof a.toJSON)return $.toJSON(a.toJSON());if("date"===f){var g=a.getUTCMonth()+1,h=a.getUTCDate(),i=a.getUTCFullYear(),j=a.getUTCHours(),k=a.getUTCMinutes(),l=a.getUTCSeconds(),m=a.getUTCMilliseconds();return 10>g&&(g="0"+g),10>h&&(h="0"+h),10>j&&(j="0"+j),10>k&&(k="0"+k),10>l&&(l="0"+l),100>m&&(m="0"+m),10>m&&(m="0"+m),'"'+i+"-"+g+"-"+h+"T"+j+":"+k+":"+l+"."+m+'Z"'}if(b=[],$.isArray(a)){for(c=0;c<a.length;c++)b.push($.toJSON(a[c])||"null");return"["+b.join(",")+"]"}if("object"==typeof a){for(c in a)if(hasOwn.call(a,c)){if(f=typeof c,"number"===f)d='"'+c+'"';else{if("string"!==f)continue;d=$.quoteString(c)}f=typeof a[c],"function"!==f&&"undefined"!==f&&(e=$.toJSON(a[c]),b.push(d+":"+e))}return"{"+b.join(",")+"}"}}},$.evalJSON="object"==typeof JSON&&JSON.parse?JSON.parse:function(str){return eval("("+str+")")},$.secureEvalJSON="object"==typeof JSON&&JSON.parse?JSON.parse:function(str){var filtered=str.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"");if(/^[\],:{}\s]*$/.test(filtered))return eval("("+str+")");throw new SyntaxError("Error parsing JSON, source is not valid.")},$.quoteString=function(a){return a.match(escape)?'"'+a.replace(escape,function(a){var b=meta[a];return"string"==typeof b?b:(b=a.charCodeAt(),"\\u00"+Math.floor(b/16).toString(16)+(b%16).toString(16))})+'"':'"'+a+'"'}}(jQuery),define("jquery.json",["jquery"],function(){}),define("modules/view/store/store_item_virtualgift_detail_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","modules/mig33_app","marionette_handlebars","modules/view/store/store_item_detail_item_view","hbs!modules/template/store/store-item-virtualgift-detail","modules/common/config","modules/common/utility","modules/chat/models/user_session","jquery.tag-it","jquery.json","modules/template/helpers/general_helpers","jquery.scrollTo"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=l.Session.getInstance(),n=h.extend({template:{type:"handlebars",template:i},events:{'click input[name="purchase_item"]':"purchaseitem"},initialize:function(a){var b=this;this.options=a,f||(f=require("modules/mig33_app")),f&&f.vent.on(f.ApplicationEvents.ACCOUNT_BALANCE,function(a){b.updateAccountBalance(a),b.hideGiftingOptions(),b.greyscaleImage(),b.checkAllowedToBuy()})},onRender:function(){var a=this,b=require("modules/chat/models/contacts").ContactGroupStore.getInstance();b.is_contacts_loaded()?this.autoCompleteWhoField(b.get_all_contacts()):b.on("contacts_load_complete",function(){a.autoCompleteWhoField(b.get_all_contacts())},this),void 0!==m.get("account_balance")&&null!==m.get("account_balance")&&this.updateAccountBalance(k.add_thousands_seperator(m.get("account_balance"))+" "+m.get("currency_code")),this.hideGiftingOptions(),this.checkAllowedToBuy(),this.greyscaleImage()},autoCompleteWhoField:function(a){var c=this,d=[],e=0,f=b("#to",this.$el);a.each(function(a){a.isFusionContact()&&d.push(a.getUsername())}),f.prop("disabled",!1).tagit({fieldName:"to",caseSensitive:!1,tagLimit:5,autocomplete:{delay:1,minLength:3,autoFocus:!0},placeholderText:k.translate("account|recipient"),availableTags:d,onTagLimitExceeded:function(){k.show_error(k.translate("store|error_max_recipient",c.model.getTypeNiceNameSingular(),5))},beforeTagAdded:function(a,d){var e=/^@*([\w\d\.\-]{1,42})$/,f=b(d.tag[0]).text(),g=f.substr(0,f.length-1),h=e.test(g);return h?void 0:(k.show_error(k.translate("store|error_username",g)),b('input[name="purchase_item"]',c.$el).prop("disabled",!0),!1)},afterTagAdded:function(a,d){e=f.tagit("assignedTags").length,b('input[name="purchase_item"]',c.$el).prop("disabled",!1);var g=c.calculateQuantityAndPrice(e);null!=m.get("account_balance")&&g>m.get("account_balance")&&(c.showRecharge(),c.disablePurchase())},afterTagRemoved:function(a,d){e=f.tagit("assignedTags").length,e>0?b('input[name="purchase_item"]',c.$el).prop("disabled",!1):b('input[name="purchase_item"]',c.$el).prop("disabled",!0);var g=c.calculateQuantityAndPrice(e);null!=m.get("account_balance")&&g<m.get("account_balance")&&(c.hideRecharge(),c.enablePurchase())}}),""!==this.toUsername&&f.tagit("createTag",this.toUsername)},purchaseitem:function(a){a.preventDefault(),b(a.currentTarget,this.$el).prop("disabled",!0);var c=this,d={to:b.trim(b("#to",this.$el).val()).replace(/@*/g,""),message:b.trim(b('textarea[name="message"]',this.$el).val()),"private":(!!b('input[name="private"]:checked',this.$el).length).toString(),postToMiniblog:(!!b('input[name="post_to_miniblog"]:checked',this.$el).length).toString()};""!==this.campaignId&&(d.counterId=this.campaignId);var e=this.model.purchase(d);e.done(function(e,g,h){return"undefined"==typeof e?!1:(e=k.parse_ajax_response(e),void("undefined"!=typeof e.id?f.vent.trigger(f.ApplicationEvents.STORE_ITEM_PURCHASED,e,d.to.split(",")):(e.error?k.show_error(e.error):k.show_error(k.translate("store|error_purchase",c.model.getTypeNiceNameSingular())),b(a.currentTarget,this.$el).prop("disabled",!1))))})},calculateQuantityAndPrice:function(a){a=parseInt(a,10);var c=0;return a>0?(c=(k.round_number_decimal(this.model.get("localPrice"))*a).toFixed(2),b(".total-quantity",this.$el).text(a),b(".total-price",this.$el).text(c+" "+this.model.get("localCurrency"))):(b(".total-quantity",this.$el).text("-"),b(".total-price",this.$el).text("-")),c},greyscaleImage:function(){this.allowedToBuyItemFromBalance()||(b(".image img",this.$el).addClass("greyscale-image"),b(".app-item-img img",this.$el).addClass("greyscale-image"))},hideGiftingOptions:function(){var a=this;this.options.hasOwnProperty("action")&&"buy"==this.options.action&&(a.calculateQuantityAndPrice(1),b('input[name="purchase_item"]',a.$el).prop("disabled",!1),b(".send",a.$el).css("text-align","center"),b('input[name="purchase_item"]',a.$el).prop("value",k.translate("common|buy")),b(".store-item-title",a.$el).text(k.translate("store|get_item")),b(".to",a.$el).hide(),b(".message",a.$el).hide(),b(".options",a.$el).hide(),b(".quantity",a.$el).hide())},updateAccountBalance:function(a){b(".account-balance-amount",this.$el).text(a),this.checkAllowedToBuy()}});return n}),define("hbs!modules/template/gift/gift-post-collection",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b,d){var e,f,h,k="";return k+="\n			",f=c.compare||d&&d.compare,h={hash:{operator:"%"},inverse:n.noop,fn:n.program(2,g,b),data:b},e=f?f.call(a,null==b||b===!1?b:b.index,d&&d.item_row,h):o.call(a,"compare",null==b||b===!1?b:b.index,d&&d.item_row,h),(e||0===e)&&(k+=e),k+='\n\n			<li class="gift" data-index="'+p((e=null==b||b===!1?b:b.index,typeof e===q?e.apply(a):e))+'">\n				<img class="gift__img" src="/images/emoticons/virtualgifts/',(f=c.previewImage)?e=f.call(a,{hash:{},data:b}):(f=a&&a.previewImage,e=typeof f===q?f.call(a,{hash:{},data:b}):f),k+=p(e)+'_64.png" alt="',(f=c.description)?e=f.call(a,{hash:{},data:b}):(f=a&&a.description,e=typeof f===q?f.call(a,{hash:{},data:b}):f),k+=p(e)+'" title="',(f=c.description)?e=f.call(a,{hash:{},data:b}):(f=a&&a.description,e=typeof f===q?f.call(a,{hash:{},data:b}):f),k+=p(e)+'" />\n				<div class="font-bold">',(f=c.name)?e=f.call(a,{hash:{},data:b}):(f=a&&a.name,e=typeof f===q?f.call(a,{hash:{},data:b}):f),k+=p(e)+'</div>\n				<div class="font-color-caption small">',(f=c.localPrice)?e=f.call(a,{hash:{},data:b}):(f=a&&a.localPrice,e=typeof f===q?f.call(a,{hash:{},data:b}):f),k+=p(e)+" ",(f=c.localCurrency)?e=f.call(a,{hash:{},data:b}):(f=a&&a.localCurrency,e=typeof f===q?f.call(a,{hash:{},data:b}):f),k+=p(e)+"</div>\n			</li>\n\n			",f=c.compare||d&&d.compare,h={hash:{operator:"%1"},inverse:n.noop,fn:n.program(5,i,b),data:b},e=f?f.call(a,null==b||b===!1?b:b.index,d&&d.item_row,h):o.call(a,"compare",null==b||b===!1?b:b.index,d&&d.item_row,h),(e||0===e)&&(k+=e),k+="\n\n			",e=c["if"].call(a,null==b||b===!1?b:b.last,{hash:{},inverse:n.noop,fn:n.programWithDepth(7,j,b,a),data:b}),(e||0===e)&&(k+=e),k+="\n\n\n		"}function g(a,b){var d,e,f,g="";return g+='\n				<div class="item ',e=c.compare||a&&a.compare,f={hash:{},inverse:n.noop,fn:n.program(3,h,b),data:b},d=e?e.call(a,null==b||b===!1?b:b.index,0,f):o.call(a,"compare",null==b||b===!1?b:b.index,0,f),(d||0===d)&&(g+=d),g+='">\n			'}function h(a,b){return"active"}function i(a,b){
return"\n				</div>\n			"}function j(a,b,d){var e,f,g,h="";return h+="\n				",f=c.compare||d&&d.compare,g={hash:{operator:"%1"},inverse:n.noop,fn:n.program(8,k,b),data:b},e=f?f.call(a,null==b||b===!1?b:b.index,d&&d.item_row,g):o.call(a,"compare",null==b||b===!1?b:b.index,d&&d.item_row,g),(e||0===e)&&(h+=e),h+='\n\n				<li class="gift go-to-store">\n					<img class="gift__img" src="'+p((f=c.getUrl||d&&d.getUrl,g={hash:{},data:b},f?f.call(a,"jsclient",g):o.call(a,"getUrl","jsclient",g)))+'/app/images/mig.me/wb_title_store.svg" alt="'+p((f=c.translate||d&&d.translate,g={hash:{},data:b},f?f.call(a,"account|go_to_store",g):o.call(a,"translate","account|go_to_store",g)))+'" title="'+p((f=c.translate||d&&d.translate,g={hash:{},data:b},f?f.call(a,"account|go_to_store",g):o.call(a,"translate","account|go_to_store",g)))+'" />\n					<div class="font-bold">'+p((f=c.translate||d&&d.translate,g={hash:{},data:b},f?f.call(a,"store|store",g):o.call(a,"translate","store|store",g)))+"</div>\n				</li>\n\n				</div>\n			"}function k(a,b){return"\n					<div>\n				"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var l,m="",n=this,o=c.helperMissing,p=this.escapeExpression,q="function";return m+='<div class="carousel slide display-block">\n	<ul class="gifts carousel-inner" id="gifts-carousel" data-interval="false">\n		',l=c.each.call(b,b&&b.gifts,{hash:{},inverse:n.noop,fn:n.programWithDepth(1,f,e,b),data:e}),(l||0===l)&&(m+=l),m+='\n	</ul>\n\n	<a class="left carousel-control" href="#gifts-carousel" data-slide="prev"><span class="chevron"> < </span></a>\n	<a class="right carousel-control" href="#gifts-carousel" data-slide="next"><span class="chevron"> > </span></a>\n</div>'})}),define("modules/view/gift/gift-post-collection",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/gift/gift-post-collection","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i){var j=e.ItemView.extend({template:{type:"handlebars",template:g},className:"",events:{"click li":"onItemClick"},initialize:function(){a.bindAll(this)},templateHelpers:function(){var a=4;return b(window).width()<768&&(a=3),{item_row:a}},onRender:function(){},onItemClick:function(a){if(b(a.currentTarget).hasClass("go-to-store"))return c.history.navigate("store",{trigger:!0}),void b("#gift-modal").modal("hide");b(a.currentTarget).parent().children().removeClass("chosen"),b(a.currentTarget).addClass("chosen");var d=b(a.currentTarget).data("index");this.trigger("gift_selected",d)}});return j}),define("modules/view/store/store_item_virtualgift_selection_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","modules/mig33_app","marionette_handlebars","modules/view/gift/gift-post-collection","modules/view/store/store_item_detail_item_view","hbs!modules/template/store/store-item-virtualgift-detail","modules/common/config","modules/common/utility","modules/chat/models/user_session","jquery.tag-it","jquery.json","modules/template/helpers/general_helpers","jquery.scrollTo"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=m.Session.getInstance(),o=i.extend({template:{type:"handlebars",template:j},events:{'click input[name="purchase_item"]':"purchaseitem"},initialize:function(a){var b=this;this.options=a,f||(f=require("modules/mig33_app")),f&&f.vent.on(f.ApplicationEvents.ACCOUNT_BALANCE,function(a){b.updateAccountBalance(a),b.hideGiftingOptions()})},onRender:function(){var a=this,d=require("modules/chat/models/contacts").ContactGroupStore.getInstance(),e=l.format(k.urls.store_type_items,k.store.type_to_category.VIRTUAL_GIFT),f="?sortby={0}&sortorder={1}&offset=0&limit=95&_="+Date.now();b(".item-details",this.$el).html(' <span class="icon-wb_loading_reload spin-cw"></span>'),b.ajax(e+l.format(f,"featured,numsold","desc,desc")).then(function(b){var d=new c.Model;d.set("gifts",b.data.listData),a.popular_items=new h({model:d}),a.popular_items.render(),a.popular_items.on("gift_selected",function(b){a.checkAllowedToBuyFromBalance(b),a.trigger("gift_selected",d.get("gifts")[b])});var e=a.$el.find(".detail");e.html(a.popular_items.$el)}),d.is_contacts_loaded()?this.autoCompleteWhoField(d.get_all_contacts()):d.on("contacts_load_complete",function(){a.autoCompleteWhoField(d.get_all_contacts())},this),void 0!==n.get("account_balance")&&null!==n.get("account_balance")&&this.updateAccountBalance(l.add_thousands_seperator(n.get("account_balance"))+" "+n.get("currency_code")),this.hideGiftingOptions()},autoCompleteWhoField:function(a){var c=this,d=[],e=0,f=b("#to",this.$el);a.each(function(a){a.isFusionContact()&&d.push(a.getUsername())}),f.prop("disabled",!1).tagit({fieldName:"to",caseSensitive:!1,tagLimit:5,autocomplete:{delay:1,minLength:3,autoFocus:!0},placeholderText:l.translate("store|add_participant"),availableTags:d,onTagLimitExceeded:function(){l.show_error(l.translate("store|error_max_recipient",c.model.getTypeNiceNameSingular(),5))},beforeTagAdded:function(a,d){var e=/^@*([\w\d\.\-]{1,42})$/,f=b(d.tag[0]).text(),g=f.substr(0,f.length-1),h=e.test(g);return h?void 0:(l.show_error(l.translate("store|error_username",g)),c.disablePurchase(),!1)},afterTagAdded:function(a,b){e=f.tagit("assignedTags").length,c.calculateQuantityAndPrice(e),c.enablePurchase()},afterTagRemoved:function(a,b){e=f.tagit("assignedTags").length,c.calculateQuantityAndPrice(e)}}),""!==this.toUsername&&f.tagit("createTag",this.toUsername)},purchaseitem:function(a){a.preventDefault(),b(a.currentTarget,this.$el).prop("disabled",!0);var c=this,d={to:b.trim(b("#to",this.$el).val()).replace(/@*/g,""),message:b.trim(b('textarea[name="message"]',this.$el).val()),"private":(!!b('input[name="private"]:checked',this.$el).length).toString(),postToMiniblog:(!!b('input[name="post_to_miniblog"]:checked',this.$el).length).toString()};""!==this.campaignId&&(d.counterId=this.campaignId);var e=this.model.purchase(d);e.done(function(e,g,h){return"undefined"==typeof e?!1:(e=l.parse_ajax_response(e),void("undefined"!=typeof e.id?f.vent.trigger(f.ApplicationEvents.STORE_ITEM_PURCHASED,e,d.to.split(",")):(e.error?l.show_error(e.error):l.show_error(l.translate("store|error_purchase",c.model.getTypeNiceNameSingular())),b(a.currentTarget,this.$el).prop("disabled",!1))))})},calculateQuantityAndPrice:function(a){if(a=parseInt(a,10),a>0){var c=(l.round_number_decimal(this.model.get("localPrice"))*a).toFixed(2);b(".total-quantity",this.$el).text(a),b(".total-price",this.$el).text(c+" "+this.model.get("localCurrency"))}else b(".total-quantity",this.$el).text("-"),b(".total-price",this.$el).text("-"),this.disablePurchase()},greyscaleImage:function(){this.allowedToBuyItemFromBalance()||(b(".image img",this.$el).addClass("greyscale-image"),b(".app-item-img img",this.$el).addClass("greyscale-image"))},hideGiftingOptions:function(){var a=this;this.options.hasOwnProperty("action")&&"buy"==this.options.action&&(a.calculateQuantityAndPrice(1),b('input[name="purchase_item"]',a.$el).prop("disabled",!1),b(".send",a.$el).css("text-align","center"),b('input[name="purchase_item"]',a.$el).prop("value",l.translate("common|buy")),b(".store-item-title",a.$el).text(l.translate("store|get_item")),b(".to",a.$el).hide(),b(".message",a.$el).hide(),b(".options",a.$el).hide(),b(".quantity",a.$el).hide())},allowedToBuyItemFromBalance:function(a){return null!=n.get("account_balance")?n.get("account_balance")>=this.popular_items.model.get("gifts")[a].localPrice:!0},checkAllowedToBuyFromBalance:function(a){this.allowedToBuyItemFromBalance(a)?(b(".account-recharge",this.$el).addClass("hidden"),b(".account-balance-amount",this.$el).removeClass("font-color-red").addClass("font-color-green"),b('input[name="purchase_item"]',this.$el).prop("disabled",!1)):(b(".account-recharge",this.$el).removeClass("hidden"),b(".account-balance-amount",this.$el).removeClass("font-color-green").addClass("font-color-red"),b('input[name="purchase_item"]',this.$el).prop("disabled",!0))},updateAccountBalance:function(a){b(".account-balance-amount",this.$el).text(a)}});return o}),define("modules/template/helpers/store_helpers",["underscore","handlebars","modules/common/config","modules/common/utility","modules/chat/models/user_session","modules/common/session_user","modules/globals/url"],function(a,b,c,d,e,f,g){var h=(e.Session.getInstance(),function(a){var b="";switch(a){case"VIRTUAL_GIFT":b=d.translate("user|gift");break;case"AVATAR":b=d.translate("user|avatar");break;case"EMOTICON":b=d.translate("chat|emoticon");break;case"STICKER":b=d.translate("chat|sticker");break;case"APP_ITEM":b=d.translate("store|applications_item");break;case"GAME_ITEM":b=d.translate("store|games_item")}return b}),i=function(a){var b="";switch(a){case"VIRTUAL_GIFT":b=d.translate("common|send");break;case"AVATAR":b=d.translate("common|download");break;case"EMOTICON":b=d.translate("common|download");break;case"STICKER":b=d.translate("common|download");break;case"APP_ITEM":b=d.translate("common|send");break;case"GAME_ITEM":b=d.translate("common|send")}return b},j=function(){return d.storeItemAllowedToBuyItemFromMigLevel(this)},k=function(){return d.storeItemAllowedToBuyItemFromGroup(this)},l=function(){return d.isGiftShowerItem(this)};b.registerHelper("getStoreItemImage",function(a,b){switch(a.type){case"VIRTUAL_GIFT":return g.site+"images/emoticons/virtualgifts/"+a.catalogImage+"_"+b+".png";case"AVATAR":return b=64===b?68:b,g.site+"images/avatar/"+a.catalogImage+"_"+b+".png";case"EMOTICON":return g.site+"img/emoticon/"+a.catalogImage+"_"+b+".png";case"STICKER":return g.site+"images/emoticons/stickers/"+a.catalogImage+"/"+a.previewImage+"_"+b+".png";case"APP_ITEM":case"GAME_ITEM":return a.referenceData.location64x64PNG}}),b.registerHelper("ifMiglevelAllowedToBuyItem",function(a){return j.call(this)?a.fn(this):a.inverse(this)}),b.registerHelper("getMigLevelRestrictedMessage",function(){if(!j.call(this)){var a=h(this.type).toLowerCase();return d.translate("store|restricted_miglevel_item",this.migLevelMin,a)}}),b.registerHelper("ifJoinedGroupAllowedToBuyItem",function(a){return k.call(this)?a.fn(this):a.inverse(this)}),b.registerHelper("getGroupRestrictedMessage",function(){if(!k.call(this)){var a=h(this.type).toLowerCase(),c=d.translate("store|restricted_group_item_tooltip",this.groupName,a),e=d.translate("store|restricted_group_item",'<a href="/group/'+this.groupId+'">'+this.groupName+"</a>");return new b.SafeString('<div title="'+c+'" style="cursor: pointer;">'+e+"</div>")}}),b.registerHelper("ifIsGiftShowerItem",function(a){return l.call(this)?a.fn(this):a.inverse(this)}),b.registerHelper("getGiftShowerRestrictedMessage",function(){return l.call(this)?d.translate("store|restricted_giftshower"):void 0}),b.registerHelper("getGiftShowerRestrictedTooltip",function(){return l.call(this)?d.translate("store|restricted_giftshower_tooltip",c.store.gift_shower_price,this.name):void 0}),b.registerHelper("getGiftShowerRestrictedSmallTooltip",function(){return d.translate("store|restricted_giftshower_tooltip_small",c.store.gift_shower_price)}),b.registerHelper("ifAllowedToBuyItem",function(a){return this.hasOwnProperty("skipAllowedToBuyItem")&&this.skipAllowedToBuyItem?a.fn(this):j.call(this)&&k.call(this)&&!l.call(this)?a.fn(this):a.inverse(this)}),b.registerHelper("ifAllowedToBuyItemInChat",function(a){return j.call(this)&&k.call(this)?a.fn(this):a.inverse(this)}),b.registerHelper("ifPremiumItem",function(a,b){return"VIRTUAL_GIFT"===a.type&&a.price>=c.store.premium_price?b.fn(this):b.inverse(this)}),b.registerHelper("getPremiumItemMessage",function(a){var b=h(a.type).toLowerCase();return d.translate("store|this_is_a_premium_item",b,d.round_number_decimal(.2*a.localPrice)+" "+a.localCurrency)}),b.registerHelper("getCongratsPremiumItemMessage",function(a){var b=h(a.type).toLowerCase();return d.translate("store|congrats_premium_gift",b,d.round_number_decimal(.2*a.localPrice)+" "+a.localCurrency)}),b.registerHelper("getNotAllowedToPurchaseItemTitle",function(){var a=h(this.type).toLowerCase(),b=i(this.type).toLowerCase();return j.call(this)?k.call(this)?l.call(this)?d.translate("store|error_title_purchase_price",b,a):void 0:d.translate("store|error_title_purchase_group",this.groupName,b,a):d.translate("store|error_title_purchase_miglevel",this.migLevelMin,b,a)}),b.registerHelper("getNotAllowedToPurchaseItemMessage",function(){var a=h(this.type).toLowerCase();i(this.type).toLowerCase();return j.call(this)?k.call(this)?l.call(this)?d.translate("store|error_message_purchase_price",h(this.type),d.round_number_decimal(this.localPrice)+" "+this.localCurrency,a,this.name):void 0:d.translate("store|error_message_purchase_group",this.groupName,this.groupId):d.translate("store|error_message_purchase_miglevel",f.getInstance().get("mig_level"))}),b.registerHelper("sendItemMessage",function(a){return d.translate("store|who_send_item",h(a.type).toLowerCase())}),b.registerHelper("sendItemButton",function(a){return d.translate("store|send_item",h(a.type).toLowerCase())}),b.registerHelper("successTitle",function(a){if("undefined"!=typeof this.storePartner&&this.buyForSelf){var c=this.storePartner,e="";return e=d.translate("store|success_title_appitems_self",c.store_category_name,this.name),e+="<br/>"+b.helpers.getCXBDownloadURL(this)}return d.translate("store|success_title_"+h(a.type).toLowerCase().replace(/\s/g,""))}),b.registerHelper("successMessage",function(a){return d.translate("store|success_message_"+h(a.type).toLowerCase().replace(/\s/g,""))}),b.registerHelper("getReceivedItemMessage",function(){var a=d.translate("common|you");return this.username!=f.getInstance().get("username")&&(a='<a href="'+d.get_profile_url(this.username)+'" class = "font-bold" title="'+this.username+'">'+this.username+"</a>"),d.translate("store|received_an_item",'<a href="'+d.get_profile_url(this.sender)+'" class = "font-bold" title="'+this.sender+'">'+this.sender+"</a>",a,this.name)}),b.registerHelper("getReceivedItemMessageSignature",function(){return d.translate("store|received_an_item_love",'<a href="'+d.get_profile_url(this.sender)+'" class = "font-bold" title="'+this.sender+'">'+this.sender+"</a>")}),b.registerHelper("getCXBMessage",function(a){if(null!=this.storePartner){var c=this.storePartner,e="";return e=d.translate("store|purchase_message_appitems",c.store_category_name,c.name),e+="<br/>"+b.helpers.getCXBDownloadURL(this)}}),b.registerHelper("getCXBDownloadURL",function(a){if(null!=a.storePartner&&null!=a.storePartner.content_data){var b=a.storePartner.content_data,c="",e="",f="",h="",i="";return null!=b.android_app_url&&(c='<a class="appstore-ico" href="'+b.android_app_url+'"><img src="'+g.migcore_cdn+'/resources/migme/img/prelogin/v4/googleplay.png"></a>'),null!=b.ios_app_url&&(e='<a class="appstore-ico" href="'+b.ios_app_url+'"><img src="'+g.migcore_cdn+'/resources/migme/img/prelogin/v4/appstore.png"></a>'),null!=b.website_url&&(f='<a class="appstore-ico" target="_blank" href="'+b.website_url+'"><img src="'+b.logo_image+'"></a>'),a.buyForSelf||(i="_sendgift"),c||e?h=d.translate("store|cxb_message_app"+i,c,e):f&&(h=d.translate("store|cxb_message_web"+i,f)),h}return""}),b.registerHelper("getGiftReceivedMessage",function(){var a=d.translate("user|gifts_received_a_gift_from",'<a href="'+d.get_profile_url(this.sender)+'" class="profile-hovercard" data-username="'+this.sender+'">'+this.sender+"</a>",'<a href="'+d.get_profile_url(this.username)+"/store/1/received/"+this.id+'">'+this.name+"</a>");return new b.SafeString(a)}),b.registerHelper("getGiftReceivedMessageOther",function(){var a=d.translate("user|gifts_received_a_gift_from_other",'<a href="'+d.get_profile_url(this.sender)+'" class="profile-hovercard" data-username="'+this.sender+'">'+this.sender+"</a>",'<a href="'+d.get_profile_url(this.username)+"/store/1/received/"+this.id+'">'+this.name+"</a>");return new b.SafeString(a)}),b.registerHelper("getGiftTip",function(a){var c=d.translate("store|tip_gift",a.name);return new b.SafeString(c)}),b.registerHelper("getInventoryItemUnlockedTitle",function(){var a=h(this.storeItemData.type).toLowerCase();return d.translate("store|inventory_this_is_an_unlock_item",a)}),b.registerHelper("getInventoryItemUnlockedMessage",function(){var a=h(this.storeItemData.type).toLowerCase();return d.translate("store|inventory_you_have_unlocked",this.count,this.storeItemData.name,a)})}),define("modules/view/common/gift_modal_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/globals/session_user","hbs!modules/template/common/gift-modal","modules/view/store/store_item_virtualgift_detail_item_view","modules/view/store/store_item_virtualgift_selection_item_view","modules/common/config","modules/common/utility","modules/chat/models/user_session","modules/template/helpers/general_helpers","modules/template/helpers/store_helpers"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=m.Session.getInstance(),o=e.ItemView.extend({template:{type:"handlebars",template:h},id:"gift-modal",className:"modal fade",onRender:function(){var a=this,b=require("modules/mig33_app");this.$el.data("giftModalViewObject",this),null!=n.get("account_balance")&&a.updateAccountBalance(l.add_thousands_seperator(n.get("account_balance"))+" "+n.get("currency_code")),b.vent.on(b.ApplicationEvents.ACCOUNT_BALANCE,function(b){a.updateAccountBalance(b)})},serializeData:function(){var a;return"undefined"!=typeof this.model&&(a=this.model.toJSON()),"undefined"!=typeof this.gift&&(a.gift=this.gift),a},ui:{container:".gift-container",giftComplete:".gift-complete",buyComplete:".buy-complete"},showGiftSelection:function(a,d){this.init();var e={type:"VIRTUAL_GIFT",skipAllowedToBuyItem:!0},f=new c.Model(e),h=this;d&&(this.postModel=d),f.purchase=function(a){switch(h.postModel&&(a.rootPostId=h.postModel.get("root_post").id,a.parentPostId=h.postModel.get("id")),"APP_ITEM"!==e.type&&"GAME_ITEM"!==e.type||""!==a.to||(a.to=g.username),this.source){case"post":a.purchaseLocation=k.store.purchase_location.POST;break;case"profile":a.purchaseLocation=k.store.purchase_location.PROFILE;break;default:a.purchaseLocation=k.store.purchase_location.STORE}var c=b.ajax({url:"/datasvc/store/item/"+h.gift.id+"/purchase",method:"post",data:JSON.stringify(a)}).then(function(b){if(b=l.parse_ajax_response(b),b.quantity=a.to.split(",").length,"undefined"!=typeof b.id){l.ecommerce_send_purchase_to_ga(b);var c="";b.parent_post=b.parent_post||{},h.postModel&&(b.parent_post.id=h.postModel.get("id"),c=h.postModel.get("author").alias);var d="/"+b.referenceData.location64x64PNG;b.body=l.translate("post|gift",b.name,c,d,a.message),b.media={photo:{url:{original:d,size_800:d}}},b.author=g,b.timestamp=Date.now(),b.type_text="photo",b.application_text=l.translate("common|application_text_web"),h.done();var e=require("modules/mig33_app");e.vent.trigger(e.ApplicationEvents.STORE_ITEM_PURCHASED+b.id,b,a.to.split(",")),"undefined"!=typeof a["private"]&&"false"!==a["private"]||e.vent.trigger(e.ApplicationEvents.POST_REPLY_ADDED,b)}else b.error?l.show_error(b.error):l.show_error(l.translate("store|error_purchase",h.model.getTypeNiceNameSingular())),h.close()});return c},f.getTypePurchaseAdjective=function(){var a=l.translate("purchase|"+this.get("type").toString().toLowerCase());return a},f.getTypeNiceNameSingular=function(){var a=l.translate("gift|"+this.get("type").toString().toLowerCase());return a},this.store=new j({model:f}),this.store.render(),this.store.on("gift_selected",function(a){h.gift=a,h.model=new c.Model(a),b(".success_img img",h.$el).attr("src","/"+a.referenceData.location64x64PNG)}),this.ui.container.html(this.store.$el);var i=b("#to");i.tagit()&&i.tagit("removeAll"),this.postModel&&this.postModel.get("author")&&this.addTagIt(this.postModel.get("author").username),this.checking_username_param()},showGiftItem:function(a,d,e){this.init(),this.action=d;var f=new c.Model(a),h=this;e&&(this.postModel=e),h.gift=a,h.model=f,h.render(),f.purchase=function(c){switch(h.postModel&&(c.rootPostId=h.postModel.get("root_post").id,c.parentPostId=h.postModel.get("id")),"APP_ITEM"!==a.type&&"GAME_ITEM"!==a.type||""!==c.to||(c.to=g.username),this.source){case"post":c.purchaseLocation=k.store.purchase_location.POST;break;default:c.purchaseLocation=k.store.purchase_location.STORE}var d=b.ajax({url:"/datasvc/store/item/"+a.id+"/purchase",method:"post",data:JSON.stringify(c)}).then(function(a){if(a=l.parse_ajax_response(a),a.quantity=c.to.split(",").length,"undefined"!=typeof a.id){l.ecommerce_send_purchase_to_ga(a);var b="";a.parent_post=a.parent_post||{},h.postModel&&(a.parent_post.id=h.postModel.get("id"),b=h.postModel.get("author").alias);var d="/"+a.referenceData.location64x64PNG;a.body=l.translate("post|gift",a.name,b,d,c.message),a.media={photo:{url:{original:d,size_800:d}}},a.author=g,a.timestamp=Date.now(),a.type_text="photo",h.done();var e=require("modules/mig33_app");e.vent.trigger(e.ApplicationEvents.STORE_ITEM_PURCHASED+a.id,a,c.to.split(",")),"undefined"!=typeof c["private"]&&"false"!==c["private"]||e.vent.trigger(e.ApplicationEvents.POST_REPLY_ADDED,a)}else a.error?l.show_error(a.error):l.show_error(l.translate("store|error_purchase",h.model.getTypeNiceNameSingular())),h.close()});return d},f.getTypePurchaseAdjective=function(){var a=l.translate("common|"+this.action.toLowerCase());return a},f.getTypeNiceNameSingular=function(){var a=l.translate("gift|"+this.get("type").toString().toLowerCase());return a},this.store=new i({model:f,action:d}),this.ui.container.html(this.store.render().$el);var j=b("#to");j.tagit()&&j.tagit("removeAll"),this.postModel&&this.postModel.get("author")&&this.addTagIt(this.postModel.get("author").username),this.checking_username_param()},init:function(){this.action="buy",this.ui.container.show(),this.ui.giftComplete.hide(),this.ui.buyComplete.hide()},close:function(){this.ui.container.hide(),b("#gift-modal").modal("hide")},done:function(){this.clear_username_param(),this.ui.container.hide(),"undefined"!=typeof this.action&&"buy"==this.action?(this.ui.buyComplete.show(),l.show_success(l.translate("store|success_buy_text"))):(this.ui.giftComplete.show(),l.show_success(l.translate("store|success_title_gift"))),setTimeout(function(){b("#gift-modal").modal("hide")},5e3)},addTagIt:function(a){if("undefined"==typeof a||null===a||!a)return!1;var c=b("#to");c.tagit()?(c.tagit("createTag",a),b("li",c.parent()).toggleClass("tagit-choice-editable","tagit-choice"),b("li a",c.parent()).remove()):c.text(a)},checking_username_param:function(){var a=3e5,c=l.getQueryString(),d="";c.username?(d=c.username,l.set_user_data("store_username_param",d),l.set_user_data("store_username_ts",b.now()+a)):null!=l.get_user_data("store_username_param")&&l.get_user_data("store_username_ts")>b.now()&&(d=l.get_user_data("store_username_param")),"undefined"==typeof d&&null==d&&""==d||this.addTagIt(d)},clear_username_param:function(){l.remove_user_data("store_username_param"),l.remove_user_data("store_username_ts")},updateAccountBalance:function(a){b(".account-balance",this.$el).text(a)},_get_sessionuser_username:function(){var a="";return window.session_user&&window.session_user.username&&(a=window.session_user.username),a},_check_logged_in:function(){return l.is_logged_in()?!0:(b("#gift-modal").modal("hide"),l.show_login_dialog(),!1)}});return o}),define("hbs!modules/template/chat_invite/chat-invite-modal",["handlebars"],function(a){return a.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},'<div class="modal-dialog">\n	<div class="modal-content">\n		<div class="modal-body">\n			<div class="col-sm-12">\n				<h4 id="chat-invite-modal-title" class="pull-left modal-title">Add people</h4>\n				<span class="icon-wb_closepopup close pull-right font-color-grey visible-xs" data-dismiss="modal"></span>\n			</div>\n			<div class="clearfix"></div>\n			<div class="row">\n				<label class="col-sm-12 share-label control-label">Invite friends on mig.</label>\n				<div class="chat-participant-container col-sm-12"></div>\n			</div>\n\n			<div class="row">\n				<div class="col-sm-12 external-invite-hr-container">\n					<hr class="external-invite-hr-left" />or<hr class="external-invite-hr-right" />\n				</div>\n			</div>\n			<div class="row">\n				<label class="col-sm-12 share-label control-label">Invite friends from Facebook or email.</label>\n			</div>\n			<div class="row external-invite-btn-container">\n				<div class="col-sm-6 fb-invite-dialog">\n					<div class="btn btn-default facebook-btn">\n						Facebook\n					</div>\n				</div>\n				<div class="col-sm-6 col-xs-mg-top-15">\n					<div class="btn btn-default email-btn col-no-padding email-invite-dialog">\n						Email\n					</div>\n				</div>\n			</div>\n\n			<div class="share-modal-spacing clear"></div>\n		</div>\n	</div>\n</div>'})}),define("hbs!modules/template/chat_invite/chat-invite-add-participant",["handlebars"],function(a){return a.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},'<select data-placeholder="Select user(s) to chat with" multiple class="add-participant-input"></select>\n<div class="btn-area" style="margin-top: 8px;">\n    <input type="button" class="start-chat btn btn-default" value="ADD" style="float: right">\n</div>'})});var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};if(define("modules/view/chat_invite/chat_invite_add_participant_view",["require","exports","../../chat/models/contacts","modules/export_marionette","backbone.marionette","marionette_handlebars","chosen","underscore","jquery","backbone","modules/common/utility","hbs!modules/template/chat_invite/chat-invite-add-participant"],function(a,b,c){function d(a){var b=[];return a.forEach(function(a){b.push(i.find_contact_by_name(a))}),b=f.compact(b)}function e(a){var b={};return a.forEach(function(a){b[a]=1}),b}var f=a("underscore"),g=a("jquery"),h=(a("modules/common/utility"),a("hbs!modules/template/chat_invite/chat-invite-add-participant")),i=c.ContactGroupStore.getInstance(),j=15,k=function(a){function b(b){this.template={type:"handlebars",template:h},this.events={"click .btn-danger":"_cancelBtnClick","click .start-chat":"_startChatClick","change .add-participant-input":"_toggleButtonArea"},this.className="chat-item-add-participant hidden",a.call(this,b)}return __extends(b,a),b.prototype.initialize=function(){f.bindAll(this)},b.prototype._cancelBtnClick=function(a){a.preventDefault(),this.hidePanel()},b.prototype._toggleButtonArea=function(a){var b=this.text_area.val();b&&b.length>0?this.button_area.find("input").removeAttr("disabled"):this.button_area.find("input").attr("disabled","disabled")},b.prototype.onRender=function(){this.text_area=g(".add-participant-input",this.$el),this.button_area=g(".btn-area",this.$el),this.text_area.chosen({max_selected_options:j,display_selected_options:!1,width:"100%"}),g(".search-field>input",this.$el).on("click",function(a){a.stopPropagation()})},b.prototype._triggerContactSelected=function(a){var b=this,c={contacts:d(a)};this.searchedParticipants&&a.forEach(function(a){b.searchedParticipants.forEach(function(b){b.getUsername()==a&&c.contacts.push(b)})});var e=jQuery.Event("ContactSelected",c);this.$el.trigger(e),this.trigger("ContactSelected",c),this._resetInput()},b.prototype._resetInput=function(){this.text_area.val([]).trigger("chosen:updated")},b.prototype._startChatClick=function(a){a.preventDefault(),this._triggerContactSelected(this.text_area.val()),this.hidePanel()},b.prototype._populateContent=function(a,b){var c=i.get_all_contacts(),d=e(b),f="<option></option>";c.each(function(a){a.isFusionContact()&&1!==d[a.getUsername()]&&(f+="<option>"+a.getUsername()+"</option>")}),g("input.start-chat",this.$el).text(a.toUpperCase()),this.contactList=f,this.text_area.html(f),this.text_area.trigger("chosen:updated")},b.prototype.addParticipant=function(a,b){this.searchedParticipants=a,a.length>0&&g(".no-results",this.$el).hide();var c=this.contactList;a.forEach(function(a){c.indexOf("<option>"+a.getUsername()+"</option")<0&&(c+="<option>"+a.getUsername()+"</option>")}),this.text_area.html(c),this.text_area.trigger("chosen:updated")},b.prototype.showPanel=function(a,b){return"undefined"==typeof a&&(a=""),"undefined"==typeof b&&(b=[]),this.$el.removeClass("hidden"),this._resetInput(),this._populateContent(a,b),!0},b.prototype.hidePanel=function(){return this._resetInput(),this.$el.addClass("hidden"),!0},b}(Marionette.ItemView);b.AddParticipantView=k}),define("modules/view/chat_invite/chat_invite_modal_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/chat_invite/chat-invite-modal","modules/common/config","modules/common/utility","modules/common/session_user","modules/chat/models/chats","modules/globals/variable","modules/globals/url","modules/view/chat_invite/chat_invite_add_participant_view","modules/chat/models/contacts","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=n.AddParticipantView,q=o.ContactModel,r=k.ChatStoreModel.getInstance(),s=e.ItemView.extend({template:{type:"handlebars",template:g},events:{"click .fb-invite-dialog":"fBInviteDialog","click .email-invite-dialog":"emailInviteDialog"},id:"chat-invite-modal",className:"modal fade",onRender:function(){this.$el.data("chatInviteModalViewObject",this)},populate:function(a){var c=this;this.addParticpantWindow=new p;var d=this.addParticpantWindow.render().$el;if(b(".chat-participant-container",this.$el).html(d),a?this.addParticpantWindow.showPanel("ADD",a.getParticipants()):this.addParticpantWindow.showPanel(),b(".chosen-choices .search-field .default").css("width","175px"),d.on("ContactSelected",function(c){a?a.addParticipants(c.contacts):r.startGroupChat(c.contacts),b("#chat-invite-modal").modal("hide")}),!a){var e,f=b(".search-field input",d);f.on("keyup",function(a){return"undefined"!=typeof c.ignore_keyup&&c.ignore_keyup?void(c.ignore_keyup=!1):(clearTimeout(e),void(e=setTimeout(function(){c.fetchSearchPeople()},500)))}),f.on("keydown",function(){clearTimeout(e)})}},fBInviteDialog:function(a){a.preventDefault();var c=j.getInstance().get("personalized_url"),d=m.site+"/sites/ajax/invite/refer_friend_facebook_submit?noredir=1";i.inviteFriendToFacebook(c,null,null,d),b("#chat-invite-modal").modal("hide")},emailInviteDialog:function(a){b("#invite-friends-trigger").data("data-source","chat_invite"),b("#chat-invite-modal").modal("hide"),b("#chat-invite-modal-email").modal("show")},fetchSearchPeople:function(){var a=this,c=b("li.search-field input",a.$el)[0],d=c.value;if(!(b("li.search-choice",this.$el).length>0||d.length<3)){b("li.no-results",this.$el).append(' <span class="icon-wb_loading_reload spin-cw"></span>');b.ajax({url:"/api/miniblog/search/users/1/?query="+d,method:"get"}).then(function(e){b("li.no-results .spin-cw",this.$el).remove(),e=i.parse_ajax_response(e);var f=[];if(c.value==d){if("undefined"==typeof e.results||null==e.results||e.results.length<=0)return a.addParticpantWindow.addParticipant(f,d),void a.searchDone(d);e.results.forEach(function(a){1==a.privacy.chat&&f.length<3&&(a.contactId=a.id,f.push(new q(a)))}),a.addParticpantWindow.addParticipant(f,d),a.searchDone(d)}})}},searchDone:function(a){var c=b("li.search-field input",this.$el);c[0].value=a,c.css("width","auto"),this.ignore_keyup=!0,c.trigger("keyup")}});return s}),define("hbs!modules/template/chat_invite/chat-invite-modal-email",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="row chat-invite-modal-dialog">\n    <div class="col-sm-offset-3 col-sm-6 modal-content">\n        <div class="row modal-body chat-invite-modal">\n            <div class="col-sm-12">\n                <div class="row ctr-bar">\n                    <div class="col-sm-12">\n                        <span class="back-btn bold-title"> Back </span>\n                        <span class="icon-wb_closepopup close pull-right font-color-grey visible-xs" data-dismiss="modal"></span>\n                    </div>\n                </div>\n\n                <div class="row">\n                    <div class="col-sm-12">\n                        <p id="chat-invite-modal-title" class="pull-left modal-title text-uppercase">INVITE VIA EAMIL</h4>\n                    </div>\n                </div>\n\n                <div class="row destinations-container">\n                    <p class="col-sm-12">\n                      <input type="text" name="body" id="chat-invite-destinations" value="" />\n                    </p>\n                </div>\n\n                <div class="row">\n                    <div class="col-sm-12">\n                        <div class="external-invite-msg">\n                            <textarea id="chat-invite-message" class="form-control" name="body" placeholder=\'Optional Message\'></textarea>\n                            <div class="external-invite-msg-count">\n                                <p class="text-right postbox-charcount"></p>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                <div class="row invite-chat-preview-btn-container">\n                    <div class="col-sm-4 col-sm-offset-4 invite-chat-preview text-center">\n                        <span id="invite-chat-preview-btn" class="text-uppercase">\n                            preview email\n                        </span>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n\n        <div id="invite-region" name="invite-region" class="row chat-invite-btn-container">\n            <input type="button" name="chat-invite-friends" class="chat-invite-button text-uppercase" value="'+j((f=c.translate||b&&b.translate,
g={hash:{},data:e},f?f.call(b,"discover|invite_now",g):i.call(b,"translate","discover|invite_now",g)))+'">            \n        </div>\n    </div>\n</div>\n'})}),define("modules/view/chat_invite/chat_invite_modal_email_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/chat_invite/chat-invite-modal-email","modules/common/config","modules/common/utility","modules/common/session_user","modules/globals/variable","modules/globals/url"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=e.ItemView.extend({template:{type:"handlebars",template:g},ui:{backBtn:".ctr-bar span:first-child",inviteFriends:'input[name="chat-invite-friends"]',previewBtn:"#invite-chat-preview-btn",textarea:'textarea[name="body"]',destinationBox:"#chat-invite-destinations",destinationBoxInput:"input.ui-widget-content",charCountBox:".postbox-charcount",inviteRegion:"#invite-region"},events:{"click     @ui.backBtn":"navBack","click     @ui.inviteFriends":"inviteFriends","click     @ui.previewBtn":"previewEmailsDialog","change    @ui.destinationBoxInput":"updateInviteBtnStatus","change    @ui.textarea":"updateCharCount","keyup     @ui.textarea":"updateCharCount","paste     @ui.textarea":"updateCharCount","mouseover @ui.textarea":"updateCharCount"},id:"chat-invite-modal-email",className:"modal fade",navBack:function(a){var c=b("#invite-friends-trigger");this.$el.modal("hide"),"header_invite"==c.data("data-source")?b("#invite-friends-modal").modal("show"):"chat_invite"==c.data("data-source")&&b("#chat-invite-modal").modal("show")},previewEmailsDialog:function(c){this.$el.modal("hide"),b("#tpl-custom-message p").empty().html(a.escape(this.ui.textarea.val())),b("#chat-invite-email-template-view").modal("show")},inviteFriends:function(c){c.preventDefault();var d=this,e=a.escape(this.ui.destinationBox.val()),f=a.escape(this.ui.textarea.val()),g=b("#chat-invite-modal-email");d.ui.textarea.prop("disabled",!0),f||(f=this.ui.textarea.attr("placeholder"));var k={data:{channel:1,type:1,destinations:e.split(","),invitationMetadata:{joinInvitationSubtype:15,chatInvitationMessage:f}}},l=b.ajax({type:"post",contentType:"application/json",data:b.toJSON(k),url:i.format(h.urls.invite,j.getInstance().get("id"))});return 0===e.length&&0===b("tagit-choice-editable").length?(b(".discover-invite-errormsg").show(),!1):(l.done(function(a){a=i.parse_ajax_response(a);var b=[],c=[];for(var e in a)if(a.hasOwnProperty(e)){var f=a[e];f>0?b.push(e):c.push(e)}b.length>0&&i.show_success(i.translate("discover|success_emails_invited",b.join(", "))),c.length>0&&i.show_error(i.translate("discover|error_sending_email",c.join(", "))),d.ui.textarea.prop("disabled",!1),d.ui.destinationBox.tagit("removeAll"),g.modal("hide")}),l.fail(function(a,b,c){i.show_error(c),d.ui.textarea.prop("disabled",!1)}),!0)},onRender:function(){var a=this;this.ui.destinationBox.tagit({fieldName:"chat-invite-destinations",placeholderText:i.translate("To"),caseSensitive:!1,tagLimit:5,onTagLimitExceeded:function(){i.show_error(i.translate("discover|error_emails_exceeded",5))},beforeTagAdded:function(c,d){var e=b(d.tag[0]).text(),f=e.substr(0,e.length-1);return a._validateEmail(f)?void 0:(i.show_error(i.translate("discover|error_valid_email",f)),a._disableInvite(),!1)},afterTagAdded:function(){a._enableInvite()}}),this._disableInvite()},_disableInvite:function(){this.ui.inviteRegion.addClass("chat-invite-btn-disable"),this.ui.inviteFriends.addClass("chat-invite-btn-disable"),this.ui.inviteFriends.prop("disabled",!0),b("#preview-invite-region").addClass("chat-invite-btn-disable"),b("input[name='preview-chat-invite-friends']").addClass("chat-invite-btn-disable"),b("input[name='preview-chat-invite-friends']").prop("disabled",!0)},_enableInvite:function(){this.ui.inviteRegion.removeClass("chat-invite-btn-disable"),this.ui.inviteFriends.removeClass("chat-invite-btn-disable"),this.ui.inviteRegion.prop("disabled",!1),b("#preview-invite-region").removeClass("chat-invite-btn-disable"),b("input[name='preview-chat-invite-friends']").removeClass("chat-invite-btn-disable"),b("input[name='preview-chat-invite-friends']").prop("disabled",!1)},updateCharCount:function(){var a=h.chat_invite.message_char_limit-this.ui.textarea.val().length;0>a?(this.ui.inviteFriends.prop("disabled",!0),this.ui.charCountBox.addClass("custom-message-error")):(this.ui.inviteFriends.prop("disabled",!1),this.ui.charCountBox.removeClass("custom-message-error")),this.ui.charCountBox.text(a)},updateInviteBtnStatus:function(b){var c=this.ui.destinationBox.tagit("assignedTags"),d=a.escape(b.target.value);""===d&&(c.length>0?this._enableInvite():this._disableInvite())},_validateEmail:function(a){var b=/^(([^<>()\[\]\\.,;:\s@\"]+(\.[^<>()\[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,c=b.test(a);return c}});return m}),define("hbs!modules/template/chat_invite/chat-invite-email-tpl-preview",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="row invite-email-preview-modal-dialog">\n    <div class="col-sm-offset-3 col-sm-6 modal-content">\n        <div class="row modal-body">\n            <div class="col-sm-12">\n                <!-- Top Control Bar -->\n                <div class="row ctr-bar">\n                    <div class="col-sm-12">\n                    <span class="back-btn bold-title">Edit Email</span>\n                    <span class="icon-wb_closepopup close pull-right font-color-grey visible-xs" data-dismiss="modal"></span>\n                    </div>\n                </div>\n\n                <div class="row">\n                    <div class="col-sm-12">\n                        <span class="bold-title text-uppercase">preview</span>\n                    </div>\n                </div>\n\n                <!-- Email Preview -->\n                <div id="email-preview-container" class="row email-preview-container">\n                    <div class="col-sm-12 email-preview-template"></div>\n                </div>\n            </div>\n        </div>\n\n        <!-- Invite Button -->\n        <div id="preview-invite-region" name="invite-region" class="row chat-invite-btn-container">\n            <input type="button" name="preview-chat-invite-friends" class="chat-invite-button text-uppercase" value="'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"discover|invite_now",g):i.call(b,"translate","discover|invite_now",g)))+'">\n        </div>\n    </div>\n</div>\n'})}),define("hbs!modules/template/chat_invite/chat-invite-email-tpl",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var c,d="";return d+="\n					"+m((c=a&&a.user,c=null==c||c===!1?c:c.name,typeof c===l?c.apply(a):c))+"\n				"}function g(a,b){var c,d="";return d+="\n					"+m((c=a&&a.user,c=null==c||c===!1?c:c.username,typeof c===l?c.apply(a):c))+"\n				"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var h,i,j,k="",l="function",m=this.escapeExpression,n=this,o=c.helperMissing;return k+='<div class="content-container" style="margin: 0;padding: 0;border: 0;font-size: 100%;font: inherit;vertical-align: baseline;padding-bottom: 53.3333px;width: 100%;padding-top: 0px;margin-top: 53.333333px;">\n\n	<!-- Company Logo -->\n	<div class="row company-logo-container" style="margin: 0;padding: 0;border: 0;font-size: 100%;font: inherit;vertical-align: baseline;width: 100%;">\n		<div class="company-logo centerred" style="margin: 0 auto;padding: 0;border: 0;font-size: 100%;font: inherit;vertical-align: baseline;float: none;width: 160px;height: 80px;">\n			<img src="'+m((h=b&&b.url,h=null==h||h===!1?h:h.cdn,typeof h===l?h.apply(b):h))+'/resources/img/migme_logo_160.png" style="margin: 0;padding: 0;border: 0;font-size: 100%;font: inherit;vertical-align: baseline;max-width: 100%;max-height: 100%;">\n		</div>\n	</div>\n\n	<!-- Invitation Text -->\n	<div class="row invitation-text-container" style="margin: 0;padding: 0;border: 0;font-size: 100%;font: inherit;vertical-align: baseline;width: 100%;">\n		<div class="invitation-text" style="margin: 0;padding: 0;border: 0;font-size: 100%;font: inherit;vertical-align: baseline;margin-top: 46.533333px;">\n			<p style="margin: 0;padding: 0;border: 0;font-size: 25px !important;font: inherit;vertical-align: baseline;font-family: &quot;Helvetica Neue&quot;;font-weight: normal;text-align: left;padding-right: 41px;padding-left: 1.8vw;">\n				<strong id="invitor" style="margin: 0;padding: 0;border: 0;font-size: 100%;font: inherit;vertical-align: baseline;font-weight: bold;">\n				',h=c["if"].call(b,(h=b&&b.user,null==h||h===!1?h:h.name),{hash:{},inverse:n.program(3,g,e),fn:n.program(1,f,e),data:e}),(h||0===h)&&(k+=h),k+='\n				</strong> wants to share photos, music, games and hottest updates with you.\n			</p>\n		</div>\n	</div>\n\n	<!-- User Avatar -->\n	<div class="row" style="margin: 0;padding: 0;border: 0;font-size: 100%;font: inherit;vertical-align: baseline;width: 100%;">\n		<div class="user-avatar" style="margin: 0;padding: 0;border: 0;font-size: 100%;font: inherit;vertical-align: baseline;background-color: #E8E8E8;height: 148px;width: 100%;position: relative;margin-top: 40.8px;">\n			<div class="user-avatar-upper" style="margin: 0;padding: 0;border: 0;font-size: 100%;font: inherit;vertical-align: baseline;position: absolute;background-color: #E8E8E8;-webkit-border-radius: 6.666667px 6.666667px 0 0;-moz-border-radius: 6.666667px 6.666667px 0 0;border-radius: 6.666667px 6.666667px 0 0;top: 0;right: 0;bottom: 50%;width: 100%;height: 50%;"></div>\n			<div class="user-avatar-bottom" style="margin: 0;padding: 0;border: 0;font-size: 100%;font: inherit;vertical-align: baseline;position: relative;background-color: #F8F8F8;height: 50%;right: 0;bottom: 0;top: 50%;width: 100%;"></div>\n			<div class="user-image centerred circular-lg" style="margin: auto;padding: 0;border: 0;font-size: 100%;font: inherit;vertical-align: baseline;width: 148px;height: 148px;border-radius: 124px;-webkit-border-radius: 124px;-moz-border-radius: 124px;float: none;position: absolute;top: 0;left: 0;right: 0;bottom: 0;z-index: 90;overflow: hidden;">\n				<img src="'+m((i=c.userGetDisplayPictureUrl||b&&b.userGetDisplayPictureUrl,j={hash:{},data:e},i?i.call(b,150,150,b&&b.user,j):o.call(b,"userGetDisplayPictureUrl",150,150,b&&b.user,j)))+'" width="150" height="150" class="img-circle" style="margin: 0;padding: 0;border: 0;font-size: 100%;font: inherit;vertical-align: baseline;"/>\n			</div>\n		</div>\n	</div>\n\n	<!-- User Related Information -->\n	<div class="row profile-container" style="margin: 0;padding: 0;border: 0;font-size: 100%;font: inherit;vertical-align: baseline;width: 100%;-webkit-border-radius: 0 0 6.666667px 6.666667px;-moz-border-radius: 0 0 6.666667px 6.666667px;border-radius: 0 0 6.666667px 6.666667px;background-color: #F8F8F8;padding-top: 17.5px;padding-bottom: 39.066667px;padding-left: ;">\n		<div class="row user-base-info" style="margin: 0;padding: 0;border: 0;font-size: 100%;font: inherit;vertical-align: baseline;width: 100%;">\n	  		<div class="username centerred" style="margin: 0 auto;padding: 0;border: 0;font-size: 24px !important;font: inherit;vertical-align: baseline;float: none;margin-bottom: 13.333333px;font-family: &quot;HelveticaNeue-Medium&quot;;text-align: center;">'+m((h=b&&b.user,h=null==h||h===!1?h:h.name,typeof h===l?h.apply(b):h))+'</div>\n	  		<div class="country centerred" style="margin: 0 auto;padding: 0;border: 0;font-size: 24px !important;font: inherit;vertical-align: baseline;float: none;font-family: &quot;HelveticaNeue-Light&quot;;text-align: center;">'+m((h=b&&b.user,h=null==h||h===!1?h:h.country,typeof h===l?h.apply(b):h))+'</div>\n		</div>\n\n		<!-- Display User Mig Info -->\n		<div class="user-info-list-container" style="font-size: normal; line-height: normal; font-style: normal; font-weight: normal; font-variant: normal; vertical-align: baseline; width: 100%; margin: 0; padding: 0; border: 0;">\n			<div class="row user-info-list" style="font-size: normal; line-height: normal; font-style: normal; font-weight: normal; font-variant: normal; vertical-align: baseline; width: 85%; text-align: center; margin: 15.466667px auto 0; padding: 0; border: 0;" align="center">\n				<div class="stat col-xs-6 col-sm-6 col-md-2" style="font-size: normal; line-height: normal; font-style: normal; font-weight: normal; font-variant: normal; vertical-align: baseline; margin: 0; border: 0;">\n					<p class="counter" style="vertical-align: baseline; text-align: center; color: #67B8A0; margin: 0; padding: 0; border: 0; font: 2vw \'Helvetica Neue\';" align="center">'+m((h=b&&b.user,h=null==h||h===!1?h:h.num_followers,typeof h===l?h.apply(b):h))+'</p>\n					<p class="stat-title" style="vertical-align: baseline; text-align: center; margin: 0; padding: 0; border: 0; font: 1vw \'Helvetica Neue\', \'HelveticaNeue-Medium\', \'HelveticaNeue-Light\', \'Helvetica Neue Light\', Helvetica, Arial, \'Lucida Grande\', sans-serif;" align="center">Fans</p>\n				</div>\n				<div class="stat col-xs-6 col-sm-6 col-md-2" style="font-size: normal; line-height: normal; font-style: normal; font-weight: normal; font-variant: normal; vertical-align: baseline; margin: 0; border: 0;">\n				  	<p class="counter" style="vertical-align: baseline; text-align: center; color: #67B8A0; margin: 0; padding: 0; border: 0; font: 2vw \'Helvetica Neue\';" align="center">'+m((h=b&&b.user,h=null==h||h===!1?h:h.num_badges_unlocked,typeof h===l?h.apply(b):h))+'</p>\n				  	<p class="stat-title" style="vertical-align: baseline; text-align: center; margin: 0; padding: 0; border: 0; font: 1vw \'Helvetica Neue\', \'HelveticaNeue-Medium\', \'HelveticaNeue-Light\', \'Helvetica Neue Light\', Helvetica, Arial, \'Lucida Grande\', sans-serif;" align="center">Badges</p>\n				</div>\n				<div class="stat col-xs-6 col-sm-6 col-md-2" style="font-size: normal; line-height: normal; font-style: normal; font-weight: normal; font-variant: normal; vertical-align: baseline; margin: 0; border: 0;">\n				  	<p class="counter" style="vertical-align: baseline; text-align: center; color: #67B8A0; margin: 0; padding: 0; border: 0; font: 2vw \'Helvetica Neue\';" align="center">'+m((h=b&&b.user,h=null==h||h===!1?h:h.num_gifts_received,typeof h===l?h.apply(b):h))+'</p>\n				  	<p class="stat-title" style="vertical-align: baseline; text-align: center; margin: 0; padding: 0; border: 0; font: 1vw \'Helvetica Neue\', \'HelveticaNeue-Medium\', \'HelveticaNeue-Light\', \'Helvetica Neue Light\', Helvetica, Arial, \'Lucida Grande\', sans-serif;" align="center">Gifts</p>\n				</div>\n				<div class="stat col-xs-6 col-sm-6 col-md-2" style="font-size: normal; line-height: normal; font-style: normal; font-weight: normal; font-variant: normal; vertical-align: baseline; margin: 0; border: 0;">\n				  	<p class="counter" style="vertical-align: baseline; text-align: center; color: #67B8A0; margin: 0; padding: 0; border: 0; font: 2vw \'Helvetica Neue\';" align="center">'+m((h=b&&b.user,h=null==h||h===!1?h:h.num_groups_joined,typeof h===l?h.apply(b):h))+'</p>\n				  	<p class="stat-title" style="vertical-align: baseline; text-align: center; margin: 0; padding: 0; border: 0; font: 1vw \'Helvetica Neue\', \'HelveticaNeue-Medium\', \'HelveticaNeue-Light\', \'Helvetica Neue Light\', Helvetica, Arial, \'Lucida Grande\', sans-serif;" align="center">Groups</p>\n				</div>\n				<div class="stat col-xs-6 col-sm-6 col-md-2" style="font-size: normal; line-height: normal; font-style: normal; font-weight: normal; font-variant: normal; vertical-align: baseline; margin: 0; border: 0;">\n				  	<p class="counter" style="vertical-align: baseline; text-align: center; color: #67B8A0; margin: 0; padding: 0; border: 0; font: 2vw \'Helvetica Neue\';" align="center">'+m((h=b&&b.user,h=null==h||h===!1?h:h.num_chatrooms_owned,typeof h===l?h.apply(b):h))+'</p>\n				  	<p class="stat-title" style="vertical-align: baseline; text-align: center; margin: 0; padding: 0; border: 0; font: 1vw \'Helvetica Neue\', \'HelveticaNeue-Medium\', \'HelveticaNeue-Light\', \'Helvetica Neue Light\', Helvetica, Arial, \'Lucida Grande\', sans-serif;" align="center">Chatrooms</p>\n				</div>\n				<div class="stat col-xs-6 col-sm-6 col-md-2" style="font-size: normal; line-height: normal; font-style: normal; font-weight: normal; font-variant: normal; vertical-align: baseline; margin: 0; border: 0;">\n					  <p class="counter" style="vertical-align: baseline; text-align: center; color: #67B8A0; margin: 0; padding: 0; border: 0; font: 2vw \'Helvetica Neue\';" align="center">'+m((h=b&&b.user,h=null==h||h===!1?h:h.num_games_played,typeof h===l?h.apply(b):h))+'</p>\n					  <p class="stat-title" style="vertical-align: baseline; text-align: center; margin: 0; padding: 0; border: 0; font: 1vw \'Helvetica Neue\', \'HelveticaNeue-Medium\', \'HelveticaNeue-Light\', \'Helvetica Neue Light\', Helvetica, Arial, \'Lucida Grande\', sans-serif;" align="center">Games</p>\n				</div>\n			 </div>\n		</div>\n\n		 <!-- Custom Invite Message -->\n		 <div class="custom-message-container" style="margin: 0;padding: 0;border: 0;font-size: 100%;font: inherit;vertical-align: baseline;margin-left: 40px;margin-right: 40px;">\n			 <div id="tpl-custom-message" class="custom-message" style="margin: 0;padding: 0;border: 0;font-size: 100%;font: inherit;vertical-align: baseline;-webkit-border-radius: 6.666667px;-moz-border-radius: 6.666667px;border-radius: 6.666667px;margin-top: 40.533333px;padding-top: 10.666667px;padding-bottom: 12px;padding-right: 32px;background-color: white;box-shadow: 0 2pt 4pt rgba(0, 0, 0, .2);">\n				<p style="margin: 0;padding: 0;border: 0;font-size: 18px !important;font: inherit;vertical-align: baseline;font-family: &quot;Roboto-Regular&quot; !important;text-align: center;"></p>\n			 </div>\n		 </div>\n\n		 <!-- View User Updates -->\n		<div class="view-updates-container" style="font-size: normal; line-height: normal; font-style: normal; font-weight: normal; font-variant: normal; vertical-align: baseline; margin: 40.27px 0 0; padding: 0; border: 0;">\n			<div class="view-updates" style="font-size: normal; line-height: normal; font-style: normal; font-weight: normal; font-variant: normal; vertical-align: baseline; -webkit-border-radius: 6.666667px; -moz-border-radius: 6.666667px; border-radius: 6.666667px; color: #FFF; width: 57%; background: #EF952B; margin: 0 auto; padding: 24px 36px; border: 0;">\n				<a href="'+m((h=b&&b.homefeed,h=null==h||h===!1?h:h.personalized_url,typeof h===l?h.apply(b):h))+"\" style=\"font-size: normal; line-height: normal; font-style: normal; font-weight: normal; font-variant: normal; vertical-align: baseline; text-decoration: none !important; color: inherit; margin: 0; padding: 0; border: 0;\">\n					<p style=\"text-align: center; vertical-align: baseline; margin: 0; padding: 0; border: 0; font: 21.333333px 'Helvetica Neue', 'HelveticaNeue-Medium', 'HelveticaNeue-Light', 'Helvetica Neue Light', Helvetica, Arial, 'Lucida Grande', sans-serif;\"> View "+m((h=b&&b.user,h=null==h||h===!1?h:h.username,typeof h===l?h.apply(b):h))+'\'s updates </p></a>\n			</div>\n		</div>\n\n\n		 <!-- List of Posts -->\n		 <div id="posts-container" class="row posts-container centre" style="margin: 0;padding: 0;border: 0;font-size: 100%;font: inherit;vertical-align: baseline;width: 87%;display: block;margin-left: auto;margin-right: auto;-webkit-border-radius: 6.666667px;-moz-border-radius: 6.666667px;border-radius: 6.666667px;margin-top: 40px;">	\n		 </div><!-- End of Posts -->\n\n		 <!-- View User Updates -->\n		<div class="view-updates-container" style="font-size: normal; line-height: normal; font-style: normal; font-weight: normal; font-variant: normal; vertical-align: baseline; margin: 40.27px 0 0; padding: 0; border: 0;">\n			<div class="view-updates" style="font-size: normal; line-height: normal; font-style: normal; font-weight: normal; font-variant: normal; vertical-align: baseline; -webkit-border-radius: 6.666667px; -moz-border-radius: 6.666667px; border-radius: 6.666667px; color: #FFF; width: 57%; background: #EF952B; margin: 0 auto; padding: 24px 36px; border: 0;">\n				<a href="'+m((h=b&&b.homefeed,h=null==h||h===!1?h:h.personalized_url,typeof h===l?h.apply(b):h))+"\" style=\"font-size: normal; line-height: normal; font-style: normal; font-weight: normal; font-variant: normal; vertical-align: baseline; text-decoration: none !important; color: inherit; margin: 0; padding: 0; border: 0;\">\n					<p style=\"text-align: center; vertical-align: baseline; margin: 0; padding: 0; border: 0; font: 21.333333px 'Helvetica Neue', 'HelveticaNeue-Medium', 'HelveticaNeue-Light', 'Helvetica Neue Light', Helvetica, Arial, 'Lucida Grande', sans-serif;\"> View "+m((h=b&&b.user,h=null==h||h===!1?h:h.username,typeof h===l?h.apply(b):h))+'\'s updates </p></a>\n			</div>\n		</div>\n\n		 <div class="row footer" style="font-size: normal; line-height: normal; font-style: normal; font-weight: normal; font-variant: normal; vertical-align: baseline; width: 100%; text-align: center; margin: 30.5pt 0 0; padding: 0; border: 0;" align="center">\n					<!-- Mig Intro Text -->\n					<div class="row" style="font-size: normal; line-height: normal; font-style: normal; font-weight: normal; font-variant: normal; vertical-align: baseline; width: 100%; margin: 0; padding: 0; border: 0;">\n						<div class="mig-intro" style="font-size: normal; border: 0; font-style: normal; font-variant: normal; padding: 0; line-height: normal; margin: 0; font-weight: normal; vertical-align: baseline;">\n							<p style="vertical-align: baseline; color: #7E7065; margin: 40px 0 0; padding: 0; border: 0; font: 1.5em \'Helvetica Neue\', \'HelveticaNeue-Medium\', \'HelveticaNeue-Light\', \'Helvetica Neue Light\', Helvetica, Arial, \'Lucida Grande\', sans-serif;">\n								mig is a fun place where you can chat with friends, meet new people, join conversations and just hangout.\n							</p>\n						</div>\n					</div>\n\n					<!-- Show Invitation Link -->\n					<div class="row" style="font-size: normal; line-height: normal; font-style: normal; font-weight: normal; font-variant: normal; vertical-align: baseline; width: 100%; margin: 0; padding: 0; border: 0;">\n						<div class="invitation-link" style="font-size: normal; line-height: normal; font-style: normal; font-weight: normal; font-variant: normal; vertical-align: baseline; margin: 37.333333pt 0 0; padding: 0; border: 0;">\n							<p style="vertical-align: baseline; color: #7E7065; margin: 0; padding: 0; border: 0; font: 1em \'Helvetica Neue\', \'HelveticaNeue-Medium\', \'HelveticaNeue-Light\', \'Helvetica Neue Light\', Helvetica, Arial, \'Lucida Grande\', sans-serif;">\n								Having problems with the link? You can also paste the following address into your browser: Invitation Link.\n							</p>\n						</div>\n					</div>\n\n					<!-- Copy Right -->\n					<div class="row" style="font-size: normal; line-height: normal; font-style: normal; font-weight: normal; font-variant: normal; vertical-align: baseline; width: 100%; margin: 0; padding: 0; border: 0;">\n						<div class="copy-right" style="font-size: normal; line-height: normal; font-style: normal; font-weight: normal; font-variant: normal; vertical-align: baseline; margin: 43.6px 0 0; padding: 0; border: 0;">\n							&#xA9;2007-2015 migme Limited. All Rights Reserved.\n						</div>\n					</div>\n			</div>\n	</div>\n</div>'})}),define("hbs!modules/template/chat_invite/chat-invite-email-tpl-homefeed",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h,i="",j="function",k=this.escapeExpression,l=c.helperMissing;return i+='<div class="post" style="margin: 0;padding: 24px 28px;border: 0;font-size: 100%;font: inherit;vertical-align: baseline;-moz-box-sizing: border-box;-webkit-box-sizing: border-box;box-sizing: border-box;width: 100%;padding-bottom: 22.666667px;margin-bottom: 18.666667px;background-color: #FFFFFF;">\n	<div class="row" style="margin: 0;padding: 0;border: 0;font-size: 100%;font: inherit;vertical-align: baseline;width: 100%;margin-top: 16px;">\n		<!-- User Photo -->\n		<div class="post-author-avatar float-left" style="margin: 0;padding: 8px 0 0 8px;border: 0;font-size: 100%;font: inherit;vertical-align: baseline;float: left;margin-right: 11.7px;">\n\n			<a href="'+k((f=b&&b.homefeed,f=null==f||f===!1?f:f.author,f=null==f||f===!1?f:f.personalized_url,typeof f===j?f.apply(b):f))+'" class="profile-hovercard" data-username="'+k((f=b&&b.homefeed,f=null==f||f===!1?f:f.author,f=null==f||f===!1?f:f.username,typeof f===j?f.apply(b):f))+'" data-hasqtip="268" oldtitle="'+k((f=b&&b.homefeed,f=null==f||f===!1?f:f.username,typeof f===j?f.apply(b):f))+'" title="" aria-describedby="qtip-268" style="margin: 0;padding: 0;border: 0;font-size: 100%;font: inherit;vertical-align: baseline;">\n				<img src="'+k((g=c.getDisplayPictureUrl||b&&b.getDisplayPictureUrl,h={hash:{},data:e},g?g.call(b,(f=b&&b.homefeed,f=null==f||f===!1?f:f.author,null==f||f===!1?f:f.username),(f=b&&b.homefeed,f=null==f||f===!1?f:f.author,null==f||f===!1?f:f.display_picture_type),36,36,h):l.call(b,"getDisplayPictureUrl",(f=b&&b.homefeed,f=null==f||f===!1?f:f.author,null==f||f===!1?f:f.username),(f=b&&b.homefeed,f=null==f||f===!1?f:f.author,null==f||f===!1?f:f.display_picture_type),36,36,h)))+'" width="36" height="36" class="circular-sm" style="margin: 0;padding: 0;border: 0;font-size: 100%;font: inherit;vertical-align: baseline;width: 48px;height: 48px;border-radius: 24px;-webkit-border-radius: 24px;-moz-border-radius: 24px;">\n			</a>\n		</div>\n\n		<div class="post-author" style="margin: 0;padding: 0;border: 0;font-size: 100%;font: inherit;vertical-align: baseline;padding-top: 18px;padding-left: 30px;">\n			<div class="post-author-name no-padding-left" style="margin: 0;padding: 0;border: 0;font-size: 100%;font: inherit;vertical-align: baseline;margin-bottom: 4px;text-align: left;padding-left: 0 !important;">\n				<a href="'+k((f=b&&b.homefeed,f=null==f||f===!1?f:f.author,f=null==f||f===!1?f:f.personalized_url,typeof f===j?f.apply(b):f))+'" class="profile-hovercard" data-username="'+k((f=b&&b.homefeed,f=null==f||f===!1?f:f.author,f=null==f||f===!1?f:f.username,typeof f===j?f.apply(b):f))+'" data-hasqtip="269" oldtitle="'+k((f=b&&b.homefeed,f=null==f||f===!1?f:f.author,f=null==f||f===!1?f:f.username,typeof f===j?f.apply(b):f))+'" title="" style="margin: 0;padding: 0;border: 0;font-size: 21.333333px;font: inherit;vertical-align: baseline;text-decoration: none;font-family: &quot;Roboto-Regular&quot;;color: #64B9A0;">'+k((f=b&&b.homefeed,f=null==f||f===!1?f:f.author,f=null==f||f===!1?f:f.username,typeof f===j?f.apply(b):f))+'</a>\n			</div>\n			<div class="post-time font-size12 no-padding-left" style="margin: 0;padding: 0;border: 0;font-size: 100%;font: inherit;vertical-align: baseline;float: left;padding-left: 0 !important;">\n				<a href="'+k((f=b&&b.homefeed,f=null==f||f===!1?f:f.permalink,typeof f===j?f.apply(b):f))+'" style="margin: 0;padding: 0;border: 0;font-size: 13.333333px;font: inherit;vertical-align: baseline;text-decoration: none;font-family: &quot;Roboto-Light&quot;;color: #999999;">\n					<time class="timeago" datetime="'+k((g=c.dateFormat||b&&b.dateFormat,h={hash:{},data:e},g?g.call(b,(f=b&&b.homefeed,null==f||f===!1?f:f.timestamp),"isoUtcDateTime",h):l.call(b,"dateFormat",(f=b&&b.homefeed,null==f||f===!1?f:f.timestamp),"isoUtcDateTime",h)))+'" style="margin: 0;padding: 0;border: 0;font-size: 100%;font: inherit;vertical-align: baseline;">'+k((f=b&&b.homefeed,f=null==f||f===!1?f:f.timestamp_relative,typeof f===j?f.apply(b):f))+"</time> via "+k((f=b&&b.homefeed,f=null==f||f===!1?f:f.application_text,typeof f===j?f.apply(b):f))+" "+k((f=b&&b.homefeed,f=null==f||f===!1?f:f.localtion,typeof f===j?f.apply(b):f))+'\n				</a>\n			</div>\n		</div>\n		<div class="clearfix" style="margin: 0;padding: 0;border: 0;font-size: 100%;font: inherit;vertical-align: baseline;zoom: 1;overflow: auto;clear: both;"></div>\n\n		<!-- User Name and Badges -->\n		<div class="post-author-status no-padding-left" style="margin: 0;padding: 0;border: 0;font-size: 100%;font: inherit;vertical-align: baseline;line-height: 1.2;margin-left: 6px;padding-left: 0 !important;"></div>\n	</div>\n\n	<!-- Post Text -->\n	<div class="row" style="margin: 0;padding: 0;border: 0;font-size: 100%;font: inherit;vertical-align: baseline;width: 100%;margin-top: 16px;">\n		<div class="post-text" style="margin: 0;padding: 0;border: 0;font-size: 21.333333px;font: inherit;vertical-align: baseline;text-align: left;font-family: &quot;Roboto-Light&quot;;color: #424242;word-wrap: break-word;">\n			<p style="margin: 0;padding: 0;border: 0;font-size: 21.3333px;font: inherit;vertical-align: baseline;font-family: &quot;Roboto-Medium&quot; !important;">',f=b&&b.homefeed,f=null==f||f===!1?f:f.body,f=typeof f===j?f.apply(b):f,(f||0===f)&&(i+=f),i+='</p>\n			<p style="margin: 0;padding: 0;border: 0;font-size: 21.3333px;font: inherit;vertical-align: baseline;font-family: &quot;Roboto-Medium&quot; !important;">\n			</p>\n		</div>\n	</div>\n\n	<!-- Post Image -->\n 	<div class="row" style="font-size: normal; line-height: normal; font-style: normal; font-weight: normal; font-variant: normal; vertical-align: baseline; width: 100%; margin: 16px 0 0; padding: 0; border: 0;">\n 		<div class="post-image" style="font-size: normal; border: 0; font-style: normal; font-variant: normal; padding: 0; line-height: normal; margin: 0; font-weight: normal; vertical-align: baseline;">\n   			<a href="'+k((f=b&&b.homefeed,f=null==f||f===!1?f:f.media,f=null==f||f===!1?f:f.photo,f=null==f||f===!1?f:f.url,f=null==f||f===!1?f:f.original,typeof f===j?f.apply(b):f))+'" style="font-size: normal; border: 0; font-style: normal; font-variant: normal; padding: 0; line-height: normal; margin: 0; font-weight: normal; vertical-align: baseline;">\n				<img class="post-image-img" src="'+k((f=b&&b.homefeed,f=null==f||f===!1?f:f.media,f=null==f||f===!1?f:f.photo,f=null==f||f===!1?f:f.url,f=null==f||f===!1?f:f.original,typeof f===j?f.apply(b):f))+'" style="font-size: normal; line-height: normal; font-style: normal; font-weight: normal; font-variant: normal; vertical-align: middle; max-width: 100%; max-height: 100%; margin: 0; padding: 0; border: 0;" /></a>\n		</div>\n	</div>\n</div><!-- End of Post -->'})}),define("modules/view/chat_invite/chat_invite_email_tpl_homefeed_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/chat_invite/chat-invite-email-tpl-homefeed","modules/common/config","modules/common/utility","modules/common/session_user","modules/common/local_storage","modules/common/nue","modules/globals/variable","modules/globals/url","modules/globals/session_user","modules/mig33_app","modules/template/helpers/general_helpers","jquery.atwho","jquery.textinputs","jquery.autosize","jquery.readmore"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=e.ItemView.extend({template:{type:"handlebars",template:g}});return p}),define("modules/view/chat_invite/chat_invite_email_tpl_homefeeds_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/view/chat_invite/chat_invite_email_tpl_homefeed_view","modules/common/config","modules/common/utility","modules/common/session_user","modules/common/local_storage","modules/common/nue","modules/globals/variable","modules/globals/url","modules/globals/session_user","modules/mig33_app","modules/template/helpers/general_helpers","jquery.atwho","jquery.textinputs","jquery.autosize","jquery.readmore"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=e.CollectionView.extend({itemView:g});return p}),define("modules/template/helpers/user_helpers",["underscore","handlebars","modules/common/utility","modules/common/session_user","modules/globals/session_user","modules/globals/url","modules/globals/variable","modules/common/guardset"],function(a,b,c,d,e,f,g,h){
b.registerHelper("userGetLabels",function(a){var d,f,g,h=[];if(d="session_user"===a&&e?e:a,d&&d.labels&&(d.label=d.labels),!d||!d.label)return"";if((d.label.fotm||d.label.isFotm)&&h.push('<span class="icon-wb_fotm user-label-fotm" title="'+c.translate("user|label_fotm")+'"></span>'),d.label.staff||d.label.isStaff?h.push('<span class="icon-wb_staff user-label-staff" title="'+c.translate("user|label_staff")+'"></span>'):(d.label.verified||d.label.isVerified)&&h.push('<span class="icon-wb_verified2 user-label-verified" title="'+c.translate("user|label_verified")+'"></span>'),null!==d.label.merchant){switch(f="",g="",d.label.merchant){case"M":f=c.translate("user|label_merchant"),g="icon-wb_merch";break;case"MT":f=c.translate("user|label_merchant_mentor"),g="icon-wb_merchmentor"}h.push('<span class="'+g+' user-label-merchant" title="'+f+'"></span>')}if(null!==d.label.admin){switch(f="",g="",d.label.admin){case"A":f=c.translate("user|label_admin"),g="icon-wb_admin";break;case"C":f=c.translate("user|label_coach"),g="icon-wb_coach";break;case"GA":f=c.translate("user|label_admin_group"),g="icon-wb_gadmin";break;case"CA":f=c.translate("user|label_admin_chatroom"),g="icon-wb_cadmin"}h.push('<span class="'+g+' user-label-admin" title="'+f+'"></span>')}return d.label.mig137&&h.push('<span class="icon-wb_mig137 user-label-mig137" title="'+c.translate("user|label_mig137")+'"></span>'),new b.SafeString(h.join("&nbsp;"))}),b.registerHelper("userGetName",function(a){var b=a||this;if(!b)return"";var c=b.name;return c||(c=b.username),c}),b.registerHelper("userGetDisplayPictureUrl",function(a,b,d){var e=d||this;return e?c.get_display_picture_url(e.username,e.display_picture_type,a,b):""}),b.registerHelper("userGetRelationship",function(a){var b=a||this;return b?g.relationship.status[b.relationship_status]:""}),b.registerHelper("userGetGenderHeShe",function(a){var b=a||this;if(!b)return"";switch(b.gender){case"M":return g.gender.heshe.M;case"F":return g.gender.heshe.F;default:return""}}),b.registerHelper("userGetGender",function(a){var b=a||this;if(!b)return"";switch(b.gender){case"M":return g.gender.name.M;case"F":return g.gender.name.F;default:return""}});var i=[c.translate("date|january"),c.translate("date|february"),c.translate("date|march"),c.translate("date|april"),c.translate("date|may"),c.translate("date|june"),c.translate("date|july"),c.translate("date|august"),c.translate("date|september"),c.translate("date|october"),c.translate("date|november"),c.translate("date|december")];b.registerHelper("userGetDob",function(a){var b=a||this;if(!b)return"";var c,d=new Date(0);return c="undefined"==typeof b.date_of_birth?b.dateOfBirth:b.date_of_birth,isNaN(c)?c:(d.setUTCSeconds(c),d.getDate()+" "+i[d.getMonth()]+" "+d.getFullYear())});var j=function(a){var b=a||this;if(!b)return"";var c,d=new Date;c="undefined"==typeof b.date_of_birth?b.dateOfBirth:b.date_of_birth;var e=new Date(1e3*c),f=d.getFullYear()-e.getFullYear();return!isNaN(f)};b.registerHelper("ifUserCanShowAge",function(a,b){var c=j.call(this,a);return c?b.fn(this):b.inverse(this)}),b.registerHelper("userCanShowAge",j),b.registerHelper("userGetAge",function(a){var b=a||this;if(!b)return"";var c,d=new Date;c="undefined"==typeof b.date_of_birth?b.dateOfBirth:b.date_of_birth;var e=new Date(1e3*c),f=d.getFullYear()-e.getFullYear();if(!isNaN(f)){var g=d.getMonth()-e.getMonth();return(0>g||0===g&&d.getDate()<e.getDate())&&f--,f}return 0}),b.registerHelper("userGetMigbotImage",function(d,g,h,i){var j=i||this;j="session_user"===d&&e?e:d;var k=c.translate("user|miglevel_with_level","<span>"+j.mig_level+"</span>"),l=a.escape(k);h=h||!1;var m="";return m=null===j.migbot_image?'<img src="'+f.emoticon+"/images/reputation/rank-egg-1-"+g+"x"+g+'.png"  title="'+l+'" alt="'+l+'" width="'+g+'" height="'+g+'" />':'<img src="'+f.emoticon+"/images/reputation/"+j.migbot_image+"-"+g+"x"+g+'.png"  title="'+l+'" alt="'+l+'" width="'+g+'" height="'+g+'" />',h&&(m+="&nbsp;"+k),new b.SafeString(m)}),b.registerHelper("ifIsOwnProfile",function(a,b){return d.getInstance().get("username")===a?b.fn(this):b.inverse(this)}),b.registerHelper("ifSessionUserIsMerchant",function(a){return null!==d.getInstance().get("label").merchant?a.fn(this):a.inverse(this)}),b.registerHelper("ifUserCanAccessDoku",function(a){return"Indonesia"==d.getInstance().get("country")?a.fn(this):a.inverse(this)}),b.registerHelper("ifShowRecUsers",function(a,b){return a.isSelf||a.isFollowerPendingApproval||a.isFriend||a.isFollower?b.inverse(this):b.fn(this)}),b.registerHelper("ifUserCanAccessMOL",function(a){return d.getInstance().get("label")&&d.getInstance().get("label").merchant?a.inverse(this):a.fn(this)}),b.registerHelper("ifUserCanAccessDompetku",function(a){return"Indonesia"==d.getInstance().get("country")?a.fn(this):a.inverse(this)}),b.registerHelper("ifUserCanAccessMimopay",function(a){return"Indonesia"==d.getInstance().get("country")?a.fn(this):a.inverse(this)}),b.registerHelper("ifUserCanAccessEsewa",function(a){return"Nepal"==d.getInstance().get("country")?a.fn(this):a.inverse(this)}),b.registerHelper("ifUserCanAccessYippster",function(a){return"India"==d.getInstance().get("country")?a.fn(this):a.inverse(this)}),b.registerHelper("ifUserCanAccessPaytm",function(a){return"India"==d.getInstance().get("country")?a.fn(this):a.inverse(this)}),b.registerHelper("ifUserCanAccessWesternUnion",function(a){return a.inverse(this)})}),define("modules/view/chat_invite/chat_invite_email_tpl_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/chat_invite/chat-invite-email-tpl","modules/view/chat_invite/chat_invite_email_tpl_homefeeds_collection_view","modules/model/user/user_model","modules/common/config","modules/common/utility","modules/common/session_user","modules/common/local_storage","modules/common/nue","modules/globals/variable","modules/globals/url","modules/globals/session_user","modules/template/helpers/user_helpers","modules/template/helpers/general_helpers","modules/mig33_app","jquery.atwho","jquery.textinputs","jquery.autosize","jquery.readmore"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){var r=c.Model.extend({}),s=c.Collection.extend({model:r}),t=e.ItemView.extend({template:{type:"handlebars",template:g},ui:{messageBox:"#custom-message",postContainer:"#posts-container",viewUpdatesButton:".view-updates-container"},initialize:function(){},serializeData:function(a){var b=l.getInstance().attributes;return{url:p,user:b}},_requestHomefeeds:function(c){var d=j.urls.profile_feed_url+"/"+q.get("id");for(var e in c)d+="/"+c[e];var f=d+"?_="+q.get("id"),g=b.ajax({type:"get",contentType:"application/json",url:f}),h=a.bind(this._generateProfileFeeds,this);g.done(h),g.fail(function(a,b,c){console.warn(c)})},onRender:function(){if(k.is_logged_in()){var a={currentPage:1,variableLimit:3,profilefeedLimit:1,reshareLimit:1};this._requestHomefeeds(a)}},_generateProfileFeeds:function(a){var b=new s;a.data.forEach(function(a){var c=new r({homefeed:a});b.add(c)}),0==b.length&&this.ui.viewUpdatesButton.eq(1).hide();var c=new h({collection:b});this.ui.postContainer.append(c.render().el)}});return t}),define("modules/view/chat_invite/chat_invite_email_tpl_preview_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/chat_invite/chat-invite-email-tpl-preview","modules/view/chat_invite/chat_invite_email_tpl_view","modules/common/config","modules/common/utility","modules/common/session_user","modules/common/local_storage","modules/common/nue","modules/globals/variable","modules/globals/url","modules/globals/session_user","modules/mig33_app","modules/template/helpers/general_helpers","jquery.atwho","jquery.textinputs","jquery.autosize","jquery.readmore"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p){var q=e.ItemView.extend({template:{type:"handlebars",template:g},className:"modal fade",id:"chat-invite-email-template-view",ui:{emailTplContainer:"#email-preview-container div:first-child",backBtn:".ctr-bar span:first-child",inviteFriends:'input[name="preview-chat-invite-friends"]'},events:{"click @ui.backBtn":"navBack","click @ui.inviteFriends":"inviteFriends"},navBack:function(a){this.$el.modal("hide"),b("#chat-invite-modal-email").modal("show")},onRender:function(){var a=new h,c=b("#invite-friends-trigger"),d=this;this.$el.on("show.bs.modal",function(a){"sidebar_invite"==c.data("data-source")?d.ui.backBtn.hide():d.ui.backBtn.show()}),this.ui.emailTplContainer.append(a.render().el)},inviteFriends:function(){var a=this,c=b("#chat-invite-destinations"),d=b("#chat-invite-message"),e=c.tagit("assignedTags"),f=d.val();d.prop("disabled",!0),f||(f=d.attr("placeholder"));var g={data:{channel:1,type:1,destinations:e,invitationMetadata:{joinInvitationSubtype:15,chatInvitationMessage:f}}},h=b.ajax({type:"post",contentType:"application/json",data:b.toJSON(g),url:j.format(i.urls.invite,k.getInstance().get("id"))});return 0===e.length&&0===b("tagit-choice-editable").length?(b(".discover-invite-errormsg").show(),!1):(h.done(function(b){b=j.parse_ajax_response(b);var e=[],f=[];for(var g in b)if(b.hasOwnProperty(g)){var h=b[g];h>0?e.push(g):f.push(g)}e.length>0&&j.show_success(j.translate("discover|success_emails_invited",e.join(", "))),f.length>0&&j.show_error(j.translate("discover|error_sending_email",f.join(", "))),d.prop("disabled",!1),c.tagit("removeAll"),a.$el.modal("hide")}),h.fail(function(a,b,c){j.show_error(c),d.prop("disabled",!1)}),!0)}});return q}),"undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");+function(a){function b(){var a=document.createElement("bootstrap"),b={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var c in b)if(void 0!==a.style[c])return{end:b[c]};return!1}a.fn.emulateTransitionEnd=function(b){var c=!1,d=this;a(this).one(a.support.transition.end,function(){c=!0});var e=function(){c||a(d).trigger(a.support.transition.end)};return setTimeout(e,b),this},a(function(){a.support.transition=b()})}(jQuery),+function(a){var b='[data-dismiss="alert"]',c=function(c){a(c).on("click",b,this.close)};c.prototype.close=function(b){function c(){f.trigger("closed.bs.alert").remove()}var d=a(this),e=d.attr("data-target");e||(e=d.attr("href"),e=e&&e.replace(/.*(?=#[^\s]*$)/,""));var f=a(e);b&&b.preventDefault(),f.length||(f=d.hasClass("alert")?d:d.parent()),f.trigger(b=a.Event("close.bs.alert")),b.isDefaultPrevented()||(f.removeClass("in"),a.support.transition&&f.hasClass("fade")?f.one(a.support.transition.end,c).emulateTransitionEnd(150):c())};var d=a.fn.alert;a.fn.alert=function(b){return this.each(function(){var d=a(this),e=d.data("bs.alert");e||d.data("bs.alert",e=new c(this)),"string"==typeof b&&e[b].call(d)})},a.fn.alert.Constructor=c,a.fn.alert.noConflict=function(){return a.fn.alert=d,this},a(document).on("click.bs.alert.data-api",b,c.prototype.close)}(jQuery),+function(a){var b=function(c,d){this.$element=a(c),this.options=a.extend({},b.DEFAULTS,d),this.isLoading=!1};b.DEFAULTS={loadingText:"loading..."},b.prototype.setState=function(b){var c="disabled",d=this.$element,e=d.is("input")?"val":"html",f=d.data();b+="Text",f.resetText||d.data("resetText",d[e]()),d[e](f[b]||this.options[b]),setTimeout(a.proxy(function(){"loadingText"==b?(this.isLoading=!0,d.addClass(c).attr(c,c)):this.isLoading&&(this.isLoading=!1,d.removeClass(c).removeAttr(c))},this),0)},b.prototype.toggle=function(){var a=!0,b=this.$element.closest('[data-toggle="buttons"]');if(b.length){var c=this.$element.find("input");"radio"==c.prop("type")&&(c.prop("checked")&&this.$element.hasClass("active")?a=!1:b.find(".active").removeClass("active")),a&&c.prop("checked",!this.$element.hasClass("active")).trigger("change")}a&&this.$element.toggleClass("active")};var c=a.fn.button;a.fn.button=function(c){return this.each(function(){var d=a(this),e=d.data("bs.button"),f="object"==typeof c&&c;e||d.data("bs.button",e=new b(this,f)),"toggle"==c?e.toggle():c&&e.setState(c)})},a.fn.button.Constructor=b,a.fn.button.noConflict=function(){return a.fn.button=c,this},a(document).on("click.bs.button.data-api","[data-toggle^=button]",function(b){var c=a(b.target);c.hasClass("btn")||(c=c.closest(".btn")),c.button("toggle"),b.preventDefault()})}(jQuery),+function(a){var b=function(b,c){this.$element=a(b),this.$indicators=this.$element.find(".carousel-indicators"),this.options=c,this.paused=this.sliding=this.interval=this.$active=this.$items=null,"hover"==this.options.pause&&this.$element.on("mouseenter",a.proxy(this.pause,this)).on("mouseleave",a.proxy(this.cycle,this))};b.DEFAULTS={interval:5e3,pause:"hover",wrap:!0},b.prototype.cycle=function(b){return b||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(a.proxy(this.next,this),this.options.interval)),this},b.prototype.getActiveIndex=function(){return this.$active=this.$element.find(".item.active"),this.$items=this.$active.parent().children(),this.$items.index(this.$active)},b.prototype.to=function(b){var c=this,d=this.getActiveIndex();return b>this.$items.length-1||0>b?void 0:this.sliding?this.$element.one("slid.bs.carousel",function(){c.to(b)}):d==b?this.pause().cycle():this.slide(b>d?"next":"prev",a(this.$items[b]))},b.prototype.pause=function(b){return b||(this.paused=!0),this.$element.find(".next, .prev").length&&a.support.transition&&(this.$element.trigger(a.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},b.prototype.next=function(){return this.sliding?void 0:this.slide("next")},b.prototype.prev=function(){return this.sliding?void 0:this.slide("prev")},b.prototype.slide=function(b,c){var d=this.$element.find(".item.active"),e=c||d[b](),f=this.interval,g="next"==b?"left":"right",h="next"==b?"first":"last",i=this;if(!e.length){if(!this.options.wrap)return;e=this.$element.find(".item")[h]()}if(e.hasClass("active"))return this.sliding=!1;var j=a.Event("slide.bs.carousel",{relatedTarget:e[0],direction:g});return this.$element.trigger(j),j.isDefaultPrevented()?void 0:(this.sliding=!0,f&&this.pause(),this.$indicators.length&&(this.$indicators.find(".active").removeClass("active"),this.$element.one("slid.bs.carousel",function(){var b=a(i.$indicators.children()[i.getActiveIndex()]);b&&b.addClass("active")})),a.support.transition&&this.$element.hasClass("slide")?(e.addClass(b),e[0].offsetWidth,d.addClass(g),e.addClass(g),d.one(a.support.transition.end,function(){e.removeClass([b,g].join(" ")).addClass("active"),d.removeClass(["active",g].join(" ")),i.sliding=!1,setTimeout(function(){i.$element.trigger("slid.bs.carousel")},0)}).emulateTransitionEnd(1e3*d.css("transition-duration").slice(0,-1))):(d.removeClass("active"),e.addClass("active"),this.sliding=!1,this.$element.trigger("slid.bs.carousel")),f&&this.cycle(),this)};var c=a.fn.carousel;a.fn.carousel=function(c){return this.each(function(){var d=a(this),e=d.data("bs.carousel"),f=a.extend({},b.DEFAULTS,d.data(),"object"==typeof c&&c),g="string"==typeof c?c:f.slide;e||d.data("bs.carousel",e=new b(this,f)),"number"==typeof c?e.to(c):g?e[g]():f.interval&&e.pause().cycle()})},a.fn.carousel.Constructor=b,a.fn.carousel.noConflict=function(){return a.fn.carousel=c,this},a(document).on("click.bs.carousel.data-api","[data-slide], [data-slide-to]",function(b){var c,d=a(this),e=a(d.attr("data-target")||(c=d.attr("href"))&&c.replace(/.*(?=#[^\s]+$)/,"")),f=a.extend({},e.data(),d.data()),g=d.attr("data-slide-to");g&&(f.interval=!1),e.carousel(f),(g=d.attr("data-slide-to"))&&e.data("bs.carousel").to(g),b.preventDefault()}),a(window).on("load",function(){a('[data-ride="carousel"]').each(function(){var b=a(this);b.carousel(b.data())})})}(jQuery),+function(a){var b=function(c,d){this.$element=a(c),this.options=a.extend({},b.DEFAULTS,d),this.transitioning=null,this.options.parent&&(this.$parent=a(this.options.parent)),this.options.toggle&&this.toggle()};b.DEFAULTS={toggle:!0},b.prototype.dimension=function(){var a=this.$element.hasClass("width");return a?"width":"height"},b.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var b=a.Event("show.bs.collapse");if(this.$element.trigger(b),!b.isDefaultPrevented()){var c=this.$parent&&this.$parent.find("> .panel > .in");if(c&&c.length){var d=c.data("bs.collapse");if(d&&d.transitioning)return;c.collapse("hide"),d||c.data("bs.collapse",null)}var e=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[e](0),this.transitioning=1;var f=function(){this.$element.removeClass("collapsing").addClass("collapse in")[e]("auto"),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!a.support.transition)return f.call(this);var g=a.camelCase(["scroll",e].join("-"));this.$element.one(a.support.transition.end,a.proxy(f,this)).emulateTransitionEnd(350)[e](this.$element[0][g])}}},b.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var b=a.Event("hide.bs.collapse");if(this.$element.trigger(b),!b.isDefaultPrevented()){var c=this.dimension();this.$element[c](this.$element[c]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse").removeClass("in"),this.transitioning=1;var d=function(){this.transitioning=0,this.$element.trigger("hidden.bs.collapse").removeClass("collapsing").addClass("collapse")};return a.support.transition?void this.$element[c](0).one(a.support.transition.end,a.proxy(d,this)).emulateTransitionEnd(350):d.call(this)}}},b.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()};var c=a.fn.collapse;a.fn.collapse=function(c){return this.each(function(){var d=a(this),e=d.data("bs.collapse"),f=a.extend({},b.DEFAULTS,d.data(),"object"==typeof c&&c);!e&&f.toggle&&"show"==c&&(c=!c),e||d.data("bs.collapse",e=new b(this,f)),"string"==typeof c&&e[c]()})},a.fn.collapse.Constructor=b,a.fn.collapse.noConflict=function(){return a.fn.collapse=c,this},a(document).on("click.bs.collapse.data-api","[data-toggle=collapse]",function(b){var c,d=a(this),e=d.attr("data-target")||b.preventDefault()||(c=d.attr("href"))&&c.replace(/.*(?=#[^\s]+$)/,""),f=a(e),g=f.data("bs.collapse"),h=g?"toggle":d.data(),i=d.attr("data-parent"),j=i&&a(i);g&&g.transitioning||(j&&j.find('[data-toggle=collapse][data-parent="'+i+'"]').not(d).addClass("collapsed"),d[f.hasClass("in")?"addClass":"removeClass"]("collapsed")),f.collapse(h)})}(jQuery),+function(a){function b(b){a(d).remove(),a(e).each(function(){var d=c(a(this)),e={relatedTarget:this};d.hasClass("open")&&(d.trigger(b=a.Event("hide.bs.dropdown",e)),b.isDefaultPrevented()||d.removeClass("open").trigger("hidden.bs.dropdown",e))})}function c(b){var c=b.attr("data-target");c||(c=b.attr("href"),c=c&&/#[A-Za-z]/.test(c)&&c.replace(/.*(?=#[^\s]*$)/,""));var d=c&&a(c);return d&&d.length?d:b.parent()}var d=".dropdown-backdrop",e="[data-toggle=dropdown]",f=function(b){a(b).on("click.bs.dropdown",this.toggle)};f.prototype.toggle=function(d){var e=a(this);if(!e.is(".disabled, :disabled")){var f=c(e),g=f.hasClass("open");if(b(),!g){"ontouchstart"in document.documentElement&&!f.closest(".navbar-nav").length&&a('<div class="dropdown-backdrop"/>').insertAfter(a(this)).on("click",b);var h={relatedTarget:this};if(f.trigger(d=a.Event("show.bs.dropdown",h)),d.isDefaultPrevented())return;f.toggleClass("open").trigger("shown.bs.dropdown",h),e.focus()}return!1}},f.prototype.keydown=function(b){if(/(38|40|27)/.test(b.keyCode)){var d=a(this);if(b.preventDefault(),b.stopPropagation(),!d.is(".disabled, :disabled")){var f=c(d),g=f.hasClass("open");if(!g||g&&27==b.keyCode)return 27==b.which&&f.find(e).focus(),d.click();var h=" li:not(.divider):visible a",i=f.find("[role=menu]"+h+", [role=listbox]"+h);if(i.length){var j=i.index(i.filter(":focus"));38==b.keyCode&&j>0&&j--,40==b.keyCode&&j<i.length-1&&j++,~j||(j=0),i.eq(j).focus()}}}};var g=a.fn.dropdown;a.fn.dropdown=function(b){return this.each(function(){var c=a(this),d=c.data("bs.dropdown");d||c.data("bs.dropdown",d=new f(this)),"string"==typeof b&&d[b].call(c)})},a.fn.dropdown.Constructor=f,a.fn.dropdown.noConflict=function(){return a.fn.dropdown=g,this},a(document).on("click.bs.dropdown.data-api",b).on("click.bs.dropdown.data-api",".dropdown form",function(a){a.stopPropagation()}).on("click.bs.dropdown.data-api",e,f.prototype.toggle).on("keydown.bs.dropdown.data-api",e+", [role=menu], [role=listbox]",f.prototype.keydown)}(jQuery),+function(a){var b=function(b,c){this.options=c,this.$element=a(b),this.$backdrop=this.isShown=null,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,a.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};b.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},b.prototype.toggle=function(a){return this[this.isShown?"hide":"show"](a)},b.prototype.show=function(b){var c=this,d=a.Event("show.bs.modal",{relatedTarget:b});this.$element.trigger(d),this.isShown||d.isDefaultPrevented()||(this.isShown=!0,this.escape(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',a.proxy(this.hide,this)),this.backdrop(function(){var d=a.support.transition&&c.$element.hasClass("fade");c.$element.parent().length||c.$element.appendTo(document.body),c.$element.show().scrollTop(0),d&&c.$element[0].offsetWidth,c.$element.addClass("in").attr("aria-hidden",!1),c.enforceFocus();var e=a.Event("shown.bs.modal",{relatedTarget:b});d?c.$element.find(".modal-dialog").one(a.support.transition.end,function(){c.$element.focus().trigger(e)}).emulateTransitionEnd(300):c.$element.focus().trigger(e)}))},b.prototype.hide=function(b){b&&b.preventDefault(),b=a.Event("hide.bs.modal"),this.$element.trigger(b),this.isShown&&!b.isDefaultPrevented()&&(this.isShown=!1,this.escape(),a(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.bs.modal"),a.support.transition&&this.$element.hasClass("fade")?this.$element.one(a.support.transition.end,a.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal())},b.prototype.enforceFocus=function(){a(document).off("focusin.bs.modal").on("focusin.bs.modal",a.proxy(function(a){this.$element[0]===a.target||this.$element.has(a.target).length||this.$element.focus()},this))},b.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.bs.modal",a.proxy(function(a){27==a.which&&this.hide()},this)):this.isShown||this.$element.off("keyup.dismiss.bs.modal")},b.prototype.hideModal=function(){var a=this;this.$element.hide(),this.backdrop(function(){a.removeBackdrop(),a.$element.trigger("hidden.bs.modal")})},b.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},b.prototype.backdrop=function(b){var c=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var d=a.support.transition&&c;if(this.$backdrop=a('<div class="modal-backdrop '+c+'" />').appendTo(document.body),this.$element.on("click.dismiss.bs.modal",a.proxy(function(a){a.target===a.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus.call(this.$element[0]):this.hide.call(this))},this)),d&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!b)return;d?this.$backdrop.one(a.support.transition.end,b).emulateTransitionEnd(150):b()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),a.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(a.support.transition.end,b).emulateTransitionEnd(150):b()):b&&b()};var c=a.fn.modal;a.fn.modal=function(c,d){return this.each(function(){var e=a(this),f=e.data("bs.modal"),g=a.extend({},b.DEFAULTS,e.data(),"object"==typeof c&&c);f||e.data("bs.modal",f=new b(this,g)),"string"==typeof c?f[c](d):g.show&&f.show(d)})},a.fn.modal.Constructor=b,a.fn.modal.noConflict=function(){return a.fn.modal=c,this},a(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(b){var c=a(this),d=c.attr("href"),e=a(c.attr("data-target")||d&&d.replace(/.*(?=#[^\s]+$)/,"")),f=e.data("bs.modal")?"toggle":a.extend({remote:!/#/.test(d)&&d},e.data(),c.data());c.is("a")&&b.preventDefault(),e.modal(f,this).one("hide",function(){c.is(":visible")&&c.focus()})}),a(document).on("show.bs.modal",".modal",function(){a(document.body).addClass("modal-open")}).on("hidden.bs.modal",".modal",function(){a(document.body).removeClass("modal-open")})}(jQuery),+function(a){var b=function(a,b){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",a,b)};b.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},b.prototype.init=function(b,c,d){this.enabled=!0,this.type=b,this.$element=a(c),this.options=this.getOptions(d);for(var e=this.options.trigger.split(" "),f=e.length;f--;){var g=e[f];if("click"==g)this.$element.on("click."+this.type,this.options.selector,a.proxy(this.toggle,this));else if("manual"!=g){var h="hover"==g?"mouseenter":"focusin",i="hover"==g?"mouseleave":"focusout";this.$element.on(h+"."+this.type,this.options.selector,a.proxy(this.enter,this)),this.$element.on(i+"."+this.type,this.options.selector,a.proxy(this.leave,this))}}this.options.selector?this._options=a.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},b.prototype.getDefaults=function(){return b.DEFAULTS},b.prototype.getOptions=function(b){return b=a.extend({},this.getDefaults(),this.$element.data(),b),b.delay&&"number"==typeof b.delay&&(b.delay={show:b.delay,hide:b.delay}),b},b.prototype.getDelegateOptions=function(){var b={},c=this.getDefaults();return this._options&&a.each(this._options,function(a,d){c[a]!=d&&(b[a]=d)}),b},b.prototype.enter=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);return clearTimeout(c.timeout),c.hoverState="in",c.options.delay&&c.options.delay.show?void(c.timeout=setTimeout(function(){"in"==c.hoverState&&c.show()},c.options.delay.show)):c.show()},b.prototype.leave=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);return clearTimeout(c.timeout),c.hoverState="out",c.options.delay&&c.options.delay.hide?void(c.timeout=setTimeout(function(){"out"==c.hoverState&&c.hide()},c.options.delay.hide)):c.hide()},b.prototype.show=function(){var b=a.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){if(this.$element.trigger(b),b.isDefaultPrevented())return;var c=this,d=this.tip();this.setContent(),this.options.animation&&d.addClass("fade");var e="function"==typeof this.options.placement?this.options.placement.call(this,d[0],this.$element[0]):this.options.placement,f=/\s?auto?\s?/i,g=f.test(e);g&&(e=e.replace(f,"")||"top"),d.detach().css({top:0,left:0,display:"block"}).addClass(e),this.options.container?d.appendTo(this.options.container):d.insertAfter(this.$element);var h=this.getPosition(),i=d[0].offsetWidth,j=d[0].offsetHeight;if(g){var k=this.$element.parent(),l=e,m=document.documentElement.scrollTop||document.body.scrollTop,n="body"==this.options.container?window.innerWidth:k.outerWidth(),o="body"==this.options.container?window.innerHeight:k.outerHeight(),p="body"==this.options.container?0:k.offset().left;e="bottom"==e&&h.top+h.height+j-m>o?"top":"top"==e&&h.top-m-j<0?"bottom":"right"==e&&h.right+i>n?"left":"left"==e&&h.left-i<p?"right":e,d.removeClass(l).addClass(e)}var q=this.getCalculatedOffset(e,h,i,j);this.applyPlacement(q,e),this.hoverState=null;var r=function(){c.$element.trigger("shown.bs."+c.type)};a.support.transition&&this.$tip.hasClass("fade")?d.one(a.support.transition.end,r).emulateTransitionEnd(150):r()}},b.prototype.applyPlacement=function(b,c){var d,e=this.tip(),f=e[0].offsetWidth,g=e[0].offsetHeight,h=parseInt(e.css("margin-top"),10),i=parseInt(e.css("margin-left"),10);isNaN(h)&&(h=0),isNaN(i)&&(i=0),b.top=b.top+h,b.left=b.left+i,a.offset.setOffset(e[0],a.extend({using:function(a){e.css({top:Math.round(a.top),left:Math.round(a.left)})}},b),0),e.addClass("in");var j=e[0].offsetWidth,k=e[0].offsetHeight;if("top"==c&&k!=g&&(d=!0,b.top=b.top+g-k),/bottom|top/.test(c)){var l=0;b.left<0&&(l=-2*b.left,b.left=0,e.offset(b),j=e[0].offsetWidth,k=e[0].offsetHeight),this.replaceArrow(l-f+j,j,"left")}else this.replaceArrow(k-g,k,"top");d&&e.offset(b)},b.prototype.replaceArrow=function(a,b,c){this.arrow().css(c,a?50*(1-a/b)+"%":"")},b.prototype.setContent=function(){var a=this.tip(),b=this.getTitle();a.find(".tooltip-inner")[this.options.html?"html":"text"](b),a.removeClass("fade in top bottom left right")},b.prototype.hide=function(){function b(){"in"!=c.hoverState&&d.detach(),c.$element.trigger("hidden.bs."+c.type)}var c=this,d=this.tip(),e=a.Event("hide.bs."+this.type);return this.$element.trigger(e),e.isDefaultPrevented()?void 0:(d.removeClass("in"),a.support.transition&&this.$tip.hasClass("fade")?d.one(a.support.transition.end,b).emulateTransitionEnd(150):b(),this.hoverState=null,this)},b.prototype.fixTitle=function(){var a=this.$element;(a.attr("title")||"string"!=typeof a.attr("data-original-title"))&&a.attr("data-original-title",a.attr("title")||"").attr("title","")},b.prototype.hasContent=function(){return this.getTitle()},b.prototype.getPosition=function(){var b=this.$element[0];return a.extend({},"function"==typeof b.getBoundingClientRect?b.getBoundingClientRect():{width:b.offsetWidth,height:b.offsetHeight},this.$element.offset())},b.prototype.getCalculatedOffset=function(a,b,c,d){return"bottom"==a?{top:b.top+b.height,left:b.left+b.width/2-c/2}:"top"==a?{top:b.top-d,left:b.left+b.width/2-c/2}:"left"==a?{top:b.top+b.height/2-d/2,left:b.left-c}:{top:b.top+b.height/2-d/2,left:b.left+b.width}},b.prototype.getTitle=function(){var a,b=this.$element,c=this.options;return a=b.attr("data-original-title")||("function"==typeof c.title?c.title.call(b[0]):c.title)},b.prototype.tip=function(){return this.$tip=this.$tip||a(this.options.template)},b.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},b.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},b.prototype.enable=function(){this.enabled=!0},b.prototype.disable=function(){this.enabled=!1},b.prototype.toggleEnabled=function(){this.enabled=!this.enabled},b.prototype.toggle=function(b){var c=b?a(b.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type):this;c.tip().hasClass("in")?c.leave(c):c.enter(c)},b.prototype.destroy=function(){clearTimeout(this.timeout),this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var c=a.fn.tooltip;a.fn.tooltip=function(c){return this.each(function(){var d=a(this),e=d.data("bs.tooltip"),f="object"==typeof c&&c;(e||"destroy"!=c)&&(e||d.data("bs.tooltip",e=new b(this,f)),"string"==typeof c&&e[c]())})},a.fn.tooltip.Constructor=b,a.fn.tooltip.noConflict=function(){return a.fn.tooltip=c,this}}(jQuery),+function(a){var b=function(a,b){this.init("popover",a,b)};if(!a.fn.tooltip)throw new Error("Popover requires tooltip.js");b.DEFAULTS=a.extend({},a.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),b.prototype=a.extend({},a.fn.tooltip.Constructor.prototype),b.prototype.constructor=b,b.prototype.getDefaults=function(){return b.DEFAULTS},b.prototype.setContent=function(){var a=this.tip(),b=this.getTitle(),c=this.getContent();a.find(".popover-title")[this.options.html?"html":"text"](b),a.find(".popover-content")[this.options.html?"string"==typeof c?"html":"append":"text"](c),a.removeClass("fade top bottom left right in"),a.find(".popover-title").html()||a.find(".popover-title").hide()},b.prototype.hasContent=function(){return this.getTitle()||this.getContent();
},b.prototype.getContent=function(){var a=this.$element,b=this.options;return a.attr("data-content")||("function"==typeof b.content?b.content.call(a[0]):b.content)},b.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},b.prototype.tip=function(){return this.$tip||(this.$tip=a(this.options.template)),this.$tip};var c=a.fn.popover;a.fn.popover=function(c){return this.each(function(){var d=a(this),e=d.data("bs.popover"),f="object"==typeof c&&c;(e||"destroy"!=c)&&(e||d.data("bs.popover",e=new b(this,f)),"string"==typeof c&&e[c]())})},a.fn.popover.Constructor=b,a.fn.popover.noConflict=function(){return a.fn.popover=c,this}}(jQuery),+function(a){function b(c,d){var e,f=a.proxy(this.process,this);this.$element=a(a(c).is("body")?window:c),this.$body=a("body"),this.$scrollElement=this.$element.on("scroll.bs.scroll-spy.data-api",f),this.options=a.extend({},b.DEFAULTS,d),this.selector=(this.options.target||(e=a(c).attr("href"))&&e.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a",this.offsets=a([]),this.targets=a([]),this.activeTarget=null,this.refresh(),this.process()}b.DEFAULTS={offset:10},b.prototype.refresh=function(){var b=this.$element[0]==window?"offset":"position";this.offsets=a([]),this.targets=a([]);var c=this;this.$body.find(this.selector).map(function(){var d=a(this),e=d.data("target")||d.attr("href"),f=/^#./.test(e)&&a(e);return f&&f.length&&f.is(":visible")&&[[f[b]().top+(!a.isWindow(c.$scrollElement.get(0))&&c.$scrollElement.scrollTop()),e]]||null}).sort(function(a,b){return a[0]-b[0]}).each(function(){c.offsets.push(this[0]),c.targets.push(this[1])})},b.prototype.process=function(){var a,b=this.$scrollElement.scrollTop()+this.options.offset,c=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,d=c-this.$scrollElement.height(),e=this.offsets,f=this.targets,g=this.activeTarget;if(b>=d)return g!=(a=f.last()[0])&&this.activate(a);if(g&&b<=e[0])return g!=(a=f[0])&&this.activate(a);for(a=e.length;a--;)g!=f[a]&&b>=e[a]&&(!e[a+1]||b<=e[a+1])&&this.activate(f[a])},b.prototype.activate=function(b){this.activeTarget=b,a(this.selector).parentsUntil(this.options.target,".active").removeClass("active");var c=this.selector+'[data-target="'+b+'"],'+this.selector+'[href="'+b+'"]',d=a(c).parents("li").addClass("active");d.parent(".dropdown-menu").length&&(d=d.closest("li.dropdown").addClass("active")),d.trigger("activate.bs.scrollspy")};var c=a.fn.scrollspy;a.fn.scrollspy=function(c){return this.each(function(){var d=a(this),e=d.data("bs.scrollspy"),f="object"==typeof c&&c;e||d.data("bs.scrollspy",e=new b(this,f)),"string"==typeof c&&e[c]()})},a.fn.scrollspy.Constructor=b,a.fn.scrollspy.noConflict=function(){return a.fn.scrollspy=c,this},a(window).on("load",function(){a('[data-spy="scroll"]').each(function(){var b=a(this);b.scrollspy(b.data())})})}(jQuery),+function(a){var b=function(b){this.element=a(b)};b.prototype.show=function(){var b=this.element,c=b.closest("ul:not(.dropdown-menu)"),d=b.data("target");if(d||(d=b.attr("href"),d=d&&d.replace(/.*(?=#[^\s]*$)/,"")),!b.parent("li").hasClass("active")){var e=c.find(".active:last a")[0],f=a.Event("show.bs.tab",{relatedTarget:e});if(b.trigger(f),!f.isDefaultPrevented()){var g=a(d);this.activate(b.parent("li"),c),this.activate(g,g.parent(),function(){b.trigger({type:"shown.bs.tab",relatedTarget:e})})}}},b.prototype.activate=function(b,c,d){function e(){f.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),b.addClass("active"),g?(b[0].offsetWidth,b.addClass("in")):b.removeClass("fade"),b.parent(".dropdown-menu")&&b.closest("li.dropdown").addClass("active"),d&&d()}var f=c.find("> .active"),g=d&&a.support.transition&&f.hasClass("fade");g?f.one(a.support.transition.end,e).emulateTransitionEnd(150):e(),f.removeClass("in")};var c=a.fn.tab;a.fn.tab=function(c){return this.each(function(){var d=a(this),e=d.data("bs.tab");e||d.data("bs.tab",e=new b(this)),"string"==typeof c&&e[c]()})},a.fn.tab.Constructor=b,a.fn.tab.noConflict=function(){return a.fn.tab=c,this},a(document).on("click.bs.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(b){b.preventDefault(),a(this).tab("show")})}(jQuery),+function(a){var b=function(c,d){this.options=a.extend({},b.DEFAULTS,d),this.$window=a(window).on("scroll.bs.affix.data-api",a.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",a.proxy(this.checkPositionWithEventLoop,this)),this.$element=a(c),this.affixed=this.unpin=this.pinnedOffset=null,this.checkPosition()};b.RESET="affix affix-top affix-bottom",b.DEFAULTS={offset:0},b.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(b.RESET).addClass("affix");var a=this.$window.scrollTop(),c=this.$element.offset();return this.pinnedOffset=c.top-a},b.prototype.checkPositionWithEventLoop=function(){setTimeout(a.proxy(this.checkPosition,this),1)},b.prototype.checkPosition=function(){if(this.$element.is(":visible")){var c=a(document).height(),d=this.$window.scrollTop(),e=this.$element.offset(),f=this.options.offset,g=f.top,h=f.bottom;"top"==this.affixed&&(e.top+=d),"object"!=typeof f&&(h=g=f),"function"==typeof g&&(g=f.top(this.$element)),"function"==typeof h&&(h=f.bottom(this.$element));var i=null!=this.unpin&&d+this.unpin<=e.top?!1:null!=h&&e.top+this.$element.height()>=c-h?"bottom":null!=g&&g>=d?"top":!1;if(this.affixed!==i){this.unpin&&this.$element.css("top","");var j="affix"+(i?"-"+i:""),k=a.Event(j+".bs.affix");this.$element.trigger(k),k.isDefaultPrevented()||(this.affixed=i,this.unpin="bottom"==i?this.getPinnedOffset():null,this.$element.removeClass(b.RESET).addClass(j).trigger(a.Event(j.replace("affix","affixed"))),"bottom"==i&&this.$element.offset({top:c-h-this.$element.height()}))}}};var c=a.fn.affix;a.fn.affix=function(c){return this.each(function(){var d=a(this),e=d.data("bs.affix"),f="object"==typeof c&&c;e||d.data("bs.affix",e=new b(this,f)),"string"==typeof c&&e[c]()})},a.fn.affix.Constructor=b,a.fn.affix.noConflict=function(){return a.fn.affix=c,this},a(window).on("load",function(){a('[data-spy="affix"]').each(function(){var b=a(this),c=b.data();c.offset=c.offset||{},c.offsetBottom&&(c.offset.bottom=c.offsetBottom),c.offsetTop&&(c.offset.top=c.offsetTop),b.affix(c)})})}(jQuery),define("bootstrap",["jquery"],function(){}),define("tourist",["jquery","backbone","underscore"],function(a,b,c){var d,e,f,g,h={}.hasOwnProperty,i=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},j=function(a,b){return function(){return a.apply(b,arguments)}},k={};return k.Model=function(a){function b(){return d=b.__super__.constructor.apply(this,arguments)}return i(b,a),b.prototype._module="Tourist",b}(b.Model),k.Tip={},k.Tip.Base=function(){function d(b){this.options=null!=b?b:{},this.onClickNext=j(this.onClickNext,this),this.onClickClose=j(this.onClickClose,this),this.el=a("<div/>"),this.initialize(b),this._bindClickEvents(),k.Tip.Base._cacheTip(this)}return d.prototype._module="Tourist",c.extend(d.prototype,b.Events),d.prototype.skipButtonTemplate='<button class="btn btn-xs btn-inverse-default pull-left tour-close">Skip Tour</button>',d.prototype.nextButtonTemplate='<button class="btn btn-xs btn-default pull-right tour-next">Got it!</button>',d.prototype.finalButtonTemplate='<button class="btn btn-xs btn-default tour-next">SO GET STARTED</button>',d.prototype.closeButtonTemplate='<a class="btn btn-close tour-close" href="#"><i class="icon icon-remove"></i></a>',d.prototype.okButtonTemplate='<button class="btn btn-xs tour-close btn-primary">Okay</button>',d.prototype.actionLabelTemplate=c.template('<h4 class="action-label"><%= label %></h4>'),d.prototype.actionLabels=["Do this:","Then this:","Next this:"],d.prototype.highlightClass="tour-highlight",d.prototype.template=c.template('<div class="tour-container"><div class="nue-image-wrapper"><img src="<%= image %>" width="<%= imageWidth %>" height="<%= imageHeight %>" /></div><div class="nue-title-wrapper"><span class="nue-step-counter <%= counter_class %>"><%= counter %></span></div><div class="nue-content-wrapper"><div class="nue-content"><%= content %></div></div><div class="nue-footer-wrapper clearfix"><div class="tour-buttons"><%= buttons %></div></div></div>'),d.prototype.destroy=function(){return this.el.remove()},d.prototype.render=function(a){return this.hide(),a&&(this._setTarget(a.target||!1,a),this._setZIndex(""),this._renderContent(a,this._buildContentElement(a)),a.target&&this.show(),a.zIndex&&this._setZIndex(a.zIndex,a)),this},d.prototype.show=function(){},d.prototype.hide=function(){},d.prototype.setTarget=function(a,b){return this._setTarget(a,b)},d.prototype.cleanupCurrentTarget=function(){return this.target&&this.target.removeClass&&this.target.removeClass(this.highlightClass),this.target=null},d.prototype.onClickClose=function(a){return this.trigger("click:close",this,a),!1},d.prototype.onClickNext=function(a){return this.trigger("click:next",this,a),!1},d.prototype._getTipElement=function(){},d.prototype._renderContent=function(a,b){},d.prototype._bindClickEvents=function(){var a;return a=this._getTipElement(),a.delegate(".tour-close","click",this.onClickClose),a.delegate(".tour-next","click",this.onClickNext)},d.prototype._setTarget=function(a,b){return this.cleanupCurrentTarget(),a&&b&&b.highlightTarget&&a.addClass(this.highlightClass),this.target=a},d.prototype._setZIndex=function(a){var b;return b=this._getTipElement(),b.css("z-index",a||"")},d.prototype._buildContentElement=function(b){var c,d;return c=this._buildButtons(b),d=a(a.parseHTML(this.template({content:b.content,image:b.image,imageWidth:b.imageWidth,imageHeight:b.imageHeight,buttons:c,close_button:this._buildCloseButton(b),counter:b["final"]?"":b.index+1+"/"+b.total,counter_class:b["final"]?"final":""}))),c||d.find(".tour-buttons").addClass("no-buttons"),this._renderActionLabels(d),d},d.prototype._buildButtons=function(a){var b;return b="",a.okButton&&(b+=this.okButtonTemplate),a.skipButton&&(b+=this.skipButtonTemplate),a.nextButton&&(b+=a["final"]?this.finalButtonTemplate:this.nextButtonTemplate),b},d.prototype._buildCloseButton=function(a){return a.closeButton?this.closeButtonTemplate:""},d.prototype._renderActionLabels=function(b){var c,d,e,f,g,h,i;for(e=b.find(".action"),d=0,i=[],g=0,h=e.length;h>g;g++)c=e[g],f=a(a.parseHTML(this.actionLabelTemplate({label:this.actionLabels[d]}))),f.insertBefore(c),i.push(d++);return i},d._cacheTip=function(a){return k.Tip.Base._cachedTips||(k.Tip.Base._cachedTips=[]),k.Tip.Base._cachedTips.push(a)},d.destroy=function(){var a,b,c,d;if(k.Tip.Base._cachedTips){for(d=k.Tip.Base._cachedTips,b=0,c=d.length;c>b;b++)a=d[b],a.destroy();return k.Tip.Base._cachedTips=null}},d}(),k.Tip.Bootstrap=function(b){function d(){return e=d.__super__.constructor.apply(this,arguments)}return i(d,b),d.prototype.initialize=function(a){var b;return b={showEffect:null,hideEffect:null},this.options=c.extend(b,a),this.tip=new k.Tip.BootstrapTip},d.prototype.destroy=function(){return this.tip.destroy(),d.__super__.destroy.call(this)},d.prototype.show=function(){var a;return this.options.showEffect?(a=k.Tip.Bootstrap.effects[this.options.showEffect],a.call(this,this.tip,this.tip.el)):this.tip.show()},d.prototype.hide=function(){var a;return this.options.hideEffect?(a=k.Tip.Bootstrap.effects[this.options.hideEffect],a.call(this,this.tip,this.tip.el)):this.tip.hide()},d.prototype._getTipElement=function(){return this.tip.el},d.prototype._setTarget=function(a,b){return d.__super__._setTarget.call(this,a,b),this.tip.setTarget(a)},d.prototype._renderContent=function(b,c){var d,e;return e=b.my||"left center",d=b.at||"right center",this.tip.setContainer(b.container||a("body")),this.tip.setContent(c),this.tip.setPosition(b.target||!1,e,d)},d}(k.Tip.Base),k.Tip.Bootstrap.effects={slidein:function(b,c){var d,e,f,g,h,i,j,k,l;for(d={top:80,left:80,right:-80,bottom:-80},i=b.my.split(" ")[0],i=i||"top",h=d[i],"bottom"===i&&(i="top"),"right"===i&&(i="left"),j=parseInt(c.css(i)),c.stop(),e={},e[i]=j+h,c.css(e),c.show(),e[i]=j,g=["easeOutCubic","swing","linear"],k=0,l=g.length;l>k&&(f=g[k],!a.easing[f]);k++);return c.animate(e,300,f),null}},k.Tip.BootstrapTip=function(){function b(b){var d;d={offset:10,tipOffset:10},this.options=c.extend(d,b),this.el=a(a.parseHTML(this.template)),this.hide()}return b.prototype.template='<div class="popover nue">\n  <div class="arrow"></div>\n  <div class="popover-content"></div>\n</div>',b.prototype.FLIP_POSITION={bottom:"top",top:"bottom",left:"right",right:"left"},b.prototype.destroy=function(){return this.el.remove()},b.prototype.show=function(){return this.el.show().addClass("visible")},b.prototype.hide=function(){return this.el.hide().removeClass("visible")},b.prototype.setTarget=function(a){return this.target=a,this._setPosition(this.target,this.my,this.at)},b.prototype.setPosition=function(a,b,c){return this.target=a,this.my=b,this.at=c,this._setPosition(this.target,this.my,this.at)},b.prototype.setContainer=function(a){return a.append(this.el)},b.prototype.setContent=function(a){return this._getContentElement().html(a)},b.prototype._getContentElement=function(){return this.el.find(".popover-content")},b.prototype._getTipElement=function(){return this.el.find(".arrow")},b.prototype._setPosition=function(a,b,c){var d,e,f,g,h,i,j,k,l,m;return null==b&&(b="left center"),null==c&&(c="right center"),a&&(m=b.split(" "),d=m[0],h=m[1],f=this.el.css("display"),this.el.css({top:0,left:0,margin:0,display:"block"}).removeClass("top").removeClass("bottom").removeClass("left").removeClass("right").addClass(this.FLIP_POSITION[d]),a)?(j=this._getTipElement().css({left:"",right:"",top:"",bottom:""}),"center"!==h&&(k={left:j[0].offsetWidth/2,right:0,top:j[0].offsetHeight/2,bottom:0},e={},e[h]=k[h]+this.options.tipOffset,e[this.FLIP_POSITION[h]]="auto",j.css(e)),i=this._caculateTargetPosition(c,a),l=this._caculateTipPosition(b,i),g=this._adjustForArrow(b,l),this.el.css(g),this.el.css({display:f})):void 0},b.prototype._caculateTargetPosition=function(a,b){var c,d;return"[object Array]"===Object.prototype.toString.call(b)?{left:b[0],top:b[1]}:(c=this._getTargetBounds(b),d=this._lookupPosition(a,c.width,c.height),{left:c.left+d[0],top:c.top+d[1]})},b.prototype._caculateTipPosition=function(a,b){var c,d,e;return e=this.el[0].offsetWidth,c=this.el[0].offsetHeight,d=this._lookupPosition(a,e,c),{left:b.left-d[0],top:b.top-d[1]}},b.prototype._adjustForArrow=function(a,b){var c,d,e,f,g,h,i;switch(i=a.split(" "),c=i[0],f=i[1],g=this._getTipElement(),h=g[0].offsetWidth,d=g[0].offsetHeight,e={top:b.top,left:b.left},c){case"top":e.top+=d+this.options.offset;break;case"bottom":e.top-=d+this.options.offset;break;case"left":e.left+=h+this.options.offset;break;case"right":e.left-=h+this.options.offset}switch(f){case"left":e.left-=h/2+this.options.tipOffset;break;case"right":e.left+=h/2+this.options.tipOffset;break;case"top":e.top-=d/2+this.options.tipOffset;break;case"bottom":e.top+=d/2+this.options.tipOffset}return e},b.prototype._lookupPosition=function(a,b,c){var d,e,f;return f=b/2,d=c/2,e={"top left":[0,0],"left top":[0,0],"top right":[b,0],"right top":[b,0],"bottom left":[0,c],"left bottom":[0,c],"bottom right":[b,c],"right bottom":[b,c],"top center":[f,0],"left center":[0,d],"right center":[b,d],"bottom center":[f,c]},e[a]},b.prototype._getTargetBounds=function(b){var c,d;return c=b[0],d="function"==typeof c.getBoundingClientRect?c.getBoundingClientRect():{width:c.offsetWidth,height:c.offsetHeight},a.extend({},d,b.offset())},b}(),k.Tip.QTip=function(b){function c(){return this._renderTipBackground=j(this._renderTipBackground,this),f=c.__super__.constructor.apply(this,arguments)}var d,e,g,h;return i(c,b),h=6,g=14,d=10,e={top:80,left:80,right:-80,bottom:-80},c.prototype.QTIP_DEFAULTS={content:{text:" "},show:{ready:!1,delay:0,effect:function(b){var c,d,f,g,h;return d=a(this),g=b.options.position.my,g&&(g=g[g.precedance]),g=g||"top",f=e[g],"bottom"===g&&(g="top"),"right"===g&&(g="left"),h=parseInt(d.css(g)),c={},c[g]=h+f,d.css(c),d.show(),c[g]=h,d.animate(c,300,"easeOutCubic"),null},autofocus:!1},hide:{event:null,delay:0,effect:!1},position:{adjust:{method:"shift shift",scroll:!1}},style:{classes:"ui-tour-tip",tip:{height:h,width:g}},events:{},zindex:2e3},c.prototype.initialize=function(b){return b=a.extend(!0,{},this.QTIP_DEFAULTS,b),this.el.qtip(b),this.qtip=this.el.qtip("api"),this.qtip.render()},c.prototype.destroy=function(){return this.qtip&&this.qtip.destroy(),c.__super__.destroy.call(this)},c.prototype.show=function(){return this.qtip.show()},c.prototype.hide=function(){return this.qtip.hide()},c.prototype._getTipElement=function(){return a("#qtip-"+this.qtip.id)},c.prototype._setTarget=function(a,b){return c.__super__._setTarget.call(this,a,b),this.qtip.set("position.target",a||!1)},c.prototype._renderContent=function(b,c){var d,e,f=this;return e=b.my||"left center",d=b.at||"right center",this._adjustPlacement(e,d),this.qtip.set("content.text",c),this.qtip.set("position.container",b.container||a("body")),this.qtip.set("position.my",e),this.qtip.set("position.at",d),this.qtip.set("position.viewport",b.viewport||!1),this.qtip.set("position.target",b.target||!1),setTimeout(function(){return f._renderTipBackground(e.split(" ")[0])},10)},c.prototype._adjustPlacement=function(a,b){return 0===a.indexOf("top")?this._adjust(0,d):0===a.indexOf("bottom")?this._adjust(0,-d):0===a.indexOf("right")?this._adjust(-d,0):this._adjust(d,0)},c.prototype._adjust=function(a,b){return this.qtip.set("position.adjust.x",a),this.qtip.set("position.adjust.y",b)},c.prototype._renderTipBackground=function(b){var c,d;return d=a("#qtip-"+this.qtip.id+" .qtip-tip"),c=d.find(".qtip-tip-bg"),c.length||(c=a("<div/>",{"class":"icon icon-tip qtip-tip-bg"}),d.append(c)),c.removeClass("top left right bottom"),c.addClass(b)},c}(k.Tip.Base),k.Tip.Simple=function(b){function c(){return g=c.__super__.constructor.apply(this,arguments)}return i(c,b),c.prototype.initialize=function(b){return a("body").append(this.el)},c.prototype.show=function(){return this.el.show()},c.prototype.hide=function(){return this.el.hide()},c.prototype._getTipElement=function(){return this.el},c.prototype._renderContent=function(a,b){return this.el.html(b)},c}(k.Tip.Base),k.Tour=function(){function a(a){var b,d;this.options=null!=a?a:{},this.onChangeCurrentStep=j(this.onChangeCurrentStep,this),this.next=j(this.next,this),b={tipClass:"Bootstrap"},this.options=c.extend(b,this.options),this.model=new k.Model({current_step:null}),d=c.extend({model:this.model},this.options.tipOptions),this.view=new k.Tip[this.options.tipClass](d),this.view.bind("click:close",c.bind(this.stop,this,!0)),this.view.bind("click:next",this.next),this.model.bind("change:current_step",this.onChangeCurrentStep)}return c.extend(a.prototype,b.Events),a.prototype.start=function(){return this.trigger("start",this),this.next()},a.prototype.stop=function(a){return a?this._showCancelFinalStep():this._stop()},a.prototype.next=function(){var a,b;return a=this._teardownCurrentStep(),b=0,a&&(b=a.index+1),b<this.options.steps.length?this._showStep(this.options.steps[b],b):b===this.options.steps.length?this._showSuccessFinalStep():this._stop()},a.prototype.setStepOptions=function(a){return this.options.stepOptions=a},a.prototype.onChangeCurrentStep=function(a,b){return this.view.render(b)},a.prototype._showCancelFinalStep=function(){return this._showFinalStep(!0)},a.prototype._showSuccessFinalStep=function(){return this._showFinalStep(!0)},a.prototype._teardownCurrentStep=function(){var a;return a=this.model.get("current_step"),this._teardownStep(a),a},a.prototype._stop=function(){return this._teardownCurrentStep(),this.model.set({current_step:null}),this.trigger("stop",this)},a.prototype._showFinalStep=function(a){var b,d;return b=this._teardownCurrentStep(),d=a?this.options.successStep:this.options.cancelStep,c.isFunction(d)&&(d.call(this,this,this.options.stepOptions),d=null),d?b&&b["final"]?this._stop():(d["final"]=!0,this._showStep(d,this.options.steps.length)):this._stop()},a.prototype._showStep=function(a,b){return a?(a=c.clone(a),a.index=b,a.total=this.options.steps.length,a["final"]||(a["final"]=this.options.steps.length===b+1&&!this.options.successStep),a=c.extend(a,this._setupStep(a)),this.model.set({current_step:a})):void 0},a.prototype._setupStep=function(a){var b,d,e,f;if(!a||!a.setup)return{};if(a.bind)for(f=a.bind,d=0,e=f.length;e>d;d++)b=f[d],a[b]=c.bind(a[b],a,this,this.options.stepOptions);return a.setup.call(a,this,this.options.stepOptions)||{}},a.prototype._teardownStep=function(a){return a&&a.teardown&&a.teardown.call(a,this,this.options.stepOptions),this.view.cleanupCurrentTarget()},a}(),k}),define("modules/view/nue/nue",["jquery","underscore","backbone","tourist","modules/common/local_storage","modules/common/utility","modules/globals/url"],function(a,b,c,d,e,f,g){var h={};return h.show=function(){var b=new d.Tour({steps:[{content:"Take a peek to discover people and stories.",image:g.jsclient+"/app/images/nue/5.png",imageWidth:120,imageHeight:120,nextButton:!0,skipButton:!0,zIndex:3e3,my:"top left",at:"bottom center",setup:function(){a("<div />").attr("id","nue-lightbox").css({width:"100%",height:"100%",background:"#000",position:"fixed",top:0,left:0,"z-index":2997,opacity:.6}).appendTo(a("body")),a("<div />").attr("id","nue-block").css({position:"absolute",top:0,left:0,width:"100%",height:"100%","z-index":2999}).appendTo(a("body")),a("body").css({"padding-top":0,height:"100%",overflow:"hidden"}),a(".navbar-fixed-top").css({"margin-bottom":0,position:"relative","z-index":"auto"});var c,d=!0;return 0===a("#discover-dropdown").length?(a(".arrow",b.view.tip.el).hide(),d=!1,c=[a(window).width()/2,(a(window).height()-320)/2]):(a(".arrow",b.view.tip.el).show(),c=a("#discover-dropdown")),{highlightTarget:d,target:c}}},{content:"Be a star. Step into your blogging spotlight.",image:g.jsclient+"/app/images/nue/2.png",imageWidth:120,imageHeight:120,nextButton:!0,skipButton:!0,zIndex:3e3,my:"top center",at:"bottom center",setup:function(){var c,d=!0;return 0===a(".post-box-container").first().length?(a(".arrow",b.view.tip.el).hide(),d=!1,c=[a(window).width()/2,(a(window).height()-320)/2]):(a(".arrow",b.view.tip.el).show(),c=a(".post-box-container").first()),{highlightTarget:d,target:c}}},{content:"Catch up with old friends or chat up someone new.",image:g.jsclient+"/app/images/nue/3.png",imageWidth:120,imageHeight:120,nextButton:!0,skipButton:!0,zIndex:3e3,my:"right top",at:"left top",setup:function(b){var c,d=!0;return f.isMobile()?(a(".arrow",b.view.tip.el).show(),c=a(".chat-mobile-toggle.visible-xs"),this.my="top center",this.at="bottom center"):0===a("#chat").length?(d=!1,c=[a(window).width()/2,(a(window).height()-320)/2],a(".arrow",b.view.tip.el).hide()):(a(".arrow",b.view.tip.el).show(),c=a("#chat")),{highlightTarget:d,target:c}}},{content:"Share gifts, post stickers, and dress up your avatar.",image:g.jsclient+"/app/images/nue/6.png",imageWidth:240,imageHeight:120,nextButton:!0,skipButton:!0,zIndex:3e3,my:"top right",at:"bottom center",setup:function(){var c,d=!0;return 0===a("#store-dropdown").length?(a(".arrow",b.view.tip.el).hide(),d=!1,this.my="top center",this.at="bottom center",c=[a(window).width()/2,(a(window).height()-320)/2]):(a(".arrow",b.view.tip.el).show(),c=a("#store-dropdown")),{highlightTarget:d,target:c}}}],successStep:{content:'<p>The stage is set. Let\'s do this!</p><label><input type="checkbox" name="no_nue" value="1" checked="checked" />&nbsp;&nbsp;Don\'t show this again</label>',image:g.jsclient+"/app/images/nue/7.png",imageWidth:241,imageHeight:100,nextButton:!0,target:[(a(window).width()-300)/2,(a(window).height()-50)/2],zIndex:3e3,setup:function(b){a(".arrow",b.view.tip.el).hide()},teardown:function(b){var c=a('input[name="no_nue"]',b.view.tip.el);a("body").removeAttr("style"),a(".navbar-fixed-top").removeAttr("style"),a("#nue-block").remove(),a("#nue-lightbox").remove(),c.is(":checked")?f.set_user_data("no_nue",1):f.set_user_data("no_nue",0)}},tipClass:"Bootstrap",tipOptions:{showEffect:"slidein"}});b.start()},h}),define("modules/model/common/poll_model",["underscore","backbone","modules/mig33_app","modules/common/config","modules/common/utility"],function(a,b,c,d){var e=b.Model.extend({initialize:function(a){this.options=a},url:function(){return d.urls.poll_url+"/"+((new Date).getTime()-d.timer.poll)}});return e}),function(a,b,c,d){var e=c("html"),f=c(a),g=c(b),h=c.fancybox=function(){h.open.apply(this,arguments)},i=navigator.userAgent.match(/msie/i),j=null,k=b.createTouch!==d,l=function(a){return a&&a.hasOwnProperty&&a instanceof c},m=function(a){return a&&"string"===c.type(a)},n=function(a){return m(a)&&a.indexOf("%")>0},o=function(a){return a&&!(a.style.overflow&&"hidden"===a.style.overflow)&&(a.clientWidth&&a.scrollWidth>a.clientWidth||a.clientHeight&&a.scrollHeight>a.clientHeight)},p=function(a,b){var c=parseInt(a,10)||0;return b&&n(a)&&(c=h.getViewport()[b]/100*c),Math.ceil(c)},q=function(a,b){return p(a,b)+"px"};c.extend(h,{version:"2.1.5",defaults:{padding:15,margin:20,width:800,height:600,minWidth:100,minHeight:100,maxWidth:9999,maxHeight:9999,pixelRatio:1,autoSize:!0,autoHeight:!1,autoWidth:!1,autoResize:!0,autoCenter:!k,fitToView:!0,aspectRatio:!1,topRatio:.5,leftRatio:.5,scrolling:"auto",wrapCSS:"",arrows:!0,closeBtn:!0,closeClick:!1,nextClick:!1,mouseWheel:!0,autoPlay:!1,playSpeed:3e3,preload:3,modal:!1,loop:!0,ajax:{dataType:"html",headers:{"X-fancyBox":!0}},iframe:{scrolling:"auto",preload:!0},swf:{wmode:"transparent",allowfullscreen:"true",allowscriptaccess:"always"},keys:{next:{13:"left",34:"up",39:"left",40:"up"},prev:{8:"right",33:"down",37:"right",38:"down"},close:[27],play:[32],toggle:[70]},direction:{next:"left",prev:"right"},scrollOutside:!0,index:0,type:null,href:null,content:null,title:null,tpl:{wrap:'<div class="fancybox-wrap" tabIndex="-1"><div class="fancybox-skin"><div class="fancybox-outer"><div class="fancybox-inner"></div></div></div></div>',image:'<img class="fancybox-image" src="{href}" alt="" />',iframe:'<iframe id="fancybox-frame{rnd}" name="fancybox-frame{rnd}" class="fancybox-iframe" frameborder="0" vspace="0" hspace="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen'+(i?' allowtransparency="true"':"")+"></iframe>",error:'<p class="fancybox-error">The requested content cannot be loaded.<br/>Please try again later.</p>',closeBtn:'<a title="Close" class="fancybox-item fancybox-close" href="javascript:;"></a>',next:'<a title="Next" class="fancybox-nav fancybox-next" href="javascript:;"><span></span></a>',prev:'<a title="Previous" class="fancybox-nav fancybox-prev" href="javascript:;"><span></span></a>'},openEffect:"fade",openSpeed:250,openEasing:"swing",openOpacity:!0,openMethod:"zoomIn",closeEffect:"fade",closeSpeed:250,closeEasing:"swing",closeOpacity:!0,closeMethod:"zoomOut",nextEffect:"elastic",nextSpeed:250,nextEasing:"swing",nextMethod:"changeIn",prevEffect:"elastic",prevSpeed:250,prevEasing:"swing",prevMethod:"changeOut",helpers:{overlay:!0,title:!0},onCancel:c.noop,beforeLoad:c.noop,afterLoad:c.noop,beforeShow:c.noop,afterShow:c.noop,beforeChange:c.noop,beforeClose:c.noop,afterClose:c.noop},group:{},opts:{},previous:null,coming:null,current:null,isActive:!1,isOpen:!1,isOpened:!1,wrap:null,skin:null,outer:null,inner:null,player:{timer:null,isActive:!1},ajaxLoad:null,imgPreload:null,transitions:{},helpers:{},open:function(a,b){return a&&(c.isPlainObject(b)||(b={}),!1!==h.close(!0))?(c.isArray(a)||(a=l(a)?c(a).get():[a]),c.each(a,function(e,f){var g,i,j,k,n,o,p,q={};"object"===c.type(f)&&(f.nodeType&&(f=c(f)),l(f)?(q={href:f.data("fancybox-href")||f.attr("href"),title:f.data("fancybox-title")||f.attr("title"),isDom:!0,element:f},c.metadata&&c.extend(!0,q,f.metadata())):q=f),g=b.href||q.href||(m(f)?f:null),i=b.title!==d?b.title:q.title||"",j=b.content||q.content,k=j?"html":b.type||q.type,!k&&q.isDom&&(k=f.data("fancybox-type"),k||(n=f.prop("class").match(/fancybox\.(\w+)/),k=n?n[1]:null)),m(g)&&(k||(h.isImage(g)?k="image":h.isSWF(g)?k="swf":"#"===g.charAt(0)?k="inline":m(f)&&(k="html",j=f)),"ajax"===k&&(o=g.split(/\s+/,2),g=o.shift(),p=o.shift())),j||("inline"===k?g?j=c(m(g)?g.replace(/.*(?=#[^\s]+$)/,""):g):q.isDom&&(j=f):"html"===k?j=g:k||g||!q.isDom||(k="inline",j=f)),c.extend(q,{href:g,type:k,content:j,title:i,selector:p}),a[e]=q}),h.opts=c.extend(!0,{},h.defaults,b),b.keys!==d&&(h.opts.keys=b.keys?c.extend({},h.defaults.keys,b.keys):!1),h.group=a,h._start(h.opts.index)):void 0},cancel:function(){var a=h.coming;a&&!1!==h.trigger("onCancel")&&(h.hideLoading(),h.ajaxLoad&&h.ajaxLoad.abort(),h.ajaxLoad=null,h.imgPreload&&(h.imgPreload.onload=h.imgPreload.onerror=null),a.wrap&&a.wrap.stop(!0,!0).trigger("onReset").remove(),h.coming=null,h.current||h._afterZoomOut(a))},close:function(a){h.cancel(),!1!==h.trigger("beforeClose")&&(h.unbindEvents(),h.isActive&&(h.isOpen&&a!==!0?(h.isOpen=h.isOpened=!1,h.isClosing=!0,c(".fancybox-item, .fancybox-nav").remove(),h.wrap.stop(!0,!0).removeClass("fancybox-opened"),h.transitions[h.current.closeMethod]()):(c(".fancybox-wrap").stop(!0).trigger("onReset").remove(),h._afterZoomOut())))},play:function(a){var b=function(){clearTimeout(h.player.timer)},c=function(){b(),h.current&&h.player.isActive&&(h.player.timer=setTimeout(h.next,h.current.playSpeed))},d=function(){b(),g.unbind(".player"),h.player.isActive=!1,h.trigger("onPlayEnd")},e=function(){h.current&&(h.current.loop||h.current.index<h.group.length-1)&&(h.player.isActive=!0,g.bind({"onCancel.player beforeClose.player":d,"onUpdate.player":c,"beforeLoad.player":b}),c(),h.trigger("onPlayStart"))};a===!0||!h.player.isActive&&a!==!1?e():d()},next:function(a){var b=h.current;b&&(m(a)||(a=b.direction.next),h.jumpto(b.index+1,a,"next"))},prev:function(a){var b=h.current;b&&(m(a)||(a=b.direction.prev),h.jumpto(b.index-1,a,"prev"))},jumpto:function(a,b,c){var e=h.current;e&&(a=p(a),h.direction=b||e.direction[a>=e.index?"next":"prev"],h.router=c||"jumpto",e.loop&&(0>a&&(a=e.group.length+a%e.group.length),a%=e.group.length),e.group[a]!==d&&(h.cancel(),h._start(a)))},reposition:function(a,b){var d,e=h.current,f=e?e.wrap:null;f&&(d=h._getPosition(b),a&&"scroll"===a.type?(delete d.position,f.stop(!0,!0).animate(d,200)):(f.css(d),e.pos=c.extend({},e.dim,d)))},update:function(a){var b=a&&a.type,c=!b||"orientationchange"===b;c&&(clearTimeout(j),j=null),h.isOpen&&!j&&(j=setTimeout(function(){var d=h.current;d&&!h.isClosing&&(h.wrap.removeClass("fancybox-tmp"),(c||"load"===b||"resize"===b&&d.autoResize)&&h._setDimension(),"scroll"===b&&d.canShrink||h.reposition(a),h.trigger("onUpdate"),j=null)},c&&!k?0:300))},toggle:function(a){h.isOpen&&(h.current.fitToView="boolean"===c.type(a)?a:!h.current.fitToView,k&&(h.wrap.removeAttr("style").addClass("fancybox-tmp"),h.trigger("onUpdate")),h.update())},hideLoading:function(){g.unbind(".loading"),c("#fancybox-loading").remove()},showLoading:function(){var a,b;h.hideLoading(),a=c('<div id="fancybox-loading"><div></div></div>').click(h.cancel).appendTo("body"),g.bind("keydown.loading",function(a){27===(a.which||a.keyCode)&&(a.preventDefault(),h.cancel())}),h.defaults.fixed||(b=h.getViewport(),a.css({position:"absolute",top:.5*b.h+b.y,left:.5*b.w+b.x}))},getViewport:function(){var b=h.current&&h.current.locked||!1,c={x:f.scrollLeft(),y:f.scrollTop()};return b?(c.w=b[0].clientWidth,c.h=b[0].clientHeight):(c.w=k&&a.innerWidth?a.innerWidth:f.width(),c.h=k&&a.innerHeight?a.innerHeight:f.height()),c},unbindEvents:function(){h.wrap&&l(h.wrap)&&h.wrap.unbind(".fb"),g.unbind(".fb"),f.unbind(".fb")},bindEvents:function(){var a,b=h.current;b&&(f.bind("orientationchange.fb"+(k?"":" resize.fb")+(b.autoCenter&&!b.locked?" scroll.fb":""),h.update),a=b.keys,a&&g.bind("keydown.fb",function(e){var f=e.which||e.keyCode,g=e.target||e.srcElement;return 27===f&&h.coming?!1:void(e.ctrlKey||e.altKey||e.shiftKey||e.metaKey||g&&(g.type||c(g).is("[contenteditable]"))||c.each(a,function(a,g){
return b.group.length>1&&g[f]!==d?(h[a](g[f]),e.preventDefault(),!1):c.inArray(f,g)>-1?(h[a](),e.preventDefault(),!1):void 0}))}),c.fn.mousewheel&&b.mouseWheel&&h.wrap.bind("mousewheel.fb",function(a,d,e,f){for(var g=a.target||null,i=c(g),j=!1;i.length&&!(j||i.is(".fancybox-skin")||i.is(".fancybox-wrap"));)j=o(i[0]),i=c(i).parent();0===d||j||h.group.length>1&&!b.canShrink&&(f>0||e>0?h.prev(f>0?"down":"left"):(0>f||0>e)&&h.next(0>f?"up":"right"),a.preventDefault())}))},trigger:function(a,b){var d,e=b||h.coming||h.current;if(e){if(c.isFunction(e[a])&&(d=e[a].apply(e,Array.prototype.slice.call(arguments,1))),d===!1)return!1;e.helpers&&c.each(e.helpers,function(b,d){d&&h.helpers[b]&&c.isFunction(h.helpers[b][a])&&h.helpers[b][a](c.extend(!0,{},h.helpers[b].defaults,d),e)}),g.trigger(a)}},isImage:function(a){return m(a)&&a.match(/(^data:image\/.*,)|(\.(jp(e|g|eg)|gif|png|bmp|webp|svg)((\?|#).*)?$)/i)},isSWF:function(a){return m(a)&&a.match(/\.(swf)((\?|#).*)?$/i)},_start:function(a){var b,d,e,f,g,i={};if(a=p(a),b=h.group[a]||null,!b)return!1;if(i=c.extend(!0,{},h.opts,b),f=i.margin,g=i.padding,"number"===c.type(f)&&(i.margin=[f,f,f,f]),"number"===c.type(g)&&(i.padding=[g,g,g,g]),i.modal&&c.extend(!0,i,{closeBtn:!1,closeClick:!1,nextClick:!1,arrows:!1,mouseWheel:!1,keys:null,helpers:{overlay:{closeClick:!1}}}),i.autoSize&&(i.autoWidth=i.autoHeight=!0),"auto"===i.width&&(i.autoWidth=!0),"auto"===i.height&&(i.autoHeight=!0),i.group=h.group,i.index=a,h.coming=i,!1===h.trigger("beforeLoad"))return void(h.coming=null);if(e=i.type,d=i.href,!e)return h.coming=null,h.current&&h.router&&"jumpto"!==h.router?(h.current.index=a,h[h.router](h.direction)):!1;if(h.isActive=!0,"image"!==e&&"swf"!==e||(i.autoHeight=i.autoWidth=!1,i.scrolling="visible"),"image"===e&&(i.aspectRatio=!0),"iframe"===e&&k&&(i.scrolling="scroll"),i.wrap=c(i.tpl.wrap).addClass("fancybox-"+(k?"mobile":"desktop")+" fancybox-type-"+e+" fancybox-tmp "+i.wrapCSS).appendTo(i.parent||"body"),c.extend(i,{skin:c(".fancybox-skin",i.wrap),outer:c(".fancybox-outer",i.wrap),inner:c(".fancybox-inner",i.wrap)}),c.each(["Top","Right","Bottom","Left"],function(a,b){i.skin.css("padding"+b,q(i.padding[a]))}),h.trigger("onReady"),"inline"===e||"html"===e){if(!i.content||!i.content.length)return h._error("content")}else if(!d)return h._error("href");"image"===e?h._loadImage():"ajax"===e?h._loadAjax():"iframe"===e?h._loadIframe():h._afterLoad()},_error:function(a){c.extend(h.coming,{type:"html",autoWidth:!0,autoHeight:!0,minWidth:0,minHeight:0,scrolling:"no",hasError:a,content:h.coming.tpl.error}),h._afterLoad()},_loadImage:function(){var a=h.imgPreload=new Image;a.onload=function(){this.onload=this.onerror=null,h.coming.width=this.width/h.opts.pixelRatio,h.coming.height=this.height/h.opts.pixelRatio,h._afterLoad()},a.onerror=function(){this.onload=this.onerror=null,h._error("image")},a.src=h.coming.href,a.complete!==!0&&h.showLoading()},_loadAjax:function(){var a=h.coming;h.showLoading(),h.ajaxLoad=c.ajax(c.extend({},a.ajax,{url:a.href,error:function(a,b){h.coming&&"abort"!==b?h._error("ajax",a):h.hideLoading()},success:function(b,c){"success"===c&&(a.content=b,h._afterLoad())}}))},_loadIframe:function(){var a=h.coming,b=c(a.tpl.iframe.replace(/\{rnd\}/g,(new Date).getTime())).attr("scrolling",k?"auto":a.iframe.scrolling).attr("src",a.href);c(a.wrap).bind("onReset",function(){try{c(this).find("iframe").hide().attr("src","//about:blank").end().empty()}catch(a){}}),a.iframe.preload&&(h.showLoading(),b.one("load",function(){c(this).data("ready",1),k||c(this).bind("load.fb",h.update),c(this).parents(".fancybox-wrap").width("100%").removeClass("fancybox-tmp").show(),h._afterLoad()})),a.content=b.appendTo(a.inner),a.iframe.preload||h._afterLoad()},_preloadImages:function(){var a,b,c=h.group,d=h.current,e=c.length,f=d.preload?Math.min(d.preload,e-1):0;for(b=1;f>=b;b+=1)a=c[(d.index+b)%e],"image"===a.type&&a.href&&((new Image).src=a.href)},_afterLoad:function(){var a,b,d,e,f,g,i=h.coming,j=h.current,k="fancybox-placeholder";if(h.hideLoading(),i&&h.isActive!==!1){if(!1===h.trigger("afterLoad",i,j))return i.wrap.stop(!0).trigger("onReset").remove(),void(h.coming=null);switch(j&&(h.trigger("beforeChange",j),j.wrap.stop(!0).removeClass("fancybox-opened").find(".fancybox-item, .fancybox-nav").remove()),h.unbindEvents(),a=i,b=i.content,d=i.type,e=i.scrolling,c.extend(h,{wrap:a.wrap,skin:a.skin,outer:a.outer,inner:a.inner,current:a,previous:j}),f=a.href,d){case"inline":case"ajax":case"html":a.selector?b=c("<div>").html(b).find(a.selector):l(b)&&(b.data(k)||b.data(k,c('<div class="'+k+'"></div>').insertAfter(b).hide()),b=b.show().detach(),a.wrap.bind("onReset",function(){c(this).find(b).length&&b.hide().replaceAll(b.data(k)).data(k,!1)}));break;case"image":b=a.tpl.image.replace("{href}",f);break;case"swf":b='<object id="fancybox-swf" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="100%" height="100%"><param name="movie" value="'+f+'"></param>',g="",c.each(a.swf,function(a,c){b+='<param name="'+a+'" value="'+c+'"></param>',g+=" "+a+'="'+c+'"'}),b+='<embed src="'+f+'" type="application/x-shockwave-flash" width="100%" height="100%"'+g+"></embed></object>"}l(b)&&b.parent().is(a.inner)||a.inner.append(b),h.trigger("beforeShow"),a.inner.css("overflow","yes"===e?"scroll":"no"===e?"hidden":e),h._setDimension(),h.reposition(),h.isOpen=!1,h.coming=null,h.bindEvents(),h.isOpened?j.prevMethod&&h.transitions[j.prevMethod]():c(".fancybox-wrap").not(a.wrap).stop(!0).trigger("onReset").remove(),h.transitions[h.isOpened?a.nextMethod:a.openMethod](),h._preloadImages()}},_setDimension:function(){var a,b,d,e,f,g,i,j,k,l,m,o,r,s,t,u=h.getViewport(),v=0,w=!1,x=!1,y=h.wrap,z=h.skin,A=h.inner,B=h.current,C=B.width,D=B.height,E=B.minWidth,F=B.minHeight,G=B.maxWidth,H=B.maxHeight,I=B.scrolling,J=B.scrollOutside?B.scrollbarWidth:0,K=B.margin,L=p(K[1]+K[3]),M=p(K[0]+K[2]);if(y.add(z).add(A).width("auto").height("auto").removeClass("fancybox-tmp"),a=p(z.outerWidth(!0)-z.width()),b=p(z.outerHeight(!0)-z.height()),d=L+a,e=M+b,f=n(C)?(u.w-d)*p(C)/100:C,g=n(D)?(u.h-e)*p(D)/100:D,"iframe"===B.type){if(s=B.content,B.autoHeight&&1===s.data("ready"))try{s[0].contentWindow.document.location&&(A.width(f).height(9999),t=s.contents().find("body"),J&&t.css("overflow-x","hidden"),g=t.outerHeight(!0))}catch(N){}}else(B.autoWidth||B.autoHeight)&&(A.addClass("fancybox-tmp"),B.autoWidth||A.width(f),B.autoHeight||A.height(g),B.autoWidth&&(f=A.width()),B.autoHeight&&(g=A.height()),A.removeClass("fancybox-tmp"));if(C=p(f),D=p(g),k=f/g,E=p(n(E)?p(E,"w")-d:E),G=p(n(G)?p(G,"w")-d:G),F=p(n(F)?p(F,"h")-e:F),H=p(n(H)?p(H,"h")-e:H),i=G,j=H,B.fitToView&&(G=Math.min(u.w-d,G),H=Math.min(u.h-e,H)),o=u.w-L,r=u.h-M,B.aspectRatio?(C>G&&(C=G,D=p(C/k)),D>H&&(D=H,C=p(D*k)),E>C&&(C=E,D=p(C/k)),F>D&&(D=F,C=p(D*k))):(C=Math.max(E,Math.min(C,G)),B.autoHeight&&"iframe"!==B.type&&(A.width(C),D=A.height()),D=Math.max(F,Math.min(D,H))),B.fitToView)if(A.width(C).height(D),y.width(C+a),l=y.width(),m=y.height(),B.aspectRatio)for(;(l>o||m>r)&&C>E&&D>F&&!(v++>19);)D=Math.max(F,Math.min(H,D-10)),C=p(D*k),E>C&&(C=E,D=p(C/k)),C>G&&(C=G,D=p(C/k)),A.width(C).height(D),y.width(C+a),l=y.width(),m=y.height();else C=Math.max(E,Math.min(C,C-(l-o))),D=Math.max(F,Math.min(D,D-(m-r)));J&&"auto"===I&&g>D&&o>C+a+J&&(C+=J),A.width(C).height(D),y.width(C+a),l=y.width(),m=y.height(),w=(l>o||m>r)&&C>E&&D>F,x=B.aspectRatio?i>C&&j>D&&f>C&&g>D:(i>C||j>D)&&(f>C||g>D),c.extend(B,{dim:{width:q(l),height:q(m)},origWidth:f,origHeight:g,canShrink:w,canExpand:x,wPadding:a,hPadding:b,wrapSpace:m-z.outerHeight(!0),skinSpace:z.height()-D}),!s&&B.autoHeight&&D>F&&H>D&&!x&&A.height("auto")},_getPosition:function(a){var b=h.current,c=h.getViewport(),d=b.margin,e=h.wrap.width()+d[1]+d[3],f=h.wrap.height()+d[0]+d[2],g={position:"absolute",top:d[0],left:d[3]};return b.autoCenter&&b.fixed&&!a&&f<=c.h&&e<=c.w?g.position="fixed":b.locked||(g.top+=c.y,g.left+=c.x),g.top=q(Math.max(g.top,g.top+(c.h-f)*b.topRatio)),g.left=q(Math.max(g.left,g.left+(c.w-e)*b.leftRatio)),g},_afterZoomIn:function(){var a=h.current;a&&(h.isOpen=h.isOpened=!0,h.wrap.css("overflow","visible").addClass("fancybox-opened"),h.update(),(a.closeClick||a.nextClick&&h.group.length>1)&&h.inner.css("cursor","pointer").bind("click.fb",function(b){c(b.target).is("a")||c(b.target).parent().is("a")||(b.preventDefault(),h[a.closeClick?"close":"next"]())}),a.closeBtn&&c(a.tpl.closeBtn).appendTo(h.skin).bind("click.fb",function(a){a.preventDefault(),h.close()}),a.arrows&&h.group.length>1&&((a.loop||a.index>0)&&c(a.tpl.prev).appendTo(h.outer).bind("click.fb",h.prev),(a.loop||a.index<h.group.length-1)&&c(a.tpl.next).appendTo(h.outer).bind("click.fb",h.next)),h.trigger("afterShow"),a.loop||a.index!==a.group.length-1?h.opts.autoPlay&&!h.player.isActive&&(h.opts.autoPlay=!1,h.play()):h.play(!1))},_afterZoomOut:function(a){a=a||h.current,c(".fancybox-wrap").trigger("onReset").remove(),c.extend(h,{group:{},opts:{},router:!1,current:null,isActive:!1,isOpened:!1,isOpen:!1,isClosing:!1,wrap:null,skin:null,outer:null,inner:null}),h.trigger("afterClose",a)}}),h.transitions={getOrigPosition:function(){var a=h.current,b=a.element,c=a.orig,d={},e=50,f=50,g=a.hPadding,i=a.wPadding,j=h.getViewport();return!c&&a.isDom&&b.is(":visible")&&(c=b.find("img:first"),c.length||(c=b)),l(c)?(d=c.offset(),c.is("img")&&(e=c.outerWidth(),f=c.outerHeight())):(d.top=j.y+(j.h-f)*a.topRatio,d.left=j.x+(j.w-e)*a.leftRatio),("fixed"===h.wrap.css("position")||a.locked)&&(d.top-=j.y,d.left-=j.x),d={top:q(d.top-g*a.topRatio),left:q(d.left-i*a.leftRatio),width:q(e+i),height:q(f+g)}},step:function(a,b){var c,d,e,f=b.prop,g=h.current,i=g.wrapSpace,j=g.skinSpace;"width"!==f&&"height"!==f||(c=b.end===b.start?1:(a-b.start)/(b.end-b.start),h.isClosing&&(c=1-c),d="width"===f?g.wPadding:g.hPadding,e=a-d,h.skin[f](p("width"===f?e:e-i*c)),h.inner[f](p("width"===f?e:e-i*c-j*c)))},zoomIn:function(){var a=h.current,b=a.pos,d=a.openEffect,e="elastic"===d,f=c.extend({opacity:1},b);delete f.position,e?(b=this.getOrigPosition(),a.openOpacity&&(b.opacity=.1)):"fade"===d&&(b.opacity=.1),h.wrap.css(b).animate(f,{duration:"none"===d?0:a.openSpeed,easing:a.openEasing,step:e?this.step:null,complete:h._afterZoomIn})},zoomOut:function(){var a=h.current,b=a.closeEffect,c="elastic"===b,d={opacity:.1};c&&(d=this.getOrigPosition(),a.closeOpacity&&(d.opacity=.1)),h.wrap.animate(d,{duration:"none"===b?0:a.closeSpeed,easing:a.closeEasing,step:c?this.step:null,complete:h._afterZoomOut})},changeIn:function(){var a,b=h.current,c=b.nextEffect,d=b.pos,e={opacity:1},f=h.direction,g=200;d.opacity=.1,"elastic"===c&&(a="down"===f||"up"===f?"top":"left","down"===f||"right"===f?(d[a]=q(p(d[a])-g),e[a]="+="+g+"px"):(d[a]=q(p(d[a])+g),e[a]="-="+g+"px")),"none"===c?h._afterZoomIn():h.wrap.css(d).animate(e,{duration:b.nextSpeed,easing:b.nextEasing,complete:h._afterZoomIn})},changeOut:function(){var a=h.previous,b=a.prevEffect,d={opacity:.1},e=h.direction,f=200;"elastic"===b&&(d["down"===e||"up"===e?"top":"left"]=("up"===e||"left"===e?"-":"+")+"="+f+"px"),a.wrap.animate(d,{duration:"none"===b?0:a.prevSpeed,easing:a.prevEasing,complete:function(){c(this).trigger("onReset").remove()}})}},h.helpers.overlay={defaults:{closeClick:!0,speedOut:200,showEarly:!0,css:{},locked:!k,fixed:!0},overlay:null,fixed:!1,el:c("html"),create:function(a){a=c.extend({},this.defaults,a),this.overlay&&this.close(),this.overlay=c('<div class="fancybox-overlay"></div>').appendTo(h.coming?h.coming.parent:a.parent),this.fixed=!1,a.fixed&&h.defaults.fixed&&(this.overlay.addClass("fancybox-overlay-fixed"),this.fixed=!0)},open:function(a){var b=this;a=c.extend({},this.defaults,a),this.overlay?this.overlay.unbind(".overlay").width("auto").height("auto"):this.create(a),this.fixed||(f.bind("resize.overlay",c.proxy(this.update,this)),this.update()),a.closeClick&&this.overlay.bind("click.overlay",function(a){return c(a.target).hasClass("fancybox-overlay")?(h.isActive?h.close():b.close(),!1):void 0}),this.overlay.css(a.css).show()},close:function(){var a,b;f.unbind("resize.overlay"),this.el.hasClass("fancybox-lock")&&(c(".fancybox-margin").removeClass("fancybox-margin"),a=f.scrollTop(),b=f.scrollLeft(),this.el.removeClass("fancybox-lock"),f.scrollTop(a).scrollLeft(b)),c(".fancybox-overlay").remove().hide(),c.extend(this,{overlay:null,fixed:!1})},update:function(){var a,c="100%";this.overlay.width(c).height("100%"),i?(a=Math.max(b.documentElement.offsetWidth,b.body.offsetWidth),g.width()>a&&(c=g.width())):g.width()>f.width()&&(c=g.width()),this.overlay.width(c).height(g.height())},onReady:function(a,b){var d=this.overlay;c(".fancybox-overlay").stop(!0,!0),d||this.create(a),a.locked&&this.fixed&&b.fixed&&(d||(this.margin=g.height()>f.height()?c("html").css("margin-right").replace("px",""):!1),b.locked=this.overlay.append(b.wrap),b.fixed=!1),a.showEarly===!0&&this.beforeShow.apply(this,arguments)},beforeShow:function(a,b){var d,e;b.locked&&(this.margin!==!1&&(c("*").filter(function(){return"fixed"===c(this).css("position")&&!c(this).hasClass("fancybox-overlay")&&!c(this).hasClass("fancybox-wrap")}).addClass("fancybox-margin"),this.el.addClass("fancybox-margin")),d=f.scrollTop(),e=f.scrollLeft(),this.el.addClass("fancybox-lock"),f.scrollTop(d).scrollLeft(e)),this.open(a)},onUpdate:function(){this.fixed||this.update()},afterClose:function(a){this.overlay&&!h.coming&&this.overlay.fadeOut(a.speedOut,c.proxy(this.close,this))}},h.helpers.title={defaults:{type:"float",position:"bottom"},beforeShow:function(a){var b,d,e=h.current,f=e.title,g=a.type;if(c.isFunction(f)&&(f=f.call(e.element,e)),m(f)&&""!==c.trim(f)){switch(b=c('<div class="fancybox-title fancybox-title-'+g+'-wrap">'+f+"</div>"),g){case"inside":d=h.skin;break;case"outside":d=h.wrap;break;case"over":d=h.inner;break;default:d=h.skin,b.appendTo("body"),i&&b.width(b.width()),b.wrapInner('<span class="child"></span>'),h.current.margin[2]+=Math.abs(p(b.css("margin-bottom")))}b["top"===a.position?"prependTo":"appendTo"](d)}}},c.fn.fancybox=function(a){var b,d=c(this),e=this.selector||"",f=function(f){var g,i,j=c(this).blur(),k=b;f.ctrlKey||f.altKey||f.shiftKey||f.metaKey||j.is(".fancybox-wrap")||(g=a.groupAttr||"data-fancybox-group",i=j.attr(g),i||(g="rel",i=j.get(0)[g]),i&&""!==i&&"nofollow"!==i&&(j=e.length?c(e):d,j=j.filter("["+g+'="'+i+'"]'),k=j.index(this)),a.index=k,h.open(j,a)!==!1&&f.preventDefault())};return a=a||{},b=a.index||0,e&&a.live!==!1?g.undelegate(e,"click.fb-start").delegate(e+":not('.fancybox-item, .fancybox-nav')","click.fb-start",f):d.unbind("click.fb-start").bind("click.fb-start",f),this.filter("[data-fancybox-start=1]").trigger("click"),this},g.ready(function(){var b,f;c.scrollbarWidth===d&&(c.scrollbarWidth=function(){var a=c('<div style="width:50px;height:50px;overflow:auto"><div/></div>').appendTo("body"),b=a.children(),d=b.innerWidth()-b.height(99).innerWidth();return a.remove(),d}),c.support.fixedPosition===d&&(c.support.fixedPosition=function(){var a=c('<div style="position:fixed;top:20px;"></div>').appendTo("body"),b=20===a[0].offsetTop||15===a[0].offsetTop;return a.remove(),b}()),c.extend(h.defaults,{scrollbarWidth:c.scrollbarWidth(),fixed:c.support.fixedPosition,parent:c("body")}),b=c(a).width(),e.addClass("fancybox-lock-test"),f=c(a).width(),e.removeClass("fancybox-lock-test"),c("<style type='text/css'>.fancybox-margin{margin-right:"+(f-b)+"px;}</style>").appendTo("head")})}(window,document,jQuery),define("fancybox",["jquery","jquery.mousewheel"],function(){}),define("modules/mig33_app",["jquery","underscore","backbone","backbone.marionette","marionette_handlebars","handlebars","modules/common/config","modules/common/utility","modules/common/session_user","modules/common/task_runner","modules/chat/chat_loader","modules/view/common/header_layout","modules/view/common/login_modal_view","modules/view/common/download_modal_view","modules/view/common/share_modal_view","modules/view/common/share_to_chat_modal_view","modules/view/common/sharebox_modal_view","modules/view/common/invite_friends_modal_view","modules/view/common/gift_modal_view","modules/view/chat_invite/chat_invite_modal_view","modules/view/chat_invite/chat_invite_modal_email_view","modules/view/chat_invite/chat_invite_email_tpl_preview_view","modules/view/nue/nue","modules/common/nue","modules/model/common/poll_model","modules/globals/session_user","modules/globals/url","modules/template/helpers/general_helpers","modules/template/helpers/user_helpers","bootstrap","fancybox"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A){b.isUndefined(window.ga)&&(window.ga=function(){});var B=j.TaskRunner;a.ajaxSetup({cache:!1}),h.send_exception_to_ga();var C=new c.Marionette.Application;C.cache={user:[]},C.addRegions({header:"#main-header",content:"#main",chat:"#chat-container"}),C.addInitializer(function(){var b=new l({model:new c.Model(z)});"iOS"==h.deviceOS()&&h.isMigmeApp()?a("body").css("padding-top","0"):C.header.show(b)}),C.root="/";var D=document.location.protocol+"//"+document.location.host+C.root,E=[document.location.protocol+"//"+document.location.host+"/wap2/",document.location.protocol+"//"+document.location.host+"/images/",document.location.protocol+"//"+document.location.host+"/img/",document.location.protocol+"//"+document.location.host+"/faq/"];return C.link_hijack_selector="a[href]:not([data-bypass])",C.link_hijack_handler=function(c){var d={prop:a(this).prop("href"),attr:a(this).attr("href")},e=!1;return b.each(E,function(a){-1!==d.attr.indexOf(a)&&(e=!0)}),e||null!==d.attr.match(/^https/)?void a(this).attr("target","_blank"):void C.navigate_to(d,c)},C.navigate_to=function(a,d){b.isString(a)&&(a={prop:a,attr:a}),a.attr.match(/\/v4\/(sites|debug)\//)||(a.attr=a.attr.replace(/\/(sites|debug)\//,"/v4/$1/")),null!==a.attr.match(new RegExp("^(((https?:)?//[^/]+)?/wap)(/.*)?$","i"))&&(a.attr=a.attr.replace(/\/wap\//,"/")),null!==a.attr.match(new RegExp("^(((https?:)?//[^/]+)?/web)(/.*)?$","i"))&&(a.attr=a.attr.replace(/\/web\//,"/")),"#"!=a.attr.charAt(0)&&a.prop.slice(0,D.length)===D&&(d&&d.preventDefault(),a.attr&&0===a.attr.indexOf(D)&&(a.attr=a.attr.slice(D.length)),c.history.navigate(a.attr,!0))},C.setup_link_hijacks=function(a){a.on("click",C.link_hijack_selector,C.link_hijack_handler)},C.setup_link_hijacks(a(document)),C.on("initialize:after",function(){c.history.firstLoad=!0,c.history.on("route",function(){c.history.firstLoad=!1}),c.history.start({pushState:h.is_pushstate_enabled(),root:C.root});var b=a("#main-container");if(h.is_logged_in()){k.initializeChatClient();var d=h.isMobile();if("undefined"!=typeof Storage&&d){var e=h.get_user_data("downloadShowCount");if(h.set_user_data("downloadShowCount",e+1),3>e){var f=new n;a("#main-header").after(f.render().el),"iOS"==h.deviceOS()&&a("a.download_link").attr("href",g.urls.iOS_download_url),"Android"==h.deviceOS()&&a("a.download_link").attr("href",g.urls.Android_download_url),e=Number(e)+1}else e=1}var i=x.nue.getInstance();if(i.startChecking(),"undefined"!=typeof window.location&&"undefined"!=typeof window.location.pathname&&"/home"===window.location.pathname&&z.mig_level<3){var j=h.get_user_data("no_nue");null!==j&&0!==parseInt(j,10)||setTimeout(function(){w.show()},5e3)}var l=new y;l.on("change",function(a){var b=a.get("unread_count").migalerts,c=a.get("unread_count").mentions,d=a.get("unread_count").posts,e=a.get("unread").migalerts;b>0&&"undefined"!=typeof e.notification_destinations&&C.vent.trigger(C.ApplicationEvents.NEW_NOTIFICATIONS,e.notification_destinations,b),c>0&&C.vent.trigger(C.ApplicationEvents.NEW_MENTIONS,c),d>0&&C.vent.trigger(C.ApplicationEvents.NEW_POSTS,d)});var A=new B;A.clear(),A.start({scope:this,fireOnStart:!0,run:function(){l.fetch()},interval:g.timer.poll});var D=new q;if(b.after(D.render().el),"registrationPopup"==window.name){var E='{"refresh" : 1}';try{window.opener.top.postMessage(E,document.location.origin)}catch(F){}return window.close(),!1}}else{var G=new m;b.after(G.render().el)}var H=[new o,new p,new r,new v,new t,new u,new s];H.forEach(function(a){b.after(a.render().el)})}),C.ApplicationEvents={POST_ADDED:"userfeed|post|added",POST_ADDED_DONE:"userfeed|post|added|done",POST_DELETED:"userfeed|post|deleted",GROUP_POST_ADDED:"groupfeed|%s|post|added",POST_REPLY_ADDED:"post|reply|added",POST_RESHARE_ADDED:"post|reshare|added",POST_EF_ADDED:"post|ef|added",POST_REPLY_DELETED:"post|reply|deleted",NEW_MIGALERT:"migalert|new",NEW_ACHIEVEMENT_LABELS:"migalert|new|label",NEW_MENTIONS:"mentions|new",NEW_POSTS:"userfeed|post|new",NEW_NOTIFICATIONS:"notifications|new",ACCOUNT_BALANCE:"user|account|balance",TOGGLE_TEARAWAY:"window|mode|toggle",COVERPHOTO_UPDATED:"coverphoto|update",STORE_ITEM_PURCHASED:"store|item|purchase",CHAT_SESSION_ERROR:"chat|session|error",CHAT_SESSION_CONNECTED:"chat|session|connected"},C}),define("modules/model/achievement/achievement_model",["underscore","modules/model/common/mig33_model","modules/common/config","modules/common/utility"],function(a,b,c,d){return b.extend({url:function(){return d.format(c.urls.achievement_url,this.attributes.userId)},parse:function(a){return console.warn(a),a}})}),define("modules/model/achievement/achievement_collection",["modules/model/common/mig33_collection","modules/model/achievement/achievement_model"],function(a,b){return a.extend({model:b})}),define("hbs!modules/template/achievement/achievement_item_unlocked",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h,i="",j=c.helperMissing,k=this.escapeExpression,l="function";return i+='<div class="posts">\n    <div class="post achievement-unlock">\n        <div class="achievement-unlock__title-bar">\n            <span>'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"Achievement Unlocked",h):j.call(b,"translate","Achievement Unlocked",h)))+'!</span>\n            <a href="#" class="dismiss"><span class="icon-wb_chatclose right"></span></a>\n        </div>\n\n        <div class="achievement-unlock__banner">\n            <img src="'+k((g=c.getUrl||b&&b.getUrl,h={hash:{},data:e},g?g.call(b,"jsclient",h):j.call(b,"getUrl","jsclient",h)))+'/app/images/identity/identity_postheader_web.png" />\n        </div>\n\n        <div class="achievement-unlock__content">\n            <h3 class="congratulations">'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"Congratulations",h):j.call(b,"translate","Congratulations",h)))+'</h3>\n\n            <div class="power-icon">\n                <img src="',(g=c.imageUrl)?f=g.call(b,{hash:{},data:e}):(g=b&&b.imageUrl,f=typeof g===l?g.call(b,{hash:{},data:e}):g),i+=k(f)+'" />\n            </div>\n\n            <p class="message">',(g=c.title)?f=g.call(b,{hash:{},data:e}):(g=b&&b.title,f=typeof g===l?g.call(b,{hash:{},data:e}):g),i+=k(f)+'</p>\n            <p class="sub-message">',(g=c.description)?f=g.call(b,{hash:{},data:e}):(g=b&&b.description,f=typeof g===l?g.call(b,{hash:{},data:e}):g),i+=k(f)+'</p>\n            <p class="private-message"><span class="icon icon-wb_private"></span> '+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"Only you can see this.",h):j.call(b,"translate","Only you can see this.",h)))+'</p>\n        </div>\n\n        <div class="achievement-unlock__action">\n            <a href="'+k((g=c.getUrl||b&&b.getUrl,h={hash:{},data:e},g?g.call(b,"corporate",h):j.call(b,"getUrl","corporate",h)))+'/faq" target="_blank">\n                <div class="more-info">\n                    <span class="icon-wb_moreinfo"></span> '+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"More Info",h):j.call(b,"translate","More Info",h)))+'\n                </div>\n            </a>\n            <a href="#">\n                <div class="share">\n                    <span class="icon-wb_mb_share"></span> '+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"Share This Moment",h):j.call(b,"translate","Share This Moment",h)))+"\n                </div>\n            </a>\n        </div>\n    </div>\n</div>\n"})}),define("modules/view/achievement/achievement_item_unlocked_view",["modules/view/common/mig33_views","hbs!modules/template/achievement/achievement_item_unlocked","modules/common/utility"],function(a,b,c){return a.ItemView.extend({template:{type:"handlebars",template:b},templateHelpers:function(){return{title:this.model.get("title"),description:this.model.get("description"),id:"achievement-unlocked-"+this.model.get("id"),imageUrl:this.model.get("imageUrl")}},ui:{dismiss:".dismiss",share:".share"},events:{"click @ui.dismiss":"dismissUnlockedPost","click @ui.share":"displayModal"},displayModal:function(){},dismissUnlockedPost:function(){this.$el.slideUp(),c.setNewLabelAchievementFeedDismissed(this.model.get("id"),!0)}})}),define("modules/view/achievement/achievement_item_unlocked_collection_view",["modules/view/common/mig33_views","modules/view/achievement/achievement_item_unlocked_view"],function(a,b){return a.CollectionView.extend({itemView:b})}),define("hbs!modules/template/homefeed/homefeed-layout",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+='\n<div class="col-md-10 unverified_box">\n	<div>\n		<h3>Hi '+n((d=c.getSessionUser||a&&a.getSessionUser,e={hash:{},data:b},d?d.call(a,"username",e):m.call(a,"getSessionUser","username",e)))+'.</h3>	\n		<p>You haven\'t verified your email address. Doing so gives you better security. <a href="/sites/ajax/settings/account_email_resend?">Verify now</a>.</p>\n	</div>\n</div>\n'}function g(a,b){var d,e,f="";return f+='\n<div class="col-md-10 unverified_box">\n	<div>\n		<h3>Hi '+n((d=c.getSessionUser||a&&a.getSessionUser,e={hash:{},data:b},d?d.call(a,"username",e):m.call(a,"getSessionUser","username",e)))+'.</h3>	\n		<p>We don\'t have your email address. For better security and to receive important updates, enter it now to continue using mig.</p>\n\n		<form action="/sites/ajax/settings/account_email" method="post">\n			<input type="submit" value="Proceed">\n		</form>\n	</div>\n</div>\n'}function h(a,b){var d,e,f="";return f+='\n		<div class="banner-homefeed"></div>\n		<div class="post-box-container postbox">\n			<div class="input-group postbox-sample" data-toggle="modal" data-target="#sharebox-modal" >\n				<div>\n					<img src="'+n((d=c.getSessionUserDisplayPictureUrl||a&&a.getSessionUserDisplayPictureUrl,e={hash:{},data:b},d?d.call(a,150,150,e):m.call(a,"getSessionUserDisplayPictureUrl",150,150,e)))+'" width="24"height="24" class="img-circle" />\n					<span class="username">'+n((d=c.getSessionUser||a&&a.getSessionUser,e={hash:{},data:b},d?d.call(a,"username",e):m.call(a,"getSessionUser","username",e)))+'</span>\n					<div class="postbox-media-option">\n						<div class="postbox-submit">\n							<a class="font-color-grey" href="#" class="text-center">\n								<span class="icon-wb_send" title="'+n((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"common|share",e):m.call(a,"translate","common|share",e)))+'"></span>\n							</a>\n						</div>\n					</div>\n				</div>\n				<input type="text" name="body-sample" class="form-control input-sm" placeholder="'+n((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"homefeed|say_something_user",e):m.call(a,"translate","homefeed|say_something_user",e)))+'" />\n				<!-- <span class="input-group-btn">\n					<input type="button" class="btn btn-sm btn-default" value="'+n((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"common|share",e):m.call(a,"translate","common|share",e)))+'" />\n				</span> -->\n			</div>\n		</div>\n		<div class="loading hidden">loading...</div>\n	    <!-- <ul class="nav nav-tabs nav-justified tabs-homefeed hidden">\n			<li><a href="/home"><span class="badge posts-unread-count"></span>&nbsp;'+n((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"homefeed|posts",e):m.call(a,"translate","homefeed|posts",e)))+'</a></li>\n			<li><a href="/mentions"><span class="badge mentions-unread-count"></span>&nbsp;'+n((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"homefeed|mentions",e):m.call(a,"translate","homefeed|mentions",e)))+'</a></li>\n\n			<li><a href="/watchlist">'+n((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"homefeed|favorites",e):m.call(a,"translate","homefeed|favorites",e)))+' (<span class="subscriptions-count">'+n((d=c.getSessionUser||a&&a.getSessionUser,e={hash:{},data:b},d?d.call(a,"num_watched_posts",e):m.call(a,"getSessionUser","num_watched_posts",e)))+'</span>)</a></li>\n		</ul> -->\n		<div id="new-message"></div>\n	'}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var i,j,k,l="",m=c.helperMissing,n=this.escapeExpression,o=this,p="function",q=c.blockHelperMissing;return k={hash:{},inverse:o.noop,fn:o.program(1,f,e),data:e},(j=c.ifExternalEmailNotVerified)?i=j.call(b,k):(j=b&&b.ifExternalEmailNotVerified,i=typeof j===p?j.call(b,k):j),c.ifExternalEmailNotVerified||(i=q.call(b,i,{hash:{},inverse:o.noop,fn:o.program(1,f,e),data:e})),(i||0===i)&&(l+=i),l+="\n\n",k={hash:{},inverse:o.noop,fn:o.program(3,g,e),data:e},(j=c.ifExternalEmailNotProvided)?i=j.call(b,k):(j=b&&b.ifExternalEmailNotProvided,i=typeof j===p?j.call(b,k):j),c.ifExternalEmailNotProvided||(i=q.call(b,i,{hash:{},inverse:o.noop,fn:o.program(3,g,e),data:e})),(i||0===i)&&(l+=i),l+='\n\n<div class="col-md-3 sidebar sidebar-homefeed hidden">\n	<div class="panel panel-hottopics">\n		<div class="panel-heading">\n			<h3 class="panel-title">'+n((j=c.translate||b&&b.translate,k={hash:{},data:e},j?j.call(b,"discover|hot_topics",k):m.call(b,"translate","discover|hot_topics",k)))+'</h3>\n		</div>\n		<div class="panel-body">\n		</div>\n	</div>\n	<div class="panel panel-banner"></div>\n	<div class="panel panel-hotpeople">\n		<div class="panel-heading">\n			<h3 class="panel-title">'+n((j=c.translate||b&&b.translate,k={hash:{},data:e},j?j.call(b,"discover|hot_people",k):m.call(b,"translate","discover|hot_people",k)))+'</h3>\n		</div>\n		<div class="hotpeople-section">\n			<a href="/discover/recommended_people"><div class="panel-subheading">'+n((j=c.translate||b&&b.translate,k={hash:{},data:e},j?j.call(b,"discover|global_heading",k):m.call(b,"translate","discover|global_heading",k)))+'</div></a>\n			<div class="panel-body-global"></div>\n		</div>\n		<div class="hotpeople-section">\n			<a href="/discover/recommended_people_country"><div class="panel-subheading">'+n((j=c.translate||b&&b.translate,k={hash:{},data:e},j?j.call(b,"discover|country_heading",k):m.call(b,"translate","discover|country_heading",k)))+'</div></a>\n			<div class="panel-body-country"></div>\n		</div>\n		<div class="hotpeople-section">\n			<a href="/discover/addressbook_users"><div class="panel-subheading">'+n((j=c.translate||b&&b.translate,k={hash:{},data:e},j?j.call(b,"discover|addressbook_heading",k):m.call(b,"translate","discover|addressbook_heading",k)))+'</div></a>\n			<div class="panel-body-addressbook"></div>\n		</div>\n	</div>\n	<div class="panel panel-invite">\n		<div class="panel-heading">\n			<h3 class="panel-title">'+n((j=c.translate||b&&b.translate,k={hash:{},data:e},j?j.call(b,"chat|invite_friends",k):m.call(b,"translate","chat|invite_friends",k)))+'</h3>\n		</div>\n		<div class="panel-body"></div>\n	</div>\n	<div class="panel-google-adx"></div>\n</div>\n<div class="col-md-8 col-md-offset-2 content content-homefeed">\n	',k={hash:{},inverse:o.noop,fn:o.program(5,h,e),data:e},(j=c.ifLoggedIn)?i=j.call(b,k):(j=b&&b.ifLoggedIn,i=typeof j===p?j.call(b,k):j),c.ifLoggedIn||(i=q.call(b,i,{hash:{},inverse:o.noop,fn:o.program(5,h,e),data:e})),(i||0===i)&&(l+=i),l+='\n    <div class="new-achievement-alerts"></div>\n	<div class="posts"></div>\n	<div class="load-more">'+n((j=c.translate||b&&b.translate,k={hash:{},data:e},j?j.call(b,"common|more",k):m.call(b,"translate","common|more",k)))+"</div>\n</div>\n"})}),define("hbs!modules/template/mimetypes/containers/post-feed/base-feed-container",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],
c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i="function";return h+='<div class="row">\n    <div class="col-xs-12">\n    	',(g=c.baseData)?f=g.call(b,{hash:{},data:e}):(g=b&&b.baseData,f=typeof g===i?g.call(b,{hash:{},data:e}):g),(f||0===f)&&(h+=f),h+="\n    </div>\n</div>"})}),define("hbs!modules/template/mimetypes/containers/post-feed/base-post-container",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i="function";return h+='<div class="row">\n    <div class="col-sm-12 postStyle">\n    	',(g=c.baseData)?f=g.call(b,{hash:{},data:e}):(g=b&&b.baseData,f=typeof g===i?g.call(b,{hash:{},data:e}):g),(f||0===f)&&(h+=f),h+="\n    </div>\n</div>"})}),define("hbs!modules/template/mimetypes/containers/post-feed/root-container",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){return'\n				<span class="icon-wb_repost icon--circle icon--bottom-rights"></span>\n			'}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var g,h,i,j="",k="function",l=this.escapeExpression,m=c.helperMissing,n=this;return j+='<div class="post-root">\n	\n	<div class="post-author-avatar left">\n		<a href="'+l((g=b&&b.author,g=null==g||g===!1?g:g.personalized_url,typeof g===k?g.apply(b):g))+'" title="'+l((g=b&&b.author,g=null==g||g===!1?g:g.username,typeof g===k?g.apply(b):g))+'" class="profile-hovercard" data-username="'+l((g=b&&b.author,g=null==g||g===!1?g:g.username,typeof g===k?g.apply(b):g))+'">\n			<img src="'+l((h=c.getDisplayPictureUrl||b&&b.getDisplayPictureUrl,i={hash:{},data:e},h?h.call(b,(g=b&&b.author,null==g||g===!1?g:g.username),(g=b&&b.author,null==g||g===!1?g:g.display_picture_type),40,40,i):m.call(b,"getDisplayPictureUrl",(g=b&&b.author,null==g||g===!1?g:g.username),(g=b&&b.author,null==g||g===!1?g:g.display_picture_type),40,40,i)))+'" width="40" height="40" class="img-circle" />\n			',h=c.compare||b&&b.compare,i={hash:{},inverse:n.noop,fn:n.program(1,f,e),data:e},g=h?h.call(b,b&&b.originality_text,"reshare",i):m.call(b,"compare",b&&b.originality_text,"reshare",i),(g||0===g)&&(j+=g),j+='\n		</a>\n	</div>\n	<div class="post-author-details left">\n		<div class="post-author">\n			<a href="'+l((g=b&&b.author,g=null==g||g===!1?g:g.personalized_url,typeof g===k?g.apply(b):g))+'" title="'+l((g=b&&b.author,g=null==g||g===!1?g:g.username,typeof g===k?g.apply(b):g))+'" class="profile-hovercard" data-username="'+l((g=b&&b.author,g=null==g||g===!1?g:g.username,typeof g===k?g.apply(b):g))+'">'+l((g=b&&b.author,g=null==g||g===!1?g:g.username,typeof g===k?g.apply(b):g))+"</a> "+l((h=c.userGetLabels||b&&b.userGetLabels,i={hash:{},data:e},h?h.call(b,b&&b.author,"16",i):m.call(b,"userGetLabels",b&&b.author,"16",i)))+'\n		</div>\n		<div class="post-time font-size-12">\n			<a href="',(h=c.permalink)?g=h.call(b,{hash:{},data:e}):(h=b&&b.permalink,g=typeof h===k?h.call(b,{hash:{},data:e}):h),j+=l(g)+'"><time class="timeago" datetime="'+l((h=c.dateFormat||b&&b.dateFormat,i={hash:{},data:e},h?h.call(b,b&&b.timestamp,"isoUtcDateTime",i):m.call(b,"dateFormat",b&&b.timestamp,"isoUtcDateTime",i)))+'">'+l((h=c.getRelativeTimestamp||b&&b.getRelativeTimestamp,i={hash:{},data:e},h?h.call(b,b&&b.timestamp,i):m.call(b,"getRelativeTimestamp",b&&b.timestamp,i)))+"</time> "+l((h=c.translate||b&&b.translate,i={hash:{},data:e},h?h.call(b,"post|via",i):m.call(b,"translate","post|via",i)))+" ",(h=c.application_text)?g=h.call(b,{hash:{},data:e}):(h=b&&b.application_text,g=typeof h===k?h.call(b,{hash:{},data:e}):h),j+=l(g)+"</a>\n		</div>\n	</div>\n	",(h=c.rootData)?g=h.call(b,{hash:{},data:e}):(h=b&&b.rootData,g=typeof h===k?h.call(b,{hash:{},data:e}):h),(g||0===g)&&(j+=g),j+="\n</div>"})}),define("hbs!modules/template/mimetypes/containers/post-feed/parent-container",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){return'\n				<span class="icon-wb_repost icon--circle icon--bottom-rights"></span>\n			'}function g(a,b){var d,e="";return e+="\n				",d=c["if"].call(a,a&&a.location,{hash:{},inverse:p.noop,fn:p.program(4,h,b),data:b}),(d||0===d)&&(e+=d),e+="\n			"}function h(a,b){var d,e="";return e+="\n					",d=c["if"].call(a,(d=a&&a.location,null==d||d===!1?d:d.displayName),{hash:{},inverse:p.noop,fn:p.program(5,i,b),data:b}),(d||0===d)&&(e+=d),e+="\n				"}function i(a,b){var c,d="";return d+='\n					&nbsp;|&nbsp;<span class="post-location"><span class="icon-wb_location"></span>&nbsp;'+o((c=a&&a.location,c=null==c||c===!1?c:c.displayName,typeof c===n?c.apply(a):c))+"</span>\n					"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var j,k,l,m="",n="function",o=this.escapeExpression,p=this,q=c.helperMissing;return m+='<div class="post-parent">\n	\n	<!-- <div class="post-author-avatar left">\n		<a href="'+o((j=b&&b.author,j=null==j||j===!1?j:j.personalized_url,typeof j===n?j.apply(b):j))+'" title="'+o((j=b&&b.author,j=null==j||j===!1?j:j.username,typeof j===n?j.apply(b):j))+'" class="profile-hovercard" data-username="'+o((j=b&&b.author,j=null==j||j===!1?j:j.username,typeof j===n?j.apply(b):j))+'">\n			<img src="'+o((k=c.getDisplayPictureUrl||b&&b.getDisplayPictureUrl,l={hash:{},data:e},k?k.call(b,(j=b&&b.author,null==j||j===!1?j:j.username),(j=b&&b.author,null==j||j===!1?j:j.display_picture_type),40,40,l):q.call(b,"getDisplayPictureUrl",(j=b&&b.author,null==j||j===!1?j:j.username),(j=b&&b.author,null==j||j===!1?j:j.display_picture_type),40,40,l)))+'" width="40" height="40" class="img-circle" />\n			',k=c.compare||b&&b.compare,l={hash:{},inverse:p.noop,fn:p.program(1,f,e),data:e},j=k?k.call(b,b&&b.originality_text,"reshare",l):q.call(b,"compare",b&&b.originality_text,"reshare",l),(j||0===j)&&(m+=j),m+='\n		</a>\n	</div>\n    <div class="post-author">\n        <a href="'+o((j=b&&b.author,j=null==j||j===!1?j:j.personalized_url,typeof j===n?j.apply(b):j))+'" title="'+o((j=b&&b.author,j=null==j||j===!1?j:j.username,typeof j===n?j.apply(b):j))+'" class="profile-hovercard" data-username="'+o((j=b&&b.author,j=null==j||j===!1?j:j.username,typeof j===n?j.apply(b):j))+'">'+o((j=b&&b.author,j=null==j||j===!1?j:j.username,typeof j===n?j.apply(b):j))+"</a> "+o((k=c.userGetLabels||b&&b.userGetLabels,l={hash:{},data:e},k?k.call(b,b&&b.author,"16",l):q.call(b,"userGetLabels",b&&b.author,"16",l)))+'\n    </div>\n    <div class="post-time font-size-12">\n        <a href="',(k=c.permalink)?j=k.call(b,{hash:{},data:e}):(k=b&&b.permalink,j=typeof k===n?k.call(b,{hash:{},data:e}):k),m+=o(j)+'"><time class="timeago" datetime="'+o((k=c.dateFormat||b&&b.dateFormat,l={hash:{},data:e},k?k.call(b,b&&b.timestamp,"isoUtcDateTime",l):q.call(b,"dateFormat",b&&b.timestamp,"isoUtcDateTime",l)))+'">'+o((k=c.getRelativeTimestamp||b&&b.getRelativeTimestamp,l={hash:{},data:e},k?k.call(b,b&&b.timestamp,l):q.call(b,"getRelativeTimestamp",b&&b.timestamp,l)))+"</time> "+o((k=c.translate||b&&b.translate,l={hash:{},data:e},k?k.call(b,"post|via",l):q.call(b,"translate","post|via",l)))+" ",(k=c.application_text)?j=k.call(b,{hash:{},data:e}):(k=b&&b.application_text,j=typeof k===n?k.call(b,{hash:{},data:e}):k),m+=o(j)+'</a>\n    </div> -->\n    <div class="post-author-avatar left">\n		<a href="'+o((j=b&&b.author,j=null==j||j===!1?j:j.personalized_url,typeof j===n?j.apply(b):j))+'" title="'+o((j=b&&b.author,j=null==j||j===!1?j:j.username,typeof j===n?j.apply(b):j))+'" class="profile-hovercard" data-username="'+o((j=b&&b.author,j=null==j||j===!1?j:j.username,typeof j===n?j.apply(b):j))+'">\n			<img src="'+o((k=c.getDisplayPictureUrl||b&&b.getDisplayPictureUrl,l={hash:{},data:e},k?k.call(b,(j=b&&b.author,null==j||j===!1?j:j.username),(j=b&&b.author,null==j||j===!1?j:j.display_picture_type),40,40,l):q.call(b,"getDisplayPictureUrl",(j=b&&b.author,null==j||j===!1?j:j.username),(j=b&&b.author,null==j||j===!1?j:j.display_picture_type),40,40,l)))+'" width="40" height="40" class="img-circle" />\n			',k=c.compare||b&&b.compare,l={hash:{},inverse:p.noop,fn:p.program(1,f,e),data:e},j=k?k.call(b,b&&b.originality_text,"reshare",l):q.call(b,"compare",b&&b.originality_text,"reshare",l),(j||0===j)&&(m+=j),m+='\n		</a>\n	</div>\n	<div class="post-author-details left">\n		<div class="post-author">\n			<a href="'+o((j=b&&b.author,j=null==j||j===!1?j:j.personalized_url,typeof j===n?j.apply(b):j))+'" title="'+o((j=b&&b.author,j=null==j||j===!1?j:j.username,typeof j===n?j.apply(b):j))+'" class="profile-hovercard" data-username="'+o((j=b&&b.author,j=null==j||j===!1?j:j.username,typeof j===n?j.apply(b):j))+'">'+o((j=b&&b.author,j=null==j||j===!1?j:j.username,typeof j===n?j.apply(b):j))+"</a> "+o((k=c.userGetLabels||b&&b.userGetLabels,l={hash:{},data:e},k?k.call(b,b&&b.author,l):q.call(b,"userGetLabels",b&&b.author,l)))+'\n		</div>\n		<div class="post-time font-size-12">\n			<a href="',(k=c.permalink)?j=k.call(b,{hash:{},data:e}):(k=b&&b.permalink,j=typeof k===n?k.call(b,{hash:{},data:e}):k),m+=o(j)+'"><time class="timeago" datetime="'+o((k=c.dateFormat||b&&b.dateFormat,l={hash:{},data:e},k?k.call(b,b&&b.timestamp,"isoUtcDateTime",l):q.call(b,"dateFormat",b&&b.timestamp,"isoUtcDateTime",l)))+'">'+o((k=c.getRelativeTimestamp||b&&b.getRelativeTimestamp,l={hash:{},data:e},k?k.call(b,b&&b.timestamp,l):q.call(b,"getRelativeTimestamp",b&&b.timestamp,l)))+"</time> "+o((k=c.translate||b&&b.translate,l={hash:{},data:e},k?k.call(b,"post|via",l):q.call(b,"translate","post|via",l)))+" ",(k=c.application_text)?j=k.call(b,{hash:{},data:e}):(k=b&&b.application_text,j=typeof k===n?k.call(b,{hash:{},data:e}):k),m+=o(j)+"</a>\n			",k=c.compare||b&&b.compare,l={hash:{},inverse:p.noop,fn:p.program(3,g,e),data:e},j=k?k.call(b,b&&b.originality,1,l):q.call(b,"compare",b&&b.originality,1,l),(j||0===j)&&(m+=j),m+="\n		</div>\n	</div>\n	",(k=c.rootData)?j=k.call(b,{hash:{},data:e}):(k=b&&b.rootData,j=typeof k===n?k.call(b,{hash:{},data:e}):k),(j||0===j)&&(m+=j),m+="\n</div>"})}),define("hbs!modules/template/mimetypes/containers/post-feed/text-container",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+='\n        <span class="post-originality-text">'+m((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"post|reply",e):l.call(a,"translate","post|reply",e)))+"</span>\n    "}function g(a,b){var d,e,f="";return f+='\n        <span class="post-originality-text">'+m((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"post|share",e):l.call(a,"translate","post|share",e)))+"</span>\n    "}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var h,i,j,k="",l=c.helperMissing,m=this.escapeExpression,n=this,o="function";return k+='<div class="post-text">\n    ',i=c.compare||b&&b.compare,j={hash:{},inverse:n.noop,fn:n.program(1,f,e),data:e},h=i?i.call(b,b&&b.originality_text,"reply",j):l.call(b,"compare",b&&b.originality_text,"reply",j),(h||0===h)&&(k+=h),k+="\n    ",i=c.compare||b&&b.compare,j={hash:{},inverse:n.noop,fn:n.program(3,g,e),data:e},h=i?i.call(b,b&&b.originality_text,"reshare",j):l.call(b,"compare",b&&b.originality_text,"reshare",j),(h||0===h)&&(k+=h),k+="\n    ",(i=c.text)?h=i.call(b,{hash:{},data:e}):(i=b&&b.text,h=typeof i===o?i.call(b,{hash:{},data:e}):i),(h||0===h)&&(k+=h),k+="\n</div>\n"})}),define("hbs!modules/template/mimetypes/containers/post-feed/image-container",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h,i="",j="function",k=this.escapeExpression,l=c.helperMissing;return i+='<div class="post-image">\n    \n    \n        \n    \n    \n        <a href="',(g=c.url)?f=g.call(b,{hash:{},data:e}):(g=b&&b.url,f=typeof g===j?g.call(b,{hash:{},data:e}):g),i+=k(f)+'" class="fancybox" rel="homefeed" title="',(g=c.author)?f=g.call(b,{hash:{},data:e}):(g=b&&b.author,f=typeof g===j?g.call(b,{hash:{},data:e}):g),i+=k(f)+": "+k((g=c.characterLimiter||b&&b.characterLimiter,h={hash:{},data:e},g?g.call(b,b&&b.text,100,!0,h):l.call(b,"characterLimiter",b&&b.text,100,!0,h)))+'">\n            ',(g=c.image)?f=g.call(b,{hash:{},data:e}):(g=b&&b.image,f=typeof g===j?g.call(b,{hash:{},data:e}):g),(f||0===f)&&(i+=f),i+="\n        </a>\n    \n</div>\n"})}),define("hbs!modules/template/mimetypes/containers/post-feed/video-container",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i="function";return h+='<div class="post-video">\n    ',(g=c.video)?f=g.call(b,{hash:{},data:e}):(g=b&&b.video,f=typeof g===i?g.call(b,{hash:{},data:e}):g),(f||0===f)&&(h+=f),h+="\n</div>"})}),define("hbs!modules/template/mimetypes/containers/post-feed/link-container",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="function";return(g=c.migmelink)?f=g.call(b,{hash:{},data:e}):(g=b&&b.migmelink,f=typeof g===h?g.call(b,{hash:{},data:e}):g),f||0===f?f:""})}),define("hbs!modules/template/mimetypes/containers/post-feed/badge-container",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i="function";return(g=c.badge)?f=g.call(b,{hash:{},data:e}):(g=b&&b.badge,f=typeof g===i?g.call(b,{hash:{},data:e}):g),(f||0===f)&&(h+=f),h+="\n"})}),define("hbs!modules/template/mimetypes/containers/post-feed/achievement-container",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i="function";return(g=c.achievement)?f=g.call(b,{hash:{},data:e}):(g=b&&b.achievement,f=typeof g===i?g.call(b,{hash:{},data:e}):g),(f||0===f)&&(h+=f),h+="\n"})}),define("hbs!modules/template/chat/gift_message_block",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){return"gift-shower-fragment"}function g(a,b){return"self-msg"}function h(a,b){return"gift-shower-box"}function i(a,b){var d,e,f="";return f+='\n				<div class="gift-shower-banner"><img src="'+t((d=c.getUrl||a&&a.getUrl,e={hash:{},data:b},d?d.call(a,"jsclient",e):s.call(a,"getUrl","jsclient",e)))+'/app/images/mig.me/giftshower.png"></div>\n			'}function j(a,b){var d,e,f="";return f+='\n					<img src="',(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===u?e.call(a,{hash:{},data:b}):e),f+=t(d)+'">\n				'}function k(a,b){var d,e,f="";return f+='\n					<i class="ico ico-24 ico-store-gifts"></i>\n					<div class="fragment-text">',(e=c.gift_hotkey)?d=e.call(a,{hash:{},data:b}):(e=a&&a.gift_hotkey,d=typeof e===u?e.call(a,{hash:{},data:b}):e),f+=t(d)+"</div>\n				"}function l(a,b){return"gift-shower-msg"}function m(a,b){var d,e,f,g="";return g+='\n			<div>Gift for <a href="'+t((e=c.getProfileUrl||a&&a.getProfileUrl,f={hash:{},data:b},e?e.call(a,a&&a.recipient_name,f):s.call(a,"getProfileUrl",a&&a.recipient_name,f)))+'">',(e=c.recipient_name)?d=e.call(a,{hash:{},data:b}):(e=a&&a.recipient_name,d=typeof e===u?e.call(a,{hash:{},data:b}):e),g+=t(d)+"</a></div>\n		"}function n(a,b){var d,e,f="";return f+='\n			<div>"',(e=c.gift_message)?d=e.call(a,{hash:{},data:b}):(e=a&&a.gift_message,d=typeof e===u?e.call(a,{hash:{},data:b}):e),f+=t(d)+'"</div>\n		'}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var o,p,q,r="",s=c.helperMissing,t=this.escapeExpression,u="function",v=this;return r+='<div class="gift-fragment ',o=c["if"].call(b,b&&b.is_gift_shower,{hash:{},inverse:v.noop,fn:v.program(1,f,e),data:e}),(o||0===o)&&(r+=o),r+=" ",o=c["if"].call(b,b&&b.is_self,{hash:{},inverse:v.noop,fn:v.program(3,g,e),data:e}),(o||0===o)&&(r+=o),r+='">\n	<div class="gift-box ',o=c["if"].call(b,b&&b.is_gift_shower,{hash:{},inverse:v.noop,fn:v.program(5,h,e),data:e}),(o||0===o)&&(r+=o),r+='">\n		<div class="gift-box-fragment">\n			',o=c["if"].call(b,b&&b.is_gift_shower,{hash:{},inverse:v.noop,fn:v.program(7,i,e),data:e}),(o||0===o)&&(r+=o),r+='\n			<div class="fragment-image emoticon-pending" emoticon:id="',(p=c.gift_hotkey)?o=p.call(b,{hash:{},data:e}):(p=b&&b.gift_hotkey,o=typeof p===u?p.call(b,{hash:{},data:e}):p),r+=t(o)+'" id="',(p=c.gift_block_id)?o=p.call(b,{hash:{},data:e}):(p=b&&b.gift_block_id,o=typeof p===u?p.call(b,{hash:{},data:e}):p),r+=t(o)+'">\n				',p=c.isNotEmpty||b&&b.isNotEmpty,q={hash:{},inverse:v.program(11,k,e),fn:v.program(9,j,e),data:e},o=p?p.call(b,b&&b.url,q):s.call(b,"isNotEmpty",b&&b.url,q),(o||0===o)&&(r+=o),r+='\n			</div>\n		</div>\n	</div>\n	<div class="message-part ',o=c["if"].call(b,b&&b.is_gift_shower,{hash:{},inverse:v.noop,fn:v.program(13,l,e),data:e}),(o||0===o)&&(r+=o),r+='">\n		',o=c.unless.call(b,b&&b.is_gift_shower,{hash:{},inverse:v.noop,fn:v.program(15,m,e),data:e}),(o||0===o)&&(r+=o),r+="\n		",p=c.isNotEmpty||b&&b.isNotEmpty,q={hash:{},inverse:v.noop,fn:v.program(17,n,e),data:e},o=p?p.call(b,b&&b.gift_message,q):s.call(b,"isNotEmpty",b&&b.gift_message,q),(o||0===o)&&(r+=o),r+='\n		<div class="message-from">Love, <a href="'+t((p=c.getProfileUrl||b&&b.getProfileUrl,q={hash:{},data:e},p?p.call(b,b&&b.sender_name,q):s.call(b,"getProfileUrl",b&&b.sender_name,q)))+'">',(p=c.sender_name)?o=p.call(b,{hash:{},data:e}):(p=b&&b.sender_name,o=typeof p===u?p.call(b,{hash:{},data:e}):p),r+=t(o)+"</a></div>\n	</div>\n</div>"})}),define("hbs!modules/template/mimetypes/textplain",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i="function";return(g=c.text)?f=g.call(b,{hash:{},data:e}):(g=b&&b.text,f=typeof g===i?g.call(b,{hash:{},data:e}):g),(f||0===f)&&(h+=f),h+="\n"})}),define("hbs!modules/template/mimetypes/textrich",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i="function";return(g=c.text)?f=g.call(b,{hash:{},data:e}):(g=b&&b.text,f=typeof g===i?g.call(b,{hash:{},data:e}):g),(f||0===f)&&(h+=f),h+="\n"})}),define("hbs!modules/template/mimetypes/image",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+=' style="width:',(e=c.width)?d=e.call(a,{hash:{},data:b}):(e=a&&a.width,d=typeof e===l?e.call(a,{hash:{},data:b}):e),f+=m(d)+",height:",(e=c.height)?d=e.call(a,{hash:{},data:b}):(e=a&&a.height,d=typeof e===l?e.call(a,{hash:{},data:b}):e),f+=m(d)+'" '}function g(a,b){var d,e,f="";return f+=' src="',(e=c.thumbnailUrl)?d=e.call(a,{hash:{},data:b}):(e=a&&a.thumbnailUrl,d=typeof e===l?e.call(a,{hash:{},data:b}):e),f+=m(d)+'" '}function h(a,b){var d,e,f="";return f+=' src="',(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===l?e.call(a,{hash:{},data:b}):e),f+=m(d)+'" '}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var i,j,k="",l="function",m=this.escapeExpression,n=this;return k+='<img class="',(j=c["class"])?i=j.call(b,{hash:{},data:e}):(j=b&&b["class"],i=typeof j===l?j.call(b,{hash:{},data:e}):j),k+=m(i)+'"\n    ',i=c["if"].call(b,b&&b.setWidthHeight,{hash:{},inverse:n.noop,fn:n.program(1,f,e),data:e}),(i||0===i)&&(k+=i),k+="\n    ",i=c["if"].call(b,b&&b.displayThumbnail,{hash:{},inverse:n.program(5,h,e),fn:n.program(3,g,e),data:e}),(i||0===i)&&(k+=i),k+="\n>\n"})}),define("hbs!modules/template/mimetypes/youtube",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+='\n		<p class="video-text">',(e=c.text)?d=e.call(a,{hash:{},data:b}):(e=a&&a.text,d=typeof e===k?e.call(a,{hash:{},data:b}):e),(d||0===d)&&(f+=d),f+="</p>\n	"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var g,h,i,j="",k="function",l=this,m=c.helperMissing,n=this.escapeExpression;return j+='<div class="pinned-item-video">\n	',h=c.isNotEmpty||b&&b.isNotEmpty,i={hash:{},inverse:l.noop,fn:l.program(1,f,e),data:e},g=h?h.call(b,b&&b.text,i):m.call(b,"isNotEmpty",b&&b.text,i),(g||0===g)&&(j+=g),j+='\n	<div class="video-container ',(h=c.pinneditem)?g=h.call(b,{hash:{},data:e}):(h=b&&b.pinneditem,g=typeof h===k?h.call(b,{hash:{},data:e}):h),j+=n(g)+'">\n		<object class="',(h=c["class"])?g=h.call(b,{hash:{},data:e}):(h=b&&b["class"],g=typeof h===k?h.call(b,{hash:{},data:e}):h),j+=n(g)+'" type="application/x-shockwave-flash" data="',(h=c.url)?g=h.call(b,{hash:{},data:e}):(h=b&&b.url,g=typeof h===k?h.call(b,{hash:{},data:e}):h),j+=n(g)+'">\n		    <param name="wmode" value="',(h=c.wmode)?g=h.call(b,{hash:{},data:e}):(h=b&&b.wmode,g=typeof h===k?h.call(b,{hash:{},data:e}):h),j+=n(g)+'" />\n		    <param name="allowfullscreen" value="',(h=c.allowfullscreen)?g=h.call(b,{hash:{},data:e}):(h=b&&b.allowfullscreen,g=typeof h===k?h.call(b,{hash:{},data:e}):h),j+=n(g)+'" />\n		    <param name="controls" value="',(h=c.controls)?g=h.call(b,{hash:{},data:e}):(h=b&&b.controls,g=typeof h===k?h.call(b,{hash:{},data:e}):h),j+=n(g)+'" />\n		    <param name="movie" value="',(h=c.url)?g=h.call(b,{hash:{},data:e}):(h=b&&b.url,g=typeof h===k?h.call(b,{hash:{},data:e}):h),j+=n(g)+'" />\n		</object>\n	</div>\n</div>'})}),define("hbs!modules/template/mimetypes/vimeo",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+='\n		<p class="video-text">',(e=c.text)?d=e.call(a,{hash:{},data:b}):(e=a&&a.text,d=typeof e===k?e.call(a,{hash:{},data:b}):e),(d||0===d)&&(f+=d),f+="</p>\n	"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var g,h,i,j="",k="function",l=this,m=c.helperMissing,n=this.escapeExpression;return j+='<div class="pinned-item-video">\n	',h=c.isNotEmpty||b&&b.isNotEmpty,i={hash:{},inverse:l.noop,fn:l.program(1,f,e),data:e},g=h?h.call(b,b&&b.text,i):m.call(b,"isNotEmpty",b&&b.text,i),(g||0===g)&&(j+=g),j+='\n	<div class="video-container ',(h=c.pinneditem)?g=h.call(b,{hash:{},data:e}):(h=b&&b.pinneditem,g=typeof h===k?h.call(b,{hash:{},data:e}):h),j+=n(g)+'">\n		<object class="',(h=c["class"])?g=h.call(b,{hash:{},data:e}):(h=b&&b["class"],g=typeof h===k?h.call(b,{hash:{},data:e}):h),j+=n(g)+'" type="application/x-shockwave-flash" data="',(h=c.url)?g=h.call(b,{hash:{},data:e}):(h=b&&b.url,g=typeof h===k?h.call(b,{hash:{},data:e}):h),j+=n(g)+'">\n		    <param name="wmode" value="',(h=c.wmode)?g=h.call(b,{hash:{},data:e}):(h=b&&b.wmode,g=typeof h===k?h.call(b,{hash:{},data:e}):h),j+=n(g)+'" />\n		    <param name="allowfullscreen" value="',(h=c.allowfullscreen)?g=h.call(b,{hash:{},data:e}):(h=b&&b.allowfullscreen,g=typeof h===k?h.call(b,{hash:{},data:e}):h),j+=n(g)+'" />\n		    <param name="movie" value="',(h=c.url)?g=h.call(b,{hash:{},data:e}):(h=b&&b.url,g=typeof h===k?h.call(b,{hash:{},data:e}):h),j+=n(g)+'" />\n		</object>\n	</div>\n</div>'})}),define("hbs!modules/template/mimetypes/deezer",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+='\n	<p class="video-text">',(e=c.text)?d=e.call(a,{hash:{},data:b}):(e=a&&a.text,d=typeof e===k?e.call(a,{hash:{},data:b}):e),(d||0===d)&&(f+=d),f+="</p>\n	"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var g,h,i,j="",k="function",l=this,m=c.helperMissing,n=this.escapeExpression;return j+='<div class="pinned-item-video">\n	',h=c.isNotEmpty||b&&b.isNotEmpty,i={hash:{},inverse:l.noop,fn:l.program(1,f,e),data:e},g=h?h.call(b,b&&b.text,i):m.call(b,"isNotEmpty",b&&b.text,i),(g||0===g)&&(j+=g),j+='\n	<div class="deezer-widget">\n		<iframe scrolling="no" frameborder="0" allowTransparency="true" src="http://www.deezer.com/plugins/player?autoplay=false&playlist=',(h=c.playlist)?g=h.call(b,{hash:{},data:e}):(h=b&&b.playlist,g=typeof h===k?h.call(b,{hash:{},data:e}):h),j+=n(g)+"&width=",(h=c.width)?g=h.call(b,{hash:{},data:e}):(h=b&&b.width,g=typeof h===k?h.call(b,{hash:{},data:e}):h),j+=n(g)+"&height=",(h=c.height)?g=h.call(b,{hash:{},data:e}):(h=b&&b.height,g=typeof h===k?h.call(b,{hash:{},data:e}):h),j+=n(g)+"&cover=",(h=c.showCover)?g=h.call(b,{hash:{},data:e}):(h=b&&b.showCover,g=typeof h===k?h.call(b,{hash:{},data:e}):h),j+=n(g)+"&type=",(h=c.type)?g=h.call(b,{hash:{},data:e}):(h=b&&b.type,g=typeof h===k?h.call(b,{hash:{},data:e}):h),j+=n(g)+"&id=",(h=c.id)?g=h.call(b,{hash:{},data:e}):(h=b&&b.id,g=typeof h===k?h.call(b,{hash:{},data:e}):h),j+=n(g)+"&title=&format=",(h=c.format)?g=h.call(b,{hash:{},data:e}):(h=b&&b.format,g=typeof h===k?h.call(b,{hash:{},data:e}):h),j+=n(g)+'&app_id=undefined" width="100%" height="',(h=c.height)?g=h.call(b,{hash:{},data:e}):(h=b&&b.height,g=typeof h===k?h.call(b,{hash:{},data:e}):h),j+=n(g)+'"></iframe>\n	</div>\n</div>'})}),define("hbs!modules/template/mimetypes/flickr",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h,i="",j="function",k=this.escapeExpression,l=c.helperMissing;return i+='<div class="video-container">\n	<object class="',(g=c["class"])?f=g.call(b,{hash:{},data:e}):(g=b&&b["class"],f=typeof g===j?g.call(b,{hash:{},data:e}):g),i+=k(f)+'" type="application/x-shockwave-flash" data="http://www.flickr.com/apps/slideshow/show.swf?v=71649">\n	    <param name="wmode" value="transparent" />\n	    <param name="allowFullScreen" value="true" />\n	    <param name="movie" value="http://www.flickr.com/apps/slideshow/show.swf?v=71649" />\n	    <param name="flashvars" value="offsite=true&amp;lang=en-us&amp;page_show_url='+k((g=c.fn_get_flickr_relative_url||b&&b.fn_get_flickr_relative_url,h={hash:{},data:e},g?g.call(b,b&&b.url,h):l.call(b,"fn_get_flickr_relative_url",b&&b.url,h)))+"/show/&amp;page_show_back_url="+k((g=c.fn_get_flickr_relative_url||b&&b.fn_get_flickr_relative_url,h={hash:{},data:e},g?g.call(b,b&&b.url,h):l.call(b,"fn_get_flickr_relative_url",b&&b.url,h)))+"/&amp;set_id=",(g=c.id)?f=g.call(b,{hash:{},data:e}):(g=b&&b.id,f=typeof g===j?g.call(b,{hash:{},data:e}):g),i+=k(f)+'" />\n	</object>\n</div>'})}),define("hbs!modules/template/mimetypes/soundcloud",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+='\n		<p class="video-text">',(e=c.text)?d=e.call(a,{hash:{},data:b}):(e=a&&a.text,d=typeof e===k?e.call(a,{hash:{},data:b}):e),(d||0===d)&&(f+=d),f+="</p>\n	"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var g,h,i,j="",k="function",l=this,m=c.helperMissing,n=this.escapeExpression;return j+='<div class="pinned-item-video">\n	',h=c.isNotEmpty||b&&b.isNotEmpty,i={hash:{},inverse:l.noop,fn:l.program(1,f,e),data:e},g=h?h.call(b,b&&b.text,i):m.call(b,"isNotEmpty",b&&b.text,i),(g||0===g)&&(j+=g),j+='\n	<div class="soundcloud-widget">\n	<iframe width="',(h=c.width)?g=h.call(b,{hash:{},data:e}):(h=b&&b.width,g=typeof h===k?h.call(b,{hash:{},data:e}):h),j+=n(g)+'" height="',(h=c.height)?g=h.call(b,{hash:{},data:e}):(h=b&&b.height,g=typeof h===k?h.call(b,{hash:{},data:e}):h),j+=n(g)+'" scrolling="',(h=c.scrolling)?g=h.call(b,{hash:{},data:e}):(h=b&&b.scrolling,g=typeof h===k?h.call(b,{hash:{},data:e}):h),j+=n(g)+'" frameborder="',(h=c.frameborder)?g=h.call(b,{hash:{},data:e}):(h=b&&b.frameborder,g=typeof h===k?h.call(b,{hash:{},data:e}):h),j+=n(g)+'" src="',(h=c.url)?g=h.call(b,{hash:{},data:e}):(h=b&&b.url,g=typeof h===k?h.call(b,{hash:{},data:e}):h),j+=n(g)+'"></iframe>\n	</div>\n</div>'})}),define("hbs!modules/template/mimetypes/migmelink",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f,m="";return m+='\n<div class="row">\n	',e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:z.program(4,h,b),fn:z.program(2,g,b),data:b},d=e?e.call(a,a&&a.image,f):y.call(a,"isNotEmpty",a&&a.image,f),(d||0===d)&&(m+=d),m+='\n		    <div class="post-meta-content">\n		        ',e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:z.program(8,j,b),fn:z.program(6,i,b),data:b},d=e?e.call(a,a&&a.title,f):y.call(a,"isNotEmpty",a&&a.title,f),(d||0===d)&&(m+=d),m+="\n		        ",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:z.noop,fn:z.program(10,k,b),data:b},d=e?e.call(a,a&&a.url,f):y.call(a,"isNotEmpty",a&&a.url,f),(d||0===d)&&(m+=d),m+="\n		        ",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:z.noop,fn:z.program(12,l,b),data:b},d=e?e.call(a,a&&a.description,f):y.call(a,"isNotEmpty",a&&a.description,f),(d||0===d)&&(m+=d),m+="\n		    </div>\n		</div>\n	</div>\n"}function g(a,b){var d,e,f="";return f+='\n		<div class="col-xs-3 col-sm-3 col-md-3 no-padding-right">\n		    <div class="post-meta-thumbnail"><img src="',(e=c.image)?d=e.call(a,{hash:{},data:b}):(e=a&&a.image,d=typeof e===w?e.call(a,{hash:{},data:b}):e),f+=x(d)+'" /></div>\n		</div>\n	<div class="col-xs-9 col-sm-9 col-md-9 no-padding-left">\n	'}function h(a,b){return'\n	<div class="col-xs-12">\n		'}function i(a,b){var d,e,f="";return f+='\n		            <div class="post-meta-title"><a href="',(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===w?e.call(a,{hash:{},data:b}):e),f+=x(d)+'" target="mig33-new-window">',(e=c.title)?d=e.call(a,{hash:{},data:b}):(e=a&&a.title,d=typeof e===w?e.call(a,{hash:{},data:b}):e),(d||0===d)&&(f+=d),f+="</a></div>\n		        "}function j(a,b){var d,e,f="";return f+='\n		            <div class="post-meta-title"><a href="',(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===w?e.call(a,{hash:{},data:b}):e),f+=x(d)+'" target="mig33-new-window">',(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===w?e.call(a,{hash:{},data:b}):e),f+=x(d)+"</a></div>\n		        "}function k(a,b){var d,e,f="";return f+='\n		            <div class="post-meta-url font-size-12"><a href="',(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===w?e.call(a,{hash:{},data:b}):e),f+=x(d)+'" target="mig33-new-window">',(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===w?e.call(a,{hash:{},data:b}):e),f+=x(d)+"</a></div>\n		        "}function l(a,b){var d,e,f="";return f+='\n		            <div class="post-meta-description">'+x((d=c.characterLimiter||a&&a.characterLimiter,e={hash:{},data:b},d?d.call(a,a&&a.description,100,e):y.call(a,"characterLimiter",a&&a.description,100,e)))+"</div>\n		        "}function m(a,b){var d,e,f,g="";return g+='\n<div class="post-meta">\n    <div class="row">\n        ',e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:z.program(17,o,b),fn:z.program(15,n,b),data:b},d=e?e.call(a,a&&a.image,f):y.call(a,"isNotEmpty",a&&a.image,f),(d||0===d)&&(g+=d),g+='\n	        <div class="post-meta-content">\n	            ',e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:z.program(21,q,b),fn:z.program(19,p,b),data:b},d=e?e.call(a,a&&a.title,f):y.call(a,"isNotEmpty",a&&a.title,f),(d||0===d)&&(g+=d),g+="\n	            ",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:z.noop,fn:z.program(23,r,b),data:b},d=e?e.call(a,a&&a.url,f):y.call(a,"isNotEmpty",a&&a.url,f),(d||0===d)&&(g+=d),g+="\n	            ",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:z.noop,fn:z.program(25,s,b),data:b},d=e?e.call(a,a&&a.description,f):y.call(a,"isNotEmpty",a&&a.description,f),(d||0===d)&&(g+=d),g+="\n	        </div>\n    	</div>\n	</div>\n</div>\n"}function n(a,b){var d,e,f="";return f+='\n        <div class="col-xs-3 col-sm-3 col-md-3 no-padding-right">\n            <div class="post-meta-thumbnail"><img src="',(e=c.image)?d=e.call(a,{hash:{},data:b}):(e=a&&a.image,d=typeof e===w?e.call(a,{hash:{},data:b}):e),f+=x(d)+'" /></div>\n        </div>\n    	<div class="col-xs-9 col-sm-9 col-md-9 no-padding-left">\n        '}function o(a,b){return'\n        <div class="col-xs-12">\n        '}function p(a,b){var d,e,f="";return f+='\n	                <div class="post-meta-title"><a href="',(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===w?e.call(a,{hash:{},data:b}):e),f+=x(d)+'" target="mig33-new-window">',(e=c.title)?d=e.call(a,{hash:{},data:b}):(e=a&&a.title,d=typeof e===w?e.call(a,{hash:{},data:b}):e),(d||0===d)&&(f+=d),f+="</a></div>\n	            "}function q(a,b){var d,e,f="";return f+='\n	                <div class="post-meta-title"><a href="',(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===w?e.call(a,{hash:{},data:b}):e),f+=x(d)+'" target="mig33-new-window">',(e=c.url)?d=e.call(a,{
hash:{},data:b}):(e=a&&a.url,d=typeof e===w?e.call(a,{hash:{},data:b}):e),f+=x(d)+"</a></div>\n	            "}function r(a,b){var d,e,f="";return f+='\n	                <div class="post-meta-url font-size-12"><a href="',(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===w?e.call(a,{hash:{},data:b}):e),f+=x(d)+'" target="mig33-new-window">',(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===w?e.call(a,{hash:{},data:b}):e),f+=x(d)+"</a></div>\n	            "}function s(a,b){var d,e,f="";return f+='\n	                <div class="post-meta-description">'+x((d=c.characterLimiter||a&&a.characterLimiter,e={hash:{},data:b},d?d.call(a,a&&a.description,100,e):y.call(a,"characterLimiter",a&&a.description,100,e)))+"</div>\n	            "}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var t,u,v,w="function",x=this.escapeExpression,y=c.helperMissing,z=this;return u=c.isNotEmpty||b&&b.isNotEmpty,v={hash:{},inverse:z.program(14,m,e),fn:z.program(1,f,e),data:e},t=u?u.call(b,b&&b.sync,v):y.call(b,"isNotEmpty",b&&b.sync,v),t||0===t?t:""})}),define("hbs!modules/template/mimetypes/unsupported_block",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i="function";return(g=c.details)?f=g.call(b,{hash:{},data:e}):(g=b&&b.details,f=typeof g===i?g.call(b,{hash:{},data:e}):g),(f||0===f)&&(h+=f),h+="\n"})}),define("hbs!modules/template/mimetypes/partnerlink",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f,k="";return k+='\n<div class="partner-post row">\n	',e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:v.noop,fn:v.program(2,g,b),data:b},d=e?e.call(a,a&&a.image,f):u.call(a,"isNotEmpty",a&&a.image,f),(d||0===d)&&(k+=d),k+='\n	<div class="col-xs-12">\n		<div class="post-meta-content">\n		',e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:v.program(6,i,b),fn:v.program(4,h,b),data:b},d=e?e.call(a,a&&a.title,f):u.call(a,"isNotEmpty",a&&a.title,f),(d||0===d)&&(k+=d),k+="\n		</div>\n		",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:v.noop,fn:v.program(8,j,b),data:b},d=e?e.call(a,a&&a.favicon,f):u.call(a,"isNotEmpty",a&&a.favicon,f),(d||0===d)&&(k+=d),k+="\n	</div>\n</div>\n"}function g(a,b){var d,e,f="";return f+='\n		<div class="col-xs-12">\n		    <div class="meta-thumbnail"><img src="',(e=c.image)?d=e.call(a,{hash:{},data:b}):(e=a&&a.image,d=typeof e===s?e.call(a,{hash:{},data:b}):e),f+=t(d)+'" /></div>\n		</div>\n	'}function h(a,b){var d,e,f="";return f+='\n			<div class="post-meta-title"><a href="',(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===s?e.call(a,{hash:{},data:b}):e),f+=t(d)+'" target="mig33-new-window">',(e=c.title)?d=e.call(a,{hash:{},data:b}):(e=a&&a.title,d=typeof e===s?e.call(a,{hash:{},data:b}):e),(d||0===d)&&(f+=d),f+="</a></div>\n		"}function i(a,b){var d,e,f="";return f+='\n			<div class="post-meta-title"><a href="',(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===s?e.call(a,{hash:{},data:b}):e),f+=t(d)+'" target="mig33-new-window">',(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===s?e.call(a,{hash:{},data:b}):e),f+=t(d)+"</a></div>\n		"}function j(a,b){var d,e,f,g="";return g+='\n		<div class="partner-logo">\n			<a href="',(e=c.partnerURL)?d=e.call(a,{hash:{},data:b}):(e=a&&a.partnerURL,d=typeof e===s?e.call(a,{hash:{},data:b}):e),g+=t(d)+'">\n				<img src="'+t((e=c.getUrl||a&&a.getUrl,f={hash:{},data:b},e?e.call(a,"jsclient",f):u.call(a,"getUrl","jsclient",f))),(e=c.favicon)?d=e.call(a,{hash:{},data:b}):(e=a&&a.favicon,d=typeof e===s?e.call(a,{hash:{},data:b}):e),g+=t(d)+'"><span>',(e=c.partnerURL)?d=e.call(a,{hash:{},data:b}):(e=a&&a.partnerURL,d=typeof e===s?e.call(a,{hash:{},data:b}):e),g+=t(d)+"</span>\n			</a>\n		</div>\n		 "}function k(a,b){var d,e,f,g="";return g+='\n<div class="post-meta">\n    <div class="partner-post row">\n        ',e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:v.noop,fn:v.program(11,l,b),data:b},d=e?e.call(a,a&&a.image,f):u.call(a,"isNotEmpty",a&&a.image,f),(d||0===d)&&(g+=d),g+='\n        <div class="col-xs-12">\n	        <div class="post-meta-content">\n	            ',e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:v.program(15,n,b),fn:v.program(13,m,b),data:b},d=e?e.call(a,a&&a.title,f):u.call(a,"isNotEmpty",a&&a.title,f),(d||0===d)&&(g+=d),g+="\n				",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:v.noop,fn:v.program(17,o,b),data:b},d=e?e.call(a,a&&a.favicon,f):u.call(a,"isNotEmpty",a&&a.favicon,f),(d||0===d)&&(g+=d),g+="\n	        </div>\n    	</div>\n	</div>\n</div>\n"}function l(a,b){var d,e,f="";return f+='\n        <div class="col-xs-12">\n            <div class="meta-thumbnail"><img src="',(e=c.image)?d=e.call(a,{hash:{},data:b}):(e=a&&a.image,d=typeof e===s?e.call(a,{hash:{},data:b}):e),f+=t(d)+'" /></div>\n        </div>\n        '}function m(a,b){var d,e,f="";return f+='\n	                <div class="post-meta-title"><a href="',(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===s?e.call(a,{hash:{},data:b}):e),f+=t(d)+'" target="mig33-new-window">',(e=c.title)?d=e.call(a,{hash:{},data:b}):(e=a&&a.title,d=typeof e===s?e.call(a,{hash:{},data:b}):e),(d||0===d)&&(f+=d),f+="</a></div>\n	            "}function n(a,b){var d,e,f="";return f+='\n	                <div class="post-meta-title"><a href="',(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===s?e.call(a,{hash:{},data:b}):e),f+=t(d)+'" target="mig33-new-window">',(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===s?e.call(a,{hash:{},data:b}):e),f+=t(d)+"</a></div>\n	            "}function o(a,b){var d,e,f,g="";return g+='\n				<div class="partner-logo">\n					<a href="',(e=c.partnerURL)?d=e.call(a,{hash:{},data:b}):(e=a&&a.partnerURL,d=typeof e===s?e.call(a,{hash:{},data:b}):e),g+=t(d)+'">\n						<img src="'+t((e=c.getUrl||a&&a.getUrl,f={hash:{},data:b},e?e.call(a,"jsclient",f):u.call(a,"getUrl","jsclient",f))),(e=c.favicon)?d=e.call(a,{hash:{},data:b}):(e=a&&a.favicon,d=typeof e===s?e.call(a,{hash:{},data:b}):e),g+=t(d)+'"><span>',(e=c.partnerURL)?d=e.call(a,{hash:{},data:b}):(e=a&&a.partnerURL,d=typeof e===s?e.call(a,{hash:{},data:b}):e),g+=t(d)+"</span>\n					</a>\n				</div>\n				 "}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var p,q,r,s="function",t=this.escapeExpression,u=c.helperMissing,v=this;return q=c.isNotEmpty||b&&b.isNotEmpty,r={hash:{},inverse:v.program(10,k,e),fn:v.program(1,f,e),data:e},p=q?q.call(b,b&&b.sync,r):u.call(b,"isNotEmpty",b&&b.sync,r),p||0===p?p:""})}),define("hbs!modules/template/mimetypes/achievement",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h,i="",j=c.helperMissing,k=this.escapeExpression,l="function";return i+='<div id="achievement-feedpost-container">\n    <div class="banner">\n        <img src="'+k((g=c.getUrl||b&&b.getUrl,h={hash:{},data:e},g?g.call(b,"jsclient",h):j.call(b,"getUrl","jsclient",h)))+'/app/images/identity/identity_header_web.png" />\n    </div>\n\n    <div class="label-content text-center">\n        <h2 class="label-header text-center">'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"Congratulation",h):j.call(b,"translate","Congratulation",h)))+'</h2>\n\n        <img class="label-img" src="'+k((g=c.getUrl||b&&b.getUrl,h={hash:{},data:e},g?g.call(b,"jsclient",h):j.call(b,"getUrl","jsclient",h)))+"/app/images/identity/",(g=c.imageName)?f=g.call(b,{hash:{},data:e}):(g=b&&b.imageName,f=typeof g===l?g.call(b,{hash:{},data:e}):g),i+=k(f)+'" />\n\n        <div class="descriptions">\n            <h3 class="greetings text-center">',(g=c.labelGreetings)?f=g.call(b,{hash:{},data:e}):(g=b&&b.labelGreetings,f=typeof g===l?g.call(b,{hash:{},data:e}):g),i+=k(f)+'</h3>\n            <h4 class="details text-center">',(g=c.description)?f=g.call(b,{hash:{},data:e}):(g=b&&b.description,f=typeof g===l?g.call(b,{hash:{},data:e}):g),i+=k(f)+'</h4>\n        </div>\n    </div>\n\n    <a href="'+k((g=c.getUrl||b&&b.getUrl,h={hash:{},data:e},g?g.call(b,"corporate",h):j.call(b,"getUrl","corporate",h)))+'/faq" target="_blank" class="action-icon">\n        <div class="profile-section-footer">\n            <div class="footer-title">\n                <span class="icon-wb_info  font-size-14 col-xs-16"></span> '+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"Find out more about user labels",h):j.call(b,"translate","Find out more about user labels",h)))+'\n                <span class="icon-wb_arrowRight font-size-12 col-xs-16 right"></span>\n            </div>\n        </div>\n    </a>\n</div>'})}),define("hbs!modules/template/mimetypes/badge",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h,i="",j=c.helperMissing,k=this.escapeExpression,l="function";return i+='<div id="badge-feedpost-container">\n    <div class="badge-image left">\n        <img src="'+k((g=c.getBadgeImageUrl||b&&b.getBadgeImageUrl,h={hash:{},data:e},g?g.call(b,b&&b.imageName,96,h):j.call(b,"getBadgeImageUrl",b&&b.imageName,96,h)))+'" />\n    </div>\n\n    <div class="badge-content left font-size-14">\n        <p class="badge-greeting">',(g=c.username)?f=g.call(b,{hash:{},data:e}):(g=b&&b.username,f=typeof g===l?g.call(b,{hash:{},data:e}):g),i+=k(f)+' earned:</p>\n        <p class="badge-name">',(g=c.badgeName)?f=g.call(b,{hash:{},data:e}):(g=b&&b.badgeName,f=typeof g===l?g.call(b,{hash:{},data:e}):g),(f||0===f)&&(i+=f),i+='</p>\n        <p class="badge-description">',(g=c.description)?f=g.call(b,{hash:{},data:e}):(g=b&&b.description,f=typeof g===l?g.call(b,{hash:{},data:e}):g),(f||0===f)&&(i+=f),i+="</p>\n    </div>\n</div>\n"})}),define("hbs!modules/template/mimetypes/reshared-achievement",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h,i="",j="function",k=this.escapeExpression,l=c.helperMissing;return i+='<a href="',(g=c.permalink)?f=g.call(b,{hash:{},data:e}):(g=b&&b.permalink,f=typeof g===j?g.call(b,{hash:{},data:e}):g),i+=k(f)+'">\n    <div id="badge-feedpost-container">\n        <div class="badge-image left">\n            <img src="'+k((g=c.getUrl||b&&b.getUrl,h={hash:{},data:e},g?g.call(b,"jsclient",h):l.call(b,"getUrl","jsclient",h)))+"/app/images/identity/",(g=c.imageName)?f=g.call(b,{hash:{},data:e}):(g=b&&b.imageName,f=typeof g===j?g.call(b,{hash:{},data:e}):g),i+=k(f)+'" />\n        </div>\n\n        <div class="badge-content left font-size-14">\n            <p class="badge-greeting">',(g=c.username)?f=g.call(b,{hash:{},data:e}):(g=b&&b.username,f=typeof g===j?g.call(b,{hash:{},data:e}):g),i+=k(f)+' earned:</p>\n            <p class="badge-name">',(g=c.badgeName)?f=g.call(b,{hash:{},data:e}):(g=b&&b.badgeName,f=typeof g===j?g.call(b,{hash:{},data:e}):g),(f||0===f)&&(i+=f),i+='</p>\n            <p class="badge-description">',(g=c.description)?f=g.call(b,{hash:{},data:e}):(g=b&&b.description,f=typeof g===j?g.call(b,{hash:{},data:e}):g),(f||0===f)&&(i+=f),i+='</p>\n            <p class="root-post-metrics">comments ',(g=c.numberOfComments)?f=g.call(b,{hash:{},data:e}):(g=b&&b.numberOfComments,f=typeof g===j?g.call(b,{hash:{},data:e}):g),i+=k(f)+" • shares ",(g=c.numberOfShares)?f=g.call(b,{hash:{},data:e}):(g=b&&b.numberOfShares,f=typeof g===j?g.call(b,{hash:{},data:e}):g),i+=k(f)+"</span></p>\n        </div>\n    </div>\n</a>\n"})}),define("modules/post/post_renderer",["require","exports","../model/mimetypes/mime_types","../view/mimetypes/mimetype_layout_renderer","../model/mimetypes/def/deezer_mime","hbs!modules/template/mimetypes/containers/post-feed/base-feed-container","hbs!modules/template/mimetypes/containers/post-feed/base-post-container","hbs!modules/template/mimetypes/containers/post-feed/root-container","hbs!modules/template/mimetypes/containers/post-feed/parent-container","hbs!modules/template/mimetypes/containers/post-feed/text-container","hbs!modules/template/mimetypes/containers/post-feed/image-container","hbs!modules/template/mimetypes/containers/post-feed/video-container","hbs!modules/template/mimetypes/containers/post-feed/link-container","hbs!modules/template/mimetypes/containers/post-feed/badge-container","hbs!modules/template/mimetypes/containers/post-feed/achievement-container","hbs!modules/template/chat/gift_message_block","hbs!modules/template/mimetypes/textplain","hbs!modules/template/mimetypes/textrich","hbs!modules/template/mimetypes/image","hbs!modules/template/mimetypes/youtube","hbs!modules/template/mimetypes/vimeo","hbs!modules/template/mimetypes/deezer","hbs!modules/template/mimetypes/flickr","hbs!modules/template/mimetypes/soundcloud","hbs!modules/template/mimetypes/migmelink","hbs!modules/template/mimetypes/unsupported_block","hbs!modules/template/mimetypes/partnerlink","hbs!modules/template/mimetypes/achievement","hbs!modules/template/mimetypes/badge","hbs!modules/template/mimetypes/reshared-achievement"],function(a,b,c,d,e){function f(b){var c="",d=b.mimeData,e=a("hbs!modules/template/mimetypes/containers/post-feed/base-feed-container");for(var f in d){var g=i(d[f],b);if(c+=e({baseData:g.content}),g.skip)break}return c}function g(b){var c="",d=b.mimeData,e=a("hbs!modules/template/mimetypes/containers/post-feed/base-post-container");for(var f in d){var g=i(d[f],b);if(c+=e({baseData:g.content}),g.skip)break}return c}function h(a,b,c){var d="",e="",f=c.parent_post&&c.parent_post.mimeData;if(""!==f&&"string"==typeof f)try{f=$.parseJSON(f)}catch(g){}for(var h in f){var j=i(f[h],b,!0);if(e+=j.content,j.skip)break}return d+=a({rootData:e,author:b.author,permalink:b.permalink,timestamp:b.timestamp,application_text:b.application_text})}function i(b,f,g){"undefined"==typeof g&&(g=!1);var i="",j=!1;return Object.keys(b).forEach(function(k){var l=b[k];if(""!==l&&"string"==typeof l)try{l=$.parseJSON(l)}catch(m){}switch(c.getMimeType(k)){case 0:var n=a("hbs!modules/template/mimetypes/containers/post-feed/root-container");i+=h(n,l,f);break;case 15:var o=a("hbs!modules/template/mimetypes/containers/post-feed/parent-container");i+=h(o,l,f);break;case 1:var p=d.get_mime_layout(k,l),q=a("hbs!modules/template/mimetypes/containers/post-feed/text-container");i+=q({originality_text:f.originality_text,text:p});break;case 7:var r=d.get_mime_layout(k,l),q=a("hbs!modules/template/mimetypes/containers/post-feed/text-container");i+=q({originality_text:f.originality_text,text:r});break;case 2:var s=d.get_mime_layout(k,l),q=a("hbs!modules/template/mimetypes/containers/post-feed/text-container");i+=q({originality_text:f.originality_text,text:s});break;case 5:l.url=f.media.photo.url.original;var t=d.get_mime_layout(k,l,{"class":"post-gift-img"}),u=a("hbs!modules/template/mimetypes/containers/post-feed/link-container");i+=u({migmelink:t}),j=!0;break;case 6:var v=d.get_mime_layout(k,l),q=a("hbs!modules/template/mimetypes/containers/post-feed/text-container");i+=q({originality_text:f.originality_text,text:v});break;case 3:l.url&&l.url.original&&(l.url=l.url.original);var w=d.get_mime_layout(k,l,{"class":"post-image-img","display-thumbnail":!1}),x=a("hbs!modules/template/mimetypes/containers/post-feed/image-container");i+=x({image:w,url:l.url,author:f.author.username,text:f.body});break;case 4:var y=d.get_mime_layout(k,l,{"class":"post-video-object"}),z=a("hbs!modules/template/mimetypes/containers/post-feed/video-container");i+=z({video:y});break;case 8:var y=d.get_mime_layout(k,l,{"class":"post-video-object"}),z=a("hbs!modules/template/mimetypes/containers/post-feed/video-container");i+=z({video:y});break;case 14:var A=e.getBlogPostConfig(),B=l;B.showCover=A.showCover,B.width=A.width,B.height=A.height,B.playlist=A.playlist;var C=d.get_mime_layout(k,B,{"class":"post-music-deezer"}),D=a("hbs!modules/template/mimetypes/containers/post-feed/video-container");i+=D({video:C});break;case 9:var y=d.get_mime_layout(k,l,{"class":"post-video-object"}),z=a("hbs!modules/template/mimetypes/containers/post-feed/video-container");i+=z({video:y});break;case 10:var y=d.get_mime_layout(k,l,{"class":"post-video-object"}),z=a("hbs!modules/template/mimetypes/containers/post-feed/video-container");i+=z({video:y});break;case 11:i+=d.get_mime_layout(k,l,{characterLimiter:100});break;case 16:i+=d.get_mime_layout(k,l,{characterLimiter:100});break;case 12:i+=d.get_mime_layout(k,l,{width:64,height:64});break;case 17:var E=d.get_mime_layout(k,l),F=a("hbs!modules/template/mimetypes/containers/post-feed/badge-container");i+=F({badge:E});break;case 18:if(g){var G=a("hbs!modules/template/mimetypes/reshared-achievement");i+=G({username:l.username,badgeName:l.labelName,description:l.description,imageName:l.labelName.toLowerCase()+"_display.png",numberOfComments:f.num_of_replies,numberOfShares:f.num_of_reshares,permalink:f.permalink});break}var H=d.get_mime_layout(k,l),I=a("hbs!modules/template/mimetypes/containers/post-feed/achievement-container");i+=I({achievement:H});break;case 13:var J=a("hbs!modules/template/mimetypes/unsupported_block");i+=J({details:f.message});break;default:var K=a("hbs!modules/template/mimetypes/unsupported_block");i+=K({details:"This feature is currently not supported."})}}),{content:i,skip:j}}b.renderFeed=f,b.renderPost=g}),define("modules/template/helpers/post_helpers",["handlebars","modules/common/utility","modules/common/session_user","modules/globals/url","modules/post/post_renderer"],function(a,b,c,d,e){function f(a,b){if(a&&"string"==typeof a)try{a=$.parseJSON(a),Array.isArray(a)||(a=Array(a))}catch(c){a=[]}return a&&1===b&&a.reverse(),a}var g={width:500,height:600},h=[96,120,200,320,480,800],i=h.concat().reverse(),j=function(a){var b="box";if(null!==a.media){if(null!==a.media.photo){var c=a.media.photo.original_width,d=a.media.photo.original_height;0===c||0===d?null!==a.media.photo.url.size_480&&(b+=" box-horizontal"):c>=g.width&&d>=g.height?b+=" box-large":c>=g.width&&d<g.height?b+=" box-horizontal":c<g.width&&d>=g.height&&(b+=" box-vertical")}null!==a.media.video&&"vimeo"==a.media.video.type&&(b+=" box-horizontal")}return b+=1===a.originality?" box-original":2===a.originality?" box-reply":" box-reshare",b+=" box-"+a.type_text};a.registerHelper("fn_post_get_css_class",function(){var a=this;j(a)});var k=function(a,b){for(var c=b?h:i,d=c.length;d--;){var e=c[d];if(a["size_"+e])return{size:e,value:a["size_"+e]}}return""};a.registerHelper("fn_post_get_big_image",function(a){var b=this;return a&&a.type_text&&(b=a),"photo"!==b.type_text?"":b.media&&b.media.photo&&b.media.photo.url?k(b.media.photo.url,!0).value:""}),a.registerHelper("fn_post_reply_get_big_image",function(a){return a&&a.url?k(a.url,!0).value:""}),a.registerHelper("fn_post_get_small_image",function(a){var b=this;return a&&a.type_text&&(b=a),"photo"!==b.type_text?"":b.media&&b.media.photo&&b.media.photo.url?k(b.media.photo.url,!1).value:""}),a.registerHelper("fn_post_id_valid",function(){var a=this;return 0===a.id.search(/^\d+-\d+$/)}),a.registerHelper("fn_get_flickr_relative_url",function(a){return a.replace("http://www.flickr.com","")});var l=function(){var a=this;return a.body?-1!==a.body.indexOf(c.getInstance().get("personalized_url")):!1};a.registerHelper("ifMentionMe",function(a){var b=l.apply(this);return b?a.fn(this):a.inverse(this)}),a.registerHelper("fn_did_mention_me",l),a.registerHelper("ifCanShowRootPost",function(a){var b=this;if("reply"===b.originality_text&&b.root_post.author&&b.root_post.author.username){if("photo"===b.root_post.type_text&&"photo"===b.type_text){if("mig33"===b.root_post.media.photo.type)return a.inverse(this)}else{if("photo"===b.type_text&&"mig33"===b.media.photo.type)return a.inverse(this);if("photo"===b.root_post.type_text&&"video"===b.type_text)return a.inverse(this);if("video"===b.root_post.type_text&&"video"===b.type_text)return a.inverse(this);if("video"===b.root_post.type_text&&"photo"===b.type_text)return a.inverse(this)}return a.fn(this)}return a.inverse(this)}),a.registerHelper("getPostTagPropertyImage",function(a,b){return 36===b?a:a.replace("/36/","/"+b+"/")}),a.registerHelper("ifCanViewFeedOrPost",function(a){if(this.group&&this.group.id)return a.fn(this);if(this.author&&this.author.relationship.is_self)return a.fn(this);if(null!==this.privacy)if(0===this.privacy){if(this.author&&1===this.author.privacy.feed)return a.fn(this);if(this.author&&2===this.author.privacy.feed&&this.author.relationship&&(this.author.relationship.is_friend||this.author.relationship.is_follower))return a.fn(this)}else if(1===this.privacy&&this.author.relationship&&this.author.relationship.is_friend)return a.fn(this);return a.inverse(this)}),a.registerHelper("ifPostCanBeReply",function(a){return 0===this.reply_permission?a.fn(this):a.inverse(this)}),a.registerHelper("ifPostCanBeShared",function(a){return 0===this.privacy||1===this.privacy?a.fn(this):a.inverse(this)}),a.registerHelper("ifPostCanBeReshared",function(a){return b.is_logged_in()&&this.author&&this.author.relationship.is_self?a.fn(this):!this.author||1!==this.author.privacy.feed||0!==this.privacy&&1!==this.privacy||this.group?a.inverse(this):a.fn(this)}),a.registerHelper("ifPostCanBeWatched",function(a){return b.is_logged_in()&&!this.group?a.fn(this):a.inverse(this)}),a.registerHelper("ifPostCanBeDeleted",function(a){return b.is_logged_in()&&this.author&&(this.author.relationship.is_self||"A"===c.getInstance().get("label").admin)?a.fn(this):a.inverse(this)}),a.registerHelper("ifPostReplyCanBeDeleted",function(a){return b.is_logged_in()&&this.author&&this.parent_post&&this.parent_post.author&&(this.author.relationship.is_self||"A"===c.getInstance().get("label").admin||this.parent_post.author.username==c.getInstance().get("username"))?a.fn(this):a.inverse(this)}),a.registerHelper("ifSponsoredPost",function(a){return 4===parseInt(this.source,10)?a.fn(this):a.inverse(this)}),a.registerHelper("ifExistMimeData",function(a){return"undefined"!=typeof this.mimeData?a.fn(this):a.inverse(this)}),a.registerHelper("ifExistRootPostMimeData",function(a){return"undefined"!=typeof this.root_post.mimeData?a.fn(this):a.inverse(this)}),a.registerHelper("renderPostMimeContent",function(){return console.warn("renderPostMimeContent"),this.mimeData=f(this.mimeData,this.originality),e.renderFeed(this)}),a.registerHelper("renderPostDetailMimeContent",function(){return console.warn("renderPostDetailMimeContent"),this.mimeData=f(this.mimeData,this.originality),e.renderPost(this)}),a.registerHelper("renderRootPostMimeContent",function(){return console.warn("renderRootPostMimeContent"),e.renderFeed(this.root_post)}),a.registerHelper("renderRootPostDetailMimeContent",function(){return console.warn("renderRootPostDetailMimeContent"),e.renderPost(this.root_post)})}),define("modules/view/homefeed/homefeed_layout",["jquery","underscore","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/common/session_user","modules/view/common/postbox_view","hbs!modules/template/homefeed/homefeed-layout","modules/template/helpers/general_helpers","modules/template/helpers/post_helpers"],function(a,b,c,d,e,f,g,h,i,j,k){var l=e.Layout.extend({initialize:function(){b.bindAll(this,"detect_scroll"),a(window).scroll(this.detect_scroll)},template:{type:"handlebars",template:k},className:"row",regions:{filters:".box-filter-container",panel_hottopics:".panel-hottopics .panel-body",panel_global_rec:".panel-hotpeople .panel-body-global",panel_country_rec:".panel-hotpeople .panel-body-country",panel_addressbook_rec:".panel-hotpeople .panel-body-addressbook",panel_invite:".panel-invite .panel-body",panel_google_adx:".panel-google-adx",panel_banner:".panel-banner",banner_homefeed:".banner-homefeed",container:".posts",pagination:".load-more",new_achievement_alerts_region:".new-achievement-alerts"},events:{"click .expand":"toggleExpandedCollapsed","click .collapse":"toggleExpandedCollapsed","click #new-message.posts":"fetchNewPost","click .postbox-sample":"removeFocus"},removeFocus:function(){a(".postbox-sample input",this.$el).blur()},fixTabsOnScroll:function(){var b=a(".tabs-homefeed",this.$el);a(window).scroll(function(){a(this).scrollTop()>a(".content-homefeed .post-box-container").height()&&"static"==b.css("position")?b.addClass("fixed").css("width",a(".content-homefeed").width()):a(this).scrollTop()<=a(".content-homefeed .post-box-container").height()&&b.hasClass("fixed")&&b.removeClass("fixed").removeAttr("style")})},showChatrooms:function(b){a(".sidebar-details .chatrooom-sidebar-control",this.$el).remove(),a(".sidebar-details",this.$el).prepend(b)},toggleExpandedCollapsed:function(b){b.preventDefault();var c=a(b.currentTarget,this.$el).data("type"),d=c.charAt(0).toUpperCase()+c.slice(1),e=a("."+c,this.$el);e.hasClass("section-expanded")?h.send_event_to_ga("Chat","Chatroom Sidebar",d+" Collapsed"):h.send_event_to_ga("Chat","Chatroom Sidebar",d+" Expanded"),e.toggleClass("section-expanded section-collapsed")},showPagination:function(){a(".load-more",this.$el).show()},hidePagination:function(){a(".load-more",this.$el).hide()},setPostsTabActive:function(){a("ul.nav > li",this.$el).removeClass("active"),a("ul.nav > li",this.$el).eq(0).addClass("active")},setMentionsTabActive:function(){a("ul.nav > li",this.$el).removeClass("active"),a("ul.nav > li",this.$el).eq(1).addClass("active")},setWatchlistTabActive:function(){a("ul.nav > li",this.$el).removeClass("active"),a("ul.nav > li",this.$el).eq(2).addClass("active")},updateMentionsCount:function(b){var c=b>0?b:"";a(".mentions-unread-count",this.$el).css("visibility","hidden").text(c)},updatePostsCount:function(b){var c=b>0?b:"";a(".posts-unread-count",this.$el).css("visibility","hidden").text(c)},updateSubscriptionsCount:function(b){var c=b>0?b:"";a(".subscriptions-count",this.$el).css("visibility","hidden").text(c)},showOrHideNewPostsMessage:function(b,c){if(c>0){var d=a("#new-message."+b,this.$el),e='<div class="alert alert-grey">'+h.translate("homefeed|new_"+b,c)+"</div>";0===a(window).scrollTop()?this.fetchNewPost():d.html(e).fadeIn()}else this.clearNewPostsMessage()},detect_scroll:function(){var b=a("#new-message.posts");b.is(":visible")&&a(window).scrollTop()<10&&this.fetchNewPost()},clearNewPostsMessage:function(){a("#new-message",this.$el).html("").hide()},addClassToNewPostsMessage:function(b){a("#new-message",this.$el).removeClass().addClass(b)},fetchNewPost:function(){a(window).scrollTo(0,{duration:"slow"}),a(".loading",this.$el).removeClass("hidden"),this.trigger("homefeed:posts:new")},displayAchievementLabelsUnlocked:function(){}});return l}),define("hbs!modules/template/homefeed/post-feed-view",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f,i="";return i+='\n		<div class="row">\n			<div class="col-xs-12">\n				<div class="post-promoted-text">\n					<span class="icon-wb_hot"></span>&nbsp;'+R((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"common|promoted",f):Q.call(a,"translate","common|promoted",f)))+'\n				</div>\n				<div class="add_friend">\n					',d=c["if"].call(a,(d=a&&a.author,d=null==d||d===!1?d:d.relationship,null==d||d===!1?d:d.is_friend),{hash:{},inverse:S.program(4,h,b),fn:S.program(2,g,b),data:b}),(d||0===d)&&(i+=d),i+="\n				</div>\n			</div>\n		</div>\n	"}function g(a,b){var d,e,f="";return f+='\n						<a href="#" class="follow btn btn-xs btn-default btn-radius disabled" title="'+R((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"user|add",e):Q.call(a,"translate","user|add",e)))+'"><span class="icon-wb_add"></span>&nbsp;'+R((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"user|add",e):Q.call(a,"translate","user|add",e)))+"</a>\n					"}function h(a,b){var d,e="";return e+="\n						",d=c["if"].call(a,(d=a&&a.author,d=null==d||d===!1?d:d.relationship,null==d||d===!1?d:d.is_follower),{hash:{},inverse:S.program(7,j,b),fn:S.program(5,i,b),data:b}),(d||0===d)&&(e+=d),e+="\n					"}function i(a,b){var d,e,f="";return f+='\n						<a href="#" class="follow btn btn-xs btn-default btn-radius disabled" title="'+R((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"user|add",e):Q.call(a,"translate","user|add",e)))+'"><span class="icon-wb_add"></span>&nbsp;'+R((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"user|add",e):Q.call(a,"translate","user|add",e)))+"</a>\n						"}function j(a,b){var d,e="";return e+="\n							",d=c["if"].call(a,(d=a&&a.author,d=null==d||d===!1?d:d.relationship,null==d||d===!1?d:d.is_self),{hash:{},inverse:S.program(10,l,b),fn:S.program(8,k,b),data:b}),(d||0===d)&&(e+=d),e+="\n						"}function k(a,b){return"\n							"}function l(a,b){var d,e,f="";return f+='\n								<a href="#" class="follow btn btn-xs btn-default btn-radius" title="'+R((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"user|add",e):Q.call(a,"translate","user|add",e)))+'"><span class="icon-wb_add"></span>&nbsp;'+R((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"user|add",e):Q.call(a,"translate","user|add",e)))+"</a>\n							"}function m(a,b){return'\n							<span class="icon-wb_repost icon--circle icon--bottom-rights"></span>\n						'}function n(a,b){var d,e="";return e+="\n							",d=c["if"].call(a,a&&a.location,{hash:{},inverse:S.noop,fn:S.program(15,o,b),data:b}),(d||0===d)&&(e+=d),e+="\n						"}function o(a,b){var d,e="";return e+="\n								",d=c["if"].call(a,(d=a&&a.location,null==d||d===!1?d:d.displayName),{hash:{},inverse:S.noop,fn:S.program(16,p,b),data:b}),(d||0===d)&&(e+=d),e+="\n							"}function p(a,b){var c,d="";return d+='\n								&nbsp;|&nbsp;<span class="post-location"><span class="icon-wb_location"></span>&nbsp;'+R((c=a&&a.location,c=null==c||c===!1?c:c.displayName,typeof c===T?c.apply(a):c))+"</span>\n								"}function q(a,b){var d,e,f="";return f+="\n        ",(e=c.renderPostMimeContent)?d=e.call(a,{hash:{},data:b}):(e=a&&a.renderPostMimeContent,d=typeof e===T?e.call(a,{hash:{},data:b}):e),(d||0===d)&&(f+=d),f+="\n    "}function r(a,b){var e,f="";return f+="\n        ",e=S.invokePartial(d.postContent,"postContent",a,c,d,b),(e||0===e)&&(f+=e),f+="\n    "}function s(a,b){var d,e,f,g="";return g+='\n            <span class="responses-more responses-more-first responses-more-favorite font-size-12">\n                ',(e=c.num_of_watches)?d=e.call(a,{hash:{},data:b}):(e=a&&a.num_of_watches,d=typeof e===T?e.call(a,{hash:{},data:b}):e),g+=R(d)+" "+R((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"post|favourite",f):Q.call(a,"translate","post|favourite",f)))+"\n            </span>\n        "}function t(a,b){var d,e,f="";return f+="\n                "+R((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"post|like",a&&a.watcher_count,e):Q.call(a,"translate","post|like",a&&a.watcher_count,e)))+"\n            "}function u(a,b){var d,e,f="";return f+="\n                    "+R((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"post|likes",a&&a.watcher_count,e):Q.call(a,"translate","post|likes",a&&a.watcher_count,e)))+"\n                "}function v(a,b){var d,e,f="";return f+="\n                    "+R((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"post|view_reply",a&&a.num_of_replies,e):Q.call(a,"translate","post|view_reply",a&&a.num_of_replies,e)))+"\n                "}function w(a,b){var d,e,f="";return f+="\n                    "+R((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"post|view_replies",a&&a.num_of_replies,e):Q.call(a,"translate","post|view_replies",a&&a.num_of_replies,e)))+"\n                "}function x(a,b){var d,e,f="";return f+="\n                "+R((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"post|share",a&&a.num_of_reshares,e):Q.call(a,"translate","post|share",a&&a.num_of_reshares,e)))+"\n            "}function y(a,b){var d,e,f="";return f+="\n                "+R((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"post|shares",a&&a.num_of_reshares,e):Q.call(a,"translate","post|shares",a&&a.num_of_reshares,e)))+"\n            ";
}function z(a,b){var d,e="";return e+='\n						<li class="post-reaction post-reaction-watch">\n							',d=c["if"].call(a,a&&a.is_watching,{hash:{},inverse:S.program(39,B,b),fn:S.program(37,A,b),data:b}),(d||0===d)&&(e+=d),e+="\n						</li>\n					"}function A(a,b){var d,e,f="";return f+='\n								<a href="#"class="watch-post watched" title="'+R((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"post|unfavourite",e):Q.call(a,"translate","post|unfavourite",e)))+'"><span class="icon-wb_like"></span></a>\n							'}function B(a,b){var d,e,f="";return f+='\n								<a href="#" class="watch-post watch" title="'+R((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"post|favourite",e):Q.call(a,"translate","post|favourite",e)))+'"><span class="icon-wb_favourite"></span></a>\n							'}function C(a,b){var d,e,f="";return f+='\n						<li class="post-reaction post-reaction-reply">\n							<a href="#" class="show-reply" title="'+R((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"post|reply",e):Q.call(a,"translate","post|reply",e)))+'">\n								<span class="icon-wb_reply"></span>\n							</a>\n						</li>\n					'}function D(a,b){var d,e,f="";return f+='\n						<!-- <li class="post-reaction post-reaction-reshare">\n							<a href="#" class="show-reshare" title="'+R((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"post|repost",e):Q.call(a,"translate","post|repost",e)))+'">\n								<span class="icon-wb_repost"></span>\n							</a>\n						</li> -->\n					'}function E(a,b){var d,e,f="";return f+='\n						<li class="post-reaction post-reaction-share">\n							<a href="#" class="show-share" title="'+R((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"common|share",e):Q.call(a,"translate","common|share",e)))+'">\n								<span class="icon-wb_mb_share"></span>\n							</a>\n						</li>\n					'}function F(a,b){var d,e,f,g="";return g+='\n								<li><a href="#" class="delete-post" title="'+R((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"common|delete",f):Q.call(a,"translate","common|delete",f)))+'">'+R((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"common|delete",f):Q.call(a,"translate","common|delete",f)))+"</a></li>\n								",e=c.ifSystemPropertyEnabled||a&&a.ifSystemPropertyEnabled,f={hash:{},inverse:S.noop,fn:S.program(48,G,b),data:b},d=e?e.call(a,"post_reply_permission",f):Q.call(a,"ifSystemPropertyEnabled","post_reply_permission",f),(d||0===d)&&(g+=d),g+="\n							"}function G(a,b){var d,e,f,g="";return g+="\n									",e=c.compare||a&&a.compare,f={hash:{},inverse:S.program(51,I,b),fn:S.program(49,H,b),data:b},d=e?e.call(a,a&&a.reply_permission,0,f):Q.call(a,"compare",a&&a.reply_permission,0,f),(d||0===d)&&(g+=d),g+="\n								"}function H(a,b){var d,e,f="";return f+='\n										<li><a href="#" class="lock-post lock" title="'+R((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"common|lock",e):Q.call(a,"translate","common|lock",e)))+'">'+R((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"common|lock",e):Q.call(a,"translate","common|lock",e)))+"</a></li>\n									"}function I(a,b){var d,e,f="";return f+='\n										<li><a href="#" class="lock-post unlock" title="'+R((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"common|unlock",e):Q.call(a,"translate","common|unlock",e)))+'">'+R((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"common|unlock",e):Q.call(a,"translate","common|unlock",e)))+"</a></li>\n									"}function J(a,b){var d,e,f="";return f+='\n								<li><a href="#" class="report-post" title="'+R((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"common|report",e):Q.call(a,"translate","common|report",e)))+'">'+R((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"common|report",e):Q.call(a,"translate","common|report",e)))+"</a></li>\n							"}function K(a,b){var d,e,f="";return f+='\n						<div class="response-form">\n							<div class="row">\n								<div class="left post-avatar-container">\n									<div class="response-box-avatar">\n										<img src="'+R((d=c.getSessionUserDisplayPictureUrl||a&&a.getSessionUserDisplayPictureUrl,e={hash:{},data:b},d?d.call(a,24,24,e):Q.call(a,"getSessionUserDisplayPictureUrl",24,24,e)))+'" width="24" height="24" class="img-circle" />\n									</div>\n								</div>\n								<div class="left post-reply-container">\n									<div class="response-box">\n										<div class="postbox-reply"></div>\n										<div class="response-lock-message">'+R((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"post|this_post_is_locked",e):Q.call(a,"translate","post|this_post_is_locked",e)))+"</div>\n									</div>\n								</div>\n							</div>\n						</div>\n					"}function L(a,b){var d,e,f,g="";return g+='\n						<div class="response-form non-logged-in">\n							<div class="row">\n								<div class="left post-avatar-container">\n									<div class="response-box-avatar">\n										<img src="',(e=c.getDefaultFaceUrl)?d=e.call(a,{hash:{},data:b}):(e=a&&a.getDefaultFaceUrl,d=typeof e===T?e.call(a,{hash:{},data:b}):e),g+=R(d)+'" width="24" height="24" class="img-circle" />\n									</div>\n								</div>\n								<div class="left post-reply-container">\n									<div class="response-box">\n										<div class="postbox-reply"></div>\n										<div class="response-lock-message">'+R((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"post|this_post_is_locked",f):Q.call(a,"translate","post|this_post_is_locked",f)))+"</div>\n									</div>\n								</div>\n							</div>\n						</div>\n					"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),d=this.merge(d,a.partials),e=e||{};var M,N,O,P="",Q=c.helperMissing,R=this.escapeExpression,S=this,T="function",U=c.blockHelperMissing;return P+='<div class="post">\n	',O={hash:{},inverse:S.noop,fn:S.program(1,f,e),data:e},(N=c.ifSponsoredPost)?M=N.call(b,O):(N=b&&b.ifSponsoredPost,M=typeof N===T?N.call(b,O):N),c.ifSponsoredPost||(M=U.call(b,M,{hash:{},inverse:S.noop,fn:S.program(1,f,e),data:e})),(M||0===M)&&(P+=M),P+='\n	<div class="row">\n		<div class="col-xs-12">\n				<div class="post-author-avatar left">\n					<a href="'+R((M=b&&b.author,M=null==M||M===!1?M:M.personalized_url,typeof M===T?M.apply(b):M))+'" title="'+R((M=b&&b.author,M=null==M||M===!1?M:M.username,typeof M===T?M.apply(b):M))+'" class="profile-hovercard" data-username="'+R((M=b&&b.author,M=null==M||M===!1?M:M.username,typeof M===T?M.apply(b):M))+'">\n						<img src="'+R((N=c.getDisplayPictureUrl||b&&b.getDisplayPictureUrl,O={hash:{},data:e},N?N.call(b,(M=b&&b.author,null==M||M===!1?M:M.username),(M=b&&b.author,null==M||M===!1?M:M.display_picture_type),40,40,O):Q.call(b,"getDisplayPictureUrl",(M=b&&b.author,null==M||M===!1?M:M.username),(M=b&&b.author,null==M||M===!1?M:M.display_picture_type),40,40,O)))+'" width="40" height="40" class="img-circle" />\n						',N=c.compare||b&&b.compare,O={hash:{},inverse:S.noop,fn:S.program(12,m,e),data:e},M=N?N.call(b,b&&b.originality_text,"reshare",O):Q.call(b,"compare",b&&b.originality_text,"reshare",O),(M||0===M)&&(P+=M),P+='\n					</a>\n				</div>\n				<div class="post-author-details left">\n					<div class="post-author">\n						<a href="'+R((M=b&&b.author,M=null==M||M===!1?M:M.personalized_url,typeof M===T?M.apply(b):M))+'" title="'+R((M=b&&b.author,M=null==M||M===!1?M:M.username,typeof M===T?M.apply(b):M))+'" class="profile-hovercard" data-username="'+R((M=b&&b.author,M=null==M||M===!1?M:M.username,typeof M===T?M.apply(b):M))+'">'+R((M=b&&b.author,M=null==M||M===!1?M:M.username,typeof M===T?M.apply(b):M))+"</a> "+R((N=c.userGetLabels||b&&b.userGetLabels,O={hash:{},data:e},N?N.call(b,b&&b.author,O):Q.call(b,"userGetLabels",b&&b.author,O)))+'\n					</div>\n					<div class="post-time font-size-12">\n						<a href="',(N=c.permalink)?M=N.call(b,{hash:{},data:e}):(N=b&&b.permalink,M=typeof N===T?N.call(b,{hash:{},data:e}):N),P+=R(M)+'"><time class="timeago" datetime="'+R((N=c.dateFormat||b&&b.dateFormat,O={hash:{},data:e},N?N.call(b,b&&b.timestamp,"isoUtcDateTime",O):Q.call(b,"dateFormat",b&&b.timestamp,"isoUtcDateTime",O)))+'">'+R((N=c.getRelativeTimestamp||b&&b.getRelativeTimestamp,O={hash:{},data:e},N?N.call(b,b&&b.timestamp,O):Q.call(b,"getRelativeTimestamp",b&&b.timestamp,O)))+"</time> "+R((N=c.translate||b&&b.translate,O={hash:{},data:e},N?N.call(b,"post|via",O):Q.call(b,"translate","post|via",O)))+" ",(N=c.application_text)?M=N.call(b,{hash:{},data:e}):(N=b&&b.application_text,M=typeof N===T?N.call(b,{hash:{},data:e}):N),P+=R(M)+"</a>\n						",N=c.compare||b&&b.compare,O={hash:{},inverse:S.noop,fn:S.program(14,n,e),data:e},M=N?N.call(b,b&&b.originality,1,O):Q.call(b,"compare",b&&b.originality,1,O),(M||0===M)&&(P+=M),P+="\n					</div>\n				</div>\n	    </div>\n	</div>\n\n    \n    ",O={hash:{},inverse:S.program(20,r,e),fn:S.program(18,q,e),data:e},(N=c.ifExistMimeData)?M=N.call(b,O):(N=b&&b.ifExistMimeData,M=typeof N===T?N.call(b,O):N),c.ifExistMimeData||(M=U.call(b,M,{hash:{},inverse:S.program(20,r,e),fn:S.program(18,q,e),data:e})),(M||0===M)&&(P+=M),P+='\n\n    <div class="metrics">\n        ',N=c.compare||b&&b.compare,O={hash:{operator:"!="},inverse:S.noop,fn:S.program(22,s,e),data:e},M=N?N.call(b,b&&b.num_of_watches,"0",O):Q.call(b,"compare",b&&b.num_of_watches,"0",O),(M||0===M)&&(P+=M),P+='\n        <span class="responses-more responses-more-like font-size-12">\n            ',N=c.compare||b&&b.compare,O={hash:{operator:"<="},inverse:S.noop,fn:S.program(24,t,e),data:e},M=N?N.call(b,b&&b.watcher_count,"1",O):Q.call(b,"compare",b&&b.watcher_count,"1",O),(M||0===M)&&(P+=M),P+="\n                ",N=c.compare||b&&b.compare,O={hash:{operator:">"},inverse:S.noop,fn:S.program(26,u,e),data:e},M=N?N.call(b,b&&b.watcher_count,"1",O):Q.call(b,"compare",b&&b.watcher_count,"1",O),(M||0===M)&&(P+=M),P+='\n        </span>\n        <span class="responses-more responses-more-reply font-size-12">\n            <a class="more-reply" href="#">\n                ',N=c.compare||b&&b.compare,O={hash:{operator:"<="},inverse:S.noop,fn:S.program(28,v,e),data:e},M=N?N.call(b,b&&b.num_of_replies,"1",O):Q.call(b,"compare",b&&b.num_of_replies,"1",O),(M||0===M)&&(P+=M),P+="\n                ",N=c.compare||b&&b.compare,O={hash:{operator:">"},inverse:S.noop,fn:S.program(30,w,e),data:e},M=N?N.call(b,b&&b.num_of_replies,"1",O):Q.call(b,"compare",b&&b.num_of_replies,"1",O),(M||0===M)&&(P+=M),P+='\n            </a>\n        </span>\n        <span class="responses-more responses-more-reshare font-size-12">\n            ',N=c.compare||b&&b.compare,O={hash:{operator:"<="},inverse:S.noop,fn:S.program(32,x,e),data:e},M=N?N.call(b,b&&b.num_of_reshares,"1",O):Q.call(b,"compare",b&&b.num_of_reshares,"1",O),(M||0===M)&&(P+=M),P+="\n            ",N=c.compare||b&&b.compare,O={hash:{operator:">"},inverse:S.noop,fn:S.program(34,y,e),data:e},M=N?N.call(b,b&&b.num_of_reshares,"1",O):Q.call(b,"compare",b&&b.num_of_reshares,"1",O),(M||0===M)&&(P+=M),P+='\n        </span>\n    </div>\n\n	\n	<div class="post-footer">\n		<div class="row">\n			<div class="col-xs-12">\n				<ul class="list-inline post-reactions">\n					\n					',O={hash:{},inverse:S.noop,fn:S.program(36,z,e),data:e},(N=c.ifPostCanBeWatched)?M=N.call(b,O):(N=b&&b.ifPostCanBeWatched,M=typeof N===T?N.call(b,O):N),c.ifPostCanBeWatched||(M=U.call(b,M,{hash:{},inverse:S.noop,fn:S.program(36,z,e),data:e})),(M||0===M)&&(P+=M),P+="\n\n					\n					",O={hash:{},inverse:S.noop,fn:S.program(41,C,e),data:e},(N=c.ifPostCanBeReply)?M=N.call(b,O):(N=b&&b.ifPostCanBeReply,M=typeof N===T?N.call(b,O):N),c.ifPostCanBeReply||(M=U.call(b,M,{hash:{},inverse:S.noop,fn:S.program(41,C,e),data:e})),(M||0===M)&&(P+=M),P+="\n\n					\n					",O={hash:{},inverse:S.noop,fn:S.program(43,D,e),data:e},(N=c.ifPostCanBeReshared)?M=N.call(b,O):(N=b&&b.ifPostCanBeReshared,M=typeof N===T?N.call(b,O):N),c.ifPostCanBeReshared||(M=U.call(b,M,{hash:{},inverse:S.noop,fn:S.program(43,D,e),data:e})),(M||0===M)&&(P+=M),P+="\n\n					\n					",O={hash:{},inverse:S.noop,fn:S.program(45,E,e),data:e},(N=c.ifPostCanBeReshared)?M=N.call(b,O):(N=b&&b.ifPostCanBeReshared,M=typeof N===T?N.call(b,O):N),c.ifPostCanBeReshared||(M=U.call(b,M,{hash:{},inverse:S.noop,fn:S.program(45,E,e),data:e})),(M||0===M)&&(P+=M),P+='\n\n					\n					<li class="post-reaction post-reaction-ef"></li>\n\n					<li class="post-reaction post-options">\n						<a class="dropdown-toggle" title="'+R((N=c.translate||b&&b.translate,O={hash:{},data:e},N?N.call(b,"post|options",O):Q.call(b,"translate","post|options",O)))+'" data-toggle="dropdown" type="button" href="#" onclick="return false;">\n							<span class="icon-wb_more font-color-grey"></span>\n						</a>\n						<ul class="dropdown-menu text-left" role="menu">\n							<li>\n								<a href="',(N=c.permalink)?M=N.call(b,{hash:{},data:e}):(N=b&&b.permalink,M=typeof N===T?N.call(b,{hash:{},data:e}):N),P+=R(M)+'" title="'+R((N=c.translate||b&&b.translate,O={hash:{},data:e},N?N.call(b,"post|view_details",O):Q.call(b,"translate","post|view_details",O)))+'">'+R((N=c.translate||b&&b.translate,O={hash:{},data:e},N?N.call(b,"post|view_details",O):Q.call(b,"translate","post|view_details",O)))+"</a>\n							</li>\n							",O={hash:{},inverse:S.program(53,J,e),fn:S.program(47,F,e),data:e},(N=c.ifPostCanBeDeleted)?M=N.call(b,O):(N=b&&b.ifPostCanBeDeleted,M=typeof N===T?N.call(b,O):N),c.ifPostCanBeDeleted||(M=U.call(b,M,{hash:{},inverse:S.program(53,J,e),fn:S.program(47,F,e),data:e})),(M||0===M)&&(P+=M),P+='\n						</ul>\n					</li>\n				</ul>\n			</div>\n		</div>\n	</div>\n\n	\n	<div class="row post-responses-row">\n		<div class="col-xs-12">\n			<div class="post-responses tab-content">\n				<div class="post-replies-pane tab-pane">\n					<div class="responses"><div class="responses-empty">'+R((N=c.translate||b&&b.translate,O={hash:{},data:e},N?N.call(b,"post|empty_replies",O):Q.call(b,"translate","post|empty_replies",O)))+"</div></div>\n					",O={hash:{},inverse:S.program(57,L,e),fn:S.program(55,K,e),data:e},(N=c.ifLoggedIn)?M=N.call(b,O):(N=b&&b.ifLoggedIn,M=typeof N===T?N.call(b,O):N),c.ifLoggedIn||(M=U.call(b,M,{hash:{},inverse:S.program(57,L,e),fn:S.program(55,K,e),data:e})),(M||0===M)&&(P+=M),P+="\n				</div>\n			</div>\n		</div>\n	</div>\n</div>"})}),define("hbs!modules/template/homefeed/post-content-view",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f,i="";return i+='\n        <div class="row">\n            <div class="col-xs-12">\n                <div class="post-text">\n                    ',e=c.compare||a&&a.compare,f={hash:{},inverse:ja.noop,fn:ja.program(2,g,b),data:b},d=e?e.call(a,a&&a.originality_text,"reply",f):ha.call(a,"compare",a&&a.originality_text,"reply",f),(d||0===d)&&(i+=d),i+="\n                    ",d=c.unless.call(a,a&&a.body,{hash:{},inverse:ja.noop,fn:ja.program(4,h,b),data:b}),(d||0===d)&&(i+=d),i+="\n                    ",(e=c.body)?d=e.call(a,{hash:{},data:b}):(e=a&&a.body,d=typeof e===ka?e.call(a,{hash:{},data:b}):e),(d||0===d)&&(i+=d),i+='\n                </div>\n            </div>\n        </div>\n        <div class="row">\n            <div class="col-xs-12">\n                <div class="post-image">\n                    \n                    ',e=c.compare||a&&a.compare,f={hash:{},inverse:ja.program(10,l,b),fn:ja.program(7,j,b),data:b},d=e?e.call(a,(d=a&&a.media,d=null==d||d===!1?d:d.photo,null==d||d===!1?d:d.type),"link",f):ha.call(a,"compare",(d=a&&a.media,d=null==d||d===!1?d:d.photo,null==d||d===!1?d:d.type),"link",f),(d||0===d)&&(i+=d),i+="\n                </div>\n            </div>\n        </div>\n    "}function g(a,b){var d,e,f="";return f+='\n                        <span class="post-originality-text">'+ia((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"post|reply",e):ha.call(a,"translate","post|reply",e)))+"</span>\n                    "}function h(a,b){var d,e,f,g="";return g+="\n                    ",e=c.compare||a&&a.compare,f={hash:{},inverse:ja.noop,fn:ja.program(5,i,b),data:b},d=e?e.call(a,a&&a.originality_text,"reshare",f):ha.call(a,"compare",a&&a.originality_text,"reshare",f),(d||0===d)&&(g+=d),g+="\n                    "}function i(a,b){var d,e,f="";return f+='\n                        <span class="post-originality-text">'+ia((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"post|share",e):ha.call(a,"translate","post|share",e)))+"</span>\n                    "}function j(a,b){var d,e,f,g="";return g+="\n                        ",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:ja.noop,fn:ja.program(8,k,b),data:b},d=e?e.call(a,(d=a&&a.media,d=null==d||d===!1?d:d.photo,d=null==d||d===!1?d:d.url,null==d||d===!1?d:d.original),f):ha.call(a,"isNotEmpty",(d=a&&a.media,d=null==d||d===!1?d:d.photo,d=null==d||d===!1?d:d.url,null==d||d===!1?d:d.original),f),(d||0===d)&&(g+=d),g+="\n                    \n                    "}function k(a,b){var c,d="";return d+='\n                            <img src="'+ia((c=a&&a.media,c=null==c||c===!1?c:c.photo,c=null==c||c===!1?c:c.url,c=null==c||c===!1?c:c.original,typeof c===ka?c.apply(a):c))+'" class="post-image-img"/>\n                        '}function l(a,b){var d,e,f,g="";return g+='\n                        <a href="'+ia((d=a&&a.media,d=null==d||d===!1?d:d.photo,d=null==d||d===!1?d:d.url,d=null==d||d===!1?d:d.original,typeof d===ka?d.apply(a):d))+'" class="fancybox" rel="homefeed" title="'+ia((d=a&&a.author,d=null==d||d===!1?d:d.username,typeof d===ka?d.apply(a):d))+": "+ia((e=c.characterLimiter||a&&a.characterLimiter,f={hash:{},data:b},e?e.call(a,a&&a.body,100,!0,f):ha.call(a,"characterLimiter",a&&a.body,100,!0,f)))+'">\n                            <img src="',(e=c.fn_post_get_big_image)?d=e.call(a,{hash:{},data:b}):(e=a&&a.fn_post_get_big_image,d=typeof e===ka?e.call(a,{hash:{},data:b}):e),g+=ia(d)+'" class="post-image-img" />\n                        </a>\n                    '}function m(a,b){var d,e,f,h="";return h+='\n        <div class="row">\n            <div class="col-xs-12">\n                <div class="post-text">\n                    ',e=c.compare||a&&a.compare,f={hash:{},inverse:ja.noop,fn:ja.program(2,g,b),data:b},d=e?e.call(a,a&&a.originality_text,"reply",f):ha.call(a,"compare",a&&a.originality_text,"reply",f),(d||0===d)&&(h+=d),h+="\n                    ",d=c.unless.call(a,a&&a.body,{hash:{},inverse:ja.noop,fn:ja.program(13,n,b),data:b}),(d||0===d)&&(h+=d),h+="\n                    ",(e=c.body)?d=e.call(a,{hash:{},data:b}):(e=a&&a.body,d=typeof e===ka?e.call(a,{hash:{},data:b}):e),(d||0===d)&&(h+=d),h+='\n                </div>\n            </div>\n        </div>\n        <div class="row">\n            <div class="col-xs-12">\n                <div class="post-video">\n                    ',e=c.compare||a&&a.compare,f={hash:{},inverse:ja.noop,fn:ja.program(16,p,b),data:b},d=e?e.call(a,(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"youtube",f):ha.call(a,"compare",(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"youtube",f),(d||0===d)&&(h+=d),h+="\n                    ",e=c.compare||a&&a.compare,f={hash:{},inverse:ja.noop,fn:ja.program(16,p,b),data:b},d=e?e.call(a,(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"vimeo",f):ha.call(a,"compare",(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"vimeo",f),(d||0===d)&&(h+=d),h+="\n                    ",e=c.compare||a&&a.compare,f={hash:{},inverse:ja.noop,fn:ja.program(18,q,b),data:b},d=e?e.call(a,(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"flickr",f):ha.call(a,"compare",(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"flickr",f),(d||0===d)&&(h+=d),h+="\n                    ",e=c.compare||a&&a.compare,f={hash:{},inverse:ja.noop,fn:ja.program(20,r,b),data:b},d=e?e.call(a,(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"soundcloud",f):ha.call(a,"compare",(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"soundcloud",f),(d||0===d)&&(h+=d),h+="\n                </div>\n            </div>\n        </div>\n    "}function n(a,b){var d,e,f,g="";return g+="\n                        ",e=c.compare||a&&a.compare,f={hash:{},inverse:ja.noop,fn:ja.program(14,o,b),data:b},d=e?e.call(a,a&&a.originality_text,"reshare",f):ha.call(a,"compare",a&&a.originality_text,"reshare",f),(d||0===d)&&(g+=d),g+="\n                    "}function o(a,b){var d,e,f="";return f+='\n                            <span class="post-originality-text">'+ia((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"post|share",e):ha.call(a,"translate","post|share",e)))+"</span>\n                        "}function p(a,b){var c,d="";return d+='\n                        <object class="post-video-object" type="application/x-shockwave-flash" data="'+ia((c=a&&a.media,c=null==c||c===!1?c:c.video,c=null==c||c===!1?c:c.url,typeof c===ka?c.apply(a):c))+'">\n                            <param name="wmode" value="transparent" />\n                            <param name="allowfullscreen" value="true" />\n                            <param name="movie" value="'+ia((c=a&&a.media,c=null==c||c===!1?c:c.video,c=null==c||c===!1?c:c.url,typeof c===ka?c.apply(a):c))+'" />\n                        </object>\n                    '}function q(a,b){var d,e,f,g="";return g+='\n                        <object class="post-video-object" type="application/x-shockwave-flash"\n                                data="http://www.flickr.com/apps/slideshow/show.swf?v=71649">\n                            <param name="wmode" value="transparent" />\n                            <param name="allowFullScreen" value="true" />\n                            <param name="movie" value="http://www.flickr.com/apps/slideshow/show.swf?v=71649" />\n                            <param name="flashvars" value="offsite=true&amp;lang=en-us&amp;page_show_url='+ia((e=c.fn_get_flickr_relative_url||a&&a.fn_get_flickr_relative_url,f={hash:{},data:b},e?e.call(a,(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.url),f):ha.call(a,"fn_get_flickr_relative_url",(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.url),f)))+"/show/&amp;page_show_back_url="+ia((e=c.fn_get_flickr_relative_url||a&&a.fn_get_flickr_relative_url,f={hash:{},data:b},e?e.call(a,(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.url),f):ha.call(a,"fn_get_flickr_relative_url",(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.url),f)))+"/&amp;set_id="+ia((d=a&&a.media,d=null==d||d===!1?d:d.video,d=null==d||d===!1?d:d.id,typeof d===ka?d.apply(a):d))+'" />\n                        </object>\n                    '}function r(a,b){var c,d="";return d+='\n                        <iframe width="100%" height="450" scrolling="no" frameborder="no" src="'+ia((c=a&&a.media,c=null==c||c===!1?c:c.video,c=null==c||c===!1?c:c.url,typeof c===ka?c.apply(a):c))+'"></iframe>\n                    '}function s(a,b){var d,e,f,h="";return h+='\n        <div class="row">\n            <div class="col-xs-12">\n                <div class="post-text">\n                    ',e=c.compare||a&&a.compare,f={hash:{},inverse:ja.noop,fn:ja.program(2,g,b),data:b},d=e?e.call(a,a&&a.originality_text,"reply",f):ha.call(a,"compare",a&&a.originality_text,"reply",f),(d||0===d)&&(h+=d),h+="\n                    ",d=c.unless.call(a,a&&a.body,{hash:{},inverse:ja.noop,fn:ja.program(13,n,b),data:b}),(d||0===d)&&(h+=d),h+="\n                    ",(e=c.body)?d=e.call(a,{hash:{},data:b}):(e=a&&a.body,d=typeof e===ka?e.call(a,{hash:{},data:b}):e),(d||0===d)&&(h+=d),h+='\n                </div>\n            </div>\n        </div>\n        <div class="row">\n            <div class="col-xs-12">\n                ',e=c.withFirst||a&&a.withFirst,f={hash:{},inverse:ja.noop,fn:ja.program(23,t,b),data:b},d=e?e.call(a,(d=a&&a.media,null==d||d===!1?d:d.links),f):ha.call(a,"withFirst",(d=a&&a.media,null==d||d===!1?d:d.links),f),(d||0===d)&&(h+=d),h+="\n            </div>\n        </div>\n    "}function t(a,b){var d,e,f,g="";return g+='\n                    <div class="post-meta">\n                        <div class="row">\n                            ',e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:ja.program(26,v,b),fn:ja.program(24,u,b),data:b},d=e?e.call(a,a&&a.image,f):ha.call(a,"isNotEmpty",a&&a.image,f),(d||0===d)&&(g+=d),g+='\n                                <div class="post-meta-content">\n                                    ',e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:ja.program(30,x,b),fn:ja.program(28,w,b),data:b},d=e?e.call(a,a&&a.title,f):ha.call(a,"isNotEmpty",a&&a.title,f),(d||0===d)&&(g+=d),g+="\n                                    ",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:ja.noop,fn:ja.program(32,y,b),data:b},d=e?e.call(a,a&&a.url,f):ha.call(a,"isNotEmpty",a&&a.url,f),(d||0===d)&&(g+=d),g+="\n                                    ",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:ja.noop,fn:ja.program(34,z,b),data:b},d=e?e.call(a,a&&a.description,f):ha.call(a,"isNotEmpty",a&&a.description,f),(d||0===d)&&(g+=d),g+="\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                "}function u(a,b){var d,e,f="";return f+='\n                                <div class="col-xs-3 col-sm-3 col-md-3 no-padding-right">\n                                    <div class="post-meta-thumbnail"><img src="',(e=c.image)?d=e.call(a,{hash:{},data:b}):(e=a&&a.image,d=typeof e===ka?e.call(a,{hash:{},data:b}):e),f+=ia(d)+'" /></div>\n                                </div>\n                                <div class="col-xs-9 col-sm-9 col-md-9 no-padding-left">\n                            '}function v(a,b){return'\n                                <div class="col-xs-12">\n                            '}function w(a,b){var d,e,f="";return f+='\n                                        <div class="post-meta-title"><a href="',(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===ka?e.call(a,{hash:{},data:b}):e),f+=ia(d)+'" target="mig33-new-window">',(e=c.title)?d=e.call(a,{hash:{},data:b}):(e=a&&a.title,d=typeof e===ka?e.call(a,{hash:{},data:b}):e),(d||0===d)&&(f+=d),f+="</a></div>\n                                    "}function x(a,b){var d,e,f="";return f+='\n                                        <div class="post-meta-title"><a href="',(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===ka?e.call(a,{hash:{},data:b}):e),f+=ia(d)+'" target="mig33-new-window">',(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===ka?e.call(a,{hash:{},data:b}):e),f+=ia(d)+"</a></div>\n                                    "}function y(a,b){var d,e,f="";return f+='\n                                        <div class="post-meta-url font-size-12"><a href="',(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===ka?e.call(a,{hash:{},data:b}):e),f+=ia(d)+'" target="mig33-new-window">',(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===ka?e.call(a,{hash:{},data:b}):e),f+=ia(d)+"</a></div>\n                                    "}function z(a,b){var d,e,f="";return f+='\n                                        <div class="post-meta-description">'+ia((d=c.characterLimiter||a&&a.characterLimiter,e={hash:{},data:b},d?d.call(a,a&&a.description,100,e):ha.call(a,"characterLimiter",a&&a.description,100,e)))+"</div>\n                                    "}function A(a,b){var d,e,f,g="";return g+='\n        <div class="row">\n            ',e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:ja.noop,fn:ja.program(37,B,b),data:b},d=e?e.call(a,(d=a&&a.event,null==d||d===!1?d:d.title),f):ha.call(a,"isNotEmpty",(d=a&&a.event,null==d||d===!1?d:d.title),f),(d||0===d)&&(g+=d),g+="\n        </div>\n    "}function B(a,b){var d,e,f,g="";return g+='\n                <div class="col-xs-12">\n                    <table cellpadding="0" cellspacing="0" width="100%">\n                        <tr>\n                            <td valign="top">\n                                ',e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:ja.noop,fn:ja.program(38,C,b),data:b},d=e?e.call(a,(d=a&&a.event,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.icon,null==d||d===!1?d:d.size_999),f):ha.call(a,"isNotEmpty",(d=a&&a.event,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.icon,null==d||d===!1?d:d.size_999),f),(d||0===d)&&(g+=d),g+='\n                            </td>\n                            <td class="game-post-text" valign="top">\n                                ',e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:ja.noop,fn:ja.program(40,D,b),data:b},d=e?e.call(a,(d=a&&a.event,d=null==d||d===!1?d:d.application,null==d||d===!1?d:d.title),f):ha.call(a,"isNotEmpty",(d=a&&a.event,d=null==d||d===!1?d:d.application,null==d||d===!1?d:d.title),f),(d||0===d)&&(g+=d),g+="\n                                ",d=a&&a.event,d=null==d||d===!1?d:d.title,d=typeof d===ka?d.apply(a):d,(d||0===d)&&(g+=d),g+='\n                                <br/><a href="'+ia((d=a&&a.event,d=null==d||d===!1?d:d.custom_url,d=null==d||d===!1?d:d.ajax,typeof d===ka?d.apply(a):d))+'">',d=a&&a.event,d=null==d||d===!1?d:d.template,d=null==d||d===!1?d:d.action_button_title,d=typeof d===ka?d.apply(a):d,(d||0===d)&&(g+=d),g+="</a><br/>\n                                ",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:ja.noop,fn:ja.program(42,E,b),data:b},d=e?e.call(a,(d=a&&a.event,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.image,null==d||d===!1?d:d.size_120),f):ha.call(a,"isNotEmpty",(d=a&&a.event,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.image,null==d||d===!1?d:d.size_120),f),(d||0===d)&&(g+=d),g+="\n                            </td>\n                        </tr>\n                    </table>\n                </div>\n            "}function C(a,b){var c,d="";return d+='\n                                    <div class="game-icon">\n                                        <img src="'+ia((c=a&&a.event,c=null==c||c===!1?c:c.media,c=null==c||c===!1?c:c.icon,c=null==c||c===!1?c:c.size_999,typeof c===ka?c.apply(a):c))+'?w=64&h=64"/>\n                                    </div>\n                                '}function D(a,b){var c,d="";return d+='\n                                    <strong><a href="'+ia((c=a&&a.event,c=null==c||c===!1?c:c.application,c=null==c||c===!1?c:c.view,c=null==c||c===!1?c:c.ajax,typeof c===ka?c.apply(a):c))+'" class="game-title">'+ia((c=a&&a.event,c=null==c||c===!1?c:c.application,c=null==c||c===!1?c:c.title,typeof c===ka?c.apply(a):c))+"</a></strong><br/>\n                                "}function E(a,b){var c,d="";return d+='\n                                    <div class="post-meta-thumbnail">\n                                        <a href="'+ia((c=a&&a.event,c=null==c||c===!1?c:c.custom_url,c=null==c||c===!1?c:c.ajax,typeof c===ka?c.apply(a):c))+'"><img src="'+ia((c=a&&a.event,c=null==c||c===!1?c:c.media,c=null==c||c===!1?c:c.image,c=null==c||c===!1?c:c.size_120,typeof c===ka?c.apply(a):c))+'" /></a>\n                                    </div>\n                                '}function F(a,b){var d,e,f,h="";return h+='\n        <div class="row">\n            <div class="col-xs-12">\n                <div class="post-text">\n                    ',e=c.compare||a&&a.compare,f={hash:{},inverse:ja.noop,fn:ja.program(2,g,b),data:b},d=e?e.call(a,a&&a.originality_text,"reply",f):ha.call(a,"compare",a&&a.originality_text,"reply",f),(d||0===d)&&(h+=d),h+="\n                    ",d=c.unless.call(a,a&&a.body,{hash:{},inverse:ja.noop,fn:ja.program(13,n,b),data:b}),(d||0===d)&&(h+=d),h+="\n                    ",(e=c.body)?d=e.call(a,{hash:{},data:b}):(e=a&&a.body,d=typeof e===ka?e.call(a,{hash:{},data:b}):e),(d||0===d)&&(h+=d),h+="\n                </div>\n            </div>\n        </div>\n    "}function G(a,b){var d,e="";return e+="\n        ",d=c["if"].call(a,(d=a&&a.root_post,d=null==d||d===!1?d:d.author,null==d||d===!1?d:d.username),{hash:{},inverse:ja.noop,fn:ja.program(47,H,b),
data:b}),(d||0===d)&&(e+=d),e+="\n    "}function H(a,b){var d,e,f,g="";return g+='\n            <div class="row">\n                <div class="col-xs-12">\n                    <div class="post-parent">\n                        \n                        <div class="post-author-avatar left">\n                            <a href="'+ia((d=a&&a.author,d=null==d||d===!1?d:d.personalized_url,typeof d===ka?d.apply(a):d))+'" title="'+ia((d=a&&a.author,d=null==d||d===!1?d:d.username,typeof d===ka?d.apply(a):d))+'" class="profile-hovercard" data-username="'+ia((d=a&&a.author,d=null==d||d===!1?d:d.username,typeof d===ka?d.apply(a):d))+'">\n                                <img src="'+ia((e=c.getDisplayPictureUrl||a&&a.getDisplayPictureUrl,f={hash:{},data:b},e?e.call(a,(d=a&&a.author,null==d||d===!1?d:d.username),(d=a&&a.author,null==d||d===!1?d:d.display_picture_type),40,40,f):ha.call(a,"getDisplayPictureUrl",(d=a&&a.author,null==d||d===!1?d:d.username),(d=a&&a.author,null==d||d===!1?d:d.display_picture_type),40,40,f)))+'" width="40" height="40" class="img-circle" />\n                                ',e=c.compare||a&&a.compare,f={hash:{},inverse:ja.noop,fn:ja.program(48,I,b),data:b},d=e?e.call(a,a&&a.originality_text,"reshare",f):ha.call(a,"compare",a&&a.originality_text,"reshare",f),(d||0===d)&&(g+=d),g+='\n                            </a>\n                        </div>\n                        <div class="post-author">\n                            <a href="'+ia((d=a&&a.root_post,d=null==d||d===!1?d:d.author,d=null==d||d===!1?d:d.personalized_url,typeof d===ka?d.apply(a):d))+'" title="'+ia((d=a&&a.root_post,d=null==d||d===!1?d:d.author,d=null==d||d===!1?d:d.username,typeof d===ka?d.apply(a):d))+'" class="profile-hovercard" data-username="'+ia((d=a&&a.root_post,d=null==d||d===!1?d:d.author,d=null==d||d===!1?d:d.username,typeof d===ka?d.apply(a):d))+'">'+ia((d=a&&a.root_post,d=null==d||d===!1?d:d.author,d=null==d||d===!1?d:d.username,typeof d===ka?d.apply(a):d))+"</a> "+ia((e=c.userGetLabels||a&&a.userGetLabels,f={hash:{},data:b},e?e.call(a,(d=a&&a.root_post,null==d||d===!1?d:d.author),"16",f):ha.call(a,"userGetLabels",(d=a&&a.root_post,null==d||d===!1?d:d.author),"16",f)))+'\n                        </div>\n                        <div class="post-time font-size-12">\n                            <a href="'+ia((d=a&&a.root_post,d=null==d||d===!1?d:d.permalink,typeof d===ka?d.apply(a):d))+'"><time class="timeago" datetime="'+ia((e=c.dateFormat||a&&a.dateFormat,f={hash:{},data:b},e?e.call(a,(d=a&&a.root_post,null==d||d===!1?d:d.timestamp),"isoUtcDateTime",f):ha.call(a,"dateFormat",(d=a&&a.root_post,null==d||d===!1?d:d.timestamp),"isoUtcDateTime",f)))+'">'+ia((e=c.getRelativeTimestamp||a&&a.getRelativeTimestamp,f={hash:{},data:b},e?e.call(a,(d=a&&a.root_post,null==d||d===!1?d:d.timestamp),f):ha.call(a,"getRelativeTimestamp",(d=a&&a.root_post,null==d||d===!1?d:d.timestamp),f)))+"</time> "+ia((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"post|via",f):ha.call(a,"translate","post|via",f)))+" "+ia((d=a&&a.root_post,d=null==d||d===!1?d:d.application_text,typeof d===ka?d.apply(a):d))+"</a>\n                        </div>\n\n                        \n                        ",e=c.compare||a&&a.compare,f={hash:{},inverse:ja.noop,fn:ja.program(50,J,b),data:b},d=e?e.call(a,(d=a&&a.root_post,null==d||d===!1?d:d.type_text),"photo",f):ha.call(a,"compare",(d=a&&a.root_post,null==d||d===!1?d:d.type_text),"photo",f),(d||0===d)&&(g+=d),g+="\n\n                        \n                        ",e=c.compare||a&&a.compare,f={hash:{},inverse:ja.noop,fn:ja.program(58,O,b),data:b},d=e?e.call(a,(d=a&&a.root_post,null==d||d===!1?d:d.type_text),"video",f):ha.call(a,"compare",(d=a&&a.root_post,null==d||d===!1?d:d.type_text),"video",f),(d||0===d)&&(g+=d),g+="\n\n                        \n                        ",e=c.compare||a&&a.compare,f={hash:{},inverse:ja.noop,fn:ja.program(63,R,b),data:b},d=e?e.call(a,(d=a&&a.root_post,null==d||d===!1?d:d.type_text),"link",f):ha.call(a,"compare",(d=a&&a.root_post,null==d||d===!1?d:d.type_text),"link",f),(d||0===d)&&(g+=d),g+="\n\n                        \n                        ",e=c.compare||a&&a.compare,f={hash:{},inverse:ja.noop,fn:ja.program(77,Z,b),data:b},d=e?e.call(a,(d=a&&a.root_post,null==d||d===!1?d:d.type_text),"event",f):ha.call(a,"compare",(d=a&&a.root_post,null==d||d===!1?d:d.type_text),"event",f),(d||0===d)&&(g+=d),g+="\n\n                        \n                        ",e=c.compare||a&&a.compare,f={hash:{},inverse:ja.noop,fn:ja.program(85,ca,b),data:b},d=e?e.call(a,(d=a&&a.root_post,null==d||d===!1?d:d.type_text),"text",f):ha.call(a,"compare",(d=a&&a.root_post,null==d||d===!1?d:d.type_text),"text",f),(d||0===d)&&(g+=d),g+="\n                    </div>\n                </div>\n            </div>\n        "}function I(a,b){return'\n                                    <span class="icon-wb_repost icon--circle icon--bottom-rights"></span>\n                                '}function J(a,b){var d,e,f,g="";return g+="\n                            ",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:ja.noop,fn:ja.program(51,K,b),data:b},d=e?e.call(a,(d=a&&a.root_post,null==d||d===!1?d:d.body),f):ha.call(a,"isNotEmpty",(d=a&&a.root_post,null==d||d===!1?d:d.body),f),(d||0===d)&&(g+=d),g+='\n                            <div class="post-image">\n                                \n                                ',e=c.compare||a&&a.compare,f={hash:{},inverse:ja.program(56,N,b),fn:ja.program(53,L,b),data:b},d=e?e.call(a,(d=a&&a.root_post,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.photo,null==d||d===!1?d:d.type),"link",f):ha.call(a,"compare",(d=a&&a.root_post,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.photo,null==d||d===!1?d:d.type),"link",f),(d||0===d)&&(g+=d),g+="\n                            </div>\n                        "}function K(a,b){var c,d="";return d+='\n                                <div class="post-text">',c=a&&a.root_post,c=null==c||c===!1?c:c.body,c=typeof c===ka?c.apply(a):c,(c||0===c)&&(d+=c),d+="</div>\n                            "}function L(a,b){var d,e,f,g="";return g+="\n                                    ",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:ja.noop,fn:ja.program(54,M,b),data:b},d=e?e.call(a,(d=a&&a.root_post,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.photo,d=null==d||d===!1?d:d.url,null==d||d===!1?d:d.original),f):ha.call(a,"isNotEmpty",(d=a&&a.root_post,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.photo,d=null==d||d===!1?d:d.url,null==d||d===!1?d:d.original),f),(d||0===d)&&(g+=d),g+="\n                                \n                                "}function M(a,b){var c,d="";return d+='\n                                        <img src="'+ia((c=a&&a.root_post,c=null==c||c===!1?c:c.media,c=null==c||c===!1?c:c.photo,c=null==c||c===!1?c:c.url,c=null==c||c===!1?c:c.original,typeof c===ka?c.apply(a):c))+'" class="post-image-img"/>\n                                    '}function N(a,b){var d,e,f,g="";return g+='\n                                    <a href="'+ia((d=a&&a.root_post,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.photo,d=null==d||d===!1?d:d.url,d=null==d||d===!1?d:d.original,typeof d===ka?d.apply(a):d))+'" class="fancybox" rel="homefeed" title="'+ia((d=a&&a.root_post,d=null==d||d===!1?d:d.author,d=null==d||d===!1?d:d.username,typeof d===ka?d.apply(a):d))+": "+ia((e=c.characterLimiter||a&&a.characterLimiter,f={hash:{},data:b},e?e.call(a,(d=a&&a.root_post,null==d||d===!1?d:d.body),100,!0,f):ha.call(a,"characterLimiter",(d=a&&a.root_post,null==d||d===!1?d:d.body),100,!0,f)))+'">\n                                        <img src="'+ia((e=c.fn_post_get_big_image||a&&a.fn_post_get_big_image,f={hash:{},data:b},e?e.call(a,a&&a.root_post,f):ha.call(a,"fn_post_get_big_image",a&&a.root_post,f)))+'" class="post-image-img" />\n                                    </a>\n                                '}function O(a,b){var d,e,f,g="";return g+="\n                            ",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:ja.noop,fn:ja.program(51,K,b),data:b},d=e?e.call(a,(d=a&&a.root_post,null==d||d===!1?d:d.body),f):ha.call(a,"isNotEmpty",(d=a&&a.root_post,null==d||d===!1?d:d.body),f),(d||0===d)&&(g+=d),g+='\n                            <div class="post-video">\n                                ',e=c.compare||a&&a.compare,f={hash:{},inverse:ja.noop,fn:ja.program(59,P,b),data:b},d=e?e.call(a,(d=a&&a.root_post,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"youtube",f):ha.call(a,"compare",(d=a&&a.root_post,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"youtube",f),(d||0===d)&&(g+=d),g+="\n                                ",e=c.compare||a&&a.compare,f={hash:{},inverse:ja.noop,fn:ja.program(59,P,b),data:b},d=e?e.call(a,(d=a&&a.root_post,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"vimeo",f):ha.call(a,"compare",(d=a&&a.root_post,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"vimeo",f),(d||0===d)&&(g+=d),g+="\n                                ",e=c.compare||a&&a.compare,f={hash:{},inverse:ja.noop,fn:ja.program(61,Q,b),data:b},d=e?e.call(a,(d=a&&a.root_post,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"flickr",f):ha.call(a,"compare",(d=a&&a.root_post,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"flickr",f),(d||0===d)&&(g+=d),g+="\n                            </div>\n                        "}function P(a,b){var c,d="";return d+='\n                                    <object class="post-video-object" type="application/x-shockwave-flash" data="'+ia((c=a&&a.root_post,c=null==c||c===!1?c:c.media,c=null==c||c===!1?c:c.video,c=null==c||c===!1?c:c.url,typeof c===ka?c.apply(a):c))+'">\n                                        <param name="wmode" value="transparent" />\n                                        <param name="allowfullscreen" value="true"/>\n                                        <param name="movie" value="'+ia((c=a&&a.root_post,c=null==c||c===!1?c:c.media,c=null==c||c===!1?c:c.video,c=null==c||c===!1?c:c.url,typeof c===ka?c.apply(a):c))+'"/>\n                                    </object>\n                                '}function Q(a,b){var d,e,f,g="";return g+='\n                                    <object class="post-video-object" type="application/x-shockwave-flash" data="http://www.flickr.com/apps/slideshow/show.swf?v=71649">\n                                        <param name="wmode" value="transparent" />\n                                        <param name="allowFullScreen" value="true"/>\n                                        <param name="movie" value="http://www.flickr.com/apps/slideshow/show.swf?v=71649"/>\n                                        <param name="flashvars" value="offsite=true&amp;lang=en-us&amp;page_show_url='+ia((e=c.fn_get_flickr_relative_url||a&&a.fn_get_flickr_relative_url,f={hash:{},data:b},e?e.call(a,(d=a&&a.root_post,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.url),f):ha.call(a,"fn_get_flickr_relative_url",(d=a&&a.root_post,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.url),f)))+"/show/&amp;page_show_back_url="+ia((e=c.fn_get_flickr_relative_url||a&&a.fn_get_flickr_relative_url,f={hash:{},data:b},e?e.call(a,(d=a&&a.root_post,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.url),f):ha.call(a,"fn_get_flickr_relative_url",(d=a&&a.root_post,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.url),f)))+"/&amp;set_id="+ia((d=a&&a.root_post,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.video,d=null==d||d===!1?d:d.id,typeof d===ka?d.apply(a):d))+'"/>\n                                    </object>\n                                '}function R(a,b){var d,e,f,g="";return g+="\n                            ",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:ja.noop,fn:ja.program(51,K,b),data:b},d=e?e.call(a,(d=a&&a.root_post,null==d||d===!1?d:d.body),f):ha.call(a,"isNotEmpty",(d=a&&a.root_post,null==d||d===!1?d:d.body),f),(d||0===d)&&(g+=d),g+='\n                            <div class="post-link">\n                                <div class="row">\n                                    ',e=c.withFirst||a&&a.withFirst,f={hash:{},inverse:ja.noop,fn:ja.program(64,S,b),data:b},d=e?e.call(a,(d=a&&a.root_post,d=null==d||d===!1?d:d.media,null==d||d===!1?d:d.links),f):ha.call(a,"withFirst",(d=a&&a.root_post,d=null==d||d===!1?d:d.media,null==d||d===!1?d:d.links),f),(d||0===d)&&(g+=d),g+="\n                                </div>\n                            </div>\n                        "}function S(a,b){var d,e,f,g="";return g+="\n                                        ",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:ja.program(67,U,b),fn:ja.program(65,T,b),data:b},d=e?e.call(a,a&&a.image,f):ha.call(a,"isNotEmpty",a&&a.image,f),(d||0===d)&&(g+=d),g+="\n                                            ",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:ja.program(71,W,b),fn:ja.program(69,V,b),data:b},d=e?e.call(a,a&&a.title,f):ha.call(a,"isNotEmpty",a&&a.title,f),(d||0===d)&&(g+=d),g+="\n                                            ",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:ja.noop,fn:ja.program(73,X,b),data:b},d=e?e.call(a,a&&a.url,f):ha.call(a,"isNotEmpty",a&&a.url,f),(d||0===d)&&(g+=d),g+="\n                                            ",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:ja.noop,fn:ja.program(75,Y,b),data:b},d=e?e.call(a,a&&a.description,f):ha.call(a,"isNotEmpty",a&&a.description,f),(d||0===d)&&(g+=d),g+="\n                                        </div>\n                                    "}function T(a,b){var d,e,f="";return f+='\n                                            <div class="col-xs-2 no-padding-right">\n                                                <div class="post-meta-thumbnail">\n                                                    <img src="',(e=c.image)?d=e.call(a,{hash:{},data:b}):(e=a&&a.image,d=typeof e===ka?e.call(a,{hash:{},data:b}):e),f+=ia(d)+'" />\n                                                </div>\n                                            </div>\n                                            <div class="col-xs-10 no-padding-left">\n                                        '}function U(a,b){return'\n                                            <div class="col-xs-12">\n                                        '}function V(a,b){var d,e,f="";return f+='\n                                                <div class="post-meta-title"><a href="',(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===ka?e.call(a,{hash:{},data:b}):e),f+=ia(d)+'" target="mig33-new-window">',(e=c.title)?d=e.call(a,{hash:{},data:b}):(e=a&&a.title,d=typeof e===ka?e.call(a,{hash:{},data:b}):e),(d||0===d)&&(f+=d),f+="</a></div>\n                                            "}function W(a,b){var d,e,f="";return f+='\n                                                <div class="post-meta-title"><a href="',(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===ka?e.call(a,{hash:{},data:b}):e),f+=ia(d)+'" target="mig33-new-window">',(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===ka?e.call(a,{hash:{},data:b}):e),f+=ia(d)+"</a></div>\n                                            "}function X(a,b){var d,e,f="";return f+='\n                                                <div class="post-meta-url font-size-12"><a href="',(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===ka?e.call(a,{hash:{},data:b}):e),f+=ia(d)+'" target="mig33-new-window">',(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===ka?e.call(a,{hash:{},data:b}):e),f+=ia(d)+"</a></div>\n                                            "}function Y(a,b){var d,e,f="";return f+='\n                                                <div class="post-meta-description">'+ia((d=c.characterLimiter||a&&a.characterLimiter,e={hash:{},data:b},d?d.call(a,a&&a.description,100,e):ha.call(a,"characterLimiter",a&&a.description,100,e)))+"</div>\n                                            "}function Z(a,b){var d,e,f,g="";return g+="\n                            ",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:ja.noop,fn:ja.program(78,$,b),data:b},d=e?e.call(a,(d=a&&a.root_post,d=null==d||d===!1?d:d.event,null==d||d===!1?d:d.title),f):ha.call(a,"isNotEmpty",(d=a&&a.root_post,d=null==d||d===!1?d:d.event,null==d||d===!1?d:d.title),f),(d||0===d)&&(g+=d),g+="\n                        "}function $(a,b){var d,e,f,g="";return g+='\n                                <div class="post-text">\n                                    <table cellpadding="0" cellspacing="0" width="100%">\n                                        <tr>\n                                            <td valign="top">\n                                                ',e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:ja.noop,fn:ja.program(79,_,b),data:b},d=e?e.call(a,(d=a&&a.root_post,d=null==d||d===!1?d:d.event,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.icon,null==d||d===!1?d:d.size_999),f):ha.call(a,"isNotEmpty",(d=a&&a.root_post,d=null==d||d===!1?d:d.event,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.icon,null==d||d===!1?d:d.size_999),f),(d||0===d)&&(g+=d),g+='\n                                            </td>\n                                            <td class="game-post-text" valign="top">\n                                                ',e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:ja.noop,fn:ja.program(81,aa,b),data:b},d=e?e.call(a,(d=a&&a.root_post,d=null==d||d===!1?d:d.event,d=null==d||d===!1?d:d.application,null==d||d===!1?d:d.title),f):ha.call(a,"isNotEmpty",(d=a&&a.root_post,d=null==d||d===!1?d:d.event,d=null==d||d===!1?d:d.application,null==d||d===!1?d:d.title),f),(d||0===d)&&(g+=d),g+="\n                                                ",d=a&&a.root_post,d=null==d||d===!1?d:d.event,d=null==d||d===!1?d:d.title,d=typeof d===ka?d.apply(a):d,(d||0===d)&&(g+=d),g+='\n                                                <br />\n                                                <a href="'+ia((d=a&&a.root_post,d=null==d||d===!1?d:d.event,d=null==d||d===!1?d:d.custom_url,d=null==d||d===!1?d:d.ajax,typeof d===ka?d.apply(a):d))+'">',d=a&&a.root_post,d=null==d||d===!1?d:d.event,d=null==d||d===!1?d:d.template,d=null==d||d===!1?d:d.action_button_title,d=typeof d===ka?d.apply(a):d,(d||0===d)&&(g+=d),g+="</a>\n                                                <br />\n                                                ",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:ja.noop,fn:ja.program(83,ba,b),data:b},d=e?e.call(a,(d=a&&a.root_post,d=null==d||d===!1?d:d.vent,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.image,null==d||d===!1?d:d.size_120),f):ha.call(a,"isNotEmpty",(d=a&&a.root_post,d=null==d||d===!1?d:d.vent,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.image,null==d||d===!1?d:d.size_120),f),(d||0===d)&&(g+=d),g+="\n                                            </td>\n                                        </tr>\n                                    </table>\n                                </div>\n                            "}function _(a,b){var c,d="";return d+='\n                                                    <div class="game-icon">\n                                                        <img src="'+ia((c=a&&a.root_post,c=null==c||c===!1?c:c.event,c=null==c||c===!1?c:c.media,c=null==c||c===!1?c:c.icon,c=null==c||c===!1?c:c.size_999,typeof c===ka?c.apply(a):c))+'?w=64&h=64"/>\n                                                    </div>\n                                                '}function aa(a,b){var c,d="";return d+='\n                                                    <strong><a href="'+ia((c=a&&a.root_post,c=null==c||c===!1?c:c.event,c=null==c||c===!1?c:c.application,c=null==c||c===!1?c:c.view,c=null==c||c===!1?c:c.ajax,typeof c===ka?c.apply(a):c))+'" class="game-title">'+ia((c=a&&a.root_post,c=null==c||c===!1?c:c.event,c=null==c||c===!1?c:c.application,c=null==c||c===!1?c:c.title,typeof c===ka?c.apply(a):c))+"</a></strong><br/>\n                                                "}function ba(a,b){var c,d="";return d+='\n                                                    <div class="post-meta-thumbnail">\n                                                        <a href="'+ia((c=a&&a.root_post,c=null==c||c===!1?c:c.event,c=null==c||c===!1?c:c.custom_url,c=null==c||c===!1?c:c.ajax,typeof c===ka?c.apply(a):c))+'"><img src="'+ia((c=a&&a.root_post,c=null==c||c===!1?c:c.event,c=null==c||c===!1?c:c.media,c=null==c||c===!1?c:c.image,c=null==c||c===!1?c:c.size_120,typeof c===ka?c.apply(a):c))+'" /></a>\n                                                    </div>\n                                                '}function ca(a,b){var d,e,f,g="";return g+="\n                            ",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:ja.noop,fn:ja.program(51,K,b),data:b},d=e?e.call(a,(d=a&&a.root_post,null==d||d===!1?d:d.body),f):ha.call(a,"isNotEmpty",(d=a&&a.root_post,null==d||d===!1?d:d.body),f),(d||0===d)&&(g+=d),g+="\n                        "}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var da,ea,fa,ga="",ha=c.helperMissing,ia=this.escapeExpression,ja=this,ka="function";return ga+="\n    ",ea=c.compare||b&&b.compare,fa={hash:{},inverse:ja.noop,fn:ja.program(1,f,e),data:e},da=ea?ea.call(b,b&&b.type_text,"photo",fa):ha.call(b,"compare",b&&b.type_text,"photo",fa),(da||0===da)&&(ga+=da),ga+="\n\n    \n    ",ea=c.compare||b&&b.compare,fa={hash:{},inverse:ja.noop,fn:ja.program(12,m,e),data:e},da=ea?ea.call(b,b&&b.type_text,"video",fa):ha.call(b,"compare",b&&b.type_text,"video",fa),(da||0===da)&&(ga+=da),ga+="\n\n    \n    ",ea=c.compare||b&&b.compare,fa={hash:{},inverse:ja.noop,fn:ja.program(22,s,e),data:e},da=ea?ea.call(b,b&&b.type_text,"link",fa):ha.call(b,"compare",b&&b.type_text,"link",fa),(da||0===da)&&(ga+=da),ga+="\n\n    \n    ",ea=c.compare||b&&b.compare,fa={hash:{},inverse:ja.noop,fn:ja.program(36,A,e),data:e},da=ea?ea.call(b,b&&b.type_text,"event",fa):ha.call(b,"compare",b&&b.type_text,"event",fa),(da||0===da)&&(ga+=da),ga+="\n\n    \n    ",ea=c.compare||b&&b.compare,fa={hash:{},inverse:ja.noop,fn:ja.program(44,F,e),data:e},da=ea?ea.call(b,b&&b.type_text,"text",fa):ha.call(b,"compare",b&&b.type_text,"text",fa),(da||0===da)&&(ga+=da),ga+="\n\n    \n    ",ea=c.compare||b&&b.compare,fa={hash:{operator:">"},inverse:ja.noop,fn:ja.program(46,G,e),data:e},da=ea?ea.call(b,b&&b.originality,1,fa):ha.call(b,"compare",b&&b.originality,1,fa),(da||0===da)&&(ga+=da),ga+="\n"})}),define("hbs!modules/template/homefeed/post-ef",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e="";return e+="\n			    ",d=c["if"].call(a,a&&a.id,{hash:{},inverse:u.noop,fn:u.program(2,g,b),data:b}),(d||0===d)&&(e+=d),e+="\n		   "}function g(a,b){var d,e,f,g="";return g+="\n					",e=c.compare||a&&a.compare,f={hash:{},inverse:u.program(5,i,b),fn:u.program(3,h,b),data:b},d=e?e.call(a,(d=a&&a.requesting_user_tag_id,null==d||d===!1?d:d.tag_id),a&&a.id,f):t.call(a,"compare",(d=a&&a.requesting_user_tag_id,null==d||d===!1?d:d.tag_id),a&&a.id,f),(d||0===d)&&(g+=d),g+="\n			    "}function h(a,b){var d,e,f,g="";return g+="\n			            <a href='#' class='tag-post active' data-tag_type='emotion' data-tag_id='",(e=c.id)?d=e.call(a,{hash:{},data:b}):(e=a&&a.id,d=typeof e===r?e.call(a,{hash:{},data:b}):e),g+=s(d)+"' title='",(e=c.label)?d=e.call(a,{hash:{},data:b}):(e=a&&a.label,d=typeof e===r?e.call(a,{hash:{},data:b}):e),g+=s(d)+"'><img src='"+s((e=c.getPostTagPropertyImage||a&&a.getPostTagPropertyImage,f={hash:{},data:b},e?e.call(a,a&&a.image,24,f):t.call(a,"getPostTagPropertyImage",a&&a.image,24,f)))+"' width='24' height='24' /></a>\n			        "}function i(a,b){var d,e,f,g="";return g+="\n				        <a href='#' class='tag-post' data-tag_type='emotion' data-tag_id='",(e=c.id)?d=e.call(a,{hash:{},data:b}):(e=a&&a.id,d=typeof e===r?e.call(a,{hash:{},data:b}):e),g+=s(d)+"' title='",(e=c.label)?d=e.call(a,{hash:{},data:b}):(e=a&&a.label,d=typeof e===r?e.call(a,{hash:{},data:b}):e),g+=s(d)+"'><img src='"+s((e=c.getPostTagPropertyImage||a&&a.getPostTagPropertyImage,f={hash:{},data:b},e?e.call(a,a&&a.image,24,f):t.call(a,"getPostTagPropertyImage",a&&a.image,24,f)))+"' width='24' height='24' /></a>\n			        "}function j(a,b){var d,e,f,g="";return g+='\n			<span class="wb wb-12" style="background:top left no-repeat url(\''+s((e=c.getUrl||a&&a.getUrl,f={hash:{},data:b},e?e.call(a,"cdn",f):t.call(a,"getUrl","cdn",f)))+"/"+s((d=a&&a.tag_entity,d=null==d||d===!1?d:d.requesting_user_tag_id,d=null==d||d===!1?d:d.image,d=null==d||d===!1?d:d.size_12,typeof d===r?d.apply(a):d))+"')\"></span>\n		"}function k(a,b){return'\n			<span class="icon-wb_emoticon"></span>\n		'}function l(a,b){var c;return s((c=a&&a.tag_entity,c=null==c||c===!1?c:c.total_count,typeof c===r?c.apply(a):c))}function m(a,b){var c="";return c}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var n,o,p,q="",r="function",s=this.escapeExpression,t=c.helperMissing,u=this,v=c.blockHelperMissing;return q+='<div class="ef-selector">\n	<a href="#"\n	   data-title="'+s((o=c.translate||b&&b.translate,p={hash:{},data:e},o?o.call(b,"post|emotional_i_feel",p):t.call(b,"translate","post|emotional_i_feel",p)))+'"\n	   data-toggle="clickover"\n	   data-placement="bottom"\n	   data-html="true"\n	   data-animation="false"\n	   data-content="\n			',p={hash:{},inverse:u.noop,fn:u.program(1,f,e),data:e},(o=c.tag_properties)?n=o.call(b,p):(o=b&&b.tag_properties,n=typeof o===r?o.call(b,p):o),c.tag_properties||(n=v.call(b,n,{hash:{},inverse:u.noop,fn:u.program(1,f,e),data:e})),(n||0===n)&&(q+=n),q+='"\n		>\n		',n=c["if"].call(b,(n=b&&b.tag_entity,n=null==n||n===!1?n:n.requesting_user_tag_id,null==n||n===!1?n:n.tag_id),{hash:{},inverse:u.program(9,k,e),fn:u.program(7,j,e),data:e}),(n||0===n)&&(q+=n),q+='\n		<span class="icon-wb_arrowDown" style="font-size: 12px; height: 14px;"></span>\n		<span class="count">',n=c["if"].call(b,b&&b.tag_entity,{hash:{},inverse:u.program(13,m,e),fn:u.program(11,l,e),data:e}),(n||0===n)&&(q+=n),q+="</span>\n	</a>\n</div>"})}),!function(a){"use strict";var b=function(a,b){this.cinit("clickover",a,b)};b.prototype=a.extend({},a.fn.popover.Constructor.prototype,{constructor:b,cinit:function(b,c,d){this.attr={},this.attr.me=(10*Math.random()+"").replace(/\D/g,""),this.attr.click_event_ns="click."+this.attr.me+" touchstart."+this.attr.me,d||(d={}),d.trigger="manual",this.init(b,c,d),this.$element.on("click",this.options.selector,a.proxy(this.clickery,this))},clickery:function(b){if(b&&(b.preventDefault(),b.stopPropagation()),this.options.width&&this.tip().width(this.options.width),this.options.height&&this.tip().height(this.options.height),this.options.tip_id&&this.tip().attr("id",this.options.tip_id),this.options.class_name&&this.tip().addClass(this.options.class_name),this[this.isShown()?"hide":"show"](),this.isShown()){var c=this;this.options.global_close&&a("body").on(this.attr.click_event_ns,function(a){c.tip().has(a.target).length||c.clickery()}),this.options.esc_close&&a(document).bind("keyup.clickery",function(a){27==a.keyCode&&c.clickery()}),!this.options.allow_multiple&&a("[data-clickover-open=1]").each(function(){a(this).data("clickover")&&a(this).data("clickover").clickery()}),this.$element.attr("data-clickover-open",1),this.tip().on("click",'[data-dismiss="clickover"]',a.proxy(this.clickery,this)),this.options.auto_close&&this.options.auto_close>0&&(this.attr.tid=setTimeout(a.proxy(this.clickery,this),this.options.auto_close)),"function"==typeof this.options.onShown&&this.options.onShown.call(this),this.$element.trigger("shown")}else this.$element.removeAttr("data-clickover-open"),this.options.esc_close&&a(document).unbind("keyup.clickery"),a("body").off(this.attr.click_event_ns),"number"==typeof this.attr.tid&&(clearTimeout(this.attr.tid),delete this.attr.tid),"function"==typeof this.options.onHidden&&this.options.onHidden.call(this),this.$element.trigger("hidden")},isShown:function(){return this.tip().hasClass("in")},resetPosition:function(){var a,b,c,d,e,f,g;if(this.hasContent()&&this.enabled){switch(a=this.tip(),f="function"==typeof this.options.placement?this.options.placement.call(this,a[0],this.$element[0]):this.options.placement,b=/in/.test(f),c=this.getPosition(b),d=a[0].offsetWidth,e=a[0].offsetHeight,b?f.split(" ")[1]:f){case"bottom":g={top:c.top+c.height,left:c.left+c.width/2-d/2};break;case"top":g={top:c.top-e,left:c.left+c.width/2-d/2};break;case"left":g={top:c.top+c.height/2-e/2,left:c.left-d};break;case"right":g={top:c.top+c.height/2-e/2,left:c.left+c.width}}a.css(g)}},debughide:function(){var a=(new Date).toString();console.log(a+": clickover hide"),this.hide()}}),a.fn.clickover=function(c){return this.each(function(){var d=a(this),e=d.data("clickover"),f="object"==typeof c&&c;e||d.data("clickover",e=new b(this,f)),"string"==typeof c&&e[c]()})},a.fn.clickover.Constructor=b,a.fn.clickover.defaults=a.extend({},a.fn.popover.defaults,{trigger:"manual",auto_close:0,global_close:1,esc_close:1,onShown:null,onHidden:null,width:null,height:null,tip_id:null,class_name:"clickover",allow_multiple:0})}(window.jQuery),define("bootstrapx-clickover",["bootstrap"],function(){}),define("modules/view/homefeed/post_ef_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/homefeed/post-ef","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers","bootstrapx-clickover"],function(a,b,c,d,e,f,g,h,i){var j=e.ItemView.extend({template:{type:"handlebars",template:g},className:"post-ef",initialize:function(a){this.options=a},events:{"click .tag-post":"tagPost"},onRender:function(){var a=b(".ef-selector",this.$el).parent();a.removeClass("post-reaction-active"),b("a",this.$el).clickover({width:270,global_close:!0,onShown:function(){a.addClass("post-reaction-active")},onHidden:function(){a.removeClass("post-reaction-active")}}),b("a.ef-selector",this.$el).attr("title",i.translate("post|emotional_i_feel"))},tagPost:function(a){if(a.preventDefault(),!i.is_logged_in())return void i.show_login_dialog();var c=this,d=b(a.currentTarget,this.$el),e=this.model.tagPost(d.data("tag_type"),d.data("tag_id"));e.done(function(a){a=i.parse_ajax_response(a),a.error?i.show_error(i.translate(a.error)):c.render()})}});return j}),define("hbs!modules/template/post/single-post-reply-item-view",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){return'\n					<span class="icon-wb_repost icon--circle icon--bottom-rights"></span>\n				'}function g(a,b){var d,e,f,g="";return g+='\n			<div class="post-image no-padding-left">\n				<img src="'+E((e=c.fn_post_reply_get_big_image||a&&a.fn_post_reply_get_big_image,f={hash:{},data:b},e?e.call(a,(d=a&&a.media,null==d||d===!1?d:d.photo),f):D.call(a,"fn_post_reply_get_big_image",(d=a&&a.media,null==d||d===!1?d:d.photo),f)))+'" class="post-image-img" />\n			</div>\n		'}function h(a,b){var d,e,f,g="";return g+='\n			<div class="post-video no-padding-left">\n				',e=c.compare||a&&a.compare,f={hash:{},inverse:G.noop,fn:G.program(6,i,b),data:b},d=e?e.call(a,(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"youtube",f):D.call(a,"compare",(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"youtube",f),(d||0===d)&&(g+=d),g+="\n				",e=c.compare||a&&a.compare,f={hash:{},inverse:G.noop,fn:G.program(6,i,b),data:b},d=e?e.call(a,(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"vimeo",f):D.call(a,"compare",(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"vimeo",f),(d||0===d)&&(g+=d),g+="\n				",e=c.compare||a&&a.compare,f={hash:{},inverse:G.noop,fn:G.program(8,j,b),
data:b},d=e?e.call(a,(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"flickr",f):D.call(a,"compare",(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"flickr",f),(d||0===d)&&(g+=d),g+="\n				",e=c.compare||a&&a.compare,f={hash:{},inverse:G.noop,fn:G.program(10,k,b),data:b},d=e?e.call(a,(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"soundcloud",f):D.call(a,"compare",(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"soundcloud",f),(d||0===d)&&(g+=d),g+="\n			</div>\n		"}function i(a,b){var c,d="";return d+='\n					<object class="post-video-object" type="application/x-shockwave-flash" data="'+E((c=a&&a.media,c=null==c||c===!1?c:c.video,c=null==c||c===!1?c:c.url,typeof c===F?c.apply(a):c))+'">\n						<param name="wmode" value="transparent" />\n						<param name="allowfullscreen" value="true" />\n						<param name="movie" value="'+E((c=a&&a.media,c=null==c||c===!1?c:c.video,c=null==c||c===!1?c:c.url,typeof c===F?c.apply(a):c))+'" />\n					</object>\n				'}function j(a,b){var d,e,f,g="";return g+='\n					<object class="post-video-object" type="application/x-shockwave-flash" data="http://www.flickr.com/apps/slideshow/show.swf?v=71649">\n						<param name="wmode" value="transparent" />\n						<param name="allowFullScreen" value="true" />\n						<param name="movie" value="http://www.flickr.com/apps/slideshow/show.swf?v=71649" />\n						<param name="flashvars" value="offsite=true&amp;lang=en-us&amp;page_show_url='+E((e=c.fn_get_flickr_relative_url||a&&a.fn_get_flickr_relative_url,f={hash:{},data:b},e?e.call(a,(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.url),f):D.call(a,"fn_get_flickr_relative_url",(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.url),f)))+"/show/&amp;page_show_back_url="+E((e=c.fn_get_flickr_relative_url||a&&a.fn_get_flickr_relative_url,f={hash:{},data:b},e?e.call(a,(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.url),f):D.call(a,"fn_get_flickr_relative_url",(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.url),f)))+"/&amp;set_id="+E((d=a&&a.media,d=null==d||d===!1?d:d.video,d=null==d||d===!1?d:d.id,typeof d===F?d.apply(a):d))+'" />\n					</object>\n				'}function k(a,b){var c,d="";return d+='\n					<iframe width="100%" height="450" scrolling="no" frameborder="no" src="'+E((c=a&&a.media,c=null==c||c===!1?c:c.video,c=null==c||c===!1?c:c.url,typeof c===F?c.apply(a):c))+'"></iframe>\n				'}function l(a,b){var d,e,f,g="";return g+='\n			<div class="gift-fragment ',d=c["if"].call(a,a&&a.is_gift_shower,{hash:{},inverse:G.noop,fn:G.program(13,m,b),data:b}),(d||0===d)&&(g+=d),g+='">\n				<div class="gift-box ',d=c["if"].call(a,a&&a.is_gift_shower,{hash:{},inverse:G.noop,fn:G.program(15,n,b),data:b}),(d||0===d)&&(g+=d),g+='">\n					<div class="gift-box-fragment">\n						',d=c["if"].call(a,a&&a.is_gift_shower,{hash:{},inverse:G.noop,fn:G.program(17,o,b),data:b}),(d||0===d)&&(g+=d),g+='\n						<div class="fragment-image emoticon-pending" emoticon:id="',(e=c.gift_hotkey)?d=e.call(a,{hash:{},data:b}):(e=a&&a.gift_hotkey,d=typeof e===F?e.call(a,{hash:{},data:b}):e),g+=E(d)+'" id="',(e=c.gift_block_id)?d=e.call(a,{hash:{},data:b}):(e=a&&a.gift_block_id,d=typeof e===F?e.call(a,{hash:{},data:b}):e),g+=E(d)+'">\n							<i class="ico ico-24 ico-store-gifts"></i>\n							<div class="fragment-text">',(e=c.gift_hotkey)?d=e.call(a,{hash:{},data:b}):(e=a&&a.gift_hotkey,d=typeof e===F?e.call(a,{hash:{},data:b}):e),g+=E(d)+'</div>\n						</div>\n					</div>\n				</div>\n				<div class="message-part ',d=c["if"].call(a,a&&a.is_gift_shower,{hash:{},inverse:G.noop,fn:G.program(19,p,b),data:b}),(d||0===d)&&(g+=d),g+='">\n					',d=c.unless.call(a,a&&a.is_gift_shower,{hash:{},inverse:G.noop,fn:G.program(21,q,b),data:b}),(d||0===d)&&(g+=d),g+="\n					",d=c["if"].call(a,a&&a.gift_message,{hash:{},inverse:G.noop,fn:G.program(23,r,b),data:b}),(d||0===d)&&(g+=d),g+='\n					<div class="message-from">'+E((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"gift_shower_msg","",f):D.call(a,"translate","gift_shower_msg","",f)))+'<a href="'+E((e=c.getProfileUrl||a&&a.getProfileUrl,f={hash:{},data:b},e?e.call(a,a&&a.sender_name,f):D.call(a,"getProfileUrl",a&&a.sender_name,f)))+'">',(e=c.sender_name)?d=e.call(a,{hash:{},data:b}):(e=a&&a.sender_name,d=typeof e===F?e.call(a,{hash:{},data:b}):e),g+=E(d)+"</a></div>\n				</div>\n			</div>\n		"}function m(a,b){return"gift-shower-fragment"}function n(a,b){return"gift-shower-box"}function o(a,b){var d,e,f="";return f+='\n							<div class="gift-shower-banner"><img src="'+E((d=c.getUrl||a&&a.getUrl,e={hash:{},data:b},d?d.call(a,"jsclient",e):D.call(a,"getUrl","jsclient",e)))+'/app/images/mig.me/giftshower.png"></div>\n						'}function p(a,b){return"gift-shower-msg"}function q(a,b){var d,e,f,g="";return g+="\n						<div>\n							"+E((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"post|gift_for","",f):D.call(a,"translate","post|gift_for","",f)))+'<a href="'+E((e=c.getProfileUrl||a&&a.getProfileUrl,f={hash:{},data:b},e?e.call(a,a&&a.recipient_name,f):D.call(a,"getProfileUrl",a&&a.recipient_name,f)))+'">',(e=c.recipient_name)?d=e.call(a,{hash:{},data:b}):(e=a&&a.recipient_name,d=typeof e===F?e.call(a,{hash:{},data:b}):e),g+=E(d)+"</a>\n						</div>\n					"}function r(a,b){var d,e,f="";return f+='\n						<div>"',(e=c.gift_message)?d=e.call(a,{hash:{},data:b}):(e=a&&a.gift_message,d=typeof e===F?e.call(a,{hash:{},data:b}):e),f+=E(d)+'"</div>\n					'}function s(a,b){var d,e="";return e+='\n			<div class="display-inline-block spp-options post-reaction">\n				',d=c["if"].call(a,a&&a.is_watching,{hash:{},inverse:G.program(28,u,b),fn:G.program(26,t,b),data:b}),(d||0===d)&&(e+=d),e+="\n			</div>\n			"}function t(a,b){var d,e,f="";return f+='\n					<a href="#" class="watch-reply watched" title="'+E((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"post|unfavourite",e):D.call(a,"translate","post|unfavourite",e)))+'">\n						<span class="icon-wb_like"></span>\n						<!-- <span>'+E((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"post|favourite",e):D.call(a,"translate","post|favourite",e)))+"</span> -->\n					</a>\n				"}function u(a,b){var d,e,f="";return f+='\n					<a href="#" class="watch-reply watch" title="'+E((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"post|favourite",e):D.call(a,"translate","post|favourite",e)))+'">\n						<span class="icon-wb_favourite"></span>\n						<!-- <span>'+E((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"post|favourite",e):D.call(a,"translate","post|favourite",e)))+"</span> -->\n					</a>\n				"}function v(a,b){var d,e,f="";return f+='\n			<div class="display-inline-block spp-options post-reaction">\n				<a href="#" class="show-reply-box" data-hasqtip="6" title="'+E((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"post|reply",e):D.call(a,"translate","post|reply",e)))+'" aria-describedby="qtip-6">\n					<span class="icon-wb_reply"></span>\n					<!-- <span>'+E((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"post|reply",e):D.call(a,"translate","post|reply",e)))+"</span> -->\n				</a>\n			</div>\n			"}function w(a,b){var d,e,f="";return f+='\n							<li><a href="#" class="delete-reply">'+E((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"common|delete",e):D.call(a,"translate","common|delete",e)))+"</a></li>\n						"}function x(a,b){var d,e,f="";return f+='\n							<li><a href="#" class="report-reply">'+E((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"common|report",e):D.call(a,"translate","common|report",e)))+"</a></li>\n						"}function y(a,b){var d,e,f="";return f+='\n		<div class="col-xs-12 no-padding-left">\n			<a href="#" class="show-all-reply hidden" data-hasqtip="6" title="Show Replies" aria-describedby="qtip-6">\n				'+E((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"post|view_replies",a&&a.num_of_replies,e):D.call(a,"translate","post|view_replies",a&&a.num_of_replies,e)))+' \n			</a>\n			<a href="#" class="hide-all-reply hidden" data-hasqtip="6" title="Hide Replies" aria-describedby="qtip-6">\n				'+E((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"post|hide_replies",e):D.call(a,"translate","post|hide_replies",e)))+" \n			</a>\n		</div>\n		"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var z,A,B,C="",D=c.helperMissing,E=this.escapeExpression,F="function",G=this,H=c.blockHelperMissing;return C+='<div class="row">\n	<div class="left post-avatar-container">\n		<div class="post-author-avatar">\n			<a href="',z=b&&b.author,z=null==z||z===!1?z:z.personalized_url,z=typeof z===F?z.apply(b):z,(z||0===z)&&(C+=z),C+='" class="profile-hovercard" data-username="'+E((z=b&&b.author,z=null==z||z===!1?z:z.username,typeof z===F?z.apply(b):z))+'">\n				<img src="'+E((A=c.getDisplayPictureUrl||b&&b.getDisplayPictureUrl,B={hash:{},data:e},A?A.call(b,(z=b&&b.author,null==z||z===!1?z:z.username),(z=b&&b.author,null==z||z===!1?z:z.display_picture_type),36,36,B):D.call(b,"getDisplayPictureUrl",(z=b&&b.author,null==z||z===!1?z:z.username),(z=b&&b.author,null==z||z===!1?z:z.display_picture_type),36,36,B)))+'" width="36" height="36" class="img-circle" />\n				',A=c.compare||b&&b.compare,B={hash:{},inverse:G.noop,fn:G.program(1,f,e),data:e},z=A?A.call(b,b&&b.originality_text,"reshare",B):D.call(b,"compare",b&&b.originality_text,"reshare",B),(z||0===z)&&(C+=z),C+='\n			</a>\n		</div>\n	</div>\n	<div class="left post-reply-container">\n		<div class="col-xs-12 post-text-details">\n			<div class="col-xs-12 no-padding-left">\n				<span class="post-author no-padding-left">\n					<a href="',z=b&&b.author,z=null==z||z===!1?z:z.personalized_url,z=typeof z===F?z.apply(b):z,(z||0===z)&&(C+=z),C+='" class="profile-hovercard" data-username="'+E((z=b&&b.author,z=null==z||z===!1?z:z.username,typeof z===F?z.apply(b):z))+'">'+E((z=b&&b.author,z=null==z||z===!1?z:z.username,typeof z===F?z.apply(b):z))+"</a>&nbsp;"+E((A=c.userGetLabels||b&&b.userGetLabels,B={hash:{},data:e},A?A.call(b,b&&b.author,B):D.call(b,"userGetLabels",b&&b.author,B)))+'\n				</span>\n				&nbsp;&nbsp;\n				<span class="post-time font-size-12">\n					<a href="',(A=c.permalink)?z=A.call(b,{hash:{},data:e}):(A=b&&b.permalink,z=typeof A===F?A.call(b,{hash:{},data:e}):A),C+=E(z)+'"><time class="timeago" datetime="'+E((A=c.dateFormat||b&&b.dateFormat,B={hash:{},data:e},A?A.call(b,b&&b.timestamp,"isoUtcDateTime",B):D.call(b,"dateFormat",b&&b.timestamp,"isoUtcDateTime",B)))+'">'+E((A=c.getRelativeTimestamp||b&&b.getRelativeTimestamp,B={hash:{},data:e},A?A.call(b,b&&b.timestamp,B):D.call(b,"getRelativeTimestamp",b&&b.timestamp,B)))+"</time> "+E((A=c.translate||b&&b.translate,B={hash:{},data:e},A?A.call(b,"post|via",B):D.call(b,"translate","post|via",B)))+" ",(A=c.application_text)?z=A.call(b,{hash:{},data:e}):(A=b&&b.application_text,z=typeof A===F?A.call(b,{hash:{},data:e}):A),C+=E(z)+'</a>\n				</span>\n			</div>\n		</div>\n		<div class="clear"></div>\n		<div class="col-xs-12 post-text">\n			',(A=c.body)?z=A.call(b,{hash:{},data:e}):(A=b&&b.body,z=typeof A===F?A.call(b,{hash:{},data:e}):A),(z||0===z)&&(C+=z),C+="\n		</div>\n		",A=c.compare||b&&b.compare,B={hash:{},inverse:G.noop,fn:G.program(3,g,e),data:e},z=A?A.call(b,b&&b.type_text,"photo",B):D.call(b,"compare",b&&b.type_text,"photo",B),(z||0===z)&&(C+=z),C+="\n		",A=c.compare||b&&b.compare,B={hash:{},inverse:G.noop,fn:G.program(5,h,e),data:e},z=A?A.call(b,b&&b.type_text,"video",B):D.call(b,"compare",b&&b.type_text,"video",B),(z||0===z)&&(C+=z),C+="\n		",A=c.compare||b&&b.compare,B={hash:{},inverse:G.noop,fn:G.program(12,l,e),data:e},z=A?A.call(b,b&&b.type_text,"gift",B):D.call(b,"compare",b&&b.type_text,"gift",B),(z||0===z)&&(C+=z),C+='\n		<div class="col-xs-12 no-padding-left spp-only hidden">\n			',B={hash:{},inverse:G.noop,fn:G.program(25,s,e),data:e},(A=c.ifPostCanBeWatched)?z=A.call(b,B):(A=b&&b.ifPostCanBeWatched,z=typeof A===F?A.call(b,B):A),c.ifPostCanBeWatched||(z=H.call(b,z,{hash:{},inverse:G.noop,fn:G.program(25,s,e),data:e})),(z||0===z)&&(C+=z),C+='\n			<!-- <div class="display-inline-block spp-options">\n				<a href="#" class="send-gift" data-hasqtip="6" title="'+E((A=c.translate||b&&b.translate,B={hash:{},data:e},A?A.call(b,"user|send_gift",B):D.call(b,"translate","user|send_gift",B)))+'" aria-describedby="qtip-6">\n					<span class="icon-wb_gift"></span>\n					<span>'+E((A=c.translate||b&&b.translate,B={hash:{},data:e},A?A.call(b,"user|gift",B):D.call(b,"translate","user|gift",B)))+"</span>\n				</a>\n			</div> -->\n			",A=c.compare||b&&b.compare,B={hash:{},inverse:G.noop,fn:G.program(30,v,e),data:e},z=A?A.call(b,b&&b.reply_permission,0,B):D.call(b,"compare",b&&b.reply_permission,0,B),(z||0===z)&&(C+=z),C+='\n			<div class="display-inline-block spp-options post-reaction">\n				<a href="#" class="share-reply" title="'+E((A=c.translate||b&&b.translate,B={hash:{},data:e},A?A.call(b,"common|share",B):D.call(b,"translate","common|share",B)))+'">\n					<span class="icon-wb_mb_share"></span>\n				</a>\n			</div>\n			<div class="display-inline-block spp-options post-reaction">\n				<div class="dropdown">\n					<a class="dropdown-toggle" data-toggle="dropdown" href="#" onclick="return false;" title="'+E((A=c.translate||b&&b.translate,B={hash:{},data:e},A?A.call(b,"common|more",B):D.call(b,"translate","common|more",B)))+'">\n						<span class="icon-wb_more"></span>\n						<!-- <span>'+E((A=c.translate||b&&b.translate,B={hash:{},data:e},A?A.call(b,"common|more",B):D.call(b,"translate","common|more",B)))+'</span> -->\n					</a>\n					<ul class="dropdown-menu">\n						',B={hash:{},inverse:G.program(34,x,e),fn:G.program(32,w,e),data:e},(A=c.ifPostReplyCanBeDeleted)?z=A.call(b,B):(A=b&&b.ifPostReplyCanBeDeleted,z=typeof A===F?A.call(b,B):A),c.ifPostReplyCanBeDeleted||(z=H.call(b,z,{hash:{},inverse:G.program(34,x,e),fn:G.program(32,w,e),data:e})),(z||0===z)&&(C+=z),C+='\n					</ul>\n				</div>\n			</div>\n			<div class="post-nested-reply"></div>\n		</div>\n		',z=c["if"].call(b,b&&b.replies,{hash:{},inverse:G.noop,fn:G.program(36,y,e),data:e}),(z||0===z)&&(C+=z),C+='\n	</div>\n</div>\n<div class="nestedreplies">\n</div>\n'})}),define("modules/view/post/single_post_reply_composite_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/view/common/postbox_view","hbs!modules/template/post/single-post-reply-item-view","modules/view/post/single_post_reply_reply_collection_view","modules/model/post/reply_collection","modules/template/helpers/general_helpers","modules/template/helpers/post_helpers","jquery.timeago"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=e.CompositeView.extend({template:{type:"handlebars",template:j},className:"response reply",events:{"click .delete-reply:first":"deleteReply","click .report-reply:first":"reportReply","click .show-reply-box:first":"showReplyBox","click .show-repost-box:first":"showRepostBox","click .share-reply:first":"showShare","click .watch-reply:first":"watchReply","click .send-gift:first":"showGift"},showGift:function(a){null!==a&&a.preventDefault(),h.show_gift_selection("post",this.model)},showShare:function(a){null!==a&&a.preventDefault(),this.model.data=this.model.attributes,h.show_share_dialog("post",this.model)},id:function(){return"post-reply-"+this.model.get("id")},initialize:function(){this.collection=new l(this.model.get("replies")),this.activePostBox=null;var a=this;b("body").click(function(c){a.activePostBox&&(b(".main-reply-box").removeClass("hidden"),a.activePostBox.addClass("hidden"),b(".show-reply-box").removeClass("active"),b(".main-reply-box").trigger("cssClassChanged"),a.activePostBox=null)})},onRender:function(){b(".reply-template",this.$el).slideDown(500),b("time.timeago",this.$el).timeago(),h.parse_profile_hovercard(this)},showRepostBox:function(a){a.stopPropagation(),a.preventDefault();var c=new i({collapsible:!1,originality:3,parent_post:this.model});c.render(),b(".post-nested-reply").addClass("hidden"),b(".show-reply-box").removeClass("active"),this.activePostBox&&this.activePostBox.empty(),this.activePostBox=b(".post-nested-reply:first",this.$el),this.activePostBox.html(c.el),this.activePostBox.removeClass("hidden"),this.activePostBox.focusin(function(a){a.stopPropagation(),a.preventDefault(),b(".main-reply-box").addClass("hidden"),b(".main-reply-box").trigger("cssClassChanged")}),b(".post-nested-reply:first textarea",this.$el).focus()},showReplyBox:function(a){a.stopPropagation(),a.preventDefault();var c=new i({collapsible:!1,originality:2,parent_post:this.model.parent_model,defaultText:"@"+this.model.get("author").alias+" "});c.render(),b(".post-nested-reply").addClass("hidden"),b(".show-reply-box").removeClass("active"),b(".show-reply-box:first",this.$el).addClass("active"),this.activePostBox&&this.activePostBox.empty(),this.activePostBox=b(".post-nested-reply:first",this.$el),this.activePostBox.html(c.el),this.activePostBox.removeClass("hidden"),this.activePostBox.focusin(function(a){a.stopPropagation(),a.preventDefault(),b(".main-reply-box").addClass("hidden"),b(".main-reply-box").trigger("cssClassChanged")}),b(".post-nested-reply:first textarea",this.$el).click()},watchReply:function(a){if(a.preventDefault(),h.is_logged_in()){var c,d=b(a.currentTarget);c=d.hasClass("watched")?this.model.unwatchPost():this.model.watchPost(),c.done(function(a){a=h.parse_ajax_response(a),a&&(d.hasClass("watched")?d.attr("title",h.translate("post|favourite")):d.attr("title",h.translate("post|unfavourite")),d.toggleClass("watch watched"),b('span[class*="icon-wb_fav"]',d).toggleClass("icon-wb_favourite icon-wb_like"))})}},reportReply:function(a){if(a.preventDefault(),h.is_logged_in()&&window.confirm(h.translate("post|confirm_report"))){var c=b(a.currentTarget);if(c.hasClass("reported"))return;var d=this,e=this.model.reportPost();e.done(function(a){a=h.parse_ajax_response(a),a.error?h.show_error(h.translate("post|error_report")):(c.text(h.translate("common|reported")),h.show_success(h.translate("post|success_report")),b(d.$el).fadeOut().addClass("reported"),b(d.$el).promise().done(function(){b(d.$el).remove()}))})}},deleteReply:function(a){if(a.stopPropagation(),a.preventDefault(),h.is_logged_in()&&window.confirm(h.translate("post|confirm_delete_reply"))){var c=this,d=this.model.deleteReply();d.done(function(a){if(a=h.parse_ajax_response(a),a.error)h.show_error(h.translate("post|error_delete_reply"));else{var d=require("modules/mig33_app");d.vent.trigger(d.ApplicationEvents.POST_REPLY_DELETED,c.model),h.show_success(h.translate("post|success_delete_reply")),b(c.$el).fadeOut(),b(c.$el).promise().done(function(){b(c.$el).remove()})}})}}});return m}),define("modules/view/post/single_post_reply_reply_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/view/post/single_post_reply_composite_view","modules/view/common/mig33_views","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j){var k=e.CollectionView.extend({itemView:i,className:"post-replies",initialize:function(b){a.bindAll(this)}});return k}),define("modules/view/post/single_post_reply_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/view/common/postbox_view","hbs!modules/template/post/single-post-reply-item-view","modules/view/post/single_post_reply_reply_collection_view","modules/model/post/reply_collection","modules/model/post/reply_model","modules/template/helpers/general_helpers","modules/template/helpers/post_helpers","jquery.timeago"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=e.ItemView.extend({template:{type:"handlebars",template:j},className:"response reply",id:function(){return"post-reply-"+this.model.get("id")},initialize:function(){this.post_replies_composite_view=null,this.activePostBox=null;var a=this;b("body").click(function(c){a.activePostBox&&(b(".main-reply-box").removeClass("hidden"),a.activePostBox.addClass("hidden"),b(".show-reply-box").removeClass("active"),b(".main-reply-box").trigger("cssClassChanged"),a.activePostBox=null)})},onRender:function(){if(b(".reply-template",this.$el).slideDown(500),b("time.timeago",this.$el).timeago(),h.parse_profile_hovercard(this),this.model.get("replies")&&this.model.get("replies").length>0){var a=new l(this.model.get("replies")),c=this;a.each(function(a){a.parent_model=c.model,a.set("parent_post",c.model.attributes)}),a.reverse(),null===this.post_replies_composite_view&&(this.post_replies_composite_view=new k({collection:a}),this.post_replies_composite_view.render(),b(".nestedreplies:first",this.$el).html(this.post_replies_composite_view.el))}this.model.get("num_of_replies")>g.posts.replies.homefeed_first_limit&&b(".show-all-reply:first",this.$el).removeClass("hidden")},events:{"click .delete-reply:first":"deleteReply","click .report-reply:first":"reportReply","click .show-reply-box:first":"showReplyBox","click .show-repost-box:first":"showRepostBox","click .show-all-reply:first":"showAllReply","click .hide-all-reply:first":"hideAllReply","click .share-reply:first":"showShare","click .watch-reply:first":"watchReply","click .send-gift:first":"showGift"},showGift:function(a){null!==a&&a.preventDefault(),h.show_gift_selection("post",this.model)},watchReply:function(a){if(a.preventDefault(),h.is_logged_in()){var c,d=b(a.currentTarget);c=d.hasClass("watched")?this.model.unwatchPost():this.model.watchPost(),c.done(function(a){a=h.parse_ajax_response(a),a&&(d.hasClass("watched")?d.attr("title",h.translate("post|favourite")):d.attr("title",h.translate("post|unfavourite")),d.toggleClass("watch watched"),b('span[class*="icon-wb_fav"]',d).toggleClass("icon-wb_favourite icon-wb_like"))})}},showShare:function(a){null!==a&&a.preventDefault(),this.model.data=this.model.attributes,h.show_share_dialog("post",this.model)},showAllReply:function(a){if(a.stopPropagation(),a.preventDefault(),b(".show-all-reply:first",this.$el).addClass("hidden"),b(".show-all-reply:first",this.$el).hasClass("shown"))b(".nestedreplies:first",this.$el).removeClass("hidden"),b(".hide-all-reply:first",this.$el).removeClass("hidden");else{var c=this,d=b.ajax({type:"get",dataType:"json",url:g.urls.replies_url+"/"+this.model.id+"/1/"+g.posts.replies.limit+"/"});d.done(function(a){var d=new l(a.data.replies),e=c;d.each(function(a){a.parent_model=e.model,a.set("parent_post",e.model.attributes)}),d.reverse(),c.post_replies_composite_view=new k({collection:d}),c.post_replies_composite_view.render(),b(".nestedreplies:first",c.$el).html(c.post_replies_composite_view.el),b(".hide-all-reply:first",c.$el).removeClass("hidden"),b(".nestedreplies:first",c.$el).removeClass("hidden")}),d.fail(function(a,d,e){h.show_error(e),b(".show-all-reply:first",c.$el).addClass("hidden")})}},hideAllReply:function(a){a.stopPropagation(),a.preventDefault(),b(".show-all-reply:first",this.$el).removeClass("hidden").addClass("shown"),b(".nestedreplies:first",this.$el).addClass("hidden"),b(".hide-all-reply:first",this.$el).addClass("hidden")},showRepostBox:function(a){a.stopPropagation(),a.preventDefault();var c=new i({collapsible:!1,originality:3,parent_post:this.model});c.render(),b(".post-nested-reply").addClass("hidden"),b(".show-reply-box").removeClass("active"),this.activePostBox&&this.activePostBox.empty(),this.activePostBox=b(".post-nested-reply:first",this.$el),this.activePostBox.html(c.el),this.activePostBox.removeClass("hidden"),this.activePostBox.focusin(function(a){a.stopPropagation(),a.preventDefault(),b(".main-reply-box").addClass("hidden"),b(".main-reply-box").trigger("cssClassChanged")}),b(".post-nested-reply:first textarea",this.$el).focus()},showReplyBox:function(a){a.stopPropagation(),a.preventDefault();var c=new i({collapsible:!1,originality:2,parent_post:this.model});c.render(),b(".post-nested-reply").addClass("hidden"),b(".show-reply-box").removeClass("active"),b(".show-reply-box:first",this.$el).addClass("active"),this.activePostBox&&this.activePostBox.empty(),this.activePostBox=b(".post-nested-reply:first",this.$el),this.activePostBox.html(c.el),this.activePostBox.removeClass("hidden"),this.activePostBox.focusin(function(a){a.stopPropagation(),a.preventDefault(),b(".main-reply-box").addClass("hidden"),b(".main-reply-box").trigger("cssClassChanged")}),b(".post-nested-reply:first textarea",this.$el).focus()},reportReply:function(a){if(a.preventDefault(),h.is_logged_in()&&window.confirm(h.translate("post|confirm_report"))){var c=b(a.currentTarget);if(c.hasClass("reported"))return;var d=this,e=this.model.reportPost();e.done(function(a){a=h.parse_ajax_response(a),a.error?h.show_error(h.translate("post|error_report")):(c.text(h.translate("common|reported")),h.show_success(h.translate("post|success_report")),b(d.$el).fadeOut().addClass("reported"),b(d.$el).promise().done(function(){b(d.$el).remove()}))})}},deleteReply:function(a){if(a.stopPropagation(),a.preventDefault(),h.is_logged_in()&&window.confirm(h.translate("post|confirm_delete_reply"))){var c=this,d=this.model.deleteReply();d.done(function(a){if(a=h.parse_ajax_response(a),a.error)h.show_error(h.translate("post|error_delete_reply"));else{var d=require("modules/mig33_app");d.vent.trigger(d.ApplicationEvents.POST_REPLY_DELETED,c.model),h.show_success(h.translate("post|success_delete_reply")),b(c.$el).fadeOut(),b(c.$el).promise().done(function(){b(c.$el).remove()})}})}},replyToReply:function(a){var c=null,d=this;this.model.set("num_of_replies",this.model.get("num_of_replies")+1),c=new l(a),c.each(function(a){a.parent_model=d.model,a.set("parent_post",d.model.attributes)}),null!==this.post_replies_composite_view&&(this.post_replies_composite_view.collection.push(c.models[0]),c=this.post_replies_composite_view.collection),this.post_replies_composite_view=new k({collection:c}),this.post_replies_composite_view.render(),b(".nestedreplies:first",this.$el).html(this.post_replies_composite_view.el),b(".main-reply-box").removeClass("hidden")}});return n}),define("modules/view/post/single_post_reply_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/view/post/single_post_reply_item_view","modules/view/common/mig33_views","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j){var k=d.compile('{{translate "post|empty_replies"}}'),l=d.compile('{{translate "common|loading"}}...'),m=e.ItemView.extend({template:{type:"handlebars",template:k},className:"responses-empty"}),n=e.ItemView.extend({template:{type:"handlebars",template:l},className:"responses-empty loading"}),o=j.CollectionView.extend({itemView:i,emptyView:m,loadingView:n,className:"post-replies",initialize:function(){a.bindAll(this)},appendHtml:function(a,b,c){0===c?a.$el.append(b.el):a.$el.prepend(b.el)},replyToReply:function(a){var b=!1;return this.children.each(function(c){c.model.get("id")===a.parent_post.id&&(b=c.replyToReply(a))}),b}});return o}),define("hbs!modules/template/post/single-post-reshare-item-view",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){return'\n					<span class="icon-wb_repost icon--circle icon--bottom-rights"></span>\n				'}function g(a,b){var d,e,f="";return f+='\n                <span class="post-originality-text">'+r((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"post|share",e):q.call(a,"translate","post|share",e)))+"</span>\n			"}function h(a,b){var d,e,f,g="";return g+='\n			<div class="post-image no-padding-left">\n				<img src="'+r((e=c.fn_post_reply_get_big_image||a&&a.fn_post_reply_get_big_image,f={hash:{},data:b},e?e.call(a,(d=a&&a.media,null==d||d===!1?d:d.photo),f):q.call(a,"fn_post_reply_get_big_image",(d=a&&a.media,null==d||d===!1?d:d.photo),f)))+'" class="post-image-img" />\n			</div>\n		'}function i(a,b){var d,e,f,g="";return g+='\n			<div class="post-video no-padding-left">\n				',e=c.compare||a&&a.compare,f={hash:{},inverse:t.noop,fn:t.program(8,j,b),data:b},d=e?e.call(a,(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"youtube",f):q.call(a,"compare",(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"youtube",f),(d||0===d)&&(g+=d),g+="\n				",e=c.compare||a&&a.compare,f={hash:{},inverse:t.noop,fn:t.program(8,j,b),data:b},d=e?e.call(a,(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"vimeo",f):q.call(a,"compare",(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"vimeo",f),(d||0===d)&&(g+=d),g+="\n				",e=c.compare||a&&a.compare,f={hash:{},inverse:t.noop,fn:t.program(10,k,b),data:b},d=e?e.call(a,(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"flickr",f):q.call(a,"compare",(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"flickr",f),(d||0===d)&&(g+=d),g+="\n				",e=c.compare||a&&a.compare,f={hash:{},inverse:t.noop,fn:t.program(12,l,b),data:b},d=e?e.call(a,(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"soundcloud",f):q.call(a,"compare",(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"soundcloud",f),(d||0===d)&&(g+=d),g+="\n			</div>\n		"}function j(a,b){var c,d="";return d+='\n					<object class="post-video-object" type="application/x-shockwave-flash" data="'+r((c=a&&a.media,c=null==c||c===!1?c:c.video,c=null==c||c===!1?c:c.url,typeof c===s?c.apply(a):c))+'">\n						<param name="wmode" value="transparent" />\n						<param name="allowfullscreen" value="true" />\n						<param name="movie" value="'+r((c=a&&a.media,c=null==c||c===!1?c:c.video,c=null==c||c===!1?c:c.url,typeof c===s?c.apply(a):c))+'" />\n					</object>\n				'}function k(a,b){var d,e,f,g="";return g+='\n					<object class="post-video-object" type="application/x-shockwave-flash" data="http://www.flickr.com/apps/slideshow/show.swf?v=71649">\n						<param name="wmode" value="transparent" />\n						<param name="allowFullScreen" value="true" />\n						<param name="movie" value="http://www.flickr.com/apps/slideshow/show.swf?v=71649" />\n						<param name="flashvars" value="offsite=true&amp;lang=en-us&amp;page_show_url='+r((e=c.fn_get_flickr_relative_url||a&&a.fn_get_flickr_relative_url,f={hash:{},data:b},e?e.call(a,(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.url),f):q.call(a,"fn_get_flickr_relative_url",(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.url),f)))+"/show/&amp;page_show_back_url="+r((e=c.fn_get_flickr_relative_url||a&&a.fn_get_flickr_relative_url,f={hash:{},data:b},e?e.call(a,(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.url),f):q.call(a,"fn_get_flickr_relative_url",(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.url),f)))+"/&amp;set_id="+r((d=a&&a.media,d=null==d||d===!1?d:d.video,d=null==d||d===!1?d:d.id,typeof d===s?d.apply(a):d))+'" />\n					</object>\n				'}function l(a,b){var c,d="";return d+='\n					<iframe width="100%" height="450" scrolling="no" frameborder="no" src="'+r((c=a&&a.media,c=null==c||c===!1?c:c.video,c=null==c||c===!1?c:c.url,typeof c===s?c.apply(a):c))+'"></iframe>\n				'}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var m,n,o,p="",q=c.helperMissing,r=this.escapeExpression,s="function",t=this;return p+='<div class="row">\n	<div class="col-xs-2 col-sm-1">\n		<div class="post-author-avatar">\n			<a href="',m=b&&b.author,m=null==m||m===!1?m:m.personalized_url,m=typeof m===s?m.apply(b):m,(m||0===m)&&(p+=m),p+='" class="profile-hovercard" data-username="'+r((m=b&&b.author,m=null==m||m===!1?m:m.username,typeof m===s?m.apply(b):m))+'">\n				<img src="'+r((n=c.getDisplayPictureUrl||b&&b.getDisplayPictureUrl,o={hash:{},data:e},n?n.call(b,(m=b&&b.author,null==m||m===!1?m:m.username),(m=b&&b.author,null==m||m===!1?m:m.display_picture_type),48,48,o):q.call(b,"getDisplayPictureUrl",(m=b&&b.author,null==m||m===!1?m:m.username),(m=b&&b.author,
null==m||m===!1?m:m.display_picture_type),48,48,o)))+'" width="48" height="48" class="img-circle" />\n				',n=c.compare||b&&b.compare,o={hash:{},inverse:t.noop,fn:t.program(1,f,e),data:e},m=n?n.call(b,b&&b.originality_text,"reshare",o):q.call(b,"compare",b&&b.originality_text,"reshare",o),(m||0===m)&&(p+=m),p+='\n			</a>\n		</div>\n	</div>\n	<div class="col-xs-10 col-sm-11">\n		<div class="post-author no-padding-left">\n			<a href="',m=b&&b.author,m=null==m||m===!1?m:m.personalized_url,m=typeof m===s?m.apply(b):m,(m||0===m)&&(p+=m),p+='" class="profile-hovercard" data-username="'+r((m=b&&b.author,m=null==m||m===!1?m:m.username,typeof m===s?m.apply(b):m))+'">'+r((m=b&&b.author,m=null==m||m===!1?m:m.username,typeof m===s?m.apply(b):m))+"</a>&nbsp;"+r((n=c.userGetLabels||b&&b.userGetLabels,o={hash:{},data:e},n?n.call(b,b&&b.author,o):q.call(b,"userGetLabels",b&&b.author,o)))+'\n		</div>\n		<div class="post-time font-size-12 no-padding-left">\n			<a href="',(n=c.permalink)?m=n.call(b,{hash:{},data:e}):(n=b&&b.permalink,m=typeof n===s?n.call(b,{hash:{},data:e}):n),p+=r(m)+'"><time class="timeago" datetime="'+r((n=c.dateFormat||b&&b.dateFormat,o={hash:{},data:e},n?n.call(b,b&&b.timestamp,"isoUtcDateTime",o):q.call(b,"dateFormat",b&&b.timestamp,"isoUtcDateTime",o)))+'">'+r((n=c.getRelativeTimestamp||b&&b.getRelativeTimestamp,o={hash:{},data:e},n?n.call(b,b&&b.timestamp,o):q.call(b,"getRelativeTimestamp",b&&b.timestamp,o)))+"</time> "+r((n=c.translate||b&&b.translate,o={hash:{},data:e},n?n.call(b,"post|via",o):q.call(b,"translate","post|via",o)))+" ",(n=c.application_text)?m=n.call(b,{hash:{},data:e}):(n=b&&b.application_text,m=typeof n===s?n.call(b,{hash:{},data:e}):n),p+=r(m)+'</a>\n		</div>\n		<div class="post-text no-padding-left">\n			',m=c.unless.call(b,b&&b.body,{hash:{},inverse:t.noop,fn:t.program(3,g,e),data:e}),(m||0===m)&&(p+=m),p+="\n			",(n=c.body)?m=n.call(b,{hash:{},data:e}):(n=b&&b.body,m=typeof n===s?n.call(b,{hash:{},data:e}):n),(m||0===m)&&(p+=m),p+="\n		</div>\n		",n=c.compare||b&&b.compare,o={hash:{},inverse:t.noop,fn:t.program(5,h,e),data:e},m=n?n.call(b,b&&b.type_text,"photo",o):q.call(b,"compare",b&&b.type_text,"photo",o),(m||0===m)&&(p+=m),p+="\n		",n=c.compare||b&&b.compare,o={hash:{},inverse:t.noop,fn:t.program(7,i,e),data:e},m=n?n.call(b,b&&b.type_text,"video",o):q.call(b,"compare",b&&b.type_text,"video",o),(m||0===m)&&(p+=m),p+="\n	</div>\n</div>"})}),define("modules/view/post/single_post_reshare_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","hbs!modules/template/post/single-post-reshare-item-view","modules/template/helpers/general_helpers","modules/template/helpers/post_helpers","jquery.timeago"],function(a,b,c,d,e,f,g,h,i){var j=e.ItemView.extend({template:{type:"handlebars",template:i},className:"response reshare",id:function(){return"post-reshare-"+this.model.get("id")},initialize:function(){},onRender:function(){b(".reply-template",this.$el).slideDown(500),b("time.timeago",this.$el).timeago(),h.parse_profile_hovercard(this)}});return j}),define("modules/view/post/single_post_reshare_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/view/post/single_post_reshare_item_view","modules/view/common/mig33_views","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j){var k=d.compile('{{translate "post|empty_reshares"}}'),l=d.compile('{{translate "common|loading"}}...'),m=e.ItemView.extend({template:{type:"handlebars",template:k},className:"responses-empty"}),n=e.ItemView.extend({template:{type:"handlebars",template:l},className:"responses-empty loading"}),o=j.CollectionView.extend({itemView:i,emptyView:m,loadingView:n,className:"post-reshares",initialize:function(){a.bindAll(this)},appendHtml:function(a,b,c){0===c?a.$el.append(b.el):a.$el.prepend(b.el)}});return o}),define("hbs!modules/template/profile/achievement_profile_details",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h,i="",j=c.helperMissing,k=this.escapeExpression,l="function";return i+='<div class="achievement-profile-details">\n    <div class="user-avatar-img cursorPointer">\n        <img src="'+k((g=c.userGetDisplayPictureUrl||b&&b.userGetDisplayPictureUrl,h={hash:{},data:e},g?g.call(b,24,24,b,h):j.call(b,"userGetDisplayPictureUrl",24,24,b,h)))+'" width="24" height="24" class="img-circle dropdown" />\n    </div>\n\n    <div class="info">\n        <div class="font-size-16">\n            <a href="',(g=c.backButtonUrl)?f=g.call(b,{hash:{},data:e}):(g=b&&b.backButtonUrl,f=typeof g===l?g.call(b,{hash:{},data:e}):g),i+=k(f)+"u/",(g=c.username)?f=g.call(b,{hash:{},data:e}):(g=b&&b.username,f=typeof g===l?g.call(b,{hash:{},data:e}):g),i+=k(f)+'" class="profile-hovercard user-alias" data-username="',(g=c.username)?f=g.call(b,{hash:{},data:e}):(g=b&&b.username,f=typeof g===l?g.call(b,{hash:{},data:e}):g),i+=k(f)+'">'+k((g=c.userGetName||b&&b.userGetName,h={hash:{},data:e},g?g.call(b,b,h):j.call(b,"userGetName",b,h)))+'</a>\n            <span class="user-label font-size-12">'+k((g=c.userGetLabels||b&&b.userGetLabels,h={hash:{},data:e},g?g.call(b,b,h):j.call(b,"userGetLabels",b,h)))+'</span>\n        </div>\n        <div class="user-name font-size-12">\n            ＠',(g=c.username)?f=g.call(b,{hash:{},data:e}):(g=b&&b.username,f=typeof g===l?g.call(b,{hash:{},data:e}):g),i+=k(f)+"\n        </div>\n    </div>\n</div>\n"})}),define("modules/view/profile/achievement_profile_details_view",["hbs!modules/template/profile/achievement_profile_details","modules/view/user/user_view"],function(a,b){return b.extend({template:{type:"handlebars",template:a}})}),define("modules/view/homefeed/homefeed_post_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/homefeed/post-feed-view","hbs!modules/template/homefeed/post-content-view","modules/view/common/postbox_view","modules/view/homefeed/post_ef_item_view","modules/view/post/single_post_reply_collection_view","modules/view/post/single_post_reshare_collection_view","modules/common/config","modules/common/utility","modules/model/mimetypes/mime_types","modules/view/profile/achievement_profile_details_view","modules/model/user/user_model","modules/common/session_user","modules/template/helpers/general_helpers","modules/template/helpers/post_helpers","jquery.timeago","jquery.readmore"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q){var r=e.Layout.extend({template:{type:"handlebars",template:g},initialize:function(){this.registerPartialTemplates();a.bindAll(this),this.model.bind("change:num_of_replies",this.updateReplyCount),this.model.bind("change:num_of_reshares",this.updateShareCount),this.model.bind("change:watcher_count",this.updateLikeCount)},serializeData:function(){var a=this.model.toJSON();return a.post_config=m.posts,a},registerPartialTemplates:function(){if(void 0===this.model.mimeType&&void 0===this.model.mimeData){var a=require("hbs!modules/template/homefeed/post-content-view");d.registerPartial("postContent",a(this.model.attributes))}},updateLikeCount:function(a){b(".responses-more-like",this.$el).text(n.translate("post|like",n.add_thousands_seperator(a.get("watcher_count"))))},updateReplyCount:function(a){b(".responses-more-reply .more-reply",this.$el).text(n.translate("post|view_replies",n.add_thousands_seperator(a.get("num_of_replies"))))},updateShareCount:function(a){b(".responses-more-reshare",this.$el).text(n.translate("post|shares",n.add_thousands_seperator(a.get("num_of_reshares"))))},onBeforeClose:function(){this.model.off("change:num_of_replies",this.updateReplyCount),this.model.off("change:num_of_reshares",this.updateShareCount),this.model.off("change:watcher_count",this.updateLikeCount)},className:function(){return 4===parseInt(this.model.get("source"),10)?"post-promoted":"post-normal"},id:function(){return"post-"+this.model.get("id")},onRender:function(){this.$el.data("PostItemViewObject",this);1===this.model.get("reply_permission")&&(this.model.get("replies")&&0===this.model.get("replies").length&&b(".post-replies-pane .responses",this.$el).text(""),this.model.get("reshares")&&0===this.model.get("reshares").length&&b(".post-reshares-pane .responses",this.$el).text(""),this.hideReponseBox()),this.model.getReplies().length>0&&(b(".post-responses-row",this.$el).show(),b(".post-responses",this.$el).show(),b(".post-replies-pane",this.$el).show(),b(".post-reshares-pane",this.$el).hide(),this.postboxReply.show(new i({collapsible:!1,originality:2,parent_post:this.model})),this.postReplies.show(new k({collection:this.model.getReplies()})),b(".reply:lt(-"+m.posts.replies.homefeed_first_limit+")",this.$el).hide()),n.parse_profile_hovercard(this),b(".post-reaction a",this.$el).qtip({content:{text:function(){return b(this).data("title")?b(this).data("title"):b(this).attr("title")}},position:{my:"bottom center",at:"top center"},style:{classes:"qtip-post",def:!1},hide:{event:"click mouseleave"}}),b(".post-text",this.$el).readmore({speed:75,lessLink:'<a href="#" class="readmore-toggle">'+n.translate("common|less")+"</a>",moreLink:'<a href="#" class="readmore-toggle" >'+n.translate("common|more")+"</a>",collapsedHeight:120,heightMargin:16})},regions:{postEf:".post-reaction-ef",postReplies:".post-replies-pane .responses",postReshares:".post-reshares-pane .responses",postboxReply:".postbox-reply",postboxReshare:".postbox-repost"},events:{"click .watch-post":"watchPost","click .report-post":"reportPost","click .delete-post":"deletePost","click .email-post":"emailPost","click .share-link":"shareLink","click .lock-post":"setReplyPermission","click .unlock-post":"setReplyPermission",'click input[name="post_permalink"]':"selectPostPermalink","click .share-to-facebook":"shareToFacebook","click .share-to-twitter":"shareToTwitter","click .post-tag > .ico-tag-mentioned":"goToMentions","click .post-tag > .ico-tag-watched":"goToWatchlist","click .more-reply":"moreReply","click .show-reply":"showReply","click .show-reshare":"showReshare","click .show-share":"showShare","click .btn-send-gift":"showGift","mouseleave .post":"hidePostOptionsMenu","click .add_friend":"addFriend"},addFriend:function(a){if(a.preventDefault(),!b(".follow",a.currentTarget).hasClass("disabled")){b(".follow",a.currentTarget).addClass("disabled");var c=this.model.get("author"),d=parseInt(c.id,10),e=c.username;return b.ajax({type:"post",cache:!1,dataType:"json",url:m.urls.miniblog_api_url+"/follow/"+d,success:function(c){c=n.parse_ajax_response(c),c.error?(n.show_error(n.translate(c.error,e)),b(".follow",a.currentTarget).removeClass("disabled")):n.show_success(n.translate(c.success,e))},error:function(){n.show_error(n.translate("user|follow_error",e)),b(".follow",a.currentTarget).removeClass("disabled")}})}},goToMentions:function(){c.history.navigate("mentions",{trigger:!0})},goToWatchlist:function(){c.history.navigate("watchlist",{trigger:!0})},hidePostOptionsMenu:function(){var a=b(".post-options",this.$el);a.hasClass("open")&&a.removeClass("open")},watchPost:function(a){if(a.preventDefault(),n.is_logged_in()){var c,d=b(a.currentTarget);c=d.hasClass("watched")?this.model.unwatchPost():this.model.watchPost(),c.done(function(a){a=n.parse_ajax_response(a),a&&(d.hasClass("watched")?d.attr("title",n.translate("post|favourite")):d.attr("title",n.translate("post|unfavourite")),d.toggleClass("watch watched"),b('span[class*="icon-wb_fav"]',d).toggleClass("icon-wb_favourite icon-wb_like"))})}},reportPost:function(a){if(a.preventDefault(),n.is_logged_in()&&window.confirm(n.translate("post|confirm_report"))){var c,d=b(a.currentTarget);if(d.hasClass("reported"))return;c=this.model.reportPost(),c.done(function(a){a=n.parse_ajax_response(a),a.error?n.show_error(n.translate("post|error_report")):(d.text(n.translate("common|reported")),n.show_success(n.translate("post|success_report")),d.addClass("reported").fadeOut())})}},deletePost:function(a){if(a.preventDefault(),n.is_logged_in()&&window.confirm(n.translate("post|confirm_delete"))){var c=this,d=this.model.deletePost();d.done(function(a){a=n.parse_ajax_response(a),a?(n.show_success(n.translate("post|success_delete")),b(c.$el).fadeOut()):n.show_error(n.translate("post|error_delete"))})}},emailPost:function(a){a.preventDefault();var c=this,d=b(".to",this.$el).val();if(0===d.length)return void n.show_error(n.translate("email|empty_email"));var e={to:d.split(","),subject:b('input[name="form_subject"]',this.$el).val(),body:b('textarea[name="form_body"]',this.$el).val(),post_id:c.model.get("id")},f=b.ajax({type:"post",contentType:"application/json",data:b.toJSON(e),url:n.format(m.urls.email_post,c.model.get("id"))});f.done(function(a){a=n.parse_ajax_response(a),"ok"===a?n.show_success(n.translate("post|success_email_send",d)):n.show_error(n.translate("post|error_email_send",d)),b('input[name="email_post"]',c.$el).prop("disabled",!0),b(".to",c.$el).tagit("removeAll"),b(".share-to-email-modal",c.$el).modal("hide")}),f.fail(function(a,b,c){n.show_error(c)})},selectPostPermalink:function(a){a.preventDefault(),b(a.currentTarget).select()},shareToFacebook:function(a){a.preventDefault(),this._openPopupWindow("http://www.facebook.com/sharer.php?u="+this.model.get("permalink"))},shareToTwitter:function(a){a.preventDefault();var b=this.model.get("body_snippet")+". By @"+this.model.get("author").username,c="https://twitter.com/share?via=migmehq&url="+this.model.get("permalink")+"&text="+b;this._openPopupWindow(c)},setReplyPermission:function(a){if(a.preventDefault(),n.is_logged_in()){var c,d=this,e=b(a.currentTarget);c=e.hasClass("lock")?this.model.setReplyPermission(1):this.model.setReplyPermission(0),b(".response-add",this.$el).show(),c.done(function(a){a=n.parse_ajax_response(a),a&&(e.hasClass("lock")?(d.hideReponseBox(),e.text(n.translate("common|unlock"))):(d.showReponseBox(),e.text(n.translate("common|lock"))),e.toggleClass("lock unlock"))})}},moreReply:function(a){a.preventDefault(),b(".more-reply",this.$el).attr("href",this.model.get("permalink"))},showReply:function(a){a.preventDefault(),b(".post-footer",this.$el).find(".post-reaction.post-reaction-active").removeClass("post-reaction-active"),this.postboxReply.show(new i({collapsible:!1,originality:2,parent_post:this.model})),this.postReplies.show(new k({collection:this.model.getReplies()})),b(".reply",this.$el).show(),b(".post-replies-pane",this.$el).is(":visible")?(b("html, body").animate({scrollTop:this.postboxReply.$el.offset().top-b(window).height()/2}),b(".post-responses .postbox-textarea",this.$el).focus()):(b(a.currentTarget).parent(".post-reaction").addClass("post-reaction-active"),b(".post-responses-row",this.$el).show(),b(".post-responses",this.$el).show(),b(".post-responses .postbox-textarea",this.$el).focus(),b(".post-replies-pane",this.$el).show(),b(".post-reshares-pane",this.$el).hide())},showReshare:function(a){a.preventDefault(),b(".post-footer",this.$el).find(".post-reaction.post-reaction-active").removeClass("post-reaction-active");var c=b("#sharebox-modal"),d=c.data("shareModalViewObject"),e=d.getPostbox();e.setToReshare(this.model),c.modal("show")},showShare:function(c){null!==c&&c.preventDefault(),b(".post-footer",this.$el).find(".post-reaction.post-reaction-active").removeClass("post-reaction-active"),console.warn(this.model);var d={},e=this.model.data.mimeType;if(a.isObject(this.model.data.mimeData))d=this.model.data.mimeData;else if(a.isString(this.model.data.mimeData))try{d=b.parseJSON(this.model.data.mimeData),d=d[e]}catch(f){}o.getMimeType(e)==o.MIMETYPE.ACHIEVEMENT&&(this.model.mimetype={onlyForPreviewing:!0,mimeType:e,mimeData:d}),n.show_share_dialog("post",this.model);var g=new i({collapsible:!1,originality:3,parent_post:this.model});this.postboxReshare.show(g),console.warn(this.model.getReshares(),this.model),this.postReshares.show(new l({collection:this.model.getReshares()}))},showGift:function(a){null!==a&&a.preventDefault(),n.show_gift_selection("post",this.model)},showReponseBox:function(){b(".postbox-reply",this.$el).show(),b(".postbox-repost",this.$el).show(),b(".response-lock-message",this.$el).hide()},hideReponseBox:function(){b(".postbox-reply",this.$el).hide(),b(".postbox-repost",this.$el).hide(),b(".response-lock-message",this.$el).show()}});return r}),define("hbs!modules/template/homefeed/homefeed-error",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<p class="text-center"><img src="'+j((f=c.getUrl||b&&b.getUrl,g={hash:{},data:e},f?f.call(b,"jsclient",g):i.call(b,"getUrl","jsclient",g)))+'/app/images/mig.me/migbot-error.png" width="200" height="200" alt="" title="" /></p>\n<p>Dear Users,</p>\n<p>We are upgrading our miniBlog and the service is temporary not available.</p>\n<p>Please bear with us, it will be up and available soon!</p>\n<p>Thank you.</p>'})}),define("modules/view/homefeed/homefeed_post_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","modules/view/common/mig33_views","marionette_handlebars","modules/common/config","modules/common/utility","modules/view/homefeed/homefeed_post_item_view","hbs!modules/template/homefeed/homefeed-error","modules/template/helpers/general_helpers","modules/template/helpers/post_helpers","fancybox","jquery.readmore"],function(a,b,c,d,e,f,g,h,i,j,k){var l=d.compile('{{#compare type "homefeed"}}{{translate "homefeed|empty_homefeed"}}{{/compare}}{{#compare type "userfeed"}}{{#compare user.num_posts 0}}{{translate "homefeed|empty_userfeed" user.username}}{{else}}{{#compare user.privacy.feed 2}}{{translate "homefeed|userfeed_is_private" user.username}}{{else}}{{translate "homefeed|empty_userfeed" user.username}}{{/compare}}{{/compare}}{{/compare}}{{#compare type "mentions"}}{{translate "homefeed|empty_mentions"}}{{/compare}}{{#compare type "watchlist"}}{{translate "homefeed|empty_watchlist"}}{{/compare}}'),m=d.compile('{{translate "common|loading"}}...'),n=e.ItemView.extend({template:{type:"handlebars",template:l},className:"empty"}),o=e.ItemView.extend({template:{type:"handlebars",template:m},className:"loading"}),p=e.ItemView.extend({template:{type:"handlebars",template:k}}),q=f.CollectionView.extend({itemView:j,emptyView:n,errorView:p,loadingView:o,getType:function(){return this.type},onRender:function(){i.createFancyBox(b(".fancybox",this.$el))},appendHtml:function(a,b,c){0===c?a.$el.prepend(b.el):a.$el.append(b.el)},initialize:function(a){this.type=a.type;var c=this;this.on("render",function(){b(window).on("scroll",function(a){c.more()}),b(window).on("scroll",function(a){c.impression()}),c.impression()}),this.on("close",function(){b(window).off("scroll")})},prevScrollY:0,page:1,impression:function(){var a=this;clearTimeout(b.data(this,"idleTimer")),b.data(this,"idleTimer",setTimeout(function(){var c=b(window).scrollTop()-b(".navbar").height(),d=b(window).scrollTop()+b(window).height(),e=a.$el.offset().top,f=a.$el.children();if("undefined"==typeof a.$el.children().last().data("height")){var g=e;for(var h in f)if(isNaN(parseInt(h,10))!==!0){var j=f[h];b(j).data("height",b(j).height()),b(j).data("topPos",g),g+=b(j).height(),b(j).data("bottomPos",g)}}var k=[];for(var l in f)if(isNaN(parseInt(l,10))!==!0){var m=f[l];b(m).data("topPos")>c&&b(m).data("topPos")<d&&(0!=l&&k.push({post_id:f[l-1].id,author:b(f[l-1]).data("PostItemViewObject").model.get("author").alias}),k.push({post_id:m.id,author:b(m).data("PostItemViewObject").model.get("author").alias}))}k.forEach(function(a){var b=i.format("/impression/{0}/post/{1}",a.author,a.post_id);i.send_pageTrack_to_ga(b)})},2e3))},more:function(){var a=b(window).scrollTop()+b(window).height(),c=b(window).get(0).scrollHeight;c||(c=b(document).height()),a>=c-h.variable.infinitescroll_height&&this.prevScrollY<a&&this.trigger(this.type+":more",++this.page),this.prevScrollY=a}});return q}),define("hbs!modules/template/discover/discover-hashtag-layout",["handlebars"],function(a){return a.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},'<div class="hashtag-filter content"></div>\n<div class="hashtag-content"></div>'})}),define("modules/model/discover/hashtag_model",["underscore","backbone","modules/mig33_app","modules/common/config","modules/common/utility"],function(a,b){var c=b.Model.extend({parse:function(a){for(var b in a)return a[b].name=a[b].name.substr(1),a[b];return a[0]}});return c}),define("modules/model/discover/hashtag_collection",["underscore","modules/model/common/mig33_collection","modules/mig33_app","modules/common/config","modules/common/utility","modules/model/discover/hashtag_model"],function(a,b,c,d,e,f){var g=b.extend({countryId:0,subType:"1D",model:f,url:function(){return d.urls.hashtags+"?size="+this.limit+"&offset="+(this.currentPage-1)*this.limit+"&countryId="+this.countryId+"&subtype="+this.subType},parse:function(b){return a.isUndefined(b.data)||null===b.data||a.isUndefined(b.data.search.result)?[]:b.data.search.result},setCountryId:function(a){this.countryId=a},setSubType:function(a){this.subType=a}});return g}),define("hbs!modules/template/discover/hashtag-list",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i="function",j=this.escapeExpression;return h+='<a href="/search/topics/?query=',(g=c.name)?f=g.call(b,{hash:{},data:e}):(g=b&&b.name,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'" class="hashtag">#',(g=c.name)?f=g.call(b,{hash:{},data:e}):(g=b&&b.name,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+"</a>"})}),define("modules/view/discover/hashtag_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/discover/hashtag-list","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g){var h=e.ItemView.extend({template:{type:"handlebars",template:g},tagName:"li"});return h}),define("hbs!modules/template/discover/hashtag-collection",["handlebars"],function(a){return a.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},'<ul class="list-inline hashtag-list"></ul>'})}),define("modules/view/discover/hashtag_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/view/discover/hashtag_item_view","hbs!modules/template/discover/hashtag-collection","modules/view/common/mig33_views","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j,k){var l=d.compile('{{translate "discover|empty_hashtag"}}'),m=d.compile('{{translate "common|loading"}}...'),n=e.ItemView.extend({template:{type:"handlebars",template:l},tagName:"li",className:"empty"}),o=e.ItemView.extend({template:{type:"handlebars",template:m},tagName:"li",className:"loading"}),p=k.CompositeView.extend({itemView:i,emptyView:n,loadingView:o,itemViewContainer:".hashtag-list",template:{type:"handlebars",template:j},events:{"click .hashtag-more a":"more"},showMore:function(){b(".hashtag-more",this.$el).show()},more:function(a){a.preventDefault(),b(".hashtag-list",this.$el).hasClass("hashtag-list-more")?(b(".hashtag-list",this.$el).removeClass("hashtag-list-more"),b(".hashtag-more a",this.$el).text(h.translate("common|more"))):(b(".hashtag-list",this.$el).addClass("hashtag-list-more"),b(".hashtag-more a",this.$el).text(h.translate("common|less")))}});return p}),define("modules/model/discover/hashtag_country_model",["underscore","backbone","modules/mig33_app","modules/common/config","modules/common/utility"],function(a,b){var c=b.Model.extend({});return c}),define("modules/model/discover/hashtag_country_collection",["underscore","modules/model/common/mig33_collection","modules/mig33_app","modules/common/config","modules/common/utility","modules/model/discover/hashtag_country_model"],function(a,b,c,d,e,f){var g=b.extend({model:f,url:function(){return d.urls.hashtags_country},parse:function(b){return a.isUndefined(b.data)||null===b.data?[]:b.data},comparator:function(a){return a.get("id")}});return g}),define("hbs!modules/template/discover/hashtag-country-list",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i="function",j=this.escapeExpression;return h+='<a href="#">',(g=c.name)?f=g.call(b,{hash:{},data:e}):(g=b&&b.name,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+"</a>"})}),define("modules/view/discover/hashtag_country_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/discover/hashtag-country-list","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers","modules/template/helpers/user_helpers"],function(a,b,c,d,e,f,g,h,i){var j=e.ItemView.extend({template:{type:"handlebars",template:g},tagName:"li",triggers:{"click a":"hashtag:country"}});return j}),define("hbs!modules/template/discover/hashtag-country-collection",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="btn-group btn-block hidden">\n	<button type="button" class="btn btn-xs btn-white btn-block dropdown-toggle btn-hashtag-countries" data-toggle="dropdown">\n		<span class="hashtag-selected-country">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"common|all_countries",g):i.call(b,"translate","common|all_countries",g)))+'</span>\n		&nbsp; <span class="caret caret-hashtag-countries"></span>\n	</button>\n	<ul class="dropdown-menu" role="menu"></ul>\n</div>'})}),define("modules/view/discover/hashtag_country_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/view/discover/hashtag_country_item_view","hbs!modules/template/discover/hashtag-country-collection","modules/view/common/mig33_views","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j,k){var l=d.compile('{{translate "common|empty_countries"}}'),m=d.compile('{{translate "common|loading"}}...'),n=e.ItemView.extend({template:{type:"handlebars",template:l},tagName:"li",className:"empty"}),o=e.ItemView.extend({template:{type:"handlebars",template:m},tagName:"li",className:"loading"}),p=k.CompositeView.extend({itemView:i,emptyView:n,loadingView:o,itemViewContainer:".dropdown-menu",template:{type:"handlebars",template:j},initialize:function(a){var c=this;this.on("itemview:hashtag:country",function(a,d){b(".dropdown-toggle",c.$el).dropdown("toggle"),c.selectedCountry(d.model.get("name")),c.trigger("compositeview:hashtag:country",d)})},selectedCountry:function(a){b(".hashtag-selected-country").text(a)}});return p}),define("modules/view/discover/discover_hashtag_layout",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/common/session_user","hbs!modules/template/discover/discover-hashtag-layout","modules/model/discover/hashtag_collection","modules/view/discover/hashtag_collection_view","modules/model/discover/hashtag_country_collection","modules/view/discover/hashtag_country_collection_view","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=e.Layout.extend({hashtagCollection:[],hashtagCountriesCollection:[],template:{type:"handlebars",template:j},regions:{filter:".hashtag-filter",content:".hashtag-content"},initialize:function(){this.hashtagCollection=new k,this.hashtagCollection.setLimit(g.recommendation.hashtags.limit),this.hashtagCollection.fetch(),this.hashtagCountriesCollection=new m,this.hashtagCountriesCollection.add(new c.Model({id:-1,name:h.translate("common|all_countries")}))},onRender:function(){var a=this,b=new n({collection:this.hashtagCountriesCollection}),c=new l({collection:this.hashtagCollection});b.on("compositeview:hashtag:country",function(b){a.hashtagCollection.setCountryId(b.model.get("id")),a.hashtagCollection.fetch()}),this.hashtagCollection.on("fetch:done",function(){a.hashtagCollection.length>g.recommendation.hashtags.limit/2&&c.showMore()}),this.hashtagCountriesCollection.on("fetch:done",function(){a.hashtagCountriesCollection.each(function(a){a.get("name")===i.getInstance().get("country")&&b.selectedCountry(a.get("name"))})}),this.filter.show(b),this.content.show(c)}});return o}),define("hbs!modules/template/discover/discover-user-list",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f,h="";return h+="\n	",e=c.ifShowRecUsers||a&&a.ifShowRecUsers,f={hash:{},inverse:Y.noop,fn:Y.program(2,g,b),data:b},d=e?e.call(a,(d=a&&a.recommendedUser,null==d||d===!1?d:d._relationship),f):X.call(a,"ifShowRecUsers",(d=a&&a.recommendedUser,null==d||d===!1?d:d._relationship),f),(d||0===d)&&(h+=d),h+="\n"}function g(a,b){var d,e,f,g="";return g+='\n		<div class="row entry">\n			<div class="col-xs-2">\n				<div class="user-avatar">\n					<a href="'+W((e=c.getProfileUrl||a&&a.getProfileUrl,f={hash:{},data:b},e?e.call(a,(d=a&&a.recommendedUser,null==d||d===!1?d:d.username),f):X.call(a,"getProfileUrl",(d=a&&a.recommendedUser,null==d||d===!1?d:d.username),f)))+'" class="profile-hovercard" data-username="'+W((d=a&&a.recommendedUser,d=null==d||d===!1?d:d.username,typeof d===V?d.apply(a):d))+'">\n						<img src="'+W((e=c.getDisplayPictureUrl||a&&a.getDisplayPictureUrl,f={hash:{},data:b},e?e.call(a,(d=a&&a.recommendedUser,null==d||d===!1?d:d.username),(d=a&&a.recommendedUser,null==d||d===!1?d:d.displayPictureType),64,64,f):X.call(a,"getDisplayPictureUrl",(d=a&&a.recommendedUser,null==d||d===!1?d:d.username),(d=a&&a.recommendedUser,null==d||d===!1?d:d.displayPictureType),64,64,f)))+'" width="64" height="64" class="img-circle" />\n					</a>\n				</div>\n			</div>\n			<div class="col-xs-10 no-padding-left">\n				<div class="row">\n					<div class="col-xs-8 no-padding-left">\n						<div class="user-details">\n							<div class="user-username">\n								<a href="'+W((e=c.getProfileUrl||a&&a.getProfileUrl,f={hash:{},data:b},e?e.call(a,(d=a&&a.recommendedUser,null==d||d===!1?d:d.username),f):X.call(a,"getProfileUrl",(d=a&&a.recommendedUser,null==d||d===!1?d:d.username),f)))+'" class="profile-hovercard" data-username="'+W((d=a&&a.recommendedUser,d=null==d||d===!1?d:d.username,typeof d===V?d.apply(a):d))+'">'+W((d=a&&a.recommendedUser,d=null==d||d===!1?d:d.username,typeof d===V?d.apply(a):d))+'</a>\n								<span class="user-label">'+W((e=c.userGetLabels||a&&a.userGetLabels,f={hash:{},data:b},e?e.call(a,a&&a.recommendedUser,f):X.call(a,"userGetLabels",a&&a.recommendedUser,f)))+'</span>\n								&nbsp;\n								<span class="user-name font-size-12">',e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:Y.noop,fn:Y.program(3,h,b),data:b},d=e?e.call(a,(d=a&&a.recommendedUser,null==d||d===!1?d:d.firstName),f):X.call(a,"isNotEmpty",(d=a&&a.recommendedUser,null==d||d===!1?d:d.firstName),f),(d||0===d)&&(g+=d),e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:Y.noop,fn:Y.program(5,i,b),data:b},d=e?e.call(a,(d=a&&a.recommendedUser,null==d||d===!1?d:d.lastName),f):X.call(a,"isNotEmpty",(d=a&&a.recommendedUser,null==d||d===!1?d:d.lastName),f),(d||0===d)&&(g+=d),g+='</span>\n							</div>\n						</div>\n					</div>\n					<div class="col-xs-4" style="padding-right 0px;">\n						<div class="user-actions text-right">\n							',f={hash:{},inverse:Y.noop,fn:Y.program(7,j,b),data:b},(e=c.ifLoggedIn)?d=e.call(a,f):(e=a&&a.ifLoggedIn,d=typeof e===V?e.call(a,f):e),
c.ifLoggedIn||(d=Z.call(a,d,{hash:{},inverse:Y.noop,fn:Y.program(7,j,b),data:b})),(d||0===d)&&(g+=d),g+='\n						</div>\n					</div>\n				</div>\n				<div class="row">\n					<div class="col-xs-12 no-padding-left">\n						<div class="user-about font-size-12">\n							<span class="user-miglevel">'+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|miglevel_with_level",(d=a&&a.recommendedUser,null==d||d===!1?d:d.migLevel),f):X.call(a,"translate","user|miglevel_with_level",(d=a&&a.recommendedUser,null==d||d===!1?d:d.migLevel),f)))+'</span>\n							&nbsp;\n							<span class="user-profile">\n								',e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:Y.noop,fn:Y.program(12,m,b),data:b},d=e?e.call(a,(d=a&&a.recommendedUser,null==d||d===!1?d:d.country),f):X.call(a,"isNotEmpty",(d=a&&a.recommendedUser,null==d||d===!1?d:d.country),f),(d||0===d)&&(g+=d),g+="\n								",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:Y.noop,fn:Y.program(14,n,b),data:b},d=e?e.call(a,(d=a&&a.recommendedUser,null==d||d===!1?d:d.gender),f):X.call(a,"isNotEmpty",(d=a&&a.recommendedUser,null==d||d===!1?d:d.gender),f),(d||0===d)&&(g+=d),g+="\n								",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:Y.noop,fn:Y.program(16,o,b),data:b},d=e?e.call(a,(d=a&&a.recommendedUser,null==d||d===!1?d:d.dateOfBirth),f):X.call(a,"isNotEmpty",(d=a&&a.recommendedUser,null==d||d===!1?d:d.dateOfBirth),f),(d||0===d)&&(g+=d),g+='\n							</span>\n						</div>\n						<div class="user-reason font-size-12">\n							'+W((e=c.removeEmpty||a&&a.removeEmpty,f={hash:{},data:b},e?e.call(a,a&&a.reason,f):X.call(a,"removeEmpty",a&&a.reason,f)))+'\n						</div>\n						<div class="user-description font-size-12">\n							',d=c["if"].call(a,(d=a&&a.recommendedUser,d=null==d||d===!1?d:d.label,null==d||d===!1?d:d.isVerified),{hash:{},inverse:Y.program(22,s,b),fn:Y.program(19,q,b),data:b}),(d||0===d)&&(g+=d),g+='\n						</div>\n						<div class="user-stats">\n							<ul class="list-inline">\n								<li class="user-stat">\n									<a href="'+W((e=c.getProfileUrl||a&&a.getProfileUrl,f={hash:{},data:b},e?e.call(a,(d=a&&a.recommendedUser,null==d||d===!1?d:d.username),f):X.call(a,"getProfileUrl",(d=a&&a.recommendedUser,null==d||d===!1?d:d.username),f)))+'" title="'+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"homefeed|posts",f):X.call(a,"translate","homefeed|posts",f)))+'"><span class="icon-wb_searchpost"></span>&nbsp;<span class="count">'+W((e=c.roundNumber||a&&a.roundNumber,f={hash:{},data:b},e?e.call(a,(d=a&&a.recommendedUser,null==d||d===!1?d:d.numOfPosts),5e3,f):X.call(a,"roundNumber",(d=a&&a.recommendedUser,null==d||d===!1?d:d.numOfPosts),5e3,f)))+'</span></a>\n								</li>\n								<li class="user-stat">\n									<a href="'+W((e=c.getProfileUrl||a&&a.getProfileUrl,f={hash:{},data:b},e?e.call(a,(d=a&&a.recommendedUser,null==d||d===!1?d:d.username),f):X.call(a,"getProfileUrl",(d=a&&a.recommendedUser,null==d||d===!1?d:d.username),f)))+'/fans" title="'+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|fans",f):X.call(a,"translate","user|fans",f)))+'"><span class="icon-wb_friend"></span>&nbsp;<span class="count">'+W((e=c.roundNumber||a&&a.roundNumber,f={hash:{},data:b},e?e.call(a,(d=a&&a.recommendedUser,null==d||d===!1?d:d.numOfFollowers),5e3,f):X.call(a,"roundNumber",(d=a&&a.recommendedUser,null==d||d===!1?d:d.numOfFollowers),5e3,f)))+'</span></a>\n								</li>\n								<li class="user-stat">\n									<a href="'+W((e=c.getProfileUrl||a&&a.getProfileUrl,f={hash:{},data:b},e?e.call(a,(d=a&&a.recommendedUser,null==d||d===!1?d:d.username),f):X.call(a,"getProfileUrl",(d=a&&a.recommendedUser,null==d||d===!1?d:d.username),f)))+'/gifts" title="'+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|gifts",f):X.call(a,"translate","user|gifts",f)))+'"><span class="icon-wb_gift"></span>&nbsp;<span class="count">'+W((e=c.roundNumber||a&&a.roundNumber,f={hash:{},data:b},e?e.call(a,(d=a&&a.recommendedUser,null==d||d===!1?d:d.numOfGiftsReceived),5e3,f):X.call(a,"roundNumber",(d=a&&a.recommendedUser,null==d||d===!1?d:d.numOfGiftsReceived),5e3,f)))+'</span></a>\n								</li>\n								<li class="user-stat">\n									<a href="'+W((e=c.getProfileUrl||a&&a.getProfileUrl,f={hash:{},data:b},e?e.call(a,(d=a&&a.recommendedUser,null==d||d===!1?d:d.username),f):X.call(a,"getProfileUrl",(d=a&&a.recommendedUser,null==d||d===!1?d:d.username),f)))+'/badges" title="'+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|badges",f):X.call(a,"translate","user|badges",f)))+'"><span class="icon-wb_badge"></span>&nbsp;<span class="count">'+W((e=c.roundNumber||a&&a.roundNumber,f={hash:{},data:b},e?e.call(a,(d=a&&a.recommendedUser,null==d||d===!1?d:d.numOfBadgesUnlocked),5e3,f):X.call(a,"roundNumber",(d=a&&a.recommendedUser,null==d||d===!1?d:d.numOfBadgesUnlocked),5e3,f)))+"</span></a>\n								</li>\n							</ul>\n						</div>\n					</div>\n				</div>\n			</div>\n	"}function h(a,b){var c,d="";return d+=W((c=a&&a.recommendedUser,c=null==c||c===!1?c:c.firstName,typeof c===V?c.apply(a):c))+" "}function i(a,b){var c;return W((c=a&&a.recommendedUser,c=null==c||c===!1?c:c.lastName,typeof c===V?c.apply(a):c))}function j(a,b){var d,e,f,g="";return g+='\n								<button class="btn btn-xs btn-default chat profile-button hidden" type="button">\n									<span class="icon-wb_chatbubble"></span>&nbsp;'+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"chat|chat",f):X.call(a,"translate","chat|chat",f)))+'\n								</button>\n								<a href="#"\n								   class="btn btn-xs btn-following following profile-button hidden"\n								   data-toggle="clickover"\n								   data-placement="top"\n								   data-html="true"\n								   data-title="'+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|be_friends_to_chat",f):X.call(a,"translate","user|be_friends_to_chat",f)))+'"\n								   data-content="'+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|sweeten_the_invite",f):X.call(a,"translate","user|sweeten_the_invite",f)))+"<div class='padding-4px'></div><a href='/store/category/1/new/?username=",(e=c.username)?d=e.call(a,{hash:{},data:b}):(e=a&&a.username,d=typeof e===V?e.call(a,{hash:{},data:b}):e),g+=W(d)+"' class='btn btn-xs btn-default'>"+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|send_gift",f):X.call(a,"translate","user|send_gift",f)))+'</a>"\n										>\n									<span class="icon-wb_fanof"></span>&nbsp;'+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|i_m_a_fan",f):X.call(a,"translate","user|i_m_a_fan",f)))+'\n								</a>\n								<button class="btn btn-xs btn-following follow-pending profile-button hidden" type="button">\n									<span class="icon-wb_recent"></span>&nbsp;'+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|pending",f):X.call(a,"translate","user|pending",f)))+'\n								</button>\n								<button class="btn btn-xs btn-default follow profile-button hidden" type="button">\n									<span class="icon-wb_add"></span>&nbsp;'+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|add",f):X.call(a,"translate","user|add",f)))+'\n								</button>\n								<div class="btn-group">\n									<a class="btn btn-xs btn-default dropdown-toggle" data-toggle="dropdown" href="#">\n										<span class="icon-wb_more"></span>\n									</a>\n									<ul class="dropdown-menu text-left">\n										<li>\n											<a href="#" class="mention" title="'+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|mention",f):X.call(a,"translate","user|mention",f)))+'">'+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|mention",f):X.call(a,"translate","user|mention",f)))+'</a>\n										</li>\n										<li>\n											<a href="#" class="send-gift" title="'+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|send_gift",f):X.call(a,"translate","user|send_gift",f)))+'">'+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|send_gift",f):X.call(a,"translate","user|send_gift",f)))+'</a>\n										</li>\n										<li>\n											<a href="/sites/ajax/account/transfer_credit?win_id=account-window&recipient_username=',(e=c.username)?d=e.call(a,{hash:{},data:b}):(e=a&&a.username,d=typeof e===V?e.call(a,{hash:{},data:b}):e),g+=W(d)+'" class="transfer-credit" title="'+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|transfer_credit",f):X.call(a,"translate","user|transfer_credit",f)))+'">'+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|transfer_credit",f):X.call(a,"translate","user|transfer_credit",f)))+'</a>\n										</li>\n										<li>\n											<a href="/sites/ajax/report/report_abuse?win_id=report_abuse&type=2&offender=',(e=c.username)?d=e.call(a,{hash:{},data:b}):(e=a&&a.username,d=typeof e===V?e.call(a,{hash:{},data:b}):e),g+=W(d)+'&subject=Profile%20Abuse" title="'+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"common|report",f):X.call(a,"translate","common|report",f)))+'">'+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"common|report",f):X.call(a,"translate","common|report",f)))+"</a>\n										</li>\n										",d=c["if"].call(a,(d=a&&a.relationship,null==d||d===!1?d:d.is_blocked_by),{hash:{},inverse:Y.program(10,l,b),fn:Y.program(8,k,b),data:b}),(d||0===d)&&(g+=d),g+='\n										<li><a href="#" onclick="return false;" title="'+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|remove_as_friend",f):X.call(a,"translate","user|remove_as_friend",f)))+'" class="unfollow-link hidden unfollow">'+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|remove_as_friend",f):X.call(a,"translate","user|remove_as_friend",f)))+"</a>\n										</li>\n									</ul>\n								</div>\n							"}function k(a,b){var d,e,f="";return f+='\n											<li><a href="#" onclick="return false;" title="'+W((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"user|unblock",e):X.call(a,"translate","user|unblock",e)))+'" class="user-unblock">'+W((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"user|unblock",e):X.call(a,"translate","user|unblock",e)))+"</a></li>\n										"}function l(a,b){var d,e,f="";return f+='\n											<li><a href="#" onclick="return false;" title="'+W((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"user|block",e):X.call(a,"translate","user|block",e)))+'" class="user-block">'+W((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"user|block",e):X.call(a,"translate","user|block",e)))+"</a></li>\n										"}function m(a,b){var c;return W((c=a&&a.recommendedUser,c=null==c||c===!1?c:c.country,typeof c===V?c.apply(a):c))}function n(a,b){var d,e,f="";return f+=", "+W((d=c.userGetGender||a&&a.userGetGender,e={hash:{},data:b},d?d.call(a,a&&a.recommendedUser,e):X.call(a,"userGetGender",a&&a.recommendedUser,e)))}function o(a,b){var d,e,f;return e=c.ifUserCanShowAge||a&&a.ifUserCanShowAge,f={hash:{},inverse:Y.noop,fn:Y.program(17,p,b),data:b},d=e?e.call(a,a&&a.recommendedUser,f):X.call(a,"ifUserCanShowAge",a&&a.recommendedUser,f),d||0===d?d:""}function p(a,b){var d,e,f="";return f+=", "+W((d=c.userGetAge||a&&a.userGetAge,e={hash:{},data:b},d?d.call(a,a&&a.recommendedUser,e):X.call(a,"userGetAge",a&&a.recommendedUser,e)))}function q(a,b){var d,e,f,g="";return g+="\n								",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:Y.noop,fn:Y.program(20,r,b),data:b},d=e?e.call(a,(d=a&&a.recommendedUser,null==d||d===!1?d:d.aboutMeVerified),f):X.call(a,"isNotEmpty",(d=a&&a.recommendedUser,null==d||d===!1?d:d.aboutMeVerified),f),(d||0===d)&&(g+=d),g+="\n							"}function r(a,b){var c,d="";return d+="\n									",c=a&&a.recommendedUser,c=null==c||c===!1?c:c.about_me_verified,c=typeof c===V?c.apply(a):c,(c||0===c)&&(d+=c),d+="\n								"}function s(a,b){var d,e,f,g="";return g+="\n								",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:Y.noop,fn:Y.program(23,t,b),data:b},d=e?e.call(a,(d=a&&a.recommendedUser,null==d||d===!1?d:d.about_me),f):X.call(a,"isNotEmpty",(d=a&&a.recommendedUser,null==d||d===!1?d:d.about_me),f),(d||0===d)&&(g+=d),g+="\n							"}function t(a,b){var c,d="";return d+="\n									",c=a&&a.recommendedUser,c=null==c||c===!1?c:c.about_me,c=typeof c===V?c.apply(a):c,(c||0===c)&&(d+=c),d+="\n								"}function u(a,b){var d,e,f,g="";return g+='\n	<div class="row">\n		<div class="col-xs-2">\n			<div class="user-avatar">\n				<a href="',(e=c.personalized_url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.personalized_url,d=typeof e===V?e.call(a,{hash:{},data:b}):e),g+=W(d)+'" class="profile-hovercard" data-username="',(e=c.username)?d=e.call(a,{hash:{},data:b}):(e=a&&a.username,d=typeof e===V?e.call(a,{hash:{},data:b}):e),g+=W(d)+'">\n					<img src="'+W((e=c.userGetDisplayPictureUrl||a&&a.userGetDisplayPictureUrl,f={hash:{},data:b},e?e.call(a,64,64,a,f):X.call(a,"userGetDisplayPictureUrl",64,64,a,f)))+'" width="64" height="64" class="img-circle" />\n				</a>\n			</div>\n		</div>\n		<div class="col-xs-10 no-padding-left">\n			<div class="row">\n				<div class="col-xs-8 no-padding-left">\n					<div class="user-details">\n						<div class="user-username">\n							<a href="',(e=c.personalized_url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.personalized_url,d=typeof e===V?e.call(a,{hash:{},data:b}):e),g+=W(d)+'" class="profile-hovercard" data-username="',(e=c.username)?d=e.call(a,{hash:{},data:b}):(e=a&&a.username,d=typeof e===V?e.call(a,{hash:{},data:b}):e),g+=W(d)+'">',(e=c.username)?d=e.call(a,{hash:{},data:b}):(e=a&&a.username,d=typeof e===V?e.call(a,{hash:{},data:b}):e),g+=W(d)+'</a>\n							<span class="user-label">'+W((e=c.userGetLabels||a&&a.userGetLabels,f={hash:{},data:b},e?e.call(a,a,f):X.call(a,"userGetLabels",a,f)))+'</span>\n							&nbsp;\n							<span class="user-name font-size-12">',e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:Y.noop,fn:Y.program(26,v,b),data:b},d=e?e.call(a,a&&a.first_name,f):X.call(a,"isNotEmpty",a&&a.first_name,f),(d||0===d)&&(g+=d),e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:Y.noop,fn:Y.program(28,w,b),data:b},d=e?e.call(a,a&&a.last_name,f):X.call(a,"isNotEmpty",a&&a.last_name,f),(d||0===d)&&(g+=d),g+='</span>\n						</div>\n					</div>\n				</div>\n				<div class="col-xs-4">\n					<div class="user-actions text-right">\n						',f={hash:{},inverse:Y.noop,fn:Y.program(30,x,b),data:b},(e=c.ifLoggedIn)?d=e.call(a,f):(e=a&&a.ifLoggedIn,d=typeof e===V?e.call(a,f):e),c.ifLoggedIn||(d=Z.call(a,d,{hash:{},inverse:Y.noop,fn:Y.program(30,x,b),data:b})),(d||0===d)&&(g+=d),g+='\n					</div>\n				</div>\n			</div>\n			<div class="row">\n				<div class="col-xs-12 no-padding-left">\n					<div class="user-about font-size-12">\n						<span class="user-miglevel">'+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|miglevel_with_level",a&&a.mig_level,f):X.call(a,"translate","user|miglevel_with_level",a&&a.mig_level,f)))+'</span>\n						&nbsp;\n						<span class="user-profile">\n							',e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:Y.noop,fn:Y.program(35,A,b),data:b},d=e?e.call(a,a&&a.country,f):X.call(a,"isNotEmpty",a&&a.country,f),(d||0===d)&&(g+=d),g+="\n							",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:Y.noop,fn:Y.program(37,B,b),data:b},d=e?e.call(a,a&&a.gender,f):X.call(a,"isNotEmpty",a&&a.gender,f),(d||0===d)&&(g+=d),g+="\n							",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:Y.noop,fn:Y.program(39,C,b),data:b},d=e?e.call(a,a&&a.date_of_birth,f):X.call(a,"isNotEmpty",a&&a.date_of_birth,f),(d||0===d)&&(g+=d),g+='\n						</span>\n					</div>\n					<div class="user-reason font-size-12">\n						',d=c["if"].call(a,(d=a&&a.relationship,null==d||d===!1?d:d.is_friend),{hash:{},inverse:Y.program(44,F,b),fn:Y.program(42,E,b),data:b}),(d||0===d)&&(g+=d),g+='\n					</div>\n					<div class="user-description font-size-12">\n						',d=c["if"].call(a,(d=a&&a.label,null==d||d===!1?d:d.verified),{hash:{},inverse:Y.program(63,S,b),fn:Y.program(60,Q,b),data:b}),(d||0===d)&&(g+=d),g+='\n					</div>\n					<div class="user-stats">\n						<ul class="list-inline">\n							<li class="user-stat">\n								<a href="',(e=c.personalized_url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.personalized_url,d=typeof e===V?e.call(a,{hash:{},data:b}):e),g+=W(d)+'" title="'+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"homefeed|posts",f):X.call(a,"translate","homefeed|posts",f)))+'"><span class="icon-wb_searchpost"></span>&nbsp;<span class="count">'+W((e=c.roundNumber||a&&a.roundNumber,f={hash:{},data:b},e?e.call(a,a&&a.num_posts,5e3,f):X.call(a,"roundNumber",a&&a.num_posts,5e3,f)))+'</span></a>\n							</li>\n							<li class="user-stat">\n								<a href="',(e=c.personalized_url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.personalized_url,d=typeof e===V?e.call(a,{hash:{},data:b}):e),g+=W(d)+'/fans" title="'+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|fans",f):X.call(a,"translate","user|fans",f)))+'"><span class="icon-wb_friend"></span>&nbsp;<span class="count">'+W((e=c.roundNumber||a&&a.roundNumber,f={hash:{},data:b},e?e.call(a,a&&a.num_followers,5e3,f):X.call(a,"roundNumber",a&&a.num_followers,5e3,f)))+'</span></a>\n							</li>\n							<li class="user-stat">\n								<a href="',(e=c.personalized_url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.personalized_url,d=typeof e===V?e.call(a,{hash:{},data:b}):e),g+=W(d)+'/gifts" title="'+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|gifts",f):X.call(a,"translate","user|gifts",f)))+'"><span class="icon-wb_gift"></span>&nbsp;<span class="count">'+W((e=c.roundNumber||a&&a.roundNumber,f={hash:{},data:b},e?e.call(a,a&&a.num_gifts_received,5e3,f):X.call(a,"roundNumber",a&&a.num_gifts_received,5e3,f)))+'</span></a>\n							</li>\n							<li class="user-stat">\n								<a href="',(e=c.personalized_url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.personalized_url,d=typeof e===V?e.call(a,{hash:{},data:b}):e),g+=W(d)+'/badges" title="'+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|badges",f):X.call(a,"translate","user|badges",f)))+'"><span class="icon-wb_badge"></span>&nbsp;<span class="count">'+W((e=c.roundNumber||a&&a.roundNumber,f={hash:{},data:b},e?e.call(a,a&&a.num_badges_unlocked,5e3,f):X.call(a,"roundNumber",a&&a.num_badges_unlocked,5e3,f)))+"</span></a>\n							</li>\n						</ul>\n					</div>\n				</div>\n			</div>\n		</div>\n	</div>\n"}function v(a,b){var d,e,f="";return(e=c.first_name)?d=e.call(a,{hash:{},data:b}):(e=a&&a.first_name,d=typeof e===V?e.call(a,{hash:{},data:b}):e),f+=W(d)+" "}function w(a,b){var d,e;return(e=c.last_name)?d=e.call(a,{hash:{},data:b}):(e=a&&a.last_name,d=typeof e===V?e.call(a,{hash:{},data:b}):e),W(d)}function x(a,b){var d,e="";return e+="\n							",d=c["if"].call(a,(d=a&&a.relationship,null==d||d===!1?d:d.is_self),{hash:{},inverse:Y.program(33,z,b),fn:Y.program(31,y,b),data:b}),(d||0===d)&&(e+=d),e+="\n						"}function y(a,b){return"\n							"}function z(a,b){var d,e,f,g="";return g+='\n								<button class="btn btn-xs btn-friends chat hidden" type="button">\n									<span class="icon-wb_friend"></span>&nbsp;'+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|friends",f):X.call(a,"translate","user|friends",f)))+'\n								</button>\n								<a href="#"\n								   class="btn btn-xs btn-following following hidden"\n								   data-toggle="clickover"\n								   data-placement="top"\n								   data-html="true"\n								   data-title="'+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|be_friends_to_chat",f):X.call(a,"translate","user|be_friends_to_chat",f)))+'"\n								   data-content="'+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|sweeten_the_invite",f):X.call(a,"translate","user|sweeten_the_invite",f)))+"<div class='padding-4px'></div><a href='/store/category/1/new/?username=",(e=c.username)?d=e.call(a,{hash:{},data:b}):(e=a&&a.username,d=typeof e===V?e.call(a,{hash:{},data:b}):e),g+=W(d)+"' class='btn btn-xs btn-default'>"+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|send_gift",f):X.call(a,"translate","user|send_gift",f)))+'</a>"\n								>\n									<span class="icon-wb_fanof"></span>&nbsp;'+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|i_m_a_fan",f):X.call(a,"translate","user|i_m_a_fan",f)))+'\n								</a>\n								<button class="btn btn-xs btn-following follow-pending hidden" type="button">\n									<span class="icon-wb_recent"></span>&nbsp;'+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|pending",f):X.call(a,"translate","user|pending",f)))+'\n								</button>\n								<button class="btn btn-xs btn-default follow hidden" type="button">\n									<span class="icon-wb_follow"></span>&nbsp;'+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|add",f):X.call(a,"translate","user|add",f)))+'\n								</button>\n								<div class="btn-group">\n									<a class="btn btn-xs btn-blank dropdown-toggle no-shadow" data-toggle="dropdown" href="#">\n										<span class="icon-wb_more"></span>\n									</a>\n									<ul class="dropdown-menu text-left">\n										<li>\n											<a href="#" class="unfollow-link unfollow hidden">'+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|remove_as_friend",f):X.call(a,"translate","user|remove_as_friend",f)))+'</a>\n										</li>\n										<li>\n											<a href="#" class="send-gift" title="'+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|send_gift",f):X.call(a,"translate","user|send_gift",f)))+'">'+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|send_gift",f):X.call(a,"translate","user|send_gift",f)))+'</a>\n										</li>\n										<li>\n											<a href="/sites/ajax/account/transfer_credit?win_id=account-window&recipient_username=',(e=c.username)?d=e.call(a,{hash:{},data:b}):(e=a&&a.username,d=typeof e===V?e.call(a,{hash:{},data:b}):e),g+=W(d)+'" class="transfer-credit" title="'+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|transfer_credit",f):X.call(a,"translate","user|transfer_credit",f)))+'">'+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|transfer_credit",f):X.call(a,"translate","user|transfer_credit",f)))+'</a>\n										</li>\n										<li>\n											<a href="/sites/ajax/report/report_abuse?win_id=report_abuse&type=2&offender=',(e=c.username)?d=e.call(a,{hash:{},data:b}):(e=a&&a.username,d=typeof e===V?e.call(a,{hash:{},data:b}):e),g+=W(d)+'&subject=Profile%20Abuse" title="'+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"common|report",f):X.call(a,"translate","common|report",f)))+'">'+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"common|report",f):X.call(a,"translate","common|report",f)))+"</a>\n										</li>\n									</ul>\n								</div>\n							"}function A(a,b){var d,e;return(e=c.country)?d=e.call(a,{hash:{},data:b}):(e=a&&a.country,d=typeof e===V?e.call(a,{hash:{},data:b}):e),W(d)}function B(a,b){var d,e,f="";return f+=", "+W((d=c.userGetGender||a&&a.userGetGender,e={hash:{},data:b},d?d.call(a,a,e):X.call(a,"userGetGender",a,e)))}function C(a,b){var d,e,f;return e=c.ifUserCanShowAge||a&&a.ifUserCanShowAge,f={hash:{},inverse:Y.noop,fn:Y.program(40,D,b),data:b},d=e?e.call(a,a,f):X.call(a,"ifUserCanShowAge",a,f),d||0===d?d:""}function D(a,b){var d,e,f="";return f+=", "+W((d=c.userGetAge||a&&a.userGetAge,e={hash:{},data:b},d?d.call(a,a,e):X.call(a,"userGetAge",a,e)))}function E(a,b){var d,e,f="";return f+="\n							"+W((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"discover|might_be_your_friend",e):X.call(a,"translate","discover|might_be_your_friend",e)))+"\n						"}function F(a,b){var d,e,f,g="";return g+="\n							",e=c.compare||a&&a.compare,f={hash:{operator:">"},inverse:Y.program(47,H,b),fn:Y.program(45,G,b),data:b},d=e?e.call(a,a&&a.mutual_num_following,1,f):X.call(a,"compare",a&&a.mutual_num_following,1,f),(d||0===d)&&(g+=d),g+="\n						"}function G(a,b){var d,e,f,g="";return g+="\n								"+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"discover|followed_by_and_people",(d=a&&a.mutual_following,null==d||d===!1?d:d[0]),a&&a.mutual_num_following,a&&a.username,f):X.call(a,"translate","discover|followed_by_and_people",(d=a&&a.mutual_following,null==d||d===!1?d:d[0]),a&&a.mutual_num_following,a&&a.username,f)))+"\n							"}function H(a,b){var d,e,f,g="";return g+="\n								",e=c.compare||a&&a.compare,f={hash:{},inverse:Y.program(50,J,b),fn:Y.program(48,I,b),data:b},d=e?e.call(a,a&&a.mutual_num_following,1,f):X.call(a,"compare",a&&a.mutual_num_following,1,f),(d||0===d)&&(g+=d),g+="\n							"}function I(a,b){var d,e,f,g="";return g+="\n									"+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"discover|followed_by",(d=a&&a.mutual_following,null==d||d===!1?d:d[0]),a&&a.username,f):X.call(a,"translate","discover|followed_by",(d=a&&a.mutual_following,null==d||d===!1?d:d[0]),a&&a.username,f)))+"\n								"}function J(a,b){var d,e,f,g="";return g+="\n									",e=c.compare||a&&a.compare,f={hash:{operator:">"},inverse:Y.program(53,L,b),fn:Y.program(51,K,b),data:b},d=e?e.call(a,a&&a.mutual_num_followers,1,f):X.call(a,"compare",a&&a.mutual_num_followers,1,f),(d||0===d)&&(g+=d),g+="\n								"}function K(a,b){var d,e,f,g="";return g+="\n										"+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"discover|followed_by_and_people",(d=a&&a.mutual_followers,null==d||d===!1?d:d[0]),a&&a.mutual_num_followers,a&&a.username,f):X.call(a,"translate","discover|followed_by_and_people",(d=a&&a.mutual_followers,null==d||d===!1?d:d[0]),a&&a.mutual_num_followers,a&&a.username,f)))+"\n									"}function L(a,b){var d,e,f,g="";return g+="\n										",e=c.compare||a&&a.compare,f={hash:{},inverse:Y.program(57,O,b),fn:Y.program(54,M,b),data:b},d=e?e.call(a,a&&a.mutual_num_followers,1,f):X.call(a,"compare",a&&a.mutual_num_followers,1,f),(d||0===d)&&(g+=d),g+="\n									"}function M(a,b){var d,e="";return e+="\n											",d=c["if"].call(a,(d=a&&a.mutual_followers,null==d||d===!1?d:d[0]),{hash:{},inverse:Y.noop,fn:Y.program(55,N,b),data:b}),(d||0===d)&&(e+=d),e+="\n										"}function N(a,b){var d,e,f,g="";return g+="\n												"+W((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"discover|followed_by",(d=a&&a.mutual_followers,null==d||d===!1?d:d[0]),a&&a.username,f):X.call(a,"translate","discover|followed_by",(d=a&&a.mutual_followers,null==d||d===!1?d:d[0]),a&&a.username,f)))+"\n											"}function O(a,b){var d,e="";return e+="\n											",d=c["if"].call(a,(d=a&&a.label,null==d||d===!1?d:d.verified),{hash:{},inverse:Y.noop,fn:Y.program(58,P,b),data:b}),(d||0===d)&&(e+=d),e+="\n										"}function P(a,b){var d,e,f="";return f+="\n												"+W((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"discover|you_might_be_interested",e):X.call(a,"translate","discover|you_might_be_interested",e)))+"\n											"}function Q(a,b){var d,e,f,g="";return g+="\n							",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:Y.noop,fn:Y.program(61,R,b),data:b},d=e?e.call(a,a&&a.about_me_verified,f):X.call(a,"isNotEmpty",a&&a.about_me_verified,f),(d||0===d)&&(g+=d),g+="\n						"}function R(a,b){var d,e,f="";return f+="\n								",(e=c.about_me_verified)?d=e.call(a,{hash:{},data:b}):(e=a&&a.about_me_verified,d=typeof e===V?e.call(a,{hash:{},data:b}):e),(d||0===d)&&(f+=d),f+="\n							"}function S(a,b){var d,e,f,g="";return g+="\n							",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:Y.noop,fn:Y.program(64,T,b),data:b},d=e?e.call(a,a&&a.about_me,f):X.call(a,"isNotEmpty",a&&a.about_me,f),(d||0===d)&&(g+=d),g+="\n						"}function T(a,b){var d,e,f="";return f+="\n								",(e=c.about_me)?d=e.call(a,{hash:{},data:b}):(e=a&&a.about_me,d=typeof e===V?e.call(a,{hash:{},data:b}):e),(d||0===d)&&(f+=d),f+="\n							"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var U,V="function",W=this.escapeExpression,X=c.helperMissing,Y=this,Z=c.blockHelperMissing;return U=c["if"].call(b,b&&b.recommendedUser,{hash:{},inverse:Y.program(25,u,e),fn:Y.program(1,f,e),data:e}),U||0===U?U:""})}),define("modules/view/discover/discover_user_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/discover/discover-user-list","modules/chat/models/chats","modules/view/user/user_view","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers","modules/template/helpers/user_helpers"],function(a,b,c,d,e,f,g,h,i,j,k){var l=i.extend({template:{type:"handlebars",template:g},className:"rec-user",onRender:function(){k.parse_profile_hovercard(this),i.prototype.onRender.apply(this,arguments)},follow:function(a){a.preventDefault();var c=this,d=this.model.follow();d.done(function(a){a=k.parse_ajax_response(a),a.error||(c._parseRelationship(a.user.relationship),b(".user-actions .chat",c.$el).removeClass("hidden"),b(".user-actions .follow",c.$el).addClass("hidden"))})},unfollow:function(a){a.preventDefault();var c=this,d=this.model.unfollow();d.done(function(a){a=k.parse_ajax_response(a),a.error||(c._parseRelationship(a.user.relationship),b(".rec-user",c.$el).addClass("hidden"))})},chat:function(){if(this.model.get("recommendedUser")){var a=this.model.get("recommendedUser");h.ChatStoreModel.getInstance().startPrivateChat(a.id,a.username,null,a.username)}}});return l}),define("hbs!modules/template/discover/discover-homefeed-user-list",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f,h="";return h+="\n	",e=c.ifShowRecUsers||a&&a.ifShowRecUsers,f={hash:{},inverse:q.noop,fn:q.program(2,g,b),data:b},d=e?e.call(a,(d=a&&a.recommendedUser,null==d||d===!1?d:d._relationship),f):n.call(a,"ifShowRecUsers",(d=a&&a.recommendedUser,null==d||d===!1?d:d._relationship),f),(d||0===d)&&(h+=d),h+="\n"}function g(a,b){var d,e,f,g="";return g+='\n		<a href="'+o((e=c.getProfileUrl||a&&a.getProfileUrl,f={hash:{},data:b},e?e.call(a,(d=a&&a.recommendedUser,null==d||d===!1?d:d.username),f):n.call(a,"getProfileUrl",(d=a&&a.recommendedUser,null==d||d===!1?d:d.username),f)))+'" class="profile-hovercard pull-left" data-username="'+o((d=a&&a.recommendedUser,d=null==d||d===!1?d:d.username,typeof d===p?d.apply(a):d))+'">\n			<img class="media-object img-circle" src="'+o((e=c.getDisplayPictureUrl||a&&a.getDisplayPictureUrl,f={hash:{},data:b},e?e.call(a,(d=a&&a.recommendedUser,null==d||d===!1?d:d.username),(d=a&&a.recommendedUser,null==d||d===!1?d:d.displayPictureType),48,48,f):n.call(a,"getDisplayPictureUrl",(d=a&&a.recommendedUser,null==d||d===!1?d:d.username),(d=a&&a.recommendedUser,null==d||d===!1?d:d.displayPictureType),48,48,f)))+'" width="48" height="48" />\n		</a>\n		<div class="media-body">\n			<div class="media-heading font-size-16 media-actions-follow">\n				<a class="link" href="'+o((e=c.getProfileUrl||a&&a.getProfileUrl,f={hash:{},data:b},e?e.call(a,(d=a&&a.recommendedUser,null==d||d===!1?d:d.username),f):n.call(a,"getProfileUrl",(d=a&&a.recommendedUser,null==d||d===!1?d:d.username),f)))+'">'+o((e=c.characterLimiter||a&&a.characterLimiter,f={hash:{},data:b},e?e.call(a,(d=a&&a.recommendedUser,null==d||d===!1?d:d.username),13,f):n.call(a,"characterLimiter",(d=a&&a.recommendedUser,null==d||d===!1?d:d.username),13,f)))+"</a>\n				",f={hash:{},inverse:q.noop,fn:q.program(3,h,b),data:b},(e=c.ifLoggedIn)?d=e.call(a,f):(e=a&&a.ifLoggedIn,d=typeof e===p?e.call(a,f):e),c.ifLoggedIn||(d=r.call(a,d,{hash:{},inverse:q.noop,fn:q.program(3,h,b),data:b})),(d||0===d)&&(g+=d),g+="\n			</div>\n		</div>\n	"}function h(a,b){var d,e,f,g="";return g+='\n					<a href="'+o((e=c.getProfileUrl||a&&a.getProfileUrl,f={hash:{},data:b},e?e.call(a,(d=a&&a.recommendedUser,null==d||d===!1?d:d.username),f):n.call(a,"getProfileUrl",(d=a&&a.recommendedUser,null==d||d===!1?d:d.username),f)))+'" class="btn btn-xs pull-right btn-inverse-lowkey profile-hovercard" type="button" data-username="'+o((d=a&&a.recommendedUser,
d=null==d||d===!1?d:d.username,typeof d===p?d.apply(a):d))+'">\n						<span class="icon-wb_friend"></span>&nbsp;View\n					</a>\n				'}function i(a,b){var d,e,f,g="";return g+='\n	<a href="',(e=c.personalized_url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.personalized_url,d=typeof e===p?e.call(a,{hash:{},data:b}):e),g+=o(d)+'" class="profile-hovercard pull-left" data-username="',(e=c.username)?d=e.call(a,{hash:{},data:b}):(e=a&&a.username,d=typeof e===p?e.call(a,{hash:{},data:b}):e),g+=o(d)+'">\n		<img class="media-object img-circle" src="'+o((e=c.userGetDisplayPictureUrl||a&&a.userGetDisplayPictureUrl,f={hash:{},data:b},e?e.call(a,48,48,a,f):n.call(a,"userGetDisplayPictureUrl",48,48,a,f)))+'" width="48" height="48" />\n	</a>\n	<div class="media-body">\n		<h4 class="media-heading font-size-16 media-actions-follow">\n			<a href="',(e=c.personalized_url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.personalized_url,d=typeof e===p?e.call(a,{hash:{},data:b}):e),g+=o(d)+'" class="profile-hovercard" data-username="',(e=c.username)?d=e.call(a,{hash:{},data:b}):(e=a&&a.username,d=typeof e===p?e.call(a,{hash:{},data:b}):e),g+=o(d)+'">'+o((e=c.characterLimiter||a&&a.characterLimiter,f={hash:{},data:b},e?e.call(a,a&&a.username,13,f):n.call(a,"characterLimiter",a&&a.username,13,f)))+"</a>\n			",f={hash:{},inverse:q.noop,fn:q.program(6,j,b),data:b},(e=c.ifLoggedIn)?d=e.call(a,f):(e=a&&a.ifLoggedIn,d=typeof e===p?e.call(a,f):e),c.ifLoggedIn||(d=r.call(a,d,{hash:{},inverse:q.noop,fn:q.program(6,j,b),data:b})),(d||0===d)&&(g+=d),g+="\n		</h4>\n	</div>\n"}function j(a,b){var d,e="";return e+="\n				",d=c["if"].call(a,(d=a&&a.relationship,null==d||d===!1?d:d.is_self),{hash:{},inverse:q.program(9,l,b),fn:q.program(7,k,b),data:b}),(d||0===d)&&(e+=d),e+="\n			"}function k(a,b){return"\n				"}function l(a,b){var d,e,f,g="";return g+='\n					<button class="btn btn-xs btn-friends chat pull-right hidden" type="button">\n						<span class="icon-wb_friend"></span>&nbsp;'+o((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|friends",f):n.call(a,"translate","user|friends",f)))+'\n					</button>\n					<a href="#"\n					   class="btn btn-xs btn-following following pull-right hidden"\n					   data-toggle="clickover"\n					   data-placement="top"\n					   data-html="true"\n					   data-title="'+o((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|be_friends_to_chat",f):n.call(a,"translate","user|be_friends_to_chat",f)))+'"\n					   data-content="'+o((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|sweeten_the_invite",f):n.call(a,"translate","user|sweeten_the_invite",f)))+"<div class='padding-4px'></div><a href='/store/category/1/new/?username=",(e=c.username)?d=e.call(a,{hash:{},data:b}):(e=a&&a.username,d=typeof e===p?e.call(a,{hash:{},data:b}):e),g+=o(d)+"' class='btn btn-xs btn-default'>"+o((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|send_gift",f):n.call(a,"translate","user|send_gift",f)))+'</a>"\n							>\n						<span class="icon-wb_fanof"></span>&nbsp;'+o((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|i_m_a_fan",f):n.call(a,"translate","user|i_m_a_fan",f)))+'\n					</a>\n					<button class="btn btn-xs btn-following follow-pending pull-right hidden" type="button">\n						<span class="icon-wb_recent"></span>&nbsp;'+o((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|pending",f):n.call(a,"translate","user|pending",f)))+'\n					</button>\n					<button class="btn btn-xs btn-default follow pull-right hidden" type="button">\n						<span class="icon-wb_add">TEST</span>&nbsp;'+o((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|add",f):n.call(a,"translate","user|add",f)))+"\n					</button>\n				"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var m,n=c.helperMissing,o=this.escapeExpression,p="function",q=this,r=c.blockHelperMissing;return m=c["if"].call(b,b&&b.recommendedUser,{hash:{},inverse:q.program(5,i,e),fn:q.program(1,f,e),data:e}),m||0===m?m:""})}),define("modules/view/discover/discover_homefeed_user_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/view/discover/discover_user_item_view","hbs!modules/template/discover/discover-homefeed-user-list","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers","modules/template/helpers/user_helpers"],function(a,b,c,d,e,f,g,h,i,j){var k=g.extend({template:{type:"handlebars",template:h},className:"media"});return k}),define("modules/view/discover/discover_homefeed_user_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/view/discover/discover_homefeed_user_item_view","modules/view/common/mig33_views","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i){var j=d.compile('{{translate "discover|empty_user"}}'),k=d.compile('{{translate "common|loading"}}...'),l=e.ItemView.extend({template:{type:"handlebars",template:j},className:"empty"}),m=e.ItemView.extend({template:{type:"handlebars",template:k},className:"loading"}),n=i.CollectionView.extend({itemView:h,emptyView:l,loadingView:m,className:"users",initialize:function(){a.bindAll(this)}});return n}),define("hbs!modules/template/discover/discover-profile-sidebar-invite",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<a href="#" class="fb-invite-dialog" title="'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"discover|invite_friends_via_facebook",g):i.call(b,"translate","discover|invite_friends_via_facebook",g)))+'"><span class="icon-wb_facebook font-size-24 font-color-facebook"></span></a>\n&nbsp;&nbsp;\n<span class="icon-wb_mail font-size-24 font-color-warm-grey-light"></span>\n<form action="/discover/invite" method="post">\n	<div class="padding-8px"></div>\n	<p class="font-size-12">\n		'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"discover|invite_friends_via_email_description",g):i.call(b,"translate","discover|invite_friends_via_email_description",g)))+'\n	</p>\n	<p>\n		<input type="text" id="destinations" value="" />\n	</p>\n	<p class="discover-invite-errormsg-sidebar" style="display:none;">\n		'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"discover|fb_invite_email_required",g):i.call(b,"translate","discover|fb_invite_email_required",g)))+'\n	</p>\n	<div class="custom-message-content">\n		<div class="custom-message-text">\n			<textarea class="custom-message-textarea" name="message" id="message"></textarea>\n		</div>\n		<div class="custom-message-count">\n			<span class="custom-message-charcount" id="custom-message-charcount"></span>\n		</div>\n		<div class="clear"></div>\n	</div>\n	<p>\n	</p>\n	<p class="text-right">\n		<input type="button" name="preview" class="btn btn-xs btn-default" value="'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"discover|preview",g):i.call(b,"translate","discover|preview",g)))+'" />\n\n		<input type="button" name="invite_friends" class="btn btn-xs btn-default" value="'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"discover|invite_now",g):i.call(b,"translate","discover|invite_now",g)))+'" disabled />\n	</p>\n</form>\n'})}),define("modules/view/discover/discover_profile_sidebar_invite_view",["jquery","underscore","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/common/session_user","modules/globals/variable","modules/globals/url","hbs!modules/template/discover/discover-profile-sidebar-invite"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=e.Layout.extend({template:{type:"handlebars",template:l},id:"discover-profile-sidebar-invite",ui:{previewBtn:'input[name="preview"]',inviteFriendsBtn:'input[name="invite_friends"]',fbInviteBtn:".fb-invite-dialog",textarea:"textarea#message",destinations:"#destinations",destinationsInput:"input.ui-widget-content",wordCountBox:"#custom-message-charcount"},events:{"click   @ui.previewBtn":"previewEmail","click   @ui.fbInviteBtn":"fBInviteDialog","click   @ui.inviteFriendsBtn":"inviteFriends","change  @ui.destinationsInput":"updateInviteBtnStatus","change  @ui.textarea":"updateCharCount","keyup   @ui.textarea":"updateCharCount","paste     @ui.textarea":"updateCharCount","mouseover @ui.textarea":"updateCharCount"},previewEmail:function(){a("#invite-friends-trigger").data("data-source","sidebar_invite");var c=b.escape(this.ui.textarea.val()),d=this.ui.destinations.tagit("assignedTags"),e=a("#chat-invite-destinations");e.tagit("removeAll"),d.forEach(function(b){a("#chat-invite-destinations").tagit("createTag",b)}),a("#chat-invite-email-template-view").modal("show"),a("#tpl-custom-message p").empty().html(c)},fBInviteDialog:function(b){b.preventDefault();var c=i.getInstance().get("personalized_url"),d=k.site+"/sites/ajax/invite/refer_friend_facebook_submit?noredir=1";h.inviteFriendToFacebook(c,null,null,d),a("#invite-friends-modal").modal("hide")},updateInviteBtnStatus:function(a){var c=this.ui.destinations.tagit("assignedTags"),d=b.escape(a.target.value);""===d&&(c.length>0?this._enableInvite():this._disableInvite())},updateCharCount:function(a){var b=this._getMaxWordCount(),c=b-this.ui.textarea.val().length;0>c&&(this.ui.wordCountBox.addClass("custom-message-error"),this._disableInvite()),c>=0&&this.ui.wordCountBox.hasClass("custom-message-error")&&(this.ui.wordCountBox.removeClass("custom-message-error"),this._enableInvite()),this.ui.wordCountBox.text(c.toString())},inviteFriends:function(c){c.preventDefault();var d=this,e=b.escape(a("#destinations").val()),f=b.escape(a("textarea#message").val()),j={data:{channel:1,type:1,destinations:e.split(","),invitationMetadata:{joinInvitationSubtype:"15",chatInvitationMessage:f}}},k=a.ajax({type:"post",contentType:"application/json",data:a.toJSON(j),url:h.format(g.urls.invite,i.getInstance().get("id"))});return 0===e.length&&0===a("tagit-choice-editable").length?(a(".discover-invite-errormsg-sidebar").show(),!1):(a(".discover-invite-errormsg-sidebar").hide(),k.done(function(b){b=h.parse_ajax_response(b);var c=[],e=[];for(var f in b)if(b.hasOwnProperty(f)){var g=b[f];g>0?c.push(f):e.push(f)}c.length>0&&h.show_success(h.translate("discover|success_emails_invited",c.join(", "))),e.length>0&&h.show_error(h.translate("discover|error_sending_email",e.join(", "))),a('input[name="invite_friends"]',d.$el).prop("disabled",!0),a("#destinations",d.$el).tagit("removeAll")}),k.fail(function(a,b,c){h.show_error(c)}),!0)},onRender:function(){var c=this;this.ui.destinations.tagit({fieldName:"destinations",caseSensitive:!1,tagLimit:5,onTagLimitExceeded:function(){h.show_error(h.translate("discover|error_emails_exceeded",5))},beforeTagAdded:function(d,e){var f=b.escape(a(e.tag[0]).text()),g=f.substr(0,f.length-1);return a(d.target).data("emailLists",g),c._validateEmail(g)?void 0:(h.show_error(h.translate("discover|error_valid_email",g)),c._disableInvite(),!1)},afterTagAdded:function(){c._enableInvite()}}),this.ui.wordCountBox.text(this._getMaxWordCount()),this.ui.textarea.attr("placeholder",h.translate("discover|enter_message")),a(".ui-autocomplete-input",this.$el).attr("placeholder",h.translate("discover|enter_email"))},_validateEmail:function(a){var b=/^(([^<>()\[\]\\.,;:\s@\"]+(\.[^<>()\[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,c=b.test(a);return c},_getMaxWordCount:function(){return g.invite_friends.message_char_limit},_enableInvite:function(){var b=this.ui.destinations.data("emailLists");"undefined"!=typeof b&&(this.ui.inviteFriendsBtn.prop("disabled",!1),a("#preview-invite-region").removeClass("chat-invite-btn-disable"),a("input[name='preview-chat-invite-friends']").removeClass("chat-invite-btn-disable"),a("input[name='preview-chat-invite-friends']").prop("disabled",!1))},_disableInvite:function(){this.ui.inviteFriendsBtn.prop("disabled",!0),a("#preview-invite-region").addClass("chat-invite-btn-disable"),a("input[name='preview-chat-invite-friends']").addClass("chat-invite-btn-disable"),a("input[name='preview-chat-invite-friends']").prop("disabled",!0)}});return m}),define("hbs!modules/template/banner/sidebar-google-adx",["handlebars"],function(a){return a.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},'<script type="text/javascript">\n	// save old document.write\n	var oldDocumentWrite = document.write \n\n	// change document.write temporary\n	document.write = function(node){\n		$("#banner-sidebar-google-adx").append(node)\n	}\n	\n	// google adx settings\n	google_ad_client = "ca-pub-3439587439313166";\n	google_ad_slot = "migme";\n	google_ad_width = 160;\n	google_ad_height = 600;\n\n	// get script\n	$.getScript( "//pagead2.googlesyndication.com/pagead/show_ads.js", function() {\n		// replace the temp document.write with the original version\n		setTimeout(function() {\n			document.write = oldDocumentWrite\n		}, 100)\n	});\n</script>\n'})}),define("modules/view/banner/sidebar_google_adx",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/banner/sidebar-google-adx","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g){var h=e.ItemView.extend({template:{type:"handlebars",template:g},id:"banner-sidebar-google-adx",className:"sidebar-google-adx",onRender:function(){}});return h}),define("hbs!modules/template/banner/sidebar",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e="";return e+='\n	<ol class="carousel-indicators">\n		',d=c.each.call(a,a&&a.items,{hash:{},inverse:x.noop,fn:x.program(2,g,b),data:b}),(d||0===d)&&(e+=d),e+="\n	</ol>\n"}function g(a,b){var d,e,f,g="";return g+="\n			",e=c.compare||a&&a.compare,f={hash:{},inverse:x.program(5,i,b),fn:x.program(3,h,b),data:b},d=e?e.call(a,null==b||b===!1?b:b.index,0,f):y.call(a,"compare",null==b||b===!1?b:b.index,0,f),(d||0===d)&&(g+=d),g+="\n		"}function h(a,b){var c,d="";return d+='\n				<li data-target="#banner-sidebar" data-slide-to="'+w((c=null==b||b===!1?b:b.index,typeof c===v?c.apply(a):c))+'" class="active"></li>\n			'}function i(a,b){var c,d="";return d+='\n				<li data-target="#banner-sidebar" data-slide-to="'+w((c=null==b||b===!1?b:b.index,typeof c===v?c.apply(a):c))+'"></li>\n			'}function j(a,b){var d,e="";return e+='\n	<div class="carousel-inner">\n		',d=c.each.call(a,a&&a.items,{hash:{},inverse:x.noop,fn:x.program(8,k,b),data:b}),(d||0===d)&&(e+=d),e+="\n	</div>\n"}function k(a,b){var d,e,f,g="";return g+="\n			",e=c.compare||a&&a.compare,f={hash:{},inverse:x.program(11,m,b),fn:x.program(9,l,b),data:b},d=e?e.call(a,null==b||b===!1?b:b.index,0,f):y.call(a,"compare",null==b||b===!1?b:b.index,0,f),(d||0===d)&&(g+=d),g+="\n			",d=c["if"].call(a,a&&a.url,{hash:{},inverse:x.program(16,p,b),fn:x.program(13,n,b),data:b}),(d||0===d)&&(g+=d),g+="\n			</div>\n		"}function l(a,b){return'\n				<div class="item active">\n			'}function m(a,b){return'\n				<div class="item">\n			'}function n(a,b){var d,e,f="";return f+='\n				<a href="',(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===v?e.call(a,{hash:{},data:b}):e),f+=w(d)+'" class="sbanner_a">\n					',d=c["if"].call(a,a&&a.imageUrl,{hash:{},inverse:x.noop,fn:x.program(14,o,b),data:b}),(d||0===d)&&(f+=d),f+="\n				</a>\n			"}function o(a,b){var d,e,f="";return f+='\n						<img src="',(e=c.imageUrl)?d=e.call(a,{hash:{},data:b}):(e=a&&a.imageUrl,d=typeof e===v?e.call(a,{hash:{},data:b}):e),f+=w(d)+'" />\n					'}function p(a,b){var d,e="";return e+="\n				",d=c["if"].call(a,a&&a.imageUrl,{hash:{},inverse:x.noop,fn:x.program(17,q,b),data:b}),(d||0===d)&&(e+=d),e+="\n			"}function q(a,b){var d,e,f="";return f+='\n					<img src="',(e=c.imageUrl)?d=e.call(a,{hash:{},data:b}):(e=a&&a.imageUrl,d=typeof e===v?e.call(a,{hash:{},data:b}):e),f+=w(d)+'" />\n				'}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var r,s,t,u="",v="function",w=this.escapeExpression,x=this,y=c.helperMissing;return s=c.compare||b&&b.compare,t={hash:{operator:">"},inverse:x.noop,fn:x.program(1,f,e),data:e},r=s?s.call(b,(r=b&&b.items,null==r||r===!1?r:r.length),1,t):y.call(b,"compare",(r=b&&b.items,null==r||r===!1?r:r.length),1,t),(r||0===r)&&(u+=r),u+="\n",s=c.compare||b&&b.compare,t={hash:{operator:">"},inverse:x.noop,fn:x.program(7,j,e),data:e},r=s?s.call(b,(r=b&&b.items,null==r||r===!1?r:r.length),0,t):y.call(b,"compare",(r=b&&b.items,null==r||r===!1?r:r.length),0,t),(r||0===r)&&(u+=r),u})}),define("modules/view/banner/sidebar",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/banner/sidebar","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i){var j=e.ItemView.extend({template:{type:"handlebars",template:g},id:"banner-sidebar",className:"carousel slide",onRender:function(){this.collection.length>0?b(this.$el).show().data("ride","carousel").carousel({interval:5e3}):b(".panel.panel-banner").hide(),b(this.$el).find(".sbanner_a").click(function(){i.send_event_to_ga("Miniblog","DiscoverBanner",b(this).find("img").attr("src"))})}});return j}),define("hbs!modules/template/banner/homefeed",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e="";return e+='\n	<ol class="carousel-indicators">\n		',d=c.each.call(a,a&&a.items,{hash:{},inverse:x.noop,fn:x.program(2,g,b),data:b}),(d||0===d)&&(e+=d),e+="\n	</ol>\n"}function g(a,b){var d,e,f,g="";return g+="\n			",e=c.compare||a&&a.compare,f={hash:{},inverse:x.program(5,i,b),fn:x.program(3,h,b),data:b},d=e?e.call(a,null==b||b===!1?b:b.index,0,f):y.call(a,"compare",null==b||b===!1?b:b.index,0,f),(d||0===d)&&(g+=d),g+="\n		"}function h(a,b){var c,d="";return d+='\n				<li data-target="#banner-homefeed" data-slide-to="'+w((c=null==b||b===!1?b:b.index,typeof c===v?c.apply(a):c))+'" class="active"></li>\n			'}function i(a,b){var c,d="";return d+='\n				<li data-target="#banner-homefeed" data-slide-to="'+w((c=null==b||b===!1?b:b.index,typeof c===v?c.apply(a):c))+'"></li>\n			'}function j(a,b){var d,e="";return e+='\n	<a href="#" class="close"><span class="icon-wb_close font-size-16"></span></a>\n	<div class="carousel-inner">\n		',d=c.each.call(a,a&&a.items,{hash:{},inverse:x.noop,fn:x.program(8,k,b),data:b}),(d||0===d)&&(e+=d),e+="\n	</div>\n"}function k(a,b){var d,e,f,g="";return g+="\n			",e=c.compare||a&&a.compare,f={hash:{},inverse:x.program(11,m,b),fn:x.program(9,l,b),data:b},d=e?e.call(a,null==b||b===!1?b:b.index,0,f):y.call(a,"compare",null==b||b===!1?b:b.index,0,f),(d||0===d)&&(g+=d),g+="\n			",d=c["if"].call(a,a&&a.url,{hash:{},inverse:x.program(16,p,b),fn:x.program(13,n,b),data:b}),(d||0===d)&&(g+=d),g+="\n		</div>\n		"}function l(a,b){return'\n				<div class="item active">\n			'}function m(a,b){return'\n				<div class="item">\n			'}function n(a,b){var d,e,f="";return f+='\n				<a href="',(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===v?e.call(a,{hash:{},data:b}):e),f+=w(d)+'" class="banner_a">\n					',d=c["if"].call(a,a&&a.imageUrl,{hash:{},inverse:x.noop,fn:x.program(14,o,b),data:b}),(d||0===d)&&(f+=d),f+="\n				</a>\n			"}function o(a,b){var d,e,f="";return f+='\n						<img src="',(e=c.imageUrl)?d=e.call(a,{hash:{},data:b}):(e=a&&a.imageUrl,d=typeof e===v?e.call(a,{hash:{},data:b}):e),f+=w(d)+'" />\n					'}function p(a,b){var d,e="";return e+="\n				",d=c["if"].call(a,a&&a.imageUrl,{hash:{},inverse:x.noop,fn:x.program(17,q,b),data:b}),(d||0===d)&&(e+=d),e+="\n			"}function q(a,b){var d,e,f="";return f+='\n					<img src="',(e=c.imageUrl)?d=e.call(a,{hash:{},data:b}):(e=a&&a.imageUrl,d=typeof e===v?e.call(a,{hash:{},data:b}):e),f+=w(d)+'" />\n				'}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var r,s,t,u="",v="function",w=this.escapeExpression,x=this,y=c.helperMissing;return s=c.compare||b&&b.compare,t={hash:{operator:">"},inverse:x.noop,fn:x.program(1,f,e),data:e},r=s?s.call(b,(r=b&&b.items,null==r||r===!1?r:r.length),1,t):y.call(b,"compare",(r=b&&b.items,null==r||r===!1?r:r.length),1,t),(r||0===r)&&(u+=r),u+="\n",s=c.compare||b&&b.compare,t={hash:{operator:">"},inverse:x.noop,fn:x.program(7,j,e),data:e},r=s?s.call(b,(r=b&&b.items,null==r||r===!1?r:r.length),0,t):y.call(b,"compare",(r=b&&b.items,null==r||r===!1?r:r.length),0,t),(r||0===r)&&(u+=r),u})}),define("modules/view/banner/homefeed",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/banner/homefeed","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i){var j=e.ItemView.extend({template:{type:"handlebars",template:g},id:"banner-homefeed",className:"carousel slide",events:{"click .close":"close"},onRender:function(){this.collection.length>0&&b(this.$el).show().data("ride","carousel").carousel({interval:5e3}),b(this.$el).find(".banner_a").click(function(){i.send_event_to_ga("Miniblog","DiscoverBanner",b(this).find("img").attr("src"))})},close:function(c){a.isUndefined(c)||null===c||(c.preventDefault(),b(this.$el).remove())}});return j}),define("modules/model/homefeed/mentions_collection",["modules/model/post/post_collection","modules/common/config"],function(a,b){var c=a.extend({url:function(){return b.urls.mentions_url+"/"+this.currentPage+"/"+b.variable.limit},parse:function(a){return a.data&&a.data.mentions?a.data.mentions:[]}});return c}),define("modules/model/homefeed/watchlist_collection",["modules/model/post/post_collection","modules/common/config"],function(a,b){var c=a.extend({url:function(){return b.urls.watchlist_url+"/"+this.currentPage+"/"+b.variable.limit}});return c}),define("modules/model/discover/discover_user_model",["underscore","backbone","modules/mig33_app","modules/model/user/user_model","modules/common/config","modules/common/utility"],function(a,b,c,d,e,f){var g=d.extend({initialize:function(a){this.options=a},follow:function(){var a=this,b=0,c="";return a.get("recommendedUser")?(b=parseInt(a.get("recommendedUser").id,10),c=this.get("recommendedUser").username):(b=parseInt(a.get("id"),10),c=this.get("username")),$.ajax({type:"post",cache:!1,dataType:"json",url:e.urls.miniblog_api_url+"/follow/"+b,success:function(a){a=f.parse_ajax_response(a),a.error?f.show_error(f.translate(a.error,c)):f.show_success(f.translate(a.success,c))},error:function(){f.show_error(f.translate("user|follow_error",c))}})},unfollow:function(){var a=this,b=0,c="";return a.get("recommendedUser")?(b=parseInt(a.get("recommendedUser").id,10),c=this.get("recommendedUser").username):(b=parseInt(a.get("id"),10),c=this.get("username")),$.ajax({type:"post",cache:!1,dataType:"json",url:e.urls.miniblog_api_url+"/unfollow/"+b,success:function(a){a=f.parse_ajax_response(a),a.error?f.show_error(f.translate(a.error,c)):f.show_success(f.translate(a.success,c))},error:function(){f.show_error(f.translate("user|follow_error",c))}})}});return g}),define("modules/model/discover/discover_user_collection",["jquery","underscore","modules/model/common/mig33_collection","modules/mig33_app","modules/common/config","modules/common/utility","modules/model/discover/discover_user_model"],function(a,b,c,d,e,f,g){var h=c.extend({model:g,offset:0,limit:20,useNewRecommendation:!1,addressbookType:"default_user",defaultRecommendationType:"default",initialize:function(a,b){this.options=b,-1!==e.urls.recommendations_user.indexOf("/recommendation/ur/user")&&(this.useNewRecommendation=!0)},url:function(){return"addressbook"==this.options.type?f.format(e.urls.addressbook_users,this.options.userId)+"&offset="+this.offset+"&limit="+this.limit+"&xformType="+this.addressbookType:"ur-country"==this.options.type?f.format(e.urls.recommendations_user_country,this.options.userId)+"&offset="+this.offset+"&limit="+this.limit+"&xformType="+this.defaultRecommendationType:this.useNewRecommendation?f.format(e.urls.recommendations_user,this.options.userId)+"&offset="+this.offset+"&limit="+this.limit+"&xformType="+this.defaultRecommendationType:e.urls.recommendations_user+"/"+this.currentPage},parse:function(a){if(null!==a.data){if(a.data.items){if(a.data.items.source&&"null"==a.data.items.source.toLowerCase())switch(this.options.type){case"addressbook":a.data.items.source=f.translate("discover|reason_abc",a.data.items.recommendedUser.username);break;case"ur-country":a.data.items.source=f.translate("discover|reason_country",a.data.items.recommendedUser.username);break;default:a.data.items.source=f.translate("discover|reason_global")}return a.data.items}if(a.data.results)return a.data.results;if(a.data.search.result)return a.data.search.result}return[]},nextPage:function(){this.useNewRecommendation?this.offset+=this.limit:this.currentPage++},getValid:function(a){var c=[],d=0;return b.each(this.models,function(b){if(d>a)return c;var e=b.get("recommendedUser")._relationship;e.isSelf||e.isFollowerPendingApproval||e.isFriend||e.isFollower||(c[d]=b,d++)}),c}});return h}),define("modules/model/banner/banner_model",["underscore","backbone","modules/mig33_app","modules/common/config","modules/common/utility"],function(a,b){var c=b.Model.extend({});return c}),define("modules/model/banner/banner_collection",["modules/model/common/mig33_collection","modules/mig33_app","modules/common/config","modules/common/utility","modules/model/banner/banner_model","underscore"],function(a,b,c,d,e,f){var g=a.extend({model:e,platform:"web",placement:"sidebar",initialize:function(a,b){this.options=b},url:function(){return c.urls.banner+"?platform="+this.platform+"&placement="+this.placement},parse:function(a){return a.data?d.random_array_sort(a.data):a},setPlacementSidebar:function(){this.placement="sidebar"},setPlacementHomefeed:function(){this.placement="homefeed"},setPlacementStore:function(){this.placement="store"}});return g}),define("modules/controller/homefeed_controller",["underscore","backbone","backbone.marionette","modules/mig33_app","modules/model/achievement/achievement_model","modules/model/achievement/achievement_collection","modules/view/achievement/achievement_item_unlocked_collection_view","modules/view/homefeed/homefeed_layout","modules/view/homefeed/homefeed_post_collection_view","modules/view/homefeed/homefeed_post_item_view","modules/view/discover/discover_hashtag_layout","modules/view/discover/discover_homefeed_user_collection_view","modules/view/discover/discover_profile_sidebar_invite_view","modules/view/banner/sidebar_google_adx","modules/view/banner/sidebar","modules/view/banner/homefeed","modules/model/post/post_collection","modules/model/homefeed/mentions_collection","modules/model/homefeed/watchlist_collection","modules/model/discover/discover_user_collection","modules/model/banner/banner_collection","modules/common/mime_types_parser","modules/common/config","modules/common/utility","modules/common/session_user","modules/globals/url","jquery.readmore"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){var A,B,C,D,E,F=null,G=null,H=c.Controller.extend({initialize:function(){var a=this;this._createAndInitHomeLayout(),d.vent.on(d.ApplicationEvents.POST_ADDED,function(a){if(A)try{""!==a.mimeData&&"undefined"!=typeof a.mimeData||(a=v.generate_post_mimedata(a)),A.add(a)}catch(b){console.log("Homefeed collection is not initialized or undefined")}}),d.vent.on(d.ApplicationEvents.NEW_ACHIEVEMENT_LABELS,function(b){a._showAcheievementPostFeed(b)}),d.vent.on(d.ApplicationEvents.NEW_MENTIONS,function(a){F.updateMentionsCount(a),F.showOrHideNewPostsMessage("mentions",a)}),d.vent.on(d.ApplicationEvents.NEW_POSTS,function(a){F.updatePostsCount(a),F.showOrHideNewPostsMessage("posts",a)}),d.vent.on(d.ApplicationEvents.POST_REPLY_ADDED,function(b){a._addInteractions(b,"replies")}),d.vent.on(d.ApplicationEvents.POST_RESHARE_ADDED,function(b){a._addInteractions(b,"reshares")}),d.vent.on(d.ApplicationEvents.POST_REPLY_DELETED,function(b){a._removeInteractions(b,"replies")}),y.getInstance().on("change:num_watched_posts",function(a){F.updateSubscriptionsCount(a.get("num_watched_posts"))}),x.is_logged_in()&&(D=new t([],{userId:y.getInstance().get("id")}),D.fetch(),D.on("fetch:done",function(){D.reset(D.getValid(5))}))},_createAndInitHomeLayout:function(){F=new h,F.on("close",function(){G=null}),F.on("homefeed:posts:new",function(){F.updatePostsCount(0),F.clearNewPostsMessage(),A&&A.fetch({success:function(){$(".loading").addClass("hidden")}})})},_show:function(){x.highlight_top_menu(""),null!==G&&G?G.close():(this._createAndInitHomeLayout(),d.content.show(F)),this._showBanners()},_showHashtags:function(){E=new k,F.panel_hottopics.show(E)},_showBanners:function(){var a=new u;a.setPlacementSidebar(),a.fetch(),a.on("fetch:done",function(){F.panel_banner.show(new o({collection:a}))});var b=new u;b.setPlacementHomefeed(),b.fetch(),b.on("fetch:done",function(){F.banner_homefeed.show(new p({collection:b}))})},_showRecommendedUsers:function(){var a=new t([],{userId:y.getInstance().get("id")});a.fetch(),a.on("fetch:done",function(){a.reset(a.getValid(3))});var b=new t([],{userId:y.getInstance().get("id"),type:"ur-country"});b.fetch(),b.on("fetch:done",function(){b.reset(b.getValid(3))});var c=new t([],{userId:y.getInstance().get("id"),type:"addressbook"});c.fetch(),c.on("fetch:done",function(){c.reset(c.getValid(3))});var d=new l({collection:a});F.panel_global_rec.show(d);var e=new l({collection:b});F.panel_country_rec.show(e);var f=new l({collection:c});F.panel_addressbook_rec.show(f)},_showInviteUser:function(){F.panel_invite.show(new m)},_showGoogleAdx:function(){F.panel_google_adx.show(new n)},_showAcheievementPostFeed:function(b){var c=[];a.each(b,function(a){var b=[];a.image&&a.image.url&&(b=a.image.url.filter(function(a){return"64x64"==a.size})[0]),c.push(new e({id:a.id,description:a.message,title:a.title,imageUrl:b.url}))});var d=new f(c),h=new g({collection:d});F.new_achievement_alerts_region.show(h)},index:function(){this._show(),A=new q;var a=this._showAndReturnHomefeedView("homefeed",A);F.setPostsTabActive(),F.updatePostsCount(0),F.clearNewPostsMessage(),F.addClassToNewPostsMessage("posts"),G=a,$(".post-text").readmore()},mentions:function(){this._show(),B=new r;var a=this._showAndReturnHomefeedView("mentions",B);F.setMentionsTabActive(),F.updateMentionsCount(0),F.clearNewPostsMessage(),F.addClassToNewPostsMessage("mentions"),G=a},watchlist:function(){this._show(),C=new s;var a=this._showAndReturnHomefeedView("watchlist",C);F.setWatchlistTabActive(),G=a},moveToReply:function(a){var b="post-reply-"+a;$("#"+b).offset()&&$("html, body").animate({scrollTop:$("#"+b).offset().top-$(window).height()/2})},moveToBottom:function(){$("html, body").animate({scrollTop:$(document).height()})},_showAndReturnHomefeedView:function(a,c){var d=new i({emptyViewModel:new b.Model({type:a}),type:a,collection:c});return c.resetPage(),c.fetch(),c.on("fetch:done",function(){F.hidePagination(),d.more=x.unblock_function(d.more)}),d.on(a+":more",function(a){F.showPagination(),d.more=x.block_function(d.more),c.fetch({remove:!1,page:a})}),F.container.show(d),F.fixTabsOnScroll(),d},_addInteractions:function(a,b){b=b||"replies";var c=a.parent_post.id;if(A){var d=A.where({id:c});if(d.length>0)for(var e=0;e<d.length;e++)d[e].set("num_of_"+b,d[e].get("num_of_"+b)+1),"replies"===b?(d[e].getReplies().add(a),$("#post-"+d[e].id).data("PostItemViewObject")&&$("#post-"+d[e].id).data("PostItemViewObject").showReply(jQuery.Event("click"))):d[e].getReshares().add(a)}if(B){var f=B.where({id:c});if(f.length>0)for(var g=0;g<f.length;g++)f[g].set("num_of_"+b,f[g].get("num_of_"+b)+1),"replies"===b?f[g].getReplies().add(a):f[g].getReshares().add(a)}if(C){var h=C.where({id:c});if(h.length>0)for(var i=0;i<h.length;i++)h[i].set("num_of_"+b,h[i].get("num_of_"+b)+1),
"replies"===b?h[i].getReplies().add(a):h[i].getReshares().add(a)}},_removeInteractions:function(a,b){b=b||"replies";var c=a.get("parent_post").id;if(A){var d=A.where({id:c});if(d.length>0)for(var e=0;e<d.length;e++)d[e].set("num_of_"+b,d[e].get("num_of_"+b)-1),"replies"===b?d[e].getReplies().remove(a.get("id")):d[e].getReshares().remove(a.get("id"))}if(B){var f=B.where({id:c});if(f.length>0)for(var g=0;g<f.length;g++)f[g].set("num_of_"+b,f[g].get("num_of_"+b)-1),"replies"===b?f[g].getReplies().remove(a.get("id")):f[g].getReshares().remove(a.get("id"))}if(C){var h=C.where({id:c});if(h.length>0)for(var i=0;i<h.length;i++)h[i].set("num_of_"+b,h[i].get("num_of_"+b)-1),"replies"===b?h[i].getReplies().remove(a.get("id")):h[i].getReshares().remove(a.get("id"))}}});return H}),define("hbs!modules/template/post/single-post-layout",["handlebars"],function(a){return a.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},'<div class="col-xs-12 col-sm-8 col-sm-offset-2 content content-singlepost">\n	<div class="row">\n		<div class="col-xs-12">\n			<div class="group-header"></div>\n			<div class="user-header"></div>\n			<div class="post-content"></div>\n			<div class="post-responses-container"></div>\n		</div>\n	</div>\n</div>'})}),define("modules/template/helpers/group_helpers",["underscore","handlebars","modules/common/utility","modules/common/session_user","modules/globals/url"],function(a,b,c,d,e){var f=function(){var a=this.post,b=this.group;return a.author&&c.is_logged_in()&&b.session_user_admin?a.author.relationship.is_self||"A"==d.getInstance().get("label").admin||b.session_user_admin:!1};b.registerHelper("ifGroupCanDeletePost",function(a){var b=f.apply(this);return b?a.fn(this):a.inverse(this)}),b.registerHelper("groupJoinText",function(){if(a.isUndefined(this.type)||null===this.type)return null;var b=this;return"OPEN"!=b.type?c.translate("group|request_to_join"):c.translate("group|join_now")}),b.registerHelper("groupLink",function(){if(a.isUndefined(this.id)||null===this.id)return null;var b=this;return e.site+"group/"+b.id}),b.registerHelper("groupModerators",function(){if(a.isUndefined(this.moderators)||null===this.moderators)return null;var b=this,d="";if(b.moderators.length>0){for(var e=0;e<b.moderators.length;e++)d+='<a href="'+c.get_profile_url(b.moderators[e].username)+'" title="'+b.moderators[e].username+'" class="profile-hovercard" data-username="'+b.moderators[e].username+'">'+b.moderators[e].username+"</a>, ";return d.substr(0,d.length-2)}return c.translate("group|no_moderator")})}),define("modules/view/post/single_post_layout",["jquery","underscore","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/post/single-post-layout","modules/template/helpers/general_helpers","modules/template/helpers/post_helpers","modules/template/helpers/group_helpers"],function(a,b,c,d,e,f,g){var h=e.Layout.extend({template:{type:"handlebars",template:g},className:"single-post row",regions:{groupHeader:".group-header",userHeader:".user-header",postContent:".post-content",postEmotionalFootPrints:".post-emotional-footprints",postResponses:".post-responses-container"},initialize:function(){},showGroupHeader:function(){a(".group-header",this.$el).show()},hideGroupHeader:function(){a(".group-header",this.$el).hide()}});return h}),define("hbs!modules/template/post/single-post-group-header",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f,g="";return g+='\n				<img src="'+o((e=c.getUrl||a&&a.getUrl,f={hash:{},data:b},e?e.call(a,"image",f):n.call(a,"getUrl","image",f)))+"/",(e=c.display_file_id)?d=e.call(a,{hash:{},data:b}):(e=a&&a.display_file_id,d=typeof e===p?e.call(a,{hash:{},data:b}):e),g+=o(d)+'?w=100&h=100&a=1&c=1" width="100" height="100" class="img-circle" />\n			'}function g(a,b){var d,e,f,g="";return g+='\n			<a href="',(e=c.groupLink)?d=e.call(a,{hash:{},data:b}):(e=a&&a.groupLink,d=typeof e===p?e.call(a,{hash:{},data:b}):e),g+=o(d)+'" title="'+o((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"group|back_to_group",f):n.call(a,"translate","group|back_to_group",f)))+'" class="btn btn-follow">'+o((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"group|back_to_group",f):n.call(a,"translate","group|back_to_group",f)))+"</a>\n		"}function h(a,b){var d,e,f,g="";return g+="\n			",f={hash:{},inverse:q.program(8,j,b),fn:q.program(6,i,b),data:b},(e=c.ifLoggedIn)?d=e.call(a,f):(e=a&&a.ifLoggedIn,d=typeof e===p?e.call(a,f):e),c.ifLoggedIn||(d=r.call(a,d,{hash:{},inverse:q.program(8,j,b),fn:q.program(6,i,b),data:b})),(d||0===d)&&(g+=d),g+="\n		"}function i(a,b){var d,e,f,g="";return g+='\n				<a href="',(e=c.groupLink)?d=e.call(a,{hash:{},data:b}):(e=a&&a.groupLink,d=typeof e===p?e.call(a,{hash:{},data:b}):e),g+=o(d)+'" title="'+o((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"group|join",f):n.call(a,"translate","group|join",f)))+'" class="btn btn-follow">'+o((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"group|join",f):n.call(a,"translate","group|join",f)))+"</a>\n			"}function j(a,b){var d,e,f="";return f+='\n				<a href="'+o((d=c.getUrl||a&&a.getUrl,e={hash:{},data:b},d?d.call(a,"login",e):n.call(a,"getUrl","login",e)))+'" data-toggle="modal" data-target="#login-modal" title="'+o((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"common|login",e):n.call(a,"translate","common|login",e)))+'" class="btn btn-follow">'+o((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"group|join",e):n.call(a,"translate","group|join",e)))+"</a>\n			"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var k,l,m="",n=c.helperMissing,o=this.escapeExpression,p="function",q=this,r=c.blockHelperMissing;return m+='<div class="row">\n	<div class="col-xs-2 col-sm-1">\n		<div class="post-author-avatar">\n			',k=c["if"].call(b,b&&b.display_file_id,{hash:{},inverse:q.noop,fn:q.program(1,f,e),data:e}),(k||0===k)&&(m+=k),m+='\n		</div>\n	</div>\n	<div class="col-xs-8 col-sm-10">\n		<div class="post-author">\n			<a href="',(l=c.groupLink)?k=l.call(b,{hash:{},data:e}):(l=b&&b.groupLink,k=typeof l===p?l.call(b,{hash:{},data:e}):l),m+=o(k)+'" title="',(l=c.name)?k=l.call(b,{hash:{},data:e}):(l=b&&b.name,k=typeof l===p?l.call(b,{hash:{},data:e}):l),m+=o(k)+'">',(l=c.name)?k=l.call(b,{hash:{},data:e}):(l=b&&b.name,k=typeof l===p?l.call(b,{hash:{},data:e}):l),m+=o(k)+'</a>\n		</div>\n		<div class="post-time font-size-12">\n			',(l=c.description)?k=l.call(b,{hash:{},data:e}):(l=b&&b.description,k=typeof l===p?l.call(b,{hash:{},data:e}):l),m+=o(k)+'\n		</div>\n	</div>\n	<div class="col-xs-2 col-sm-1">\n		',k=c["if"].call(b,b&&b.session_user_member,{hash:{},inverse:q.program(5,h,e),fn:q.program(3,g,e),data:e}),(k||0===k)&&(m+=k),m+="\n	</div>\n</div>"})}),define("modules/view/post/single_post_group_header_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","hbs!modules/template/post/single-post-group-header","modules/template/helpers/general_helpers","modules/template/helpers/user_helpers"],function(a,b,c,d,e,f,g,h,i){var j=e.ItemView.extend({template:{type:"handlebars",template:i},initialize:function(){a.bindAll(this)}});return j}),define("hbs!modules/template/post/single-post-header",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){return'\n						<span class="icon-wb_repost icon--circle icon--bottom-rights"></span>\n					'}function g(a,b){var d,e="";return e+="\n					",d=c["if"].call(a,a&&a.location,{hash:{},inverse:p.noop,fn:p.program(4,h,b),data:b}),(d||0===d)&&(e+=d),e+="\n				"}function h(a,b){var d,e="";return e+="\n						",d=c["if"].call(a,(d=a&&a.location,null==d||d===!1?d:d.displayName),{hash:{},inverse:p.noop,fn:p.program(5,i,b),data:b}),(d||0===d)&&(e+=d),e+="\n					"}function i(a,b){var c,d="";return d+='\n							&nbsp;|&nbsp;<span class="post-location"><span class="icon-wb_location"></span>&nbsp;'+o((c=a&&a.location,c=null==c||c===!1?c:c.displayName,typeof c===n?c.apply(a):c))+"</span>\n						"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var j,k,l,m="",n="function",o=this.escapeExpression,p=this,q=c.helperMissing;return m+='<div class="row">\n	<div class="col-xs-12">\n		<div class="left post-author-avatar">\n			<a href="'+o((j=b&&b.author,j=null==j||j===!1?j:j.personalized_url,typeof j===n?j.apply(b):j))+'" title="'+o((j=b&&b.author,j=null==j||j===!1?j:j.username,typeof j===n?j.apply(b):j))+'" class="profile-hovercard" data-username="'+o((j=b&&b.author,j=null==j||j===!1?j:j.username,typeof j===n?j.apply(b):j))+'">\n				<img src="'+o((k=c.getDisplayPictureUrl||b&&b.getDisplayPictureUrl,l={hash:{},data:e},k?k.call(b,(j=b&&b.author,null==j||j===!1?j:j.username),(j=b&&b.author,null==j||j===!1?j:j.display_picture_type),40,40,l):q.call(b,"getDisplayPictureUrl",(j=b&&b.author,null==j||j===!1?j:j.username),(j=b&&b.author,null==j||j===!1?j:j.display_picture_type),40,40,l)))+'" width="40" height="40" class="img-circle" />\n					',k=c.compare||b&&b.compare,l={hash:{},inverse:p.noop,fn:p.program(1,f,e),data:e},j=k?k.call(b,b&&b.originality_text,"reshare",l):q.call(b,"compare",b&&b.originality_text,"reshare",l),(j||0===j)&&(m+=j),m+='\n			</a>\n		</div>\n		<div class="post-author-details left">\n			<div class="post-author">\n				<a href="'+o((j=b&&b.author,j=null==j||j===!1?j:j.personalized_url,typeof j===n?j.apply(b):j))+'" title="'+o((j=b&&b.author,j=null==j||j===!1?j:j.username,typeof j===n?j.apply(b):j))+'" class="profile-hovercard" data-username="'+o((j=b&&b.author,j=null==j||j===!1?j:j.username,typeof j===n?j.apply(b):j))+'">'+o((j=b&&b.author,j=null==j||j===!1?j:j.username,typeof j===n?j.apply(b):j))+"</a>\n				&nbsp;"+o((k=c.userGetLabels||b&&b.userGetLabels,l={hash:{},data:e},k?k.call(b,b&&b.author,l):q.call(b,"userGetLabels",b&&b.author,l)))+'\n			</div>\n			<div class="post-time font-size-12">\n				<a href="',(k=c.permalink)?j=k.call(b,{hash:{},data:e}):(k=b&&b.permalink,j=typeof k===n?k.call(b,{hash:{},data:e}):k),m+=o(j)+'"><time class="timeago" datetime="'+o((k=c.dateFormat||b&&b.dateFormat,l={hash:{},data:e},k?k.call(b,b&&b.timestamp,"isoUtcDateTime",l):q.call(b,"dateFormat",b&&b.timestamp,"isoUtcDateTime",l)))+'">'+o((k=c.getRelativeTimestamp||b&&b.getRelativeTimestamp,l={hash:{},data:e},k?k.call(b,b&&b.timestamp,l):q.call(b,"getRelativeTimestamp",b&&b.timestamp,l)))+"</time> "+o((k=c.translate||b&&b.translate,l={hash:{},data:e},k?k.call(b,"post|via",l):q.call(b,"translate","post|via",l)))+" ",(k=c.application_text)?j=k.call(b,{hash:{},data:e}):(k=b&&b.application_text,j=typeof k===n?k.call(b,{hash:{},data:e}):k),m+=o(j)+"</a>\n				",k=c.compare||b&&b.compare,l={hash:{},inverse:p.noop,fn:p.program(3,g,e),data:e},j=k?k.call(b,b&&b.originality,1,l):q.call(b,"compare",b&&b.originality,1,l),(j||0===j)&&(m+=j),m+='\n			</div>\n		</div>\n    </div>\n	<!-- <div class="col-xs-2 col-sm-1 text-right">\n		<div class="post-author-actions text-right"></div>\n    </div> -->\n</div>'})}),define("modules/view/post/single_post_header_layout",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","hbs!modules/template/post/single-post-header","modules/template/helpers/general_helpers","modules/template/helpers/user_helpers"],function(a,b,c,d,e,f,g,h,i){var j=e.Layout.extend({template:{type:"handlebars",template:i},className:"post-header",onRender:function(){h.parse_profile_hovercard(this)}});return j}),define("hbs!modules/template/post/single-post-details",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f,i="";return i+="\n			\n		    ",f={hash:{},inverse:na.program(4,h,b),fn:na.program(2,g,b),data:b},(e=c.ifExistMimeData)?d=e.call(a,f):(e=a&&a.ifExistMimeData,d=typeof e===ka?e.call(a,f):e),c.ifExistMimeData||(d=oa.call(a,d,{hash:{},inverse:na.program(4,h,b),fn:na.program(2,g,b),data:b})),(d||0===d)&&(i+=d),i+="\n			"}function g(a,b){var d,e,f="";return f+="\n		        ",(e=c.renderPostDetailMimeContent)?d=e.call(a,{hash:{},data:b}):(e=a&&a.renderPostDetailMimeContent,d=typeof e===ka?e.call(a,{hash:{},data:b}):e),(d||0===d)&&(f+=d),f+="\n		    "}function h(a,b){var d,e,f,g="";return g+="\n				\n				",e=c.compare||a&&a.compare,f={hash:{},inverse:na.noop,fn:na.program(5,i,b),data:b},d=e?e.call(a,a&&a.type_text,"photo",f):la.call(a,"compare",a&&a.type_text,"photo",f),(d||0===d)&&(g+=d),g+="\n\n				\n				",e=c.compare||a&&a.compare,f={hash:{},inverse:na.noop,fn:na.program(16,p,b),data:b},d=e?e.call(a,a&&a.type_text,"video",f):la.call(a,"compare",a&&a.type_text,"video",f),(d||0===d)&&(g+=d),g+="\n\n				\n				",e=c.compare||a&&a.compare,f={hash:{},inverse:na.noop,fn:na.program(23,t,b),data:b},d=e?e.call(a,a&&a.type_text,"link",f):la.call(a,"compare",a&&a.type_text,"link",f),(d||0===d)&&(g+=d),g+="\n\n				\n				",e=c.compare||a&&a.compare,f={hash:{},inverse:na.noop,fn:na.program(37,B,b),data:b},d=e?e.call(a,a&&a.type_text,"event",f):la.call(a,"compare",a&&a.type_text,"event",f),(d||0===d)&&(g+=d),g+="\n\n				\n				",e=c.compare||a&&a.compare,f={hash:{},inverse:na.noop,fn:na.program(45,G,b),data:b},d=e?e.call(a,a&&a.type_text,"text",f):la.call(a,"compare",a&&a.type_text,"text",f),(d||0===d)&&(g+=d),g+="\n\n				\n				",e=c.compare||a&&a.compare,f={hash:{operator:">"},inverse:na.noop,fn:na.program(47,H,b),data:b},d=e?e.call(a,a&&a.originality,1,f):la.call(a,"compare",a&&a.originality,1,f),(d||0===d)&&(g+=d),g+="\n		    "}function i(a,b){var d,e,f,g="";return g+='\n					<div class="row">\n						<div class="col-sm-12">\n							<div class="post-text font-size-24">\n								',e=c.compare||a&&a.compare,f={hash:{},inverse:na.noop,fn:na.program(6,j,b),data:b},d=e?e.call(a,a&&a.originality_text,"reply",f):la.call(a,"compare",a&&a.originality_text,"reply",f),(d||0===d)&&(g+=d),g+="\n								",d=c.unless.call(a,a&&a.body,{hash:{},inverse:na.noop,fn:na.program(8,k,b),data:b}),(d||0===d)&&(g+=d),g+="\n								",(e=c.body)?d=e.call(a,{hash:{},data:b}):(e=a&&a.body,d=typeof e===ka?e.call(a,{hash:{},data:b}):e),(d||0===d)&&(g+=d),g+='\n							</div>\n						</div>\n					</div>\n					<div class="row">\n						<div class="col-sm-12">\n							<div class="post-image">\n								\n								',e=c.compare||a&&a.compare,f={hash:{},inverse:na.program(14,o,b),fn:na.program(11,m,b),data:b},d=e?e.call(a,(d=a&&a.media,d=null==d||d===!1?d:d.photo,null==d||d===!1?d:d.type),"link",f):la.call(a,"compare",(d=a&&a.media,d=null==d||d===!1?d:d.photo,null==d||d===!1?d:d.type),"link",f),(d||0===d)&&(g+=d),g+="\n							</div>\n						</div>\n					</div>\n				"}function j(a,b){var d,e,f="";return f+='\n									<span class="post-originality-text">'+ma((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"post|reply",e):la.call(a,"translate","post|reply",e)))+"</span>\n								"}function k(a,b){var d,e,f,g="";return g+="\n									",e=c.compare||a&&a.compare,f={hash:{},inverse:na.noop,fn:na.program(9,l,b),data:b},d=e?e.call(a,a&&a.originality_text,"reshare",f):la.call(a,"compare",a&&a.originality_text,"reshare",f),(d||0===d)&&(g+=d),g+="\n								"}function l(a,b){var d,e,f="";return f+='\n                                        <span class="post-originality-text">'+ma((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"post|share",e):la.call(a,"translate","post|share",e)))+"</span>\n									"}function m(a,b){var d,e,f,g="";return g+="\n									",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:na.noop,fn:na.program(12,n,b),data:b},d=e?e.call(a,(d=a&&a.media,d=null==d||d===!1?d:d.photo,d=null==d||d===!1?d:d.url,null==d||d===!1?d:d.original),f):la.call(a,"isNotEmpty",(d=a&&a.media,d=null==d||d===!1?d:d.photo,d=null==d||d===!1?d:d.url,null==d||d===!1?d:d.original),f),(d||0===d)&&(g+=d),g+="\n								\n								"}function n(a,b){var c,d="";return d+='\n										<img src="'+ma((c=a&&a.media,c=null==c||c===!1?c:c.photo,c=null==c||c===!1?c:c.url,c=null==c||c===!1?c:c.original,typeof c===ka?c.apply(a):c))+'" class="post-image-img"/>\n									'}function o(a,b){var d,e,f,g="";return g+='\n									<a href="'+ma((d=a&&a.media,d=null==d||d===!1?d:d.photo,d=null==d||d===!1?d:d.url,d=null==d||d===!1?d:d.original,typeof d===ka?d.apply(a):d))+'" class="fancybox" rel="homefeed" title="'+ma((d=a&&a.author,d=null==d||d===!1?d:d.username,typeof d===ka?d.apply(a):d))+": "+ma((e=c.characterLimiter||a&&a.characterLimiter,f={hash:{},data:b},e?e.call(a,a&&a.body,100,!0,f):la.call(a,"characterLimiter",a&&a.body,100,!0,f)))+'">\n										<img src="',(e=c.fn_post_get_big_image)?d=e.call(a,{hash:{},data:b}):(e=a&&a.fn_post_get_big_image,d=typeof e===ka?e.call(a,{hash:{},data:b}):e),g+=ma(d)+'" class="post-image-img" />\n									</a>\n								'}function p(a,b){var d,e,f,g="";return g+='\n					<div class="row">\n						<div class="col-sm-12">\n							<div class="post-text font-size-24">\n								',e=c.compare||a&&a.compare,f={hash:{},inverse:na.noop,fn:na.program(6,j,b),data:b},d=e?e.call(a,a&&a.originality_text,"reply",f):la.call(a,"compare",a&&a.originality_text,"reply",f),(d||0===d)&&(g+=d),g+="\n								",d=c.unless.call(a,a&&a.body,{hash:{},inverse:na.noop,fn:na.program(8,k,b),data:b}),(d||0===d)&&(g+=d),g+="\n								",(e=c.body)?d=e.call(a,{hash:{},data:b}):(e=a&&a.body,d=typeof e===ka?e.call(a,{hash:{},data:b}):e),(d||0===d)&&(g+=d),g+='\n							</div>\n						</div>\n					</div>\n					<div class="row">\n						<div class="col-sm-12">\n							<div class="post-video">\n								',e=c.compare||a&&a.compare,f={hash:{},inverse:na.noop,fn:na.program(17,q,b),data:b},d=e?e.call(a,(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"youtube",f):la.call(a,"compare",(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"youtube",f),(d||0===d)&&(g+=d),g+="\n								",e=c.compare||a&&a.compare,f={hash:{},inverse:na.noop,fn:na.program(17,q,b),data:b},d=e?e.call(a,(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"vimeo",f):la.call(a,"compare",(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"vimeo",f),(d||0===d)&&(g+=d),g+="\n								",e=c.compare||a&&a.compare,f={hash:{},inverse:na.noop,fn:na.program(19,r,b),data:b},d=e?e.call(a,(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"flickr",f):la.call(a,"compare",(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"flickr",f),(d||0===d)&&(g+=d),g+="\n								",e=c.compare||a&&a.compare,f={hash:{},inverse:na.noop,fn:na.program(21,s,b),data:b},d=e?e.call(a,(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"soundcloud",f):la.call(a,"compare",(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"soundcloud",f),(d||0===d)&&(g+=d),g+="\n							</div>\n						</div>\n					</div>\n				"}function q(a,b){var c,d="";return d+='\n									<object class="post-video-object" type="application/x-shockwave-flash" data="'+ma((c=a&&a.media,c=null==c||c===!1?c:c.video,c=null==c||c===!1?c:c.url,typeof c===ka?c.apply(a):c))+'">\n										<param name="wmode" value="transparent" />\n										<param name="allowfullscreen" value="true" />\n										<param name="movie" value="'+ma((c=a&&a.media,c=null==c||c===!1?c:c.video,c=null==c||c===!1?c:c.url,typeof c===ka?c.apply(a):c))+'" />\n									</object>\n								'}function r(a,b){var d,e,f,g="";return g+='\n									<object class="post-video-object" type="application/x-shockwave-flash"\n									        data="http://www.flickr.com/apps/slideshow/show.swf?v=71649">\n										<param name="wmode" value="transparent" />\n										<param name="allowFullScreen" value="true" />\n										<param name="movie" value="http://www.flickr.com/apps/slideshow/show.swf?v=71649" />\n										<param name="flashvars" value="offsite=true&amp;lang=en-us&amp;page_show_url='+ma((e=c.fn_get_flickr_relative_url||a&&a.fn_get_flickr_relative_url,f={hash:{},data:b},e?e.call(a,(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.url),f):la.call(a,"fn_get_flickr_relative_url",(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.url),f)))+"/show/&amp;page_show_back_url="+ma((e=c.fn_get_flickr_relative_url||a&&a.fn_get_flickr_relative_url,f={hash:{},data:b},e?e.call(a,(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.url),f):la.call(a,"fn_get_flickr_relative_url",(d=a&&a.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.url),f)))+"/&amp;set_id="+ma((d=a&&a.media,d=null==d||d===!1?d:d.video,d=null==d||d===!1?d:d.id,typeof d===ka?d.apply(a):d))+'" />\n									</object>\n								'}function s(a,b){var c,d="";return d+='\n									<iframe width="100%" height="450" scrolling="no" frameborder="no" src="'+ma((c=a&&a.media,c=null==c||c===!1?c:c.video,c=null==c||c===!1?c:c.url,typeof c===ka?c.apply(a):c))+'"></iframe>\n								'}function t(a,b){var d,e,f,g="";return g+='\n					<div class="row">\n						<div class="col-sm-12">\n							<div class="post-text font-size-24">\n								',e=c.compare||a&&a.compare,f={hash:{},inverse:na.noop,fn:na.program(6,j,b),data:b},d=e?e.call(a,a&&a.originality_text,"reply",f):la.call(a,"compare",a&&a.originality_text,"reply",f),(d||0===d)&&(g+=d),g+="\n								",d=c.unless.call(a,a&&a.body,{hash:{},inverse:na.noop,fn:na.program(8,k,b),data:b}),(d||0===d)&&(g+=d),g+="\n								",(e=c.body)?d=e.call(a,{hash:{},data:b}):(e=a&&a.body,d=typeof e===ka?e.call(a,{hash:{},data:b}):e),(d||0===d)&&(g+=d),g+='\n							</div>\n						</div>\n					</div>\n					<div class="row">\n						<div class="col-sm-12">\n							',e=c.withFirst||a&&a.withFirst,f={hash:{},inverse:na.noop,fn:na.program(24,u,b),data:b},d=e?e.call(a,(d=a&&a.media,null==d||d===!1?d:d.links),f):la.call(a,"withFirst",(d=a&&a.media,null==d||d===!1?d:d.links),f),(d||0===d)&&(g+=d),g+="\n						</div>\n					</div>\n				"}function u(a,b){var d,e,f,g="";return g+='\n								<div class="post-meta">\n									<div class="row">\n										',e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:na.program(27,w,b),fn:na.program(25,v,b),data:b},d=e?e.call(a,a&&a.image,f):la.call(a,"isNotEmpty",a&&a.image,f),(d||0===d)&&(g+=d),g+='\n											<div class="post-meta-content">\n												',e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:na.program(31,y,b),fn:na.program(29,x,b),data:b},d=e?e.call(a,a&&a.title,f):la.call(a,"isNotEmpty",a&&a.title,f),(d||0===d)&&(g+=d),g+="\n												",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:na.noop,fn:na.program(33,z,b),data:b},d=e?e.call(a,a&&a.url,f):la.call(a,"isNotEmpty",a&&a.url,f),(d||0===d)&&(g+=d),g+="\n												",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:na.noop,fn:na.program(35,A,b),data:b},d=e?e.call(a,a&&a.description,f):la.call(a,"isNotEmpty",a&&a.description,f),(d||0===d)&&(g+=d),g+="\n											</div>\n										</div>\n									</div>\n								</div>\n							"}function v(a,b){var d,e,f="";return f+='\n											<div class="col-xs-3 col-sm-3 col-md-3 no-padding-right">\n												<div class="post-meta-thumbnail"><img src="',(e=c.image)?d=e.call(a,{hash:{},data:b}):(e=a&&a.image,d=typeof e===ka?e.call(a,{hash:{},data:b}):e),f+=ma(d)+'" /></div>\n											</div>\n											<div class="col-xs-9 col-sm-9 col-md-9 no-padding-left">\n										'}function w(a,b){return'\n											<div class="col-sm-12">\n										'}function x(a,b){var d,e,f="";return f+='\n													<div class="post-meta-title"><a href="',(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===ka?e.call(a,{hash:{},data:b}):e),f+=ma(d)+'" target="mig33-new-window">',(e=c.title)?d=e.call(a,{hash:{},data:b}):(e=a&&a.title,d=typeof e===ka?e.call(a,{hash:{},data:b}):e),(d||0===d)&&(f+=d),f+="</a></div>\n												"}function y(a,b){var d,e,f="";return f+='\n													<div class="post-meta-title"><a href="',(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===ka?e.call(a,{hash:{},data:b}):e),f+=ma(d)+'" target="mig33-new-window">',(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===ka?e.call(a,{hash:{},data:b}):e),f+=ma(d)+"</a></div>\n												"}function z(a,b){var d,e,f="";return f+='\n													<div class="post-meta-url"><a href="',(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===ka?e.call(a,{hash:{},data:b}):e),f+=ma(d)+'" target="mig33-new-window">',(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===ka?e.call(a,{hash:{},data:b}):e),f+=ma(d)+"</a></div>\n												"}function A(a,b){var d,e,f="";return f+='\n													<div class="post-meta-description">'+ma((d=c.characterLimiter||a&&a.characterLimiter,e={hash:{},data:b},d?d.call(a,a&&a.description,100,e):la.call(a,"characterLimiter",a&&a.description,100,e)))+"</div>\n												"}function B(a,b){var d,e,f,g="";return g+='\n					<div class="row">\n						',e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:na.noop,fn:na.program(38,C,b),data:b},d=e?e.call(a,(d=a&&a.event,null==d||d===!1?d:d.title),f):la.call(a,"isNotEmpty",(d=a&&a.event,null==d||d===!1?d:d.title),f),(d||0===d)&&(g+=d),g+="\n					</div>\n				"}function C(a,b){var d,e,f,g="";return g+='\n							<div class="col-sm-12">\n								<table cellpadding="0" cellspacing="0" width="100%">\n									<tr>\n										<td valign="top">\n											',e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:na.noop,fn:na.program(39,D,b),data:b},d=e?e.call(a,(d=a&&a.event,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.icon,null==d||d===!1?d:d.size_999),f):la.call(a,"isNotEmpty",(d=a&&a.event,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.icon,null==d||d===!1?d:d.size_999),f),(d||0===d)&&(g+=d),g+='\n										</td>\n										<td class="game-post-text" valign="top">\n											',e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:na.noop,fn:na.program(41,E,b),data:b},d=e?e.call(a,(d=a&&a.event,d=null==d||d===!1?d:d.application,null==d||d===!1?d:d.title),f):la.call(a,"isNotEmpty",(d=a&&a.event,d=null==d||d===!1?d:d.application,null==d||d===!1?d:d.title),f),(d||0===d)&&(g+=d),g+="\n											",d=a&&a.event,d=null==d||d===!1?d:d.title,d=typeof d===ka?d.apply(a):d,(d||0===d)&&(g+=d),g+='\n											<br/><a href="'+ma((d=a&&a.event,d=null==d||d===!1?d:d.custom_url,d=null==d||d===!1?d:d.ajax,typeof d===ka?d.apply(a):d))+'">',d=a&&a.event,d=null==d||d===!1?d:d.template,d=null==d||d===!1?d:d.action_button_title,d=typeof d===ka?d.apply(a):d,(d||0===d)&&(g+=d),g+="</a><br/>\n											",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:na.noop,fn:na.program(43,F,b),data:b},d=e?e.call(a,(d=a&&a.event,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.image,null==d||d===!1?d:d.size_120),f):la.call(a,"isNotEmpty",(d=a&&a.event,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.image,null==d||d===!1?d:d.size_120),f),(d||0===d)&&(g+=d),g+="\n										</td>\n									</tr>\n								</table>\n							</div>\n						"}function D(a,b){var c,d="";return d+='\n												<div class="game-icon">\n													<img src="'+ma((c=a&&a.event,c=null==c||c===!1?c:c.media,c=null==c||c===!1?c:c.icon,c=null==c||c===!1?c:c.size_999,typeof c===ka?c.apply(a):c))+'?w=64&h=64"/>\n												</div>\n											'}function E(a,b){var c,d="";return d+='\n												<strong><a href="'+ma((c=a&&a.event,c=null==c||c===!1?c:c.application,c=null==c||c===!1?c:c.view,c=null==c||c===!1?c:c.ajax,typeof c===ka?c.apply(a):c))+'" class="game-title">'+ma((c=a&&a.event,c=null==c||c===!1?c:c.application,c=null==c||c===!1?c:c.title,typeof c===ka?c.apply(a):c))+"</a></strong><br/>\n											"}function F(a,b){var c,d="";return d+='\n												<div class="post-meta-thumbnail">\n													<a href="'+ma((c=a&&a.event,c=null==c||c===!1?c:c.custom_url,c=null==c||c===!1?c:c.ajax,typeof c===ka?c.apply(a):c))+'"><img src="'+ma((c=a&&a.event,c=null==c||c===!1?c:c.media,c=null==c||c===!1?c:c.image,c=null==c||c===!1?c:c.size_120,typeof c===ka?c.apply(a):c))+'" /></a>\n												</div>\n											'}function G(a,b){var d,e,f,g="";return g+='\n					<div class="row">\n						<div class="col-sm-12">\n							<div class="post-text font-size-24">\n								',e=c.compare||a&&a.compare,f={hash:{},inverse:na.noop,fn:na.program(6,j,b),data:b},d=e?e.call(a,a&&a.originality_text,"reply",f):la.call(a,"compare",a&&a.originality_text,"reply",f),(d||0===d)&&(g+=d),g+="\n								",d=c.unless.call(a,a&&a.body,{hash:{},inverse:na.noop,fn:na.program(8,k,b),data:b}),(d||0===d)&&(g+=d),g+="\n								",(e=c.body)?d=e.call(a,{hash:{},data:b}):(e=a&&a.body,d=typeof e===ka?e.call(a,{hash:{},data:b}):e),(d||0===d)&&(g+=d),g+="\n							</div>\n						</div>\n					</div>\n				"}function H(a,b){var d,e="";return e+="\n					",d=c["if"].call(a,(d=a&&a.root_post,d=null==d||d===!1?d:d.author,null==d||d===!1?d:d.username),{hash:{},inverse:na.noop,fn:na.program(48,I,b),data:b}),(d||0===d)&&(e+=d),e+="\n				"}function I(a,b){var d,e,f,g="";return g+='\n						<div class="row">\n							<div class="col-sm-12">\n								<div class="post-parent">\n									\n									<div class="post-author">\n										<a href="'+ma((d=a&&a.root_post,d=null==d||d===!1?d:d.author,d=null==d||d===!1?d:d.personalized_url,typeof d===ka?d.apply(a):d))+'" title="'+ma((d=a&&a.root_post,d=null==d||d===!1?d:d.author,d=null==d||d===!1?d:d.username,typeof d===ka?d.apply(a):d))+'" class="profile-hovercard" data-username="'+ma((d=a&&a.root_post,d=null==d||d===!1?d:d.author,d=null==d||d===!1?d:d.username,typeof d===ka?d.apply(a):d))+'">'+ma((d=a&&a.root_post,d=null==d||d===!1?d:d.author,d=null==d||d===!1?d:d.username,typeof d===ka?d.apply(a):d))+"</a> "+ma((e=c.userGetLabels||a&&a.userGetLabels,f={hash:{},data:b},e?e.call(a,(d=a&&a.root_post,null==d||d===!1?d:d.author),f):la.call(a,"userGetLabels",(d=a&&a.root_post,null==d||d===!1?d:d.author),f)))+'\n									</div>\n									<div class="post-time font-size-12">\n										<a href="'+ma((d=a&&a.root_post,d=null==d||d===!1?d:d.permalink,typeof d===ka?d.apply(a):d))+'"><time class="timeago" datetime="'+ma((e=c.dateFormat||a&&a.dateFormat,f={hash:{},data:b},e?e.call(a,(d=a&&a.root_post,null==d||d===!1?d:d.timestamp),"isoUtcDateTime",f):la.call(a,"dateFormat",(d=a&&a.root_post,null==d||d===!1?d:d.timestamp),"isoUtcDateTime",f)))+'">'+ma((e=c.getRelativeTimestamp||a&&a.getRelativeTimestamp,f={hash:{},data:b},e?e.call(a,(d=a&&a.root_post,null==d||d===!1?d:d.timestamp),f):la.call(a,"getRelativeTimestamp",(d=a&&a.root_post,null==d||d===!1?d:d.timestamp),f)))+"</time> "+ma((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"post|via",f):la.call(a,"translate","post|via",f)))+" "+ma((d=a&&a.root_post,d=null==d||d===!1?d:d.application_text,typeof d===ka?d.apply(a):d))+"</a>\n									</div>\n\n									\n									",e=c.compare||a&&a.compare,f={hash:{},inverse:na.noop,fn:na.program(49,J,b),data:b},d=e?e.call(a,(d=a&&a.root_post,null==d||d===!1?d:d.type_text),"photo",f):la.call(a,"compare",(d=a&&a.root_post,null==d||d===!1?d:d.type_text),"photo",f),(d||0===d)&&(g+=d),g+="\n\n									\n									",e=c.compare||a&&a.compare,f={hash:{},inverse:na.noop,fn:na.program(57,O,b),data:b},d=e?e.call(a,(d=a&&a.root_post,null==d||d===!1?d:d.type_text),"video",f):la.call(a,"compare",(d=a&&a.root_post,null==d||d===!1?d:d.type_text),"video",f),(d||0===d)&&(g+=d),g+="\n\n									\n									",e=c.compare||a&&a.compare,f={hash:{},inverse:na.noop,fn:na.program(62,R,b),data:b},d=e?e.call(a,(d=a&&a.root_post,null==d||d===!1?d:d.type_text),"link",f):la.call(a,"compare",(d=a&&a.root_post,null==d||d===!1?d:d.type_text),"link",f),(d||0===d)&&(g+=d),g+="\n\n									\n									",e=c.compare||a&&a.compare,f={hash:{},inverse:na.noop,fn:na.program(76,Z,b),data:b},d=e?e.call(a,(d=a&&a.root_post,null==d||d===!1?d:d.type_text),"event",f):la.call(a,"compare",(d=a&&a.root_post,null==d||d===!1?d:d.type_text),"event",f),(d||0===d)&&(g+=d),g+="\n\n									\n									",e=c.compare||a&&a.compare,f={hash:{},inverse:na.noop,fn:na.program(84,ca,b),data:b},d=e?e.call(a,(d=a&&a.root_post,null==d||d===!1?d:d.type_text),"text",f):la.call(a,"compare",(d=a&&a.root_post,null==d||d===!1?d:d.type_text),"text",f),
(d||0===d)&&(g+=d),g+="\n								</div>\n							</div>\n						</div>\n					"}function J(a,b){var d,e,f,g="";return g+="\n										",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:na.noop,fn:na.program(50,K,b),data:b},d=e?e.call(a,(d=a&&a.root_post,null==d||d===!1?d:d.body),f):la.call(a,"isNotEmpty",(d=a&&a.root_post,null==d||d===!1?d:d.body),f),(d||0===d)&&(g+=d),g+='\n										<div class="post-image">\n											\n											',e=c.compare||a&&a.compare,f={hash:{},inverse:na.program(55,N,b),fn:na.program(52,L,b),data:b},d=e?e.call(a,(d=a&&a.root_post,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.photo,null==d||d===!1?d:d.type),"link",f):la.call(a,"compare",(d=a&&a.root_post,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.photo,null==d||d===!1?d:d.type),"link",f),(d||0===d)&&(g+=d),g+="\n										</div>\n									"}function K(a,b){var c,d="";return d+='\n											<div class="post-text">',c=a&&a.root_post,c=null==c||c===!1?c:c.body,c=typeof c===ka?c.apply(a):c,(c||0===c)&&(d+=c),d+="</div>\n										"}function L(a,b){var d,e,f,g="";return g+="\n												",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:na.noop,fn:na.program(53,M,b),data:b},d=e?e.call(a,(d=a&&a.root_post,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.photo,d=null==d||d===!1?d:d.url,null==d||d===!1?d:d.original),f):la.call(a,"isNotEmpty",(d=a&&a.root_post,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.photo,d=null==d||d===!1?d:d.url,null==d||d===!1?d:d.original),f),(d||0===d)&&(g+=d),g+="\n											\n											"}function M(a,b){var c,d="";return d+='\n													<img src="'+ma((c=a&&a.root_post,c=null==c||c===!1?c:c.media,c=null==c||c===!1?c:c.photo,c=null==c||c===!1?c:c.url,c=null==c||c===!1?c:c.original,typeof c===ka?c.apply(a):c))+'" class="post-image-img"/>\n												'}function N(a,b){var d,e,f,g="";return g+='\n												<a href="'+ma((d=a&&a.root_post,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.photo,d=null==d||d===!1?d:d.url,d=null==d||d===!1?d:d.original,typeof d===ka?d.apply(a):d))+'" class="fancybox" rel="homefeed" title="'+ma((d=a&&a.root_post,d=null==d||d===!1?d:d.author,d=null==d||d===!1?d:d.username,typeof d===ka?d.apply(a):d))+": "+ma((e=c.characterLimiter||a&&a.characterLimiter,f={hash:{},data:b},e?e.call(a,(d=a&&a.root_post,null==d||d===!1?d:d.body),100,!0,f):la.call(a,"characterLimiter",(d=a&&a.root_post,null==d||d===!1?d:d.body),100,!0,f)))+'">\n													<img src="'+ma((e=c.fn_post_get_big_image||a&&a.fn_post_get_big_image,f={hash:{},data:b},e?e.call(a,a&&a.root_post,f):la.call(a,"fn_post_get_big_image",a&&a.root_post,f)))+'" class="post-image-img" />\n												</a>\n											'}function O(a,b){var d,e,f,g="";return g+="\n										",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:na.noop,fn:na.program(50,K,b),data:b},d=e?e.call(a,(d=a&&a.root_post,null==d||d===!1?d:d.body),f):la.call(a,"isNotEmpty",(d=a&&a.root_post,null==d||d===!1?d:d.body),f),(d||0===d)&&(g+=d),g+='\n										<div class="post-video">\n											',e=c.compare||a&&a.compare,f={hash:{},inverse:na.noop,fn:na.program(58,P,b),data:b},d=e?e.call(a,(d=a&&a.root_post,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"youtube",f):la.call(a,"compare",(d=a&&a.root_post,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"youtube",f),(d||0===d)&&(g+=d),g+="\n											",e=c.compare||a&&a.compare,f={hash:{},inverse:na.noop,fn:na.program(58,P,b),data:b},d=e?e.call(a,(d=a&&a.root_post,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"vimeo",f):la.call(a,"compare",(d=a&&a.root_post,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"vimeo",f),(d||0===d)&&(g+=d),g+="\n											",e=c.compare||a&&a.compare,f={hash:{},inverse:na.noop,fn:na.program(60,Q,b),data:b},d=e?e.call(a,(d=a&&a.root_post,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"flickr",f):la.call(a,"compare",(d=a&&a.root_post,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.type),"flickr",f),(d||0===d)&&(g+=d),g+="\n										</div>\n									"}function P(a,b){var c,d="";return d+='\n												<object class="post-video-object" type="application/x-shockwave-flash" data="'+ma((c=a&&a.root_post,c=null==c||c===!1?c:c.media,c=null==c||c===!1?c:c.video,c=null==c||c===!1?c:c.url,typeof c===ka?c.apply(a):c))+'">\n													<param name="wmode" value="transparent" />\n													<param name="allowfullscreen" value="true"/>\n													<param name="movie" value="'+ma((c=a&&a.root_post,c=null==c||c===!1?c:c.media,c=null==c||c===!1?c:c.video,c=null==c||c===!1?c:c.url,typeof c===ka?c.apply(a):c))+'"/>\n												</object>\n											'}function Q(a,b){var d,e,f,g="";return g+='\n												<object class="post-video-object" type="application/x-shockwave-flash" data="http://www.flickr.com/apps/slideshow/show.swf?v=71649">\n													<param name="wmode" value="transparent" />\n													<param name="allowFullScreen" value="true"/>\n													<param name="movie" value="http://www.flickr.com/apps/slideshow/show.swf?v=71649"/>\n													<param name="flashvars" value="offsite=true&amp;lang=en-us&amp;page_show_url='+ma((e=c.fn_get_flickr_relative_url||a&&a.fn_get_flickr_relative_url,f={hash:{},data:b},e?e.call(a,(d=a&&a.root_post,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.url),f):la.call(a,"fn_get_flickr_relative_url",(d=a&&a.root_post,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.url),f)))+"/show/&amp;page_show_back_url="+ma((e=c.fn_get_flickr_relative_url||a&&a.fn_get_flickr_relative_url,f={hash:{},data:b},e?e.call(a,(d=a&&a.root_post,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.url),f):la.call(a,"fn_get_flickr_relative_url",(d=a&&a.root_post,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.video,null==d||d===!1?d:d.url),f)))+"/&amp;set_id="+ma((d=a&&a.root_post,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.video,d=null==d||d===!1?d:d.id,typeof d===ka?d.apply(a):d))+'"/>\n												</object>\n											'}function R(a,b){var d,e,f,g="";return g+="\n										",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:na.noop,fn:na.program(50,K,b),data:b},d=e?e.call(a,(d=a&&a.root_post,null==d||d===!1?d:d.body),f):la.call(a,"isNotEmpty",(d=a&&a.root_post,null==d||d===!1?d:d.body),f),(d||0===d)&&(g+=d),g+='\n										<div class="post-link">\n											<div class="row">\n												',e=c.withFirst||a&&a.withFirst,f={hash:{},inverse:na.noop,fn:na.program(63,S,b),data:b},d=e?e.call(a,(d=a&&a.root_post,d=null==d||d===!1?d:d.media,null==d||d===!1?d:d.links),f):la.call(a,"withFirst",(d=a&&a.root_post,d=null==d||d===!1?d:d.media,null==d||d===!1?d:d.links),f),(d||0===d)&&(g+=d),g+="\n											</div>\n										</div>\n									"}function S(a,b){var d,e,f,g="";return g+="\n													",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:na.program(66,U,b),fn:na.program(64,T,b),data:b},d=e?e.call(a,a&&a.image,f):la.call(a,"isNotEmpty",a&&a.image,f),(d||0===d)&&(g+=d),g+="\n														",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:na.program(70,W,b),fn:na.program(68,V,b),data:b},d=e?e.call(a,a&&a.title,f):la.call(a,"isNotEmpty",a&&a.title,f),(d||0===d)&&(g+=d),g+="\n														",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:na.noop,fn:na.program(72,X,b),data:b},d=e?e.call(a,a&&a.url,f):la.call(a,"isNotEmpty",a&&a.url,f),(d||0===d)&&(g+=d),g+="\n														",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:na.noop,fn:na.program(74,Y,b),data:b},d=e?e.call(a,a&&a.description,f):la.call(a,"isNotEmpty",a&&a.description,f),(d||0===d)&&(g+=d),g+="\n													</div>\n												"}function T(a,b){var d,e,f="";return f+='\n														<div class="col-sm-2 no-padding-right">\n															<div class="post-meta-thumbnail">\n																<img src="',(e=c.image)?d=e.call(a,{hash:{},data:b}):(e=a&&a.image,d=typeof e===ka?e.call(a,{hash:{},data:b}):e),f+=ma(d)+'" />\n															</div>\n														</div>\n														<div class="col-sm-10 no-padding-left">\n													'}function U(a,b){return'\n														<div class="col-sm-12">\n													'}function V(a,b){var d,e,f="";return f+='\n															<div class="post-meta-title"><a href="',(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===ka?e.call(a,{hash:{},data:b}):e),f+=ma(d)+'" target="mig33-new-window">',(e=c.title)?d=e.call(a,{hash:{},data:b}):(e=a&&a.title,d=typeof e===ka?e.call(a,{hash:{},data:b}):e),(d||0===d)&&(f+=d),f+="</a></div>\n														"}function W(a,b){var d,e,f="";return f+='\n															<div class="post-meta-title"><a href="',(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===ka?e.call(a,{hash:{},data:b}):e),f+=ma(d)+'" target="mig33-new-window">',(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===ka?e.call(a,{hash:{},data:b}):e),f+=ma(d)+"</a></div>\n														"}function X(a,b){var d,e,f="";return f+='\n															<div class="post-meta-url"><a href="',(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===ka?e.call(a,{hash:{},data:b}):e),f+=ma(d)+'" target="mig33-new-window">',(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===ka?e.call(a,{hash:{},data:b}):e),f+=ma(d)+"</a></div>\n														"}function Y(a,b){var d,e,f="";return f+='\n															<div class="post-meta-description">'+ma((d=c.characterLimiter||a&&a.characterLimiter,e={hash:{},data:b},d?d.call(a,a&&a.description,100,e):la.call(a,"characterLimiter",a&&a.description,100,e)))+"</div>\n														"}function Z(a,b){var d,e,f,g="";return g+="\n										",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:na.noop,fn:na.program(77,$,b),data:b},d=e?e.call(a,(d=a&&a.root_post,d=null==d||d===!1?d:d.event,null==d||d===!1?d:d.title),f):la.call(a,"isNotEmpty",(d=a&&a.root_post,d=null==d||d===!1?d:d.event,null==d||d===!1?d:d.title),f),(d||0===d)&&(g+=d),g+="\n									"}function $(a,b){var d,e,f,g="";return g+='\n											<div class="post-text">\n												<table cellpadding="0" cellspacing="0" width="100%">\n													<tr>\n														<td valign="top">\n															',e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:na.noop,fn:na.program(78,_,b),data:b},d=e?e.call(a,(d=a&&a.root_post,d=null==d||d===!1?d:d.event,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.icon,null==d||d===!1?d:d.size_999),f):la.call(a,"isNotEmpty",(d=a&&a.root_post,d=null==d||d===!1?d:d.event,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.icon,null==d||d===!1?d:d.size_999),f),(d||0===d)&&(g+=d),g+='\n														</td>\n														<td class="game-post-text" valign="top">\n															',e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:na.noop,fn:na.program(80,aa,b),data:b},d=e?e.call(a,(d=a&&a.root_post,d=null==d||d===!1?d:d.event,d=null==d||d===!1?d:d.application,null==d||d===!1?d:d.title),f):la.call(a,"isNotEmpty",(d=a&&a.root_post,d=null==d||d===!1?d:d.event,d=null==d||d===!1?d:d.application,null==d||d===!1?d:d.title),f),(d||0===d)&&(g+=d),g+="\n															",d=a&&a.root_post,d=null==d||d===!1?d:d.event,d=null==d||d===!1?d:d.title,d=typeof d===ka?d.apply(a):d,(d||0===d)&&(g+=d),g+='\n															<br />\n															<a href="'+ma((d=a&&a.root_post,d=null==d||d===!1?d:d.event,d=null==d||d===!1?d:d.custom_url,d=null==d||d===!1?d:d.ajax,typeof d===ka?d.apply(a):d))+'">',d=a&&a.root_post,d=null==d||d===!1?d:d.event,d=null==d||d===!1?d:d.template,d=null==d||d===!1?d:d.action_button_title,d=typeof d===ka?d.apply(a):d,(d||0===d)&&(g+=d),g+="</a>\n															<br />\n															",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:na.noop,fn:na.program(82,ba,b),data:b},d=e?e.call(a,(d=a&&a.root_post,d=null==d||d===!1?d:d.vent,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.image,null==d||d===!1?d:d.size_120),f):la.call(a,"isNotEmpty",(d=a&&a.root_post,d=null==d||d===!1?d:d.vent,d=null==d||d===!1?d:d.media,d=null==d||d===!1?d:d.image,null==d||d===!1?d:d.size_120),f),(d||0===d)&&(g+=d),g+="\n														</td>\n													</tr>\n												</table>\n											</div>\n										"}function _(a,b){var c,d="";return d+='\n																<div class="game-icon">\n																	<img src="'+ma((c=a&&a.root_post,c=null==c||c===!1?c:c.event,c=null==c||c===!1?c:c.media,c=null==c||c===!1?c:c.icon,c=null==c||c===!1?c:c.size_999,typeof c===ka?c.apply(a):c))+'?w=64&h=64"/>\n																</div>\n															'}function aa(a,b){var c,d="";return d+='\n																<strong><a href="'+ma((c=a&&a.root_post,c=null==c||c===!1?c:c.event,c=null==c||c===!1?c:c.application,c=null==c||c===!1?c:c.view,c=null==c||c===!1?c:c.ajax,typeof c===ka?c.apply(a):c))+'" class="game-title">'+ma((c=a&&a.root_post,c=null==c||c===!1?c:c.event,c=null==c||c===!1?c:c.application,c=null==c||c===!1?c:c.title,typeof c===ka?c.apply(a):c))+"</a></strong><br/>\n															"}function ba(a,b){var c,d="";return d+='\n																<div class="post-meta-thumbnail">\n																	<a href="'+ma((c=a&&a.root_post,c=null==c||c===!1?c:c.event,c=null==c||c===!1?c:c.custom_url,c=null==c||c===!1?c:c.ajax,typeof c===ka?c.apply(a):c))+'"><img src="'+ma((c=a&&a.root_post,c=null==c||c===!1?c:c.event,c=null==c||c===!1?c:c.media,c=null==c||c===!1?c:c.image,c=null==c||c===!1?c:c.size_120,typeof c===ka?c.apply(a):c))+'" /></a>\n																</div>\n															'}function ca(a,b){var d,e,f,g="";return g+="\n										",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:na.noop,fn:na.program(50,K,b),data:b},d=e?e.call(a,(d=a&&a.root_post,null==d||d===!1?d:d.body),f):la.call(a,"isNotEmpty",(d=a&&a.root_post,null==d||d===!1?d:d.body),f),(d||0===d)&&(g+=d),g+="\n									"}function da(a,b){var d,e="";return e+="\n				",d=c["if"].call(a,(d=a&&a.author,null==d||d===!1?d:d.username),{hash:{},inverse:na.program(89,fa,b),fn:na.program(87,ea,b),data:b}),(d||0===d)&&(e+=d),e+="\n			"}function ea(a,b){var d,e,f,g="";return g+="\n					"+ma((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"post|post_is_private",(d=a&&a.author,null==d||d===!1?d:d.username),f):la.call(a,"translate","post|post_is_private",(d=a&&a.author,null==d||d===!1?d:d.username),f)))+"\n				"}function fa(a,b){var d,e,f="";return f+="\n					"+ma((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"post|this_post_is_private",e):la.call(a,"translate","post|this_post_is_private",e)))+"\n				"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var ga,ha,ia,ja="",ka="function",la=c.helperMissing,ma=this.escapeExpression,na=this,oa=c.blockHelperMissing;return ja+='<div class="post">\n	<div class="row">\n		<div class="col-sm-12">\n			',ia={hash:{},inverse:na.program(86,da,e),fn:na.program(1,f,e),data:e},(ha=c.ifCanViewFeedOrPost)?ga=ha.call(b,ia):(ha=b&&b.ifCanViewFeedOrPost,ga=typeof ha===ka?ha.call(b,ia):ha),c.ifCanViewFeedOrPost||(ga=oa.call(b,ga,{hash:{},inverse:na.program(86,da,e),fn:na.program(1,f,e),data:e})),(ga||0===ga)&&(ja+=ga),ja+="\n		</div>\n	</div>\n</div>"})}),define("modules/view/post/single_post_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/globals/variable","hbs!modules/template/post/single-post-details","modules/template/helpers/general_helpers","modules/template/helpers/post_helpers","jquery.scrollTo","jquery.timeago","fancybox"],function(a,b,c,d,e,f,g,h,i,j){var k=e.ItemView.extend({template:{type:"handlebars",template:j},className:"box",id:function(){return"post-"+this.model.get("id")},initialize:function(){var a=this;this.model.on("sync",function(){a.render()})},onRender:function(){var c=this.model.get("author"),d=this.model.get("body_snippet");if(c&&d){var e=this.model.get("type_text");if("event"==e){var f=this.model.get("event");a.isUndefined(f)||null===f?h.show_document_title(c.username+" on migme"):h.show_document_title(f.title+" - "+c.username+" on migme")}else null!==c&&1===parseInt(this.model.get("status"),10)&&h.show_document_title(this.model.get("body_snippet")+" - "+c.username+" on migme")}b("time.timeago",this.$el).timeago(),h.createFancyBox(b(".fancybox",this.$el)),h.parse_profile_hovercard(this)}});return k}),define("hbs!modules/template/post/single-post-ef",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f,h="";return h+="\n	",f={hash:{},inverse:s.noop,fn:s.program(2,g,b),data:b},(e=c.ifLoggedIn)?d=e.call(a,f):(e=a&&a.ifLoggedIn,d=typeof e===p?e.call(a,f):e),c.ifLoggedIn||(d=t.call(a,d,{hash:{},inverse:s.noop,fn:s.program(2,g,b),data:b})),(d||0===d)&&(h+=d),h+="\n"}function g(a,b){var d,e,f,g="";return g+='\n		<div class="ef-selector-row">\n			<div class="display-inline-block no-padding-right">\n				<div class="ef-selector">\n					<a href="#"\n					   data-title="'+q((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"post|emotional_i_feel",f):r.call(a,"translate","post|emotional_i_feel",f)))+'"\n					   data-toggle="clickover"\n					   data-placement="bottom"\n					   data-html="true"\n					   data-container=".ef-selector-row"\n					   data-animation="false"\n					   data-content="\n		               ',f={hash:{},inverse:s.noop,fn:s.program(3,h,b),data:b},(e=c.tag_properties)?d=e.call(a,f):(e=a&&a.tag_properties,d=typeof e===p?e.call(a,f):e),c.tag_properties||(d=t.call(a,d,{hash:{},inverse:s.noop,fn:s.program(3,h,b),data:b})),(d||0===d)&&(g+=d),g+='"\n					>\n						<span class="icon-wb_emoticon"></span>\n						&nbsp;',d=c["if"].call(a,a&&a.total_count,{hash:{},inverse:s.program(11,m,b),fn:s.program(9,l,b),data:b}),(d||0===d)&&(g+=d),g+='&nbsp;\n						<span class="icon-wb_arrowDown" style="font-size: 12px; height: 14px;"></span>\n					</a>\n				</div>\n			</div>\n			<div class="display-inline-block no-padding-left">\n				<div class="ef-users">\n					',e=c.key_value||a&&a.key_value,f={hash:{},inverse:s.noop,fn:s.program(13,n,b),data:b},d=e?e.call(a,a&&a.usernames,f):r.call(a,"key_value",a&&a.usernames,f),(d||0===d)&&(g+=d),g+="\n				</div>\n			</div>\n		</div>\n	"}function h(a,b){var d,e="";return e+="\n						   ",d=c["if"].call(a,a&&a.id,{hash:{},inverse:s.noop,fn:s.program(4,i,b),data:b}),(d||0===d)&&(e+=d),e+="\n					   "}function i(a,b){var d,e,f,g="";return g+="\n							   ",e=c.compare||a&&a.compare,f={hash:{},inverse:s.program(7,k,b),fn:s.program(5,j,b),data:b},d=e?e.call(a,(d=a&&a.requesting_user_tag_id,null==d||d===!1?d:d.tag_id),a&&a.id,f):r.call(a,"compare",(d=a&&a.requesting_user_tag_id,null==d||d===!1?d:d.tag_id),a&&a.id,f),(d||0===d)&&(g+=d),g+="\n						   "}function j(a,b){var d,e,f,g="";return g+="\n		                            <a href='#' class='tag-post active' data-tag_type='emotion' data-tag_id='",(e=c.id)?d=e.call(a,{hash:{},data:b}):(e=a&&a.id,d=typeof e===p?e.call(a,{hash:{},data:b}):e),g+=q(d)+"' title='",(e=c.label)?d=e.call(a,{hash:{},data:b}):(e=a&&a.label,d=typeof e===p?e.call(a,{hash:{},data:b}):e),g+=q(d)+"'><img src='"+q((e=c.getPostTagPropertyImage||a&&a.getPostTagPropertyImage,f={hash:{},data:b},e?e.call(a,a&&a.image,24,f):r.call(a,"getPostTagPropertyImage",a&&a.image,24,f)))+"' width='24' height='24' /></a>\n				                "}function k(a,b){var d,e,f,g="";return g+="\n					                <a href='#' class='tag-post' data-tag_type='emotion' data-tag_id='",(e=c.id)?d=e.call(a,{hash:{},data:b}):(e=a&&a.id,d=typeof e===p?e.call(a,{hash:{},data:b}):e),g+=q(d)+"' title='",(e=c.label)?d=e.call(a,{hash:{},data:b}):(e=a&&a.label,d=typeof e===p?e.call(a,{hash:{},data:b}):e),g+=q(d)+"'><img src='"+q((e=c.getPostTagPropertyImage||a&&a.getPostTagPropertyImage,f={hash:{},data:b},e?e.call(a,a&&a.image,24,f):r.call(a,"getPostTagPropertyImage",a&&a.image,24,f)))+"' width='24' height='24' /></a>\n				                "}function l(a,b){var d,e;return(e=c.total_count)?d=e.call(a,{hash:{},data:b}):(e=a&&a.total_count,d=typeof e===p?e.call(a,{hash:{},data:b}):e),q(d)}function m(a,b){var c="";return c}function n(a,b){var d,e,f,g="";return g+='\n						<a href="'+q((e=c.getProfileUrl||a&&a.getProfileUrl,f={hash:{},data:b},e?e.call(a,(d=a&&a.value,null==d||d===!1?d:d.username),f):r.call(a,"getProfileUrl",(d=a&&a.value,null==d||d===!1?d:d.username),f)))+'" class="profile-hovercard img-circle" style="background: top left no-repeat url(\''+q((e=c.getDisplayPictureUrl||a&&a.getDisplayPictureUrl,f={hash:{},data:b},e?e.call(a,(d=a&&a.value,null==d||d===!1?d:d.username),2,36,36,f):r.call(a,"getDisplayPictureUrl",(d=a&&a.value,null==d||d===!1?d:d.username),2,36,36,f)))+'\');" data-username="'+q((d=a&&a.value,d=null==d||d===!1?d:d.username,typeof d===p?d.apply(a):d))+'">\n							<span class="ef-user-selected wb wb-16" style="background:top left no-repeat url(\''+q((e=c.getUrl||a&&a.getUrl,f={hash:{},data:b},e?e.call(a,"cdn",f):r.call(a,"getUrl","cdn",f)))+"/"+q((d=a&&a.value,d=null==d||d===!1?d:d.image,d=null==d||d===!1?d:d.size_16,typeof d===p?d.apply(a):d))+"');\"></span>\n						</a>\n					"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var o,p="function",q=this.escapeExpression,r=c.helperMissing,s=this,t=c.blockHelperMissing;return o=c["if"].call(b,b&&b.tag_properties,{hash:{},inverse:s.noop,fn:s.program(1,f,e),data:e}),o||0===o?o:""})}),define("modules/view/post/single_post_ef_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/post/single-post-ef","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers","bootstrapx-clickover"],function(a,b,c,d,e,f,g,h,i){var j=e.ItemView.extend({template:{type:"handlebars",template:g},className:"post-ef",initialize:function(a){this.options=a},events:{"click .tag-post":"tagPost"},onRender:function(){var a=b(".ef-selector",this.$el).parent();b("a",this.$el).clickover({global_close:!0,onShown:function(){a.addClass("post-reaction-active")},onHidden:function(){a.removeClass("post-reaction-active")}}),b(".ef-selector a",this.$el).attr("title",i.translate("post|emotional_i_feel")),i.parse_profile_hovercard(this)},tagPost:function(a){if(a.preventDefault(),!i.is_logged_in())return void i.show_login_dialog();var c=b(a.currentTarget,this.$el),d=this.options.postModel.tagPost(c.data("tag_type"),c.data("tag_id"));d.done(function(a){})}});return j}),define("hbs!modules/template/post/single-post-responses-layout",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e="";return e+='\n						<li class="post-reaction post-reaction-watch">\n							',d=c["if"].call(a,a&&a.is_watching,{hash:{},inverse:A.program(4,h,b),fn:A.program(2,g,b),data:b}),(d||0===d)&&(e+=d),e+="\n						</li>\n					"}function g(a,b){var d,e,f="";return f+='\n								<a href="#" class="watch-post watched" title="'+z((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"post|unfavourite",e):y.call(a,"translate","post|unfavourite",e)))+'"><span class="icon-wb_like"></span></a>\n							'}function h(a,b){var d,e,f="";return f+='\n								<a href="#" class="watch-post watch" title="'+z((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"post|favourite",e):y.call(a,"translate","post|favourite",e)))+'"><span class="icon-wb_favourite"></span></a>\n							'}function i(a,b){var d,e,f="";return f+='\n						<li class="post-reaction post-reaction-reply">\n							<a href="#" class="show-reply" title="'+z((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"post|reply",e):y.call(a,"translate","post|reply",e)))+'">\n								<span class="icon-wb_reply"></span>\n							</a>\n						</li>\n						<li class="post-reaction post-reaction-share">\n							<a href="#" class="show-share" title="'+z((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"common|share",e):y.call(a,"translate","common|share",e)))+'">\n								<span class="icon-wb_mb_share"></span>\n							</a>\n						</li>\n					'}function j(a,b){var d,e,f,g="";return g+='\n								<li><a href="#" class="delete-post">'+z((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"common|delete",f):y.call(a,"translate","common|delete",f)))+"</a></li>\n								",e=c.ifSystemPropertyEnabled||a&&a.ifSystemPropertyEnabled,f={hash:{},inverse:A.noop,fn:A.program(9,k,b),data:b},d=e?e.call(a,"post_reply_permission",f):y.call(a,"ifSystemPropertyEnabled","post_reply_permission",f),(d||0===d)&&(g+=d),g+="\n							"}function k(a,b){var d,e,f,g="";return g+="\n									",e=c.compare||a&&a.compare,f={hash:{},inverse:A.program(12,m,b),fn:A.program(10,l,b),data:b},d=e?e.call(a,a&&a.reply_permission,0,f):y.call(a,"compare",a&&a.reply_permission,0,f),(d||0===d)&&(g+=d),g+="\n								"}function l(a,b){var d,e,f="";return f+='\n										<li><a href="#" class="lock-post lock">'+z((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"common|lock",e):y.call(a,"translate","common|lock",e)))+"</a></li>\n									"}function m(a,b){var d,e,f="";return f+='\n										<li><a href="#" class="lock-post unlock">'+z((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"common|unlock",e):y.call(a,"translate","common|unlock",e)))+"</a></li>\n									"}function n(a,b){var d,e,f="";return f+='\n								<li><a href="#" class="report-post">'+z((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"common|report",e):y.call(a,"translate","common|report",e)))+"</a></li>\n							"}function o(a,b){var d,e,f="";return f+="\n								"+z((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"post|like",a&&a.watcher_count,e):y.call(a,"translate","post|like",a&&a.watcher_count,e)))+"\n							"}function p(a,b){var d,e,f="";return f+="\n								"+z((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"post|likes",a&&a.watcher_count,e):y.call(a,"translate","post|likes",a&&a.watcher_count,e)))+"\n							"}function q(a,b){var d,e,f="";return f+="\n								"+z((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"post|view_reply",a&&a.num_of_replies,e):y.call(a,"translate","post|view_reply",a&&a.num_of_replies,e)))+"\n							"}function r(a,b){var d,e,f="";return f+="\n								"+z((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"post|view_replies",a&&a.num_of_replies,e):y.call(a,"translate","post|view_replies",a&&a.num_of_replies,e)))+"\n							"}function s(a,b){var d,e,f="";return f+="\n								"+z((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"post|share",a&&a.num_of_reshares,e):y.call(a,"translate","post|share",a&&a.num_of_reshares,e)))+"\n							"}function t(a,b){var d,e,f="";return f+="\n								"+z((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"post|shares",a&&a.num_of_reshares,e):y.call(a,"translate","post|shares",a&&a.num_of_reshares,e)))+"\n							"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var u,v,w,x="",y=c.helperMissing,z=this.escapeExpression,A=this,B="function",C=c.blockHelperMissing;return x+='<div class="row">\n	<div class="col-xs-12 post-footer">\n		<div class="row">\n			<div class="col-xs-12">\n				<ul class="list-inline post-reactions">\n					\n					<!-- <li class="post-reaction post-reaction-gift">\n						<a href="#" class="btn-send-gift" title="'+z((v=c.translate||b&&b.translate,w={hash:{},data:e},v?v.call(b,"post|send_gift",w):y.call(b,"translate","post|send_gift",w)))+'">\n							<span class="icon-wb_gift"></span>\n						</a>\n					</li> -->\n\n					',w={hash:{},inverse:A.noop,fn:A.program(1,f,e),data:e},(v=c.ifPostCanBeWatched)?u=v.call(b,w):(v=b&&b.ifPostCanBeWatched,u=typeof v===B?v.call(b,w):v),c.ifPostCanBeWatched||(u=C.call(b,u,{hash:{},inverse:A.noop,fn:A.program(1,f,e),data:e})),(u||0===u)&&(x+=u),x+="\n\n					",w={hash:{},inverse:A.noop,fn:A.program(6,i,e),data:e},(v=c.ifPostCanBeReshared)?u=v.call(b,w):(v=b&&b.ifPostCanBeReshared,u=typeof v===B?v.call(b,w):v),c.ifPostCanBeReshared||(u=C.call(b,u,{hash:{},inverse:A.noop,fn:A.program(6,i,e),data:e})),(u||0===u)&&(x+=u),x+='\n\n					\n					<li class="post-reaction post-emotional-footprints"></li>\n\n					<li class="post-reaction post-options">\n						<a class="dropdown-toggle" title="'+z((v=c.translate||b&&b.translate,w={hash:{},data:e},v?v.call(b,"post|options",w):y.call(b,"translate","post|options",w)))+'" data-toggle="dropdown" type="button" href="#">\n							<span class="icon-wb_more font-color-grey"></span>\n						</a>\n						<ul class="dropdown-menu text-left" role="menu">\n							<li>\n								<a href="',(v=c.permalink)?u=v.call(b,{hash:{},data:e}):(v=b&&b.permalink,u=typeof v===B?v.call(b,{hash:{},data:e}):v),x+=z(u)+'">'+z((v=c.translate||b&&b.translate,w={hash:{},data:e},v?v.call(b,"post|view_details",w):y.call(b,"translate","post|view_details",w)))+"</a>\n							</li>\n							",w={hash:{},inverse:A.program(14,n,e),fn:A.program(8,j,e),data:e},(v=c.ifPostCanBeDeleted)?u=v.call(b,w):(v=b&&b.ifPostCanBeDeleted,u=typeof v===B?v.call(b,w):v),c.ifPostCanBeDeleted||(u=C.call(b,u,{hash:{},inverse:A.program(14,n,e),fn:A.program(8,j,e),data:e})),(u||0===u)&&(x+=u),x+='\n						</ul>\n					</li>\n				</ul>\n			</div>\n		</div>\n	</div>\n</div>\n<div class="row">\n	<div class="col-sm-12">\n		<div class="post-responses tab-content">\n			<div class="post-replies-pane tab-pane">\n				<div class="row no-margin">\n					<div class="col-sm-12">\n						<span class="responses-more responses-more-like font-size-12">\n							',v=c.compare||b&&b.compare,w={hash:{operator:"<="},inverse:A.noop,fn:A.program(16,o,e),data:e},u=v?v.call(b,b&&b.watcher_count,"1",w):y.call(b,"compare",b&&b.watcher_count,"1",w),(u||0===u)&&(x+=u),x+="\n							",v=c.compare||b&&b.compare,w={hash:{operator:">"},inverse:A.noop,fn:A.program(18,p,e),data:e},u=v?v.call(b,b&&b.watcher_count,"1",w):y.call(b,"compare",b&&b.watcher_count,"1",w),(u||0===u)&&(x+=u),x+='\n						</span>\n						<span class="responses-more responses-more-reply font-size-12">\n							',v=c.compare||b&&b.compare,w={hash:{operator:"<="},inverse:A.noop,fn:A.program(20,q,e),data:e},u=v?v.call(b,b&&b.num_of_replies,"1",w):y.call(b,"compare",b&&b.num_of_replies,"1",w),(u||0===u)&&(x+=u),x+="\n							",v=c.compare||b&&b.compare,w={hash:{operator:">"},inverse:A.noop,fn:A.program(22,r,e),data:e},u=v?v.call(b,b&&b.num_of_replies,"1",w):y.call(b,"compare",b&&b.num_of_replies,"1",w),(u||0===u)&&(x+=u),x+='\n						</span>\n						<span class="responses-more responses-more-reshare font-size-12">\n							',v=c.compare||b&&b.compare,w={hash:{operator:"<="},inverse:A.noop,fn:A.program(24,s,e),data:e},u=v?v.call(b,b&&b.num_of_reshares,"1",w):y.call(b,"compare",b&&b.num_of_reshares,"1",w),(u||0===u)&&(x+=u),x+="\n							",v=c.compare||b&&b.compare,w={hash:{operator:">"},inverse:A.noop,fn:A.program(26,t,e),data:e},u=v?v.call(b,b&&b.num_of_reshares,"1",w):y.call(b,"compare",b&&b.num_of_reshares,"1",w),(u||0===u)&&(x+=u),x+='\n						</span>\n					</div>\n				</div>\n				<div class="row no-margin">\n					<div class="col-sm-12">\n						<div class="responses-more responses-show-more-reply font-size-12">\n							<a href="#" class="more-reply">'+z((v=c.translate||b&&b.translate,w={hash:{},data:e},v?v.call(b,"common|show_more",w):y.call(b,"translate","common|show_more",w)))+'</a>\n						</div>\n					</div>\n				</div>\n				<div class="responses"><div class="responses-empty">'+z((v=c.translate||b&&b.translate,w={hash:{},data:e},v?v.call(b,"post|empty_replies",w):y.call(b,"translate","post|empty_replies",w)))+'</div></div>\n				<div class="response-form fixed--bottom non-logged-in">\n					<div class="row">\n						<div class="col-xs-12">\n							<div class="response-box">\n								<div class="postbox-reply main-reply-box"></div>\n								<div class="response-lock-message">'+z((v=c.translate||b&&b.translate,w={hash:{},data:e},v?v.call(b,"post|this_post_is_locked",w):y.call(b,"translate","post|this_post_is_locked",w)))+"</div>\n							</div>\n						</div>\n					</div>\n				</div>\n			</div>\n		</div>\n	</div>\n</div>\n"})}),define("modules/view/post/single_post_responses_layout",["jquery","underscore","backbone","handlebars","modules/mig33_app","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/globals/variable","modules/view/common/postbox_view","hbs!modules/template/post/single-post-responses-layout","modules/template/helpers/general_helpers","modules/template/helpers/post_helpers"],function(a,b,c,d,e,f,g,h,i,j,k,l){
var m=f.Layout.extend({template:{type:"handlebars",template:l},regions:{postReplies:".post-replies-pane .responses",postReshares:".post-reshares-pane .responses",postboxReply:".postbox-reply",postboxReshare:".postbox-repost"},events:{"click .watch-post":"watchPost","click .report-post":"reportPost","click .delete-post":"deletePost","click .email-post":"emailPost","click .share-link":"shareLink","click .lock-post":"setReplyPermission","click .unlock-post":"setReplyPermission",'click input[name="post_permalink"]':"selectPostPermalink","click .share-to-facebook":"shareToFacebook","click .share-to-twitter":"shareToTwitter","click .more-reply":"moreReply","click .more-reshare":"moreReshare","click .show-reply":"showReply","click .show-reshare":"showReshare","click .show-share":"showShare","click .btn-send-gift":"showGift"},initialize:function(){var a=this;e.vent.on(e.ApplicationEvents.POST_REPLY_ADDED,function(b){a.moveToReply(b.id)}),this.model.bind("change:num_of_replies",this.updateReplyCount),this.model.bind("change:num_of_reshares",this.updateShareCount),this.model.bind("change:watcher_count",this.updateLikeCount)},onBeforeClose:function(){this.model.off("change:num_of_replies",this.updateReplyCount),this.model.off("change:num_of_reshares",this.updateShareCount),this.model.off("change:watcher_count",this.updateLikeCount)},updateLikeCount:function(b){a(".responses-more-like",this.$el).text(i.translate("post|like",i.add_thousands_seperator(b.get("watcher_count"))))},updateReplyCount:function(b){a(".responses-more-reply .more-reply",this.$el).text(i.translate("post|view_replies",i.add_thousands_seperator(b.get("num_of_replies"))))},updateShareCount:function(b){a(".responses-more-reshare",this.$el).text(i.translate("post|shares",i.add_thousands_seperator(b.get("num_of_reshares"))))},onRender:function(){var c=this;a(".postbox-reply",this.$el).hide(),this.postboxReply.show(new k({collapsible:!1,originality:2,parent_post:this.model,top:!0})),this.allow_response(),1===parseInt(i.get_query_params_by_name("reshare"),10)?b.delay(function(){c.showReshare(null)},100):1===parseInt(i.get_query_params_by_name("share"),10)&&b.delay(function(){c.showShare(null)},100),a(".to",this.$el).tagit({fieldName:"to",caseSensitive:!1,tagLimit:5,onTagLimitExceeded:function(){i.show_error(i.translate("discover|error_emails_exceeded",5))},beforeTagAdded:function(b,d){var e=/^(([^<>()\[\]\\.,;:\s@\"]+(\.[^<>()\[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,f=a(d.tag[0]).text(),g=f.substr(0,f.length-1),h=e.test(g);return h?void 0:(i.show_error(i.translate("discover|error_valid_email",g)),a('input[name="email_post"]',c.$el).prop("disabled",!0),!1)},afterTagAdded:function(){a('input[name="email_post"]',c.$el).prop("disabled",!1)}}),a(".post-reaction > a, .post-reaction a.dropdown-toggle",this.$el).qtip({content:{text:function(){return a(this).data("title")?a(this).data("title"):a(this).attr("title")}},position:{my:"bottom center",at:"top center"},style:{classes:"qtip-post",def:!1},hide:{event:"click mouseleave"}}),a(".post-responses",this.$el).show(),this.model.get("num_of_replies")<=h.posts.replies.limit&&this.hideMoreReply(),a(".post-root, .post-parent").parent().removeClass("postStyle"),a(".post-root .post-text, .post-parent .post-text").readmore({speed:75,lessLink:'<a href="#" class="readmore-toggle">'+i.translate("common|less")+"</a>",moreLink:'<a href="#" class="readmore-toggle" >'+i.translate("common|more")+"</a>",collapsedHeight:120,heightMargin:16})},allow_response:function(){1===this.model.get("reply_permission")?this.hideReponseBox():this.showReponseBox()},_check_response:function(){var b=a(".response-form",this.$el),c=a(".post-responses .responses",this.$el),d=a(".postbox-reply",this.$el),e=c.offset().top+c.outerHeight()-c.css("padding-bottom").replace("px",""),f=b.height();if("none"==d.css("display")){var g=d.attr("style");d.css({visibility:"hidden",display:"block"}),f=b.height(),d.attr("style",g?g:"")}a(window).height()<e+f?(b.addClass("fixed--bottom"),c.css("padding-bottom",f),b.width(a(".post-responses-container").width()-2)):(b.removeClass("fixed--bottom"),c.css("padding-bottom",""),b.css("width",""))},watchPost:function(b){if(b.preventDefault(),!i.is_logged_in())return void i.show_login_dialog();var c,d=a(b.currentTarget);c=d.hasClass("watched")?this.model.unwatchPost():this.model.watchPost(),c.done(function(b){b=i.parse_ajax_response(b),b&&(d.hasClass("watched")?d.attr("title",i.translate("post|favourite")):d.attr("title",i.translate("post|unfavourite")),d.toggleClass("watch watched"),a('span[class*="icon-wb_fav"]',d).toggleClass("icon-wb_favourite icon-wb_like"))})},reportPost:function(b){if(b.preventDefault(),!i.is_logged_in())return void i.show_login_dialog();if(window.confirm(i.translate("post|confirm_report"))){var c,d=a(b.currentTarget);if(d.hasClass("reported"))return;c=this.model.reportPost(),c.done(function(a){a=i.parse_ajax_response(a),a.error?i.show_error(i.translate("post|error_report")):(d.text(i.translate("common|reported")),i.show_success(i.translate("post|success_report")),d.addClass("reported").fadeOut())})}},deletePost:function(a){if(a.preventDefault(),!i.is_logged_in())return void i.show_login_dialog();if(window.confirm(i.translate("post|confirm_delete"))){var b=this.model.deletePost();b.done(function(a){a=i.parse_ajax_response(a),a?(i.show_success(i.translate("post|success_delete")),c.history.navigate("/home",{trigger:!0})):i.show_error(i.translate("post|error_delete"))})}},emailPost:function(b){b.preventDefault();var c=this,d=a(".to",this.$el).val();if(0===d.length)return void i.show_error(i.translate("email|empty_email"));var e={to:d.split(","),subject:a('input[name="form_subject"]',this.$el).val(),body:a('textarea[name="form_body"]',this.$el).val(),post_id:c.model.get("id")},f=a.ajax({type:"post",contentType:"application/json",data:a.toJSON(e),url:i.format(h.urls.email_post,c.model.get("id"))});f.done(function(b){b=i.parse_ajax_response(b),"ok"===b?i.show_success(i.translate("post|success_email_send",d)):i.show_error(i.translate("post|error_email_send",d)),a('input[name="email_post"]',c.$el).prop("disabled",!0),a(".to",c.$el).tagit("removeAll"),a(".share-to-email-modal",c.$el).modal("hide")}),f.fail(function(a,b,c){i.show_error(c)})},selectPostPermalink:function(b){b.preventDefault(),a(b.currentTarget).select()},shareToFacebook:function(a){a.preventDefault(),this._openPopupWindow("http://www.facebook.com/sharer.php?u="+this.model.get("permalink"))},shareToTwitter:function(a){a.preventDefault();var b=this.model.get("body_snippet")+". By @"+this.model.get("author").username,c="https://twitter.com/share?via=migmehq&url="+this.model.get("permalink")+"&text="+b;this._openPopupWindow(c)},setReplyPermission:function(b){if(b.preventDefault(),!i.is_logged_in())return void i.show_login_dialog();var c,d=this,e=a(b.currentTarget);c=e.hasClass("lock")?this.model.setReplyPermission(1):this.model.setReplyPermission(0),a(".response-add",this.$el).show(),c.done(function(a){a=i.parse_ajax_response(a),a&&(e.hasClass("lock")?(d.hideReponseBox(),e.text(i.translate("common|unlock"))):(d.showReponseBox(),e.text(i.translate("common|lock"))),e.toggleClass("lock unlock"))})},moreReply:function(a){return a.preventDefault(),i.is_logged_in()?void this.trigger("post:reply:more"):void i.show_login_dialog()},moreReshare:function(a){a.preventDefault(),this.trigger("post:reshare:more")},showMoreReply:function(){a(".responses-show-more-reply",this.$el).show()},hideMoreReply:function(){a(".responses-show-more-reply",this.$el).hide()},showReponseBox:function(){a(".postbox-reply",this.$el).show(),a(".postbox-repost",this.$el).show(),a(".response-lock-message",this.$el).hide()},hideReponseBox:function(){a(".postbox-reply",this.$el).hide(),a(".postbox-repost",this.$el).hide(),a(".response-lock-message",this.$el).show()},showReply:function(b){void 0!==b&&b.preventDefault(),a(".post-footer",this.$el).find(".post-reaction.post-reaction-active").removeClass("post-reaction-active"),a(".post-replies-pane",this.$el).is(":visible")?(a("html, body").animate({scrollTop:this.postboxReply.$el.offset().top-a(window).height()/2}),a(".post-responses .postbox-textarea",this.$el).focus()):(a(b.currentTarget).parent(".post-reaction").addClass("post-reaction-active"),a(".post-responses",this.$el).show(),a(".post-replies-pane",this.$el).show(),a(".post-replies-pane .postbox-textarea",this.$el).focus(),a(".post-reshares-pane",this.$el).hide())},moveToReply:function(b){var c="post-reply-"+b;this._check_response(),a("html, body").animate({scrollTop:a("#"+c).offset().top-a(window).height()/2})},showReshare:function(b){null!==b&&b.preventDefault();var c=a("#sharebox-modal"),d=c.data("shareModalViewObject"),e=d.getPostbox();e.setToReshare(this.model),c.modal("show"),a(".post-footer",this.$el).find(".post-reaction.post-reaction-active").removeClass("post-reaction-active")},showShare:function(b){null!==b&&b.preventDefault(),a(".post-footer",this.$el).find(".post-reaction.post-reaction-active").removeClass("post-reaction-active"),i.show_share_dialog("post",this.model)},showGift:function(a){null!==a&&a.preventDefault(),i.show_gift_selection("post",this.model)},_openPopupWindow:function(a){var b,c,d=600,e=450;b=window.screen.width/2-(d/2+10),c=window.screen.height/2-(e/2+50),window.open(a,"migme-new-window","height="+e+",width="+d+",left="+b+",top="+c+",screenX="+b+",screenY="+c+",toolbar=no,menubar=no,directories=no")}});return m}),define("modules/model/group/group_model",["underscore","backbone","modules/mig33_app","modules/common/config","modules/common/utility","modules/model/common/mig33_model"],function(a,b,c,d,e,f){var g=f.extend({initialize:function(a){this.options=a},url:function(){return e.format(d.urls.group,this.options.group_id)},parse:function(b){return b.data&&!a.isUndefined(b.data.group)&&null!==b.data.group?b.data.group:b},goToGroup:function(a){var c="group/"+this.get("id");a=a||"",""!==a&&(c=c+"/"+a),b.history.navigate(c,{trigger:!0})},join:function(){var a=this,b=$.ajax({type:"post",dataType:"json",url:e.format(d.urls.group_join,this.options.group_id)});return b.done(function(b){b=e.parse_ajax_response(b),b.error?e.show_error(b.error):e.show_success(b.success),a._invalidateCache("members")}),b.fail(function(a,b,c){e.show_error(c)}),b},leave:function(){var a=$.ajax({type:"post",dataType:"json",url:e.format(d.urls.group_leave,this.options.group_id)});return a.done(function(a){a=e.parse_ajax_response(a),a.error?e.show_error(a.error):e.show_success(a.success),this._invalidateCache("members")}),a.fail(function(a,b,c){e.show_error(c)}),a},_invalidateCache:function(a){$.ajax({type:"delete",url:e.format(d.urls.group_invalidate_cache,this.get("id"),a)})},sendInviteRequest:function(){var a=$.ajax({type:"post",dataType:"json",url:e.format(d.urls.group_invite_request,this.options.group_id)});return a.done(function(a){a=e.parse_ajax_response(a),a.error?e.show_error(a.error):e.show_success(a.success)}),a.fail(function(a,b,c){e.show_error(c)}),a}});return g}),define("modules/model/post/ef_model",["underscore","backbone","modules/mig33_app","modules/common/config","modules/common/utility","modules/model/common/mig33_model"],function(a,b,c,d,e,f){var g=f.extend({currentPage:1,parentId:null,url:function(){return d.urls.ef_url+"/"+this.parentId+"/"+this.currentPage},initialize:function(){},setParentId:function(a){this.parentId=a},resetPage:function(){this.currentPage=1},nextPage:function(){this.currentPage++}});return g}),define("modules/controller/single_post_controller",["underscore","backbone","backbone.marionette","modules/mig33_app","modules/common/config","modules/common/utility","modules/view/post/single_post_layout","modules/view/post/single_post_group_header_view","modules/view/post/single_post_header_layout","modules/view/post/single_post_item_view","modules/view/post/single_post_ef_item_view","modules/view/post/single_post_responses_layout","modules/view/post/single_post_reply_collection_view","modules/view/post/single_post_reshare_collection_view","modules/model/user/user_model","modules/model/post/post_model","modules/model/group/group_model","modules/model/post/ef_model","modules/model/post/reply_collection","modules/model/post/reshare_collection"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){var u=null,v=null,w=null,x=null,y=null,z=null,A=null,B=null,C=c.Controller.extend({_createAndInitSinglePostLayout:function(){w=new g,y=new r,z=new t,A=new s,w.on("close",function(){y=null,z=null,A=null,u=null})},_show:function(){f.highlight_top_menu(""),null!==u&&u?u.close():(this._createAndInitSinglePostLayout(),d.content.show(w))},_getPostById:function(a){var b=new p({id:a});return b.setRepliesLimit(0),b.setResharesLimit(0),b.setEfLimit(0),b.fetch(),b},_getUserByName:function(a){var b=new o({username:a});return b.fetch(),b},_getGroupById:function(a){var b=new q({group_id:a});return b.fetch(),b},initialize:function(){d.vent.on(d.ApplicationEvents.POST_REPLY_ADDED,function(a){null!==v&&null!==A&&null!==B&&(v.id===a.parent_post.id?(v.set("num_of_replies",v.get("num_of_replies")+1),A.add(a)):B.replyToReply(a),$(".post-nested-reply").addClass("hidden"),$(".show-reply-box").removeClass("active"))}),d.vent.on(d.ApplicationEvents.POST_RESHARE_ADDED,function(a){null!==v&&null!==z&&(v.set("num_of_reshares",v.get("num_of_reshares")+1),z.add(a),null!==x&&x.showReshare())}),d.vent.on(d.ApplicationEvents.POST_EF_ADDED,function(a){null!==y&&y.set(a)}),d.vent.on(d.ApplicationEvents.POST_REPLY_DELETED,function(){null!==v&&v.set("num_of_replies",v.get("num_of_replies")-1)})},index:function(a,b){v=this._getPostById(b);var c=this;this._getUserByName(a);this._show(),v.on("fetch:done",function(){var a=new i({model:v});if(w.userHeader.show(a),w.postContent.show(new j({model:v})),c._isGroupPost(v)){var b=c._getGroupById(v.get("group").id);b.on("fetch:done",function(){w.groupHeader.show(new h({model:b})),w.showGroupHeader()})}else w.hideGroupHeader();c._canViewPost(v)&&(x=new l({model:v}),w.postResponses.show(x),B=new m({collection:A}),A.setParentId(v.get("id")),f.is_logged_in()?A.setLimit(e.posts.replies.limit):A.setLimit(e.posts.replies.logout_limit),A.fetch(),x.postReplies.show(B),A.on("fetch:done",function(a){0===a.replies.length?x.hideMoreReply():(f.is_logged_in()&&a.post.num_of_replies>e.posts.replies.limit||!f.is_logged_in()&&a.post.num_of_replies>e.posts.replies.logout_limit)&&x.showMoreReply(),null!==x&&(x.allow_response(),x._check_response(),$(".main-reply-box").bind("cssClassChanged",function(){x._check_response()}))}),x.on("post:reply:more",function(){A.nextPage(),A.fetch({remove:!1})})),u=x})},_canViewPost:function(a){if(0===a.get("status"))return!1;if(this._isGroupPost(a))return!0;if(a.get("author")&&a.get("author").relationship.is_self)return!0;if(a.get("author")&&1===a.get("author").privacy.feed){if(0===a.get("privacy"))return!0;if(1===a.get("privacy")&&a.get("author").relationship.is_friend)return!0;if(2===a.get("privacy")&&a.get("author").relationship.is_self)return!0}if(a.get("author")&&2===a.get("author").privacy.feed&&a.get("author").relationship&&(a.get("author").relationship.is_friend||a.get("author").relationship.is_follower)&&null!==a.get("privacy")){if(0===a.get("privacy"))return!0;if(1===a.get("privacy")&&a.get("author").relationship.is_friend)return!0;if(2===a.get("privacy")&&a.get("author").relationship.is_self)return!0}return!1},_isGroupPost:function(a){return a.get("group")&&a.get("group").id}});return C}),define("hbs!modules/template/profile/profile-layout",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f,g="";return g+='\n	<div class="dropdown" id="dropdownEditCoverphoto">\n		<div class="col-md-offset-1 col-md-10 header header-profile"></div>\n		<div class="hidden">\n			<a href="',(e=c.cover_photo_url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.cover_photo_url,d=typeof e===l?e.call(a,{hash:{},data:b}):e),g+=m(d)+'" id="editCoverphoto" class="fancybox" rel="coverphoto" title="<a href=/u/'+m((e=c.getSessionUser||a&&a.getSessionUser,f={hash:{},data:b},e?e.call(a,"username",f):n.call(a,"getSessionUser","username",f)))+"/coverphoto onclick=$.fancybox.close();> "+m((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|edit_cover_photo",f):n.call(a,"translate","user|edit_cover_photo",f)))+'</a>">\n				View cover photo\n			</a>\n			<a href="'+m((e=c.getSessionUserDisplayPictureUrl||a&&a.getSessionUserDisplayPictureUrl,f={hash:{},data:b},e?e.call(a,300,300,f):n.call(a,"getSessionUserDisplayPictureUrl",300,300,f)))+'" id="editAvatar" class="fancybox" rel="avatar" title="<a href=/sites/ajax/settings/account_picture onclick=$.fancybox.close();> '+m((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|edit_profile_picture",f):n.call(a,"translate","user|edit_profile_picture",f)))+'</a>">\n				View profile picture\n			</a>\n		</div>\n	</div>\n	'}function g(a,b){return'\n		<div class="col-md-offset-1 col-md-10 header header-profile"></div>\n	'}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var h,i,j,k="",l="function",m=this.escapeExpression,n=c.helperMissing,o=this,p=c.blockHelperMissing;return k+='<div class="row">\n	',j={hash:{},inverse:o.program(3,g,e),fn:o.program(1,f,e),data:e},(i=c.ifLoggedIn)?h=i.call(b,j):(i=b&&b.ifLoggedIn,h=typeof i===l?i.call(b,j):i),c.ifLoggedIn||(h=p.call(b,h,{hash:{},inverse:o.program(3,g,e),fn:o.program(1,f,e),data:e})),(h||0===h)&&(k+=h),k+='\n</div>\n<div class="row">\n	<div class="profile-container col-md-offset-1 col-md-10">\n		<div class="profile-detail"></div>\n		<div class="sidebar sidebar-profile"></div>\n		<div class="content content-profile">\n			<div class="item-count-container"></div>\n			<div class="container-profile-post"></div>\n			<div class="container-profile"></div>\n			<div class="load-more">'+m((i=c.translate||b&&b.translate,j={hash:{},data:e},i?i.call(b,"common|more",j):n.call(b,"translate","common|more",j)))+"</div>\n		</div>\n	</div>\n</div>"})}),define("modules/view/profile/profile_layout",["jquery","underscore","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/profile/profile-layout","modules/common/utility","modules/common/session_user","modules/template/helpers/general_helpers","modules/template/helpers/post_helpers"],function(a,b,c,d,e,f,g,h,i){var j=e.Layout.extend({template:{type:"handlebars",template:g},templateHelpers:function(){return{cover_photo_url:h.getCoverphoto()}},regions:{header:".header-profile",detailbar:".profile-detail",sidebar:".sidebar-profile",container:".container-profile",pagination:".load-more",shareBoxPost:".container-profile-post"},showPagination:function(){a(".load-more",this.$el).show()},hidePagination:function(){a(".load-more",this.$el).hide()}});return j}),define("hbs!modules/template/profile/profile-header",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+='\n	<div class="profile-header',d=c["if"].call(a,(d=a&&a.relationship,null==d||d===!1?d:d.is_self),{hash:{},inverse:l.noop,fn:l.program(2,g,b),data:b}),(d||0===d)&&(f+=d),f+='" style="background-image: url(\'',(e=c.cover_photo_url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.cover_photo_url,d=typeof e===m?e.call(a,{hash:{},data:b}):e),f+=n(d)+"');\">\n"}function g(a,b){return" self cursorPointer"}function h(a,b){var d,e,f,h="";return h+='\n	<div class="profile-header',d=c["if"].call(a,(d=a&&a.relationship,null==d||d===!1?d:d.is_self),{hash:{},inverse:l.noop,fn:l.program(2,g,b),data:b}),(d||0===d)&&(h+=d),h+='" style="background-image: url(\''+n((e=c.getUrl||a&&a.getUrl,f={hash:{},data:b},e?e.call(a,"jsclient",f):o.call(a,"getUrl","jsclient",f)))+"/app/images/profile_image_03.png');\">\n"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var i,j,k="",l=this,m="function",n=this.escapeExpression,o=c.helperMissing;return i=c["if"].call(b,b&&b.cover_photo_url,{hash:{},inverse:l.program(4,h,e),fn:l.program(1,f,e),data:e}),(i||0===i)&&(k+=i),k+='\n\n	<div class="row directory">\n		<div class="col-xs-12">\n			<div class="user-actions text-left"><span class="font-size-12"> <a href="',(j=c.backButtonUrl)?i=j.call(b,{hash:{},data:e}):(j=b&&b.backButtonUrl,i=typeof j===m?j.call(b,{hash:{},data:e}):j),k+=n(i)+"u/",(j=c.username)?i=j.call(b,{hash:{},data:e}):(j=b&&b.username,i=typeof j===m?j.call(b,{hash:{},data:e}):j),k+=n(i)+'" class="font-color-white backButton icon-wb_arrowLeft">Back</a></span></div>\n		</div>\n	</div>\n\n</div>'})}),define("modules/view/profile/profile_header_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/profile/profile-header","modules/view/user/user_view","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j){var k=h.extend({template:{type:"handlebars",template:g},templateHelpers:{backButtonUrl:"/"},className:"profile-header-bg",events:{"click a":"interceptLinks","click .profile-header.self":"clickCoverphoto","click .backButton":"goByBBHistory"},onRender:function(){h.prototype.onRender.apply(this,arguments)},goByBBHistory:function(a){a.preventDefault(),a.stopPropagation(),c.history.navigate(b(a.target).attr("href"),!0)},clickCoverphoto:function(a){b("#editCoverphoto").click()},interceptLinks:function(a){j.is_logged_in()||(a.preventDefault(),a.stopPropagation(),j.show_login_dialog())}});return k}),define("hbs!modules/template/profile/profile-detail",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){return'\n		<a href="/sites/ajax/settings/account_picture" class="btn btn-xs btn-default hidden"><span class="icon-wb_edit"></span></a>\n		'}function g(a,b){var d,e,f,g="";return g+="\n			",e=c.ifUserCanShowAge||a&&a.ifUserCanShowAge,f={hash:{},inverse:u.noop,fn:u.program(4,h,b),data:b},d=e?e.call(a,a,f):s.call(a,"ifUserCanShowAge",a,f),(d||0===d)&&(g+=d),g+="\n		"}function h(a,b){var d,e,f="";return f+="\n				"+t((d=c.userGetAge||a&&a.userGetAge,e={hash:{},data:b},d?d.call(a,a,e):s.call(a,"userGetAge",a,e)))+",&nbsp;\n			"}function i(a,b){var d,e,f="";return f+="\n			"+t((d=c.userGetGender||a&&a.userGetGender,e={hash:{},data:b},d?d.call(a,a,e):s.call(a,"userGetGender",a,e)))+",&nbsp;\n		"}function j(a,b){var d,e,f="";return f+="\n			",(e=c.country)?d=e.call(a,{hash:{},data:b}):(e=a&&a.country,d=typeof e===v?e.call(a,{hash:{},data:b}):e),f+=t(d)+",&nbsp;\n		"}function k(a,b){var d,e,f,g="";return g+='\n		<div class="btn-group edit-profile-btn-group">\n			<a class="profile-setting-button" id="profile-credit" href="/credit">\n				<span id="header-credit" class="icon-wb_credit"></span>\n			</a>\n		</div>\n		<div class="btn-group edit-profile-btn-group">\n			<a class="dropdown-toggle profile-setting-button" id="profile-settings" href="#">\n				<span id="header-setting" class="icon-wb_setting"></span>\n			</a>\n			<ul class="dropdown-menu text-left profile-dropdown" id="profile-settings-list">\n				<li>\n					<a id="editProfile" href="/sites/ajax/settings/account_profile">\n						'+t((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|edit_profile",f):s.call(a,"translate","user|edit_profile",f)))+'\n					</a>\n				</li>\n				<li>\n					<a id="changeCoverphoto" href="',(e=c.personalized_url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.personalized_url,d=typeof e===v?e.call(a,{hash:{},data:b}):e),g+=t(d)+'/coverphoto" title="'+t((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|change_cover_photo",f):s.call(a,"translate","user|change_cover_photo",f)))+'">'+t((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|change_cover_photo",f):s.call(a,"translate","user|change_cover_photo",f)))+"</a>\n				</li>\n			</ul>\n		</div>\n	"}function l(a,b){var d,e,f,g="";return g+='\n		<!-- <button class="btn btn-xs btn-default chat profile-button hidden" type="button">\n			<span class="icon-wb_chatbubble"></span>&nbsp;'+t((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"chat|chat",f):s.call(a,"translate","chat|chat",f)))+'\n		</button>\n		<a href="#" class="btn btn-xs btn-default send-gift profile-button" type="button">\n			<span class="icon-wb_gift"></span>&nbsp;'+t((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|send_gift",f):s.call(a,"translate","user|send_gift",f)))+'\n		</a>\n		<a href="#"\n		   class="btn btn-xs btn-following following profile-button hidden"\n		   data-toggle="clickover"\n		   data-placement="top"\n		   data-html="true"\n		   data-title="'+t((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|be_friends_to_chat",f):s.call(a,"translate","user|be_friends_to_chat",f)))+'"\n		   data-content="'+t((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|sweeten_the_invite",f):s.call(a,"translate","user|sweeten_the_invite",f)))+"<div class='padding-4px'></div><a href='/store/category/1/new/?username=",(e=c.username)?d=e.call(a,{hash:{},data:b}):(e=a&&a.username,d=typeof e===v?e.call(a,{hash:{},data:b}):e),g+=t(d)+"' class='btn btn-xs btn-default'>"+t((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|send_gift",f):s.call(a,"translate","user|send_gift",f)))+'</a>"\n				>\n			<span class="icon-wb_fanof"></span>&nbsp;'+t((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|i_m_a_fan",f):s.call(a,"translate","user|i_m_a_fan",f)))+'\n		</a>\n		<button class="btn btn-xs btn-following follow-pending profile-button hidden" type="button">\n			<span class="icon-wb_recent"></span>&nbsp;'+t((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|pending",f):s.call(a,"translate","user|pending",f)))+'\n		</button>\n		<button class="btn btn-xs btn-default follow profile-button hidden" type="button">\n			<span class="icon-wb_add"></span>&nbsp;'+t((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|add",f):s.call(a,"translate","user|add",f)))+'\n		</button> !-->\n		<div class="btn-group edit-profile-btn-group ">\n			<a class="follow hidden profile-setting-button">\n				<span class="icon-wb_friend"></span>\n			</a>\n		</div>\n		<div class="btn-group edit-profile-btn-group">\n			<a href="#" class="send-gift profile-setting-button">\n				<span class="icon-wb_gift"></span>\n			</a>\n		</div>\n		<div class="btn-group edit-profile-btn-group">\n			<a class="chat hidden profile-setting-button">\n				<span class="icon-wb_chatbubble"></span>\n			</a>\n		</div>\n		<div class="btn-group edit-profile-btn-group">\n			<a class="btn dropdown-toggle profile-setting-button" data-toggle="dropdown" href="#" id="others-profile-settings">\n				...\n			</a>\n			<ul class="dropdown-menu text-left" id="other-profile-settings-list">\n				<li>\n					<a href="#" class="share_profile" title="'+t((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"common|share_profile",f):s.call(a,"translate","common|share_profile",f)))+'">'+t((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"common|share_profile",f):s.call(a,"translate","common|share_profile",f)))+'</a>\n				</li>\n				<li>\n					<a href="#" class="mention" title="'+t((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|mention",f):s.call(a,"translate","user|mention",f)))+'">'+t((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|mention",f):s.call(a,"translate","user|mention",f)))+'</a>\n				</li>\n				<li>\n					<a href="#" class="send-gift" title="'+t((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|send_gift",f):s.call(a,"translate","user|send_gift",f)))+'">'+t((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|send_gift",f):s.call(a,"translate","user|send_gift",f)))+'</a>\n				</li>\n				<li>\n					<a href="/sites/ajax/account/transfer_credit?win_id=account-window&recipient_username=',(e=c.username)?d=e.call(a,{hash:{},data:b}):(e=a&&a.username,d=typeof e===v?e.call(a,{hash:{},data:b}):e),g+=t(d)+'" class="transfer-credit" title="'+t((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|transfer_credit",f):s.call(a,"translate","user|transfer_credit",f)))+'">'+t((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|transfer_credit",f):s.call(a,"translate","user|transfer_credit",f)))+'</a>\n				</li>\n				<li>\n					<a href="/sites/ajax/report/report_abuse?win_id=report_abuse&type=2&offender=',(e=c.username)?d=e.call(a,{hash:{},data:b}):(e=a&&a.username,d=typeof e===v?e.call(a,{hash:{},data:b}):e),g+=t(d)+'&subject=Profile%20Abuse" title="'+t((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"common|report",f):s.call(a,"translate","common|report",f)))+'">'+t((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"common|report",f):s.call(a,"translate","common|report",f)))+"</a>\n				</li>\n				",d=c["if"].call(a,(d=a&&a.relationship,null==d||d===!1?d:d.is_blocked_by),{hash:{},inverse:u.program(15,n,b),fn:u.program(13,m,b),data:b}),(d||0===d)&&(g+=d),g+='\n				<li><a href="#" onclick="return false;" title="'+t((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|remove_as_friend",f):s.call(a,"translate","user|remove_as_friend",f)))+'" class="unfollow-link hidden unfollow">'+t((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|remove_as_friend",f):s.call(a,"translate","user|remove_as_friend",f)))+"</a>\n				</li>\n			</ul>\n		</div>\n	"}function m(a,b){var d,e,f="";return f+='\n					<li><a href="#" onclick="return false;" title="'+t((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"user|unblock",e):s.call(a,"translate","user|unblock",e)))+'" class="user-unblock">'+t((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"user|unblock",e):s.call(a,"translate","user|unblock",e)))+"</a></li>\n				"}function n(a,b){var d,e,f="";return f+='\n					<li><a href="#" onclick="return false;" title="'+t((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"user|block",e):s.call(a,"translate","user|block",e)))+'" class="user-block">'+t((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"user|block",e):s.call(a,"translate","user|block",e)))+"</a></li>\n				"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var o,p,q,r="",s=c.helperMissing,t=this.escapeExpression,u=this,v="function";return r+='\n<div class="user-avatar">\n	<div class="user-avatar-img cursorPointer">\n		<img src="'+t((p=c.userGetDisplayPictureUrl||b&&b.userGetDisplayPictureUrl,q={hash:{},data:e},p?p.call(b,120,120,b,q):s.call(b,"userGetDisplayPictureUrl",120,120,b,q)))+'" width="120" height="120" class="img-circle dropdown" />\n		',p=c.ifIsSelf||b&&b.ifIsSelf,q={hash:{},inverse:u.noop,fn:u.program(1,f,e),data:e},o=p?p.call(b,b&&b.username,q):s.call(b,"ifIsSelf",b&&b.username,q),(o||0===o)&&(r+=o),r+='\n	</div>\n</div>\n<div class="profile-info">\n	<div class="user-username">\n			<a href="/u/',(p=c.username)?o=p.call(b,{hash:{},data:e}):(p=b&&b.username,o=typeof p===v?p.call(b,{hash:{},data:e}):p),r+=t(o)+'/achievements" class="profile-hovercard" data-username="',(p=c.username)?o=p.call(b,{hash:{},data:e}):(p=b&&b.username,o=typeof p===v?p.call(b,{hash:{},data:e}):p),r+=t(o)+'">'+t((p=c.userGetName||b&&b.userGetName,q={hash:{},data:e},p?p.call(b,b,q):s.call(b,"userGetName",b,q)))+'</a>\n			&nbsp;<span class="user-label font-size-12">'+t((p=c.userGetLabels||b&&b.userGetLabels,q={hash:{},data:e},p?p.call(b,b,q):s.call(b,"userGetLabels",b,q)))+'</span>\n	</div>\n	<div class="user-about font-size-12">\n		＠',(p=c.username)?o=p.call(b,{hash:{},data:e}):(p=b&&b.username,o=typeof p===v?p.call(b,{hash:{},data:e}):p),r+=t(o)+'\n	</div>\n	<div class="user-about font-size-12">\n		',p=c.isNotEmpty||b&&b.isNotEmpty,q={hash:{},inverse:u.noop,fn:u.program(3,g,e),data:e},o=p?p.call(b,b&&b.date_of_birth,q):s.call(b,"isNotEmpty",b&&b.date_of_birth,q),(o||0===o)&&(r+=o),r+="\n\n		",p=c.isNotEmpty||b&&b.isNotEmpty,q={hash:{},inverse:u.noop,fn:u.program(6,i,e),data:e},o=p?p.call(b,b&&b.gender,q):s.call(b,"isNotEmpty",b&&b.gender,q),
(o||0===o)&&(r+=o),r+="\n\n		",p=c.isNotEmpty||b&&b.isNotEmpty,q={hash:{},inverse:u.noop,fn:u.program(8,j,e),data:e},o=p?p.call(b,b&&b.country,q):s.call(b,"isNotEmpty",b&&b.country,q),(o||0===o)&&(r+=o),r+="\n		"+t((p=c.translate||b&&b.translate,q={hash:{},data:e},p?p.call(b,"user|miglevel_with_level",b&&b.mig_level,q):s.call(b,"translate","user|miglevel_with_level",b&&b.mig_level,q)))+'\n	</div>\n	<!--<div class="user-profile-share">\n		<a href="#" class="show-prof-share" title="'+t((p=c.translate||b&&b.translate,q={hash:{},data:e},p?p.call(b,"common|share",q):s.call(b,"translate","common|share",q)))+'">\n			<span class="icon-wb_mb_share"></span>\n		</a>\n	</div>!-->\n</div>\n<div class="directory">\n	',o=c["if"].call(b,(o=b&&b.relationship,null==o||o===!1?o:o.is_self),{hash:{},inverse:u.program(12,l,e),fn:u.program(10,k,e),data:e}),(o||0===o)&&(r+=o),r+="\n</div>\n"})}),define("modules/view/profile/profile_detail_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/profile/profile-detail","modules/view/user/user_view","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j){var k=h.extend({template:{type:"handlebars",template:g},templateHelpers:{backButtonUrl:"/"},events:{"click a":"interceptLinks","click .follow":"follow","click .unfollow":"unfollow","click .user-block":"block","click .user-unblock":"unblock","click .chat":"chat","click .mention":"mention","click .share_profile":"shareProfile","click #profile-settings":"profileSettings","click .user-avatar-img":"profileAvatarSettings","click #editProfile":"editProfile","click #changeCoverphoto":"changeCoverphoto","click .send-gift":"sendGift","click .user-username":"goUserProfile","click #profile-credit":"profileCredit"},onRender:function(){h.prototype.onRender.apply(this,arguments)},interceptLinks:function(a){j.is_logged_in()||(a.preventDefault(),a.stopPropagation(),j.show_login_dialog())},profileSettings:function(a){a.preventDefault(),a.stopPropagation(),b("#profile-settings-list").toggle()},profileCredit:function(a){a.preventDefault(),a.stopPropagation(),c.history.navigate(b("#profile-credit").attr("href"),!0)},profileAvatarSettings:function(a){a.preventDefault(),a.stopPropagation();var c=1,d=300,e=300,f=this.model.get("username"),g=j.get_display_picture_url(f,c,d,e),h=b("#editAvatar");j.is_owner()?(h.attr("title","<a href=/sites/ajax/settings/account_picture onclick=$.fancybox.close();> "+j.translate("user|edit_profile_picture")+"</a>"),h.attr("href",g)):(h.attr("title","Profile picture"),h.attr("href",g)),h.click()},goByBBHistory:function(a){a.preventDefault(),a.stopPropagation(),c.history.navigate(b(a.target).attr("href"),!0)},goUserProfile:function(a){a.preventDefault(),a.stopPropagation(),c.history.navigate(b(a.target).attr("href"),!0)},editProfile:function(a){a.preventDefault(),a.stopPropagation(),c.history.navigate("/v4"+b(a.target).attr("href"),!0)},sendGift:function(a){j.show_gift_selection("profile");var c=b("#gift-modal").find("input#to");c.tagit("removeAll").tagit("createTag",this.model.get("username"))},shareProfile:function(a){a.preventDefault(),a.stopPropagation(),j.show_share_dialog("user",this.model)},updateCoverPhoto:function(a){b(".profile-header").css("background-image",'url("'+a+'")')}});return k}),define("hbs!modules/template/profile/profile-sidebar",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+='\n	<div class="panel-body">\n		<div class="user-verified">',(e=c.about_me_verified)?d=e.call(a,{hash:{},data:b}):(e=a&&a.about_me_verified,d=typeof e===x?e.call(a,{hash:{},data:b}):e),(d||0===d)&&(f+=d),f+="</div>\n	</div>\n	"}function g(a,b){var d,e,f,g="";return g+='\n			<div class="about-content-description">\n				<span class="about-content-description-field">\n					'+z((e=c.characterLimiter||a&&a.characterLimiter,f={hash:{},data:b},e?e.call(a,a&&a.about_me,"100",f):y.call(a,"characterLimiter",a&&a.about_me,"100",f)))+"\n				</span>\n				",e=c.ifStringExceedLength||a&&a.ifStringExceedLength,f={hash:{},inverse:A.noop,fn:A.program(4,h,b),data:b},d=e?e.call(a,a&&a.about_me,100,!0,f):y.call(a,"ifStringExceedLength",a&&a.about_me,100,!0,f),(d||0===d)&&(g+=d),g+="\n			</div>\n			<br />\n		"}function h(a,b){var d,e,f="";return f+='\n					<span class="about-content-more">\n						&nbsp;&nbsp;<a href="#" class="expand" data-field="about_me">'+z((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"common|more",e):y.call(a,"translate","common|more",e)))+"</a>\n					</span>\n				"}function i(a,b){var d,e,f,g="";return g+='\n			<div class="about-content-title">'+z((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|interests",f):y.call(a,"translate","user|interests",f)))+'</div>\n			<div class="about-content-description">\n				<span class="about-content-description-field">\n					'+z((e=c.characterLimiter||a&&a.characterLimiter,f={hash:{},data:b},e?e.call(a,a&&a.interests,"100",f):y.call(a,"characterLimiter",a&&a.interests,"100",f)))+"\n				</span>\n				",e=c.ifStringExceedLength||a&&a.ifStringExceedLength,f={hash:{},inverse:A.noop,fn:A.program(7,j,b),data:b},d=e?e.call(a,a&&a.interests,100,!0,f):y.call(a,"ifStringExceedLength",a&&a.interests,100,!0,f),(d||0===d)&&(g+=d),g+="\n			</div>\n			<br />\n		"}function j(a,b){var d,e,f="";return f+='\n					<span class="about-content-more">\n						&nbsp;&nbsp;<a href="#" class="expand" data-field="interests">'+z((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"common|more",e):y.call(a,"translate","common|more",e)))+"</a>\n					</span>\n				"}function k(a,b){var d,e,f,g="";return g+='\n<!-- Friends, Fans, Following and favourites panel only show on self user profile sidebar-->\n<div class="panel-container">\n	<div class="panel-avatar-container">\n		<div class="panel panel-avatar">\n			<div class="panel-body">\n				<a href="/u/',(e=c.username)?d=e.call(a,{hash:{},data:b}):(e=a&&a.username,d=typeof e===x?e.call(a,{hash:{},data:b}):e),g+=z(d)+'/friends" class="sidebar-link"><div class="about-content-title showInline">'+z((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"homefeed|postbox_friends_only",f):y.call(a,"translate","homefeed|postbox_friends_only",f)))+'</div>\n				</a>\n				<div class="about-content-description showInline friendCount">\n				',e=c.ifIsSelf||a&&a.ifIsSelf,f={hash:{},inverse:A.program(12,m,b),fn:A.program(10,l,b),data:b},d=e?e.call(a,a&&a.username,f):y.call(a,"ifIsSelf",a&&a.username,f),(d||0===d)&&(g+=d),g+='\n				 </div>\n				<div id="friendList" class="panel-avatar-list"></div>\n			</div>\n		</div>\n		<div class="panel panel-avatar">\n			<div class="panel-body">\n				<a href="/u/',(e=c.username)?d=e.call(a,{hash:{},data:b}):(e=a&&a.username,d=typeof e===x?e.call(a,{hash:{},data:b}):e),g+=z(d)+'/fans" class="sidebar-link"><div class="about-content-title showInline">'+z((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|fans",f):y.call(a,"translate","user|fans",f)))+'</div>\n				</a>\n				<div class="about-content-description showInline friendCount">\n				',e=c.ifIsSelf||a&&a.ifIsSelf,f={hash:{},inverse:A.program(16,o,b),fn:A.program(14,n,b),data:b},d=e?e.call(a,a&&a.username,f):y.call(a,"ifIsSelf",a&&a.username,f),(d||0===d)&&(g+=d),g+='\n				 </div>\n				<div id="fanList" class="panel-avatar-list"></div>\n			</div>\n		</div>\n		<div class="panel panel-avatar">\n			<div class="panel-body">\n				<a href="/u/',(e=c.username)?d=e.call(a,{hash:{},data:b}):(e=a&&a.username,d=typeof e===x?e.call(a,{hash:{},data:b}):e),g+=z(d)+'/following" class="sidebar-link"><div class="about-content-title showInline">'+z((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|fan_of",f):y.call(a,"translate","user|fan_of",f)))+'</div>\n				</a>\n				<div class="about-content-description showInline friendCount">\n				',e=c.ifIsSelf||a&&a.ifIsSelf,f={hash:{},inverse:A.program(20,q,b),fn:A.program(18,p,b),data:b},d=e?e.call(a,a&&a.username,f):y.call(a,"ifIsSelf",a&&a.username,f),(d||0===d)&&(g+=d),g+='\n				 </div>\n				<div id="followingList" class="panel-avatar-list"></div>\n			</div>\n		</div>\n\n		<!-- <div class="panel panel-about panel-avatar post">\n			<div class="panel-body">\n				<a href="/watchlist" class="sidebar-link"><div class="about-content-title showInline">'+z((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"homefeed|favorites",f):y.call(a,"translate","homefeed|favorites",f)))+'</div>\n				</a>\n				<div class="about-content-description showInline favouritesCount">\n				('+z((e=c.getSessionUser||a&&a.getSessionUser,f={hash:{},data:b},e?e.call(a,"num_watched_posts",f):y.call(a,"getSessionUser","num_watched_posts",f)))+')\n				 </div>\n				<div id="favouritesList"></div>\n			</div>\n		</div> -->\n		'}function l(a,b){var d,e,f="";return f+="\n				("+z((d=c.getSessionUser||a&&a.getSessionUser,e={hash:{},data:b},d?d.call(a,"num_friends",e):y.call(a,"getSessionUser","num_friends",e)))+")\n				"}function m(a,b){var d,e,f="";return f+="\n				(",(e=c.num_friends)?d=e.call(a,{hash:{},data:b}):(e=a&&a.num_friends,d=typeof e===x?e.call(a,{hash:{},data:b}):e),f+=z(d)+")\n				"}function n(a,b){var d,e,f="";return f+="\n				("+z((d=c.getSessionUser||a&&a.getSessionUser,e={hash:{},data:b},d?d.call(a,"num_followers",e):y.call(a,"getSessionUser","num_followers",e)))+")\n				"}function o(a,b){var d,e,f="";return f+="\n				(",(e=c.num_followers)?d=e.call(a,{hash:{},data:b}):(e=a&&a.num_followers,d=typeof e===x?e.call(a,{hash:{},data:b}):e),f+=z(d)+")\n				"}function p(a,b){var d,e,f="";return f+="\n				("+z((d=c.getSessionUser||a&&a.getSessionUser,e={hash:{},data:b},d?d.call(a,"num_following",e):y.call(a,"getSessionUser","num_following",e)))+")\n				"}function q(a,b){var d,e,f="";return f+="\n				(",(e=c.num_following)?d=e.call(a,{hash:{},data:b}):(e=a&&a.num_following,d=typeof e===x?e.call(a,{hash:{},data:b}):e),f+=z(d)+")\n				"}function r(a,b){var d,e,f,g="";return g+='\n		<div class="panel panel-avatar">\n			<div class="panel-body">\n				<a href="/u/',(e=c.username)?d=e.call(a,{hash:{},data:b}):(e=a&&a.username,d=typeof e===x?e.call(a,{hash:{},data:b}):e),g+=z(d)+'/gifts" class="sidebar-link"><div class="about-content-title showInline">'+z((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|gifts",f):y.call(a,"translate","user|gifts",f)))+'</div>\n				</a>\n				<div class="about-content-description showInline">(',(e=c.num_gifts_received)?d=e.call(a,{hash:{},data:b}):(e=a&&a.num_gifts_received,d=typeof e===x?e.call(a,{hash:{},data:b}):e),g+=z(d)+')</div>\n				<div id="giftList" class="panel-avatar-list"></div>\n			</div>\n		</div>\n		'}function s(a,b){return"\n		"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var t,u,v,w="",x="function",y=c.helperMissing,z=this.escapeExpression,A=this,B=c.blockHelperMissing;return w+='<div id="user-leaderboard" class="panel panel-leaderboard hidden">\n</div>\n<div class="panel panel-about">\n	',u=c.isNotEmpty||b&&b.isNotEmpty,v={hash:{},inverse:A.noop,fn:A.program(1,f,e),data:e},t=u?u.call(b,b&&b.about_me_verified,v):y.call(b,"isNotEmpty",b&&b.about_me_verified,v),(t||0===t)&&(w+=t),w+='\n	<div class="panel-body about-content font-size-14">\n			<div class="about-content-title">'+z((u=c.translate||b&&b.translate,v={hash:{},data:e},u?u.call(b,"user|about_me",v):y.call(b,"translate","user|about_me",v)))+"</div>\n		",u=c.isNotEmpty||b&&b.isNotEmpty,v={hash:{},inverse:A.noop,fn:A.program(3,g,e),data:e},t=u?u.call(b,b&&b.about_me,v):y.call(b,"isNotEmpty",b&&b.about_me,v),(t||0===t)&&(w+=t),w+="\n		",u=c.isNotEmpty||b&&b.isNotEmpty,v={hash:{},inverse:A.noop,fn:A.program(6,i,e),data:e},t=u?u.call(b,b&&b.interests,v):y.call(b,"isNotEmpty",b&&b.interests,v),(t||0===t)&&(w+=t),w+='\n		<div class="pull-right">\n			<a href="/u/',(u=c.username)?t=u.call(b,{hash:{},data:e}):(u=b&&b.username,t=typeof u===x?u.call(b,{hash:{},data:e}):u),w+=z(t)+'/about" title="'+z((u=c.translate||b&&b.translate,v={hash:{},data:e},u?u.call(b,"user|about",v):y.call(b,"translate","user|about",v)))+'">View more</a>\n		</div>\n	</div>\n</div>\n\n',u=c.ifIsSelf||b&&b.ifIsSelf,v={hash:{},inverse:A.noop,fn:A.program(9,k,e),data:e},t=u?u.call(b,b&&b.username,v):y.call(b,"ifIsSelf",b&&b.username,v),(t||0===t)&&(w+=t),w+="\n\n		",v={hash:{},inverse:A.program(24,s,e),fn:A.program(22,r,e),data:e},(u=c.ifLoggedIn)?t=u.call(b,v):(u=b&&b.ifLoggedIn,t=typeof u===x?u.call(b,v):u),c.ifLoggedIn||(t=B.call(b,t,{hash:{},inverse:A.program(24,s,e),fn:A.program(22,r,e),data:e})),(t||0===t)&&(w+=t),w+='\n		<div class="panel panel-avatar">\n			<div class="panel-body">\n				<a href="/u/',(u=c.username)?t=u.call(b,{hash:{},data:e}):(u=b&&b.username,t=typeof u===x?u.call(b,{hash:{},data:e}):u),w+=z(t)+'/achievements" class="sidebar-link"><div class="about-content-title showInline">'+z((u=c.translate||b&&b.translate,v={hash:{},data:e},u?u.call(b,"Achievments",v):y.call(b,"translate","Achievments",v)))+'</div>\n				</a>\n				<div class="about-content-description showInline">(',(u=c.num_badges_unlocked)?t=u.call(b,{hash:{},data:e}):(u=b&&b.num_badges_unlocked,t=typeof u===x?u.call(b,{hash:{},data:e}):u),w+=z(t)+')</div>\n				<div id="badgesList" class="panel-avatar-list"></div>\n			</div>\n		</div>\n	</div>\n</div>\n<div class="panel panel-custom">\n	<div class="panel-heading">\n		<h3 class="panel-title"></h3>\n	</div>\n	<div class="panel-body"></div>\n	<div class="panel-footer custom-more font-size-12">\n		<a href="#">'+z((u=c.translate||b&&b.translate,v={hash:{},data:e},u?u.call(b,"common|show_more",v):y.call(b,"translate","common|show_more",v)))+'</a>\n	</div>\n</div>\n\n<div id="artist-fotm" class="panel panel-leaderboard hidden">\n</div>\n\n<div id="artist-leaderboard" class="panel panel-leaderboard hidden">\n</div>\n\n<div class="panel panel-invite">\n	<div class="panel-heading">\n		<h3 class="panel-title">'+z((u=c.translate||b&&b.translate,v={hash:{},data:e},u?u.call(b,"chat|invite_friends",v):y.call(b,"translate","chat|invite_friends",v)))+'</h3>\n	</div>\n	<div class="panel-body"></div>\n</div>'})}),define("modules/model/user/following_collection",["modules/model/common/mig33_collection","modules/mig33_app","modules/common/config","modules/common/utility","modules/model/user/user_model","underscore"],function(a,b,c,d,e,f){var g=a.extend({model:e,totalCount:0,initialize:function(a,b){this.options=b},url:function(){return c.urls.following_url+"/"+this.options.userId+"/"+this.currentPage},parse:function(a){return a.data&&!f.isUndefined(a.data.total)&&null!==a.data.total&&(this.totalCount=parseInt(a.data.total,10)),a.data&&!f.isUndefined(a.data.following)&&null!==a.data.following?a.data.following:a},getTotalCount:function(){return this.totalCount}});return g}),define("modules/model/user/follower_collection",["modules/model/common/mig33_collection","modules/mig33_app","modules/common/config","modules/common/utility","modules/model/user/user_model","underscore"],function(a,b,c,d,e,f){var g=a.extend({model:e,totalCount:0,newCount:0,initialize:function(a,b){this.options=b},url:function(){return c.urls.follower_url+"/"+this.options.userId+"/"+this.currentPage},parse:function(a){if(a.data&&!f.isUndefined(a.data.total)&&null!==a.data.total&&(this.totalCount=parseInt(a.data.total,10)),a.data&&!f.isUndefined(a.data.newCount)&&null!==a.data.newCount&&(this.newCount=parseInt(a.data.newCount,10)),a.data&&!f.isUndefined(a.data.followers)&&null!==a.data.followers){for(var b=this.newCount>a.data.followers.length?a.data.followers.length:this.newCount,c=0;b>c;c++)a.data.followers[c].isNew=!0;return a.data.followers}return a},getTotalCount:function(){return this.totalCount},getNewCount:function(){return this.newCount}});return g}),define("modules/model/user/friend_collection",["modules/model/common/mig33_collection","modules/mig33_app","modules/common/session_user","modules/common/config","modules/common/utility","modules/model/user/user_model","underscore"],function(a,b,c,d,e,f,g){var h=a.extend({model:f,totalCount:0,newCount:0,LIMIT_FOR_GET_ALL:-1,initialize:function(a,b){this.options=b},url:function(){var a=this.currentPage-1;return e.format(d.urls.getfriend_url,this.options.userId,a,this.LIMIT_FOR_GET_ALL)},parse:function(a){var b=null,c=[];if(a.data&&!g.isUndefined(a.data)&&null!==a.data){for(var d in a.data)c.push(this._normalizeUser(a.data[d]));return this.totalCount=a.data.length,this.limit!=this.LIMIT_FOR_GET_ALL?c.slice(this.currentPage-1,this.limit):c}return b={data:{friends:c,newCount:this.getNewCount(),total:this.getTotalCount()},error:{errno:0}}},getTotalCount:function(){return this.totalCount},getNewCount:function(){return this.newCount},_normalizeUser:function(a){return this._isViewedByOwner()?a.relationship={is_friend:!0}:a.relationship=void 0,a.mig_level=a.migLevel,a.privacy=a._privacy,a},_isViewedByOwner:function(){return"undefined"!=typeof this&&null!==this&&null!=this.options&&null!=this.options.userId&&c.getInstance().get("id")===this.options.userId}});return h}),define("hbs!modules/template/profile/friend-list",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h,i="",j="function",k=this.escapeExpression,l=c.helperMissing;return i+='<a href="',(g=c.userprofile_url)?f=g.call(b,{hash:{},data:e}):(g=b&&b.userprofile_url,f=typeof g===j?g.call(b,{hash:{},data:e}):g),i+=k(f),(g=c.username)?f=g.call(b,{hash:{},data:e}):(g=b&&b.username,f=typeof g===j?g.call(b,{hash:{},data:e}):g),i+=k(f)+'" class="profile-hovercard noUnderline" data-username="',(g=c.username)?f=g.call(b,{hash:{},data:e}):(g=b&&b.username,f=typeof g===j?g.call(b,{hash:{},data:e}):g),i+=k(f)+'">\n	<img src="'+k((g=c.userGetDisplayPictureUrl||b&&b.userGetDisplayPictureUrl,h={hash:{},data:e},g?g.call(b,64,64,b,h):l.call(b,"userGetDisplayPictureUrl",64,64,b,h)))+'" width="49" height="49" />\n</a>'})}),define("modules/view/profile/friend_avatar_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/view/user/user_view","hbs!modules/template/profile/friend-list","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j){var k=g.extend({options:[],template:{type:"handlebars",template:h},templateHelpers:{userprofile_url:"/u/"},className:function(){return"display-inline"},onRender:function(){j.parse_profile_hovercard(this),g.prototype.onRender.apply(this,arguments)},initialize:function(a){this.options=a}});return k}),define("hbs!modules/template/profile/friend-avatar-collection",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){return'\n	<div class="alert alert-grey font-size-12" style="display: none;"></div>\n'}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var g,h,i,j="",k=this,l=c.helperMissing;return h=c.ifIsSelf||b&&b.ifIsSelf,i={hash:{},inverse:k.noop,fn:k.program(1,f,e),data:e},g=h?h.call(b,b&&b.username,i):l.call(b,"ifIsSelf",b&&b.username,i),(g||0===g)&&(j+=g),j+='\n<div class="friend-list"></div>'})}),define("modules/view/profile/friend_avatar_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/view/profile/friend_avatar_item_view","hbs!modules/template/profile/friend-avatar-collection","modules/view/common/mig33_views","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j,k){var l=d.compile('{{translate "user|friends_none" username}}'),m=d.compile('{{translate "common|loading"}}...'),n=e.ItemView.extend({template:{type:"handlebars",template:l},className:"empty"}),o=e.ItemView.extend({template:{type:"handlebars",template:m},className:"loading"}),p=k.CompositeView.extend({itemView:i,emptyView:n,loadingView:o,itemViewContainer:".friend-list",itemViewOptions:function(a,b){return{type:"follower",itemIndex:b}},template:{type:"handlebars",template:j},initialize:function(){a.bindAll(this);var c=this;this.on("render",function(){b(window).on("scroll",function(a){c.more(a)})}),this.on("close",function(){b(window).off("scroll")})},prevScrollY:0,page:1,more:function(){}});return p}),define("hbs!modules/template/gift/gift-list",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){return'\n					<span class="recipient-name">you</span>\n				'}function g(a,b){var d,e,f="";return f+='\n					<span class="recipient-name">',(e=c.getUsernameFromUrl)?d=e.call(a,{hash:{},data:b}):(e=a&&a.getUsernameFromUrl,d=typeof e===o?e.call(a,{hash:{},data:b}):e),f+=p(d)+"</span>\n				"}function h(a,b){var d,e="";return e+='\n			<div class="gift-ctl-bar">\n				',d=c["if"].call(a,a&&a.favorite,{hash:{},inverse:q.program(8,j,b),fn:q.program(6,i,b),data:b}),(d||0===d)&&(e+=d),e+='\n\n				<span class="icon-wb_gift gift-ctl-option"></span>\n				<span class="icon-wb_mb_share gift-ctl-option"></span>			\n			</div>\n		'}function i(a,b){return'\n					<span class="icon-wb_like gift-ctl-option"></span>\n				'}function j(a,b){return'\n					<span class="icon-wb_favourite gift-ctl-option"></span>\n				'}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var k,l,m,n="",o="function",p=this.escapeExpression,q=this,r=c.helperMissing,s=c.blockHelperMissing;return n+='<div class=\'monthly-gift col-md-12 col-xs-12\'>\n	<div class="gift-content">\n		<a href="'+p((l=c.getProfileUrl||b&&b.getProfileUrl,m={hash:{},data:e},l?l.call(b,b&&b.sender,m):r.call(b,"getProfileUrl",b&&b.sender,m)))+'" title="',(l=c.sender)?k=l.call(b,{hash:{},data:e}):(l=b&&b.sender,k=typeof l===o?l.call(b,{hash:{},data:e}):l),n+=p(k)+'">\n			<img src="'+p((l=c.getDisplayPictureUrl||b&&b.getDisplayPictureUrl,m={hash:{},data:e},l?l.call(b,b&&b.sender,2,40,40,m):r.call(b,"getDisplayPictureUrl",b&&b.sender,2,40,40,m)))+'" width="40" height="40" class="img-circle left" />\n		</a>\n		<div class="gift-info left">\n			<div>\n				<span class="sender-name">',(l=c.sender)?k=l.call(b,{hash:{},data:e}):(l=b&&b.sender,k=typeof l===o?l.call(b,{hash:{},data:e}):l),n+=p(k)+"</span> send\n				",m={hash:{},inverse:q.program(3,g,e),fn:q.program(1,f,e),data:e},(l=c.ifCurrentUser)?k=l.call(b,m):(l=b&&b.ifCurrentUser,k=typeof l===o?l.call(b,m):l),c.ifCurrentUser||(k=s.call(b,k,{hash:{},inverse:q.program(3,g,e),fn:q.program(1,f,e),data:e})),(k||0===k)&&(n+=k),n+="\n				\n				<span> a ",(l=c.name)?k=l.call(b,{hash:{},data:e}):(l=b&&b.name,k=typeof l===o?l.call(b,{hash:{},data:e}):l),n+=p(k)+'</span>\n			</div>\n			<div class="gift-send-time">'+p((l=c.getRelativeTimestamp||b&&b.getRelativeTimestamp,m={hash:{},data:e},l?l.call(b,b&&b.dateCreated,m):r.call(b,"getRelativeTimestamp",b&&b.dateCreated,m)))+'</div>\n		</div>\n		<div class="gift-img right">\n			<a href="'+p((l=c.getProfileUrl||b&&b.getProfileUrl,m={hash:{},data:e},l?l.call(b,b&&b.username,m):r.call(b,"getProfileUrl",b&&b.username,m)))+"/store/1/received/",(l=c.id)?k=l.call(b,{hash:{},data:e}):(l=b&&b.id,k=typeof l===o?l.call(b,{hash:{},data:e}):l),n+=p(k)+'" title="'+p((l=c.translate||b&&b.translate,m={hash:{},data:e},l?l.call(b,"user|view_gift_received",m):r.call(b,"translate","user|view_gift_received",m)))+'">\n				<img src="'+p((l=c.getGiftImageUrl||b&&b.getGiftImageUrl,m={hash:{},data:e},l?l.call(b,b&&b.location,64,"png",m):r.call(b,"getGiftImageUrl",b&&b.location,64,"png",m)))+'" width="40" height="40" />\n			</a>\n		</div>\n		<div class="clear"></div>\n		',m={hash:{},inverse:q.noop,fn:q.program(5,h,e),data:e},(l=c.ifCurrentUser)?k=l.call(b,m):(l=b&&b.ifCurrentUser,k=typeof l===o?l.call(b,m):l),c.ifCurrentUser||(k=s.call(b,k,{hash:{},inverse:q.noop,fn:q.program(5,h,e),data:e})),(k||0===k)&&(n+=k),n+="\n	</div>\n</div>"})}),define("modules/model/gift/gift_model",["underscore","backbone","modules/mig33_app","modules/common/config","modules/common/utility"],function(a,b,c,d,e){var f=b.Model.extend({url:function(){return e.format(d.url.add_gift_favorite)}});return f}),define("modules/view/gift/gift_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/gift/gift-list","modules/common/config","modules/model/gift/gift_model","modules/model/user/user_model","modules/model/post/post_model","modules/common/utility","modules/common/session_user","modules/globals/url","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=e.ItemView.extend({model:i,template:{type:"handlebars",template:g},ui:{favourite:".gift-ctl-bar span:nth-child(1)",sendGift:".gift-ctl-bar span:nth-child(2)",shareGift:".gift-ctl-bar span:nth-child(3)",recipient:".recipient-name"},events:{"click @ui.favourite":"toggleFavoriteGift","click @ui.sendGift":"sendGift","click @ui.shareGift":"shareGift"},className:"row gift-container",initialize:function(){a.bindAll(this);var c=b("#sharebox-modal"),d=c.find("textarea.postbox-textarea");c.on("hide.bs.modal",function(){d.val("")})},onRender:function(){m.getInstance().get("username"),l.get_username();b("a.view-message",this.$el).popover({trigger:"hover"}),l.parse_profile_hovercard(this)},toggleFavoriteGift:function(a){var b=new j({username:m.getInstance().get("username")});b.fetch();var c=this,d={itemId:this.model.id};b.on("change",function(){c.ui.favourite.hasClass("icon-wb_like")?b.removeFavoriteGift(h.favorite.gift,d):b.addFavoriteGift(h.favorite.gift,d)}),b.on("fetch:error",function(){l.show_error(l.translate("chat|load-message-error"))}),b.on("favourite:gift",function(a){"remove"==a.status?(c.ui.favourite.addClass("icon-wb_favourite").removeClass("icon-wb_like"),l.show_success(l.translate("chat|remove_from_favourites"))):(c.ui.favourite.removeClass("icon-wb_favourite").addClass("icon-wb_like"),l.show_success(l.translate("chat|add_to_favourites")))})},sendGift:function(a){l.show_gift_selection("profile");var c=b("#gift-modal").find("input#to");c.tagit("removeAll").tagit("createTag",this.model.get("sender")),this.$el.modal("hide")},shareGift:function(a){var c=b("#sharebox-modal"),d="@"+this.model.get("sender")+" has sent me a "+this.model.get("name")+" "+l.get_gift_image_url(this.model.get("location"),64,"png"),e=c.find("textarea.postbox-textarea");e.val(d),c.modal("show")}});return o}),define("hbs!modules/template/gift/sidebar-gift-modal",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+='\n					<div class="gift-message">\n						',(e=c.message)?d=e.call(a,{hash:{},data:b}):(e=a&&a.message,d=typeof e===m?e.call(a,{hash:{},data:b}):e),f+=n(d)+"\n					</div>\n				"}function g(a,b){return'\n					<div class="gift-spacing"></div>\n				'}function h(a,b){return'\n					<div class="gift-actions-bar">\n						<span class="gift-favorite icon-wb_favourite"></span>\n\n						<span class="gift-sendback icon-wb_gift"></span>\n\n						<span class="gift-share icon-wb_mb_share"></span>\n					</div>\n				'}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var i,j,k,l="",m="function",n=this.escapeExpression,o=c.helperMissing,p=this,q=c.blockHelperMissing;return l+='<div class="modal-dialog">\n	<div class="modal-content">\n		<div class="modal-body">\n			<div class="col-sm-12 badge-container text-center">\n				<div class="gift-image">\n					<img src="'+n((j=c.getGiftImageUrl||b&&b.getGiftImageUrl,k={hash:{},data:e},j?j.call(b,b&&b.location,64,"png",k):o.call(b,"getGiftImageUrl",b&&b.location,64,"png",k)))+'" />\n				</div>\n				<div class="gift-head-line">\n					',(j=c.sender)?i=j.call(b,{hash:{},data:e}):(j=b&&b.sender,i=typeof j===m?j.call(b,{hash:{},data:e}):j),l+=n(i)+" has sent you a ",(j=c.name)?i=j.call(b,{hash:{},data:e}):(j=b&&b.name,i=typeof j===m?j.call(b,{hash:{},data:e}):j),l+=n(i)+"\n				</div> \n\n				",j=c.isNotEmpty||b&&b.isNotEmpty,k={hash:{},inverse:p.program(3,g,e),fn:p.program(1,f,e),data:e},i=j?j.call(b,b&&b.message,k):o.call(b,"isNotEmpty",b&&b.message,k),(i||0===i)&&(l+=i),l+='\n\n				<div class="love-regards">',(j=c.getReceivedItemMessageSignature)?i=j.call(b,{hash:{},data:e}):(j=b&&b.getReceivedItemMessageSignature,i=typeof j===m?j.call(b,{hash:{},data:e}):j),(i||0===i)&&(l+=i),l+="</div>\n				\n				",k={hash:{},inverse:p.noop,fn:p.program(5,h,e),data:e},(j=c.ifCurrentUser)?i=j.call(b,k):(j=b&&b.ifCurrentUser,i=typeof j===m?j.call(b,k):j),c.ifCurrentUser||(i=q.call(b,i,{hash:{},inverse:p.noop,fn:p.program(5,h,e),data:e})),(i||0===i)&&(l+=i),l+='\n			</div>\n			<div class="share-modal-spacing clear"></div>\n		</div>\n	</div>\n</div>\n'})}),define("modules/view/gift/sidebar_gift_modal_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/globals/session_user","hbs!modules/template/gift/sidebar-gift-modal","modules/common/config","modules/common/utility","modules/chat/models/user_session","modules/common/session_user","modules/model/user/user_model","modules/globals/url","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=e.ItemView.extend({template:{type:"handlebars",template:h},id:"sidebar-gift-modal",className:"modal fade",ui:{favBtn:".gift-actions-bar .gift-favorite",giftBtn:".gift-actions-bar .gift-sendback",shareBtn:".gift-actions-bar .gift-share"},events:{"click @ui.favBtn":"favoriteGift","click @ui.giftBtn":"sendGift","click @ui.shareBtn":"shareGift"},favoriteGift:function(a){var b=new m({username:l.getInstance().get("username")}),c=this,d={itemId:this.model.id};b.fetch(),b.on("change",function(){b.addFavoriteGift(i.favorite.gift,d)}),b.on("fetch:error",function(){j.show_error(j.translate("chat|load-message-error"))}),b.on("favourite:gift",function(a){"add"==a.status&&(c.ui.favBtn.removeClass("icon-wb_favourite").addClass("icon-wb_like"),j.show_success(j.translate("chat|add_to_favourites"))),c.$el.modal("hide")})},sendGift:function(a){j.show_gift_selection("profile");var c=b("#gift-modal").find("input#to");c.tagit("removeAll").tagit("createTag",this.model.get("sender")),this.$el.modal("hide")},shareGift:function(a){var c=b("#sharebox-modal"),d=n.site+"u/"+l.getInstance().get("username")+"/store/"+i.store.type_to_category.VIRTUAL_GIFT+"/received/"+this.model.id,e=c.find("textarea.postbox-textarea");e.val(d),c.modal("show"),this.$el.modal("hide")}});return o}),define("hbs!modules/template/gift/gift-sidebar",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<a href="#" class="noUnderline" title="'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"user|view_gift_received",g):i.call(b,"translate","user|view_gift_received",g)))+'">\n	<img src="'+j((f=c.getGiftImageUrl||b&&b.getGiftImageUrl,g={hash:{},data:e},f?f.call(b,b&&b.location,64,"png",g):i.call(b,"getGiftImageUrl",b&&b.location,64,"png",g)))+'" width="49" height="49" />\n</a>'})}),define("modules/view/gift/gift_sidebar_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/view/gift/sidebar_gift_modal_view","hbs!modules/template/gift/gift-sidebar","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j){var k=e.ItemView.extend({template:{type:"handlebars",template:h},ui:{giftImg:"a"},events:{"click @ui.giftImg":"showGiftDetail"},className:"item-content no-padding display-inline",initialize:function(){a.bindAll(this)},showGiftDetail:function(a){a.preventDefault();var c=b("#main-container"),d=new g({model:this.model});c.after(d.render().el),d.$el.modal("show")}});return k}),define("hbs!modules/template/gift/gift-sidebar-collection",["handlebars"],function(a){return a.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},'<div id="gift-list" class="clearfix block font-size-12"></div>'})}),define("modules/view/gift/gift_sidebar_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/view/gift/gift_sidebar_view","hbs!modules/template/gift/gift-sidebar-collection","modules/view/common/mig33_views","modules/globals/session_user","modules/template/helpers/general_helpers","modules/template/helpers/store_helpers"],function(a,b,c,d,e,f,g,h,i,j,k,l){
var m=d.compile('{{#compare username "'+(null!==l?l.username:"")+'" }}{{translate "user|gifts_none_you"}}{{else}}{{translate "user|gifts_none" username}}{{/compare}}'),n=d.compile('{{translate "common|loading"}}...'),o=e.ItemView.extend({template:{type:"handlebars",template:m},className:"empty"}),p=e.ItemView.extend({template:{type:"handlebars",template:n},className:"loading"}),q=k.CompositeView.extend({itemView:i,emptyView:o,loadingView:p,itemViewContainer:"#gift-list",template:{type:"handlebars",template:j},initialize:function(){a.bindAll(this);var c=this;this.on("render",function(){b(window).on("scroll",function(a){c.more()})}),this.on("close",function(){b(window).off("scroll")})},prevScrollY:0,page:1,more:function(){var a=b(window).scrollTop()+b(window).height(),c=b(window).get(0).scrollHeight;c||(c=b(document).height()),a>=c-g.variable.infinitescroll_height&&this.prevScrollY<a&&this.trigger("gift:more",++this.page),this.prevScrollY=a}});return q}),define("modules/model/badge/badge_collection",["modules/model/common/mig33_collection","modules/mig33_app","modules/common/config","modules/common/utility","modules/model/badge/badge_model","underscore"],function(a,b,c,d,e,f){var g=a.extend({model:e,sortBy:"name",initialize:function(a,b){this.options=b},url:function(){return d.format(c.urls.badges,this.options.userId)},parse:function(a){return f.isUndefined(a.data.badges)||f.isNull(a.data.badges)?a:a.data.badges}});return g}),define("hbs!modules/template/badge/badge-modal",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h,i="",j=c.helperMissing,k=this.escapeExpression,l="function";return i+='<div class="modal-dialog">\n	<div class="modal-content">\n		<div class="modal-body">\n\n			<div class="badge-container text-center">\n\n                <span class="icon-wb_closepopup close pull-right font-color-grey visible-xs" data-dismiss="modal"></span>\n\n                <div class="badge-image text-center">\n                    <img src="'+k((g=c.getBadgeImageUrl||b&&b.getBadgeImageUrl,h={hash:{},data:e},g?g.call(b,b&&b.imageName,96,h):j.call(b,"getBadgeImageUrl",b&&b.imageName,96,h)))+'" />\n                </div>\n\n				<h3 class="font-light">',(g=c.name)?f=g.call(b,{hash:{},data:e}):(g=b&&b.name,f=typeof g===l?g.call(b,{hash:{},data:e}):g),i+=k(f)+'</h3>\n\n				<div class="badge-description">\n					',(g=c.description)?f=g.call(b,{hash:{},data:e}):(g=b&&b.description,f=typeof g===l?g.call(b,{hash:{},data:e}):g),i+=k(f)+'\n				</div>\n\n				<div class="badge-timestamp">\n					Earned '+k((g=c.timeAgoFormat||b&&b.timeAgoFormat,h={hash:{},data:e},g?g.call(b,b&&b.unlockedTimestamp,h):j.call(b,"timeAgoFormat",b&&b.unlockedTimestamp,h)))+'\n				</div>\n\n			</div>\n\n            <div class="badge-share-container text-center">\n                <span class="badge-share icon-wb_mb_share "></span> Share\n            </div>\n\n		</div>\n	</div>\n</div>\n'})}),define("modules/view/badge/badge_modal_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/globals/session_user","hbs!modules/template/badge/badge-modal","modules/common/config","modules/common/utility","modules/chat/models/user_session","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j,k){var l=(k.Session.getInstance(),e.ItemView.extend({template:{type:"handlebars",template:h},id:"badge-modal",className:"modal fade",onRender:function(){},events:{"click .badge-share-container":"displayShare"},displayShare:function(a){this.model.mimetype={mimeType:"application/vnd.migme.badge",mimeData:{thumbnailUrl:this.model.get("imageName"),badgeName:this.model.get("name"),description:this.model.get("description"),unlockTime:this.model.get("unlockedTimestamp"),badgeId:this.model.get("id"),username:this.model.collection.options.username}},j.show_share_dialog("badge",this.model),this.$el.modal("hide")}}));return l}),define("hbs!modules/template/badge/badge-list",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f,h="";return h+='\n	<a href="#" class="row">\n        <div class="col-xs-2 text-center no-padding">\n		    <img class="badge-img" src="'+k((e=c.getBadgeImageUrl||a&&a.getBadgeImageUrl,f={hash:{},data:b},e?e.call(a,a&&a.imageName,64,f):l.call(a,"getBadgeImageUrl",a&&a.imageName,64,f)))+'" />\n            ',d=c["if"].call(a,a&&a.categoryBadgesCount,{hash:{},inverse:m.noop,fn:m.program(2,g,b),data:b}),(d||0===d)&&(h+=d),h+='\n        </div>\n		<div class="col-xs-10 badge-details">\n			<div class="badge-title">',(e=c.name)?d=e.call(a,{hash:{},data:b}):(e=a&&a.name,d=typeof e===j?e.call(a,{hash:{},data:b}):e),h+=k(d)+'</div>\n			<div class="badge-description">',(e=c.description)?d=e.call(a,{hash:{},data:b}):(e=a&&a.description,d=typeof e===j?e.call(a,{hash:{},data:b}):e),h+=k(d)+'</div>\n			<div class="badge-timestamp">'+k((e=c.timeAgoFormat||a&&a.timeAgoFormat,f={hash:{},data:b},e?e.call(a,a&&a.unlockedTimestamp,f):l.call(a,"timeAgoFormat",a&&a.unlockedTimestamp,f)))+"</div>\n		</div>\n	</a>\n"}function g(a,b){var d,e,f="";return f+='\n                <span class="badge-tier">',(e=c.badgeTier)?d=e.call(a,{hash:{},data:b}):(e=a&&a.badgeTier,d=typeof e===j?e.call(a,{hash:{},data:b}):e),f+=k(d)+" of ",(e=c.categoryBadgesCount)?d=e.call(a,{hash:{},data:b}):(e=a&&a.categoryBadgesCount,d=typeof e===j?e.call(a,{hash:{},data:b}):e),f+=k(d)+"</span>\n            "}function h(a,b){var d,e,f,g="";return g+='\n	<a href="#" class="row">\n        <div class="col-xs-2 no-padding">\n		    <img class="badge-img" src="'+k((e=c.getBadgeImageMonotoneUrl||a&&a.getBadgeImageMonotoneUrl,f={hash:{},data:b},e?e.call(a,a&&a.imageName,64,f):l.call(a,"getBadgeImageMonotoneUrl",a&&a.imageName,64,f)))+'" />\n        </div>\n		<div class="col-xs-10 badge-details">\n			<div class="badge-title">',(e=c.name)?d=e.call(a,{hash:{},data:b}):(e=a&&a.name,d=typeof e===j?e.call(a,{hash:{},data:b}):e),g+=k(d)+'</div>\n			<div class="badge-description">',(e=c.description)?d=e.call(a,{hash:{},data:b}):(e=a&&a.description,d=typeof e===j?e.call(a,{hash:{},data:b}):e),g+=k(d)+"</div>\n		</div>\n	</a>\n"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var i,j="function",k=this.escapeExpression,l=c.helperMissing,m=this;return i=c["if"].call(b,b&&b.unlockedTimestamp,{hash:{},inverse:m.program(4,h,e),fn:m.program(1,f,e),data:e}),i||0===i?i:""})}),define("modules/view/badge/badge_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/view/badge/badge_modal_view","hbs!modules/template/badge/badge-list","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j){var k=e.ItemView.extend({template:{type:"handlebars",template:h},id:function(){return"badge-"+this.model.get("id")},className:"mig33-badge clearfix",onRender:function(){this.model.get("unlockedTimestamp")?b(this.el).addClass("unlocked"):b(this.el).addClass("locked")},events:{"click a":"displayBadgeDetail"},displayBadgeDetail:function(d){if(d.stopPropagation(),d.preventDefault(),!a.isUndefined(this.model.get("unlockedTimestamp"))&&this.model.get("unlockedTimestamp")){var e=b("#main-container"),f=new g({model:this.model}),h=c.history.fragment;h.indexOf("/badge")>=0&&(h="/u/"+this.model.collection.options.username+"/badges"),e.after(f.render().el),f.$el.modal("show"),f.$el.one("hidden.bs.modal",function(a){this.remove(),j.track_navigate(h)}),j.track_navigate("/u/"+this.model.collection.options.username+"/badge/"+this.model.id)}}});return k}),define("hbs!modules/template/badge/badge-sidebar-collection",["handlebars"],function(a){return a.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},'<div id="badge-list" class="clearfix block font-size-12"></div>'})}),define("modules/view/badge/badge_sidebar_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/view/badge/badge_item_view","hbs!modules/template/badge/badge-sidebar-collection","modules/view/common/mig33_views","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j,k){var l=d.compile('{{translate "user|badges_none"}}'),m=d.compile('{{translate "common|loading"}}...'),n=e.ItemView.extend({template:{type:"handlebars",template:l},className:"empty"}),o=e.ItemView.extend({template:{type:"handlebars",template:m},className:"loading"}),p=k.CompositeView.extend({itemView:i,emptyView:n,loadingView:o,itemViewContainer:"#badge-list",template:{type:"handlebars",template:j},initialize:function(){a.bindAll(this);var c=this;this.on("render",function(){b(window).on("scroll",function(a){c.more()})}),this.on("close",function(){b(window).off("scroll")})},prevScrollY:0,page:1,more:function(){var a=b(window).scrollTop()+b(window).height(),c=b(window).get(0).scrollHeight;c||(c=b(document).height()),a>=c-g.variable.infinitescroll_height&&this.prevScrollY<a&&this.trigger("badge:more",++this.page),this.prevScrollY=a}});return p}),define("modules/model/store/store_item_received_model",["underscore","backbone","modules/mig33_app","modules/common/config","modules/common/utility"],function(a,b,c,d,e){var f=b.Model.extend({initialize:function(a){this.options=a},url:function(){return e.format(d.urls.user_store_item_received,this.options.username,this.options.received_id)+"?type="+this.options.type}});return f}),define("modules/model/store/store_item_received_collection",["modules/model/common/mig33_collection","modules/mig33_app","modules/common/config","modules/common/utility","modules/model/store/store_item_received_model","underscore"],function(a,b,c,d,e,f){var g=a.extend({totalResults:0,model:e,initialize:function(a,b){this.options=b},url:function(){var a=""!=this.options.limit&&"number"==typeof this.options.limit?this.options.limit:c.store.items.received.limit;return d.format(c.urls.user_store_gifts_received,this.options.username)+"?offset="+(this.currentPage-1)*a+"&limit="+a},parse:function(a,b){return a.data&&!f.isUndefined(a.data.listData)&&null!==a.data.listData?(this.totalResults=a.data.totalResults,a.data.listData):[]}});return g}),define("modules/view/profile/profile_sidebar_view",["underscore","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/profile/profile-sidebar","modules/common/utility","modules/model/user/following_collection","modules/model/user/follower_collection","modules/model/user/friend_collection","modules/view/profile/friend_avatar_collection_view","modules/view/gift/gift_item_view","modules/view/gift/gift_sidebar_collection_view","modules/model/badge/badge_collection","modules/view/badge/badge_sidebar_collection_view","modules/model/user/user_model","modules/model/store/store_item_received_collection","modules/common/config","modules/mig33_app","modules/template/helpers/general_helpers","modules/template/helpers/user_helpers","modules/template/helpers/post_helpers"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){var s="/",t=d.Layout.extend({template:{type:"handlebars",template:f},templateHelpers:function(){return{num_friends:this.model.get("num_friends"),num_followers:this.model.get("num_followers"),num_following:this.model.get("num_following")}},className:"profile-sidebar",regions:{panel_custom:".panel-custom .panel-body",panel_invite:".panel-invite .panel-body",user_fan_of:"#user-leaderboard",artist_fotm:"#artist-fotm",artist_leaderboard:"#artist-leaderboard"},events:{"click .expand":"toggleExpanded","click .contract":"toggleContracted","click a.requires-login":"interceptLinks","click .show-prof-share":"showProfShare"},initialize:function(b,c){a.bindAll(this);var d=$(".dropdown"),e=$(".profile-dropdown");d.click(function(a){e.hide()})},onRender:function(){},onShow:function(){this.showSidebarFriendPanel(),this.showSidebarFanPanel(),this.showSidebarFollowingPanel(),this.showSidebarGiftPanel(),this.showSidebarBadgePanel()},toggleExpanded:function(b){b.preventDefault(),$(b.currentTarget).parent(".about-content-more").siblings(".about-content-description-field").text(a.escape(this.model.get($(b.currentTarget).data("field")))),$(b.currentTarget).text(g.translate("common|less")).toggleClass("expand contract")},toggleContracted:function(a){a.preventDefault(),$(a.currentTarget).parent(".about-content-more").siblings(".about-content-description-field").text(g.character_limiter(this.model.get($(a.currentTarget).data("field")),100,!0)),$(a.currentTarget).text(g.translate("common|more")).toggleClass("expand contract")},interceptLinks:function(a){g.is_logged_in()||(a.preventDefault(),a.stopPropagation(),g.show_login_dialog())},setBackButton:function(){$(".backButton").attr("href",s)},showSidebarFriendPanel:function(){var a=new j([],{userId:this.model.get("id")});a.setLimit(20),a.fetch();var c=new k({emptyViewModel:new b.Model({username:this.model.get("username")}),model:this.model,collection:a});$("#friendList").html(c.render().el)},showSidebarFanPanel:function(){var a=new i([],{userId:this.model.get("id")});a.setLimit(20),a.fetch();var c=new k({emptyViewModel:new b.Model({username:this.model.get("username")}),model:this.model,collection:a});$("#fanList").html(c.render().el)},showSidebarFollowingPanel:function(){var a=new h([],{userId:this.model.get("id")});a.setLimit(20),a.fetch();var c=new k({emptyViewModel:new b.Model({username:this.model.get("username")}),model:this.model,collection:a});$("#followingList").html(c.render().el)},showSidebarGiftPanel:function(){var a=new q([],{type:1,username:this.model.get("username")});a.fetch();var c=new m({emptyViewModel:new b.Model({username:this.model.get("username")}),model:this.model,collection:a});$("#giftList").html(c.render().el)},showSidebarBadgePanel:function(){var a=new n([],{userId:this.model.get("id"),username:this.model.get("username")});a.fetch();var c=new o({emptyViewModel:new b.Model({username:this.model.get("username")}),model:this.model,collection:a});$("#badgesList").html(c.render().el)},showProfilePost:function(){$(".container-profile-post").show()},hideProfilePost:function(){$(".container-profile-post").hide()},showAvatarPanel:function(){$(".panel-avatar",this.$el).show()},hideAvatarPanel:function(){$(".panel-avatar",this.$el).hide()},showAboutPanel:function(){$(".panel-about",this.$el).show()},hideAboutPanel:function(){$(".panel-about",this.$el).hide()},showCustomPanel:function(){$(".panel-custom",this.$el).show()},hideCustomPanel:function(){$(".panel-custom",this.$el).hide()},showInvitePanel:function(){$(".panel-invite",this.$el).show()},hideInvitePanel:function(){$(".panel-invite",this.$el).hide()},showSidebar:function(){$(".sidebar-profile").show()},hideSidebar:function(){$(".sidebar-profile").hide()},showArtistLeaderboardPanel:function(){$("#artist-fotm",this.$el).show(),$("#artist-fotm",this.$el).removeClass("hidden"),$("#artist-leaderboard",this.$el).show(),$("#artist-leaderboard",this.$el).removeClass("hidden")},setCustomPanelTitle:function(a){$(".panel-custom .panel-title",this.$el).text(a)},setCustomPanelFooter:function(a){$(".panel-custom .panel-footer a",this.$el).attr("href",a)},showProfShare:function(a){null!==a&&a.preventDefault(),g.show_share_dialog("user",this.model)}});return t}),define("hbs!modules/template/profile/posts-layout",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+='\n  <div id="mention_subtitle_bar" class="row no-margin">\n    <div class="subtitle friend col-xs-12">\n      '+l((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"homefeed|mentions",e):k.call(a,"translate","homefeed|mentions",e)))+"\n    </div>\n  </div>\n"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var g,h,i,j="",k=c.helperMissing,l=this.escapeExpression,m=this;return h=c.compare||b&&b.compare,i={hash:{},inverse:m.noop,fn:m.program(1,f,e),data:e},g=h?h.call(b,b&&b.type,"mentions",i):k.call(b,"compare",b&&b.type,"mentions",i),(g||0===g)&&(j+=g),j+='\n\n<div class="posts"></div>'})}),define("modules/view/profile/posts_layout",["jquery","underscore","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/common/session_user","modules/view/common/postbox_view","hbs!modules/template/profile/posts-layout","modules/template/helpers/general_helpers","modules/template/helpers/post_helpers"],function(a,b,c,d,e,f,g,h,i,j,k){var l=e.Layout.extend({onShow:function(){},template:{type:"handlebars",template:k},regions:{posts:".posts"},incrementPostsCount:function(b){var c=a("."+b+"-posts-count",this.$el);c.text(parseInt(c.text(),10)+1)},decrementPostsCount:function(b){var c=a("."+b+"-posts-count",this.$el);c.text(parseInt(c.text(),10)-1)}});return l}),define("modules/model/user/about_model",["underscore","backbone","modules/common/config","modules/mig33_app","modules/common/utility"],function(a,b,c){var d=b.Model.extend({initialize:function(a,b){this.options=b},url:function(){return c.urls.mainpage_url+"ajax/datasvc/user/"+this.get("username")+"?useUsername=1"},parse:function(a){return a.data?a.data:a}});return d}),define("modules/model/game/game_model",["underscore","backbone","modules/mig33_app","modules/common/config","modules/common/utility"],function(a,b){var c=b.Model.extend({initialize:function(a){this.options=a}});return c}),define("modules/model/game/game_collection",["modules/model/common/mig33_collection","modules/common/config","modules/common/utility","modules/model/game/game_model","underscore"],function(a,b,c,d,e){var f=a.extend({model:d,initialize:function(a,b){this.options=b},url:function(){return"user_played"==this.options.type?c.format(b.urls.user_games,this.options.username):null},parse:function(a){return a.data&&!e.isUndefined(a.data.games)&&null!==a.data.games?a.data.games:a}});return f}),define("modules/model/group/group_collection",["modules/model/common/mig33_collection","modules/common/config","modules/common/utility","modules/model/group/group_model","underscore"],function(a,b,c,d,e){var f=a.extend({model:d,limit:b.groups.limit,totalResults:0,userId:0,initialize:function(a,b){this.options=b},url:function(){return"user_joined"==this.options.type?c.format(b.urls.user_groups,this.options.userId,this.currentPage,this.limit):"official"==this.options.type?c.format(b.urls.groups_official,this.currentPage,this.limit):"games"==this.options.type?b.urls.groups_games:null},parse:function(a){return null===a.data||e.isUndefined(a.data.groups)||null===a.data.groups?null:(this.totalResults+=a.data.groups.length,a.data.groups)},getTotalResults:function(){return this.totalResults}});return f}),define("modules/model/user/leaderboard_collection",["modules/model/common/mig33_collection","modules/mig33_app","modules/common/config","modules/common/utility","modules/model/user/user_model","underscore"],function(a,b,c,d,e,f){var g={ALL:1,GIFT:2,ENGAGEMENT:3},h={PREVIOUS_MONTHLY:"PREVIOUS_MONTHLY",MONTHLY:"MONTHLY",ALL_TIME:"ALL_TIME"},i=a.extend({model:e,limit:10,initialize:function(a,b){this.options=b,this.options.type=this.options.type||g.ALL,this.options.period=this.options.period||h.MONTHLY,this.limit=this.options.limit||this.limit},url:function(){return d.format(c.urls.user_engagement,this.options.userId,this.options.type,this.options.period)},parse:function(a){if(a.data){if(a.data=a.data.slice(0,this.limit),a.data.length>0)for(var b=0;b<a.data.length;b++){a.data[b].username=a.data[b].member,a.data[b].display_picture_type=a.data[b].displayPictureType<1?1:a.data[b].displayPictureType;var c=a.data[b].alias||a.data[b].username;a.data[b].personalized_url=d.get_profile_url(c),a.data[b].rank=b+1,a.data[b].hidden=!1,this.options.contracted&&this.options.contracted_item_view&&b>=this.options.contracted_item_view&&(a.data[b].hidden=!0)}return a.data}return null},update:function(a,b){this.options.type=g[a]||this.options.type,this.options.period=h[b]||this.options.period,this.fetch()},updateType:function(a){this.options.type=g[a]||this.options.type,this.fetch()},updatePeriod:function(a){this.options.period=h[a]||this.options.period,this.fetch()}});return i}),define("modules/model/user/fanofthemonth_collection",["modules/model/common/mig33_collection","modules/mig33_app","modules/common/config","modules/common/utility","modules/model/user/user_model","underscore"],function(a,b,c,d,e,f){var g=a.extend({model:e,initialize:function(a,b){this.options=b},url:function(){return d.format(c.urls.user_fan_of_the_month,this.options.userId)},parse:function(a){if(a.data){if(a.data.length>0)for(var b=0;b<a.data.length;b++){a.data[b].username=a.data[b].member,a.data[b].display_picture_type=a.data[b].displayPictureType<1?1:a.data[b].displayPictureType;var c=a.data[b].alias||a.data[b].username;a.data[b].personalized_url=d.get_profile_url(c),a.data[b].rank=b+1,a.data[b].hidden=!1,this.options.contracted&&this.options.contracted_item_view&&b>=this.options.contracted_item_view&&(a.data[b].hidden=!0)}return a.data}return null}});return g}),define("modules/model/user/about_collection",["modules/model/common/mig33_collection","modules/mig33_app","modules/common/config","modules/common/utility","modules/model/user/about_model","underscore"],function(a,b,c,d,e,f){var g=a.extend({model:e,totalCount:0,newCount:0,initialize:function(a,b){this.options=b},url:function(){return"http://mig.me/ajax/datasvc/user/johnnywu1?useUsername=1"},parse:function(a){return a.data?a.data:a}});return g}),define("modules/model/store/store_favorite_item_received_collection",["modules/model/common/mig33_collection","modules/mig33_app","modules/common/config","modules/common/utility","modules/model/store/store_item_received_model","underscore"],function(a,b,c,d,e,f){var g=a.extend({totalResults:0,model:e,initialize:function(a,b){this.options=b},url:function(){var a=""!=this.options.limit&&"number"==typeof this.options.limit?this.options.limit:c.store.items.received.limit;return d.format(c.urls.user_store_gifts_list,this.options.id)+"?offset="+(this.currentPage-1)*a+"&ascDesc=DESC&category=FAVORITE&orderBy=DATE&limit="+a},parse:function(a,b){return a.data&&!f.isUndefined(a.data.listData)&&null!==a.data.listData?(this.totalResults=a.data.totalResults,a.data.listData):[]}});return g}),define("modules/model/chatroom/chatroom_model",["underscore","backbone","modules/mig33_app","modules/common/config","modules/common/utility"],function(a,b){var c=b.Model.extend({initialize:function(a){this.options=a}});return c}),define("modules/model/chatroom/chatroom_collection",["modules/model/common/mig33_collection","modules/common/config","modules/common/utility","modules/model/chatroom/chatroom_model","underscore"],function(a,b,c,d,e){var f=a.extend({model:d,totalResults:0,initialize:function(a,b){this.options=b},url:function(){return c.format(b.urls.user_chatrooms,this.options.username,this.currentPage,b.profile.chatrooms.limit)},parse:function(a){if(null!==a.data)if("own"==this.options.type){if(!e.isUndefined(a.data.own.chatrooms)&&!e.isNull(a.data.own.chatrooms))return this.totalResults=a.data.own.total,a.data.own.chatrooms}else if("mod"==this.options.type&&!e.isUndefined(a.data.mod.chatrooms))return this.totalResults=a.data.mod.total,a.data.mod.chatrooms;return null},getTotalResults:function(){return this.totalResults}});return f}),define("modules/model/setting/setting_coverphoto_model",["underscore","backbone","modules/mig33_app","modules/common/config","modules/common/utility"],function(a,b,c,d,e){var f=b.Model.extend({setCoverPhoto:function(){if(!e.is_logged_in())return null;var a=this;return $.ajax({type:"post",cache:!1,dataType:"json",url:d.urls.coverphotos,data:"url="+a.get("url")})}});return f}),define("modules/model/setting/setting_coverphoto_collection",["modules/model/common/mig33_collection","modules/mig33_app","modules/common/config","modules/common/utility","modules/model/setting/setting_coverphoto_model","underscore"],function(a,b,c,d,e,f){var g=a.extend({model:e,initialize:function(a,b){this.options=b},url:function(){return c.urls.coverphotos},parse:function(a){return f.isUndefined(a.data)||null===a.data?a:a.data}});return g}),define("hbs!modules/template/game/game-profile-sidebar-list",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f,g="";return g+='\n    <a href="/group/',(e=c.group_id)?d=e.call(a,{hash:{},data:b}):(e=a&&a.group_id,d=typeof e===k?e.call(a,{hash:{},data:b}):e),g+=l(d)+'" title="',(e=c.display_name)?d=e.call(a,{hash:{},data:b}):(e=a&&a.display_name,d=typeof e===k?e.call(a,{hash:{},data:b}):e),g+=l(d)+'"><img src="'+l((e=c.getGameImage||a&&a.getGameImage,f={hash:{},data:b},e?e.call(a,"24","24",f):m.call(a,"getGameImage","24","24",f)))+'" /></a>\n'}function g(a,b){var d,e,f="";return f+='\n    <a href="/sites/ajax/bot/bot_help?id=',(e=c.id)?d=e.call(a,{hash:{},data:b}):(e=a&&a.id,d=typeof e===k?e.call(a,{hash:{},data:b}):e),f+=l(d)+'&p=1" title="',(e=c.display_name)?d=e.call(a,{hash:{},data:b}):(e=a&&a.display_name,d=typeof e===k?e.call(a,{hash:{},data:b}):e),f+=l(d)+'"><img src="/sites/resources/images/icons/24/24_games.png" /></a>\n'}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var h,i,j,k="function",l=this.escapeExpression,m=c.helperMissing,n=this;return i=c.compare||b&&b.compare,j={hash:{},inverse:n.program(3,g,e),fn:n.program(1,f,e),data:e},h=i?i.call(b,b&&b.type,"GAME",j):m.call(b,"compare",b&&b.type,"GAME",j),h||0===h?h:""})}),define("modules/template/helpers/game_helpers",["underscore","handlebars","modules/common/utility"],function(a,b){b.registerHelper("getGameImage",function(a,b){var c=this;return c.group_picture_url+"?w="+a+"&h="+b})}),define("modules/view/game/game_profile_sidebar_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/game/game-profile-sidebar-list","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers","modules/template/helpers/game_helpers"],function(a,b,c,d,e,f,g){var h=e.ItemView.extend({template:{type:"handlebars",template:g},tagName:"li"});return h}),define("modules/view/game/game_profile_sidebar_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/session_user","modules/view/game/game_profile_sidebar_item_view","modules/view/common/mig33_views","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j){var k=d.compile('{{translate "game|empty_games"}}'),l=d.compile('{{translate "common|loading"}}...'),m=e.ItemView.extend({template:{type:"handlebars",template:k},tagName:"li",className:"empty"}),n=e.ItemView.extend({template:{type:"handlebars",template:l},tagName:"li",className:"loading"}),o=j.CollectionView.extend({itemView:i,emptyView:m,loadingView:n,tagName:"ul",className:"inline",addMore:function(){b(this.$el).append('<li><a href="'+h.getInstance().get("personalized_url")+'/games" class="requires-login"><i class="ico ico-24 ico-profile-more"></i></a></li>')}});return o}),define("hbs!modules/template/group/group-profile-sidebar-list",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f,g="";return g+='\n		<img src="'+l((e=c.getUrl||a&&a.getUrl,f={hash:{},data:b},e?e.call(a,"image",f):k.call(a,"getUrl","image",f)))+"/",(e=c.display_file_id)?d=e.call(a,{hash:{},data:b}):(e=a&&a.display_file_id,d=typeof e===m?e.call(a,{hash:{},data:b}):e),g+=l(d)+'?w=48&h=48&a=1&c=1" class="img-circle" />\n	'}function g(a,b){var d,e,f="";return f+='\n		<img src="'+l((d=c.getUrl||a&&a.getUrl,e={hash:{},data:b},d?d.call(a,"jsclient",e):k.call(a,"getUrl","jsclient",e)))+'/app/images/group_defaultimg.png" width="48" height="48" class="img-circle" />\n	'}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var h,i,j="",k=c.helperMissing,l=this.escapeExpression,m="function",n=this;return j+='<a class="pull-left" href="/group/',(i=c.id)?h=i.call(b,{hash:{},data:e}):(i=b&&b.id,h=typeof i===m?i.call(b,{hash:{},data:e}):i),j+=l(h)+'">\n	',h=c["if"].call(b,b&&b.display_file_id,{hash:{},inverse:n.program(3,g,e),fn:n.program(1,f,e),data:e}),(h||0===h)&&(j+=h),j+='\n</a>\n<div class="media-body">\n	<h4 class="media-heading font-size-16">\n		<a href="/group/',(i=c.id)?h=i.call(b,{hash:{},data:e}):(i=b&&b.id,h=typeof i===m?i.call(b,{hash:{},data:e}):i),j+=l(h)+'" title="',(i=c.name)?h=i.call(b,{hash:{},data:e}):(i=b&&b.name,h=typeof i===m?i.call(b,{hash:{},data:e}):i),j+=l(h)+'">',(i=c.name)?h=i.call(b,{hash:{},data:e}):(i=b&&b.name,h=typeof i===m?i.call(b,{hash:{},data:e}):i),j+=l(h)+"</a>\n	</h4>\n</div>"})}),define("modules/view/group/group_profile_sidebar_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/group/group-profile-sidebar-list","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers","modules/template/helpers/group_helpers"],function(a,b,c,d,e,f,g){var h=e.ItemView.extend({template:{type:"handlebars",template:g},className:"media"});return h}),define("modules/view/group/group_profile_sidebar_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/session_user","modules/view/group/group_profile_sidebar_item_view","modules/view/common/mig33_views","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j){var k=d.compile('{{translate "group|empty_groups"}}'),l=d.compile('{{translate "common|loading"}}...'),m=e.ItemView.extend({template:{type:"handlebars",template:k},className:"empty"}),n=e.ItemView.extend({template:{type:"handlebars",template:l},className:"loading"}),o=j.CollectionView.extend({itemView:i,emptyView:m,loadingView:n,className:"groups"});return o}),define("hbs!modules/template/profile/follower-following-friend-list",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f;return e=c.ifUserCanShowAge||a&&a.ifUserCanShowAge,f={hash:{},inverse:u.noop,fn:u.program(2,g,b),data:b},d=e?e.call(a,a,f):s.call(a,"ifUserCanShowAge",a,f),d||0===d?d:""}function g(a,b){var d,e,f="";return f+=t((d=c.userGetAge||a&&a.userGetAge,e={hash:{},data:b},d?d.call(a,a,e):s.call(a,"userGetAge",a,e)))+", "}function h(a,b){var d,e,f="";return f+=t((d=c.userGetGender||a&&a.userGetGender,e={hash:{},data:b},d?d.call(a,a,e):s.call(a,"userGetGender",a,e)))+", "}function i(a,b){var d,e,f="";return(e=c.country)?d=e.call(a,{hash:{},data:b}):(e=a&&a.country,d=typeof e===v?e.call(a,{hash:{},data:b}):e),f+=t(d)+", "}function j(a,b){var d,e,f="";return f+='\n							<li><a href="#" onclick="return false;" title="'+t((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"user|unblock",e):s.call(a,"translate","user|unblock",e)))+'" class="user-unblock">'+t((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"user|unblock",e):s.call(a,"translate","user|unblock",e)))+"</a></li>\n						"}function k(a,b){var d,e,f="";return f+='\n							<li><a href="#" onclick="return false;" title="'+t((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"user|block",e):s.call(a,"translate","user|block",e)))+'" class="user-block">'+t((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"user|block",e):s.call(a,"translate","user|block",e)))+"</a></li>\n						"}function l(a,b){var d,e="";return e+="\n				",d=c["if"].call(a,(d=a&&a.relationship,null==d||d===!1?d:d.is_self),{hash:{},inverse:u.program(15,n,b),fn:u.program(13,m,b),data:b}),(d||0===d)&&(e+=d),e+="\n			"}function m(a,b){return'\n				<ul class="list-inline">\n					<li class="user-stat">\n					</li>\n				</ul>\n				'}function n(a,b){var d,e,f="";return f+='\n				<ul class="list-inline">\n					<li class="user-stat">\n						<a class="user-relationship cursor_pointer"></a>\n						<a class="follow cursor_pointer" title="'+t((d=c.translate||a&&a.translate,
e={hash:{},data:b},d?d.call(a,"user|add",e):s.call(a,"translate","user|add",e)))+'"></a>\n					</li>\n					<li class="user-stat">\n						<a href="#" class="send-gift" title="'+t((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"user|gifts",e):s.call(a,"translate","user|gifts",e)))+'">\n							<span class="icon-wb_gift" alt="'+t((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"user|gifts",e):s.call(a,"translate","user|gifts",e)))+'"></span>\n						</a>\n					</li>\n					<li class="user-stat">\n						<a class="chat" title="'+t((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"chat|chat",e):s.call(a,"translate","chat|chat",e)))+'"><span class="icon-wb_chat" alt="'+t((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"chat|chat",e):s.call(a,"translate","chat|chat",e)))+'"></span></a>\n					</li>\n				</ul>\n				'}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var o,p,q,r="",s=c.helperMissing,t=this.escapeExpression,u=this,v="function",w=c.blockHelperMissing;return r+='<div class="search-user-avatar left">\n	<div class="user-avatar">\n		<a href="'+t((p=c.getProfileUrl||b&&b.getProfileUrl,q={hash:{},data:e},p?p.call(b,b&&b.username,q):s.call(b,"getProfileUrl",b&&b.username,q)))+'" class="profile-hovercard" data-username="',(p=c.username)?o=p.call(b,{hash:{},data:e}):(p=b&&b.username,o=typeof p===v?p.call(b,{hash:{},data:e}):p),r+=t(o)+'">\n			<img src="'+t((p=c.userGetDisplayPictureUrl||b&&b.userGetDisplayPictureUrl,q={hash:{},data:e},p?p.call(b,64,64,b,q):s.call(b,"userGetDisplayPictureUrl",64,64,b,q)))+'" width="64" height="64" class="img-circle" />\n		</a>\n	</div>\n</div>\n<div class="search-user-details">\n		<div class="user-details">\n			<div class="user-username">\n				<a href="'+t((p=c.getProfileUrl||b&&b.getProfileUrl,q={hash:{},data:e},p?p.call(b,b&&b.username,q):s.call(b,"getProfileUrl",b&&b.username,q)))+'" class="profile-hovercard" data-username="',(p=c.username)?o=p.call(b,{hash:{},data:e}):(p=b&&b.username,o=typeof p===v?p.call(b,{hash:{},data:e}):p),r+=t(o)+'">',(p=c.username)?o=p.call(b,{hash:{},data:e}):(p=b&&b.username,o=typeof p===v?p.call(b,{hash:{},data:e}):p),r+=t(o)+"</a>\n				"+t((p=c.userGetLabels||b&&b.userGetLabels,q={hash:{},data:e},p?p.call(b,b,q):s.call(b,"userGetLabels",b,q)))+'\n			</div>\n			<div class="user-about">\n				<span class="user-profile">\n					',p=c.isNotEmpty||b&&b.isNotEmpty,q={hash:{},inverse:u.noop,fn:u.program(1,f,e),data:e},o=p?p.call(b,b&&b.date_of_birth,q):s.call(b,"isNotEmpty",b&&b.date_of_birth,q),(o||0===o)&&(r+=o),r+="\n					",p=c.isNotEmpty||b&&b.isNotEmpty,q={hash:{},inverse:u.noop,fn:u.program(4,h,e),data:e},o=p?p.call(b,b&&b.gender,q):s.call(b,"isNotEmpty",b&&b.gender,q),(o||0===o)&&(r+=o),r+="\n					",p=c.isNotEmpty||b&&b.isNotEmpty,q={hash:{},inverse:u.noop,fn:u.program(6,i,e),data:e},o=p?p.call(b,b&&b.country,q):s.call(b,"isNotEmpty",b&&b.country,q),(o||0===o)&&(r+=o),r+="\n					"+t((p=c.translate||b&&b.translate,q={hash:{},data:e},p?p.call(b,"user|miglevel_with_level",b&&b.mig_level,q):s.call(b,"translate","user|miglevel_with_level",b&&b.mig_level,q)))+'\n				</span>\n			</div>\n			<div class="btn-group">\n					<a class="btn btn-xs btn-blank dropdown-toggle no-shadow" data-toggle="dropdown" href="#">\n						<span class="icon-wb_more" alt="'+t((p=c.translate||b&&b.translate,q={hash:{},data:e},p?p.call(b,"common|show_more",q):s.call(b,"translate","common|show_more",q)))+'"></span>\n					</a>\n					<ul class="dropdown-menu text-left">\n						<li>\n							<a href="#" class="unfollow-link unfollow hidden">'+t((p=c.translate||b&&b.translate,q={hash:{},data:e},p?p.call(b,"user|remove_as_friend",q):s.call(b,"translate","user|remove_as_friend",q)))+'</a>\n						</li>\n						<li>\n							<a href="#" class="send-gift" title="'+t((p=c.translate||b&&b.translate,q={hash:{},data:e},p?p.call(b,"user|send_gift",q):s.call(b,"translate","user|send_gift",q)))+'">'+t((p=c.translate||b&&b.translate,q={hash:{},data:e},p?p.call(b,"user|send_gift",q):s.call(b,"translate","user|send_gift",q)))+'</a>\n						</li>\n						<li>\n							<a href="/sites/ajax/account/transfer_credit?win_id=account-window&recipient_username=',(p=c.username)?o=p.call(b,{hash:{},data:e}):(p=b&&b.username,o=typeof p===v?p.call(b,{hash:{},data:e}):p),r+=t(o)+'" class="transfer-credit" title="'+t((p=c.translate||b&&b.translate,q={hash:{},data:e},p?p.call(b,"user|transfer_credit",q):s.call(b,"translate","user|transfer_credit",q)))+'">'+t((p=c.translate||b&&b.translate,q={hash:{},data:e},p?p.call(b,"user|transfer_credit",q):s.call(b,"translate","user|transfer_credit",q)))+"</a>\n						</li>\n						",o=c["if"].call(b,(o=b&&b.relationship,null==o||o===!1?o:o.is_blocked_by),{hash:{},inverse:u.program(10,k,e),fn:u.program(8,j,e),data:e}),(o||0===o)&&(r+=o),r+='\n						<li>\n							<a href="/sites/ajax/report/report_abuse?win_id=report_abuse&type=2&offender=',(p=c.username)?o=p.call(b,{hash:{},data:e}):(p=b&&b.username,o=typeof p===v?p.call(b,{hash:{},data:e}):p),r+=t(o)+'&subject=Profile%20Abuse" title="'+t((p=c.translate||b&&b.translate,q={hash:{},data:e},p?p.call(b,"common|report",q):s.call(b,"translate","common|report",q)))+'">'+t((p=c.translate||b&&b.translate,q={hash:{},data:e},p?p.call(b,"common|report",q):s.call(b,"translate","common|report",q)))+'</a>\n						</li>\n					</ul>\n				</div>\n		</div>\n		\n	<div class="col-xs-10 no-padding">\n		<div class="left">\n			<div class="user-stats">\n			',q={hash:{},inverse:u.noop,fn:u.program(12,l,e),data:e},(p=c.ifLoggedIn)?o=p.call(b,q):(p=b&&b.ifLoggedIn,o=typeof p===v?p.call(b,q):p),c.ifLoggedIn||(o=w.call(b,o,{hash:{},inverse:u.noop,fn:u.program(12,l,e),data:e})),(o||0===o)&&(r+=o),r+='\n			</div>\n		</div>\n		<div class="user-actions right">\n		</div>\n	</div>\n</div>'})}),define("modules/view/profile/follower_following_friend_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/view/user/user_view","hbs!modules/template/profile/follower-following-friend-list","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j){var k=g.extend({options:[],template:{type:"handlebars",template:h},className:function(){return"follower"===this.options.type?"user"+(this.model.get("isNew")?" user-new":""):"user"},events:function(){return a.extend({},g.prototype.events,{"click .send-gift":"sendGift"})},onRender:function(){j.parse_profile_hovercard(this),g.prototype.onRender.apply(this,arguments)},initialize:function(a){this.options=a}});return k}),define("hbs!modules/template/profile/about-collection",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){return'\n			<a href="/sites/ajax/settings/account_picture"><span class="toggle_searchbar_button icon-wb_edit font-size-16"></span></a>\n		'}function g(a,b){return'\n			<span class="toggle_searchbar_button icon-wb_edit font-size-16 hidden"></span>\n		'}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var h,i,j,k="",l=c.helperMissing,m=this.escapeExpression,n=this,o="function";return k+='<div class="row no-margin">\n	<div class="subtitle follower col-md-8">\n		'+m((i=c.translate||b&&b.translate,j={hash:{},data:e},i?i.call(b,"user|about",j):l.call(b,"translate","user|about",j)))+'\n	</div>\n	<div class="subtitle follower col-md-4 text-right search-form-btn">\n		',i=c.ifIsSelf||b&&b.ifIsSelf,j={hash:{},inverse:n.program(3,g,e),fn:n.program(1,f,e),data:e},h=i?i.call(b,b&&b.username,j):l.call(b,"ifIsSelf",b&&b.username,j),(h||0===h)&&(k+=h),k+='\n	</div>\n</div>\n<div class="about-list">\n	<div class="title">'+m((i=c.translate||b&&b.translate,j={hash:{},data:e},i?i.call(b,"user|basic_info",j):l.call(b,"translate","user|basic_info",j)))+'</div>\n	<div class="about-item">\n		<span class="about-label">'+m((i=c.translate||b&&b.translate,j={hash:{},data:e},i?i.call(b,"user|name",j):l.call(b,"translate","user|name",j)))+'</span>\n		<span class="about-info">',(i=c.username)?h=i.call(b,{hash:{},data:e}):(i=b&&b.username,h=typeof i===o?i.call(b,{hash:{},data:e}):i),k+=m(h)+'</span>\n	</div>\n	<div class="about-item">\n		<span class="about-label">'+m((i=c.translate||b&&b.translate,j={hash:{},data:e},i?i.call(b,"user|birthday",j):l.call(b,"translate","user|birthday",j)))+'</span>\n		<span class="about-info">',(i=c.dateOfBirth)?h=i.call(b,{hash:{},data:e}):(i=b&&b.dateOfBirth,h=typeof i===o?i.call(b,{hash:{},data:e}):i),k+=m(h)+'</span>\n	</div>\n	<div class="about-item">\n		<span class="about-label">'+m((i=c.translate||b&&b.translate,j={hash:{},data:e},i?i.call(b,"user|gender",j):l.call(b,"translate","user|gender",j)))+'</span>\n		<span class="about-info">',(i=c.gender)?h=i.call(b,{hash:{},data:e}):(i=b&&b.gender,h=typeof i===o?i.call(b,{hash:{},data:e}):i),k+=m(h)+'</span>\n	</div>\n	<div class="about-item">\n		<span class="about-label">'+m((i=c.translate||b&&b.translate,j={hash:{},data:e},i?i.call(b,"user|relationship",j):l.call(b,"translate","user|relationship",j)))+'</span>\n		<span class="about-info">'+m((i=c.relationshipToName||b&&b.relationshipToName,j={hash:{},data:e},i?i.call(b,b&&b.relationship,j):l.call(b,"relationshipToName",b&&b.relationship,j)))+'</span>\n	</div>\n	<div class="about-item">\n		<span class="about-label">'+m((i=c.translate||b&&b.translate,j={hash:{},data:e},i?i.call(b,"common|city",j):l.call(b,"translate","common|city",j)))+'</span>\n		<span class="about-info">',(i=c.city)?h=i.call(b,{hash:{},data:e}):(i=b&&b.city,h=typeof i===o?i.call(b,{hash:{},data:e}):i),k+=m(h)+'</span>\n	</div>\n	<div class="title">'+m((i=c.translate||b&&b.translate,j={hash:{},data:e},i?i.call(b,"user|about",j):l.call(b,"translate","user|about",j)))+'</div>\n	<div class="about-item">\n		<span class="about-info-left">',(i=c.aboutMe)?h=i.call(b,{hash:{},data:e}):(i=b&&b.aboutMe,h=typeof i===o?i.call(b,{hash:{},data:e}):i),k+=m(h)+'</span>\n	</div>\n	<div class="title">'+m((i=c.translate||b&&b.translate,j={hash:{},data:e},i?i.call(b,"user|interests",j):l.call(b,"translate","user|interests",j)))+'</div>\n	<div class="about-item">\n		<span class="about-info-left">',(i=c.interests)?h=i.call(b,{hash:{},data:e}):(i=b&&b.interests,h=typeof i===o?i.call(b,{hash:{},data:e}):i),k+=m(h)+'</span>\n	</div>\n	<div class="title">'+m((i=c.translate||b&&b.translate,j={hash:{},data:e},i?i.call(b,"user|work",j):l.call(b,"translate","user|work",j)))+'</div>\n	<div class="about-item">\n		<span class="about-info-left">',(i=c.companies)?h=i.call(b,{hash:{},data:e}):(i=b&&b.companies,h=typeof i===o?i.call(b,{hash:{},data:e}):i),k+=m(h)+"</span>\n	</div>\n</div>"})}),define("modules/view/profile/about_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/view/profile/follower_following_friend_item_view","hbs!modules/template/profile/about-collection","modules/view/common/mig33_views","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j,k){var l=d.compile('{{translate "common|loading"}}...'),m=e.ItemView.extend({template:{type:"handlebars",template:l},className:"loading"}),n=e.ItemView.extend({loadingView:m,template:{type:"handlebars",template:j},initialize:function(){a.bindAll(this)}});return n}),define("hbs!modules/template/profile/follower-collection",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h,i="",j=c.helperMissing,k=this.escapeExpression,l="function";return i+='<div id="follower_subtitle_bar">\n	<div class="subtitle follower col-md-8">\n		'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"user|fans",h):j.call(b,"translate","user|fans",h)))+" (",(g=c.num_followers)?f=g.call(b,{hash:{},data:e}):(g=b&&b.num_followers,f=typeof g===l?g.call(b,{hash:{},data:e}):g),i+=k(f)+')\n	</div>\n	<div class="subtitle follower col-md-4 text-right search-form-btn">\n		<span class="toggle_searchbar_button icon-wb_search font-size-16"></span>\n	</div>\n</div>\n\n<!-- start of search bar: default: hidden -->\n<div id="follower_search_bar" class="hidden">\n	<div class="col-md-11 no-padding">\n		<div class="subtitle follower search-form-btn-left">\n			<span class="icon-wb_search font-size-16 left"></span>\n		</div>\n		<input type="text" name="filter_input" placeholder="Search" value="" id="filter_input" class="subtitle follower form-control">\n	</div>\n	<div class="subtitle follower col-md-1 text-right">\n		<span class="icon-wb_closepopup toggle_searchbar_button mini" alt="'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"common|close",h):j.call(b,"translate","common|close",h)))+'"></span>\n	</div>\n</div>\n<!-- end of search bar: default: hidden -->\n\n<div class="users users-followers"></div>'})}),define("modules/view/profile/follower_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/view/profile/follower_following_friend_item_view","hbs!modules/template/profile/follower-collection","modules/view/common/mig33_views","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j,k){var l=d.compile('{{translate "user|fans_none" username}}'),m=d.compile('{{translate "common|loading"}}...'),n=e.ItemView.extend({template:{type:"handlebars",template:l},className:"empty"}),o=e.ItemView.extend({template:{type:"handlebars",template:m},className:"loading"}),p=k.CompositeView.extend({itemView:i,emptyView:n,loadingView:o,itemViewContainer:".users",itemViewClass:".user",itemViewOptions:function(a,b){return{type:"follower",itemIndex:b}},template:{type:"handlebars",template:j},events:{"click .toggle_searchbar_button":"_toggleSearchBar","keyup #filter_input":a.throttle(function(a){this._doFilter()},200)},initialize:function(){a.bindAll(this);var c=this;this.on("render",function(){b(window).on("scroll",function(a){c.more(a)})}),this.on("close",function(){b(window).off("scroll")})},prevScrollY:0,page:1,more:function(){var a=b(window).scrollTop()+b(window).height(),c=b(window).get(0).scrollHeight;c||(c=b(document).height()),a>=c-g.variable.infinitescroll_height&&this.prevScrollY<a&&this.trigger("follower:more",++this.page),this.prevScrollY=a},setNewFollowersCount:function(a){a>0&&b(".followers-stats",this.$el).text(h.translate("user|new_fans_with_count",a)).show()},_doFilter:function(){var c=a.escape(b("#filter_input",this.$el).val());this._hideAll(),this.$el.find(this.itemViewClass+":containsIgnoreCase('"+c.toLowerCase()+"')").show()},_resetFilter:function(){b("#filter_input",this.$el).val(""),this._showAll()},_hideAll:function(){this.$el.find(this.itemViewClass).hide()},_showAll:function(){this.$el.find(this.itemViewClass).show()},_toggleSearchBar:function(){this.$el.find("#follower_subtitle_bar").hasClass("hidden")?(this._resetFilter(),this.$el.find("#follower_search_bar").addClass("hidden"),this.$el.find("#follower_subtitle_bar").removeClass("hidden")):(this.$el.find("#follower_search_bar").removeClass("hidden"),this.$el.find("#follower_subtitle_bar").addClass("hidden"))}});return p}),define("hbs!modules/template/profile/following-collection",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h,i="",j=c.helperMissing,k=this.escapeExpression,l="function";return i+='<div id="following_subtitle_bar">\n	<div class="subtitle following col-md-8">\n		'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"user|fan_of",h):j.call(b,"translate","user|fan_of",h)))+" (",(g=c.num_following)?f=g.call(b,{hash:{},data:e}):(g=b&&b.num_following,f=typeof g===l?g.call(b,{hash:{},data:e}):g),i+=k(f)+')\n	</div>\n	<div class="subtitle following col-md-4 text-right search-form-btn">\n		<span class="toggle_searchbar_button icon-wb_search font-size-16"></span>\n	</div>\n</div>\n\n<div class="clear"></div>\n<a href="/search/users/" class="find-more-people">+ '+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"chat|find-more-people",h):j.call(b,"translate","chat|find-more-people",h)))+'</a>\n\n<!-- start of search bar: default: hidden -->\n<div id="following_search_bar" class="hidden">\n	<div class="col-md-11 no-padding">\n		<div class="subtitle following search-form-btn-left">\n			<span class="icon-wb_search font-size-16 left"></span>\n		</div>\n		<input type="text" name="filter_input" placeholder="Search" value="" id="filter_input" class="subtitle follower form-control">\n	</div>\n	<div class="subtitle following col-md-1 text-right">\n		<span class="icon-wb_closepopup toggle_searchbar_button mini" alt="'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"common|close",h):j.call(b,"translate","common|close",h)))+'"></span>\n	</div>\n</div>\n<!-- end of search bar: default: hidden -->\n\n<div class="users users-following"></div>'})}),define("modules/view/profile/following_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/view/profile/follower_following_friend_item_view","hbs!modules/template/profile/following-collection","modules/view/common/mig33_views","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j,k){var l=d.compile('{{translate "user|following_none" username}}'),m=d.compile('{{translate "common|loading"}}...'),n=e.ItemView.extend({template:{type:"handlebars",template:l},className:"empty"}),o=e.ItemView.extend({template:{type:"handlebars",template:m},className:"loading"}),p=k.CompositeView.extend({itemView:i,emptyView:n,loadingView:o,itemViewContainer:".users",itemViewClass:".user",itemViewOptions:function(a,b){return{type:"following",itemIndex:b}},template:{type:"handlebars",template:j},events:{"click .toggle_searchbar_button":"_toggleSearchBar","keyup #filter_input":a.throttle(function(a){this._doFilter()},200)},initialize:function(){a.bindAll(this);var c=this;this.on("render",function(){b(window).on("scroll",function(a){c.more(a)})}),this.on("close",function(){b(window).off("scroll")})},prevScrollY:0,page:1,more:function(){var a=b(window).scrollTop()+b(window).height(),c=b(window).get(0).scrollHeight;c||(c=b(document).height()),a>=c-g.variable.infinitescroll_height&&this.prevScrollY<a&&this.trigger("following:more",++this.page),this.prevScrollY=a},_doFilter:function(){var c=a.escape(b("#filter_input",this.$el).val());this._hideAll(),this.$el.find(this.itemViewClass+":containsIgnoreCase('"+c.toLowerCase()+"')").show()},_resetFilter:function(){b("#filter_input",this.$el).val(""),this._showAll()},_hideAll:function(){this.$el.find(this.itemViewClass).hide()},_showAll:function(){this.$el.find(this.itemViewClass).show()},_toggleSearchBar:function(){this.$el.find("#following_subtitle_bar").hasClass("hidden")?(this._resetFilter(),this.$el.find("#following_search_bar").addClass("hidden"),this.$el.find("#following_subtitle_bar").removeClass("hidden")):(this.$el.find("#following_search_bar").removeClass("hidden"),this.$el.find("#following_subtitle_bar").addClass("hidden"))}});return p}),define("hbs!modules/template/profile/friend-collection",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h,i="",j=c.helperMissing,k=this.escapeExpression,l="function";return i+='<div id="friend_subtitle_bar">\n	<div class="subtitle friend col-xs-8">\n		'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"user|friends",h):j.call(b,"translate","user|friends",h)))+" (",(g=c.num_friends)?f=g.call(b,{hash:{},data:e}):(g=b&&b.num_friends,f=typeof g===l?g.call(b,{hash:{},data:e}):g),i+=k(f)+')\n	</div>\n	<div class="subtitle friend col-xs-4 text-right search-form-btn">\n		<span class="toggle_searchbar_button icon-wb_search font-size-16"></span>\n	</div>\n</div>\n\n<div class="clear"></div>\n<a href="/search/users/" class="find-more-people">+ '+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"chat|find-more-people",h):j.call(b,"translate","chat|find-more-people",h)))+'</a>\n\n<!-- start of search bar: default: hidden -->\n<div id="friend_search_bar" class="hidden">\n	<div class="col-md-11 no-padding">\n		<div class="subtitle friend search-form-btn-left">\n			<span class="icon-wb_search font-size-16 left"></span>\n		</div>\n		<input type="text" name="filter_input" placeholder="Search" value="" id="filter_input" class="subtitle friend form-control">\n	</div>\n	<div class="subtitle friend col-md-1 text-right">\n		<span class="icon-wb_closepopup toggle_searchbar_button mini" alt="'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"common|close",h):j.call(b,"translate","common|close",h)))+'"></span>\n	</div>\n</div>\n<!-- end of search bar: default: hidden -->\n\n<div class="users users-friends"></div>'})}),define("modules/view/profile/friend_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/view/profile/follower_following_friend_item_view","hbs!modules/template/profile/friend-collection","modules/view/common/mig33_views","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j,k){var l=d.compile('{{translate "user|friends_none" username}}'),m=d.compile('{{translate "common|loading"}}...'),n=e.ItemView.extend({template:{type:"handlebars",template:l},className:"empty"}),o=e.ItemView.extend({template:{type:"handlebars",template:m},className:"loading"}),p=k.CompositeView.extend({itemView:i,emptyView:n,loadingView:o,itemViewContainer:".users",itemViewClass:".user",itemViewOptions:function(a,b){return{type:"friend",itemIndex:b}},template:{type:"handlebars",template:j},events:{"click .toggle_searchbar_button":"_toggleSearchBar","keyup #filter_input":a.throttle(function(a){this._doFilter()},200)},initialize:function(){a.bindAll(this);var c=this;this.on("render",function(){b(window).on("scroll",function(a){c.more(a)})}),this.on("close",function(){b(window).off("scroll")})},prevScrollY:0,page:1,more:function(){},_doFilter:function(){var c=a.escape(b("#filter_input",this.$el).val());this._hideAll(),this.$el.find(this.itemViewClass+":containsIgnoreCase('"+c.toLowerCase()+"')").show()},_resetFilter:function(){b("#filter_input",this.$el).val(""),this._showAll()},_hideAll:function(){this.$el.find(this.itemViewClass).hide()},_showAll:function(){this.$el.find(this.itemViewClass).show()},_toggleSearchBar:function(){this.$el.find("#friend_subtitle_bar").hasClass("hidden")?(this._resetFilter(),this.$el.find("#friend_search_bar").addClass("hidden"),this.$el.find("#friend_subtitle_bar").removeClass("hidden")):(this.$el.find("#friend_search_bar").removeClass("hidden"),this.$el.find("#friend_subtitle_bar").addClass("hidden"))}});return p}),define("hbs!modules/template/badge/badge-collection",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+='\n		<div class="text">'+m((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"user|own_badge_level",a&&a.mig_level,e):l.call(a,"translate","user|own_badge_level",a&&a.mig_level,e)))+"</div>\n	"}function g(a,b){var d,e,f="";return f+='\n		<div class="text">'+m((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"user|other_badge_level",a&&a.username,a&&a.mig_level,e):l.call(a,"translate","user|other_badge_level",a&&a.username,a&&a.mig_level,e)))+"</div>\n	"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var h,i,j,k="",l=c.helperMissing,m=this.escapeExpression,n="function",o=this;return k+='<div id="badge_subtitle_bar" class="row no-margin">\n	<div class="subtitle friend col-xs-12">\n		'+m((i=c.translate||b&&b.translate,j={hash:{},data:e},i?i.call(b,"user|badges_with_count",b&&b.numberOfBadgesUnlocked,j):l.call(b,"translate","user|badges_with_count",b&&b.numberOfBadgesUnlocked,j)))+'\n	</div>\n</div>\n\n<div class="badge-header row no-margin">\n	<div class="level">',(i=c.mig_level)?h=i.call(b,{hash:{},data:e}):(i=b&&b.mig_level,h=typeof i===n?i.call(b,{hash:{},data:e}):i),k+=m(h)+"</div>\n	",i=c.ifIsOwnProfile||b&&b.ifIsOwnProfile,j={hash:{},inverse:o.program(3,g,e),fn:o.program(1,f,e),data:e},h=i?i.call(b,b&&b.username,j):l.call(b,"ifIsOwnProfile",b&&b.username,j),(h||0===h)&&(k+=h),k+='\n</div>\n\n<div id="badge-list" class="clearfix block"></div>'})}),define("hbs!modules/template/profile/achievement_badge_list",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f,g="";return g+='\n        <a href="/u/',(e=c.username)?d=e.call(a,{hash:{},data:b}):(e=a&&a.username,d=typeof e===k?e.call(a,{hash:{},data:b}):e),g+=l(d)+'/badges/archived" class="action-icon js-legacy">\n            <img src="'+l((e=c.getUrl||a&&a.getUrl,f={hash:{},data:b},e?e.call(a,"jsclient",f):m.call(a,"getUrl","jsclient",f)))+'/app/images/identity/archive.svg" />\n        </a>\n        '}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var g,h,i,j="",k="function",l=this.escapeExpression,m=c.helperMissing,n=this;return j+='<div id="badge_subtitle_bar" class="row no-margin badge-header profile-section-header">\n    <div class="header-title col-xs-14 left">\n        '+l((h=c.translate||b&&b.translate,i={hash:{},data:e},h?h.call(b,b&&b.collectionTitle,b&&b.numberOfBadgesUnlocked,i):m.call(b,"translate",b&&b.collectionTitle,b&&b.numberOfBadgesUnlocked,i)))+'\n    </div>\n\n    <div class="menus right">\n        ',g=c.unless.call(b,b&&b.isArchives,{hash:{},inverse:n.noop,fn:n.program(1,f,e),data:e}),(g||0===g)&&(j+=g),j+='\n        <a href="'+l((h=c.getUrl||b&&b.getUrl,i={hash:{},data:e},h?h.call(b,"corporate",i):m.call(b,"getUrl","corporate",i)))+'/faq" target="_blank" class="action-icon">\n            <span class="icon-wb_help col-xs-16"></span>\n        </a>\n    </div>\n</div>\n\n<div id="badge-list" class="clearfix block achievement-badge-list"></div>\n'})}),define("modules/view/badge/badge_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/view/badge/badge_item_view","hbs!modules/template/badge/badge-collection","modules/view/common/mig33_views","hbs!modules/template/profile/achievement_badge_list","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=d.compile('{{translate "user|badges_none"}}'),n=d.compile('{{translate "common|loading"}}...'),o=e.ItemView.extend({template:{type:"handlebars",template:m},className:"empty"}),p=e.ItemView.extend({template:{type:"handlebars",template:n},className:"loading"}),q=k.CompositeView.extend({itemView:i,emptyView:o,loadingView:p,itemViewContainer:"#badge-list",numberOfBadgesUnlocked:0,setNumberOfBadgesUnlocked:function(){var a=0;this.collection.models.map(function(b){a+=b.attributes.badgeTier?b.attributes.badgeTier:1}),this.numberOfBadgesUnlocked=a},template:{type:"handlebars",template:l},templateHelpers:function(){return{collectionTitle:this.options.isArchives?"user|archive_badges_with_count":"user|badges_with_count",isArchives:this.options.isArchives,numberOfBadgesUnlocked:this.numberOfBadgesUnlocked}},initialize:function(){a.bindAll(this);var c=this;this.on("render",function(){b(window).on("scroll",function(a){c.more()})}),this.on("close",function(){b(window).off("scroll")})},prevScrollY:0,page:1,more:function(){var a=b(window).scrollTop()+b(window).height(),c=b(window).get(0).scrollHeight;c||(c=b(document).height()),a>=c-g.variable.infinitescroll_height&&this.prevScrollY<a&&this.trigger("badge:more",++this.page),this.prevScrollY=a}});return q}),define("modules/model/gift/gift_collection",["modules/model/common/mig33_collection","modules/mig33_app","modules/common/config","modules/common/utility","modules/model/gift/gift_model","underscore"],function(a,b,c,d,e,f){var g=a.extend({model:e,initialize:function(a,b){this.options=b},url:function(){return d.format(c.urls.user_gifts,this.options.username,this.currentPage,c.profile.gifts.limit)},parse:function(a){return a.data&&!f.isUndefined(a.data.gifts)&&null!==a.data.gifts?a.data.gifts:a}});return g}),define("hbs!modules/template/gift/gift-collection",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="row gift-received-date">\n	<div class="col-md-12">\n		<span class="wb"></span>\n		<span class="received-date"></span>\n		<span class="show-more">\n			<a>'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"user|show_more_gifts",g):i.call(b,"translate","user|show_more_gifts",g)))+'</a>\n			<span class="chevron"> > </span>\n		</span>		\n	</div>\n</div>\n<div class="gifts-recieved-container"></div>'})}),define("modules/view/gift/gift_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/view/gift/gift_item_view","hbs!modules/template/gift/gift-collection","modules/view/common/mig33_views","modules/globals/session_user","modules/globals/url","modules/template/helpers/general_helpers","modules/template/helpers/store_helpers"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=d.compile("<div> {{getUsernameFromUrl}} {{translate 'user|empty_favorite_gift'}} </div>"),o=e.ItemView.extend({template:{type:"handlebars",template:n},className:"empty"}),p=e.CompositeView.extend({emptyView:o,itemView:i,itemViewContainer:"div.gifts-recieved-container",template:{type:"handlebars",template:j},ui:{timeIcon:".gift-received-date span:nth-child(1)",receivedDate:".gift-received-date .received-date",showMoreLink:".gift-received-date span:nth-child(3)"},initialize:function(){this.show_more_link_href=m.personalized+"/"+h.get_username()+"/gifts/recent"},onRender:function(){if(this.ui.timeIcon.addClass("icon-wb_recent"),"undefined"!=typeof this.options.createdYearMonth){var a=this.options.createdYearMonth.split("-"),b=a[0],c=a[1],d=h.mapMonthName(c);this.ui.receivedDate.append(d+" "+b)}"undefined"!=typeof this.options.indicationText&&""!=this.options.indicationText&&this.ui.receivedDate.text(this.options.indicationText),this._showMoreLink(1==this.options.showMoreLink)},_showMoreLink:function(a){a?this.ui.showMoreLink.show():this.ui.showMoreLink.hide();this.ui.showMoreLink.children().first().attr({href:this.show_more_link_href})}});return p}),define("hbs!modules/template/gift/favorite-gift-list",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h,i="",j=c.helperMissing,k=this.escapeExpression,l="function";return i+='<div class="favorite-gift-container">\n	<img src="'+k((g=c.getGiftImageUrl||b&&b.getGiftImageUrl,h={hash:{},data:e},g?g.call(b,b&&b.location,64,"png",h):j.call(b,"getGiftImageUrl",b&&b.location,64,"png",h)))+'" />\n	<div class="favorite-gift-remark">\n		<div>from</div>\n		<div class="favorite-gift-send-from">',(g=c.sender)?f=g.call(b,{hash:{},data:e}):(g=b&&b.sender,f=typeof g===l?g.call(b,{hash:{},data:e}):g),i+=k(f)+"</div>\n	</div>\n</div>"})}),define("modules/view/gift/favorite_gift_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/gift/favorite-gift-list","modules/common/config","modules/model/gift/gift_model","modules/model/user/user_model","modules/model/post/post_model","modules/common/utility","modules/common/session_user","modules/globals/url","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=e.ItemView.extend({model:i,className:"col-md-3 col-sm-4 col-xs-6 ",template:{type:"handlebars",template:g}});return o}),define("modules/view/gift/favorite_gift_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/globals/url","modules/view/gift/favorite_gift_item_view","hbs!modules/template/gift/gift-collection","modules/view/common/mig33_views","modules/globals/session_user","modules/template/helpers/general_helpers","modules/template/helpers/store_helpers"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){
var n=d.compile("<div> {{getUsernameFromUrl}} {{translate 'user|empty_favorite_gift'}} </div>"),o=e.ItemView.extend({template:{type:"handlebars",template:n},className:"empty"}),p=e.CompositeView.extend({emptyView:o,itemView:j,itemViewContainer:"div.gifts-recieved-container",template:{type:"handlebars",template:k},ui:{favoriteIcon:".gift-received-date span:nth-child(1)",receivedDate:".gift-received-date .received-date",showMoreLink:".gift-received-date .show-more"},initialize:function(a){this.options=a,this.show_more_link_href=i.personalized+"/"+h.get_username()+"/gifts/favorite"},onRender:function(){if(b(".gifts-recieved-container",this.$el).addClass("row"),this.ui.favoriteIcon.addClass("icon-wb_like"),"undefined"!=typeof this.options.YearMonthReceived){var a=this.options.YearMonthReceived.split("-"),c=a[0],d=a[1],e=h.mapMonthName(d);this.ui.receivedDate.append(e+" "+c)}"undefined"!=typeof this.options.indicationText&&""!=this.options.indicationText&&this.ui.receivedDate.text(this.options.indicationText),this._showMoreLink(1==this.options.showMoreLink)},setRecievedDate:function(a){this.options.YearMonthReceived=a},_showMoreLink:function(a){a?this.ui.showMoreLink.show():this.ui.showMoreLink.hide();this.ui.showMoreLink.children().first().attr({href:this.show_more_link_href})}});return p}),define("hbs!modules/template/gift/favorite-gift-monthly-list-container",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f="";return f})}),define("modules/view/gift/favorite_gift_monthly_list_container_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/view/gift/gift_item_view","hbs!modules/template/gift/favorite-gift-monthly-list-container","modules/view/common/mig33_views","modules/globals/session_user","modules/template/helpers/general_helpers","modules/template/helpers/store_helpers"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=e.Layout.extend({prevScrollY:0,page:1,className:"gift-monthly-list-container",template:{type:"handlebars",template:j},initialize:function(c){a.bindAll(this),this.options=c;var d=this;this.on("render",function(){b(window).on("scroll",function(a){d.more()})}),this.on("close",function(){b(window).off("scroll")})},onRender:function(){this.trigger("favoriteGift:monthly",this.$el)},more:function(){var a=b(window).scrollTop()+b(window).height(),c=b(window).get(0).scrollHeight;c||(c=b(document).height()),a>=c-g.variable.infinitescroll_height&&this.prevScrollY<a&&this.trigger("gift:more",++this.page),this.prevScrollY=a}});return n}),define("hbs!modules/template/gift/gift-monthly-list-container",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f="";return f})}),define("modules/view/gift/gift_monthly_list_container_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/view/gift/gift_item_view","hbs!modules/template/gift/gift-monthly-list-container","modules/view/common/mig33_views","modules/globals/session_user","modules/template/helpers/general_helpers","modules/template/helpers/store_helpers"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=e.Layout.extend({prevScrollY:0,page:1,template:{type:"handlebars",template:j},className:"gift-monthly-list-container",initialize:function(c){a.bindAll(this),this.options=c;var d=this;this.on("render",function(){b(window).on("scroll",function(a){d.more()})}),this.on("close",function(){b(window).off("scroll")})},onRender:function(){this.trigger("gift:monthly",this.$el)},more:function(){var a=b(window).scrollTop()+b(window).height(),c=b(window).get(0).scrollHeight;c||(c=b(document).height()),a>=c-g.variable.infinitescroll_height&&this.prevScrollY<a&&this.trigger("gift:more",++this.page),this.prevScrollY=a}});return m}),define("hbs!modules/template/gift/gift-main-layout",["handlebars"],function(a){return a.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},'<div class="preview-favorite-gifts"></div>\n<div class="preview-recent-gifts"></div>'})}),define("modules/view/gift/gift_main_layout_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","hbs!modules/template/gift/gift-main-layout","modules/view/common/mig33_views","modules/globals/session_user"],function(a,b,c,d,e,f,g,h,i,j,k){var l=e.Layout.extend({template:{type:"handlebars",template:i},regions:{previewFavoriteGifts:".preview-favorite-gifts",previewRecentGifts:".preview-recent-gifts"},onRender:function(){this.trigger("gift:main",this)}});return l}),define("hbs!modules/template/group/group-profile-list",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f,g="";return g+='\n					<img src="'+p((e=c.getUrl||a&&a.getUrl,f={hash:{},data:b},e?e.call(a,"image",f):o.call(a,"getUrl","image",f)))+"/",(e=c.display_file_id)?d=e.call(a,{hash:{},data:b}):(e=a&&a.display_file_id,d=typeof e===q?e.call(a,{hash:{},data:b}):e),g+=p(d)+'?w=48&h=48&a=1&c=1" width="48" height="48" />\n				'}function g(a,b){var d,e,f="";return f+='\n					<img src="'+p((d=c.getUrl||a&&a.getUrl,e={hash:{},data:b},d?d.call(a,"jsclient",e):o.call(a,"getUrl","jsclient",e)))+'/app/images/group_defaultimg.png" width="48" height="48" />\n				'}function h(a,b){return'\n					&nbsp;<span class="group-official"><i class="ico ico-16 ico-group-official"></i></span>\n				'}function i(a,b){var d,e,f="";return f+="\n						"+p((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"group|likes",a&&a.likes,e):o.call(a,"translate","group|likes",a&&a.likes,e)))+"\n					"}function j(a,b){var d,e,f="";return f+="\n						"+p((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"group|likes_none",e):o.call(a,"translate","group|likes_none",e)))+"\n					"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var k,l,m,n="",o=c.helperMissing,p=this.escapeExpression,q="function",r=this;return n+='<div class="item-content">\n	<div class="row">\n		<div class="col-xs-2">\n			<div class="padding-8px no-padding-bottom">\n				',k=c["if"].call(b,b&&b.display_file_id,{hash:{},inverse:r.program(3,g,e),fn:r.program(1,f,e),data:e}),(k||0===k)&&(n+=k),n+='\n			</div>\n		</div>\n		<div class="col-xs-10">\n			<div class="padding-8px no-padding-bottom">\n				<a href="',(l=c.groupLink)?k=l.call(b,{hash:{},data:e}):(l=b&&b.groupLink,k=typeof l===q?l.call(b,{hash:{},data:e}):l),n+=p(k)+'">',(l=c.name)?k=l.call(b,{hash:{},data:e}):(l=b&&b.name,k=typeof l===q?l.call(b,{hash:{},data:e}):l),n+=p(k)+"</a>\n				",k=c["if"].call(b,b&&b.official,{hash:{},inverse:r.noop,fn:r.program(5,h,e),data:e}),(k||0===k)&&(n+=k),n+='\n				<div class="font-size-12 font-color-grey">\n					'+p((l=c.translate||b&&b.translate,m={hash:{},data:e},l?l.call(b,"group|members",b&&b.member_count,m):o.call(b,"translate","group|members",b&&b.member_count,m)))+"\n					&nbsp;|&nbsp;\n					",k=c["if"].call(b,b&&b.likes,{hash:{},inverse:r.program(9,j,e),fn:r.program(7,i,e),data:e}),(k||0===k)&&(n+=k),n+='\n				</div>\n			</div>\n		</div>\n	</div>\n	<div class="item-content-content">\n		<div class="row">\n			<div class="col-xs-12">\n				<div class="padding-8px" title="',(l=c.description)?k=l.call(b,{hash:{},data:e}):(l=b&&b.description,k=typeof l===q?l.call(b,{hash:{},data:e}):l),n+=p(k)+'">\n					'+p((l=c.characterLimiter||b&&b.characterLimiter,m={hash:{},data:e},l?l.call(b,b&&b.description,100,!0,m):o.call(b,"characterLimiter",b&&b.description,100,!0,m)))+'\n				</div>\n			</div>\n		</div>\n	</div>\n	<div class="item-content-footer">\n		<div class="row">\n			<div class="col-xs-12">\n				<div class="padding-8px text-center">\n					<a href="',(l=c.groupLink)?k=l.call(b,{hash:{},data:e}):(l=b&&b.groupLink,k=typeof l===q?l.call(b,{hash:{},data:e}):l),n+=p(k)+'" class="btn btn-xs btn-default">'+p((l=c.translate||b&&b.translate,m={hash:{},data:e},l?l.call(b,"group|view_group",m):o.call(b,"translate","group|view_group",m)))+"</a>\n				</div>\n			</div>\n		</div>\n	</div>\n</div>"})}),define("modules/view/group/group_profile_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/group/group-profile-list","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers","modules/template/helpers/group_helpers"],function(a,b,c,d,e,f,g){var h=e.ItemView.extend({template:{type:"handlebars",template:g},className:"col-xs-6 group item",initialize:function(){a.bindAll(this)},onRender:function(){}});return h}),define("hbs!modules/template/group/group-profile-collection",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="row">\n	<div class="col-xs-12">\n		<div class="page-subtitle clearfix">\n			'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"group|groups_joined",g):i.call(b,"translate","group|groups_joined",g)))+'\n			<a href="/v4/sites/ajax/group/create_group" title="'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"group|create_a_group",g):i.call(b,"translate","group|create_a_group",g)))+'" class="btn btn-xs btn-default pull-right">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"group|create_a_group",g):i.call(b,"translate","group|create_a_group",g)))+'</a>\n			&nbsp;&nbsp;\n			<form class="pull-right" action="/v4/sites/ajax/group/search">\n				<div class="input-group">\n					<input type="text" class="form-control search-query" name="name" placeholder="'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"header|search",g):i.call(b,"translate","header|search",g)))+'">\n					<span class="input-group-addon"><span class="icon-wb_search"></span></span>\n				</div>\n			</form>\n		</div>\n	</div>\n</div>\n<div id="group-list" class="row groups items"></div>\n'})}),define("modules/view/group/group_profile_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/view/group/group_profile_item_view","hbs!modules/template/group/group-profile-collection","modules/view/common/mig33_views","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j,k){var l=d.compile('{{translate "group|empty_groups"}}'),m=d.compile('{{translate "common|loading"}}...'),n=e.ItemView.extend({template:{type:"handlebars",template:l},className:"empty"}),o=e.ItemView.extend({template:{type:"handlebars",template:m},className:"loading"}),p=k.CompositeView.extend({itemView:i,emptyView:n,loadingView:o,itemViewContainer:"#group-list",template:{type:"handlebars",template:j},initialize:function(){a.bindAll(this);var c=this;this.on("render",function(){b(window).on("scroll",function(a){c.more()})}),this.on("close",function(){b(window).off("scroll")})},prevScrollY:0,page:1,more:function(){var a=b(window).scrollTop()+b(window).height(),c=b(window).get(0).scrollHeight;c||(c=b(document).height()),a>=c-g.variable.infinitescroll_height&&this.prevScrollY<a&&this.trigger("group:more",++this.page),this.prevScrollY=a}});return p}),define("hbs!modules/template/game/game-profile-list",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+='\n					<img src="'+q((d=c.getGameImage||a&&a.getGameImage,e={hash:{},data:b},d?d.call(a,"48","48",e):p.call(a,"getGameImage","48","48",e)))+'" width="48" height="48" />\n				'}function g(a,b){return'\n					<img src="/sites/resources/images/icons/48/48_games.png" width="48" height="48" />\n				'}function h(a,b){var d,e,f="";return f+='\n					<a href="/group/',(e=c.group_id)?d=e.call(a,{hash:{},data:b}):(e=a&&a.group_id,d=typeof e===r?e.call(a,{hash:{},data:b}):e),f+=q(d)+'">',(e=c.display_name)?d=e.call(a,{hash:{},data:b}):(e=a&&a.display_name,d=typeof e===r?e.call(a,{hash:{},data:b}):e),f+=q(d)+"</a>\n				"}function i(a,b){var d,e,f="";return f+='\n					<a href="/sites/ajax/bot/bot_help?id=',(e=c.id)?d=e.call(a,{hash:{},data:b}):(e=a&&a.id,d=typeof e===r?e.call(a,{hash:{},data:b}):e),f+=q(d)+'&p=1">',(e=c.display_name)?d=e.call(a,{hash:{},data:b}):(e=a&&a.display_name,d=typeof e===r?e.call(a,{hash:{},data:b}):e),f+=q(d)+"</a>\n				"}function j(a,b){var d,e,f,g="";return g+='\n						<a href="/group/',(e=c.group_id)?d=e.call(a,{hash:{},data:b}):(e=a&&a.group_id,d=typeof e===r?e.call(a,{hash:{},data:b}):e),g+=q(d)+'" class="btn btn-xs btn-default">'+q((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"game|play",f):p.call(a,"translate","game|play",f)))+"</a>\n					"}function k(a,b){var d,e,f,g="";return g+='\n						<a href="/sites/ajax/bot/bot_help?id=',(e=c.id)?d=e.call(a,{hash:{},data:b}):(e=a&&a.id,d=typeof e===r?e.call(a,{hash:{},data:b}):e),g+=q(d)+'&p=1" class="btn btn-xs btn-default">'+q((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"game|play",f):p.call(a,"translate","game|play",f)))+"</a>\n					"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var l,m,n,o="",p=c.helperMissing,q=this.escapeExpression,r="function",s=this;return o+='<div class="item-content">\n	<div class="row">\n		<div class="col-xs-2">\n			<div class="padding-8px">\n				',m=c.compare||b&&b.compare,n={hash:{},inverse:s.program(3,g,e),fn:s.program(1,f,e),data:e},l=m?m.call(b,b&&b.type,"GAME",n):p.call(b,"compare",b&&b.type,"GAME",n),(l||0===l)&&(o+=l),o+='\n			</div>\n		</div>\n		<div class="col-xs-10">\n			<div class="padding-8px">\n				',m=c.compare||b&&b.compare,n={hash:{},inverse:s.program(7,i,e),fn:s.program(5,h,e),data:e},l=m?m.call(b,b&&b.type,"GAME",n):p.call(b,"compare",b&&b.type,"GAME",n),(l||0===l)&&(o+=l),o+='\n			</div>\n		</div>\n	</div>\n	<div class="item-content-content">\n		<div class="row">\n			<div class="col-xs-12">\n				<div class="padding-8px" title="',(m=c.description)?l=m.call(b,{hash:{},data:e}):(m=b&&b.description,l=typeof m===r?m.call(b,{hash:{},data:e}):m),o+=q(l)+'">\n					'+q((m=c.characterLimiter||b&&b.characterLimiter,n={hash:{},data:e},m?m.call(b,b&&b.description,100,!0,n):p.call(b,"characterLimiter",b&&b.description,100,!0,n)))+'\n				</div>\n			</div>\n		</div>\n	</div>\n	<div class="item-content-footer">\n		<div class="row">\n			<div class="col-xs-12">\n				<div class="padding-8px text-center">\n					',m=c.compare||b&&b.compare,n={hash:{},inverse:s.program(11,k,e),fn:s.program(9,j,e),data:e},l=m?m.call(b,b&&b.type,"GAME",n):p.call(b,"compare",b&&b.type,"GAME",n),(l||0===l)&&(o+=l),o+="\n				</div>\n			</div>\n		</div>\n	</div>\n</div>"})}),define("modules/view/game/game_profile_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/game/game-profile-list","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g){var h=e.ItemView.extend({template:{type:"handlebars",template:g},className:"col-xs-6 game item"});return h}),define("hbs!modules/template/game/game-profile-collection",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="row">\n	<div class="col-xs-12">\n		<div class="page-subtitle clearfix">\n			'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"game|games_played_recently",g):i.call(b,"translate","game|games_played_recently",g)))+'\n		</div>\n	</div>\n</div>\n\n<div id="game-list" class="row games items"></div>'})}),define("modules/view/game/game_profile_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/view/game/game_profile_item_view","hbs!modules/template/game/game-profile-collection","modules/view/common/mig33_views","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j,k){var l=d.compile('{{translate "game|empty_games"}}'),m=d.compile('{{translate "common|loading"}}...'),n=e.ItemView.extend({template:{type:"handlebars",template:l},className:"empty"}),o=e.ItemView.extend({template:{type:"handlebars",template:m},className:"loading"}),p=k.CompositeView.extend({itemView:i,emptyView:n,loadingView:o,itemViewContainer:"#game-list",template:{type:"handlebars",template:j},initialize:function(){a.bindAll(this);var c=this;this.on("render",function(){b(window).on("scroll",function(a){c.more()})}),this.on("close",function(){b(window).off("scroll")})},prevScrollY:0,page:1,more:function(){var a=b(window).scrollTop()+b(window).height(),c=b(window).get(0).scrollHeight;c||(c=b(document).height()),a>=c-g.variable.infinitescroll_height&&this.prevScrollY<a&&this.trigger("game:more",++this.page),this.prevScrollY=a}});return p}),define("hbs!modules/template/chatroom/chatroom-profile-layout",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="row">\n	<div class="col-xs-12">\n		<div class="page-subtitle clearfix">\n			'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"user|own_chatrooms_with_count",g):i.call(b,"translate","user|own_chatrooms_with_count",g)))+'\n			<a href="#" title="'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"chat|create_chatroom",g):i.call(b,"translate","chat|create_chatroom",g)))+'" class="btn btn-xs btn-default add-chatroom pull-right">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"chat|create_chatroom",g):i.call(b,"translate","chat|create_chatroom",g)))+'</a>\n			<a href="#" title="'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"chat|search_chatrooms",g):i.call(b,"translate","chat|search_chatrooms",g)))+'" class="btn btn-xs btn-default search-chatrooms pull-right">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"chat|search_chatrooms",g):i.call(b,"translate","chat|search_chatrooms",g)))+'</a>\n		</div>\n	</div>\n</div>\n<div id="chatroom-own-list" class="row chatrooms items"></div>\n<div class="row">\n	<div class="col-xs-12">\n		<div class="page-subtitle">\n			'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"user|mod_chatrooms_with_count",g):i.call(b,"translate","user|mod_chatrooms_with_count",g)))+'\n		</div>\n	</div>\n</div>\n<div id="chatroom-mod-list" class="row chatrooms items"></div>'})}),define("modules/view/chatroom/chatroom_profile_layout",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/chat/views/content_window_helper","hbs!modules/template/chatroom/chatroom-profile-layout","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j){var k=c.Marionette.Layout.extend({template:{type:"handlebars",template:j},regions:{own:"#chatroom-own-list",mod:"#chatroom-mod-list"},events:{"click .search-chatrooms":"searchChatrooms","click .add-chatroom":"addChatroom"},initialize:function(){a.bindAll(this)},setChatroomTypeTotalCount:function(a,c){b("#user-"+a+"-chatroom-count").text(c)},setChatroomTotalCount:function(a){b("#user-chatroom-count").text(a)},searchChatrooms:function(a){a.preventDefault(),i.show_window("search_chat_room")},addChatroom:function(a){a.preventDefault(),i.show_window("create_new_chatroom")}});return k}),define("hbs!modules/template/chatroom/chatroom-profile-list",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+='\n					<img src="'+p((d=c.getGameImage||a&&a.getGameImage,e={hash:{},data:b},d?d.call(a,"48","48",e):o.call(a,"getGameImage","48","48",e)))+'" width="48" height="48" />\n				'}function g(a,b){return'\n					<img src="/sites/resources/images/icons/48/48_games.png" width="48" height="48" />\n				'}function h(a,b){var d,e,f,g="";return g+="\n						"+p((e=c.characterLimiter||a&&a.characterLimiter,f={hash:{},data:b},e?e.call(a,a&&a.description,50,!0,f):o.call(a,"characterLimiter",a&&a.description,50,!0,f)))+"\n						",d=c["if"].call(a,a&&a.group_name,{hash:{},inverse:r.noop,fn:r.program(6,i,b),data:b}),(d||0===d)&&(g+=d),g+="\n					"}function i(a,b){var d,e,f,g="";return g+="\n							<p>"+p((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"chatroom|is_in_group",f):o.call(a,"translate","chatroom|is_in_group",f)))+' <a href="/group/',(e=c.group_id)?d=e.call(a,{hash:{},data:b}):(e=a&&a.group_id,d=typeof e===q?e.call(a,{hash:{},data:b}):e),g+=p(d)+'">',(e=c.group_name)?d=e.call(a,{hash:{},data:b}):(e=a&&a.group_name,d=typeof e===q?e.call(a,{hash:{},data:b}):e),g+=p(d)+"</a></p>\n						"}function j(a,b){var d,e,f="";return f+="\n						"+p((d=c.characterLimiter||a&&a.characterLimiter,e={hash:{},data:b},d?d.call(a,a&&a.description,100,!0,e):o.call(a,"characterLimiter",a&&a.description,100,!0,e)))+"\n					"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var k,l,m,n="",o=c.helperMissing,p=this.escapeExpression,q="function",r=this;return n+='<div class="item-content">\n	<div class="row">\n		<div class="col-xs-2">\n			<div class="padding-8px">\n				',l=c.compare||b&&b.compare,m={hash:{},inverse:r.program(3,g,e),fn:r.program(1,f,e),data:e},k=l?l.call(b,b&&b.type,"GAME",m):o.call(b,"compare",b&&b.type,"GAME",m),(k||0===k)&&(n+=k),n+='\n			</div>\n		</div>\n		<div class="col-xs-10">\n			<div class="padding-8px">\n				<a href="#" class="join-chatroom">',(l=c.name)?k=l.call(b,{hash:{},data:e}):(l=b&&b.name,k=typeof l===q?l.call(b,{hash:{},data:e}):l),n+=p(k)+"&nbsp;&nbsp;(",(l=c.total_users)?k=l.call(b,{hash:{},data:e}):(l=b&&b.total_users,k=typeof l===q?l.call(b,{hash:{},data:e}):l),n+=p(k)+"/",(l=c.max_users)?k=l.call(b,{hash:{},data:e}):(l=b&&b.max_users,k=typeof l===q?l.call(b,{hash:{},data:e}):l),n+=p(k)+')</a>\n			</div>\n		</div>\n	</div>\n	<div class="item-content-content">\n		<div class="row">\n			<div class="col-xs-12">\n				<div class="padding-8px" title="',(l=c.description)?k=l.call(b,{hash:{},data:e}):(l=b&&b.description,k=typeof l===q?l.call(b,{hash:{},data:e}):l),n+=p(k)+'">\n					',k=c["if"].call(b,b&&b.group_id,{hash:{},inverse:r.program(8,j,e),fn:r.program(5,h,e),data:e}),(k||0===k)&&(n+=k),n+='\n				</div>\n			</div>\n		</div>\n	</div>\n	<div class="item-content-footer">\n		<div class="row">\n			<div class="col-xs-12">\n				<div class="padding-8px text-center">\n					<a href="#" class="btn btn-xs btn-default join-chatroom">'+p((l=c.translate||b&&b.translate,m={hash:{},data:e},l?l.call(b,"chat|join_chat_room",m):o.call(b,"translate","chat|join_chat_room",m)))+"</a>\n				</div>\n			</div>\n		</div>\n	</div>\n</div>"})}),define("modules/view/chatroom/chatroom_profile_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/chatroom/chatroom-profile-list","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g){var h=e.ItemView.extend({template:{type:"handlebars",template:g},className:"col-xs-12 chatroom item",events:{"click .join-chatroom":"joinChatroom"},joinChatroom:function(a){a.preventDefault(),mig33.chatroom_manager.join_chatroom(this.model.get("name"))}});return h}),define("modules/view/chatroom/chatroom_profile_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/view/chatroom/chatroom_profile_item_view","modules/view/common/mig33_views","modules/globals/session_user","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j,k){var l=d.compile('{{#compare username "'+(null!==k?k.username:"")+'" }}{{#compare type "own"}}{{translate "chatroom|empty_own_chatroom_you"}}{{else}}{{translate "chatroom|empty_mod_chatroom_you"}}{{/compare}}{{else}}{{#compare type "own"}}{{translate "chatroom|empty_own_chatroom" username}}{{else}}{{translate "chatroom|empty_mod_chatroom" username}}{{/compare}}{{/compare}}'),m=d.compile('{{translate "common|loading"}}...'),n=e.ItemView.extend({template:{type:"handlebars",template:l},className:"empty"}),o=e.ItemView.extend({template:{type:"handlebars",template:m},className:"loading"}),p=j.CollectionView.extend({itemView:i,emptyView:n,loadingView:o,initialize:function(){a.bindAll(this)}});return p}),define("hbs!modules/template/setting/setting-coverphoto-list",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+='\n			<button class="btn btn-xs btn-success">'+l((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"common|selected",e):k.call(a,"translate","common|selected",e)))+"</button>\n		"}function g(a,b){var d,e,f="";return f+='\n			<button class="btn btn-xs btn-default">'+l((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"common|select",e):k.call(a,"translate","common|select",e)))+"</button>\n		"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var h,i,j="",k=c.helperMissing,l=this.escapeExpression,m="function",n=this;return j+='<a href="#" class="thumbnail update-coverphoto" data-url="',(i=c.url)?h=i.call(b,{hash:{},data:e}):(i=b&&b.url,h=typeof i===m?i.call(b,{hash:{},data:e}):i),j+=l(h)+'">\n	<div class="img" style="background-image: url(\'',(i=c.url)?h=i.call(b,{hash:{},data:e}):(i=b&&b.url,h=typeof i===m?i.call(b,{hash:{},data:e}):i),j+=l(h)+"');\">\n		",h=c["if"].call(b,b&&b.selected,{hash:{},inverse:n.program(3,g,e),fn:n.program(1,f,e),data:e}),(h||0===h)&&(j+=h),j+="\n	</div>\n</a>"})}),define("modules/view/setting/setting_coverphoto_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/setting/setting-coverphoto-list","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i){var j=e.ItemView.extend({template:{type:"handlebars",template:g},className:"col-xs-12 col-md-6",events:{"click .update-coverphoto":"updateCoverPhoto"},initialize:function(){a.bindAll(this)},onRender:function(){},updateCoverPhoto:function(a){a.preventDefault();var b=this.model.setCoverPhoto();b.done(function(a){if(a=i.parse_ajax_response(a),a.error)i.show_error(i.translate("user|coverphoto_error_set"));else{var b=require("modules/mig33_app");b.vent.trigger(b.ApplicationEvents.COVERPHOTO_UPDATED,a)}}),b.error(function(){i.show_error(i.translate("user|coverphoto_error_set"))})}});return j}),define("hbs!modules/template/setting/setting-coverphoto-collection",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="page-subtitle clearfix">\n	'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"user|coverphoto_my",g):i.call(b,"translate","user|coverphoto_my",g)))+'\n    <span class="btn btn-xs btn-default btn-file pull-right">\n        '+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"user|coverphoto_upload",g):i.call(b,"translate","user|coverphoto_upload",g)))+'<input type="file" name="coverphoto" accept="image/png, image/jpeg"/>\n    </span>\n	<!--<a href="#coverphoto-upload-modal" data-toggle="modal" title="" class="btn btn-xs btn-default ">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"user|coverphoto_upload",g):i.call(b,"translate","user|coverphoto_upload",g)))+'</a>-->\n</div>\n<div id="coverphoto-list" class="block">\n	<div class="row"></div>\n</div>'})}),function(a){"function"==typeof define&&define.amd?define("cropper",["jquery"],a):a(jQuery)}(function(a){var b=a(window),c=function(b,d){d=a.isPlainObject(d)?d:{},this.$image=a(b),this.defaults=a.extend({},c.defaults,this.$image.data(),d),this.init()};c.prototype={construstor:c,init:function(){this.setAspectRatio(this.defaults.aspectRatio),this.render()},render:function(b){var d,e,f=this,g=this.$image;this.active||(this.$clone&&this.$clone.remove(),e=g.attr("src"),d=a('<img src="'+e+'">'),d.on("load",function(){var a;d.off("load"),this.naturalWidth&&this.naturalHeight?a={naturalHeight:this.naturalHeight,naturalWidth:this.naturalWidth}:(c.fn.size(d,{height:"auto",width:"auto"}),a=c.fn.size(d),a={naturalHeight:a.height,naturalWidth:a.width}),c.fn.size(d,{height:"100%",width:"100%"}),a.aspectRatio=a.naturalWidth/a.naturalHeight,f.src=e,f.image=a,f.active=!0,f.createCropper()}),a.isFunction(b)&&g.on("ready.cropper",b),this.$clone=d,g.after(d))},unrender:function(){return this.active&&(this.active=!1,this.removeCropper(),this.src="",this.image=null,this.cropper=null,this.dragger=null),this},rerender:function(a){var b=this;this.unrender().render(function(){a||b.setData(b.data)})},resize:function(){this.data=this.getData(),clearTimeout(this.resizing),this.resizing=setTimeout(a.proxy(this.rerender,this),200)},createCropper:function(){this.$cropper=a(c.template),this.$dragger=this.$cropper.find(".cropper-dragger"),c.fn.toggle(this.$image),this.$image.after(this.$cropper),this.$cropper.prepend(this.$clone),this.defaults.modal||c.fn.toggle(this.$cropper.find(".cropper-modal")),this.setPreview(),this.addListener()},removeCropper:function(){this.removeListener(),this.$preview=null,this.$clone.remove(),this.$clone=null,this.$dragger=null,this.$cropper.remove(),this.$cropper=null,c.fn.toggle(this.$image)},addListener:function(){this.$cropper.bind("mousedown touchstart",a.proxy(this.dragstart,this)),this.$cropper.bind("mousemove touchmove",a.proxy(this.dragmove,this)),this.$cropper.bind("mouseup mouseleave touchend touchleave",a.proxy(this.dragend,this)),b.on("resize",a.proxy(this.resize,this))},removeListener:function(){this.$cropper.unbind("mousedown touchstart",this.dragstart),this.$cropper.unbind("mousemove touchmove",this.dragmove),this.$cropper.unbind("mouseup mouseleave touchend touchleave",this.dragend),b.off("resize",this.resize)},setPreview:function(){var a=this.defaults.preview;this.$preview=this.$cropper.find(".cropper-preview"),"string"==typeof a&&a.length>0&&(this.$preview=this.$preview.add(a)),this.$preview.html('<img src="'+this.src+'">'),this.setCropper()},setCropper:function(){var b,d=this.$image.parent(),e=c.fn.size(d),f=this.image;f.naturalWidth*e.height/f.naturalHeight-e.width>=0?(b={height:e.width/f.aspectRatio,width:e.width,left:0},b.top=(e.height-b.height)/2):(b={height:e.height,width:e.height*f.aspectRatio,top:0},b.left=(e.width-b.width)/2),a.each(b,function(a,c){b[a]=Math.round(c)}),f.height=b.height,f.width=b.width,f.ratio=f.width/f.naturalWidth,c.fn.position(d),this.$cropper.css({height:b.height,left:b.left,top:b.top,width:b.width}),this.cropper=b,this.setDragger()},setDragger:function(){var a,b=this.cropper,d=this.defaults.aspectRatio||this.image.aspectRatio;a=b.height*d-b.width>=0?{height:b.width/d,width:b.width,left:0,top:(b.height-b.width/d)/2,maxWidth:b.width,maxHeight:b.width/d}:{height:b.height,width:b.height*d,left:(b.width-b.height*d)/2,top:0,maxHeight:b.height,maxWidth:b.height*d},a.height*=.8,a.width*=.8,a.left=(b.width-a.width)/2,a.top=(b.height-a.height)/2,this.dragger=c.fn.round(a),this.setData(this.defaults.data),this.$image.trigger("ready.cropper").off("ready.cropper")},resetDragger:function(){var a=this.dragger,b=this.cropper;a.width=a.width>a.maxWidth?a.maxWidth:Math.abs(a.width),a.height=a.height>a.maxHeight?a.maxHeight:Math.abs(a.height),a.maxLeft=b.width-a.width,a.maxTop=b.height-a.height,a.left=a.left<0?0:a.left>a.maxLeft?a.maxLeft:a.left,a.top=a.top<0?0:a.top>a.maxTop?a.maxTop:a.top,a=c.fn.round(a),this.$dragger.css({height:a.height,left:a.left,top:a.top,width:a.width
}),this.dragger=a,this.preview(),this.output()},dragging:function(){var a=this.direction,b=this.dragger,c=this.defaults.aspectRatio,d={x:this.endX-this.startX,y:this.endY-this.startY};switch(c&&(d.X=d.y*c,d.Y=d.x/c),a){case"e":b.width+=d.x,c&&(b.height=b.width/c,b.top-=d.Y/2),b.width<0&&(this.direction="w",b.width=0);break;case"n":b.height-=d.y,b.top+=d.y,c&&(b.width=b.height*c,b.left+=d.X/2),b.height<0&&(this.direction="s",b.height=0);break;case"w":b.width-=d.x,b.left+=d.x,c&&(b.height=b.width/c,b.top+=d.Y/2),b.width<0&&(this.direction="e",b.width=0);break;case"s":b.height+=d.y,c&&(b.width=b.height*c,b.left-=d.X/2),b.height<0&&(this.direction="n",b.height=0);break;case"ne":b.height-=d.y,b.top+=d.y,c?b.width=b.height*c:b.width+=d.x,b.height<0&&(this.direction="sw",b.height=0,b.width=0);break;case"nw":b.height-=d.y,b.top+=d.y,c?(b.width=b.height*c,b.left+=d.X):(b.width-=d.x,b.left+=d.x),b.height<0&&(this.direction="se",b.height=0,b.width=0);break;case"sw":b.width-=d.x,b.left+=d.x,c?b.height=b.width/c:b.height+=d.y,b.width<0&&(this.direction="ne",b.height=0,b.width=0);break;case"se":b.width+=d.x,c?b.height=b.width/c:b.height+=d.y,b.width<0&&(this.direction="nw",b.height=0,b.width=0);break;default:b.left+=d.x,b.top+=d.y}this.resetDragger(),this.startX=this.endX,this.startY=this.endY},output:function(){this.defaults.done(this.getData())},preview:function(){var b=this,d=b.cropper,e=b.dragger;this.$preview.each(function(){var b=a(this),f=b.width()/e.width,g={height:d.height,marginLeft:-e.left,marginTop:-e.top,width:d.width};b.css({overflow:"hidden"}),b.find("img").css(c.fn.round(g,function(a){return a*f}))})},enable:function(a){this.render(a)},disable:function(){this.unrender()},setAspectRatio:function(b){("auto"===b||a.isNumeric(b)&&b>0)&&(this.defaults.aspectRatio="auto"===b?NaN:b,this.active&&this.setDragger())},setData:function(b){var d=this.cropper,e=this.dragger,f=this.defaults.aspectRatio,g=function(a){return"number"==typeof a};this.active&&(a.isPlainObject(b)&&!a.isEmptyObject(b)&&(b=c.fn.transformData(b,this.image.ratio),g(b.x1)&&b.x1<=d.width&&(e.left=b.x1),g(b.y1)&&b.y1<=d.height&&(e.top=b.y1),f?g(b.width)&&b.width<=d.width?(e.width=b.width,e.height=e.width/f):g(b.height)&&b.height<=d.height?(e.height=b.height,e.width=e.height*f):g(b.x2)&&b.x2<=d.width?(e.width=b.x2-e.left,e.height=e.width/f):g(b.y2)&&b.y2<=d.height&&(e.height=b.y2-e.top,e.width=e.height*f):(g(b.width)&&b.width<=d.width?e.width=b.width:g(b.x2)&&b.x2<=d.width&&(e.width=b.x2-e.left),g(b.height)&&b.height<=d.height?e.height=b.height:g(b.y2)&&b.height<=d.height&&(e.height=b.y2-e.top))),this.dragger=e,this.resetDragger())},getData:function(){var a=this.dragger,b={};return this.active&&(b={x1:a.left,y1:a.top,width:a.width,height:a.height,x2:a.left+a.width,y2:a.top+a.height},b=c.fn.transformData(b,1/this.image.ratio)),b},setImgSrc:function(a){"string"==typeof a&&a.length>0&&a!==this.src&&(this.$image.attr("src",a),this.rerender(!0))},getImgInfo:function(){return this.image||{}},dragstart:function(b){var d,e,f=c.fn.getOriginalEvent(b).touches,g=b;f&&1===f.length&&(g=f[0],this.touchId=g.identifier,d=!0),e=a(g.target).data().direction,c.fn.isDirection(e)&&(this.startX=g.pageX,this.startY=g.pageY,this.direction=e,this.$image.trigger("dragstart"),d&&b.preventDefault())},dragmove:function(a){var b,d=c.fn.getOriginalEvent(a).changedTouches,e=a;d&&1===d.length&&(e=d[0],b=!0,e.identifier!==this.touchId)||this.direction&&(this.$image.trigger("dragmove"),b&&a.preventDefault(),this.endX=e.pageX,this.endY=e.pageY,this.dragging())},dragend:function(a){var b,d=c.fn.getOriginalEvent(a).changedTouches,e=a;d&&1===d.length&&(e=d[0],b=!0,e.identifier!==this.touchId)||this.direction&&(this.direction="",this.$image.trigger("dragend"),b&&a.preventDefault())}},c.fn={toggle:function(a){a.toggleClass("cropper-hidden")},position:function(a,b){var c=a.css("position");"static"===c&&a.css("position",b||"relative")},size:function(b,c){return a.isPlainObject(c)?void b.css(c):{height:b.height(),width:b.width()}},round:function(b,c){var d,e;for(e in b)d=b[e],b.hasOwnProperty(e)&&"number"==typeof d&&(b[e]=Math.round(a.isFunction(c)?c(d):d));return b},transformData:function(b,c){var d=this,e={};return a.each(b,function(b,f){d.isDataOption(b)&&a.isNumeric(f)&&f>=0&&(e[b]=Math.round(f*c))}),e},getOriginalEvent:function(a){return a&&"undefined"!=typeof a.originalEvent&&(a=a.originalEvent),a},isDataOption:function(a){return/^(x1|y1|x2|y2|width|height)$/i.test(a)},isDirection:function(a){return/^(\*|e|n|w|s|ne|nw|sw|se)$/i.test(a)}},c.template=['<div class="cropper-container">','<div class="cropper-modal"></div>','<div class="cropper-dragger">','<span class="cropper-preview"></span>','<span class="cropper-dashed dashed-h"></span>','<span class="cropper-dashed dashed-v"></span>','<span class="cropper-face" data-direction="*"></span>','<span class="cropper-line line-e" data-direction="e"></span>','<span class="cropper-line line-n" data-direction="n"></span>','<span class="cropper-line line-w" data-direction="w"></span>','<span class="cropper-line line-s" data-direction="s"></span>','<span class="cropper-point point-e" data-direction="e"></span>','<span class="cropper-point point-n" data-direction="n"></span>','<span class="cropper-point point-w" data-direction="w"></span>','<span class="cropper-point point-s" data-direction="s"></span>','<span class="cropper-point point-ne" data-direction="ne"></span>','<span class="cropper-point point-nw" data-direction="nw"></span>','<span class="cropper-point point-sw" data-direction="sw"></span>','<span class="cropper-point point-se" data-direction="se"></span>',"</div>","</div>"].join(""),c.defaults={aspectRatio:"auto",data:{},done:function(){},modal:!0,preview:""},c.setDefaults=function(b){a.extend(c.defaults,b)},a.fn.cropper=function(b,d){var e=this;return this.each(function(){var f=a(this),g=f.data("cropper");g||(g=new c(this,b),f.data("cropper",g)),"string"==typeof b&&a.isFunction(g[b])&&(e=g[b](d))}),"undefined"!=typeof e?e:this},a.fn.cropper.Constructor=c,a.fn.cropper.setDefaults=c.setDefaults,a(function(){a("img[cropper]").cropper()})}),define("hbs!modules/template/setting/setting-coverphoto-upload-modal",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="modal-dialog modal-edit-coverphoto">\n	<div class="modal-content">\n		<form action="/profile/coverphoto_upload" method="post" accept-charset="utf-8" enctype="multipart/form-data">\n			<input type="hidden" name="callback" value="" />\n			<div class="modal-header">\n				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>\n				<h4 class="modal-title">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"user|coverphoto_upload",g):i.call(b,"translate","user|coverphoto_upload",g)))+'</h4>\n			</div>\n			<div class="modal-body text-center">\n				<div class="progress progress-striped active" style="visibility: hidden; margin: 0">\n					<div class="progress-bar"></div>\n				</div>\n                <img class="preview-img" style="display:none!important;">\n			</div>\n			<div class="modal-footer">\n                <span class="btn btn-default btn-file">\n					'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"common|change",g):i.call(b,"translate","common|change",g)))+'<input type="file" name="coverphoto" accept="image/png, image/jpeg"/>\n				</span>\n				<input type="button" class="btn btn-default upload-coverphoto" value="'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"user|set_cover_photo",g):i.call(b,"translate","user|set_cover_photo",g)))+'" />\n			</div>\n		</form>\n	</div>\n</div>'})});var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};define("modules/view/setting/setting_coverphoto_upload_modal_view",["require","exports","modules/export_marionette","backbone.marionette","underscore","jquery","marionette_handlebars","backbone","modules/common/utility","modules/common/config","modules/template/helpers/general_helpers","cropper","hbs!modules/template/setting/setting-coverphoto-upload-modal","modules/globals/url","cropper"],function(a,b){var c=a("underscore"),d=a("jquery"),e=a("hbs!modules/template/setting/setting-coverphoto-upload-modal"),f=a("modules/common/config"),g=a("modules/common/utility"),h=300,i=960,j=function(b){function j(a){this.template={type:"handlebars",template:e},this.id="coverphoto-upload-modal",this.className="modal fade",this.events={"click .upload-coverphoto":"uploadCoverPhoto"},b.call(this,a)}return __extends(j,b),j.prototype.setFile=function(a){var b=this,c=new FileReader;c.onload=function(){var a=new Image;a.onload=function(){b.readyImageForEditing(a)},a.src=c.result},c.readAsDataURL(a)},j.prototype.readyImageForEditing=function(a){var b,c,d=this;this.imageElement=a,b=i/a.width;var e=b*a.height;a.setAttribute("class","img-edit"),this.$el.find(".img-edit").remove(),this.$el.find(".cropper-container").remove(),this.$el.find(".modal-body").prepend(a),this.$el.find(".img-edit").css({width:i,height:e}),Math.abs(a.width/a.height-i/h)<.1&&(c={x1:0,y1:0,height:a.height,width:a.width,x2:a.width,y2:a.height}),this.$el.find(".img-edit").cropper({aspectRatio:i/h,done:function(a){d.cropData=a},data:c})},j.prototype.extractCroppedImage=function(a){var b=this.ctx,c=this.canv;b.clearRect(0,0,i,h),b.drawImage(this.imageElement,a.x1,a.y1,a.width,a.height,0,0,i,h);var d=c.toDataURL("image/png");return g.dataURItoBlob(d)},j.prototype.initialize=function(){c.bindAll(this)},j.prototype.listenForFileSelection=function(){var a=this,b=d("input[type='file']",this.$el);b.on("change",function(c){var d=c.target;d.files[0]&&(a.setFile(d.files[0]),b.replaceWith(b.clone(!0)))})},j.prototype.onRender=function(){var a=document.createElement("canvas"),b=a.getContext("2d");this.$el.find(".modal-body").append(a),d("canvas",this.$el).hide(),a.width=i,a.height=h,this.canv=a,this.ctx=b,this.listenForFileSelection()},j.prototype.uploadCoverPhoto=function(){var b=this,c=d("form",this.$el),e=new FormData;d(".upload-coverphoto",c).prop("disabled",!0),e.append("coverphoto",this.extractCroppedImage(this.cropData),"image.png"),this.showProgressBar();var h=d.ajax({type:"post",cache:!1,contentType:!1,processData:!1,dataType:"json",url:f.urls.coverphoto_upload,data:e,xhr:function(){var a=d.ajaxSettings.xhr();return a.upload&&a.upload.addEventListener("progress",function(a){if(a.lengthComputable){var c=Math.floor(100*a.loaded/a.total)-Math.floor(10*Math.random());b.setProgressBarPercentage(c)}},!1),a}});h.done(function(c){if(b.setProgressBarPercentage(100),c=g.parse_ajax_response(c),c.error)return void g.show_error(c.error);if(c.cover_photo_url){d("#"+b.id).modal("hide");var e=a("modules/mig33_app");e.vent.trigger(e.ApplicationEvents.COVERPHOTO_UPDATED,c.cover_photo_url)}else g.show_error(g.translate("user|coverphoto_error_set"))}),h.fail(function(a,b,c){g.show_error(c)}),h.always(function(){d(".upload-coverphoto",c).prop("disabled",!1),b.hideProgressBar()})},j.prototype.showProgressBar=function(){d(".progress-bar",this.$el).css("visibility","visible")},j.prototype.hideProgressBar=function(){d(".progress-bar",this.$el).css("visibility","hidden")},j.prototype.setProgressBarPercentage=function(a){var b=a+"%";d(".progress-bar",this.$el).width(b).text(b)},j}(Marionette.ItemView);b.SettingCoverPhotoUploadModalView=j}),define("modules/view/setting/setting_coverphoto_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/view/setting/setting_coverphoto_item_view","hbs!modules/template/setting/setting-coverphoto-collection","modules/view/common/mig33_views","modules/view/setting/setting_coverphoto_upload_modal_view","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m,n=d.compile('{{translate "user|coverphoto_none" username}}'),o=d.compile('{{translate "common|loading"}}...'),p=e.ItemView.extend({template:{type:"handlebars",template:n},className:"empty"}),q=e.ItemView.extend({template:{type:"handlebars",template:o},className:"loading"}),r=k.CompositeView.extend({itemView:i,emptyView:p,loadingView:q,itemViewContainer:"#coverphoto-list .row",template:{type:"handlebars",template:j},initialize:function(){a.bindAll(this)},onRender:function(){0===b("#coverphoto-upload-modal").length&&(m=new l.SettingCoverPhotoUploadModalView,b("#main-container").after(m.render().el)),this.listenForFileSelection()},listenForFileSelection:function(){var c=b("input[type='file']",this.$el);c.on("change",function(b){var d=b.target;d.files[0]&&(m.$el.modal({backdrop:"static"}),a.delay(function(){m.setFile(d.files[0])},200),c.replaceWith(c.clone(!0)))})}});return r}),define("hbs!modules/template/profile/leaderboard-list",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h,i="",j="function",k=this.escapeExpression,l=c.helperMissing;return i+='<div class="row">\n	<div class="col-xs-12">\n		<div class="wb" style="width:5%;">',(g=c.rank)?f=g.call(b,{hash:{},data:e}):(g=b&&b.rank,f=typeof g===j?g.call(b,{hash:{},data:e}):g),i+=k(f)+'</div>\n		<div class="user-avatar wb" style="padding-right:25px;">\n			<a href="',(g=c.personalized_url)?f=g.call(b,{hash:{},data:e}):(g=b&&b.personalized_url,f=typeof g===j?g.call(b,{hash:{},data:e}):g),i+=k(f)+'" class="profile-hovercard" data-username="',(g=c.username)?f=g.call(b,{hash:{},data:e}):(g=b&&b.username,f=typeof g===j?g.call(b,{hash:{},data:e}):g),i+=k(f)+'">\n				<img src="'+k((g=c.userGetDisplayPictureUrl||b&&b.userGetDisplayPictureUrl,h={hash:{},data:e},g?g.call(b,48,48,b,h):l.call(b,"userGetDisplayPictureUrl",48,48,b,h)))+'" class="img-circle" />\n			</a>\n		</div>\n		<div class="wb" style="width:50%;">\n			<div class="row">\n				<div class="user-details">\n					<div class="user-username">\n						<a href="',(g=c.personalized_url)?f=g.call(b,{hash:{},data:e}):(g=b&&b.personalized_url,f=typeof g===j?g.call(b,{hash:{},data:e}):g),i+=k(f)+'" data-username="',(g=c.username)?f=g.call(b,{hash:{},data:e}):(g=b&&b.username,f=typeof g===j?g.call(b,{hash:{},data:e}):g),i+=k(f)+'">',(g=c.username)?f=g.call(b,{hash:{},data:e}):(g=b&&b.username,f=typeof g===j?g.call(b,{hash:{},data:e}):g),i+=k(f)+'</a>\n					</div>\n				</div>\n			</div>\n		</div>\n		<a id="leaderboard-gift-back" href="/store/?username=',(g=c.username)?f=g.call(b,{hash:{},data:e}):(g=b&&b.username,f=typeof g===j?g.call(b,{hash:{},data:e}):g),i+=k(f)+'" title="'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"user|gift_back",h):l.call(b,"translate","user|gift_back",h)))+'"><span class="gift-icon icon icon-wb_giftback"></span></a>\n	</div>\n</div>'})}),define("modules/view/profile/leaderboard_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/view/user/user_view","hbs!modules/template/profile/leaderboard-list","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j){var k=g.extend({options:[],template:{type:"handlebars",template:h},className:"user",initialize:function(a){this.options=a},onRender:function(){this.model.get("hidden")&&this.$el.hide(),this.options.isSelf?this.$el.find("#leaderboard-gift-back").show():this.$el.find("#leaderboard-gift-back").hide(),j.parse_profile_hovercard(this),g.prototype.onRender.apply(this,arguments)}});return k}),define("hbs!modules/template/profile/artist-leaderboard",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="leaderboard-top no-bg">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"leaderboard|fan_leaderboard",g):i.call(b,"translate","leaderboard|fan_leaderboard",g)))+'</div>\n\n<div class="leaderboard-container">\n	<div class="leaderboard-content">\n		<div class="row">\n			<div class="col-xs-6" style="padding-right:5px">\n				<div class="btn-group no-padding">\n					<button type="button" class="btn btn-sm btn-white dropdown-toggle text-left" data-toggle="dropdown" >\n						<div class="artist-leaderboard-type-text display-inline-block">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"leaderboard|total",g):i.call(b,"translate","leaderboard|total",g)))+'</div> &nbsp; <span class="caret"></span>\n					</button>\n					<ul class="dropdown-menu artist-leaderboard-type" role="menu">\n						<li><a href="#" data-type="ALL">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"leaderboard|total",g):i.call(b,"translate","leaderboard|total",g)))+'</a></li>\n						<li><a href="#" data-type="GIFT">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"leaderboard|gift",g):i.call(b,"translate","leaderboard|gift",g)))+'</a></li>\n						<li><a href="#" data-type="ENGAGEMENT">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"leaderboard|engagement",g):i.call(b,"translate","leaderboard|engagement",g)))+'</a></li>\n					</ul>\n				</div>\n			</div>\n			<div class="col-xs-6" style="padding-left:5px">\n				<div class="btn-group no-padding">\n					<button type="button" class="btn btn-sm btn-white dropdown-toggle text-left" data-toggle="dropdown" >\n						<div class="artist-leaderboard-period-text display-inline-block">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"leaderboard|this_month",g):i.call(b,"translate","leaderboard|this_month",g)))+'</div> &nbsp; <span class="caret"></span>\n					</button>\n					<ul class="dropdown-menu artist-leaderboard-period" role="menu">\n						<li><a href="#" data-period="MONTHLY">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"leaderboard|this_month",g):i.call(b,"translate","leaderboard|this_month",g)))+'</a></li>\n						<li><a href="#" data-period="ALL_TIME">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"leaderboard|all_time",g):i.call(b,"translate","leaderboard|all_time",g)))+'</a></li>\n					</ul>\n				</div>\n			</div>\n		</div>\n\n		<div class="leaderboard-list"></div>\n\n		<div class="panel-footer custom-more font-size-12 leaderboard-expand hidden">\n			<a href="#">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"common|show_more",g):i.call(b,"translate","common|show_more",g)))+"</a>\n		</div>\n	</div>\n</div>"})}),define("modules/view/profile/artist_leaderboard_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/view/profile/leaderboard_item_view","hbs!modules/template/profile/artist-leaderboard","modules/view/common/mig33_views","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j,k){var l=5,m=d.compile('{{translate "leaderboard|fans_none_gift" username}}'),n=d.compile('{{translate "common|loading"}}...'),o=e.ItemView.extend({template:{type:"handlebars",template:m},className:"empty"}),p=e.ItemView.extend({template:{type:"handlebars",template:n},className:"loading"}),q=k.CompositeView.extend({itemView:i,emptyView:o,loadingView:p,itemViewContainer:".leaderboard-list",itemViewOptions:function(a,b){return{type:"artist-leaderboard",itemIndex:b,isSelf:window.session_user&&window.session_user.username?window.session_user.username==this.options.collection.options.username:!1}},template:{type:"handlebars",template:j},events:{"click .artist-leaderboard-type a":"showByType","click .artist-leaderboard-period a":"showByPeriod","click .leaderboard-expand":"toggleExpanded","click .leaderboard-contract":"toggleContracted","mouseover .leaderboard-hint-icon":"showHint","mouseout .leaderboard-hint-icon":"hideHint"},collectionEvents:{request:"showLoading",sync:"hideLoading"},initialize:function(){a.bindAll(this),this.collection.options.contracted=!0,this.collection.options.contracted_item_view=l,this.setEmptyText("gift"),this.hint=h.translate("leaderboard|hint"),window.session_user&&window.session_user.username===this.options.username&&(this.hint=h.translate("leaderboard|art_hint")),this.listenTo(this.collection,"add",function(){this.collection.length>l&&this.$el.find(".custom-more").removeClass("hidden")})},serializeData:function(){var a={leaderboard_hint:this.hint};return a},showByType:function(a){a.preventDefault(),this.$el.find(".custom-more").addClass("hidden"),b(".artist-leaderboard-type-text",this.$el).text(b(a.currentTarget).text()),this.collection.updateType(b(a.currentTarget).data("type")),this.setEmptyText(b(a.currentTarget).data("type").toLowerCase()),this.$el.find(".empty").html(this.emptyText)},showByPeriod:function(a){a.preventDefault(),this.$el.find(".custom-more").addClass("hidden"),b(".artist-leaderboard-period-text",this.$el).text(b(a.currentTarget).text()),this.collection.updatePeriod(b(a.currentTarget).data("period"))},toggleExpanded:function(a){a.preventDefault(),this.$el.find(".leaderboard-list .user:gt("+(l-1)+")").show("slow"),this.collection.options.contracted=!1,b(a.currentTarget).toggleClass("leaderboard-expand leaderboard-contract").find("a").text(h.translate("common|show_less"))},toggleContracted:function(a){a.preventDefault(),this.$el.find(".leaderboard-list .user:gt("+(l-1)+")").hide("slow"),this.collection.options.contracted=!0,b(a.currentTarget).toggleClass("leaderboard-expand leaderboard-contract").find("a").text(h.translate("common|show_more"))},showHint:function(a){a.preventDefault(),b(a.currentTarget).parent().find(".leaderboard-hint").removeClass("hidden")},hideHint:function(a){a.preventDefault(),b(".leaderboard-hint").addClass("hidden")},showLoading:function(a){this.$el.find(this.itemViewContainer).html("<div class='loading remove'>"+h.translate("common|loading")+"...</div>")},hideLoading:function(a){this.$el.find(this.itemViewContainer).removeClass("loading"),this.$el.find(".remove").remove(),this.populateEmpty()},populateEmpty:function(){this.isEmpty()&&0===this.$el.find(".empty").length&&this.$el.find(this.itemViewContainer).append("<div class='empty'></div>"),this.$el.find(".empty").html(this.emptyText)},setEmptyText:function(a){var b=a||"gift";this.emptyText=h.translate("leaderboard|fans_none_"+b,this.options.username),this.emptyText+="<br><br>"+h.translate("leaderboard|fans_none_tip"),window.session_user&&window.session_user.username===this.options.username&&(this.emptyText=h.translate("leaderboard|art_fans_none_"+b,this.options.username),this.emptyText+="<br><br>"+h.translate("leaderboard|art_fans_none_tip"))}});return q}),define("hbs!modules/template/profile/current-top-leaderboard",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f,g="";return g+='\n	<div class="current-leaderboard">\n		<a href="',(e=c.personalized_url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.personalized_url,d=typeof e===k?e.call(a,{hash:{},data:b}):e),g+=l(d)+'" class="profile-hovercard" data-username="',(e=c.username)?d=e.call(a,{hash:{},data:b}):(e=a&&a.username,d=typeof e===k?e.call(a,{hash:{},data:b}):e),g+=l(d)+'">\n			<img src="'+l((e=c.userGetDisplayPictureUrl||a&&a.userGetDisplayPictureUrl,f={hash:{},data:b},e?e.call(a,48,48,a,f):m.call(a,"userGetDisplayPictureUrl",48,48,a,f)))+'" width="48" height="48" class="img-circle" />\n		</a>\n		<div class="user-username">\n			<a href="',(e=c.personalized_url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.personalized_url,d=typeof e===k?e.call(a,{hash:{},data:b}):e),g+=l(d)+'" class="profile-hovercard" data-username="',(e=c.username)?d=e.call(a,{hash:{},data:b}):(e=a&&a.username,d=typeof e===k?e.call(a,{hash:{},data:b}):e),g+=l(d)+'">',(e=c.username)?d=e.call(a,{hash:{},data:b}):(e=a&&a.username,d=typeof e===k?e.call(a,{hash:{},data:b}):e),g+=l(d)+'</a>\n			&nbsp;<span class="user-label font-size-16">'+l((e=c.userGetLabels||a&&a.userGetLabels,f={hash:{},data:b},e?e.call(a,a,f):m.call(a,"userGetLabels",a,f)))+'</span>\n		</div>\n		<div class="user-leaderboard">\n			'+l((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"leaderboard|points_in_month",a&&a.score,a&&a.cur_date,f):m.call(a,"translate","leaderboard|points_in_month",a&&a.score,a&&a.cur_date,f)))+"\n		</div>\n	</div>\n"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var g,h,i,j="",k="function",l=this.escapeExpression,m=c.helperMissing,n=this;return h=c.isNotEmpty||b&&b.isNotEmpty,i={hash:{},inverse:n.noop,fn:n.program(1,f,e),data:e},g=h?h.call(b,b&&b.username,i):m.call(b,"isNotEmpty",b&&b.username,i),(g||0===g)&&(j+=g),j+="\n"})}),define("modules/view/profile/current_top_leaderboard_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/mig33_app","modules/model/user/user_model","hbs!modules/template/profile/current-top-leaderboard","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j,k){var l=e.ItemView.extend({options:[],template:{type:"handlebars",template:i},className:"user",initialize:function(a){this.options=a;var b=this;if(this.model.collection.length>0){var c=this.model.get("username"),d=this.model.get("score");if(!g.cache.user[c]){var e=new h({username:c});e.fetch(),e.on("sync",function(){b.model.set(this.attributes),b.$el=b.render().$el,g.cache.user[c]=b.model})}var f=new Date,i=new Date(f.getFullYear(),f.getMonth()-1,1);this.model.set("cur_date",k.dateFormat(i.getTime(),"mmmm yyyy")),this.model.set("score",k.add_thousands_seperator(d))}},onRender:function(){(this.model.get("hidden")||this.options.model.get("hidden"))&&this.$el.hide(),k.parse_profile_hovercard(this),b(".user-stat a",this.$el).qtip({position:{my:"bottom center",at:"top center"},style:{classes:"qtip-user",def:!1},hide:{event:"click mouseleave"}})}});return l}),define("hbs!modules/template/profile/fotm-leaderboard",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h,i="",j="function",k=this.escapeExpression,l=c.helperMissing;return i+='<div class="leaderboard-hint-container">\n	<span class="i-icon leaderboard-hint-icon">i</span>\n	<div class="hidden leaderboard-hint">\n	<span class="arrow-left"></span>\n	<span class="text-container">',(g=c.fotm_hint)?f=g.call(b,{hash:{},data:e}):(g=b&&b.fotm_hint,f=typeof g===j?g.call(b,{hash:{},data:e}):g),i+=k(f)+'</span>\n	</div>\n</div>\n<div class="leaderboard-top with-bg">'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"leaderboard|fan_of_the_month",h):l.call(b,"translate","leaderboard|fan_of_the_month",h)))+'</div>\n\n<div class="leaderboard-container">\n	<div class="current-top-leaderboard">\n	</div>\n</div>'})}),define("modules/view/profile/fotm_leaderboard_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/view/profile/current_top_leaderboard_item_view","hbs!modules/template/profile/fotm-leaderboard","modules/view/common/mig33_views","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j,k){var l=d.compile('{{translate "leaderboard|fotm_none" username}}'),m=d.compile('{{translate "common|loading"}}...'),n=e.ItemView.extend({template:{type:"handlebars",template:l},className:"empty"}),o=e.ItemView.extend({template:{type:"handlebars",template:m},className:"loading"}),p=k.CompositeView.extend({itemView:i,emptyView:n,loadingView:o,itemViewContainer:".current-top-leaderboard",itemViewOptions:function(a,b){return{type:"fotm-leaderboard",itemIndex:b}},template:{type:"handlebars",template:j},events:{"mouseover .leaderboard-hint-icon":"showHint","mouseout .leaderboard-hint-icon":"hideHint"},collectionEvents:{sync:"checkText"},initialize:function(){a.bindAll(this),this.emptyText=h.translate("leaderboard|fotm_none",this.options.username),this.hint=h.translate("leaderboard|hint"),window.session_user&&window.session_user.username===this.options.username&&(this.emptyText=h.translate("leaderboard|art_fotm_none"),this.hint=h.translate("leaderboard|art_hint")),this.listenTo(this.collection,"add",function(){this.collection.length>1&&this.collection.reset(this.collection.slice(0,1))})},serializeData:function(){var a={fotm_hint:this.hint};return a},showHint:function(a){a.preventDefault(),b(a.currentTarget).parent().find(".leaderboard-hint").removeClass("hidden")},hideHint:function(a){a.preventDefault(),b(".leaderboard-hint").addClass("hidden")},checkText:function(a){h.translate("leaderboard|current_fotm_hint");!this.isEmpty()&&this.$el.find(".empty").length>0&&this.$el.find(".empty").text(this.emptyText)}});return p}),define("hbs!modules/template/profile/user-fotm-leaderboard",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h,i="",j="function",k=this.escapeExpression,l=c.helperMissing;return i+='<div class="leaderboard-hint-container">\n	<span class="i-icon leaderboard-hint-icon">i</span>\n	<div class="hidden leaderboard-hint">\n	<span class="arrow-left"></span>\n	<span class="text-container">',(g=c.fotm_hint)?f=g.call(b,{hash:{},data:e}):(g=b&&b.fotm_hint,f=typeof g===j?g.call(b,{hash:{},data:e}):g),i+=k(f)+'</span>\n	</div>\n</div>\n\n<div class="leaderboard-top with-bg">'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"leaderboard|fan_of_the_month_of",h):l.call(b,"translate","leaderboard|fan_of_the_month_of",h)))+'</div>\n\n<div class="leaderboard-container">\n	<div class="user-top-leaderboard">\n	</div>\n\n	<div class="panel-footer custom-more font-size-12 leaderboard-expand hidden">\n		<a href="#">'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"common|show_more",h):l.call(b,"translate","common|show_more",h)))+"</a>\n	</div>\n</div>"})}),define("modules/view/profile/user_fotm_leaderboard_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/view/profile/current_top_leaderboard_item_view","hbs!modules/template/profile/user-fotm-leaderboard","modules/view/common/mig33_views","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j,k){var l=1,m=d.compile('{{translate "leaderboard|fotm_none" username}}'),n=d.compile('{{translate "common|loading"}}...'),o=e.ItemView.extend({template:{type:"handlebars",template:m},className:"empty"}),p=e.ItemView.extend({template:{type:"handlebars",template:n},className:"loading"}),q=k.CompositeView.extend({itemView:i,emptyView:o,loadingView:p,itemViewContainer:".user-top-leaderboard",itemViewOptions:function(a,b){return{type:"user-fotm-leaderboard",itemIndex:b}},template:{type:"handlebars",template:j},events:{"mouseover .leaderboard-hint-icon":"showHint","mouseout .leaderboard-hint-icon":"hideHint","click .leaderboard-expand":"toggleExpanded","click .leaderboard-contract":"toggleContracted"},collectionEvents:{sync:"checkText"},initialize:function(){a.bindAll(this),this.collection.options.contracted=!0,this.collection.options.contracted_item_view=l,this.emptyText=h.translate("leaderboard|fans_none_tip",this.options.username),this.hint=h.translate("leaderboard|user_fotm_hint"),this.listenTo(this.collection,"add",function(){this.$el.parent().removeClass("hidden"),this.collection.length>l&&this.$el.find(".leaderboard-expand").removeClass("hidden")})},onRender:function(){this.collection.length>0&&b("#user-leaderboard").removeClass("hidden")},serializeData:function(){var a={fotm_hint:this.hint};return a},toggleExpanded:function(a){a.preventDefault(),this.$el.find(this.itemViewContainer+" .user:gt("+(l-1)+")").show("slow"),this.collection.options.contracted=!1,
b(a.currentTarget).toggleClass("leaderboard-expand leaderboard-contract").find("a").text(h.translate("common|show_less"))},toggleContracted:function(a){a.preventDefault(),this.$el.find(this.itemViewContainer+" .user:gt("+(l-1)+")").hide("slow"),this.collection.options.contracted=!0,b(a.currentTarget).toggleClass("leaderboard-expand leaderboard-contract").find("a").text(h.translate("common|show_more"))},showHint:function(a){a.preventDefault(),b(a.currentTarget).parent().find(".leaderboard-hint").removeClass("hidden")},hideHint:function(a){a.preventDefault(),b(".leaderboard-hint").addClass("hidden")},checkText:function(a){h.translate("leaderboard|current_fotm_hint");!this.isEmpty()&&this.$el.find(".empty").length>0&&this.$el.find(".empty").text(this.emptyText)}});return q}),define("hbs!modules/template/profile/share-box",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="post-box-container postbox">\n	<div class="input-group postbox-sample" data-toggle="modal" data-target="#sharebox-modal" >\n		<div>\n			<img src="'+j((f=c.getSessionUserDisplayPictureUrl||b&&b.getSessionUserDisplayPictureUrl,g={hash:{},data:e},f?f.call(b,150,150,g):i.call(b,"getSessionUserDisplayPictureUrl",150,150,g)))+'" width="24" height="24" class="img-circle" />\n			<span class="username">'+j((f=c.getSessionUser||b&&b.getSessionUser,g={hash:{},data:e},f?f.call(b,"username",g):i.call(b,"getSessionUser","username",g)))+'</span>\n			<div class="postbox-media-option">\n				<div class="postbox-submit">\n					<a class="font-color-grey" href="#" class="text-center">\n						<span class="icon-wb_send" title="'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"common|share",g):i.call(b,"translate","common|share",g)))+'"></span>\n					</a>\n				</div>\n			</div>\n		</div>\n		<input type="text" name="body-sample" class="form-control input-sm" placeholder="'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"homefeed|say_something_user",g):i.call(b,"translate","homefeed|say_something_user",g)))+'" />\n		<!-- <span class="input-group-btn">\n			<input type="button" class="btn btn-sm btn-default" value="'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"common|share",g):i.call(b,"translate","common|share",g)))+'" />\n		</span> -->\n	</div>\n</div>'})}),define("modules/view/profile/share_box_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/profile/share-box","modules/common/config","modules/model/gift/gift_model","modules/model/user/user_model","modules/model/post/post_model","modules/common/utility","modules/common/session_user","modules/globals/url","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=e.ItemView.extend({template:{type:"handlebars",template:g}});return o}),define("hbs!modules/template/gift/gift-item-count",["handlebars"],function(a){return a.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},"\n"})}),define("modules/view/gift/gift_item_count_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/gift/gift-item-count","modules/common/config","modules/model/gift/gift_model","modules/model/user/user_model","modules/model/post/post_model","modules/common/utility","modules/common/session_user","modules/globals/url","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=e.ItemView.extend({template:{type:"handlebars",template:g},className:"item-count",id:"item-count",initialize:function(a){this.options=a},onRender:function(){this.$el.html(this.options.total)}});return o}),define("modules/model/badge/badge_expired_collection",["underscore","modules/model/common/mig33_collection","modules/model/badge/badge_model","modules/common/config","modules/common/utility"],function(a,b,c,d,e){return b.extend({model:c,sortBy:"name",initialize:function(a,b){this.options=b},url:function(){return e.format(d.urls.expired_badges_url,this.options.userId)},parse:function(b){return a.isUndefined(b.data.badges)||a.isNull(b.data.badges)?b:(console.warn(b.data.badges),b.data.badges)}})}),define("hbs!modules/template/achievement/achievement-layout",["handlebars"],function(a){return a.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},'<div id="achievement-labels-container"></div>\n<div id="achievement-badges-container"></div>\n<div id="achievement-powers-container"></div>'})}),define("modules/view/profile/achievements_layout",["modules/view/common/mig33_views","hbs!modules/template/achievement/achievement-layout"],function(a,b){return a.Layout.extend({itemViewContainer:"#achievements",template:{type:"handlebars",template:b},regions:{labels:"#achievement-labels-container",badges:"#achievement-badges-container",powers:"#achievement-powers-container"}})}),define("hbs!modules/template/achievement/achievement-labels-modal",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h,i="",j=c.helperMissing,k=this.escapeExpression,l="function";return i+='<div id="label-modal">\n    <div class="modal-dialog">\n        <div class="modal-content">\n            <div class="modal-body achievement-label-model">\n                <div class="post achievement-unlock">\n\n                    <div class="achievement-unlock__banner">\n                        <img src="'+k((g=c.getUrl||b&&b.getUrl,h={hash:{},data:e},g?g.call(b,"jsclient",h):j.call(b,"getUrl","jsclient",h)))+'/app/images/identity/identity_postheader_web.png" />\n                    </div>\n\n                    <div class="achievement-unlock__content">\n                        <h3 class="congratulations">'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"Congratulations",h):j.call(b,"translate","Congratulations",h)))+'</h3>\n\n                        <div class="power-icon">\n                            <img src="'+k((g=c.getUrl||b&&b.getUrl,h={hash:{},data:e},g?g.call(b,"jsclient",h):j.call(b,"getUrl","jsclient",h)))+"/app/images/identity/",(g=c.imageName)?f=g.call(b,{hash:{},data:e}):(g=b&&b.imageName,f=typeof g===l?g.call(b,{hash:{},data:e}):g),i+=k(f)+'" />\n                        </div>\n\n                        <p class="message">',(g=c.title)?f=g.call(b,{hash:{},data:e}):(g=b&&b.title,f=typeof g===l?g.call(b,{hash:{},data:e}):g),i+=k(f)+'</p>\n                        <p class="sub-message">',(g=c.description)?f=g.call(b,{hash:{},data:e}):(g=b&&b.description,f=typeof g===l?g.call(b,{hash:{},data:e}):g),i+=k(f)+'</p>\n                        <!--<p class="private-message"><span class="icon icon-wb_private"></span> Only you can see this.</p>-->\n                    </div>\n\n                    <div class="achievement-unlock__action">\n                        <a href="'+k((g=c.getUrl||b&&b.getUrl,h={hash:{},data:e},g?g.call(b,"corporate",h):j.call(b,"getUrl","corporate",h)))+'/faq" target="_blank">\n                            <div class="more-info">\n                                <span class="icon-wb_moreinfo"></span> '+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"More Info",h):j.call(b,"translate","More Info",h)))+'\n                            </div>\n                        </a>\n                        <a class="js-share" href="#">\n                            <div class="share">\n                                <span class="icon-wb_mb_share"></span> '+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"Share This Moment",h):j.call(b,"translate","Share This Moment",h)))+"\n                            </div>\n                        </a>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n"})}),define("modules/view/profile/achievements_labels_modal_view",["backbone.marionette","modules/common/utility","hbs!modules/template/achievement/achievement-labels-modal"],function(a,b,c){return a.ItemView.extend({className:"modal fade",template:{type:"handlebars",template:c},events:{"click .js-share":"displayShare"},displayShare:function(a){this.model.mimetype={mimeType:"application/vnd.migme.achievement",mimeData:{username:this.model.attributes.username,userId:this.model.attributes.userId,labelName:this.model.attributes.name,labelId:this.model.attributes.id,title:this.model.attributes.name,description:this.model.attributes.description}},b.show_share_dialog("label",this.model),this.$el.modal("hide")}})}),define("hbs!modules/template/achievement/achievement-labels",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+='\n        <ul class="vertical-label-list">\n            ',d=c.each.call(a,a&&a.labels,{hash:{},inverse:o.noop,fn:o.program(2,g,b),data:b}),(d||0===d)&&(f+=d),f+='\n        </ul>\n\n        <div class="descriptions">\n            <h3 class="greetings text-center">',(e=c.labelGreetings)?d=e.call(a,{hash:{},data:b}):(e=a&&a.labelGreetings,d=typeof e===l?e.call(a,{hash:{},data:b}):e),f+=m(d)+'</h3>\n            <h4 class="text-center">Labels are granted to star users of migme.</h4>\n        </div>\n    '}function g(a,b){var d,e,f,g="";return g+='\n                <li id="achievement-'+m((d=a&&a.id,typeof d===l?d.apply(a):d))+'" class="label-item" data-name="'+m((d=a&&a.name,typeof d===l?d.apply(a):d))+'" style="z-index: '+m((d=null==b||b===!1?b:b.index,typeof d===l?d.apply(a):d))+';">\n                    <img class="label-img" src="'+m((e=c.getUrl||a&&a.getUrl,f={hash:{},data:b},e?e.call(a,"jsclient",f):n.call(a,"getUrl","jsclient",f)))+"/app/images/identity/"+m((d=a&&a.imageName,typeof d===l?d.apply(a):d))+'" />\n                </li>\n            '}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var h,i,j,k="",l="function",m=this.escapeExpression,n=c.helperMissing,o=this;return k+='<div class="row no-margin profile-section-header">\n    <div class="header-title col-xs-14 left">\n        '+m((i=c.translate||b&&b.translate,j={hash:{},data:e},i?i.call(b,"Your Achievements",j):n.call(b,"translate","Your Achievements",j)))+'\n    </div>\n\n    <div class="menus right">\n        <a href="'+m((i=c.getUrl||b&&b.getUrl,j={hash:{},data:e},i?i.call(b,"corporate",j):n.call(b,"getUrl","corporate",j)))+'/faq" target="_blank" class="action-icon">\n            <span class="icon-wb_help col-xs-16"></span>\n        </a>\n    </div>\n</div>\n\n<div class="banner">\n    <img src="'+m((i=c.getUrl||b&&b.getUrl,j={hash:{},data:e},i?i.call(b,"jsclient",j):n.call(b,"getUrl","jsclient",j)))+'/app/images/identity/identity_header_web.png" />\n</div>\n\n<div class="label-content text-center">\n    <h2 class="label-header text-center">'+m((i=c.translate||b&&b.translate,j={hash:{},data:e},i?i.call(b,"Your Achievements",j):n.call(b,"translate","Your Achievements",j)))+"</h2>\n    ",h=c["if"].call(b,b&&b.labels,{hash:{},inverse:o.noop,fn:o.program(1,f,e),data:e}),(h||0===h)&&(k+=h),k+='\n</div>\n\n<a href="'+m((i=c.getUrl||b&&b.getUrl,j={hash:{},data:e},i?i.call(b,"corporate",j):n.call(b,"getUrl","corporate",j)))+'/faq" target="_blank" class="action-icon">\n    <div class="profile-section-footer">\n        <div class="footer-title">\n            <span class="icon-wb_info col-xs-16"></span> '+m((i=c.translate||b&&b.translate,j={hash:{},data:e},i?i.call(b,"Find out more about user labels",j):n.call(b,"translate","Find out more about user labels",j)))+'\n            <span class="icon-wb_arrowRight font-size-12 col-xs-16 right"></span>\n        </div>\n    </div>\n</a>\n'})}),define("modules/view/profile/achievements_labels_view",["backbone","underscore","modules/common/utility","modules/view/common/mig33_views","modules/view/profile/achievements_labels_modal_view","hbs!modules/template/achievement/achievement-labels"],function(a,b,c,d,e,f){return d.ItemView.extend({template:{type:"handlebars",template:f},events:{"click .label-item":"displayModal"},id:function(){return"achievement-"+this.model.get("id")},displayModal:function(d){d.stopPropagation(),d.preventDefault();var f=this,g=this.options.username,h=this.model.attributes.data.labels||[],i=$(d.currentTarget).data("name");b.each(h,function(b){if(b.name===i){b.imageName=i.toLowerCase()+"_display.png",b.username=g,b.userId=f.options.model.get("userId");var d=new e({model:new a.Model(b)}),h=a.history.fragment;h.indexOf("/achievement")>=0&&(h="/u/"+b.username+"/achievements"),$("#main-container").after(d.render().el),d.$el.modal("show"),d.$el.one("hidden.bs.modal",function(a){c.track_navigate(h),this.remove()}),c.track_navigate("/u/"+b.username+"/achievement/"+b.id)}})},templateHelpers:function(){var a=this.model.attributes.data.labels||[],c=[];return a.sort(function(a,b){return a.achievedTimestamp<b.achievedTimestamp}),a.length>2&&a.splice(2,a.length-2),b.each(a,function(a){var b=a.name;c.push(b),a.imageName=b.toLowerCase()+"_display.png"}),{labels:a,labelGreetings:this.options.username+" are a "+c.join(" and ")}}})}),define("hbs!modules/template/achievement/achievement-badges",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e="";return e+='\n        <ul class="vertical-badge-list">\n            ',d=c.each.call(a,a&&a.badges,{hash:{},inverse:p.noop,fn:p.program(2,g,b),data:b}),(d||0===d)&&(e+=d),e+="\n        </ul>\n    "}function g(a,b){var d,e,f,g="";return g+='\n                <li class="badge-item" data-name="'+n((d=a&&a.name,typeof d===m?d.apply(a):d))+'" style="z-index: '+n((d=null==b||b===!1?b:b.index,typeof d===m?d.apply(a):d))+';"><img class="badge-img" src="'+n((e=c.getBadgeImageUrl||a&&a.getBadgeImageUrl,f={hash:{},data:b},e?e.call(a,a&&a.imageName,64,f):o.call(a,"getBadgeImageUrl",a&&a.imageName,64,f)))+'" /></li>\n            '}function h(a,b){var d,e,f="";return f+="\n        <span>"+n((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"You haven't earn any Badges yet!",e):o.call(a,"translate","You haven't earn any Badges yet!",e)))+"</span>\n    "}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var i,j,k,l="",m="function",n=this.escapeExpression,o=c.helperMissing,p=this;return l+='<div class="row no-margin profile-section-header">\n    <div class="header-title col-xs-14 left">\n        '+n((j=c.translate||b&&b.translate,k={hash:{},data:e},j?j.call(b,"user|badges_with_count",b&&b.numOfBadges,k):o.call(b,"translate","user|badges_with_count",b&&b.numOfBadges,k)))+'\n    </div>\n</div>\n\n<div class="badge-content">\n    ',i=c["if"].call(b,b&&b.numOfBadges,{hash:{},inverse:p.noop,fn:p.program(1,f,e),data:e}),(i||0===i)&&(l+=i),l+="\n\n    ",i=c["if"].call(b,b&&b.displayEmptyWords,{hash:{},inverse:p.noop,fn:p.program(4,h,e),data:e}),(i||0===i)&&(l+=i),l+='\n</div>\n\n<a href="/u/',(j=c.username)?i=j.call(b,{hash:{},data:e}):(j=b&&b.username,i=typeof j===m?j.call(b,{hash:{},data:e}):j),l+=n(i)+'/badges" target="_blank" class="action-icon">\n    <div class="profile-section-footer">\n        <div class="footer-title">\n            '+n((j=c.translate||b&&b.translate,k={hash:{},data:e},j?j.call(b,"View more",k):o.call(b,"translate","View more",k)))+'\n            <span class="icon-wb_arrowRight font-size-10 col-xs-16"></span>\n        </div>\n    </div>\n</a>\n'})}),define("modules/view/profile/achievements_badges_view",["modules/view/common/mig33_views","hbs!modules/template/achievement/achievement-badges","underscore"],function(a,b,c){return a.ItemView.extend({template:{type:"handlebars",template:b},templateHelpers:function(){var a=this.model.attributes.data.badges||{},b=a.total;return{badges:a,username:this.options.username,numOfBadges:b,displayEmptyWords:!b}}})}),define("hbs!modules/template/achievement/achievement-powers",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f,h="";return h+='\n    <div class="row no-margin profile-section-header">\n        <div class="header-title col-xs-14 left">\n            '+j((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"Powers",f):k.call(a,"translate","Powers",f)))+'\n        </div>\n    </div>\n\n    <div class="power-content">\n        <ul class="vertical-power-list">\n            ',d=c.each.call(a,a&&a.powers,{hash:{},inverse:l.noop,fn:l.program(2,g,b),data:b}),(d||0===d)&&(h+=d),h+="\n        </ul>\n    </div>\n"}function g(a,b){var d,e,f,g="";return g+='\n                <li class="power-item" style="z-index: '+j((d=null==b||b===!1?b:b.index,typeof d===i?d.apply(a):d))+';">\n                    <img src="'+j((e=c.getUrl||a&&a.getUrl,f={hash:{},data:b},e?e.call(a,"jsclient",f):k.call(a,"getUrl","jsclient",f)))+'/app/images/identity/power.png" alt="Power Image">\n                    <div class="descriptions">\n                        <div class="name">'+j((d=a&&a.name,typeof d===i?d.apply(a):d))+'</div>\n                        <div class="description">'+j((d=a&&a.description,typeof d===i?d.apply(a):d))+'</div>\n                        <div class="quantity">'+j((d=a&&a.quantity,typeof d===i?d.apply(a):d))+' <span class="delta">+ '+j((d=a&&a.delta,typeof d===i?d.apply(a):d))+"</span></div>\n                    </div>\n                </li>\n            "}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var h,i="function",j=this.escapeExpression,k=c.helperMissing,l=this;return h=c["if"].call(b,b&&b.numOfPowers,{hash:{},inverse:l.noop,fn:l.program(1,f,e),data:e}),h||0===h?h:""})}),define("modules/view/profile/achievements_powers_view",["modules/view/common/mig33_views","hbs!modules/template/achievement/achievement-powers"],function(a,b){return a.ItemView.extend({template:{type:"handlebars",template:b},templateHelpers:function(){var a=this.model.get("data"),b=Object.keys(a).length||0;return{powers:a,numOfPowers:b}}})}),define("modules/model/power/power_model",["modules/model/common/mig33_model","modules/common/config","modules/common/utility"],function(a,b,c){return a.extend({url:function(){return c.format(b.urls.power_url,this.attributes.userId)},parse:function(a){return console.warn(a),a}})}),define("modules/controller/profile_controller",["underscore","backbone","backbone.marionette","modules/mig33_app","modules/view/profile/profile_layout","modules/view/profile/profile_header_view","modules/view/profile/profile_detail_view","modules/view/profile/profile_sidebar_view","modules/view/profile/posts_layout","modules/model/user/user_model","modules/model/user/about_model","modules/model/homefeed/mentions_collection","modules/model/post/post_collection","modules/model/game/game_collection","modules/model/group/group_collection","modules/model/user/leaderboard_collection","modules/model/user/fanofthemonth_collection","modules/model/user/about_collection","modules/model/user/follower_collection","modules/model/user/following_collection","modules/model/user/friend_collection","modules/model/badge/badge_collection","modules/model/store/store_item_received_collection","modules/model/store/store_favorite_item_received_collection","modules/model/chatroom/chatroom_collection","modules/model/setting/setting_coverphoto_collection","modules/model/discover/discover_user_collection","modules/view/homefeed/homefeed_post_collection_view","modules/view/game/game_profile_sidebar_collection_view","modules/view/group/group_profile_sidebar_collection_view","modules/view/profile/about_collection_view","modules/view/profile/follower_collection_view","modules/view/profile/following_collection_view","modules/view/profile/friend_collection_view","modules/view/badge/badge_collection_view","modules/model/gift/gift_collection","modules/model/gift/gift_model","modules/model/store/store_item_received_model","modules/view/gift/gift_collection_view","modules/view/gift/favorite_gift_collection_view","modules/view/gift/favorite_gift_monthly_list_container_view","modules/view/gift/gift_monthly_list_container_view","modules/view/gift/gift_main_layout_view","modules/view/group/group_profile_collection_view","modules/view/game/game_profile_collection_view","modules/view/chatroom/chatroom_profile_layout","modules/view/chatroom/chatroom_profile_collection_view","modules/view/setting/setting_coverphoto_collection_view","modules/view/discover/discover_homefeed_user_collection_view","modules/view/discover/discover_profile_sidebar_invite_view","modules/view/profile/artist_leaderboard_view","modules/view/profile/fotm_leaderboard_view","modules/view/profile/user_fotm_leaderboard_view","modules/view/profile/share_box_item_view","modules/view/gift/gift_item_count_view","modules/common/config","modules/common/utility","modules/common/session_user","modules/common/task_runner","modules/view/profile/achievement_profile_details_view","modules/model/badge/badge_expired_collection","modules/view/profile/achievements_layout","modules/view/profile/achievements_labels_view","modules/view/profile/achievements_badges_view","modules/view/profile/achievements_powers_view","modules/model/achievement/achievement_model","modules/model/power/power_model"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja,ka,la,ma,na){var oa,pa,qa,ra,sa,ta,ua,va,wa,xa=null,ya=null,za=fa.TaskRunner,Aa=new za,Ba=c.Controller.extend({_createAndInitProfileLayout:function(){ra=new e,ra.on("close",function(){ya=null})},_show:function(a){var b=this;a="undefined"!=typeof a&&""!=a&&null!=a?a:da.get_username(),da.highlight_top_menu("profile"),this._createAndInitProfileLayout(),d.content.show(ra),oa=this._getUserByName(a),pa=this._getAboutUserByName(a),oa.on("change",function(){null!==ya&&a==qa||b._fetchProfileSidebar(oa),qa=a})},_getUserByName:function(a){var b=new j({username:a}),c=(new k({username:a}),b.fetch());return c.done(function(a){return a}),b.on("change",function(a){}),b},_getAboutUserByName:function(a){var b=new k({username:a}),c=b.fetch();return c.done(function(a){return a}),b.on("change",function(a){}),b},_redirect_to_login:function(){da.is_logged_in()||location.reload()},_hideProfileSidebar:function(){ua.hideSidebar(),$(".profile-container",this.$el).removeClass("col-md-offset-1 col-md-10").addClass("col-md-offset-2 col-md-7 subpage"),$(".header-profile",this.$el).removeClass("col-md-offset-1 col-md-10").addClass("col-md-offset-2 col-md-7")},_showProfileSidebar:function(){ua.showProfilePost(),ua.showSidebar(),ua.setBackButton(),$(".profile-container",this.$el).addClass("col-md-offset-1 col-md-10").removeClass("col-md-offset-2 col-md-7 subpage"),$(".header-profile",this.$el).addClass("col-md-offset-1 col-md-10").removeClass("col-md-offset-2 col-md-7")},initialize:function(){var a=this,b=require("modules/common/session_user");d.vent.on(d.ApplicationEvents.COVERPHOTO_UPDATED,function(a){wa.fetch(),b&&b.getInstance().set("cover_photo_url",a),oa.set("cover_photo_url",a),ta.updateCoverPhoto(a),da.show_success(da.translate("user|coverphoto_success_set"))}),d.vent.on(d.ApplicationEvents.POST_ADDED,function(a){null!==xa&&xa.incrementPostsCount(a.author.username)}),d.vent.on(d.ApplicationEvents.POST_DELETED,function(a){}),d.vent.on(d.ApplicationEvents.POST_REPLY_ADDED,function(b){a._addInteractions(b,"replies")}),d.vent.on(d.ApplicationEvents.POST_RESHARE_ADDED,function(b){a._addInteractions(b,"reshares")}),d.vent.on(d.ApplicationEvents.POST_REPLY_DELETED,function(b){a._removeInteractions(b,"replies")})},index:function(a){var c=this;this._show(a),oa.on("change",function(){if(c._showProfileSidebar(),ua.showAvatarPanel(),ua.showAboutPanel(),ua.hideCustomPanel(),ua.hideInvitePanel(),da.is_logged_in()&&da.is_owner()){var a=new aa;ra.shareBoxPost.show(a)}var e=new B({emptyViewModel:new b.Model({type:"userfeed",user:oa.toJSON()}),type:"userfeed",collection:oa.profile_feed});oa.profile_feed.fetch(),xa=new i({model:oa}),ra.container.show(xa),xa.posts.show(e),d.vent.on(d.ApplicationEvents.POST_ADDED,function(a){oa.profile_feed.create(a)}),e.on("userfeed:more",function(a){ra.showPagination(),e.more=da.block_function(e.more),oa.profile_feed.fetch({remove:!1,page:a})}),oa.profile_feed.on("fetch:done",function(){ra.hidePagination(),e.more=da.unblock_function(e.more)}),ya=e})},mentions:function(a){var c=this;this._redirect_to_login(),this._show(),oa.on("change",function(){va=new l,va.fetch();var a=new B({emptyViewModel:new b.Model({type:"mentions"}),type:"mentions",collection:va});xa||(xa=new i({model:oa})),c._hideProfileSidebar(),ra.container.show(xa),xa.posts.show(a),a.on("mentions:more",function(b){ra.showPagination(),a.more=da.block_function(a.more),va.fetch({remove:!1,page:b})}),va.on("fetch:done",function(){ra.hidePagination(),a.more=da.unblock_function(a.more)}),ya=a})},about:function(a){var c=this;this._redirect_to_login(),this._show(a),oa.on("change",function(){c._hideProfileSidebar();var a=new r([],{userId:oa.get("id")});a.fetch();var d=new E({emptyViewModel:new b.Model({username:oa.get("username")}),model:pa,collection:a});ra.container.show(d),ya=d})},followers:function(a){var c=this;this._redirect_to_login(),this._show(a),oa.on("change",function(){c._hideProfileSidebar();var a=new s([],{userId:oa.get("id")});a.fetch();var d=new F({emptyViewModel:new b.Model({username:oa.get("username")}),model:oa,collection:a});ra.container.show(d),oa.get("num_followers")>ca.profile.following.limit&&d.on("follower:more",function(b){ra.showPagination(),d.more=da.block_function(d.more),a.fetch({remove:!1,page:b})}),a.on("fetch:done",function(){1===this.getPage()&&oa.get("username")===ea.getInstance().get("username")&&d.setNewFollowersCount(this.getNewCount()),ra.hidePagination(),d.more=da.unblock_function(d.more)}),ya=d})},following:function(a){var c=this;this._redirect_to_login(),this._show(a),oa.on("change",function(){c._hideProfileSidebar();var a=new t([],{userId:oa.get("id")});a.fetch();var d=new G({emptyViewModel:new b.Model({username:oa.get("username")}),model:oa,collection:a});ra.container.show(d),oa.get("num_following")>ca.profile.following.limit&&d.on("following:more",function(b){ra.showPagination(),d.more=da.block_function(d.more),a.fetch({remove:!1,page:b})}),a.on("fetch:done",function(){ra.hidePagination(),d.more=da.unblock_function(d.more)}),ya=d})},friends:function(a){var c=this;this._redirect_to_login(),this._show(a),oa.on("change",function(){c._hideProfileSidebar();var a=new u([],{userId:oa.get("id")});a.setLimit(a.LIMIT_FOR_GET_ALL),a.fetch();var d=new H({emptyViewModel:new b.Model({username:oa.get("username")}),model:oa,collection:a});ra.container.show(d),ya=d})},badges:function(a,c,d){null==c&&this._redirect_to_login();var e=this;d=d||!1,this._show(a),oa.on("change",function(){var a,f,g={userId:oa.get("id"),username:oa.get("alias")},h=new ga({model:oa});d?(a=new ha([],g),f=new I({emptyViewModel:new b.Model({username:oa.get("username")}),model:oa,collection:a,isArchives:!0})):(a=new v([],g),f=new I({emptyViewModel:new b.Model({username:oa.get("username")}),model:oa,collection:a})),a.fetch(),e._hideProfileSidebar(),ra.detailbar.show(h),ra.container.show(f),f.on("badge:more",function(b){ra.showPagination(),f.more=da.block_function(f.more),a.fetch({remove:!1,page:b})}),a.on("fetch:done",function(){ra.hidePagination(),f.setNumberOfBadgesUnlocked(),f.more=da.unblock_function(f.more),f.render(),null!=c&&$("#badge-"+c+" a",f.$el).trigger("click")}),ya=f})},achievements:function(a,b){var c=this;this._redirect_to_login(),this._show(a),oa.on("change",function(){c._hideProfileSidebar();var d=new ma({userId:oa.id}),e=new na({userId:oa.id}),f=new ia,g=new ja({model:d,username:a}),h=new ka({model:d,username:a}),i=new la({model:e}),j=new ga({model:oa});ra.container.show(f),d.fetch(),e.fetch(),ra.detailbar.show(j),d.on("fetch:done",function(){f.badges.show(h),f.labels.show(g),null!=b&&$("#achievement-"+b,g.$el).trigger("click")}),e.on("fetch:done",function(){f.powers.show(i)})})},recent_gifts:function(c){var d=this;this._redirect_to_login(),this._show(c),oa.on("change",function(){d._hideProfileSidebar();var c=new w([],{type:1,username:oa.get("username")}),e=[],f=ra.$el.find(".container-profile"),g=new P;c.fetch({more:!1}),c.on("fetch:done",function(d){if(0==d.more){var h=new ba({total:0==d.totalResults||"undefined"==typeof d.totalResults?da.translate("user|recent_gifts_received",0):da.translate("user|recent_gifts_received",d.totalResults)});f.prepend(h.render().el)}d.listData.forEach(function(a){c.add(new L(a))});var i=d.listData;i=a.groupBy(i,function(a){var b=new Date(a.dateCreated),c=b.getFullYear(),d=b.getMonth();return c+"-"+d});var j=new w([],{type:1,username:oa.get("username")});if(a.isEmpty(i)){var k=new M({emptyViewModel:new b.Model({username:oa.get("username")}),model:oa,collection:j});e.push(k)}else for(var l in i)if(i.hasOwnProperty(l)){for(var m=0,n=i[l].length;n>m;m++)i[l][m].year_month_created=l,j.add(new L(i[l][m]));var o=new M({emptyViewModel:new b.Model({username:oa.get("username")}),model:oa,collection:j,createdYearMonth:l});e.push(o)}g.on("gift:monthly",function(a){for(var b=0,c=e.length;c>b;b++)a.append(e[b].render().el)}),0==d.listData.length&&1==d.more||f.append(g.render().el)}),oa.get("num_gifts_received")>ca.store.items.received.limit&&g.on("gift:more",function(a){ra.showPagination(),g.more=da.block_function(g.more),c.fetch({remove:!1,page:a,more:!0})}),c.on("fetch:done",function(){ra.hidePagination(),g.more=da.unblock_function(g.more)}),ya=g})},gifts:function(a){var c=this;this._redirect_to_login(),this._show(a),oa.on("change",function(){var a=new Q;a.on("gift:main",function(a){c._hideProfileSidebar();var d=new x([],{type:1,id:oa.get("id"),limit:4}),e=d.fetch();e.done(function(c){c.data.response.forEach(function(a){d.add(new L(a))});var e=new N({emptyViewModel:new b.Model({username:oa.get("username")}),username:oa.get("username"),model:oa,collection:d,indicationText:da.translate("user|favorite_gifts"),showMoreLink:!0});a.previewFavoriteGifts.show(e)});var f=new w([],{type:1,username:oa.get("username"),limit:4});f.fetch().done(function(c){if("undefined"!=typeof c.data){var d=new ba({total:da.translate("user|total_gifts",c.data.totalResults)});$(ra.container.el).prepend(d.render().el),c.data.listData.forEach(function(a){f.add(new L(a))})}var e=new M({emptyViewModel:new b.Model({username:oa.get("username")}),username:oa.get("username"),model:oa,collection:f,indicationText:da.translate("user|recent_gifts"),showMoreLink:!0});a.previewRecentGifts.show(e)})}),$(ra.container.el).append(a.render().el),ya=a})},favorite_gifts:function(c){var d=this,e=0;this._redirect_to_login(),this._show(c),oa.on("change",function(){d._hideProfileSidebar();var c=new x([],{type:1,id:oa.get("id")}),f=new O;c.fetch({more:!1});new ba({total:e});c.on("fetch:done",function(c){function d(a){h.add(new L(a))}var e=[],g=a.groupBy(c.response,function(a){var b=a.receivedTimeStamp.split(" "),c=new Date(b[0]);return c.getFullYear()+"-"+c.getMonth()}),h=new x([],{type:1,username:oa.get("username")});if(a.isEmpty(g)){var i=new N({emptyViewModel:new b.Model({username:oa.get("username")}),username:oa.get("username"),model:oa,collection:h});e.push(i)}else for(var j in g)if(g.hasOwnProperty(j)){g[j].forEach(d);var k=new N({emptyViewModel:new b.Model({username:oa.get("username")}),YearMonthReceived:j,username:oa.get("username"),model:oa,collection:h});e.push(k)}f.on("favoriteGift:monthly",function(a){e.forEach(function(b){a.append(b.render().el)})}),0==c.response.length&&1==c.more||ra.container.show(f)}),oa.get("num_gifts_received")>ca.store.items.received.limit&&f.on("gift:more",function(a){ra.showPagination(),f.more=da.block_function(f.more),c.fetch({remove:!1,page:a,more:!0})}),c.on("fetch:done",function(){ra.hidePagination(),f.more=da.unblock_function(f.more)}),ya=f})},groups:function(a){this._redirect_to_login(),this._show(a);var c=new o([],{type:"official"}),d=new D({
collection:c});c.setLimit(ca.profile.sidebar.limit),c.fetch(),c.on("fetch:done",function(){c.reset(c.first(ca.profile.sidebar.limit))}),oa.on("change",function(){ua.hideAvatarPanel(),ua.hideAboutPanel(),ua.showCustomPanel(),ua.hideInvitePanel(),ua.setCustomPanelTitle(da.translate("group|recommended_groups")),ua.setCustomPanelFooter("/group"),ua.panel_custom.show(d);var a=new o([],{type:"user_joined",userId:oa.get("id")});a.fetch();var c=new R({emptyViewModel:new b.Model({username:oa.get("username")}),model:oa,collection:a});ra.container.show(c),oa.get("num_groups_joined")>ca.profile.groups.limit&&c.on("group:more",function(){ra.showPagination(),c.more=da.block_function(c.more),a.nextPage(),a.fetch({remove:!1})}),a.on("fetch:done",function(){ra.hidePagination(),c.more=da.unblock_function(c.more)}),ya=c})},games:function(a){this._redirect_to_login(),this._show(a);var c=new o([],{type:"games"}),d=new D({collection:c});c.setLimit(ca.profile.sidebar.limit),c.fetch(),c.on("fetch:done",function(){c.reset(c.first(ca.profile.sidebar.limit))}),oa.on("change",function(){ua.hideAvatarPanel(),ua.hideAboutPanel(),ua.showCustomPanel(),ua.hideInvitePanel(),ua.setCustomPanelTitle(da.translate("game|recommended_games")),ua.setCustomPanelFooter("/group"),ua.panel_custom.show(d);var a=new n([],{type:"user_played",username:oa.get("username")});a.fetch();var c=new S({emptyViewModel:new b.Model({username:oa.get("username")}),model:oa,collection:a});ra.container.show(c),oa.get("num_games_played")>ca.profile.games.limit&&c.on("group:more",function(){ra.showPagination(),c.more=da.block_function(c.more),a.nextPage(),a.fetch({remove:!1})}),a.on("fetch:done",function(){ra.hidePagination(),c.more=da.unblock_function(c.more)}),ya=c})},chatrooms:function(a){this._redirect_to_login(),this._show(a),oa.on("change",function(){ua.hideAvatarPanel(),ua.hideAboutPanel(),ua.hideCustomPanel(),ua.hideInvitePanel();var a=new y([],{type:"own",username:oa.get("username")}),c=new y([],{type:"mod",username:oa.get("username")});a.fetch(),c.fetch();var d=new T({model:oa}),e=new U({emptyViewModel:new b.Model({username:oa.get("username"),type:"own"}),model:oa,collection:a}),f=new U({emptyViewModel:new b.Model({username:oa.get("username"),type:"mod"}),model:oa,collection:c});ra.container.show(d),d.own.show(e),d.mod.show(f),a.on("fetch:done",function(a){d.setChatroomTypeTotalCount("own",a.own.total),d.setChatroomTypeTotalCount("mod",a.mod.total),d.setChatroomTotalCount(a.own.total+a.mod.total)}),ya=e})},coverphoto:function(a){this._redirect_to_login(),this._show(a);var c=this;oa.on("change",function(){a===oa.get("username")&&a===oa.get("alias")||c._redirect_to_login(),ua.showAvatarPanel(),ua.showAboutPanel(),ua.hideCustomPanel(),ua.hideInvitePanel(),wa=new z([],{userId:oa.get("id")}),wa.fetch();var d=new V({emptyViewModel:new b.Model({username:oa.get("username")}),model:oa,collection:wa});ra.container.show(d),ya=d})},moveToReply:function(a){var b="post-reply-"+a;$("#"+b).offset()&&$("html, body").animate({scrollTop:$("#"+b).offset().top-$(window).height()/2})},moveToBottom:function(){$("html, body").animate({scrollTop:$(document).height()})},_fetchProfileSidebar:function(a){sa=new f({model:a}),ra.header.show(sa),ta=new g({model:a}),ra.detailbar.show(ta),ua=new h({model:a}),ra.sidebar.show(ua),ua.panel_invite.show(new X)},_fetchUserLeaderboard:function(a,c){var d=new q([],{userId:a.get("id"),username:a.get("username"),limit:1});d.fetch();var e=new _({emptyViewModel:new b.Model({username:a.get("username")}),username:a.get("username"),collection:d});c.user_fan_of.show(e)},_fetchArtistLeaderboard:function(a,c){var d=new p([],{userId:a.get("id"),username:a.get("username")}),e=new p([],{userId:a.get("id"),username:a.get("username"),limit:1});e.update("ALL","PREVIOUS_MONTHLY"),e.fetch(),Aa.stop(),Aa.clear(),Aa.start({scope:this,fireOnStart:!0,run:function(){d.fetch()},interval:ca.timer.leaderboard_poll}),ra.on("close",function(){Aa.stop()}),ra.on("change",function(){Aa.stop()});var f=new Y({emptyViewModel:new b.Model({username:a.get("username")}),username:a.get("username"),collection:d}),g=new Z({emptyViewModel:new b.Model({username:a.get("username")}),username:a.get("username"),collection:e});c.artist_fotm.show(g),c.artist_leaderboard.show(f),c.showArtistLeaderboardPanel()},_addInteractions:function(a,b){b=b||"replies";var c=a.parent_post.id;if(oa&&oa.profile_feed){var d=oa.profile_feed.where({id:c});if(d.length>0)for(var e=0;e<d.length;e++)d[e].set("num_of_"+b,d[e].get("num_of_"+b)+1),"replies"===b?(d[e].getReplies().add(a),$("#post-"+d[e].id).data("PostItemViewObject")?$("#post-"+d[e].id).data("PostItemViewObject").showReply(jQuery.Event("click")):this.moveToBottom()):d[e].getReshares().add(a)}},_removeInteractions:function(a,b){b=b||"replies";var c=a.get("parent_post").id;if(oa&&oa.profile_feed){var d=oa.profile_feed.where({id:c});if(d.length>0)for(var e=0;e<d.length;e++)d[e].set("num_of_"+b,d[e].get("num_of_"+b)-1),"replies"===b?d[e].getReplies().remove(d[e]):d[e].getReshares().remove(d[e])}}});return Ba}),define("hbs!modules/template/migalert/migalert-fulllist",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="col-sm-12 col-md-10 col-md-offset-1">\n	<div class="row">\n		<div class="col-xs-6 no-padding">\n			<div class="content-page-title">\n				<div class="font-size-12 font-bold">\n					<a href="/home" class="icon-wb_arrowLeft">\n						'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"common|home",g):i.call(b,"translate","common|home",g)))+'\n					</a>\n				</div>\n			</div>\n		</div>\n	</div>\n	<div class="row" id="migalerts-fulllist"></div>\n</div>'})}),define("hbs!modules/template/migalert/migalert-fulllist-collection",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="migalert-title">\n	'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"migalert|migalerts",g):i.call(b,"translate","migalert|migalerts",g)))+'\n</div>\n<ul id="migalerts-fulllist-list" class="list-unstyled"></ul>'})}),define("modules/view/migalert/migalert_fulllist_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/common/local_storage","modules/view/migalert/migalert_item_view","hbs!modules/template/migalert/migalert-fulllist-collection","modules/view/common/mig33_views","modules/template/helpers/general_helpers","modules/template/helpers/migalert_helpers"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=d.compile('{{translate "migalert|empty"}}'),n=d.compile('{{translate "common|loading"}}...'),o=e.ItemView.extend({template:{type:"handlebars",template:m},tagName:"li",className:"migalert-error"}),p=e.ItemView.extend({template:{type:"handlebars",template:n},className:"loading"}),q=l.CompositeView.extend({itemView:j,emptyView:o,loadingView:p,itemViewContainer:"#migalerts-fulllist-list",prevScrollY:0,template:{type:"handlebars",template:k},className:"migalerts-fulllist",initialize:function(){a.bindAll(this)},onRender:function(){var a="bottom";b(window).width()<768&&(a="left"),b(".migalert-setting a",this.$el).clickover({width:140,global_close:!0,placement:a,onShown:function(){null!==h.get_user_data("sound_notification")&&1!==parseInt(h.get_user_data("sound_notification"),10)||b('input[name="sound_notification"]').prop("checked",!0)}}),this.collection.hasMore()&&this.appendMore()},events:{"click .next":"fetchNextMigAlerts","click label":"migalertSettings"},fetchNextMigAlerts:function(a){a.preventDefault(),a.stopPropagation();var b,c=this;c.hideMore(),c.collection.nextPage(),b=c.collection.fetch({remove:!1,beforeSend:c.collection.setHeader})},migalertSettings:function(a){b('input[name="sound_notification"]',a.currentTarget).is(":checked")?h.set_user_data("sound_notification",1):h.set_user_data("sound_notification",0),a.stopPropagation()},hideMore:function(){b(this.itemViewContainer).find("li.alert-next").remove()},appendMore:function(){b(this.itemViewContainer).append('<li class="migalert alert-next"><a href="#" class="next">'+h.translate("common|load_more")+"</a></li>")}});return q}),define("modules/view/migalert/migalert_fulllist",["jquery","underscore","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/migalert/migalert-fulllist","modules/model/migalert/migalert_collection","modules/view/migalert/migalert_fulllist_collection_view","modules/common/utility","modules/common/session_user","modules/template/helpers/general_helpers","modules/template/helpers/post_helpers"],function(a,b,c,d,e,f,g,h,i,j,k){var l=e.Layout.extend({template:{type:"handlebars",template:g},templateHelpers:function(){return{cover_photo_url:j.getCoverphoto()}},regions:{migalertsFulllistCollection:"#migalerts-fulllist"},onRender:function(a){var b=new h,c=new i({collection:b});this.migalertsFulllistCollection.show(c),b.fetch({beforeSend:b.setHeader}),b.on("fetch:done",function(a){c.render()})}});return l}),define("modules/controller/migalert_controller",["underscore","backbone","backbone.marionette","modules/mig33_app","modules/common/config","modules/common/utility","modules/common/session_user","modules/chat/models/user_session","modules/view/migalert/migalert_fulllist"],function(a,b,c,d,e,f,g,h,i){var j=(h.Session.getInstance(),c.Controller.extend({index:function(){var a=new i;d.content.show(a)}}));return j}),define("hbs!modules/template/discover/discover-layout",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="col-md-3 sidebar sidebar-discover">\n	<div class="panel panel-hottopics">\n		<div class="panel-heading">\n			<h3 class="panel-title">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"discover|hot_topics",g):i.call(b,"translate","discover|hot_topics",g)))+'</h3>\n			<div class="panel-desc">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"discover|description",g):i.call(b,"translate","discover|description",g)))+'</div>\n		</div>\n		<div class="panel-body">\n		</div>\n	</div>\n	<div class="panel panel-hotpeople">\n		<div class="panel-heading">\n			<h3 class="panel-title">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"discover|hot_people",g):i.call(b,"translate","discover|hot_people",g)))+'</h3>\n			<div class="panel-desc">Follow these users to explore the best content migme has to offer</div>\n		</div>\n		<div class="hotpeople-section">\n			<a href="/discover/recommended_people"><div class="panel-subheading">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"discover|global_heading",g):i.call(b,"translate","discover|global_heading",g)))+'</div></a>\n			<div class="panel-body-global"></div>\n		</div>\n		<div class="hotpeople-section">\n			<a href="/discover/recommended_people_country"><div class="panel-subheading">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"discover|country_heading",g):i.call(b,"translate","discover|country_heading",g)))+'</div></a>\n			<div class="panel-body-country"></div>\n		</div>\n		<div class="hotpeople-section">\n			<a href="/discover/addressbook_users"><div class="panel-subheading">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"discover|addressbook_heading",g):i.call(b,"translate","discover|addressbook_heading",g)))+'</div></a>\n			<div class="panel-body-addressbook"></div>\n		</div>\n	</div>\n</div>\n<div class="col-md-7 content content-discover">\n	<div class="content-heading">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"discover|hot_people",g):i.call(b,"translate","discover|hot_people",g)))+'</div>\n	<div class="content-subheading">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"discover|description",g):i.call(b,"translate","discover|description",g)))+'</div>\n    <ul class="nav nav-tabs nav-justified tabs-discover">\n		<li class="discover-tab-recommended_people"><a href="/discover/recommended_people">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"discover|global_header",g):i.call(b,"translate","discover|global_header",g)))+'</a></li>\n		<li class="discover-tab-recommended_people_country"><a href="/discover/recommended_people_country">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"discover|country_header",g):i.call(b,"translate","discover|country_header",g)))+'</a></li>\n		<li class="discover-tab-addressbook_users"><a href="/discover/addressbook_users">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"discover|abc_header",g):i.call(b,"translate","discover|abc_header",g)))+'</a></li>\n    </ul>\n	<div class="discover"></div>\n	<div class="load-more">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"common|more",g):i.call(b,"translate","common|more",g)))+"</div>\n</div>"})}),define("modules/view/discover/discover_layout",["jquery","underscore","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/discover/discover-layout","modules/template/helpers/general_helpers","modules/template/helpers/group_helpers"],function(a,b,c,d,e,f,g){var h=e.Layout.extend({template:{type:"handlebars",template:g},className:"row",regions:{content:".discover",panel_hottopics:".panel-hottopics .panel-body",panel_global_rec:".panel-hotpeople .panel-body-global",panel_country_rec:".panel-hotpeople .panel-body-country",panel_addressbook_rec:".panel-hotpeople .panel-body-addressbook"},setActiveTab:function(b){a(".nav.nav-tabs",this.$el).show().find("li").removeClass("active").end().find("li.discover-tab-"+b).addClass("active")},hidePagination:function(){a(".load-more",this.$el).hide()},showPagination:function(){a(".load-more",this.$el).show()},setRecommendationHeading:function(b){a(".content-heading",this.$el).html(b)},setRecommendationSubheading:function(b){a(".content-subheading",this.$el).html(b)}});return h}),define("modules/view/discover/discover_user_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/view/discover/discover_user_item_view","modules/view/common/mig33_views","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i){var j=d.compile('{{translate "discover|empty_user"}}'),k=d.compile('{{translate "common|loading"}}...'),l=e.ItemView.extend({template:{type:"handlebars",template:j},className:"empty"}),m=e.ItemView.extend({template:{type:"handlebars",template:k},className:"loading"}),n=i.CollectionView.extend({itemView:h,emptyView:l,loadingView:m,tagName:"ul",className:"users list-unstyled thumbnails",initialize:function(){a.bindAll(this);var c=this;this.on("render",function(){b(window).on("scroll",function(a){c.more()})})},more:function(){var a=b(window).scrollTop()+b(window).height(),c=b(window).get(0).scrollHeight;c||(c=b(document).height()),a>=c-g.variable.infinitescroll_height&&this.prevScrollY<a&&this.trigger("recommended:more"),this.prevScrollY=a}});return n}),define("hbs!modules/template/containment/iframe",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i="function",j=this.escapeExpression;return h+='<script type="text/javascript">\n	$(document).ready(function() {\n	var nearToBottom = 50;\n	var windowheight = $(\'#iframe-migworld\').height();\n	var multiplier = 300;\n	var isScrolling = true;\n\n		$(window).scroll(function (e) {\n\n			if(isScrolling) {\n				if ($(window).scrollTop() + $(window).height() > $(document).height() - nearToBottom) {\n					var iframe = document.getElementById("iframe-migworld");\n					if(iframe) {\n						var iframeWin = iframe.contentWindow;\n						iframeWin.postMessage("scroll", "*");\n					}\n					//windowheight = windowheight + multiplier;\n					//$(\'#iframe-migworld\').height(windowheight);\n				}\n			}\n		});\n	});\nfunction on_load(ele) {\n	var doc = ele.contentDocument || ele.contentWindow.document;\n	if(doc) {\n		setTimeout(function() {\n			var docHeight = doc.body.scrollHeight;\n			$(ele).height(docHeight);\n		}, 100);\n	}\n}\n</script>\n\n<div class="span10">\n    <div class="containment" style="height: 100%;">\n        <iframe id="iframe-migworld" class="miniblog-iframe" style="width: 100%; padding: 0px; margin: 0px; border: 0px;" src="',(g=c.url)?f=g.call(b,{hash:{},data:e}):(g=b&&b.url,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'" onload="on_load(this);"></iframe>\n    </div>\n</div>\n\n<!-- Google Code for Peek Inside Conversion Page -->\n<script type="text/javascript">\n	/* <![CDATA[ */\n	var google_conversion_id = ',(g=c.get_peekinside_id)?f=g.call(b,{hash:{},data:e}):(g=b&&b.get_peekinside_id,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+';\n	var google_conversion_language = "en";\n	var google_conversion_format = "2";\n	var google_conversion_color = "ffffff";\n	var google_conversion_label = "',(g=c.get_peekinside_label)?f=g.call(b,{hash:{},data:e}):(g=b&&b.get_peekinside_label,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'";\n	var google_remarketing_only = false;\n	/* ]]> */\n</script>\n<!-- http://www.jakobbeyer.de/asynchronous-google-adwords-conversion-tracking -->\n<script>\n	// save old document.write\n	var oldDocumentWrite = document.write;\n\n	// change document.write temporary\n	document.write = function(node){\n		$("body").append(node);\n	}\n    // get script\n    $.getScript( "http://www.googleadservices.com/pagead/conversion.js", function() {\n        // replace the temp document.write with the original version\n        // setTimeout(function() {\n        //     document.write = oldDocumentWrite;\n        // }, 100)\n    });\n</script>\n\n</script>\n<noscript>\n	<div style="display:inline;">\n		<img height="1" width="1" style="border-style:none;" alt="" src="//www.googleadservices.com/pagead/conversion/',(g=c.get_peekinside_id)?f=g.call(b,{hash:{},data:e}):(g=b&&b.get_peekinside_id,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+"/?label=",(g=c.get_peekinside_label)?f=g.call(b,{hash:{},data:e}):(g=b&&b.get_peekinside_label,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'&amp;guid=ON&amp;script=0"/>\n	</div>\n</noscript>\n'})}),define("hbs!modules/template/common/generic-modal",["handlebars"],function(a){return a.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},'<div class="generic-modal-dialog">\n	<div class="generic-modal-content">\n		<div class="generic-modal-header">\n			<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>\n		</div>\n		<div class="generic-modal-body">\n			<div class ="generic-content"></div>\n		</div>\n	</div>\n</div>'})}),define("modules/view/common/generic_modal_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/common/generic-modal","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g){var h=e.Layout.extend({template:{type:"handlebars",template:g},id:"generic-modal",className:"generic-modal fade",regions:{container:".generic-content"}});return h}),define("hbs!modules/template/store/discover-store-item-virtualgift-detail",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+='\n			<img class="image" src="'+r((d=c.getStoreItemImage||a&&a.getStoreItemImage,e={hash:{},data:b},d?d.call(a,a,64,e):q.call(a,"getStoreItemImage",a,64,e)))+'" width="64" height="64" />\n		'}function g(a,b){var d,e,f="";return f+='\n			<img class = "image" src="'+r((d=c.getStoreItemImage||a&&a.getStoreItemImage,e={hash:{},data:b},d?d.call(a,a,64,e):q.call(a,"getStoreItemImage",a,64,e)))+'" width="64" height="64" class="greyscale-image" />\n		'}function h(a,b){var d,e,f="";return f+='\n				<span class="price">'+r((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"store|free",e):q.call(a,"translate","store|free",e)))+"</span>\n			"}function i(a,b){var d,e,f="";return f+='\n				<span class="price">',(e=c.localPrice)?d=e.call(a,{hash:{},data:b}):(e=a&&a.localPrice,d=typeof e===s?e.call(a,{hash:{},data:b}):e),f+=r(d)+" ",(e=c.localCurrency)?d=e.call(a,{hash:{},data:b}):(e=a&&a.localCurrency,d=typeof e===s?e.call(a,{hash:{},data:b}):e),f+=r(d)+"</span>\n			"}function j(a,b){var d,e,f,g="";return g+='\n	<div class="discover-vg-purchase-form-container">\n		<form class="discover-purchase-form" action="/store/item/',(e=c.id)?d=e.call(a,{hash:{},data:b}):(e=a&&a.id,d=typeof e===s?e.call(a,{hash:{},data:b}):e),g+=r(d)+'/purchase" method="post">\n			<div class="to">\n				'+r((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"discoverstore|who_send_item",f):q.call(a,"translate","discoverstore|who_send_item",f)))+'<br />\n				<input type="text" id="to" value="" disabled />\n			</div>\n			<div class="message">\n				'+r((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"discoverstore|add_a_message",f):q.call(a,"translate","discoverstore|add_a_message",f)))+'<br />\n				<textarea name="message" rows="3" cols="100"></textarea>\n			</div>\n			<div class="options">\n				<div class="row">\n					',e=c.compare||a&&a.compare,f={hash:{},inverse:t.noop,fn:t.program(10,k,b),data:b},d=e?e.call(a,a&&a.type,"VIRTUAL_GIFT",f):q.call(a,"compare",a&&a.type,"VIRTUAL_GIFT",f),(d||0===d)&&(g+=d),g+='\n					<div class="col-xs-5">\n						<div>\n							<input type="checkbox" name="post_to_miniblog" value="1" />&nbsp;&nbsp;'+r((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"store|post_to_miniblog",f):q.call(a,"translate","store|post_to_miniblog",f)))+'\n						</div>\n					</div>\n				</div>\n			</div>\n			<div class="send">\n				<input type="button" name="purchase_item" class="btn btn-xs btn-default" value="'+r((e=c.sendItemButton||a&&a.sendItemButton,f={hash:{},data:b},e?e.call(a,a,f):q.call(a,"sendItemButton",a,f)))+'" disabled />\n			</div>\n		</form>\n	</div>\n'}function k(a,b){var d,e,f="";return f+='\n						<div class="col-xs-4">\n							<div>\n								<input type="checkbox" name="private" value="1" />&nbsp;&nbsp;'+r((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"store|private_gift",e):q.call(a,"translate","store|private_gift",e)))+"\n							</div>\n						</div>\n					"}function l(a,b){var d,e,f="";return f+='\n	<div class="body">\n		<div class="error-title">',(e=c.getNotAllowedToPurchaseItemTitle)?d=e.call(a,{hash:{},data:b}):(e=a&&a.getNotAllowedToPurchaseItemTitle,d=typeof e===s?e.call(a,{hash:{},data:b}):e),f+=r(d)+'</div>\n		<div class="error-message">',(e=c.getNotAllowedToPurchaseItemMessage)?d=e.call(a,{hash:{},data:b}):(e=a&&a.getNotAllowedToPurchaseItemMessage,d=typeof e===s?e.call(a,{hash:{},data:b}):e),(d||0===d)&&(f+=d),f+="</div>\n	</div>\n"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var m,n,o,p="",q=c.helperMissing,r=this.escapeExpression,s="function",t=this,u=c.blockHelperMissing;return p+='<div class="discover-vg-detail">\n	<div class="discover-vg-detail-msg">'+r((n=c.translate||b&&b.translate,o={hash:{},data:e},n?n.call(b,"discoverstore|vgstore",o):q.call(b,"translate","discoverstore|vgstore",o)))+'</div>\n	<div class="image-container">\n		',o={hash:{},inverse:t.program(3,g,e),fn:t.program(1,f,e),data:e},(n=c.ifAllowedToBuyItem)?m=n.call(b,o):(n=b&&b.ifAllowedToBuyItem,m=typeof n===s?n.call(b,o):n),c.ifAllowedToBuyItem||(m=u.call(b,m,{hash:{},inverse:t.program(3,g,e),fn:t.program(1,f,e),data:e})),(m||0===m)&&(p+=m),p+='\n		<div class ="details">\n			<span class="title">',(n=c.name)?m=n.call(b,{hash:{},data:e}):(n=b&&b.name,m=typeof n===s?n.call(b,{hash:{},data:e}):n),p+=r(m)+"</span>\n			",n=c.compare||b&&b.compare,o={hash:{},inverse:t.program(7,i,e),fn:t.program(5,h,e),data:e},m=n?n.call(b,b&&b.price,0,o):q.call(b,"compare",b&&b.price,0,o),(m||0===m)&&(p+=m),p+="\n		</div>\n	</div>\n</div>\n",o={hash:{},inverse:t.program(12,l,e),fn:t.program(9,j,e),data:e},(n=c.ifAllowedToBuyItem)?m=n.call(b,o):(n=b&&b.ifAllowedToBuyItem,m=typeof n===s?n.call(b,o):n),c.ifAllowedToBuyItem||(m=u.call(b,m,{hash:{},inverse:t.program(12,l,e),fn:t.program(9,j,e),data:e})),(m||0===m)&&(p+=m),p})}),define("modules/view/store/discover_store_item_virtualgift_detail_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","modules/mig33_app","marionette_handlebars","modules/view/store/store_item_virtualgift_detail_item_view","hbs!modules/template/store/discover-store-item-virtualgift-detail","modules/common/config","modules/common/utility","jquery.tag-it","jquery.json","modules/template/helpers/general_helpers","jquery.scrollTo"],function(a,b,c,d,e,f,g,h,i,j,k){var l=h.extend({template:{type:"handlebars",template:i},events:{'click input[name="purchase_item"]':"purchaseitem"},purchaseitem:function(a){a.preventDefault(),b(a.currentTarget,this.$el).prop("disabled",!0);var c=this,d={to:b.trim(b("#to",this.$el).val()),message:b.trim(b('textarea[name="message"]',this.$el).val()),"private":(!!b('input[name="private"]:checked',this.$el).length).toString(),postToMiniblog:(!!b('input[name="post_to_miniblog"]:checked',this.$el).length).toString(),purchaseLocation:j.store.purchase_location.DISCOVER};""!==this.campaignId&&(d.counterId=this.campaignId);var e=this.model.purchase(d);e.done(function(e,f,g){return"undefined"==typeof e?!1:(e=k.parse_ajax_response(e),void("undefined"!=typeof e.id?c.trigger("purchase_success",d.to.split(",")):(e.error.indexOf("Insufficient")>-1?c.trigger("recharge_required"):e.error?c.trigger("general_error",e.error):k.show_error(k.translate("store|error_purchase",c.model.getTypeNiceNameSingular())),b(a.currentTarget,this.$el).prop("disabled",!1))))})}});return l}),define("hbs!modules/template/store/store-item-sticker-detail",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+='\n				<span class="price">'+r((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"store|free",e):q.call(a,"translate","store|free",e)))+"</span>\n			"}function g(a,b){var d,e,f="";return f+='\n				<span class="price">',(e=c.localPrice)?d=e.call(a,{hash:{},data:b}):(e=a&&a.localPrice,d=typeof e===s?e.call(a,{hash:{},data:b}):e),f+=r(d)+" ",(e=c.localCurrency)?d=e.call(a,{hash:{},data:b}):(e=a&&a.localCurrency,d=typeof e===s?e.call(a,{hash:{},data:b}):e),f+=r(d)+"</span>\n			"}function h(a,b){var d,e,f="";return f+="\n				",(e=c.description)?d=e.call(a,{hash:{},data:b}):(e=a&&a.description,d=typeof e===s?e.call(a,{hash:{},data:b}):e),f+=r(d)+"\n			"}function i(a,b){var d,e,f="";return f+='\n					<input type="button" name="purchase_item" class="btn btn-xs btn-default" value="'+r((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"common|download",e):q.call(a,"translate","common|download",e)))+'" />\n				'}function j(a,b){var d,e,f="";return f+='\n					<input type="button" name="purchase_item" class="btn btn-xs btn-default" value="'+r((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"common|buy",e):q.call(a,"translate","common|buy",e)))+'" />\n				'}function k(a,b){return'\n	<div class="body"></div>\n'}function l(a,b){var d,e,f="";return f+='\n	<div class="body">\n		<div class="error-title">',(e=c.getNotAllowedToPurchaseItemTitle)?d=e.call(a,{hash:{},data:b}):(e=a&&a.getNotAllowedToPurchaseItemTitle,d=typeof e===s?e.call(a,{hash:{},data:b}):e),f+=r(d)+'</div>\n		<div class="error-message">',(e=c.getNotAllowedToPurchaseItemMessage)?d=e.call(a,{hash:{},data:b}):(e=a&&a.getNotAllowedToPurchaseItemMessage,d=typeof e===s?e.call(a,{hash:{},data:b}):e),(d||0===d)&&(f+=d),f+="</div>\n	</div>\n"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var m,n,o,p="",q=c.helperMissing,r=this.escapeExpression,s="function",t=this,u=c.blockHelperMissing;return p+='<div class="detail clearfix">\n	<div class="image">\n		<img src="'+r((n=c.getStoreItemImage||b&&b.getStoreItemImage,o={hash:{},data:e},n?n.call(b,b,96,o):q.call(b,"getStoreItemImage",b,96,o)))+'" width="96" height="96" />\n	</div>\n	<div class="info">\n		<div class="title">\n			',(n=c.name)?m=n.call(b,{hash:{},data:e}):(n=b&&b.name,m=typeof n===s?n.call(b,{hash:{},data:e}):n),p+=r(m)+"\n			",n=c.compare||b&&b.compare,o={hash:{},inverse:t.program(3,g,e),fn:t.program(1,f,e),data:e},m=n?n.call(b,b&&b.price,0,o):q.call(b,"compare",b&&b.price,0,o),(m||0===m)&&(p+=m),p+='\n		</div>\n		<div class="description">\n			',m=c["if"].call(b,b&&b.description,{hash:{},inverse:t.noop,fn:t.program(5,h,e),data:e}),(m||0===m)&&(p+=m),p+='\n		</div>\n		<form class="purchase-form" action="/store/item/',(n=c.id)?m=n.call(b,{hash:{},data:e}):(n=b&&b.id,m=typeof n===s?n.call(b,{hash:{},data:e}):n),p+=r(m)+'/purchase" method="post">\n			<div class="send">\n				',n=c.compare||b&&b.compare,o={hash:{},inverse:t.program(9,j,e),fn:t.program(7,i,e),data:e},m=n?n.call(b,b&&b.price,0,o):q.call(b,"compare",b&&b.price,0,o),(m||0===m)&&(p+=m),p+="\n			</div>\n		</form>\n	</div>\n</div>\n",o={hash:{},inverse:t.program(13,l,e),fn:t.program(11,k,e),data:e},(n=c.ifAllowedToBuyItem)?m=n.call(b,o):(n=b&&b.ifAllowedToBuyItem,m=typeof n===s?n.call(b,o):n),c.ifAllowedToBuyItem||(m=u.call(b,m,{hash:{},inverse:t.program(13,l,e),fn:t.program(11,k,e),data:e})),(m||0===m)&&(p+=m),p+='\n<div class="sticker-preview"><img src="'+r((n=c.getStoreItemImage||b&&b.getStoreItemImage,o={hash:{},data:e},n?n.call(b,b,650,o):q.call(b,"getStoreItemImage",b,650,o)))+'" /></div>'})}),define("modules/view/store/store_item_sticker_detail_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","modules/mig33_app","marionette_handlebars","modules/view/store/store_item_detail_item_view","hbs!modules/template/store/store-item-sticker-detail","modules/common/config","modules/common/utility","jquery.tag-it","jquery.json","modules/template/helpers/general_helpers","jquery.scrollTo"],function(a,b,c,d,e,f,g,h,i,j,k){var l=h.extend({toUsername:"",template:{type:"handlebars",template:i},events:{'click input[name="purchase_item"]':"purchaseitem"},initialize:function(a){var b=this;f||(f=require("modules/mig33_app")),f.vent.on(f.ApplicationEvents.ACCOUNT_BALANCE,function(){b.checkAllowedToBuy(),b.allowedToBuyItemFromBalance()?b.enablePurchaseButton():b.disablePurchaseButton()})},onRender:function(){this.owned()?(this.disablePurchaseButton(),b(".purchase-form",this.$el).replaceWith('<button class="btn btn-xs btn-success disabled"><i class="icon-ok"></i>&nbsp;'+k.translate("common|owned")+"</button>")):this.allowedToBuyItemFromBalance()||this.disablePurchaseButton()},purchaseitem:function(a){a.preventDefault(),b(a.currentTarget,this.$el).prop("disabled",!0);var c=this,d=this.model.purchase({});d.done(function(d){return"undefined"==typeof d?!1:(d=k.parse_ajax_response(d),void("undefined"!=typeof d.id?(b(".purchase-form",c.$el).replaceWith('<div class="alert alert-success text-left">'+k.translate("store|success_title_sticker",c.model.get("name"))+"</div>"),b(".body",c.$el).hide()):(d.error?k.show_error(d.error):k.show_error(k.translate("store|error_purchase",c.model.getTypeNiceNameSingular())),b(a.currentTarget,this.$el).prop("disabled",!1))))})},enablePurchaseButton:function(){b('INPUT[name="purchase_item"]',this.$el).prop("disabled",!1)},disablePurchaseButton:function(){b('INPUT[name="purchase_item"]',this.$el).prop("disabled",!0)},owned:function(){return null!==this.model.get("referenceData")&&this.model.get("referenceData").owned}});return l}),define("hbs!modules/template/store/discover-store-item-purchase-success-layout",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],
c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="discover-purchase-success">\n	<div class="image"><img src="'+j((f=c.getUrl||b&&b.getUrl,g={hash:{},data:e},f?f.call(b,"jsclient",g):i.call(b,"getUrl","jsclient",g)))+'/app/images/mig.me/bot_celebrate.png" width="140" height="140" /></div>\n	<div class="details">\n		<div>'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"discoverstore|gift_sent",g):i.call(b,"translate","discoverstore|gift_sent",g)))+"</div>\n		<div>"+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"discoverstore|you_rock",g):i.call(b,"translate","discoverstore|you_rock",g)))+"</div>\n	</div>\n</div>"})}),define("modules/view/store/discover_store_item_purchase_success_layout",["jquery","underscore","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","hbs!modules/template/store/discover-store-item-purchase-success-layout","modules/template/helpers/general_helpers","modules/template/helpers/store_helpers"],function(a,b,c,d,e,f,g,h,i,j){var k=e.Layout.extend({template:{type:"handlebars",template:i},regions:{recipients:".recipients"}});return k}),define("hbs!modules/template/store/discover-store-item-recharge-required-layout",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="discover-recharge-required">\n	<div class="image"><img src="'+j((f=c.getUrl||b&&b.getUrl,g={hash:{},data:e},f?f.call(b,"jsclient",g):i.call(b,"getUrl","jsclient",g)))+'/app/images/mig.me/icon_nocredit.png" width="140" height="140" /></div>\n	<div class="details">\n		<div>'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"discoverstore|your_balance",b&&b.get_account_balance,b&&b.get_user_currency,g):i.call(b,"translate","discoverstore|your_balance",b&&b.get_account_balance,b&&b.get_user_currency,g)))+'</div>\n		<div class="recharge-msg">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"discoverstore|recharge_msg",g):i.call(b,"translate","discoverstore|recharge_msg",g)))+'</div>\n	</div>\n	<a id="recharge-now" href="#" class="popup">\n		<div class="recharge-button">\n			'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"discoverstore|recharge",g):i.call(b,"translate","discoverstore|recharge",g)))+"\n		</div>\n	</a>\n</div>"})}),define("modules/view/store/discover_store_item_recharge_required_layout",["jquery","underscore","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/globals/url","hbs!modules/template/store/discover-store-item-recharge-required-layout","modules/template/helpers/general_helpers","modules/template/helpers/store_helpers"],function(a,b,c,d,e,f,g,h,i,j,k){var l=e.Layout.extend({template:{type:"handlebars",template:j},events:{"click #recharge-now":"rechargeNow"},rechargeNow:function(b){return a("#generic-modal").modal("hide"),b.preventDefault(),window.open(document.location.protocol+"//"+document.location.hostname+"/credit","popup"),!1}});return l}),define("hbs!modules/template/store/discover-store-item-error-layout",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h,i="",j=c.helperMissing,k=this.escapeExpression,l="function";return i+='<div class="discover-recharge-required">\n	<div class="image"><img src="'+k((g=c.getUrl||b&&b.getUrl,h={hash:{},data:e},g?g.call(b,"jsclient",h):j.call(b,"getUrl","jsclient",h)))+'/app/images/mig.me/bot_kick_200.png" width="140" height="140" /></div>\n	<div class="details">\n		<div>',(g=c.error_message)?f=g.call(b,{hash:{},data:e}):(g=b&&b.error_message,f=typeof g===l?g.call(b,{hash:{},data:e}):g),i+=k(f)+'</div>\n	</div>\n	<a href="#" class="popup" data-dismiss="modal" aria-hidden="true">\n		<div class="recharge-button">\n			'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"common|close",h):j.call(b,"translate","common|close",h)))+"\n		</div>\n	</a>\n</div>"})}),define("modules/view/store/discover_store_item_error_layout",["jquery","underscore","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/globals/url","hbs!modules/template/store/discover-store-item-error-layout","modules/template/helpers/general_helpers","modules/template/helpers/store_helpers"],function(a,b,c,d,e,f,g,h,i,j,k){var l=e.Layout.extend({template:{type:"handlebars",template:j},events:{},initialize:function(){b.bindAll(this)},serializeData:function(){var a={error_message:this.options.error_message};return a}});return l}),define("hbs!modules/template/discover/discover-invite-view",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="discover-invite-modal">\n	<div class="discover-invite-modal-heading">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"discover|fb_invite_title",g):i.call(b,"translate","discover|fb_invite_title",g)))+'</div>\n	<div class="discover-invite-modal-body">\n		<!--<span class="icon-wb_mail font-size-24 font-color-warm-grey-light"></span>-->\n		<form action="/discover/invite" method="post">\n			<p class="discover-invite-msg">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"discover|invite_friends_via_email_description",g):i.call(b,"translate","discover|invite_friends_via_email_description",g)))+'</p>\n			<p class="discover-invite-emails"><input type="text" id="destinations" value="" /></p>\n			<p class="discover-invite-errormsg" style="display:none;">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"discover|fb_invite_email_required",g):i.call(b,"translate","discover|fb_invite_email_required",g)))+'</p>\n			<div class="discover-invite-button">\n				<p><input type="button" name="invite_friends" class="btn btn-md btn-default" value="'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"discover|invite_now_ext",g):i.call(b,"translate","discover|invite_now_ext",g)))+'"/></p>\n			</div>\n			<div class="discover-invite-or">\n				<div class="discover-invite-or-text">\n					OR\n				</div>\n				<div class="discover-invite-button">\n					<p><a href="#" class="fb-invite-dialog btn" title="'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"discover|invite_friends_via_facebook",g):i.call(b,"translate","discover|invite_friends_via_facebook",g)))+'">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"discover|invite_friends_via_facebook_ext",g):i.call(b,"translate","discover|invite_friends_via_facebook_ext",g)))+"</a></p>\n				</div>\n			</div>\n		</form>\n	</div>\n</div>"})}),define("modules/view/discover/discover_invite_view",["jquery","underscore","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/view/discover/discover_profile_sidebar_invite_view","hbs!modules/template/discover/discover-invite-view"],function(a,b,c,d,e,f,g,h){var i=g.extend({template:{type:"handlebars",template:h},events:{"click .fb-invite-dialog":"fBInviteDialogAndClose",'click input[name="invite_friends"]':"inviteFriendsAndClose"},fBInviteDialogAndClose:function(a){this.fBInviteDialog(a),this.closeModal(a)},inviteFriendsAndClose:function(a){var b=this.inviteFriends(a);b&&this.closeModal(a)},closeModal:function(b){a("#generic-modal").modal("hide")}});return i}),define("modules/view/containment/migworld_containment_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/mig33_app","hbs!modules/template/containment/iframe","modules/globals/session_user","modules/common/config","modules/common/utility","modules/common/nue","modules/view/common/generic_modal_view","modules/model/store/store_item_model","modules/view/store/discover_store_item_virtualgift_detail_item_view","modules/view/store/store_item_sticker_detail_item_view","modules/view/store/discover_store_item_purchase_success_layout","modules/view/store/discover_store_item_recharge_required_layout","modules/view/store/discover_store_item_error_layout","modules/view/discover/discover_invite_view","modules/model/store/store_item_collection"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u){var v=e.ItemView.extend({template:{type:"handlebars",template:h},className:"row",initialize:function(){c.history.firstLoad=!0},onRender:function(){var a=document.location.protocol+"//discover."+document.location.hostname,d=document.location.protocol+"//"+document.location.hostname,e=j.urls.gamecenter_root_url,f=j.urls.music_root_url,g=Array(a,d,e,f);b(window).on("message",function(d){if(-1!=b.inArray(d.originalEvent.origin,g)&&""!==d.originalEvent.data){var e=JSON.parse(d.originalEvent.data);if(e.height&&("100%"===e.height?b(".miniblog-iframe",this.$el).css("height",b(window).height()):b(".miniblog-iframe",this.$el).css("height",e.height),document.location.search.indexOf("cid=")>=0&&!k.is_logged_in())){var f=b(window).height(),h=b("body").height(),l=(h-f)/2+50;h>f&&setTimeout(function(){b("html, body").animate({scrollTop:l},700)},5e3)}if("undefined"!=typeof e.scroll_top&&0===e.scroll_top||b("html, body").animate({scrollTop:0},0),e.game_id&&(window.history.replaceState({title:"Games - migme"},"Games - migme","/games?id="+e.game_id),k.send_pageTrack_to_ga("/games?id="+e.game_id)),e.music_provider&&(window.history.replaceState({title:"Music - migme"},"Music - migme","/music/"+e.music_provider+"/"+e.music_type+"/"+e.music_id),k.send_pageTrack_to_ga("/music/"+e.music_provider+"/"+e.music_type+"/"+e.music_id)),e.add_music_favorite)if(k.is_logged_in()){var u={data:[{userFavoriteType:"MUSIC_CHANNEL",userFavorite:"deezer/radio/"+e.add_music_favorite}]};u=JSON.stringify(u);b.ajax({type:"post",contentType:"application/json",dataType:"json",url:k.format(j.urls.add_music_favorite,i.id),data:u,success:function(a){a=k.parse_ajax_response(a),a.error?k.show_error(k.translate("chat|load-message-error")):k.show_success(k.translate("chat|add_to_favourites"))},error:function(){k.show_error(k.translate("chat|load-message-error"))}})}else k.show_login_dialog();if(e.remove_music_favorite&&k.is_logged_in()){var v={data:[{userFavoriteType:"MUSIC_CHANNEL",userFavorite:"deezer/radio/"+e.remove_music_favorite}]};v=JSON.stringify(v);b.ajax({type:"post",contentType:"application/json",dataType:"json",url:k.format(j.urls.remove_music_favorite,i.id),data:v,success:function(a){a=k.parse_ajax_response(a),a.error?k.show_error(k.translate("chat|load-message-error")):k.show_success(k.translate("chat|remove_from_favourites"))},error:function(){k.show_error(k.translate("chat|load-message-error"))}})}if(e.music_favorite&&k.is_logged_in()){var w=b.ajax({type:"get",dataType:"json",url:k.format(j.urls.get_music_favorite,i.id)});w.done(function(a){if(a.error&&0!==a.error.errno)k.show_error(a.error);else{var b=document.getElementById("iframe-migworld");b.contentWindow.postMessage(a,"http://migme.github.io/music")}}),w.fail(function(a,b,c){k.show_error(c)})}if(e.share_music_id&&(k.is_logged_in()?k.show_share_dialog("music",{username:i.username,provider:e.share_music_provider,type:e.share_music_type,id:e.share_music_id}):k.show_login_dialog()),e.url){var x=e.url.substring(a.length);if(x=x.replace(/[&|?]?isLoggedIn=[0|1]?/gi,""),window.history.replaceState({title:"Discover - migme"},"Discover - migme","/discover/migworld?path="+x),b(".container-logged-out").length){var y=b("#signin-modal-signup").attr("href");y&&(y=y.substring(0,y.indexOf("?return_url="))+"?return_url="+encodeURIComponent(e.url),b("#signin-modal-signup").attr("href",y));var z=b("#signin-modal-form").attr("action");z&&(z=z.substring(0,z.indexOf("?return_url="))+"?return_url="+encodeURIComponent(e.url),b("#signin-modal-form").attr("href",z))}}if(e.refresh&&location.reload(),e.itemid&&e.username)if(k.is_logged_in()){var A=new n([],{item_id:e.itemid});A.fetch(),A.on("change",function(){var a=null;switch(A.get("type")){case"VIRTUAL_GIFT":a=new o({model:A});break;case"STICKER":a=new p({model:A})}e.username&&a.setToUsername(e.username),e.vote&&a.setCampaignId(e.vote);var d=new m;b("#main-container").after(d.render().el),d.container.show(a),a.on("purchase_success",function(a){for(var e=new q({model:A}),f=new c.Collection,g=0;g<a.length;g++)f.add(new c.Model({recipient:a[g]}));d.container.show(e),setTimeout(function(){b("#generic-modal").modal("hide")},2e3)}),a.on("recharge_required",function(){var a=new r;d.container.show(a)}),a.on("general_error",function(a){var b=new s({error_message:a});d.container.show(b)}),a.on("recharge_now",function(){b("#recharge-now").modal("hide")}),b("#generic-modal").modal("show"),k.send_event_to_ga("Discover Store","View Item","Item "+e.itemid)})}else k.show_login_dialog();if(e.chatroomName&&(k.is_logged_in()?(window.mig33.chatroom_manager&&window.mig33.chatroom_manager.join_chatroom(e.chatroomName),k.send_event_to_ga("Discover Chatroom","Join Chatroom",e.chatroomName)):(k.show_login_dialog(),k.send_event_to_ga("Discover Chatroom","Join Chatroom Notloggedin ",e.chatroomName))),e.action&&"signup"==e.action)if(k.is_logged_in()){var B=new t,C=new m;b("#main-container").after(C.render().el),C.container.show(B),b("#generic-modal").modal("show")}else k.show_login_dialog()}})}});return v}),define("modules/controller/discover_controller",["underscore","backbone","backbone.marionette","modules/mig33_app","modules/globals/url","modules/common/config","modules/common/utility","modules/common/session_user","modules/chat/models/user_session","modules/view/discover/discover_layout","modules/view/discover/discover_user_collection_view","modules/view/discover/discover_hashtag_layout","modules/view/discover/discover_homefeed_user_collection_view","modules/view/containment/migworld_containment_view","modules/model/discover/discover_user_collection"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){var p,q,r=null,s=(i.Session.getInstance(),c.Controller.extend({_createAndInitDiscoverLayout:function(){r=new j,r.on("close",function(){p=null})},_show:function(){null!==p&&p?p.close():(g.highlight_top_menu("discover"),this._createAndInitDiscoverLayout(),d.content.show(r))},initialize:function(){},index:function(){this._show();var a=new o([],{userId:h.getInstance().get("id")});a.resetPage(),a.fetch();var b=new k({collection:a});a.on("fetch:done",function(a){r.hidePagination(),b.more=g.unblock_function(b.more)}),b.on("recommended:more",function(){r.showPagination(),b.more=g.block_function(b.more),a.nextPage(),a.fetch({remove:!1})}),r.setRecommendationHeading(g.translate("discover|hot_people")),r.setRecommendationSubheading(g.translate("discover|description")),r.content.show(b),r.setActiveTab("recommended_people"),this._showHashtags(),this._showRecommendedUsers(),p=b},address_book:function(){this._show();var a=new o([],{userId:h.getInstance().get("id"),type:"addressbook"});a.resetPage(),a.fetch();var b=new k({collection:a});a.on("fetch:done",function(a){r.hidePagination(),b.more=g.unblock_function(b.more)}),b.on("recommended:more",function(){r.showPagination(),b.more=g.block_function(b.more),a.nextPage(),a.fetch({remove:!1})}),r.setRecommendationHeading(g.translate("discover|addresssbook_ppl")),r.setRecommendationSubheading(g.translate("discover|description_addressbook")),r.content.show(b),r.setActiveTab("addressbook_users"),this._showHashtags(),this._showRecommendedUsers(),p=b},recommended_users_by_country:function(){this._show();var a=new o([],{userId:h.getInstance().get("id"),type:"ur-country"});a.resetPage(),a.fetch();var b=new k({collection:a});a.on("fetch:done",function(a){r.hidePagination(),b.more=g.unblock_function(b.more)}),b.on("recommended:more",function(){r.showPagination(),b.more=g.block_function(b.more),a.nextPage(),a.fetch({remove:!1})}),r.setRecommendationHeading(g.translate("discover|hot_people_country")),r.setRecommendationSubheading(g.translate("discover|description_country")),r.content.show(b),r.setActiveTab("recommended_people_country"),this._showHashtags(),this._showRecommendedUsers(),p=b},migworld:function(a){g.highlight_top_menu("discover");var c=document.location.protocol+"//discover."+document.location.hostname;if("undefined"!=typeof a){var e=a.indexOf("?")<0?"?":"&";e+="isLoggedIn=",e+=g.is_logged_in()?1:0,c=c+a+e}d.content.show(new n({model:new b.Model({url:c})}))},_showHashtags:function(){q=new l,r.panel_hottopics.show(q)},_showRecommendedUsers:function(){var a=new o([],{userId:h.getInstance().get("id")});a.fetch(),a.on("fetch:done",function(){a.reset(a.getValid(3))});var b=new o([],{userId:h.getInstance().get("id"),type:"ur-country"});b.fetch(),b.on("fetch:done",function(){b.reset(b.getValid(3))});var c=new o([],{userId:h.getInstance().get("id"),type:"addressbook"});c.fetch(),c.on("fetch:done",function(){c.reset(c.getValid(3))});var d=new m({collection:a});r.panel_global_rec.show(d);var e=new m({collection:b});r.panel_country_rec.show(e);var f=new m({collection:c});r.panel_addressbook_rec.show(f)}}));return s}),define("modules/controller/gamecenter_controller",["underscore","backbone","backbone.marionette","modules/mig33_app","modules/globals/url","modules/common/config","modules/common/utility","modules/common/session_user","modules/chat/models/user_session","modules/view/containment/migworld_containment_view"],function(a,b,c,d,e,f,g,h,i,j){var k=(i.Session.getInstance(),c.Controller.extend({initialize:function(){},index:function(a){g.highlight_top_menu("play");var c=f.urls.gamecenter_url;"undefined"!=typeof a&&("/"==c.substr(-1)&&(c=f.urls.gamecenter_url.substr(0,f.urls.gamecenter_url.length-1)),c=c+"#game/"+a),d.content.show(new j({model:new b.Model({url:c})}))}}));return k}),define("modules/controller/music_controller",["underscore","backbone","backbone.marionette","modules/mig33_app","modules/globals/url","modules/common/config","modules/common/utility","modules/common/session_user","modules/chat/models/user_session","modules/view/containment/migworld_containment_view"],function(a,b,c,d,e,f,g,h,i,j){var k=(i.Session.getInstance(),c.Controller.extend({initialize:function(){},index:function(a,c,e){g.highlight_top_menu("music");var h=f.urls.music_url;"undefined"!=typeof e&&("/"==h.substr(-1)&&(h=f.urls.music_url.substr(0,f.urls.music_url.length-1)),h=h+"/#/"+a+"/"+c+"/"+e),d.content.show(new j({model:new b.Model({url:h})}))}}));return k}),define("hbs!modules/template/search/search-layout",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="col-md-3 sidebar sidebar-homefeed hidden">\n	<div class="panel panel-hottopics">\n		<div class="panel-heading">\n			<h3 class="panel-title">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"discover|hot_topics",g):i.call(b,"translate","discover|hot_topics",g)))+'</h3>\n		</div>\n		<div class="panel-body">\n		</div>\n	</div>\n	<div class="panel panel-hotpeople">\n		<div class="panel-heading">\n			<h3 class="panel-title">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"discover|hot_people",g):i.call(b,"translate","discover|hot_people",g)))+'</h3>\n		</div>\n		<div class="panel-body"></div>\n		<div class="panel-footer hotpeople-more font-size-12">\n			<a href="/discover/recommended_people">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"common|show_more",g):i.call(b,"translate","common|show_more",g)))+'</a>\n		</div>\n	</div>\n</div>\n<div class="col-xs-12 col-md-8 col-md-offset-2 no-padding content content-search">\n	<!-- <div class="content-heading">\n		'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"common|search",g):i.call(b,"translate","common|search",g)))+'\n	</div>\n	<div class="content-subheading">\n		'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"search|description",g):i.call(b,"translate","search|description",g)))+'\n	</div>\n	<div class="search-box">\n		<form class="search-form" action="/search" method="get" onsubmit="return false;">\n			<input type="hidden" name="location" value="users" />\n			<div class="row">\n				<div class="col-xs-12">\n					<div class="input-group">\n						<span class="input-group-btn">\n							<button class="btn btn-white search-form-submit" type="button"><span class="icon-wb_search font-size-14"></span></button>\n						</span>\n						<input class="form-control" name="search-form-query" type="text" placeholder="'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"header|search",g):i.call(b,"translate","header|search",g)))+'" value="" />\n					</div>\n				</div>\n			</div>\n		</form>\n	</div> -->\n	<div class="search-box visible-xs">\n		<div class="row">\n			<div class="col-xs-12">\n				<div class="input-group">\n					<span class="input-group-btn">\n						<button class="btn btn-white mobile-form-submit" type="button"><span class="icon-wb_search font-size-14"></span></button>\n					</span>\n					<input class="form-control" name="mobile-form-query" type="text" placeholder="'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"header|search",g):i.call(b,"translate","header|search",g)))+'" value="" />\n				</div>\n			</div>\n		</div>\n	</div>\n\n	<div class="row no-margin">\n		<div class="col-xs-12 no-padding">\n			<div class="content-page-title search-title hidden">\n				<div class="font-size-12 font-bold">\n					<a href="/search/users/">\n						< '+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"common|back",g):i.call(b,"translate","common|back",g)))+'\n					</a>\n				</div>\n				<h3 class="font-color-link font-light current-page-category no-margin">\n					'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"header|search",g):i.call(b,"translate","header|search",g)))+'\n				</h3>\n			</div>\n		</div>\n	</div>\n\n	<div class="search-tab-container">\n		<ul class="nav nav-tabs nav-justified tabs-homefeed">\n			<li class="search-tab-posts"><a data-searchtype="posts" href="#">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"homefeed|stories",g):i.call(b,"translate","homefeed|stories",g)))+'</a></li>\n			<li class="search-tab-users"><a data-searchtype="users" href="#">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"user|people",g):i.call(b,"translate","user|people",g)))+'</a></li>\n			<li class="search-tab-chatrooms"><a data-searchtype="chatrooms" href="#">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"homefeed|chatrooms",g):i.call(b,"translate","homefeed|chatrooms",g)))+'</a></li>\n			<!-- <li class="search-tab-topics"><a href="#">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"search|topics",g):i.call(b,"translate","search|topics",g)))+'</a></li> -->\n		</ul>\n	</div>\n	<div class="row">\n		<div class="col-xs-12">\n			<div class="search-results-stats"></div>\n		</div>\n	</div>\n	<div class="search-title-wrapper">\n		<div class="row">\n			<div class="col-xs-8">\n				<div class="search-title"></div>\n			</div>\n			<div class="col-xs-4 text-right">\n				<div class="search-count"></div>\n			</div>\n		</div>\n		<div class="search-subtitle font-size-12"></div>\n		<div class="search-postbox"></div>\n	</div>\n\n	<div class="search-results">\n		<div class="posts users"></div>\n	</div>\n	<div class="load-more">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"common|more",g):i.call(b,"translate","common|more",g)))+"</div>\n</div>"})}),jQuery.fn.highlight=function(a){function b(a,c){var d=0;if(3==a.nodeType){var e=a.data.toUpperCase().indexOf(c);if(e>=0){d=document.createElement("span"),d.className="highlight",e=a.splitText(e),e.splitText(c.length);var f=e.cloneNode(!0);d.appendChild(f),e.parentNode.replaceChild(d,e),d=1}}else if(1==a.nodeType&&a.childNodes&&!/(script|style)/i.test(a.tagName))for(e=0;e<a.childNodes.length;++e)e+=b(a.childNodes[e],c);return d}return this.length&&a&&a.length?this.each(function(){b(this,a.toUpperCase())}):this},jQuery.fn.removeHighlight=function(){return this.find("span.highlight").each(function(){with(this.parentNode.firstChild.nodeName,this.parentNode)replaceChild(this.firstChild,this),normalize()}).end()},define("jquery.highlight-4",["jquery"],function(){}),define("modules/view/search/search_layout",["jquery","underscore","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/utility","modules/view/common/postbox_view","hbs!modules/template/search/search-layout","modules/template/helpers/general_helpers","modules/template/helpers/group_helpers","jquery.highlight-4"],function(a,b,c,d,e,f,g,h,i){var j=e.Layout.extend({activeTab:"posts",template:{type:"handlebars",template:i},regions:{panel_hottopics:".panel-hottopics .panel-body",panel_hotpeople:".panel-hotpeople .panel-body",sharebox:".search-postbox",tab:".search-tab-container",container:".posts",pagination:".load-more"},events:{"click .mobile-form-submit":"searchEnter","click .search-tab-users a":"setActiveTabUsers","click .search-tab-posts a":"setActiveTabPosts","click .search-tab-chatrooms a":"setActiveTabChatrooms",'keyup input[name="mobile-form-query"]':"searchEnter"},showPagination:function(){a(".load-more",this.$el).show()},hidePagination:function(){a(".load-more",this.$el).hide()},showChatrooms:function(b){a(".sidebar-details .chatrooom-sidebar-control",this.$el).remove(),a(".sidebar-details",this.$el).prepend(b)},setActiveTabUsers:function(a){a.preventDefault(),this.doSearch("users")},setActiveTabPosts:function(a){a.preventDefault(),this.doSearch("posts")},setActiveTabChatrooms:function(a){a.preventDefault(),this.doSearch("chatrooms")},setActiveTab:function(b){this.activeTab=b,a(".search-tab-container .nav.nav-tabs",this.$el).show().find("li").removeClass("active").end().find("li.search-tab-"+b).addClass("active")},getActiveTab:function(a){return this.activeTab},searchEnter:function(b){if(13==b.keyCode){b.stopPropagation();var c=a.trim(a('input[name="mobile-form-query"]',this.$el).val()),d=a(".search-form");a('input[name="search-form-query"]',d).val(c),this.doSearch()}},doSearch:function(b){b=b?b:"posts";var d=a(".search-form"),e=(a('input[name="location"]',d).val(),a.trim(a('input[name="search-form-query"]',d).val())?a.trim(a('input[name="search-form-query"]',d).val()):g.get_query_params_by_name("query"));return("users"===b||"chatrooms"===b)&&e.length<3?(g.show_error("Search must be longer than 2 characters"),!1):(this.setActiveTab(b),void c.history.navigate("search/"+b+"/?query="+encodeURIComponent(e),{trigger:!0}))},setSearchResultsStats:function(b,c,d){var e=a(".search-form");a(".search-results-stats",this.$el).html(d),a('input[name="search-form-query"]',e).val(c),a('input[name="location"]',e).val(b,c),this.hightlightSearchTerms(b,c)},hightlightSearchTerms:function(b,c){var d;switch(b){case"users":d=a(".search-user-list",this.$el),a(".username a",d).highlight(c),a(".stats",d).highlight(c);break;case"topics":case"chatrooms":case"posts":d=a(".posts",this.$el),a(".post-author a",d).highlight(c),a(".post-text",d).highlight(c)}},topicsTweaks:function(b,c,d,e){var f=new h({});this.sharebox.show(f),a(".postbox",this.$el).removeClass("postbox-collapsed"),e||this.setTopicsPostboxHashtag(d);var i=a(".search-title-wrapper",this.$el);null!==d&&a(".search-title",i).text("#"+d),null!==c&&a("search-subtitle",i).text(c),a(".search-count",i).text(g.translate("search|results_found",g.add_thousands_seperator(b))),i.show(),a(".search-postbox",this.$el).show(),a(".search-results-stats",this.$el).hide(),a(".search-results-divider",this.$el).show()},removeTopicsTweaks:function(){this.sharebox&&this.sharebox.close(),a(".search-title-wrapper",this.$el).hide(),a(".search-postbox",this.$el).hide(),a(".search-results-stats",this.$el).show(),a(".search-results-divider",this.$el).hide()},setTopicsPostboxHashtag:function(b){a('.postbox textarea[name="body"]',this.$el).focus().val("#"+b+" ")}});return j}),define("modules/view/search/search_user_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/profile/follower-following-friend-list","modules/view/user/user_view","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j){var k=h.extend({template:{type:"handlebars",template:g},events:function(){return a.extend({},h.prototype.events,{"click .send-gift":"sendGift"})},onRender:function(){j.parse_profile_hovercard(this),h.prototype.onRender.apply(this,arguments)}});return k}),define("hbs!modules/template/search/search-user-collection",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+='\n<div class="faq-outline font-color-link connect-to-fb cursor_pointer margin-top-half">\n  <div class="col-xs-12 no-padding">\n    <img class="margin-right" src="'+l((d=c.getUrl||a&&a.getUrl,e={hash:{},data:b},d?d.call(a,"jsclient",e):k.call(a,"getUrl","jsclient",e)))+'/app/images/web/facebook_c.svg"/>\n    '+l((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"discover|connect_to_fb",e):k.call(a,"translate","discover|connect_to_fb",e)))+'\n    <span class="pull-right font-color-caption glyphicon glyphicon-triangle-right" aria-hidden="true"></span>\n  </div>\n</div>\n\n<div class="faq-outline font-color-link meet-at-random cursor_pointer margin-top-half">\n  <div class="col-xs-12 no-padding">\n    <img class="margin-right" src="'+l((d=c.getUrl||a&&a.getUrl,e={hash:{},data:b},d?d.call(a,"jsclient",e):k.call(a,"getUrl","jsclient",e)))+'/app/images/web/random.svg"/>\n    '+l((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"discover|meet_at_random",e):k.call(a,"translate","discover|meet_at_random",e)))+'\n    <span class="pull-right font-color-caption glyphicon glyphicon-triangle-right" aria-hidden="true"></span>\n  </div>\n</div>\n'}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var g,h,i,j="",k=c.helperMissing,l=this.escapeExpression,m=this,n="function",o=c.blockHelperMissing;return i={hash:{},inverse:m.noop,fn:m.program(1,f,e),data:e},(h=c.ifLoggedIn)?g=h.call(b,i):(h=b&&b.ifLoggedIn,g=typeof h===n?h.call(b,i):h),c.ifLoggedIn||(g=o.call(b,g,{hash:{},inverse:m.noop,fn:m.program(1,f,e),data:e})),(g||0===g)&&(j+=g),j+='\n\n<div class="faq-outline font-color-link invite-friends cursor_pointer margin-top-half">\n  <div class="col-xs-12 no-padding">\n    <img class="margin-right" src="'+l((h=c.getUrl||b&&b.getUrl,i={hash:{},data:e},h?h.call(b,"jsclient",i):k.call(b,"getUrl","jsclient",i)))+'/app/images/web/email.svg"/>\n    <span style="margin-left:-4px;">'+l((h=c.translate||b&&b.translate,i={hash:{},data:e},h?h.call(b,"discover|invite_friends_to_migme",i):k.call(b,"translate","discover|invite_friends_to_migme",i)))+'</span>\n    <span class="pull-right font-color-caption glyphicon glyphicon-triangle-right" aria-hidden="true"></span>\n  </div>\n</div>\n\n\n<div class="search-user-list">\n	<div id="facebook-list" class="hidden">\n    <h3 class="search-category left"></h3>\n    <div class="follow-all">+ '+l((h=c.translate||b&&b.translate,i={hash:{},data:e},h?h.call(b,"discover|follow_all",i):k.call(b,"translate","discover|follow_all",i)))+'</div>\n  </div>\n\n  <div class="clear"></div>\n  <br/>\n\n  <div id="friend-list" class="hidden">\n		<h3 class="search-category">Friends</h3>\n	</div>\n	<div id="recommended-list" class="hidden">\n		<h3 class="search-category">Recommended</h3>\n	</div>\n</div>'})}),define("modules/view/search/search_user_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/common/session_user","modules/view/search/search_user_item_view","modules/model/user/user_model","hbs!modules/template/search/search-user-collection","modules/view/common/mig33_views","modules/template/helpers/general_helpers","jquery.loadmask"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){
var n=d.compile('{{translate "search|users_none"}}'),o=d.compile('{{translate "common|loading"}}...'),p=e.ItemView.extend({template:{type:"handlebars",template:n},className:"empty"}),q=e.ItemView.extend({template:{type:"handlebars",template:o},className:"loading"}),r=m.CompositeView.extend({itemView:j,emptyView:p,loadingView:q,itemViewContainer:".search-user-list",itemViewContainerFriends:"#friend-list",itemViewContainerRecommended:"#recommended-list",template:{type:"handlebars",template:l},prevScrollY:0,page:1,fb_friends:!1,events:{"click .connect-to-fb":"connectToFB","click .meet-at-random":"meetAtRandom","click .invite-friends":"inviteFriends","click .follow-all":"followAll"},initialize:function(){a.bindAll(this,"more"),b(window).scroll(this.more)},appendHtml:function(a,c,d){var e=this.itemViewContainer,f=null;c.model.get("userRelationship")?f=c.model.get("userRelationship"):c.model.get("relationship")&&(f=c.model.get("relationship")),null!==f&&this.fb_friends===!1&&(f.is_friend||f.isFriend?(this.$("div#friend-list").removeClass("hidden"),e=this.itemViewContainerFriends):(this.$("div#recommended-list").removeClass("hidden"),e=this.itemViewContainerRecommended)),b(e).append(c.$el)},onRender:function(){},more:function(){var a=b(window).scrollTop()+b(window).height(),c=b(window).get(0).scrollHeight;c||(c=b(document).height()),this.fb_friends!==!0&&a>=c-g.variable.infinitescroll_height&&this.prevScrollY<a&&this.trigger("search:user:more",++this.page),this.prevScrollY=a},connectToFB:function(d){var e=this;d.preventDefault(),this.$el.mask(h.translate("common|loading"),10),h.track_navigate("/search/users/facebookFriends"),h.getFacebookFriends(function(d){var f={};f.username=i.getInstance().get("username"),f.facebookFriends=[],a.each(d.data,function(a){f.facebookFriends.push(a.id)}),b.ajax({url:g.urls.facebook_friending_url,method:"post",contentType:"application/json",data:JSON.stringify({data:f})}).then(function(a){if(e.$el.unmask(),a.data){var b=c.Collection.extend({model:k});e.collection=new b(a.data),e.fb_friends=!0,e.render(),e.trigger("search:user:facebook",a.data.length)}})})},meetAtRandom:function(a){a.preventDefault(),c.history.navigate("/search/users/meetrandom",{trigger:!0})},inviteFriends:function(a){a.preventDefault(),h.show_invite_friend_dialog()},followAll:function(c){if(this.fb_friends!==!0)return!1;var d=this,e=[];this.success_following=0,this.new_following=0,a.each(this.collection.models,function(a){if(a.get("userRelationshipData").follower!==!0){var c=a.get("id");d.new_following++,e.push(b.ajax({type:"post",cache:!1,dataType:"json",url:g.urls.miniblog_api_url+"/follow/"+c,success:function(a){a=h.parse_ajax_response(a),a.error||d.success_following++}}))}}),b.when.apply(b,e).then(function(){h.show_success(h.translate("discover|follow_success_message",d.success_following,d.new_following))})}});return r}),define("modules/view/search/search_post_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/view/homefeed/homefeed_post_item_view"],function(a,b,c,d,e,f,g,h,i){var j=i.extend({});return j}),define("modules/view/search/search_post_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/view/search/search_post_item_view","modules/view/common/mig33_views","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j){var k=d.compile('{{translate "search|posts_none"}}'),l=d.compile('{{translate "common|loading"}}...'),m=e.ItemView.extend({template:{type:"handlebars",template:k},className:"empty"}),n=e.ItemView.extend({template:{type:"handlebars",template:l},className:"loading"}),o=j.CollectionView.extend({itemView:i,emptyView:m,loadingView:n,initialize:function(){var a=this;this.on("render",function(){b(window).on("scroll",function(b){a.more()})}),this.on("close",function(){b(window).off("scroll")})},onRender:function(){h.createFancyBox(b(".fancybox",this.$el))},prevScrollY:0,page:1,more:function(){var a=b(window).scrollTop()+b(window).height(),c=b(window).get(0).scrollHeight;c||(c=b(document).height()),a>=c-g.variable.infinitescroll_height&&this.prevScrollY<a&&this.trigger("search:post:more",++this.page),this.prevScrollY=a}});return o}),define("modules/view/search/search_topic_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/view/homefeed/homefeed_post_item_view"],function(a,b,c,d,e,f,g,h,i){var j=i.extend({});return j}),define("modules/view/search/search_topic_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/view/search/search_topic_item_view","modules/view/common/mig33_views","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j){var k=d.compile('{{translate "search|topics_none"}}'),l=d.compile('{{translate "common|loading"}}...'),m=e.ItemView.extend({template:{type:"handlebars",template:k},className:"empty"}),n=e.ItemView.extend({template:{type:"handlebars",template:l},className:"loading"}),o=j.CollectionView.extend({itemView:i,emptyView:m,loadingView:n,initialize:function(){a.bindAll(this);var c=this;this.on("render",function(){b(window).on("scroll",function(a){c.more(a)})}),this.on("close",function(){b(window).off("scroll")})},onRender:function(){h.createFancyBox(b(".fancybox",this.$el))},prevScrollY:0,page:1,more:function(){var a=b(window).scrollTop()+b(window).height(),c=b(window).get(0).scrollHeight;c||(c=b(document).height()),a>=c-g.variable.infinitescroll_height&&this.prevScrollY<a&&this.trigger("search:topic:more",++this.page),this.prevScrollY=a}});return o}),define("hbs!modules/template/chatroom/chatroom-search-list",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+='\n				<img src="'+m((d=c.getGameImage||a&&a.getGameImage,e={hash:{},data:b},d?d.call(a,"48","48",e):l.call(a,"getGameImage","48","48",e)))+'" width="48" height="48" />\n			'}function g(a,b){return'\n				<img src="/sites/resources/images/icons/48/48_games.png" width="48" height="48" />\n			'}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var h,i,j,k="",l=c.helperMissing,m=this.escapeExpression,n=this,o="function";return k+='<div class="item-content">\n	<div class="row">\n		<div class="search-chatroom-image left">\n			',i=c.compare||b&&b.compare,j={hash:{},inverse:n.program(3,g,e),fn:n.program(1,f,e),data:e},h=i?i.call(b,b&&b.type,"GAME",j):l.call(b,"compare",b&&b.type,"GAME",j),(h||0===h)&&(k+=h),k+='\n		</div>\n		<div class="search-chatroom-detail">\n			<div class="col-xs-12 no-padding">\n				<a href="#" class="join-chatroom col-xs-12 no-padding">\n				<div class="name">',(i=c.name)?h=i.call(b,{hash:{},data:e}):(i=b&&b.name,h=typeof i===o?i.call(b,{hash:{},data:e}):i),k+=m(h)+'</div>\n				<div class="status">',(i=c.size)?h=i.call(b,{hash:{},data:e}):(i=b&&b.size,h=typeof i===o?i.call(b,{hash:{},data:e}):i),k+=m(h)+"/",(i=c.maximumSize)?h=i.call(b,{hash:{},data:e}):(i=b&&b.maximumSize,h=typeof i===o?i.call(b,{hash:{},data:e}):i),k+=m(h)+"</div>\n				</a>\n			</div>\n		</div>\n	</div>\n</div>"})}),define("modules/view/search/search_chatroom_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/view/chatroom/chatroom_profile_item_view","hbs!modules/template/chatroom/chatroom-search-list"],function(a,b,c,d,e,f,g,h,i,j){var k=i.extend({template:{type:"handlebars",template:j}});return k}),define("modules/view/search/search_chatroom_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/view/search/search_chatroom_item_view","modules/view/common/mig33_views","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j){var k=d.compile('{{translate "search|chatrooms_none"}}'),l=d.compile('{{translate "common|loading"}}...'),m=e.ItemView.extend({template:{type:"handlebars",template:k},className:"empty"}),n=e.ItemView.extend({template:{type:"handlebars",template:l},className:"loading"}),o=j.CollectionView.extend({itemView:i,emptyView:m,loadingView:n,initialize:function(){a.bindAll(this);var c=this;this.on("render",function(){b(window).on("scroll",function(a){c.more(a)})}),this.on("close",function(){b(window).off("scroll")})},onRender:function(){h.createFancyBox(b(".fancybox",this.$el))},prevScrollY:0,page:1,more:function(){var a=b(window).scrollTop()+b(window).height(),c=b(window).get(0).scrollHeight;c||(c=b(document).height()),a>=c-g.variable.infinitescroll_height&&this.prevScrollY<a&&this.trigger("search:chatroom:more",++this.page),this.prevScrollY=a}});return o}),define("hbs!modules/template/search/meet-random-list",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h,i="",j=c.helperMissing,k=this.escapeExpression,l="function";return i+='<div class="search-user-avatar left">\n  <div class="user-avatar">\n    <a href="'+k((g=c.getProfileUrl||b&&b.getProfileUrl,h={hash:{},data:e},g?g.call(b,b&&b.username,h):j.call(b,"getProfileUrl",b&&b.username,h)))+'" class="profile-hovercard" data-username="',(g=c.username)?f=g.call(b,{hash:{},data:e}):(g=b&&b.username,f=typeof g===l?g.call(b,{hash:{},data:e}):g),i+=k(f)+'">\n      <img src="'+k((g=c.userGetDisplayPictureUrl||b&&b.userGetDisplayPictureUrl,h={hash:{},data:e},g?g.call(b,40,40,b,h):j.call(b,"userGetDisplayPictureUrl",40,40,b,h)))+'" width="40" height="40" class="img-circle" />\n    </a>\n  </div>\n</div>'})}),define("modules/view/search/meet_random_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/search/meet-random-list","modules/view/user/user_view","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j){var k=h.extend({template:{type:"handlebars",template:g},events:function(){return a.extend({},h.prototype.events,{"click .send-gift":"sendGift"})},onRender:function(){h.prototype.onRender.apply(this,arguments)}});return k}),define("hbs!modules/template/search/meet-random-collection",["handlebars"],function(a){return a.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},'<div class="meet-random-user-list">\n</div>\n\n<div class="meet-random-selected hidden">\n  <div class="hovercard"></div>\n  <div class="chat-now cursorPointer">\n    <span class="icon-wb_chatbubble font-size-16"></span>\n    &nbsp;\n    Chat\n  </div>\n\n  <div class="meet-random-text">\n    Start chatting to get to know this person\n    <div class="meet-random-retry">\n      Or retry\n    </div>\n  </div>\n</div>'})}),define("modules/view/search/meet_random_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/common/session_user","modules/view/search/meet_random_item_view","modules/view/user/user_view","hbs!modules/template/search/meet-random-collection","modules/view/common/mig33_views","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=3e3,o=500,p=n,q=.05,r=5,s=d.compile('{{translate "search|users_none"}}'),t=d.compile('{{translate "common|loading"}}...'),u=e.ItemView.extend({template:{type:"handlebars",template:s},className:"empty"}),v=e.ItemView.extend({template:{type:"handlebars",template:t},className:"loading"}),w=m.CompositeView.extend({itemView:j,emptyView:u,loadingView:v,itemViewContainer:".meet-random-user-list",template:{type:"handlebars",template:l},events:{"click .meet-random-retry":"retry","click .meet-random-selected .chat-now":"chat"},initialize:function(){},onRender:function(){},retry:function(){this.startAnimation(),h.send_event_to_ga("Meet at Random","Find again retry")},startAnimation:function(){this.reset(),this.lightUp(this)},lightUp:function(a){r=Math.min(r,Math.ceil(a.children.length/8));for(var c=0;r>c&&!(b(".user:not('.active')",a.$el).length<=0);c++)for(;;){var d=Math.floor(Math.random()*a.children.length),e=a.children.findByIndex(d).$el;if(!e.hasClass("active")){e.addClass("active"),e.fadeTo(o,1,a.removeActive);break}}p>0?(p-=o,setTimeout(function(){a.lightUp(a)},o)):setTimeout(function(){a.done()},2*o)},done:function(){var a=this;p=n,a.children.each(function(a){a.$el.attr("style",""),a.$el.removeClass("active")});var b=Math.floor(Math.random()*a.children.length),c=a.children.findByIndex(b);c.$el.fadeTo(o,1),setTimeout(function(){a.showChosenOne(c)},o)},showChosenOne:function(a){var c=b(".meet-random-selected",this.$el);c.fadeTo(0,0),c.removeClass("hidden"),c.fadeTo(o,1);var d=new k({model:a.model});if(b(".meet-random-selected .hovercard",this.$el).html(d.render().el),b(window).width()>=768){var e=a.$el.position().top+a.$el.height()/2,f=a.$el.position().left+a.$el.width()/2;f+c.width()+200>b("#main").width()&&(f-=c.width()+a.$el.width()/2),c.css({top:e+"px",left:f+"px"})}},chat:function(){b(".meet-random-selected .hovercard .chat",this.$el).trigger("click"),h.send_event_to_ga("Chat","Meet at Random"),h.send_event_to_ga("Meet at Random","Start a Chat")},removeActive:function(){b(this).fadeTo(o,q,function(){b(this).removeClass("active"),b(this).attr("style","")})},reset:function(){this.children.each(function(a){a.$el.attr("style",""),a.$el.removeClass("active")}),b(".meet-random-selected",this.$el).addClass("hidden"),b(".meet-random-selected .hovercard",this.$el).html("")}});return w}),define("modules/model/search/search_user_collection",["modules/model/common/mig33_collection","modules/mig33_app","modules/common/config","modules/common/utility","modules/model/user/user_model","underscore"],function(a,b,c,d,e,f){var g=a.extend({model:e,initialize:function(a,b){this.options=b},url:function(){return c.urls.search+"/users/"+this.currentPage+"/?query="+this.options.query},parse:function(a){return null===a.data||f.isUndefined(a.data.results)||null===a.data.results?[]:a.data.results}});return g}),define("modules/model/search/search_post_collection",["modules/model/common/mig33_collection","modules/mig33_app","modules/common/config","modules/common/utility","modules/model/post/post_model","underscore"],function(a,b,c,d,e,f){var g=a.extend({model:e,initialize:function(a,b){this.options=b},url:function(){return c.urls.search+"/posts/"+this.currentPage+"/?query="+this.options.query},parse:function(a){return null===a.data||f.isUndefined(a.data.results)||null===a.data.results?[]:a.data.results}});return g}),define("modules/model/search/search_topic_collection",["modules/model/common/mig33_collection","modules/mig33_app","modules/common/config","modules/common/utility","modules/model/post/post_model","underscore"],function(a,b,c,d,e,f){var g=a.extend({model:e,initialize:function(a,b){this.options=b},url:function(){return c.urls.search+"/topics/"+this.currentPage+"/?query="+this.options.query},parse:function(a){return null===a.data||f.isUndefined(a.data.results)||null===a.data.results?[]:a.data.results}});return g}),define("modules/model/search/search_chatroom_collection",["modules/model/common/mig33_collection","modules/mig33_app","modules/common/config","modules/common/utility","modules/model/chatroom/chatroom_model","underscore"],function(a,b,c,d,e,f){var g=a.extend({model:e,initialize:function(a,b){this.options=b},url:function(){return d.format(c.urls.search_chatrooms,"SG",this.options.query,"EN",this.currentPage,this.limit)},parse:function(a){return null===a.data||f.isUndefined(a.data.chatrooms)||null===a.data.chatrooms?[]:a.data.chatrooms}});return g}),define("modules/model/search/meet_random_collection",["modules/model/common/mig33_collection","modules/mig33_app","modules/common/config","modules/common/utility","modules/model/user/user_model","underscore"],function(a,b,c,d,e,f){var g=a.extend({model:e,limit:c.search.meet_at_random.limit,initialize:function(a){"undefined"==typeof a&&(a={}),"undefined"==typeof a.limit&&(a.limit=this.limit),this.options=a},url:function(){return c.urls.friending_meet_random_url+"/?limit="+this.options.limit},parse:function(a){return null!==a&&!f.isUndefined(a.data)&&null!==a.data&&a.data.length?a.data.slice(0,this.options.limit):[]}});return g}),define("modules/controller/search_controller",["underscore","backbone","backbone.marionette","modules/mig33_app","modules/common/config","modules/common/utility","modules/common/session_user","modules/chat/models/user_session","modules/view/search/search_layout","modules/view/search/search_user_collection_view","modules/view/search/search_post_collection_view","modules/view/search/search_topic_collection_view","modules/view/search/search_chatroom_collection_view","modules/view/search/meet_random_collection_view","modules/view/discover/discover_hashtag_layout","modules/view/discover/discover_homefeed_user_collection_view","modules/model/search/search_user_collection","modules/model/search/search_post_collection","modules/model/search/search_topic_collection","modules/model/search/search_chatroom_collection","modules/model/search/meet_random_collection","modules/model/discover/discover_user_collection"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v){var w,x,y,z,A=null,B=null,C=!1,D=c.Controller.extend({_createAndInitSearchLayout:function(){A=new i,A.on("close",function(){B=null})},_show:function(){f.highlight_top_menu(""),this._hideSearchSubTitle(),null!==B&&B?B.close():(this._createAndInitSearchLayout(),d.content.show(A))},initialize:function(){d.vent.on(d.ApplicationEvents.POST_ADDED_DONE,function(a){null!==A&&"topics"===A.getActiveTab()&&A.setTopicsPostboxHashtag(f.get_query_params_by_name("query"))})},index:function(){},users:function(a){var b=this;a=a.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/^#/,""),this._show(),A.setActiveTab("users"),y=new q([],{query:a}),y.fetch(),z=new j({collection:y}),A.container.show(z),z.on("search:user:more",function(a){A.showPagination(),z.more=f.block_function(z.more),y.fetch({remove:!1,page:a})}),z.on("search:user:facebook",function(a){A.hidePagination(),b._showSearchSubTitle(f.translate("search|facebook_contacts")),$("#facebook-list h3",this.$el).text(f.translate("search|users_facebook",a)),$("#facebook-list",this.$el).removeClass("hidden")}),y.on("fetch:done",function(b){null===b.total&&(b.total=0),this.total=this.total?this.total+b.total:0+b.total,A.setSearchResultsStats("users",a,f.translate("search|users_found",this.total,a)),A.hidePagination(),A.removeTopicsTweaks(),this.total>e.search.users.limit?z.more=f.unblock_function(z.more):z.more=f.block_function(z.more)}),B=z},posts:function(a){a=a.replace(/</g,"&lt;").replace(/>/g,"&gt;"),this._show(),A.setActiveTab("posts");var b=new r([],{query:a});b.fetch();var c=new k({collection:b});A.container.show(c),c.on("search:post:more",function(a){A.showPagination(),c.more=f.block_function(c.more),b.fetch({remove:!1,page:a})}),b.on("fetch:done",function(b){null===b.total&&(b.total=0),A.setSearchResultsStats("posts",a,f.translate("search|posts_found",b.total,a)),A.hidePagination(),A.removeTopicsTweaks(),b.total>e.search.posts.limit?c.more=f.unblock_function(c.more):c.more=f.block_function(c.more)})},chatrooms:function(a){a=a.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/^#/,""),this._show(),A.setActiveTab("chatrooms");var b=new t([],{query:a});b.fetch();var c=new m({collection:b});A.container.show(c),c.on("search:chatroom:more",function(a){A.showPagination(),c.more=f.block_function(c.more),b.fetch({remove:!1,page:a}),C=!0}),b.on("fetch:done",function(b){A.setSearchResultsStats("chatrooms",a,f.translate("search|chatrooms_found",b.totalresults,a)),A.hidePagination(),b.totalresults>e.search.chatrooms.limit?c.more=f.unblock_function(c.more):c.more=f.block_function(c.more),C=!1})},topics:function(a){a=a.replace(/</g,"&lt;").replace(/>/g,"&gt;");var b="#"+a;this._show(),A.setActiveTab("posts");var c=new s([],{query:a});c.fetch();var d=new l({collection:c});A.container.show(d),d.on("search:topic:more",function(a){A.showPagination(),d.more=f.block_function(d.more),c.fetch({remove:!1,page:a}),C=!0}),c.on("fetch:done",function(a){null===a.total&&(a.total=0),A.setSearchResultsStats("topics",b,f.translate("search|posts_found",a.total,b)),A.hidePagination(),A.removeTopicsTweaks(),a.total>e.search.topics.limit?d.more=f.unblock_function(d.more):d.more=f.block_function(d.more),C=!1})},meetAtRandom:function(){this._show(),A.removeTopicsTweaks(),this._showSearchSubTitle(f.translate("discover|meet_at_random"));var a=new u;a.fetch();var b=new n({collection:a});A.container.show(b),b.on("search:random:next",function(c){A.showPagination(),b.more=f.block_function(b.more),a.fetch({remove:!1,page:c})}),a.on("fetch:done",function(a){b.startAnimation()}),B=b},_showHashtags:function(){w=new o,A.panel_hottopics.show(w)},_showRecommendedUsers:function(){var a=new v([],{userId:g.getInstance().get("id")});a.fetch(),a.on("fetch:done",function(){a.reset(a.first(5))}),x=new p({collection:a}),A.panel_hotpeople.show(x)},_showSearchSubTitle:function(a){$(".search-tab-container").hide(),$(".content-page-title.search-title .current-page-category").text(a),$(".content-page-title.search-title").removeClass("hidden"),$(".connect-to-fb",this.$el).hide(),$(".meet-at-random",this.$el).hide(),$(".invite-friends",this.$el).hide(),$(".search-results-stats",this.$el).hide(),$(".search-box").attr("style","display:none!important")},_hideSearchSubTitle:function(){$(".search-tab-container").show(),$(".content-page-title.search-title").addClass("hidden"),$(".search-box").attr("style","")}});return D}),define("modules/view/containment/migcore_containment_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/mig33_app","hbs!modules/template/containment/iframe","modules/common/config","modules/common/utility","modules/globals/session_user"],function(a,b,c,d,e,f,g,h,i,j,k){var l=25,m=e.ItemView.extend({template:{type:"handlebars",template:h},className:"row",initialize:function(){a.bindAll(this)},onRender:function(){var a=this,c=this.model.get("url"),d=document.location.protocol+"//discover."+document.location.hostname,e=document.location.protocol+"//"+document.location.hostname,f=i.urls.gamecenter_root_url,h=i.urls.music_root_url,k=Array(d,e,f,h);b(window).on("message",function(a){if(-1!=b.inArray(a.originalEvent.origin,k)&&""!==a.originalEvent.data){var c=JSON.parse(a.originalEvent.data);if("refreshUserDisplayPicture"===c.action){j.invalidate_display_picture_browser_cache();var d="_="+(new Date).getTime();b.each([".nav-profile img.img-circle",".chat-user-avatar img.img-circle",".dropdown-menu img.img-circle"],function(a,c){b(c).each(function(a){var c,e,f,g,h=b(this).attr("src");h&&(e=h.indexOf("_="),e>-1?(f=h.indexOf("&",e),g=f>-1?h.substring(e,f):h.substring(e),c=h.replace(g,d)):c=h+"&"+d,b(this).attr("src",c))})})}}}),this._iframe=b("iframe",this.$el),this._iframe.load(function(){if("undefined"!=typeof c){var d=document.createElement("a");if(d.href=c,"https:"===d.protocol)return;if("undefined"!=typeof document.location.hostname&&document.location.hostname!==d.hostname)return}var e=b(this).contents(),f=e.outerHeight(!0),h=e.outerHeight(!0),i=b(this).width();h>i&&(f+=l),b(this).css("height",f+"px"),g||(g=require("modules/mig33_app")),g.setup_link_hijacks(e),e.click(function(){b(a._iframe).click()}),a._applyContainmentStyle(this)})},_applyContainmentStyle:function(a){b(a).ready(function(){a.style.height=a.contentWindow.document.body.scrollHeight+"px",b(a).contents().find("body").css({"padding-top":"0px","margin-top":"0px",background:"#fff"}).end().find("#header").hide()})}});return m}),define("modules/controller/migcore_containment_controller",["underscore","backbone","backbone.marionette","modules/mig33_app","modules/common/utility","modules/view/containment/migcore_containment_view"],function(a,b,c,d,e,f){var g=c.Controller.extend({index:function(){var a=e.parse_location_href();window.postdata&&(this._href=e.appendQueryString(a,window.postdata)),this._href=this._href.replace(/\/v4\/(sites|debug)\//,"/$1/");var c=new f({model:new b.Model({url:this._href})});d.content.show(c),"/v4/sites/ajax/bot/bot_list"!==window.location.pathname&&"/v4/sites/ajax/leaderboard/home"!==window.location.pathname||e.highlight_top_menu("play")}});return g}),define("modules/view/containment/migbo_containment_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/mig33_app","hbs!modules/template/containment/iframe","modules/common/config","modules/common/utility"],function(a,b,c,d,e,f,g,h){var i=25,j=e.ItemView.extend({template:{type:"handlebars",template:h},className:"row",initialize:function(){a.bindAll(this)},onRender:function(){var a=this.model.get("url");this._iframe=b("iframe",this.$el),this._iframe.load(function(){if("undefined"!=typeof a){var c=document.createElement("a");if(c.href=a,"https:"===c.protocol)return;if("undefined"!=typeof document.location.hostname&&document.location.hostname!==c.hostname)return}var d=b(this).contents(),e=d.outerHeight(!0),f=d.outerHeight(!0),h=b(this).width();f>h&&(e+=i),b(this).css("height",e+"px"),g||(g=require("modules/mig33_app")),g.setup_link_hijacks(d),b(this).contents().find("form").each(function(a){var c=b(this).attr("action");c=c.indexOf("/sites/")>=0?c.replace(/\/wap\//,"/ajax/"):null!==c.match(new RegExp("^(((https?:)?//[^/]+)?/wap)(/.*)?$","i"))?c.replace(new RegExp("^(((https?:)?//[^/]+)?/wap)(/.*)?$","i"),"$1/bv4$4"):c.replace(new RegExp("^((https?:)?//[^/]+)?(/.*)?$","i"),"$1/wap/bv4$3"),b(this).attr("action",c)})})}});return j}),define("modules/controller/migbo_containment_controller",["underscore","backbone","backbone.marionette","modules/mig33_app","modules/common/utility","modules/view/containment/migbo_containment_view"],function(a,b,c,d,e,f){var g=c.Controller.extend({index:function(){var a=e.parse_location_href();if(null!==a.match(new RegExp("^(((https?:)?//[^/]+)?/wap)(/.*)?$","i"))&&(a=a.replace(/\/wap\//,"/")),null!==a.match(new RegExp("^(((https?:)?//[^/]+)?/web)(/.*)?$","i"))&&(a=a.replace(/\/web\//,"/")),null!==a.match(new RegExp("^(((https?:)?//[^/]+)?/search)(/.*)?$","i"))&&(a=a.replace("query=#","query=")),this._href=a.replace(new RegExp("^((https?:)?//[^/]+)?(/.*)?$","i"),"$1/wap/bv4$3"),"undefined"!=typeof this._href){var c="",g=this._href.replace(window.location.protocol+"//"+window.location.hostname+"/wap/bv4/","").split("/");"u"==g[0]?"undefined"!=typeof g[1]&&"undefined"!=typeof g[2]&&(c=g[2]+" - "+g[1]):c=g[0],c.length>1&&e.show_document_title(c.charAt(0).toUpperCase()+c.slice(1)+" - migme")}var h=new f({model:new b.Model({url:this._href})});d.content.show(h)}});return g}),define("hbs!modules/template/group/group-index-layout",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="col-md-10">\n    <div class="group">\n        <h1>'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"group|groups",g):i.call(b,"translate","group|groups",g)))+' <div class="pull-right"><a href="/v4/sites/ajax/group/create_group" class="chat btn btn-primary">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"group|create_a_group",g):i.call(b,"translate","group|create_a_group",g)))+'</a></div></h1>\n        <div class="clear"></div>\n\n        <h2>\n            '+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"group|my_groups_with_count","<span id='my-groups-count'>0</span>",g):i.call(b,"translate","group|my_groups_with_count","<span id='my-groups-count'>0</span>",g)))+'\n            <form class="navbar-search pull-right" action="/v4/sites/ajax/group/search">\n                <input type="text" class="search-query" name="name" placeholder="'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"group|search_all_groups",g):i.call(b,"translate","group|search_all_groups",g)))+'">\n            </form>\n        </h2>\n        <div class="my-groups groups"></div>\n\n        <div class="groups-recommendation">\n            <div class="groups-category pull-left">\n                <!-- <p class="active">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"group|all_groups",g):i.call(b,"translate","group|all_groups",g)))+'</p> -->\n                <p class="active">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"group|official_groups",g):i.call(b,"translate","group|official_groups",g)))+"</p>\n                <!-- <p>"+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"group|friends_groups",g):i.call(b,"translate","group|friends_groups",g)))+"</p>  -->\n                <!-- <p>"+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"group|games_groups",g):i.call(b,"translate","group|games_groups",g)))+'</p> -->\n            </div>\n            <div class="groups pull-left">\n                <!--\n                <div class="group-sort">\n                    <select name="group_sort">\n                        <option value="popular">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"group|group_sort_popular",g):i.call(b,"translate","group|group_sort_popular",g)))+'</option>\n                        <option value="time">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"group|group_sort_time",g):i.call(b,"translate","group|group_sort_time",g)))+'</option>\n                        <option value="activity">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"group|group_sort_activity",g):i.call(b,"translate","group|group_sort_activity",g)))+'</option>\n                    </select>\n                </div>\n                -->\n                <div class="official-groups"></div>\n            </div>\n        </div>\n        <div class="clear"></div>\n        <!--\n        <div class="group-more"><button class="chat btn btn-inverse" type="button">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"group|load_all_groups",g):i.call(b,"translate","group|load_all_groups",g)))+"</button></div>\n        -->\n    </div>\n</div>"})}),define("modules/view/group/group_index_layout",["jquery","underscore","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/group/group-index-layout","modules/template/helpers/general_helpers","modules/template/helpers/group_helpers"],function(a,b,c,d,e,f,g){var h=e.Layout.extend({template:{type:"handlebars",template:g},regions:{my_groups:".my-groups",official_groups:".official-groups"},className:"row",updateMyGroupsCount:function(b){a("#my-groups-count",this.$el).text(b)}});return h}),define("hbs!modules/template/group/group-details-layout",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="col-md-10">\n    <div class="group">\n        <div class="group-details"></div>\n        <div class="group-postbox-chatroooms">\n            <div class="group-chatrooms"></div>\n            <div class="clear"></div>\n        </div>\n    </div>\n</div>\n<div class="col-md-10">\n	<h2>'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"homefeed|posts",g):i.call(b,"translate","homefeed|posts",g)))+'</h2>\n	<div class="group-postbox"></div>\n	<div class="posts"></div>\n	<div class="load-more">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"common|more",g):i.call(b,"translate","common|more",g)))+"</div>\n</div>\n";
})}),define("modules/view/group/group_details_layout",["jquery","underscore","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/group/group-details-layout","modules/template/helpers/general_helpers","modules/template/helpers/group_helpers"],function(a,b,c,d,e,f,g){var h=e.Layout.extend({template:{type:"handlebars",template:g},className:"row",regions:{details:".group-details",postbox:".group-postbox",chatrooms:".group-chatrooms",container:".posts",pagination:".load-more"},showPagination:function(){a(".load-more",this.$el).show()},hidePagination:function(){a(".load-more",this.$el).hide()}});return h}),define("hbs!modules/template/group/group-members-layout",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){return'\n                &nbsp;<span class="group-official"><i class="ico ico-16 ico-group-official"></i></span>\n            '}function g(a,b){var d,e,f="";return f+='\n            <h2 id="pending-invites-title">'+m((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"group|pending_invites_with_count","<span id='group-pending-invites-count'>0</span>",e):l.call(a,"translate","group|pending_invites_with_count","<span id='group-pending-invites-count'>0</span>",e)))+'</h2>\n            <div id="pending-invites" class="group-members"></div>\n            <div class="clear"></div>\n        '}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var h,i,j,k="",l=c.helperMissing,m=this.escapeExpression,n="function",o=this;return k+='<div class="col-md-10">\n    <div class="group">\n        <div class="group-back"><a href="',(i=c.groupLink)?h=i.call(b,{hash:{},data:e}):(i=b&&b.groupLink,h=typeof i===n?i.call(b,{hash:{},data:e}):i),k+=m(h)+'">'+m((i=c.translate||b&&b.translate,j={hash:{},data:e},i?i.call(b,"group|back_to_group",j):l.call(b,"translate","group|back_to_group",j)))+"</a></div>\n        <h1>\n            ",(i=c.name)?h=i.call(b,{hash:{},data:e}):(i=b&&b.name,h=typeof i===n?i.call(b,{hash:{},data:e}):i),k+=m(h)+"\n            ",h=c["if"].call(b,b&&b.official,{hash:{},inverse:o.noop,fn:o.program(1,f,e),data:e}),(h||0===h)&&(k+=h),k+="\n        </h1>\n        ",h=c["if"].call(b,b&&b.session_user_admin,{hash:{},inverse:o.noop,fn:o.program(3,g,e),data:e}),(h||0===h)&&(k+=h),k+='\n\n        <h2 id="moderators-title">'+m((i=c.translate||b&&b.translate,j={hash:{},data:e},i?i.call(b,"group|moderators_with_count","<span id='group-moderators-count'>0</span>",j):l.call(b,"translate","group|moderators_with_count","<span id='group-moderators-count'>0</span>",j)))+'</h2>\n        <div id="moderators" class="group-members"></div>\n        <div class="clear"></div>\n\n        <h2 id="members-title">'+m((i=c.translate||b&&b.translate,j={hash:{},data:e},i?i.call(b,"group|members_with_count","<span id='group-members-count'>0</span>",j):l.call(b,"translate","group|members_with_count","<span id='group-members-count'>0</span>",j)))+'</h2>\n        <div id="members" class="group-members"></div>\n        <div class="clear"></div>\n        <div class="group-more"><button id="group-members-more" class="chat btn btn-inverse" type="button">'+m((i=c.translate||b&&b.translate,j={hash:{},data:e},i?i.call(b,"group|load_more_members",j):l.call(b,"translate","group|load_more_members",j)))+"</button></div>\n    </div>\n</div>"})}),define("modules/view/group/group_members_layout",["jquery","underscore","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/group/group-members-layout","modules/template/helpers/general_helpers","modules/template/helpers/group_helpers"],function(a,b,c,d,e,f,g){var h=e.Layout.extend({template:{type:"handlebars",template:g},regions:{pending_invites:"#pending-invites",moderators:"#moderators",members:"#members"},className:"row",triggers:{"click #group-members-more":"group:members:more"},hideMore:function(){a("#group-members-more",this.$el).hide()},hideGroupPendingInvitesTitle:function(){a("#pending-invites-title",this.$el).hide()},hideGroupModeratorsTitle:function(){a("#moderators-title",this.$el).hide()},updateGroupPendingInvitesCount:function(b){a("#group-pending-invites-count",this.$el).text(b)},updateGroupModeratorsCount:function(b){a("#group-moderators-count",this.$el).text(b)},updateGroupMembersCount:function(b){a("#group-members-count",this.$el).text(b)}});return h}),define("hbs!modules/template/group/group-list",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f,g="";return g+='\n            <img src="'+o((e=c.getUrl||a&&a.getUrl,f={hash:{},data:b},e?e.call(a,"image",f):n.call(a,"getUrl","image",f)))+"/",(e=c.display_file_id)?d=e.call(a,{hash:{},data:b}):(e=a&&a.display_file_id,d=typeof e===p?e.call(a,{hash:{},data:b}):e),g+=o(d)+'?w=80&h=80&a=1&c=1" />\n        '}function g(a,b){return'\n                &nbsp;<span class="group-official"><i class="ico ico-16 ico-group-official"></i></span>\n            '}function h(a,b){var d,e,f="";return f+="\n                "+o((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"group|likes",a&&a.likes,e):n.call(a,"translate","group|likes",a&&a.likes,e)))+"\n            "}function i(a,b){var d,e,f="";return f+="\n                "+o((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"group|likes_none",e):n.call(a,"translate","group|likes_none",e)))+"\n            "}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var j,k,l,m="",n=c.helperMissing,o=this.escapeExpression,p="function",q=this;return m+='<div class="group-item">\n    <div class="group-avatar">\n        ',j=c["if"].call(b,b&&b.display_file_id,{hash:{},inverse:q.noop,fn:q.program(1,f,e),data:e}),(j||0===j)&&(m+=j),m+='\n    </div>\n    <div class="group-content">\n        <div class="group-title">\n            ',(k=c.name)?j=k.call(b,{hash:{},data:e}):(k=b&&b.name,j=typeof k===p?k.call(b,{hash:{},data:e}):k),m+=o(j)+"\n            ",j=c["if"].call(b,b&&b.official,{hash:{},inverse:q.noop,fn:q.program(3,g,e),data:e}),(j||0===j)&&(m+=j),m+='\n        </div>\n        <div class="group-stats">\n            '+o((k=c.translate||b&&b.translate,l={hash:{},data:e},k?k.call(b,"group|members",b&&b.member_count,l):n.call(b,"translate","group|members",b&&b.member_count,l)))+"<br />\n            ",j=c["if"].call(b,b&&b.likes,{hash:{},inverse:q.program(7,i,e),fn:q.program(5,h,e),data:e}),(j||0===j)&&(m+=j),m+="\n        </div>\n    </div>\n</div>"})}),define("modules/view/group/group_item_view",["jquery","underscore","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/group/group-list","modules/common/config","modules/template/helpers/general_helpers","modules/template/helpers/group_helpers"],function(a,b,c,d,e,f,g){var h=e.ItemView.extend({template:{type:"handlebars",template:g},initialize:function(){this.model=this.options.model},id:function(){return"group-"+this.model.get("id")},className:function(){return"group-item-wrapper"},events:{"click .group-item":"goToGroup"},goToGroup:function(){this.model.goToGroup()}});return h}),define("hbs!modules/template/group/group-collection",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+='\n	<div class="clear"></div>\n	<div class="group-more">\n		<button id="my-groups-more" class="chat btn btn-inverse" type="button">'+l((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"group|load_more_groups",e):k.call(a,"translate","group|load_more_groups",e)))+"</button>\n	</div>\n"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var g,h,i,j="",k=c.helperMissing,l=this.escapeExpression,m=this;return j+='<div class="groups-container"></div>\n',h=c.compare||b&&b.compare,i={hash:{},inverse:m.noop,fn:m.program(1,f,e),data:e},g=h?h.call(b,b&&b.type,"user_joined",i):k.call(b,"compare",b&&b.type,"user_joined",i),(g||0===g)&&(j+=g),j})}),define("modules/view/group/group_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/view/group/group_item_view","hbs!modules/template/group/group-collection","modules/view/common/mig33_views","modules/template/helpers/general_helpers","modules/template/helpers/group_helpers"],function(a,b,c,d,e,f,g,h,i,j){var k=d.compile('{{translate "group|empty_groups"}}'),l=d.compile('{{translate "common|loading"}}...'),m=e.ItemView.extend({template:{type:"handlebars",template:k},className:"group-empty"}),n=e.ItemView.extend({template:{type:"handlebars",template:l},className:"loading"}),o=j.CompositeView.extend({itemView:h,emptyView:m,loadingView:n,itemViewContainer:".groups-container",template:{type:"handlebars",template:i},initialize:function(a){this.model=new c.Model({type:a.type})},triggers:{"click #my-groups-more":"group:my:more"},hideMore:function(){b(".group-more",this.$el).hide()}});return o}),define("hbs!modules/template/group/group-details",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){return'\n        &nbsp;<span class="group-official"><i class="ico ico-16 ico-group-official"></i></span>\n    '}function g(a,b){var d,e,f="";return f+='\n                <li><a href="#" class="leave-group">'+x((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"group|leave_group",e):w.call(a,"translate","group|leave_group",e)))+"</a></li>\n            "}function h(a,b){var d,e,f="";return f+='\n                <li><a href="#" class="leave-group" style="display: none;">'+x((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"group|leave_group",e):w.call(a,"translate","group|leave_group",e)))+"</a></li>\n            "}function i(a,b){var d,e,f,g="";return g+='\n                <li class="divider"></li>\n                <li><a href="/v4/sites/ajax/group/setting?cid=',(e=c.id)?d=e.call(a,{hash:{},data:b}):(e=a&&a.id,d=typeof e===y?e.call(a,{hash:{},data:b}):e),g+=x(d)+'">'+x((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"group|group_settings",f):w.call(a,"translate","group|group_settings",f)))+"</a></li>\n            "}function j(a,b){var d,e,f,g="";return g+='\n            <img src="'+x((e=c.getUrl||a&&a.getUrl,f={hash:{},data:b},e?e.call(a,"image",f):w.call(a,"getUrl","image",f)))+"/",(e=c.display_file_id)?d=e.call(a,{hash:{},data:b}):(e=a&&a.display_file_id,d=typeof e===y?e.call(a,{hash:{},data:b}):e),g+=x(d)+'?w=256&h=256&a=1&c=1" />\n        '}function k(a,b){var d,e;return x((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"group|public_group",e):w.call(a,"translate","group|public_group",e)))}function l(a,b){var d,e;return x((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"group|by_approval_group",e):w.call(a,"translate","group|by_approval_group",e)))}function m(a,b){var d,e,f,g="";return g+='\n            <p><a href="/sites/wap/opensocial/start_app?appid=',(e=c.client_id)?d=e.call(a,{hash:{},data:b}):(e=a&&a.client_id,d=typeof e===y?e.call(a,{hash:{},data:b}):e),g+=x(d)+'" class="btn btn-large btn-primary">'+x((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"game|play_game",f):w.call(a,"translate","game|play_game",f)))+"</a></p>\n        "}function n(a,b){var d,e,f="";return f+='\n            <p class="request-status">'+x((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"group|pending_approval",e):w.call(a,"translate","group|pending_approval",e)))+"</p>\n        "}function o(a,b){var d,e,f,g="";return g+="\n            ",d=c["if"].call(a,a&&a.session_user_member,{hash:{},inverse:z.program(22,q,b),fn:z.program(20,p,b),data:b}),(d||0===d)&&(g+=d),g+='\n            <p class="request-status" style="display: none;">'+x((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"group|pending_approval",f):w.call(a,"translate","group|pending_approval",f)))+"</p>\n        "}function p(a,b){var d,e,f="";return f+='\n                <p><a href="#" class="join-group btn btn-large btn-primary" style="display: none;">',(e=c.groupJoinText)?d=e.call(a,{hash:{},data:b}):(e=a&&a.groupJoinText,d=typeof e===y?e.call(a,{hash:{},data:b}):e),f+=x(d)+"</a></p>\n            "}function q(a,b){var d,e,f="";return f+='\n                <p><a href="#" class="join-group btn btn-large btn-primary">',(e=c.groupJoinText)?d=e.call(a,{hash:{},data:b}):(e=a&&a.groupJoinText,d=typeof e===y?e.call(a,{hash:{},data:b}):e),f+=x(d)+"</a></p>\n            "}function r(a,b){var d,e,f,g="";return g+='\n        <p class="invite">\n            <i class="ico ico-24 ico-group-invite pull-left"></i>\n            &nbsp;<span class="group-stats-title"><a href="/sites/ajax/group/invite_contact?cid=',(e=c.id)?d=e.call(a,{hash:{},data:b}):(e=a&&a.id,d=typeof e===y?e.call(a,{hash:{},data:b}):e),g+=x(d)+'">'+x((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"common|invite",f):w.call(a,"translate","common|invite",f)))+"</a></span>\n        </p>\n        "}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var s,t,u,v="",w=c.helperMissing,x=this.escapeExpression,y="function",z=this;return v+='<h1 class="clearfix">\n    ',(t=c.name)?s=t.call(b,{hash:{},data:e}):(t=b&&b.name,s=typeof t===y?t.call(b,{hash:{},data:e}):t),v+=x(s)+"\n    ",s=c["if"].call(b,b&&b.official,{hash:{},inverse:z.noop,fn:z.program(1,f,e),data:e}),(s||0===s)&&(v+=s),v+='\n    <div class="dropdown pull-right">\n	<a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="ico ico-24 ico-window-settings"></i></a>\n        <ul class="dropdown-menu">\n            ',s=c["if"].call(b,b&&b.session_user_member,{hash:{},inverse:z.program(5,h,e),fn:z.program(3,g,e),data:e}),(s||0===s)&&(v+=s),v+='\n            <li><a href="/v4/sites/ajax/report/report_abuse?gn=',(t=c.name)?s=t.call(b,{hash:{},data:e}):(t=b&&b.name,s=typeof t===y?t.call(b,{hash:{},data:e}):t),v+=x(s)+"&cid=",(t=c.id)?s=t.call(b,{hash:{},data:e}):(t=b&&b.id,s=typeof t===y?t.call(b,{hash:{},data:e}):t),v+=x(s)+'&type=5" class="report-group">'+x((t=c.translate||b&&b.translate,u={hash:{},data:e},t?t.call(b,"group|report_group",u):w.call(b,"translate","group|report_group",u)))+'</a></li>\n            <li><a href="/v4/sites/ajax/group/home?cid=',(t=c.id)?s=t.call(b,{hash:{},data:e}):(t=b&&b.id,s=typeof t===y?t.call(b,{hash:{},data:e}):t),v+=x(s)+'">'+x((t=c.translate||b&&b.translate,u={hash:{},data:e},t?t.call(b,"group|view_old_features",u):w.call(b,"translate","group|view_old_features",u)))+"</a></li>\n            ",s=c["if"].call(b,b&&b.session_user_admin,{hash:{},inverse:z.noop,fn:z.program(7,i,e),data:e}),(s||0===s)&&(v+=s),v+='\n        </ul>\n    </div>\n</h1>\n<div class="group-header">\n    <div class="group-avatar">\n        ',s=c["if"].call(b,b&&b.display_file_id,{hash:{},inverse:z.noop,fn:z.program(9,j,e),data:e}),(s||0===s)&&(v+=s),v+='\n    </div>\n    <div class="group-details">\n        <p>',(t=c.description)?s=t.call(b,{hash:{},data:e}):(t=b&&b.description,s=typeof t===y?t.call(b,{hash:{},data:e}):t),v+=x(s)+"</p>\n        <p>\n            <strong>"+x((t=c.translate||b&&b.translate,u={hash:{},data:e},t?t.call(b,"group|type_colon",u):w.call(b,"translate","group|type_colon",u)))+"</strong> ",t=c.compare||b&&b.compare,u={hash:{},inverse:z.program(13,l,e),fn:z.program(11,k,e),data:e},s=t?t.call(b,b&&b.type,"OPEN",u):w.call(b,"compare",b&&b.type,"OPEN",u),(s||0===s)&&(v+=s),v+="<br />\n            <strong>"+x((t=c.translate||b&&b.translate,u={hash:{},data:e},t?t.call(b,"group|created_colon",u):w.call(b,"translate","group|created_colon",u)))+"</strong> "+x((t=c.mysqlDateFormat||b&&b.mysqlDateFormat,u={hash:{},data:e},t?t.call(b,b&&b.date_created,u):w.call(b,"mysqlDateFormat",b&&b.date_created,u)))+"<br />\n            <strong>"+x((t=c.translate||b&&b.translate,u={hash:{},data:e},t?t.call(b,"group|owner_colon",u):w.call(b,"translate","group|owner_colon",u)))+'</strong> <a href="'+x((t=c.getProfileUrl||b&&b.getProfileUrl,u={hash:{},data:e},t?t.call(b,b&&b.created_by,u):w.call(b,"getProfileUrl",b&&b.created_by,u)))+'" title="',(t=c.created_by)?s=t.call(b,{hash:{},data:e}):(t=b&&b.created_by,s=typeof t===y?t.call(b,{hash:{},data:e}):t),v+=x(s)+'" class="profile-hovercard" data-username="',(t=c.created_by)?s=t.call(b,{hash:{},data:e}):(t=b&&b.created_by,s=typeof t===y?t.call(b,{hash:{},data:e}):t),v+=x(s)+'">',(t=c.created_by)?s=t.call(b,{hash:{},data:e}):(t=b&&b.created_by,s=typeof t===y?t.call(b,{hash:{},data:e}):t),v+=x(s)+"</a><br />\n            <strong>"+x((t=c.translate||b&&b.translate,u={hash:{},data:e},t?t.call(b,"group|moderator_colon",u):w.call(b,"translate","group|moderator_colon",u)))+"</strong> ",(t=c.groupModerators)?s=t.call(b,{hash:{},data:e}):(t=b&&b.groupModerators,s=typeof t===y?t.call(b,{hash:{},data:e}):t),(s||0===s)&&(v+=s),v+="\n        </p>\n\n        ",s=c["if"].call(b,b&&b.client_id,{hash:{},inverse:z.noop,fn:z.program(15,m,e),data:e}),(s||0===s)&&(v+=s),v+="\n\n        ",s=c["if"].call(b,b&&b.request_exists,{hash:{},inverse:z.program(19,o,e),fn:z.program(17,n,e),data:e}),(s||0===s)&&(v+=s),v+='\n    </div>\n    <div class="group-stats">\n        <p>\n            <i class="ico ico-24 ico-group-member pull-left"></i>\n            &nbsp;<span class="group-stats-title"><a href="',(t=c.groupLink)?s=t.call(b,{hash:{},data:e}):(t=b&&b.groupLink,s=typeof t===y?t.call(b,{hash:{},data:e}):t),v+=x(s)+'/members">'+x((t=c.translate||b&&b.translate,u={hash:{},data:e},t?t.call(b,"group|members",b&&b.member_count,u):w.call(b,"translate","group|members",b&&b.member_count,u)))+'</a></span>\n        </p>\n        <p>\n            <i class="ico ico-24 ico-group-like pull-left"></i>\n            &nbsp;<span class="group-stats-title">'+x((t=c.translate||b&&b.translate,u={hash:{},data:e},t?t.call(b,"group|likes",b&&b.likes,u):w.call(b,"translate","group|likes",b&&b.likes,u)))+"</span>\n        </p>\n        ",s=c["if"].call(b,b&&b.session_user_member,{hash:{},inverse:z.noop,fn:z.program(24,r,e),data:e}),(s||0===s)&&(v+=s),v+='\n    </div>\n    <div class="clear"></div>\n</div>'})}),define("modules/view/group/group_item_detail_view",["jquery","underscore","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/group/group-details","modules/common/utility","modules/template/helpers/general_helpers","modules/template/helpers/group_helpers"],function(a,b,c,d,e,f,g,h){var i=e.ItemView.extend({template:{type:"handlebars",template:g},events:{"click .join-group":"joinGroup","click .leave-group":"leaveGroup"},onRender:function(){h.parse_profile_hovercard(this)},joinGroup:function(b){if(h.is_logged_in())if(b.preventDefault(),"OPEN"!==this.model.get("type")){var c=this.model.sendInviteRequest();c.done(function(){a(".join-group",this.$el).hide(),a(".request-status",this.$el).show()})}else{var d=this.model.join();d.done(function(){a(".join-group",this.$el).hide(),a(".leave-group",this.$el).show()})}},leaveGroup:function(b){if(h.is_logged_in()){b.preventDefault();var c=this.model.leave();c.done(function(){a(".join-group",this.$el).show(),a(".leave-group",this.$el).hide()})}}});return i}),define("hbs!modules/template/group/group-postbox",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f,k="";return k+='\n	<div class="col-xs-12">\n		<div class="postbox">\n			<form action="post" method="post" accept-charset="utf-8" enctype="multipart/form-data">\n				<input type="hidden" name="originality" value="1" />\n				<input type="hidden" name="group_id" value="',(e=c.group_id)?d=e.call(a,{hash:{},data:b}):(e=a&&a.group_id,d=typeof e===t?e.call(a,{hash:{},data:b}):e),k+=u(d)+'" />\n\n				\n				<div class="postbox-progress-wrapper">\n					<div class="row">\n						<div class="col-xs-12">\n							<div class="bar"></div>\n						</div>\n					</div>\n				</div>\n\n				\n				<div class="postbox-content">\n					<div class="row postbox-body-media">\n						<div class="col-xs-10 no-padding-right postbox-body-wrapper-col">\n							<div class="postbox-body-wrapper">\n								<div class="postbox postbox-dragdrop-text">'+u((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"homefeed|postbox_drop_image",f):v.call(a,"translate","homefeed|postbox_drop_image",f)))+'</div>\n						        <textarea class="postbox-textarea form-control" name="body" rows="5" cols="30" placeholder="'+u((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"group|postbox_insert_groupid",(d=a&&a.trigger_char,null==d||d===!1?d:d.group),a&&a.group_id,f):v.call(a,"translate","group|postbox_insert_groupid",(d=a&&a.trigger_char,null==d||d===!1?d:d.group),a&&a.group_id,f)))+'">'+u((d=a&&a.trigger_char,d=null==d||d===!1?d:d.group,typeof d===t?d.apply(a):d)),(e=c.group_id)?d=e.call(a,{hash:{},data:b}):(e=a&&a.group_id,d=typeof e===t?e.call(a,{hash:{},data:b}):e),k+=u(d)+' </textarea>\n							    <div class="postbox-media-wrapper">\n								        <a href="#" class="close hidden">&times;</a>\n								        <input type="file" name="media" accept="image/*" class="postbox-media-upload" style="display: none;" />\n\n								        <img class="postbox-media hidden" />\n 				        	\n							        <div class="postbox-count">\n							        	<span class="postbox-charcount">		\n							        	',d=c["if"].call(a,(d=a&&a.session_user,d=null==d||d===!1?d:d.label,null==d||d===!1?d:d.verified),{hash:{},inverse:w.program(4,h,b),fn:w.program(2,g,b),data:b}),(d||0===d)&&(k+=d),k+='\n							        	</span>\n					        		</div>\n					        		<div class="clear"></div>\n						        </div>\n							</div>\n						</div>\n					</div>\n\n					\n					<div class="postbox-footer">\n						<div class="row">\n							<div class="col-xs-1">\n								<div class="postbox-media-option text-right">\n									<a href="#"\n									   class="insert-emoticons"\n									   data-toggle="clickover"\n									   data-placement="bottom"\n									   data-html="true"\n									   data-animation="false"\n									   data-content="',d=a&&a.variables,d=null==d||d===!1?d:d.emoticons,d=typeof d===t?d.apply(a):d,d=x.call(a,d,{hash:{},inverse:w.noop,fn:w.program(6,i,b),data:b}),(d||0===d)&&(k+=d),k+='"\n											>\n										<span class="icon-wb_emoticon font-color-grey" title="'+u((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"homefeed|emotions",f):v.call(a,"translate","homefeed|emotions",f)))+'"></span>\n									</a>\n								</div>\n							</div>\n							<div class="col-xs-9 text-right">\n								',e=c.ifSessionUserSettingsThirdPartySite||a&&a.ifSessionUserSettingsThirdPartySite,f={hash:{},inverse:w.noop,fn:w.program(8,j,b),data:b},d=e?e.call(a,"status|twitter",f):v.call(a,"ifSessionUserSettingsThirdPartySite","status|twitter",f),(d||0===d)&&(k+=d),k+="\n								",e=c.ifSessionUserSettingsThirdPartySite||a&&a.ifSessionUserSettingsThirdPartySite,f={hash:{},inverse:w.noop,fn:w.program(13,m,b),data:b},d=e?e.call(a,"status|facebook",f):v.call(a,"ifSessionUserSettingsThirdPartySite","status|facebook",f),(d||0===d)&&(k+=d),k+='\n								<!-- <div class="dropdown postbox-post-privacy postbox-media-option">\n									<a href="#" title="'+u((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"post|post_privacy_settings",f):v.call(a,"translate","post|post_privacy_settings",f)))+'" data-toggle="dropdown">\n										<span class="postbox-post-privacy-selected">'+u((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"common|public",f):v.call(a,"translate","common|public",f)))+'</span>&nbsp;&nbsp;&nbsp;<span class="icon-wb_arrowDown font-size-12"></span>\n									</a>\n									<ul class="dropdown-menu">\n										<li><label class="postbox-post-privacy-select"><input type="radio" name="privacy" value="0" checked="checked" />&nbsp;&nbsp;&nbsp;'+u((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"common|public",f):v.call(a,"translate","common|public",f)))+'</label></li>\n										<li><label class="postbox-post-privacy-select"><input type="radio" name="privacy" value="1" />&nbsp;&nbsp;&nbsp;'+u((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"homefeed|postbox_friends_only",f):v.call(a,"translate","homefeed|postbox_friends_only",f)))+'</label></li>\n										<li><label class="postbox-post-privacy-select"><input type="radio" name="privacy" value="2" />&nbsp;&nbsp;&nbsp;'+u((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|myself",f):v.call(a,"translate","user|myself",f)))+"</label></li>\n										",e=c.ifSystemPropertyEnabled||a&&a.ifSystemPropertyEnabled,f={hash:{},inverse:w.noop,fn:w.program(18,p,b),data:b},d=e?e.call(a,"post_reply_permission",f):v.call(a,"ifSystemPropertyEnabled","post_reply_permission",f),(d||0===d)&&(k+=d),k+='\n									</ul>\n								</div> -->\n								<div class="postbox-showreplyinfeed postbox-media-option hidden">\n									<label>\n										<input type="checkbox" name="show_reply_in_feed" value="1" />&nbsp;&nbsp;&nbsp;'+u((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"homefeed|postbox_also_share",f):v.call(a,"translate","homefeed|postbox_also_share",f)))+'\n									</label>\n								</div>\n							</div>\n							<div class="col-xs-2 no-padding-left" style="padding-right: 14px;">\n								<div class="postbox-submit">\n									<input type="button" class="btn btn-xs btn-default" name="post" value="'+u((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"common|share",f):v.call(a,"translate","common|share",f)))+'" />\n								</div>\n							</div>\n						</div>\n					</div>\n				</div>\n			</form>\n		</div>\n	</div>\n'}function g(a,b){var c,d="";return d+="\n							        		"+u((c=a&&a.variables,c=null==c||c===!1?c:c.characters_count,c=null==c||c===!1?c:c.long_post,typeof c===t?c.apply(a):c))+"\n							        	"}function h(a,b){var c,d="";return d+="\n							        		"+u((c=a&&a.variables,c=null==c||c===!1?c:c.characters_count,c=null==c||c===!1?c:c.normal_post,typeof c===t?c.apply(a):c))+"\n							        	"}function i(a,b){var d,e,f="";return f+="<a href='#' class='insert-emoticon' data-emoticon='",(e=c.hotkey)?d=e.call(a,{hash:{},data:b}):(e=a&&a.hotkey,d=typeof e===t?e.call(a,{hash:{},data:b}):e),f+=u(d)+"'><img width='16' height='16' title='",(e=c.name)?d=e.call(a,{hash:{},data:b}):(e=a&&a.name,d=typeof e===t?e.call(a,{hash:{},data:b}):e),f+=u(d)+"' alt='",(e=c.name)?d=e.call(a,{hash:{},data:b}):(e=a&&a.name,d=typeof e===t?e.call(a,{hash:{},data:b}):e),f+=u(d)+"' src='",(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===t?e.call(a,{hash:{},data:b}):e),f+=u(d)+"' /></a>"}function j(a,b){var d,e,f,g="";return g+='\n									<div class="postbox-twitter-field postbox-media-option">\n										',e=c.ifSessionUserSettingsThirdPartySite||a&&a.ifSessionUserSettingsThirdPartySite,f={hash:{},inverse:w.program(11,l,b),fn:w.program(9,k,b),data:b},d=e?e.call(a,"linked|twitter",f):v.call(a,"ifSessionUserSettingsThirdPartySite","linked|twitter",f),(d||0===d)&&(g+=d),g+="\n									</div>\n									&nbsp;&nbsp;\n								"}function k(a,b){return'\n											<input type="hidden" name="post_to_twitter" value="0" />\n											<span class="icon-wb_twitter font-color-grey font-size-20 post-to-twitter"></span>\n										'}function l(a,b){var d,e,f="";return f+='\n											<input type="hidden" name="post_to_twitter" value="0" />\n											<a href="'+u((d=c.getUrl||a&&a.getUrl,e={hash:{},data:b},d?d.call(a,"settings",e):v.call(a,"getUrl","settings",e)))+'/connect_apps" title="'+u((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"homefeed|postbox_to_twitter",e):v.call(a,"translate","homefeed|postbox_to_twitter",e)))+'"><span class="icon-wb_twitter font-size-20 font-color-grey"></span></a>\n										'}function m(a,b){var d,e,f,g="";return g+='\n									<div class="postbox-facebook-field postbox-media-option">\n										',e=c.ifSessionUserSettingsThirdPartySite||a&&a.ifSessionUserSettingsThirdPartySite,f={hash:{},inverse:w.program(16,o,b),fn:w.program(14,n,b),data:b},d=e?e.call(a,"linked|facebook",f):v.call(a,"ifSessionUserSettingsThirdPartySite","linked|facebook",f),(d||0===d)&&(g+=d),g+="\n									</div>\n									&nbsp;&nbsp;\n								"}function n(a,b){return'\n											<input type="hidden" name="post_to_facebook" value="0" />\n											<span class="icon-wb_facebook font-color-grey font-size-20 post-to-facebook"></span>\n										'}function o(a,b){var d,e,f="";return f+='\n											<input type="hidden" name="post_to_facebook" value="0" />\n											<a href="'+u((d=c.getUrl||a&&a.getUrl,e={hash:{},data:b},d?d.call(a,"settings",e):v.call(a,"getUrl","settings",e)))+'/connect_apps" title="'+u((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"homefeed|postbox_to_facebook",e):v.call(a,"translate","homefeed|postbox_to_facebook",e)))+'"><span class="icon-wb_facebook font-size-20 font-color-grey"></span></a>\n										'}function p(a,b){var d,e,f="";return f+='\n											<li class="divider"></li>\n											<li><label><input type="checkbox" name="reply_permission" value="0" checked="checked" />&nbsp;&nbsp;&nbsp;'+u((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"homefeed|postbox_allow_replies",e):v.call(a,"translate","homefeed|postbox_allow_replies",e)))+"</label></li>\n										"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var q,r,s,t="function",u=this.escapeExpression,v=c.helperMissing,w=this,x=c.blockHelperMissing;return s={hash:{},inverse:w.noop,fn:w.program(1,f,e),data:e},(r=c.ifLoggedIn)?q=r.call(b,s):(r=b&&b.ifLoggedIn,q=typeof r===t?r.call(b,s):r),c.ifLoggedIn||(q=x.call(b,q,{hash:{},inverse:w.noop,fn:w.program(1,f,e),data:e})),q||0===q?q:""})}),define("modules/view/group/group_postbox_view",["underscore","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/group/group-postbox","modules/view/common/postbox_view","modules/common/utility","modules/globals/session_user","modules/globals/variable","modules/template/helpers/general_helpers","modules/template/helpers/group_helpers"],function(a,b,c,d,e,f,g,h,i,j){var k=g.extend({initialize:function(){a.bindAll(this),k.__super__.initialize.apply(this,arguments)},template:function(){var a=this;return f({avatar_url:h.is_logged_in()?h.get_display_picture_url(i.username):"",session_user:i,variables:j,trigger_char:a.trigger_char,group_id:a.options.group_id})}});return k}),define("hbs!modules/template/group/group-chatroom-list",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i="function",j=this.escapeExpression;return h+='<li><i class="ico ico-12 ico-chatroom"></i> <a href="#" data-chatroom="',(g=c.name)?f=g.call(b,{hash:{},data:e}):(g=b&&b.name,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'">',(g=c.name)?f=g.call(b,{hash:{},data:e}):(g=b&&b.name,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+"</a> (",(g=c.total_users)?f=g.call(b,{hash:{},data:e}):(g=b&&b.total_users,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+"/",(g=c.max_users)?f=g.call(b,{hash:{},data:e}):(g=b&&b.max_users,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+")</li>"})}),define("modules/view/group/group_chatroom_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/group/group-chatroom-list","modules/common/config","modules/common/utility","modules/chat/models/chatrooms","modules/template/helpers/general_helpers","modules/template/helpers/group_helpers"],function(a,b,c,d,e,f,g,h,i,j){var k=e.ItemView.extend({template:{type:"handlebars",template:g},events:{"click LI > A":"joinChatroom"},joinChatroom:function(a){if(a.preventDefault(),i.is_logged_in()){var c=b(a.currentTarget,this.$el);j.ChatRoomCategoryStore.getInstance().join_chatroom_by_name(c.data("chatroom"))}}});return k}),define("hbs!modules/template/group/group-chatroom",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f,g="";return g+='\n        <div class="pull-right"><a href="/v4/sites/ajax/group/list_chatrooms?cid=',
(e=c.group_id)?d=e.call(a,{hash:{},data:b}):(e=a&&a.group_id,d=typeof e===k?e.call(a,{hash:{},data:b}):e),g+=l(d)+'">'+l((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"group|chatrooms_linkunlink",f):m.call(a,"translate","group|chatrooms_linkunlink",f)))+"</a></div>\n    "}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var g,h,i,j="",k="function",l=this.escapeExpression,m=c.helperMissing,n=this;return j+='<div class="group-chatrooms-title">\n    <strong>'+l((h=c.translate||b&&b.translate,i={hash:{},data:e},h?h.call(b,"group|chatrooms_with_count",b&&b.total,i):m.call(b,"translate","group|chatrooms_with_count",b&&b.total,i)))+"</strong>\n    ",g=c["if"].call(b,b&&b.session_user_admin,{hash:{},inverse:n.noop,fn:n.program(1,f,e),data:e}),(g||0===g)&&(j+=g),j+='\n</div>\n<ul class="groups-chatrooms-list"></ul>'})}),define("modules/view/group/group_chatroom_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/view/group/group_chatroom_item_view","hbs!modules/template/group/group-chatroom","modules/view/common/mig33_views","modules/template/helpers/general_helpers","modules/template/helpers/group_helpers"],function(a,b,c,d,e,f,g,h,i,j){var k=d.compile('{{translate "group|empty_group_chatroom"}}'),l=d.compile('{{translate "common|loading"}}...'),m=e.ItemView.extend({template:{type:"handlebars",template:k},className:"group-chatrooms-empty"}),n=e.ItemView.extend({template:{type:"handlebars",template:l},className:"loading"}),o=j.CompositeView.extend({itemView:h,emptyView:m,loadingView:n,itemViewContainer:".groups-chatrooms-list",template:{type:"handlebars",template:i},initialize:function(b){a.bindAll(this),this.model=new c.Model({session_user_admin:b.session_user_admin,group_id:b.collection.options.group_id})},updateTotalChatroomCount:function(a){b(".group-chatroom-total-count",this.$el).text(a)}});return o}),define("modules/view/group/group_feed_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/view/homefeed/homefeed_post_collection_view","modules/template/helpers/general_helpers","modules/template/helpers/group_helpers"],function(a,b,c,d,e,f,g,h){var i=d.compile('<div class="group-feed box-container-empty">{{translate "group|empty_group_feed"}}</div>'),j=e.ItemView.extend({template:{type:"handlebars",template:i}}),k=h.extend({emptyView:j});return k}),define("hbs!modules/template/group/group-member-list",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f,i="";return i+='\n            <div class="dropdown pull-right">\n				<a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="ico ico-24 ico-window-settings"></i></a>\n                <ul class="dropdown-menu">\n                    ',e=c.compare||a&&a.compare,f={hash:{},inverse:q.program(4,h,b),fn:q.program(2,g,b),data:b},d=e?e.call(a,(d=a&&a.member,null==d||d===!1?d:d.type),3,f):o.call(a,"compare",(d=a&&a.member,null==d||d===!1?d:d.type),3,f),(d||0===d)&&(i+=d),i+='\n                    <li><a href="#" class="block-member">'+p((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|block",f):o.call(a,"translate","user|block",f)))+"</a></li>\n                </ul>\n            </div>\n        "}function g(a,b){var d,e,f="";return f+='\n                        <li><a href="#" class="demote-member">'+p((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"group|demote",e):o.call(a,"translate","group|demote",e)))+"</a></li>\n                    "}function h(a,b){var d,e,f="";return f+='\n                        <li><a href="#" class="promote-member">'+p((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"group|promote",e):o.call(a,"translate","group|promote",e)))+"</a></li>\n                    "}function i(a,b){var d,e,f="";return f+='\n        <div class="group-member-type">('+p((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"group|moderator",e):o.call(a,"translate","group|moderator",e)))+")</div>\n    "}function j(a,b){var d,e,f="";return f+='\n        <div class="group-member-type">('+p((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"group|owner",e):o.call(a,"translate","group|owner",e)))+")</div>\n    "}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var k,l,m,n="",o=c.helperMissing,p=this.escapeExpression,q=this,r="function";return n+='<div class="group-member-avatar"><img src="'+p((l=c.getDisplayPictureUrl||b&&b.getDisplayPictureUrl,m={hash:{},data:e},l?l.call(b,(k=b&&b.member,null==k||k===!1?k:k.username),2,48,48,m):o.call(b,"getDisplayPictureUrl",(k=b&&b.member,null==k||k===!1?k:k.username),2,48,48,m)))+'" /></div>\n<div class="group-member-content">\n    <div class="group-member-title">\n        <strong><a href="'+p((l=c.getProfileUrl||b&&b.getProfileUrl,m={hash:{},data:e},l?l.call(b,(k=b&&b.member,null==k||k===!1?k:k.username),m):o.call(b,"getProfileUrl",(k=b&&b.member,null==k||k===!1?k:k.username),m)))+'" class="profile-hovercard" data-username="'+p((k=b&&b.member,k=null==k||k===!1?k:k.username,typeof k===r?k.apply(b):k))+'">'+p((k=b&&b.member,k=null==k||k===!1?k:k.username,typeof k===r?k.apply(b):k))+"</a></strong>\n        ",k=c["if"].call(b,(k=b&&b.group,null==k||k===!1?k:k.session_user_admin),{hash:{},inverse:q.noop,fn:q.program(1,f,e),data:e}),(k||0===k)&&(n+=k),n+="\n    </div>\n    ",l=c.compare||b&&b.compare,m={hash:{},inverse:q.noop,fn:q.program(6,i,e),data:e},k=l?l.call(b,(k=b&&b.member,null==k||k===!1?k:k.type),3,m):o.call(b,"compare",(k=b&&b.member,null==k||k===!1?k:k.type),3,m),(k||0===k)&&(n+=k),n+="\n    ",l=c.compare||b&&b.compare,m={hash:{},inverse:q.noop,fn:q.program(8,j,e),data:e},k=l?l.call(b,(k=b&&b.member,null==k||k===!1?k:k.type),2,m):o.call(b,"compare",(k=b&&b.member,null==k||k===!1?k:k.type),2,m),(k||0===k)&&(n+=k),n+="\n</div>"})}),define("modules/view/group/group_member_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/group/group-member-list","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers","modules/template/helpers/group_helpers"],function(a,b,c,d,e,f,g,h,i){var j=e.ItemView.extend({initialize:function(b){a.bindAll(this),this.group=b.group},onRender:function(){i.parse_profile_hovercard(this)},className:function(){return"group-member-"+this.model.get("id")+" group-member-item"},template:function(a){var b=this;return g({member:a,group:b.group.toJSON()})},events:{"click .promote-member":"promoteMember","click .demote-member":"demoteMember","click .block-member":"blockMember"},promoteMember:function(){if(i.is_logged_in()){var a=this,b=this.model.promoteMember(this.group.id);b.done(function(){a.group.goToGroup("members")})}},demoteMember:function(){if(i.is_logged_in()){var a=this,b=this.model.demoteMember(this.group.id);b.done(function(){a.group.goToGroup("members")})}},blockMember:function(){if(i.is_logged_in()){var a=this,b=this.model.blockMember(this.group.id);b.done(function(){a.group.goToGroup("members")})}}});return j}),define("modules/view/group/group_member_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/view/group/group_member_item_view","modules/view/common/mig33_views","modules/template/helpers/general_helpers","modules/template/helpers/group_helpers"],function(a,b,c,d,e,f,g,h,i){var j=d.compile('{{translate "group|empty_group_member"}}'),k=d.compile('{{translate "common|loading"}}...'),l=e.ItemView.extend({template:{type:"handlebars",template:j},className:"group-chatrooms-empty"}),m=e.ItemView.extend({template:{type:"handlebars",template:k},className:"loading"}),n=i.CollectionView.extend({itemView:h,emptyView:l,loadingView:m,initialize:function(b){a.bindAll(this),this.group=b.group},itemViewOptions:function(){return{group:this.group}}});return n}),define("hbs!modules/template/group/group-invite-list",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+='\n            <div class="dropdown pull-right">\n				<a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="ico ico-24 ico-window-settings"></i></a>\n                <ul class="dropdown-menu">\n                    <li><a href="#" class="accept-invite">'+l((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"common|accept",e):k.call(a,"translate","common|accept",e)))+'</a></li>\n                    <li><a href="#" class="reject-invite">'+l((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"common|reject",e):k.call(a,"translate","common|reject",e)))+"</a></li>\n                </ul>\n            </div>\n        "}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var g,h,i,j="",k=c.helperMissing,l=this.escapeExpression,m="function",n=this;return j+='<div class="group-member-avatar"><img src="'+l((h=c.getDisplayPictureUrl||b&&b.getDisplayPictureUrl,i={hash:{},data:e},h?h.call(b,(g=b&&b.invite,null==g||g===!1?g:g.requester_username),2,48,48,i):k.call(b,"getDisplayPictureUrl",(g=b&&b.invite,null==g||g===!1?g:g.requester_username),2,48,48,i)))+'" /></div>\n<div class="group-member-content">\n    <div class="group-member-title">\n	    <strong><a href="'+l((h=c.getProfileUrl||b&&b.getProfileUrl,i={hash:{},data:e},h?h.call(b,(g=b&&b.invite,null==g||g===!1?g:g.requester_username),i):k.call(b,"getProfileUrl",(g=b&&b.invite,null==g||g===!1?g:g.requester_username),i)))+'" class="profile-hovercard" data-username="'+l((g=b&&b.invite,g=null==g||g===!1?g:g.requester_username,typeof g===m?g.apply(b):g))+'">'+l((g=b&&b.invite,g=null==g||g===!1?g:g.requester_username,typeof g===m?g.apply(b):g))+"</a></strong>\n        ",g=c["if"].call(b,(g=b&&b.group,null==g||g===!1?g:g.session_user_admin),{hash:{},inverse:n.noop,fn:n.program(1,f,e),data:e}),(g||0===g)&&(j+=g),j+="\n    </div>\n</div>"})}),define("modules/view/group/group_invite_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/group/group-invite-list","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers","modules/template/helpers/group_helpers"],function(a,b,c,d,e,f,g,h,i){var j=e.ItemView.extend({initialize:function(b){a.bindAll(this),this.group=b.group},onRender:function(){i.parse_profile_hovercard(this)},template:function(a){var b=this;return g({invite:a,group:b.group.toJSON()})},id:function(){return"group-invite-"+this.model.get("id")},className:function(){return"group-member-"+this.model.get("requester_id")+" group-member-item"},events:{"click .accept-invite":"acceptInvite","click .reject-invite":"rejectInvite"},acceptInvite:function(){if(i.is_logged_in()){var a=this,b=this.model.acceptInvite(this.group.id);b.done(function(){a.group.goToGroup("members")})}},rejectInvite:function(){if(i.is_logged_in()){var a=this,b=this.model.rejectInvite(this.group.id);b.done(function(){a.group.goToGroup("members")})}}});return j}),define("modules/view/group/group_invite_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/view/group/group_invite_item_view","modules/view/group/group_member_collection_view","modules/template/helpers/general_helpers","modules/template/helpers/group_helpers"],function(a,b,c,d,e,f,g,h,i){var j=i.extend({itemView:h});return j}),define("modules/model/group/group_chatroom_model",["underscore","backbone","modules/mig33_app","modules/common/config","modules/common/utility"],function(a,b){var c=b.Model.extend({initialize:function(a){this.options=a}});return c}),define("modules/model/group/group_chatroom_collection",["modules/model/common/mig33_collection","modules/common/config","modules/common/utility","modules/model/group/group_chatroom_model","underscore"],function(a,b,c,d,e){var f=a.extend({model:d,currentPage:1,initialize:function(a,b){this.options=b},url:function(){return c.format(b.urls.group_chatrooms,this.options.group_id)},parse:function(a){return null===a||e.isUndefined(a.data.chatrooms)||null===a.data.chatrooms?null:a.data.chatrooms},resetPage:function(){this.currentPage=1},nextPage:function(){this.currentPage++}});return f}),define("modules/model/group/group_feed_collection",["modules/mig33_app","modules/common/config","modules/common/utility","modules/model/post/post_collection"],function(a,b,c,d){var e=d.extend({initialize:function(a,b){this.options=b},url:function(){return c.format(b.urls.group_feed,this.options.group_id,this.currentPage,b.variable.limit)}});return e}),define("modules/model/group/group_member_model",["underscore","backbone","modules/mig33_app","modules/common/config","modules/common/utility"],function(a,b,c,d,e){var f=b.Model.extend({initialize:function(a){this.options=a},promoteMember:function(a){if(window.confirm(e.translate("group|will_be_promoted",this.get("username")))){var b=this,c=$.ajax({type:"post",dataType:"json",url:e.format(d.urls.group_member_promote,a,b.get("username"))});return c.done(function(a){a=e.parse_ajax_response(a),a.error?e.show_error(a.error):e.show_success(a.success)}),c.fail(function(a,b,c){e.show_error(c)}),c}return null},demoteMember:function(a){if(window.confirm(e.translate("group|will_be_demoted",this.get("username")))){var b=this,c=$.ajax({type:"post",dataType:"json",url:e.format(d.urls.group_member_demote,a,b.get("username"))});return c.done(function(a){a=e.parse_ajax_response(a),a.error?e.show_error(a.error):e.show_success(a.success)}),c.fail(function(a,b,c){e.show_error(c)}),c}return null},blockMember:function(a){if(window.confirm(e.translate("group|will_be_blocked",this.get("username")))){var b=this,c=$.ajax({type:"post",dataType:"json",url:e.format(d.urls.group_member_block,a,b.get("username"))});return c.done(function(a){a=e.parse_ajax_response(a),a.error?e.show_error(a.error):e.show_success(a.success)}),c.fail(function(a,b,c){e.show_error(c)}),c}return null}});return f}),define("modules/model/group/group_member_collection",["modules/model/common/mig33_collection","modules/common/config","modules/common/utility","modules/model/group/group_member_model","underscore"],function(a,b,c,d,e){var f=a.extend({model:d,offset:0,limit:b.groups.members.limit,totalResults:0,initialize:function(a,b){this.options=b},url:function(){return c.format(b.urls.group_members,this.options.group_id)+"?offset="+this.offset+"&e="+this.limit},parse:function(a){return null!==a&&!e.isUndefined(a.data)&&null!==a.data&&a.data.length?(this.totalResults+=a.data.length,a.data):null},resetPage:function(){this.offset=0},nextPage:function(){this.offset=this.offset+this.limit},getTotalResults:function(){return this.totalResults}});return f}),define("modules/model/group/group_moderator_collection",["modules/model/common/mig33_collection","modules/common/config","modules/common/utility","modules/model/group/group_member_model","modules/model/group/group_member_collection","underscore"],function(a,b,c,d,e,f){var g=e.extend({model:d,initialize:function(a,b){this.options=b},url:function(){return c.format(b.urls.group_moderators,this.options.group_id)},parse:function(a){return null===a||f.isUndefined(a.data.moderators)||null===a.data.moderators?null:a.data.moderators}});return g}),define("modules/model/group/group_invite_model",["underscore","backbone","modules/common/config","modules/common/utility"],function(a,b,c,d){var e=b.Model.extend({initialize:function(a){this.options=a},acceptInvite:function(a){if(window.confirm(d.translate("group|will_be_allowed_join",this.get("requester_username")))){var b=this,e=$.ajax({type:"post",dataType:"json",url:d.format(c.urls.group_invite_accept,a,b.get("id"))});return e.done(function(c){c=d.parse_ajax_response(c),c.error?d.show_error(c.error):d.show_success(c.success),b._invalidateCache(a,"members")}),e.fail(function(a,b,c){d.show_error(c)}),e}return null},rejectInvite:function(a){if(window.confirm(d.translate("group|will_not_be_allowed_join",this.get("requester_username")))){var b=this,e=$.ajax({type:"post",dataType:"json",url:d.format(c.urls.group_invite_reject,a,b.get("id"))});return e.done(function(a){a=d.parse_ajax_response(a),a.error?d.show_error(a.error):d.show_success(a.success)}),e.fail(function(a,b,c){d.show_error(c)}),e}return null},_invalidateCache:function(a,b){$.ajax({type:"delete",url:d.format(c.urls.group_invalidate_cache,a,b)})}});return e}),define("modules/model/group/group_invite_collection",["modules/model/common/mig33_collection","modules/common/config","modules/common/utility","modules/model/group/group_invite_model","underscore"],function(a,b,c,d,e){var f=a.extend({model:d,initialize:function(a,b){this.options=b},url:function(){return c.format(b.urls.group_pending_invites,this.options.group_id)},parse:function(a){return null===a||e.isUndefined(a.data.pending_invites)||null===a.data.pending_invites?null:a.data.pending_invites}});return f}),define("modules/controller/group_controller",["underscore","backbone","backbone.marionette","modules/mig33_app","modules/view/group/group_index_layout","modules/view/group/group_details_layout","modules/view/group/group_members_layout","modules/view/group/group_collection_view","modules/view/group/group_item_view","modules/view/group/group_item_detail_view","modules/view/group/group_postbox_view","modules/view/group/group_chatroom_collection_view","modules/view/group/group_feed_collection_view","modules/view/group/group_member_collection_view","modules/view/group/group_invite_collection_view","modules/model/group/group_model","modules/model/group/group_collection","modules/model/group/group_chatroom_collection","modules/model/group/group_feed_collection","modules/model/group/group_member_collection","modules/model/group/group_moderator_collection","modules/model/group/group_invite_collection","modules/common/mime_types_parser","modules/common/config","modules/common/utility","modules/common/session_user"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){var A,B,C=c.Controller.extend({_getGroupById:function(a){var b=new p({group_id:a});return b.fetch(),b},initialize:function(){d.vent.on(y.format(d.ApplicationEvents.GROUP_POST_ADDED,B),function(a){if(A)try{""!==a.mimeData&&"undefined"!=typeof a.mimeData||(a=w.generate_post_mimedata(a)),A.add(a)}catch(b){console.log("groupfeed collection is not initialized or undefined")}})},showGroup404:function(){y.show_error(y.translate("group|not_found"))},index:function(){var a=new e;d.content.show(a);var b=new q([],{type:"user_joined",userId:z.getInstance().get("id")}),c=new q([],{type:"official"}),f=new h({collection:b,type:"user_joined"});b.on("fetch:done",function(c){b.getTotalResults()==c.total_results&&f.hideMore(),a.updateMyGroupsCount(c.total_results)}),f.on("group:my:more",function(){b.nextPage(),b.fetch({remove:!1})}),a.my_groups.show(f),a.official_groups.show(new h({collection:c,type:"official"})),b.fetch(),c.fetch()},create:function(){},members:function(a){var b=this._getGroupById(a);b.on("change",function(){var c=new g({model:b});d.content.show(c);var e=new t([],{group_id:a}),f=new n({collection:e,group:b});e.fetch(),c.members.show(f),e.on("fetch:done",function(){var a=b.get("member_count");e.getTotalResults()==a&&c.hideMore(),c.updateGroupMembersCount(a)}),c.on("group:members:more",function(){e.nextPage(),e.fetch({remove:!1})});var h=new u([],{group_id:a});h.fetch();var i=new n({collection:h,group:b});c.moderators.show(i),h.on("fetch:done",function(a){var b=a.total;0===b?(c.moderators.close(),c.hideGroupModeratorsTitle()):c.updateGroupModeratorsCount(a.total)});var j=new v([],{group_id:a});j.fetch();var k=new o({collection:j,group:b});c.pending_invites.show(k),j.on("fetch:done",function(a){var b=a.total;0===b?(c.pending_invites.close(),c.hideGroupPendingInvitesTitle()):c.updateGroupPendingInvitesCount(a.total)})})},settings:function(a,b){},details:function(a){B=a;var b=this._getGroupById(a);b.on("change",function(){var c=new f;d.content.show(c);var e=new j({model:b});c.details.show(e);var g=new k({group_id:a,session_user_admin:b.get("session_user_admin")});c.postbox.show(g);var h=new r([],{group_id:a});h.fetch();var i=new l({collection:h,session_user_admin:b.get("session_user_admin")});c.chatrooms.show(i),h.on("fetch:done",function(a){i.updateTotalChatroomCount(a.chatroom_total_results)}),A=new s([],{group_id:a}),A.fetch();var n=new m({type:"groupfeed",collection:A});A.on("fetch:done",function(){c.hidePagination(),n.more=y.unblock_function(n.more)}),n.on("groupfeed:more",function(a){c.showPagination(),n.more=y.block_function(n.more),A.fetch({remove:!1,page:a})}),c.container.show(n)})}});return C}),define("hbs!modules/template/store/store-layout",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="col-sm-12 col-md-10 col-md-offset-1">\n	<div class="row">\n		<div class="col-xs-6 no-padding">\n			<div class="content-page-title">\n				<div class="font-size-12 font-bold">\n					<a href="/home" class="icon-wb_arrowLeft">\n						'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"common|home",g):i.call(b,"translate","common|home",g)))+'\n					</a>\n				</div>\n				<h3 class="font-color-link font-light current-store-category no-margin">\n					'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"store|store",g):i.call(b,"translate","store|store",g)))+'\n				</h3>\n			</div>\n		</div>\n		<div class="col-xs-6 no-padding">\n			<div class="account-credits clearfix pull-right">\n				<a href="/credit" class="btn-outline btn-credit">\n					<span class="wb wb-20 icon-wb_staff text-right"></span>\n					<span id="store-account-balance" class="account-balance-amount">\n						<div class="loading"></div>Loading...\n					</span>\n					<span class="account-recharge hidden">\n						'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"store|recharge",g):i.call(b,"translate","store|recharge",g)))+'\n					</span>\n				</a>\n			</div>\n		</div>\n	</div>\n	<div class="row row-offcanvas row-offcanvas-left background-color">\n        <div id="store" class="col-sm-12 col-md-12 content content-store">\n			<form class="row form-inline store-search-form" action="store/search" method="get" onsubmit="return false;">\n				<input type="hidden" name="store-search-filter" value="new" />\n				<input type="hidden" name="store-search-type" value="1" />\n				<input type="hidden" name="store-search-categoryid" value="1" />\n				<input type="hidden" name="store-sortby" value="popular" />\n				<input type="hidden" name="store-sortorder" value="desc" />\n				<div class="store-search">\n					<div class="row">\n						<div class="col-xs-6 col-lg-3 no-padding-right">\n							<div class="btn-group display-block">\n								<button type="button" class="btn btn-white dropdown-toggle text-left" data-toggle="dropdown" style="width: 100%;">\n									<span class="store-categories-text">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"store|category",g):i.call(b,"translate","store|category",g)))+'</span> &nbsp; <span class="caret"></span>\n								</button>\n								<div class="store-categories-content input-sm"></div>\n							</div>\n						</div>\n						<div class="col-xs-2 col-lg-1 col-lg-push-5 no-padding">\n							<div class="sort-by text-right input-sm font-color-caption font-bold">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"store|sort_by",g):i.call(b,"translate","store|sort_by",g)))+'</div>\n						</div>\n						<div class="col-xs-4 col-lg-2 col-lg-push-5 no-padding-left">\n							<div class="btn-group" style="width:100%">\n								<button type="button" class="btn btn-white dropdown-toggle text-left" data-toggle="dropdown" style="width:100%;">\n									<span class="store-sortby-text">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"store|sort_popularity",g):i.call(b,"translate","store|sort_popularity",g)))+'</span> &nbsp; <span class="caret"></span>\n								</button>\n								<ul class="dropdown-menu store-sortby" role="menu">\n									<li><a href="#" data-sortby="popular" data-sortorder="desc">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"store|sort_popularity",g):i.call(b,"translate","store|sort_popularity",g)))+'</a></li>\n									<li><a href="#" data-sortby="price" data-sortorder="asc">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"store|sort_price_low_high",g):i.call(b,"translate","store|sort_price_low_high",g)))+'</a></li>\n									<li><a href="#" data-sortby="price" data-sortorder="desc">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"store|sort_price_high_low",g):i.call(b,"translate","store|sort_price_high_low",g)))+'</a></li>\n									<li><a href="#" data-sortby="name" data-sortorder="asc">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"store|sort_name_a_z",g):i.call(b,"translate","store|sort_name_a_z",g)))+'</a></li>\n									<li><a href="#" data-sortby="name" data-sortorder="desc">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"store|sort_name_z_a",g):i.call(b,"translate","store|sort_name_z_a",g)))+'</a></li>\n								</ul>\n							</div>\n						</div>\n						<div class="col-xs-4 col-lg-2 col-lg-pull-3 no-padding-right">\n							<div class="btn-group">\n								<button type="button" class="btn btn-white dropdown-toggle text-left" data-toggle="dropdown" style="width: 125px;">\n									<span class="store-searchby-text">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"store|search_name",g):i.call(b,"translate","store|search_name",g)))+'</span> &nbsp; <span class="caret"></span>\n								</button>\n								<ul class="dropdown-menu store-searchby" role="menu">\n									<li><a href="#" data-searchby="name">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"store|search_name",g):i.call(b,"translate","store|search_name",g)))+'</a></li>\n									<li><a href="#" data-searchby="price">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"store|search_choose_price",g):i.call(b,"translate","store|search_choose_price",g)))+'</a></li>\n								</ul>\n							</div>\n						</div>\n						<div class="col-xs-6 col-lg-3 col-lg-pull-3 no-padding-left">\n							<div class="store-search-name">\n								<input class="form-control input-sm" name="store-search-query" type="text" placeholder="'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"common|search",g):i.call(b,"translate","common|search",g)))+'" value="" style="width:100%" />\n							</div>\n							<div class="store-search-price" style="display: none;">\n								<input class="form-control input-sm" name="store-search-price-min" type="text" placeholder="'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"common|from",g):i.call(b,"translate","common|from",g)))+'" value="" size="7" />\n								&nbsp;\n								<input class="form-control input-sm" name="store-search-price-max" type="text" placeholder="'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"common|to",g):i.call(b,"translate","common|to",g)))+'" value="" size="7" />\n								&nbsp;<span class="store-search-user-currency font-size-14">USD</span>\n							</div>\n						</div>\n						<div class="col-xs-2 col-lg-1 text-right">\n							<button type="submit" class="btn btn-default btn-circle font-size-20 store-search-submit">\n								<span class="icon-wb_search"></span>\n							</button>\n						</div>\n					</div>\n				</div>\n			</form>\n			<div class="row app-header"></div>\n			<div class="store-content"></div>\n			<div class="load-more">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"common|more",g):i.call(b,"translate","common|more",g)))+"</div>\n		</div>\n	</div>\n</div>"})}),define("modules/view/store/store_layout",["jquery","underscore","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/globals/url","hbs!modules/template/store/store-layout","modules/template/helpers/general_helpers","modules/template/helpers/store_helpers","jquery.highlight-4"],function(a,b,c,d,e,f,g,h,i,j){var k=e.Layout.extend({template:{type:"handlebars",template:j},regions:{defaultCategories:".store-categories-default",categories:".store-categories-content",header:".app-header",container:".store-content",pagination:".load-more"},events:{"click .go-to-url":"goToUrl","click .store-search-submit":"doSearch",'keyup input[name="store-search-query"]':"searchEnter","click .store-sortby a":"doSortBy","click .store-searchby a":"doSearchBy","click [data-toggle=offcanvas]":"toggleSideBar","mouseover .btn-credit":"toggleCreditButton","mouseout .btn-credit":"toggleCreditButton"},className:"store",onRender:function(a){this.update_back_button(a.options.category_id,a.options.nice_name)},toggleSideBar:function(b){a(".row-offcanvas",this.$el).toggleClass("active"),a(b.target).blur()},makeTabActive:function(b){a(".store-tabs",this.$el).find("li").removeClass("active").end().find("#store-category-tab-"+b).addClass("active")},searchEnter:function(a){13==a.keyCode&&(a.stopPropagation(),this.doSearch(a))},doSearch:function(d){d.preventDefault();var e=a(".store-search-form",this.$el),f=a('input[name="store-search-filter"]',e).val(),i=parseInt(a('input[name="store-search-type"]',e).val(),10),j=parseInt(a('input[name="store-search-categoryid"]',e).val(),10),k=a.trim(a('input[name="store-search-query"]',e).val()),l=-1,m=a.trim(a('input[name="store-search-price-min"]',e).val()),n=-1,o=a.trim(a('input[name="store-search-price-max"]',e).val()),p=a.trim(a('input[name="store-sortby"]',e).val()),q=a.trim(a('input[name="store-sortorder"]',e).val()),r=0===k.length&&0===m.length&&0===o.length;if(r)c.history.navigate("store/category/"+j+"/"+f+"/"+p+"/"+q,{trigger:!0});else{if(m.length>0&&(l=parseFloat(m)),o.length>0&&(n=parseFloat(o)),isNaN(parseFloat(l)))return void h.show_error(h.translate("store|error_search_minprice_nan"));if(isNaN(parseFloat(n)))return void h.show_error(h.translate("store|error_search_maxprice_nan"));if(parseFloat(l)>parseFloat(n))return void h.show_error(h.translate("store|error_search_minprice_more"));c.history.navigate(e.attr("action")+"/"+j+"/?type="+i+(j>b.size(g.store.type_to_category)?"&categoryId="+j:"")+"&query="+encodeURIComponent(k)+"&minPrice="+l+"&maxPrice="+n+"&sortBy="+p+"&sortOrder="+q,{trigger:!0})}},resetSearchForm:function(){a(".store-search-form",this.$el).trigger("reset")},setParamsForSearchField:function(b,c,d){var e=a(".store-search-form",this.$el);a('input[name="store-search-query"]',e).val(b),(c>-1||""===c)&&a('input[name="store-search-price-min"]',e).val(c),(d>-1||""===c)&&a('input[name="store-search-price-max"]',e).val(d)},setParamsForSortField:function(b,c){var d=a(".store-search-form",this.$el);a(".store-sortby li",d).filter(function(){return a("a",this).data("sortby")===b&&a("a",this).data("sortorder")===c}).children("a").click()},setFilterTypeAndCategoryId:function(c,d,e){var f=a(".store-search-form",this.$el);a('input[name="store-search-filter"]',f).val(c),a('input[name="store-search-type"]',f).val(d),a('input[name="store-search-categoryid"]',f).val(e),e<=b.size(g.store.type_to_category)&&a(".store-categories-text",this.$el).text(h.translate("store|category"))},hightlightSearchTerms:function(b){a(".store-content > ul > li > .store-item > .title").highlight(b)},goToUrl:function(b){b.preventDefault(),c.history.navigate(i.site.replace(window.location.protocol+"//"+window.location.hostname,"")+a(b.currentTarget).data("url"),{trigger:!0})},updateAccountBalance:function(b){a("#store-account-balance",this.$el).text(b)},showPagination:function(){a(".load-more",this.$el).show()},hidePagination:function(){a(".load-more",this.$el).hide();
},setSearchCurrency:function(b){a(".store-search-user-currency",this.$el).text(b)},showSearch:function(){a(".store-search-form",this.$el).show()},hideSearch:function(){a(".store-search-form",this.$el).hide()},doSearchBy:function(b){b.preventDefault(),a(".store-searchby-text",this.$el).text(a(b.currentTarget).text()),"name"===a(b.currentTarget).data("searchby")?(a(".store-search-name",this.$el).show(),a(".store-search-price",this.$el).hide(),a('input[name="store-search-price-min"]',this.$el).val(""),a('input[name="store-search-price-max"]',this.$el).val("")):(a(".store-search-name",this.$el).hide(),a(".store-search-price",this.$el).show(),a('input[name="store-search-query"]',this.$el).val(""))},doSortBy:function(b){b.preventDefault(),a('input[name="store-sortby"]',this.$el).val(a(b.currentTarget).data("sortby")),a('input[name="store-sortorder"]',this.$el).val(a(b.currentTarget).data("sortorder")),a(".store-sortby-text",this.$el).text(a(b.currentTarget).text())},toggleCreditButton:function(b){b.preventDefault();var c=a(".account-recharge",b.currentTarget).hasClass("hidden");"mouseover"==b.type&&c===!0&&a(b.currentTarget.children).toggleClass("hidden"),"mouseout"==b.type&&c===!1&&a(b.currentTarget.children).toggleClass("hidden")},update_back_button:function(b,d){var e="Store",f="Home",g="/home";c.history.fragment.indexOf("item")>0||c.history.fragment.indexOf("inventory")>0||c.history.fragment.indexOf("received")>0?(e=d,f="Back",g="javascript:Backbone.history.history.back();"):"home"!=b&&(a(".current-store-category",this.$el).text(""),e=d,f="Store",g="/store"),a(".current-store-category",this.$el).text(e),a(".content-page-title a",this.$el).text(f),a(".content-page-title a",this.$el).attr("href",g)},update_back_title:function(b){a(".current-store-category",this.$el).text(b)}});return k}),define("hbs!modules/template/store/store-item-purchase-layout",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h,i="",j="function",k=this.escapeExpression,l=c.helperMissing;return i+='<div class="store-item-details modal-dialog"></div>\n<div class="hidden">\n	<div class="store-back text-right"><a href="/store/category/',(g=c.parent_category_id)?f=g.call(b,{hash:{},data:e}):(g=b&&b.parent_category_id,f=typeof g===j?g.call(b,{hash:{},data:e}):g),i+=k(f)+'/popular">'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"store|search_back_to_all",b&&b.category_nice_name,h):l.call(b,"translate","store|search_back_to_all",b&&b.category_nice_name,h)))+'</a></div>\n	<div class="store-popular-items">\n		<div class="store-popular-items-title hidden">'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"store|category_popular",b&&b.category_nice_name,h):l.call(b,"translate","store|category_popular",b&&b.category_nice_name,h)))+'</div>\n		<div class="store-more-items-title">'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"store|want_to_send_more",b&&b.category_nice_name,h):l.call(b,"translate","store|want_to_send_more",b&&b.category_nice_name,h)))+'</div>\n		<div class="store-popular-items-content"></div>\n	</div>\n</div>'})}),define("modules/view/store/store_item_purchase_layout",["jquery","underscore","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","hbs!modules/template/store/store-item-purchase-layout","modules/template/helpers/general_helpers","modules/template/helpers/store_helpers","jquery.highlight-4"],function(a,b,c,d,e,f,g,h,i,j){var k=e.Layout.extend({template:{type:"handlebars",template:i},regions:{popular:".store-popular-items-content",details:".store-item-details"},className:"store-item-purchase-wrapper",togglePopularAndMoreTitle:function(b){"more"==b?(a(".store-popular-items-title").addClass("hidden"),a(".store-more-items-title").removeClass("hidden")):(a(".store-popular-items-title").removeClass("hidden"),a(".store-more-items-title").addClass("hidden"))}});return k}),define("hbs!modules/template/store/store-item-received-layout",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h,i="",j="function",k=this.escapeExpression,l=c.helperMissing;return i+='<div class="store-item-received"></div>\n<div class="hidden">\n	<div class="store-back text-right"><a href="/store/category/',(g=c.category_id)?f=g.call(b,{hash:{},data:e}):(g=b&&b.category_id,f=typeof g===j?g.call(b,{hash:{},data:e}):g),i+=k(f)+'/popular">'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"store|view_all",b&&b.category_nice_name,h):l.call(b,"translate","store|view_all",b&&b.category_nice_name,h)))+'</a></div>\n	<div class="store-popular-items">\n		<div class="store-popular-items-title">'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"store|want_to_send_thankyou_gift",b&&b.sender,h):l.call(b,"translate","store|want_to_send_thankyou_gift",b&&b.sender,h)))+'</div>\n		<div class="store-new-items-content"></div>\n	</div>\n	<div class="store-popular-items">\n		<div class="store-popular-items-title">'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"store|category_popular",b&&b.category_nice_name,h):l.call(b,"translate","store|category_popular",b&&b.category_nice_name,h)))+'</div>\n		<div class="store-popular-items-content"></div>\n	</div>\n</div>'})}),define("modules/view/store/store_item_received_layout",["jquery","underscore","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","hbs!modules/template/store/store-item-received-layout","modules/template/helpers/general_helpers","modules/template/helpers/store_helpers","jquery.highlight-4"],function(a,b,c,d,e,f,g,h,i,j){var k=e.Layout.extend({template:{type:"handlebars",template:i},regions:{details:".store-item-received",latest:".store-new-items-content",popular:".store-popular-items-content"},className:"store-item-received-wrapper"});return k}),define("hbs!modules/template/store/store-partner-header",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var c,d="";return d+='\n	<a target="_blank" href="'+m((c=a&&a.content_data,c=null==c||c===!1?c:c.website_url,typeof c===l?c.apply(a):c))+'">\n'}function g(a,b){return"\n	</a>\n"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var h,i,j,k="",l="function",m=this.escapeExpression,n=this,o=c.helperMissing;return i=c.isNotEmpty||b&&b.isNotEmpty,j={hash:{},inverse:n.noop,fn:n.program(1,f,e),data:e},h=i?i.call(b,(h=b&&b.content_data,null==h||h===!1?h:h.website_url),j):o.call(b,"isNotEmpty",(h=b&&b.content_data,null==h||h===!1?h:h.website_url),j),(h||0===h)&&(k+=h),k+='\n\n<div class="app-header-bg row">\n	<div class="image col-sm-3 col-xs-4">\n		<img src="'+m((h=b&&b.content_data,h=null==h||h===!1?h:h.logo_image,typeof h===l?h.apply(b):h))+'" height="64" />\n	</div>\n	<div class="details col-sm-6 col-xs-8">\n		<div class="title">',(i=c.store_category_name)?h=i.call(b,{hash:{},data:e}):(i=b&&b.store_category_name,h=typeof i===l?i.call(b,{hash:{},data:e}):i),k+=m(h)+'</div>\n		<div class="description">',(i=c.store_category_description)?h=i.call(b,{hash:{},data:e}):(i=b&&b.store_category_description,h=typeof i===l?i.call(b,{hash:{},data:e}):i),k+=m(h)+"</div>\n	</div>\n</div>\n\n",i=c.isNotEmpty||b&&b.isNotEmpty,j={hash:{},inverse:n.noop,fn:n.program(3,g,e),data:e},h=i?i.call(b,(h=b&&b.content_data,null==h||h===!1?h:h.website_url),j):o.call(b,"isNotEmpty",(h=b&&b.content_data,null==h||h===!1?h:h.website_url),j),(h||0===h)&&(k+=h),k})}),define("modules/view/store/store_category_partner_layout",["jquery","underscore","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","hbs!modules/template/store/store-partner-header"],function(a,b,c,d,e,f,g,h,i){var j=e.Layout.extend({template:{type:"handlebars",template:i},regions:{}});return j}),define("hbs!modules/template/store/store-category-list",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h,i="",j="function",k=this.escapeExpression,l=c.helperMissing;return i+='<a href="/store/category/',(g=c.id)?f=g.call(b,{hash:{},data:e}):(g=b&&b.id,f=typeof g===j?g.call(b,{hash:{},data:e}):g),i+=k(f)+'" title="',(g=c.name)?f=g.call(b,{hash:{},data:e}):(g=b&&b.name,f=typeof g===j?g.call(b,{hash:{},data:e}):g),i+=k(f)+" ("+k((g=c.addThousandsSeperator||b&&b.addThousandsSeperator,h={hash:{},data:e},g?g.call(b,b&&b.totalItems,h):l.call(b,"addThousandsSeperator",b&&b.totalItems,h)))+')">',(g=c.name)?f=g.call(b,{hash:{},data:e}):(g=b&&b.name,f=typeof g===j?g.call(b,{hash:{},data:e}):g),i+=k(f)+' <span class="total-items">('+k((g=c.addThousandsSeperator||b&&b.addThousandsSeperator,h={hash:{},data:e},g?g.call(b,b&&b.totalItems,h):l.call(b,"addThousandsSeperator",b&&b.totalItems,h)))+")</span></a>"})}),define("modules/view/store/store_category_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/store/store-category-list","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i){var j=e.ItemView.extend({template:{type:"handlebars",template:g},id:function(){return"store-category-"+this.model.get("id")},tagName:"li",className:function(){return 0===this.model.get("totalItems")?"hidden":void(this.options.category_id==this.model.get("id")&&b(".store-categories-text").text(this.model.get("name")))},initialize:function(a){this.options=a}});return j}),define("modules/view/store/store_category_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/view/store/store_category_item_view","modules/view/common/mig33_views","modules/globals/session_user","modules/template/helpers/general_helpers","modules/template/helpers/store_helpers"],function(a,b,c,d,e,f,g,h,i,j,k){var l=d.compile('{{translate "store|empty_category"}}'),m=d.compile('{{translate "common|loading"}}...'),n=e.ItemView.extend({template:{type:"handlebars",template:l},tagName:"li",className:"empty"}),o=e.ItemView.extend({template:{type:"handlebars",template:m},tagName:"li",className:"loading"}),p=j.CollectionView.extend({itemView:i,emptyView:n,loadingView:o,tagName:"ul",className:"dropdown-menu store-categories",initialize:function(a){this.options=a,b(this.$el).attr("role","menu")},onRender:function(){if(!(this.$el.find("a").length>0)){var a=this.options.category_id,b=this.options.category_nice_name;this.$el.prepend('<li id="store-category-default-popular"><a href="/store/category/'+a+'/new">'+h.translate("store|category_all",b)+"</a></li>"),1==a&&this.$el.prepend('<li id="store-category-default-unlocked"><a href="/u/'+k.username+"/store/"+a+'/inventory">'+h.translate("store|category_unlocked",b)+"</a></li>")}},itemViewOptions:function(){return{category_id:this.options.category_id}},removeHighlightFromCategory:function(){b(this.$el).find("li").removeClass("active")},highlightCurrentCategory:function(a){this.removeHighlightFromCategory(),b("#store-category-"+a).text()&&b(".store-categories-text").text(b("#store-category-"+a).text())}});return p}),define("hbs!modules/template/store/store-category-default",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f,h="";return h+='\n	<ul class="list-unstyled">\n		<li id="store-category-default-unlocked"><a href="/u/'+l((e=c.getSessionUser||a&&a.getSessionUser,f={hash:{},data:b},e?e.call(a,"username",f):m.call(a,"getSessionUser","username",f)))+"/store/",(e=c.category_id)?d=e.call(a,{hash:{},data:b}):(e=a&&a.category_id,d=typeof e===k?e.call(a,{hash:{},data:b}):e),h+=l(d)+'/inventory">'+l((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"store|category_unlocked",a&&a.category_nice_name,f):m.call(a,"translate","store|category_unlocked",a&&a.category_nice_name,f)))+"</a></li>\n		",e=c.compare||a&&a.compare,f={hash:{operator:"!="},inverse:n.noop,fn:n.program(2,g,b),data:b},d=e?e.call(a,a&&a.category_id,"7",f):m.call(a,"compare",a&&a.category_id,"7",f),(d||0===d)&&(h+=d),h+='\n		<li id="store-category-default-new"><a href="/store/category/',(e=c.category_id)?d=e.call(a,{hash:{},data:b}):(e=a&&a.category_id,d=typeof e===k?e.call(a,{hash:{},data:b}):e),h+=l(d)+'/new">'+l((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"store|category_new",a&&a.category_nice_name,f):m.call(a,"translate","store|category_new",a&&a.category_nice_name,f)))+"</a></li>\n	</ul>\n"}function g(a,b){var d,e,f,g="";return g+='\n		<li id="store-category-default-popular"><a href="/store/category/',(e=c.category_id)?d=e.call(a,{hash:{},data:b}):(e=a&&a.category_id,d=typeof e===k?e.call(a,{hash:{},data:b}):e),g+=l(d)+'/popular">'+l((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"store|category_all",a&&a.category_nice_name,f):m.call(a,"translate","store|category_all",a&&a.category_nice_name,f)))+'</a></li>\n		<li id="store-category-default-featured"><a href="/store/category/',(e=c.category_id)?d=e.call(a,{hash:{},data:b}):(e=a&&a.category_id,d=typeof e===k?e.call(a,{hash:{},data:b}):e),g+=l(d)+'/featured">'+l((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"store|category_featured",a&&a.category_nice_name,f):m.call(a,"translate","store|category_featured",a&&a.category_nice_name,f)))+"</a></li>\n		"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var h,i,j,k="function",l=this.escapeExpression,m=c.helperMissing,n=this;return i=c.compare||b&&b.compare,j={hash:{operator:">"},inverse:n.noop,fn:n.program(1,f,e),data:e},h=i?i.call(b,b&&b.category_id,0,j):m.call(b,"compare",b&&b.category_id,0,j),h||0===h?h:""})}),define("modules/view/store/store_category_default_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/store/store-category-default","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i){var j=e.ItemView.extend({template:{type:"handlebars",template:g},className:"store-categories-default-content",initialize:function(a){this.options=a},removeHighlightFromDefaultCategory:function(){var a=b("ul",this.$el);return a.find("li").removeClass("active"),a},highlightCurrentDefaultCategory:function(a){b("#store-category-default-"+a).text()&&b(".store-categories-text").text(b("#store-category-default-"+a).text())},showUnlockedDefaultCategory:function(){b("#store-category-default-unlocked",this.$el).removeClass("hidden")},hideUnlockedDefaultCategory:function(){b("#store-category-default-unlocked",this.$el).addClass("hidden")}});return j}),define("modules/model/store/store_partner_model",["underscore","backbone","modules/mig33_app","modules/common/config","modules/common/utility"],function(a,b,c,d,e){var f=b.Model.extend({initialize:function(a){this.options=a},url:function(){return e.format(d.urls.cxb_store_partner,this.options.partner_id)}});return f}),define("hbs!modules/template/store/store-item-list",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){return"app_item"}function g(a,b){var d,e,f,g="";return g+="\n			",e=c.compare||a&&a.compare,f={hash:{},inverse:L.program(6,i,b),fn:L.program(4,h,b),data:b},d=e?e.call(a,a&&a.type,"STICKER",f):J.call(a,"compare",a&&a.type,"STICKER",f),(d||0===d)&&(g+=d),g+="\n		"}function h(a,b){var d,e,f="";return f+='\n				<img src="'+K((d=c.getStoreItemImage||a&&a.getStoreItemImage,e={hash:{},data:b},d?d.call(a,a,300,e):J.call(a,"getStoreItemImage",a,300,e)))+'" width="300" height="100" />\n			'}function i(a,b){var d,e,f="";return f+='\n				<img src="'+K((d=c.getStoreItemImage||a&&a.getStoreItemImage,e={hash:{},data:b},d?d.call(a,a,64,e):J.call(a,"getStoreItemImage",a,64,e)))+'" width="64" height="64" />\n			'}function j(a,b){var d,e,f="";return f+='\n			<img src="'+K((d=c.getStoreItemImage||a&&a.getStoreItemImage,e={hash:{},data:b},d?d.call(a,a,64,e):J.call(a,"getStoreItemImage",a,64,e)))+'" width="64" height="64" class="greyscale-image" />\n		'}function k(a,b){return'\n	<div class="app_details">\n'}function l(a,b){var d,e,f="";return f+="\n			"+K((d=c.characterLimiter||a&&a.characterLimiter,e={hash:{},data:b},d?d.call(a,a&&a.name,7,e):J.call(a,"characterLimiter",a&&a.name,7,e)))+' <span class="wb wb-16 wb-premium"></span>\n		'}function m(a,b){var d,e,f,g="";return g+="\n			",e=c.compare||a&&a.compare,f={hash:{},inverse:L.program(17,o,b),fn:L.program(15,n,b),data:b},d=e?e.call(a,a&&a.type,"STICKER",f):J.call(a,"compare",a&&a.type,"STICKER",f),(d||0===d)&&(g+=d),g+="\n		"}function n(a,b){var d,e,f="";return f+="\n				",(e=c.name)?d=e.call(a,{hash:{},data:b}):(e=a&&a.name,d=typeof e===M?e.call(a,{hash:{},data:b}):e),f+=K(d)+"\n			"}function o(a,b){var d,e,f,g="";return g+="\n				",e=c.compare||a&&a.compare,f={hash:{},inverse:L.program(20,q,b),fn:L.program(18,p,b),data:b},d=e?e.call(a,a&&a.type,"APP_ITEM",f):J.call(a,"compare",a&&a.type,"APP_ITEM",f),(d||0===d)&&(g+=d),g+="\n			"}function p(a,b){var d,e,f="";return f+="\n					",(e=c.name)?d=e.call(a,{hash:{},data:b}):(e=a&&a.name,d=typeof e===M?e.call(a,{hash:{},data:b}):e),f+=K(d)+"\n				"}function q(a,b){var d,e,f,g="";return g+="\n				",e=c.compare||a&&a.compare,f={hash:{},inverse:L.program(21,r,b),fn:L.program(18,p,b),data:b},d=e?e.call(a,a&&a.type,"GAME_ITEM",f):J.call(a,"compare",a&&a.type,"GAME_ITEM",f),(d||0===d)&&(g+=d),g+="\n				"}function r(a,b){var d,e,f,g="";return g+="\n					",f={hash:{},inverse:L.program(24,t,b),fn:L.program(22,s,b),data:b},(e=c.ifIsGiftShowerItem)?d=e.call(a,f):(e=a&&a.ifIsGiftShowerItem,d=typeof e===M?e.call(a,f):e),c.ifIsGiftShowerItem||(d=N.call(a,d,{hash:{},inverse:L.program(24,t,b),fn:L.program(22,s,b),data:b})),(d||0===d)&&(g+=d),g+="\n				"}function s(a,b){var d,e,f="";return f+="\n						"+K((d=c.characterLimiter||a&&a.characterLimiter,e={hash:{},data:b},d?d.call(a,a&&a.name,7,e):J.call(a,"characterLimiter",a&&a.name,7,e)))+' <span class="wb wb-16 wb-gift-shower"></span>\n					'}function t(a,b){var d,e,f="";return f+="\n						"+K((d=c.characterLimiter||a&&a.characterLimiter,e={hash:{},data:b},d?d.call(a,a&&a.name,10,e):J.call(a,"characterLimiter",a&&a.name,10,e)))+"\n					"}function u(a,b){var d,e,f,g="";return g+='\n		<div class="price">\n			',e=c.compare||a&&a.compare,f={hash:{},inverse:L.program(29,w,b),fn:L.program(27,v,b),data:b},d=e?e.call(a,a&&a.price,0,f):J.call(a,"compare",a&&a.price,0,f),(d||0===d)&&(g+=d),g+="\n		</div>\n	"}function v(a,b){var d,e,f="";return f+="\n				"+K((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"store|free",e):J.call(a,"translate","store|free",e)))+"\n			"}function w(a,b){var d,e,f="";return f+="\n				",(e=c.localPrice)?d=e.call(a,{hash:{},data:b}):(e=a&&a.localPrice,d=typeof e===M?e.call(a,{hash:{},data:b}):e),f+=K(d)+" ",(e=c.localCurrency)?d=e.call(a,{hash:{},data:b}):(e=a&&a.localCurrency,d=typeof e===M?e.call(a,{hash:{},data:b}):e),f+=K(d)+"\n			"}function x(a,b){var d,e,f="";return f+="\n			",(e=c.description)?d=e.call(a,{hash:{},data:b}):(e=a&&a.description,d=typeof e===M?e.call(a,{hash:{},data:b}):e),f+=K(d)+"\n		"}function y(a,b){var d,e,f,g="";return g+="\n			",f={hash:{},inverse:L.program(37,B,b),fn:L.program(34,z,b),data:b},(e=c.ifJoinedGroupAllowedToBuyItem)?d=e.call(a,f):(e=a&&a.ifJoinedGroupAllowedToBuyItem,d=typeof e===M?e.call(a,f):e),c.ifJoinedGroupAllowedToBuyItem||(d=N.call(a,d,{hash:{},inverse:L.program(37,B,b),fn:L.program(34,z,b),data:b})),(d||0===d)&&(g+=d),g+="\n		"}function z(a,b){var d,e,f,g="";return g+="\n				",f={hash:{},inverse:L.noop,fn:L.program(35,A,b),data:b},(e=c.ifIsGiftShowerItem)?d=e.call(a,f):(e=a&&a.ifIsGiftShowerItem,d=typeof e===M?e.call(a,f):e),c.ifIsGiftShowerItem||(d=N.call(a,d,{hash:{},inverse:L.noop,fn:L.program(35,A,b),data:b})),(d||0===d)&&(g+=d),g+="\n			"}function A(a,b){var d,e,f="";return f+='\n					<div title="',(e=c.getGiftShowerRestrictedTooltip)?d=e.call(a,{hash:{},data:b}):(e=a&&a.getGiftShowerRestrictedTooltip,d=typeof e===M?e.call(a,{hash:{},data:b}):e),f+=K(d)+'" style="cursor: pointer;">',(e=c.getGiftShowerRestrictedMessage)?d=e.call(a,{hash:{},data:b}):(e=a&&a.getGiftShowerRestrictedMessage,d=typeof e===M?e.call(a,{hash:{},data:b}):e),f+=K(d)+"</div>\n				"}function B(a,b){var d,e,f="";return f+="\n				",(e=c.getGroupRestrictedMessage)?d=e.call(a,{hash:{},data:b}):(e=a&&a.getGroupRestrictedMessage,d=typeof e===M?e.call(a,{hash:{},data:b}):e),(d||0===d)&&(f+=d),f+="\n			"}function C(a,b){var d,e,f="";return f+="\n			",(e=c.getMigLevelRestrictedMessage)?d=e.call(a,{hash:{},data:b}):(e=a&&a.getMigLevelRestrictedMessage,d=typeof e===M?e.call(a,{hash:{},data:b}):e),(d||0===d)&&(f+=d),f+="\n		"}function D(a,b){return"\n	</div>\n"}function E(a,b){var d,e,f="";return f+='\n		<div class="app_purchase_buttons">\n			<a class="btn-outline buy_as_gift" href="#">\n				<span class="wb wb-20 icon-wb_gift"></span>\n			</a>\n			&nbsp;\n			<a class="btn-outline buy_for_self" href="#">\n				'+K((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"common|buy",e):J.call(a,"translate","common|buy",e)))+"\n			</a>\n		</div>\n	"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var F,G,H,I="",J=c.helperMissing,K=this.escapeExpression,L=this,M="function",N=c.blockHelperMissing;return I+='<div class="store-item ',G=c.compare||b&&b.compare,H={hash:{},inverse:L.noop,fn:L.program(1,f,e),data:e},F=G?G.call(b,b&&b.type,"APP_ITEM",H):J.call(b,"compare",b&&b.type,"APP_ITEM",H),(F||0===F)&&(I+=F),I+=" ",G=c.compare||b&&b.compare,H={hash:{},inverse:L.noop,fn:L.program(1,f,e),data:e},F=G?G.call(b,b&&b.type,"GAME_ITEM",H):J.call(b,"compare",b&&b.type,"GAME_ITEM",H),(F||0===F)&&(I+=F),I+='" title="',(G=c.name)?F=G.call(b,{hash:{},data:e}):(G=b&&b.name,F=typeof G===M?G.call(b,{hash:{},data:e}):G),I+=K(F)+'">\n	<div class="image">\n		',H={hash:{},inverse:L.program(8,j,e),fn:L.program(3,g,e),data:e},(G=c.ifAllowedToBuyItem)?F=G.call(b,H):(G=b&&b.ifAllowedToBuyItem,F=typeof G===M?G.call(b,H):G),c.ifAllowedToBuyItem||(F=N.call(b,F,{hash:{},inverse:L.program(8,j,e),fn:L.program(3,g,e),data:e})),(F||0===F)&&(I+=F),I+="\n	</div>\n\n",G=c.compare||b&&b.compare,H={hash:{},inverse:L.noop,fn:L.program(10,k,e),data:e},F=G?G.call(b,b&&b.type,"APP_ITEM",H):J.call(b,"compare",b&&b.type,"APP_ITEM",H),(F||0===F)&&(I+=F),I+="\n",G=c.compare||b&&b.compare,H={hash:{},inverse:L.noop,fn:L.program(10,k,e),data:e},F=G?G.call(b,b&&b.type,"GAME_ITEM",H):J.call(b,"compare",b&&b.type,"GAME_ITEM",H),(F||0===F)&&(I+=F),I+='\n\n	<div class="title">\n		',G=c.ifPremiumItem||b&&b.ifPremiumItem,H={hash:{},inverse:L.program(14,m,e),fn:L.program(12,l,e),data:e},F=G?G.call(b,b,H):J.call(b,"ifPremiumItem",b,H),(F||0===F)&&(I+=F),I+="\n	</div>\n	",H={hash:{},inverse:L.noop,fn:L.program(26,u,e),data:e},(G=c.ifAllowedToBuyItem)?F=G.call(b,H):(G=b&&b.ifAllowedToBuyItem,F=typeof G===M?G.call(b,H):G),c.ifAllowedToBuyItem||(F=N.call(b,F,{hash:{},inverse:L.noop,fn:L.program(26,u,e),data:e})),(F||0===F)&&(I+=F),I+='\n	<div class="description">\n		',G=c.compare||b&&b.compare,H={hash:{},inverse:L.noop,fn:L.program(31,x,e),data:e},F=G?G.call(b,b&&b.type,"APP_ITEM",H):J.call(b,"compare",b&&b.type,"APP_ITEM",H),(F||0===F)&&(I+=F),I+="\n		",G=c.compare||b&&b.compare,H={hash:{},inverse:L.noop,fn:L.program(31,x,e),data:e},F=G?G.call(b,b&&b.type,"GAME_ITEM",H):J.call(b,"compare",b&&b.type,"GAME_ITEM",H),(F||0===F)&&(I+=F),I+="\n		",H={hash:{},inverse:L.program(39,C,e),fn:L.program(33,y,e),data:e},(G=c.ifMiglevelAllowedToBuyItem)?F=G.call(b,H):(G=b&&b.ifMiglevelAllowedToBuyItem,F=typeof G===M?G.call(b,H):G),c.ifMiglevelAllowedToBuyItem||(F=N.call(b,F,{hash:{},inverse:L.program(39,C,e),fn:L.program(33,y,e),data:e})),(F||0===F)&&(I+=F),I+="\n	</div>\n\n",G=c.compare||b&&b.compare,H={hash:{},inverse:L.noop,fn:L.program(41,D,e),data:e},F=G?G.call(b,b&&b.type,"APP_ITEM",H):J.call(b,"compare",b&&b.type,"APP_ITEM",H),(F||0===F)&&(I+=F),I+="\n",G=c.compare||b&&b.compare,H={hash:{},inverse:L.noop,fn:L.program(41,D,e),data:e},F=G?G.call(b,b&&b.type,"GAME_ITEM",H):J.call(b,"compare",b&&b.type,"GAME_ITEM",H),(F||0===F)&&(I+=F),I+="\n\n	",G=c.compare||b&&b.compare,H={hash:{},inverse:L.noop,fn:L.program(43,E,e),data:e},F=G?G.call(b,b&&b.type,"APP_ITEM",H):J.call(b,"compare",b&&b.type,"APP_ITEM",H),(F||0===F)&&(I+=F),I+="\n	",G=c.compare||b&&b.compare,H={hash:{},inverse:L.noop,fn:L.program(43,E,e),data:e},F=G?G.call(b,b&&b.type,"GAME_ITEM",H):J.call(b,"compare",b&&b.type,"GAME_ITEM",H),(F||0===F)&&(I+=F),I+="\n</div>"})}),define("modules/view/store/store_item_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/model/store/store_partner_model","hbs!modules/template/store/store-item-list","modules/common/config","modules/common/utility","modules/globals/session_user","modules/mig33_app","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=e.ItemView.extend({template:{type:"handlebars",template:h},id:function(){return"store-item-"+this.model.get("id")},className:function(){var a="col-xs-4 col-sm-3 col-md-2 eq-col-xs-4 eq-col-sm-3 eq-col-md-2";return"STICKER"===this.model.get("type")&&(a="col-xs-12 col-sm-4 eq-col-xs-12 eq-col-sm-4"),"APP_ITEM"!==this.model.get("type")&&"GAME_ITEM"!==this.model.get("type")||(a="col-xs-6 col-sm-4 col-md-3 eq-col-xs-6 eq-col-sm-4 eq-col-md-3"),a+=" no-padding-right "+this.model.get("type").toLowerCase(),this.model.allowedToBuyItem()?a:a+" not-allowed"},initialize:function(b){a.bindAll(this);var c=this;l.vent.on(l.ApplicationEvents.STORE_ITEM_PURCHASED+this.model.get("id"),function(a,b){c.model.set("referenceData",a.referenceData)})},events:{"click .store-item":"goToStoreItem","click .buy_as_gift":"buyAsGift","click .buy_for_self":"buyForSelf"},goToStoreItem:function(b){if(b.preventDefault(),this._add_index(),a.contains(["VIRTUAL_GIFT","STICKER","EMOTICON","AVATAR"],this.model.get("type"))){if(this.model.allowedToBuyItem()){var d="buy";"VIRTUAL_GIFT"===this.model.get("type")&&(d="gift"),j.ecommerce_send_storeClick_to_ga(this.model),j.show_gift_dialog(this.model.attributes,d)}}else"APP_ITEM"!==this.model.get("type")&&"GAME_ITEM"!==this.model.get("type")&&c.history.navigate("v4/sites/ajax/store/view_item?itid="+this.model.get("id"),{trigger:!0})},buyAsGift:function(a){a.preventDefault(),a.stopPropagation();var b=this;if(this._add_index(),("APP_ITEM"===this.model.get("type")||"GAME_ITEM"===this.model.get("type"))&&this.model.get("storePartnerId")&&this.model.allowedToBuyItem()){var c=new g({partner_id:this.model.get("storePartnerId")});c.fetch(),c.on("change",function(){b.model.attributes.storePartner=this.attributes,j.ecommerce_send_storeClick_to_ga(b.model),j.show_gift_dialog(b.model.attributes,"gift")})}},buyForSelf:function(a){a.preventDefault(),a.stopPropagation();var b=this;if(this._add_index(),("APP_ITEM"===this.model.get("type")||"GAME_ITEM"===this.model.get("type"))&&this.model.get("storePartnerId")&&this.model.allowedToBuyItem()){var c=new g({partner_id:this.model.get("storePartnerId")});c.fetch(),c.on("change",function(){b.model.attributes.storePartner=this.attributes,j.ecommerce_send_storeClick_to_ga(b.model),j.show_gift_dialog(b.model.attributes,"buy")})}},_add_index:function(){"undefined"==typeof this.model.get("index")&&this.model.set("index",this.$el.index(),{silent:!0})}});return m}),define("hbs!modules/template/store/store-item-collection",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h,i="",j="function",k=this.escapeExpression,l=c.helperMissing;return i+='<div class="font-bold font-color-caption small collection-header">\n	<span class="text-uppercase">',(g=c.category_nice_name)?f=g.call(b,{hash:{},data:e}):(g=b&&b.category_nice_name,f=typeof g===j?g.call(b,{hash:{},data:e}):g),i+=k(f)+'</span>\n	<a class="right" href="/store/category/',(g=c.category_id)?f=g.call(b,{hash:{},data:e}):(g=b&&b.category_id,f=typeof g===j?g.call(b,{hash:{},data:e}):g),i+=k(f)+'/new">'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"common|see_more",h):l.call(b,"translate","common|see_more",h)))+' > </a>\n</div>\n<div class="item-collection equalBlocks"></div>\n'})}),define("modules/view/store/store_item_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/view/store/store_item_item_view","hbs!modules/template/store/store-item-collection","modules/view/common/mig33_views","modules/template/helpers/general_helpers","modules/template/helpers/store_helpers"],function(a,b,c,d,e,f,g,h,i,j,k){var l=d.compile('{{translate "store|empty_item"}}'),m=d.compile('{{translate "common|loading"}}...'),n=e.ItemView.extend({template:{type:"handlebars",template:l},className:"empty margin-left-15px"}),o=e.ItemView.extend({template:{type:"handlebars",template:m},className:"loading margin-left-15px"}),p=k.CompositeView.extend({itemView:i,emptyView:n,loadingView:o,className:"row no-margin-right",itemViewContainer:".item-collection",template:j,initialize:function(c){a.bindAll(this);var d=this;this.on("render",function(){b(window).on("scroll",function(a){d.more(a)})}),this.on("close",function(){b(window).off("scroll")}),this.collection.on("fetched",function(){d.sendImpression(),b(window).on("load resize",d.equaliseBlocks),d.equaliseBlocks()})},onRender:function(){this.options.showHeader?this.showHeader():this.hideHeader()},prevScrollY:0,page:1,more:function(){var a=b(window).scrollTop()+b(window).height(),c=b(window).get(0).scrollHeight;c||(c=b(document).height()),a>=c-g.variable.infinitescroll_height&&this.prevScrollY<a&&this.trigger("store:item:more",++this.page),this.prevScrollY=a},showHeader:function(){b(".collection-header",this.$el).show()},hideHeader:function(){b(".collection-header",this.$el).hide()},sendImpression:function(){var a=this.collection.getLimit(),b=(this.collection.getPage()-1)*a;if(!(this.collection.length<=b)){var c=this.collection.models.slice(b);h.ecommerce_send_impressions_to_ga(c)}},equaliseBlocks:function(){b.fn.eqHeights=function(a){var c={child:!1,parentSelector:null},d=b.extend(c,a),e=b(this);e.length>0&&!e.data("eqHeights")&&(b(window).bind("resize.eqHeights",function(){e.eqHeights()}),e.data("eqHeights",!0));var f;f=d.child&&d.child.length>0?b(d.child,this):b(this).children().find(".description");var g,h=Math.floor(b(this[0]).parent().width()/b(this[0]).width()),i=0,j=0,k=[];f.height("auto").each(function(){d.parentSelector&&g!==b(this).parents(d.parentSelector).get(0)&&(b(k).height(j),j=0,i=0,k=[],g=b(this).parents(d.parentSelector).get(0));var a=this.offsetTop;i>0&&i!=a&&(b(k).height(j),j=b(this).height(),k=[]),j=Math.max(j,b(this).height()),i=this.offsetTop,k.push(this),k.length>=h&&(b(k).height(j),j=0,k=[])})},b('.equalBlocks [class*="eq-"]').eqHeights({parentSelector:".equalBlocks"})}});return p}),define("hbs!modules/template/store/store-item-received",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var c,d="";return d+='\n			<div class="image app-ico-header">\n				<img src="'+o((c=a&&a.storePartner,c=null==c||c===!1?c:c.content_data,c=null==c||c===!1?c:c.logo_image,typeof c===n?c.apply(a):c))+'" height="48" />\n				<span class="app-title padding-8px">\n					<div class="app-name">'+o((c=a&&a.storePartner,c=null==c||c===!1?c:c.store_category_name,typeof c===n?c.apply(a):c))+'</div>\n					<div class="company-name font-size-14">'+o((c=a&&a.storePartner,c=null==c||c===!1?c:c.name,typeof c===n?c.apply(a):c))+"</div>\n				</span>\n			</div>\n		"}function g(a,b){return"app-item-img"}function h(a,b){var d,e,f="";return f+='\n		<div class="message">\n			',(e=c.message)?d=e.call(a,{
hash:{},data:b}):(e=a&&a.message,d=typeof e===n?e.call(a,{hash:{},data:b}):e),f+=o(d)+"\n		</div>\n	"}function i(a,b){var d,e,f,g="";return g+='\n	<div class="premium">\n		<span class="wb wb-16 wb-premium"></span> ',e=c.getCongratsPremiumItemMessage||a&&a.getCongratsPremiumItemMessage,f={hash:{},data:b},d=e?e.call(a,a&&a.storeItemData,f):p.call(a,"getCongratsPremiumItemMessage",a&&a.storeItemData,f),(d||0===d)&&(g+=d),g+="\n	</div>\n"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var j,k,l,m="",n="function",o=this.escapeExpression,p=c.helperMissing,q=this;return m+='<div class="store-item-received-bg">\n	<div class="store-item-icon">\n		',k=c.isNotEmpty||b&&b.isNotEmpty,l={hash:{},inverse:q.noop,fn:q.program(1,f,e),data:e},j=k?k.call(b,(j=b&&b.storePartner,j=null==j||j===!1?j:j.content_data,null==j||j===!1?j:j.logo_image),l):p.call(b,"isNotEmpty",(j=b&&b.storePartner,j=null==j||j===!1?j:j.content_data,null==j||j===!1?j:j.logo_image),l),(j||0===j)&&(m+=j),m+='\n		<div class="item-details ',k=c.isNotEmpty||b&&b.isNotEmpty,l={hash:{},inverse:q.noop,fn:q.program(3,g,e),data:e},j=k?k.call(b,(j=b&&b.storePartner,j=null==j||j===!1?j:j.content_data,null==j||j===!1?j:j.logo_image),l):p.call(b,"isNotEmpty",(j=b&&b.storePartner,j=null==j||j===!1?j:j.content_data,null==j||j===!1?j:j.logo_image),l),(j||0===j)&&(m+=j),m+='">\n			<img src="'+o((k=c.getStoreItemImage||b&&b.getStoreItemImage,l={hash:{},data:e},k?k.call(b,b&&b.storeItemData,64,l):p.call(b,"getStoreItemImage",b&&b.storeItemData,64,l)))+'" width="64" height="64" />\n		</div>\n	</div>\n	<div class="title font-light">',(k=c.getReceivedItemMessage)?j=k.call(b,{hash:{},data:e}):(k=b&&b.getReceivedItemMessage,j=typeof k===n?k.call(b,{hash:{},data:e}):k),(j||0===j)&&(m+=j),m+="</div>\n	\n	",j=c["if"].call(b,b&&b.message,{hash:{},inverse:q.noop,fn:q.program(5,h,e),data:e}),(j||0===j)&&(m+=j),m+="\n\n	<div class='item-received-sign'>",(k=c.getReceivedItemMessageSignature)?j=k.call(b,{hash:{},data:e}):(k=b&&b.getReceivedItemMessageSignature,j=typeof k===n?k.call(b,{hash:{},data:e}):k),(j||0===j)&&(m+=j),m+='</div>\n\n	<div class="store-message">',(k=c.getCXBMessage)?j=k.call(b,{hash:{},data:e}):(k=b&&b.getCXBMessage,j=typeof k===n?k.call(b,{hash:{},data:e}):k),(j||0===j)&&(m+=j),m+="</div>\n\n</div>\n",k=c.ifPremiumItem||b&&b.ifPremiumItem,l={hash:{},inverse:q.noop,fn:q.program(7,i,e),data:e},j=k?k.call(b,b&&b.storeItemData,l):p.call(b,"ifPremiumItem",b&&b.storeItemData,l),(j||0===j)&&(m+=j),m})}),define("modules/view/store/store_item_received_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","modules/mig33_app","marionette_handlebars","hbs!modules/template/store/store-item-received","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j){var k=e.ItemView.extend({template:{type:"handlebars",template:h},id:function(){return"store-item-received-"+this.model.get("id")},initialize:function(a){}});return k}),define("hbs!modules/template/store/store-item-give",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var c,d="";return d+='\n			<div class="image app-ico-header">\n				<img src="'+r((c=a&&a.storePartner,c=null==c||c===!1?c:c.content_data,c=null==c||c===!1?c:c.logo_image,typeof c===q?c.apply(a):c))+'" height="48" />\n				<span class="app-title padding-8px">\n					<div class="app-name">'+r((c=a&&a.storePartner,c=null==c||c===!1?c:c.store_category_name,typeof c===q?c.apply(a):c))+'</div>\n					<div class="company-name font-size-14">'+r((c=a&&a.storePartner,c=null==c||c===!1?c:c.name,typeof c===q?c.apply(a):c))+"</div>\n				</span>\n			</div>\n		"}function g(a,b){return"app-item-img"}function h(a,b){var d,e,f="";return f+='\n					<div class="col-xs-3">\n						<label>\n							<input type="checkbox" name="private" value="1" />&nbsp;&nbsp;'+r((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"store|private_gift",e):s.call(a,"translate","store|private_gift",e)))+'\n						</label>\n					</div><div class="col-xs-5">\n						<label>\n							<input type="checkbox" name="post_to_miniblog" value="1" />&nbsp;&nbsp;'+r((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"store|post_to_miniblog",e):s.call(a,"translate","store|post_to_miniblog",e)))+"\n						</label>\n					</div>\n				"}function i(a,b){var d,e,f="";return f+='\n					<div class="col-xs-3">\n						<label>\n							<input type="checkbox" name="private" value="1" />&nbsp;&nbsp;'+r((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"store|private_gift",e):s.call(a,"translate","store|private_gift",e)))+"\n						</label>\n					</div>\n				"}function j(a,b){var d,e,f,g="";return g+='\n			<input type="button" name="purchase_item" class="btn btn-button btn-default" value="',(e=c.sendItemButton)?d=e.call(a,{hash:{},data:b}):(e=a&&a.sendItemButton,d=typeof e===q?e.call(a,{hash:{},data:b}):e),g+=r(d)+" "+r((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"store|item",f):s.call(a,"translate","store|item",f)))+'" disabled />\n			'}function k(a,b){var d,e,f,g="";return g+="\n			",e=c.compare||a&&a.compare,f={hash:{},inverse:t.program(12,l,b),fn:t.program(9,j,b),data:b},d=e?e.call(a,a&&a.type,"GAME_ITEM",f):s.call(a,"compare",a&&a.type,"GAME_ITEM",f),(d||0===d)&&(g+=d),g+="\n			"}function l(a,b){var d,e,f="";return f+='\n			<input type="button" name="purchase_item" class="btn btn-button btn-default" value="'+r((d=c.sendItemButton||a&&a.sendItemButton,e={hash:{},data:b},d?d.call(a,a&&a.storeItemData,e):s.call(a,"sendItemButton",a&&a.storeItemData,e)))+'" disabled />\n			'}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var m,n,o,p="",q="function",r=this.escapeExpression,s=c.helperMissing,t=this;return p+='<div class="detail">\n	<div class="store-item-icon">\n		',n=c.isNotEmpty||b&&b.isNotEmpty,o={hash:{},inverse:t.noop,fn:t.program(1,f,e),data:e},m=n?n.call(b,(m=b&&b.storePartner,m=null==m||m===!1?m:m.content_data,null==m||m===!1?m:m.logo_image),o):s.call(b,"isNotEmpty",(m=b&&b.storePartner,m=null==m||m===!1?m:m.content_data,null==m||m===!1?m:m.logo_image),o),(m||0===m)&&(p+=m),p+='\n\n		<div class="item-details ',n=c.compare||b&&b.compare,o={hash:{},inverse:t.noop,fn:t.program(3,g,e),data:e},m=n?n.call(b,b&&b.type,"APP_ITEM",o):s.call(b,"compare",b&&b.type,"APP_ITEM",o),(m||0===m)&&(p+=m),p+=" ",n=c.compare||b&&b.compare,o={hash:{},inverse:t.noop,fn:t.program(3,g,e),data:e},m=n?n.call(b,b&&b.type,"GAME_ITEM",o):s.call(b,"compare",b&&b.type,"GAME_ITEM",o),(m||0===m)&&(p+=m),p+='">\n			<img src="'+r((n=c.getStoreItemImage||b&&b.getStoreItemImage,o={hash:{},data:e},n?n.call(b,b&&b.storeItemData,64,o):s.call(b,"getStoreItemImage",b&&b.storeItemData,64,o)))+'" width="64" height="64" />\n			<div class="details">\n				<div class="title font-bold">'+r((m=b&&b.storeItemData,m=null==m||m===!1?m:m.name,typeof m===q?m.apply(b):m))+'</div>\n				<span class="price">'+r((m=b&&b.storeItemData,m=null==m||m===!1?m:m.localPrice,typeof m===q?m.apply(b):m))+" "+r((m=b&&b.storeItemData,m=null==m||m===!1?m:m.localCurrency,typeof m===q?m.apply(b):m))+'</span>\n			</div>\n		</div>\n	</div>\n\n	<div class="quantity font-size-14 padding-12-15px">\n		',(n=c.getInventoryItemUnlockedTitle)?m=n.call(b,{hash:{},data:e}):(n=b&&b.getInventoryItemUnlockedTitle,m=typeof n===q?n.call(b,{hash:{},data:e}):n),p+=r(m)+'\n	</div>\n	<div class="message">\n		',(n=c.getInventoryItemUnlockedMessage)?m=n.call(b,{hash:{},data:e}):(n=b&&b.getInventoryItemUnlockedMessage,m=typeof n===q?n.call(b,{hash:{},data:e}):n),p+=r(m)+'\n	</div>\n</div>\n\n\n<div class="body allowed-to-buy">\n	<form class="purchase-form" action="/store/item/'+r((m=b&&b.storeItemData,m=null==m||m===!1?m:m.id,typeof m===q?m.apply(b):m))+'/purchase" method="post">\n		<div class="to">\n			<input type="text" id="to" value="" disabled />\n		</div>\n		<div class="message">\n			<textarea name="message" rows="1" cols="100"></textarea>\n		</div>\n		<div class="options">\n			<div class="row">\n				',n=c.compare||b&&b.compare,o={hash:{},inverse:t.noop,fn:t.program(5,h,e),data:e},m=n?n.call(b,(m=b&&b.storeItemData,null==m||m===!1?m:m.type),"VIRTUAL_GIFT",o):s.call(b,"compare",(m=b&&b.storeItemData,null==m||m===!1?m:m.type),"VIRTUAL_GIFT",o),(m||0===m)&&(p+=m),p+="\n				",n=c.compare||b&&b.compare,o={hash:{},inverse:t.noop,fn:t.program(7,i,e),data:e},m=n?n.call(b,b&&b.type,"APP_ITEM_WHEN_FUSION_READY.add post to miniblog to all as well",o):s.call(b,"compare",b&&b.type,"APP_ITEM_WHEN_FUSION_READY.add post to miniblog to all as well",o),(m||0===m)&&(p+=m),p+='\n			</div>\n		</div>\n		<div class="send text-center">\n			',n=c.compare||b&&b.compare,o={hash:{},inverse:t.program(11,k,e),fn:t.program(9,j,e),data:e},m=n?n.call(b,b&&b.type,"APP_ITEM",o):s.call(b,"compare",b&&b.type,"APP_ITEM",o),(m||0===m)&&(p+=m),p+="\n		</div>\n	</form>\n</div>"})}),define("modules/view/store/store_item_inventory_give_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","modules/mig33_app","marionette_handlebars","modules/view/store/store_item_detail_item_view","hbs!modules/template/store/store-item-give","modules/common/config","modules/common/utility","jquery.tag-it","jquery.json","modules/template/helpers/general_helpers","jquery.scrollTo"],function(a,b,c,d,e,f,g,h,i,j,k){var l=h.extend({template:{type:"handlebars",template:i},events:{'click input[name="purchase_item"]':"giveitem"},id:function(){return"store-item-details-"+this.model.get("id")},initialize:function(a){f||(f=require("modules/mig33_app"))},onRender:function(){var a=this,c=require("modules/chat/models/contacts").ContactGroupStore.getInstance();c.is_contacts_loaded()?this.autoCompleteWhoField(c.get_all_contacts()):c.on("contacts_load_complete",function(){a.autoCompleteWhoField(c.get_all_contacts())},this),b.scrollTo(0)},autoCompleteWhoField:function(a){var c=this,d=[],e=b("#to",this.$el);a.each(function(a){a.isFusionContact()&&d.push(a.getUsername())}),e.prop("disabled",!1).tagit({fieldName:"to",caseSensitive:!1,tagLimit:this.model.get("count"),autocomplete:{delay:1,minLength:3,autoFocus:!0},availableTags:d,onTagLimitExceeded:function(){k.show_error(k.translate("store|error_max_recipient",c.model.getTypeNiceNameSingular(),c.model.get("count")))},beforeTagAdded:function(a,d){var e=/^([\w\d\.\-]{1,42})$/,f=b(d.tag[0]).text(),g=f.substr(0,f.length-1),h=e.test(g);return h?void 0:(k.show_error(k.translate("store|error_username",g)),c.disablePurchase(),!1)},afterTagAdded:function(){c.enablePurchase()},beforeTagRemoved:function(){}})},giveitem:function(a){a.preventDefault(),b(a.currentTarget,this.$el).prop("disabled",!0);var c=this,d={to:b.trim(b("#to").val()),message:b.trim(b('textarea[name="message"]').val()),"private":(!!b('input[name="private"]:checked').length).toString(),postToMiniblog:(!!b('input[name="post_to_miniblog"]:checked').length).toString()},e=this.model.give(d);e.done(function(e,g,h){return"undefined"==typeof e?!1:(e=k.parse_ajax_response(e),void("undefined"!=typeof e.id?f.vent.trigger(f.ApplicationEvents.STORE_ITEM_PURCHASED,e,d.to.split(",")):(e.error?k.show_error(e.error):k.show_error(k.translate("store|error_purchase",c.model.getTypeNiceNameSingular())),b(a.currentTarget,this.$el).prop("disabled",!1))))})}});return l}),define("hbs!modules/template/store/store-item-purchase-success-layout",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var c,d="";return d+='\n			<div class="image app-ico-header">\n				<img src="'+o((c=a&&a.storePartner,c=null==c||c===!1?c:c.content_data,c=null==c||c===!1?c:c.logo_image,typeof c===n?c.apply(a):c))+'" height="48" />\n				<span class="app-title padding-8px">\n					<div class="app-name">'+o((c=a&&a.storePartner,c=null==c||c===!1?c:c.store_category_name,typeof c===n?c.apply(a):c))+'</div>\n					<div class="company-name font-size-14">'+o((c=a&&a.storePartner,c=null==c||c===!1?c:c.name,typeof c===n?c.apply(a):c))+"</div>\n				</span>\n			</div>\n		"}function g(a,b){return"app-item-img"}function h(a,b){var d,e,f="";return f+='\n					<span class="price">'+o((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"store|free",e):p.call(a,"translate","store|free",e)))+"</span>\n				"}function i(a,b){var d,e,f="";return f+='\n					<span class="price">',(e=c.localPrice)?d=e.call(a,{hash:{},data:b}):(e=a&&a.localPrice,d=typeof e===n?e.call(a,{hash:{},data:b}):e),f+=o(d)+" ",(e=c.localCurrency)?d=e.call(a,{hash:{},data:b}):(e=a&&a.localCurrency,d=typeof e===n?e.call(a,{hash:{},data:b}):e),f+=o(d)+"</span>\n				"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var j,k,l,m="",n="function",o=this.escapeExpression,p=c.helperMissing,q=this;return m+='<div class="success">\n	<div class="store-item-icon">\n		',k=c.isNotEmpty||b&&b.isNotEmpty,l={hash:{},inverse:q.noop,fn:q.program(1,f,e),data:e},j=k?k.call(b,(j=b&&b.storePartner,j=null==j||j===!1?j:j.content_data,null==j||j===!1?j:j.logo_image),l):p.call(b,"isNotEmpty",(j=b&&b.storePartner,j=null==j||j===!1?j:j.content_data,null==j||j===!1?j:j.logo_image),l),(j||0===j)&&(m+=j),m+='\n		<div class="item-details ',k=c.compare||b&&b.compare,l={hash:{},inverse:q.noop,fn:q.program(3,g,e),data:e},j=k?k.call(b,b&&b.type,"APP_ITEM",l):p.call(b,"compare",b&&b.type,"APP_ITEM",l),(j||0===j)&&(m+=j),m+=" ",k=c.compare||b&&b.compare,l={hash:{},inverse:q.noop,fn:q.program(3,g,e),data:e},j=k?k.call(b,b&&b.type,"GAME_ITEM",l):p.call(b,"compare",b&&b.type,"GAME_ITEM",l),(j||0===j)&&(m+=j),m+='">\n			<img src="'+o((k=c.getStoreItemImage||b&&b.getStoreItemImage,l={hash:{},data:e},k?k.call(b,b,64,l):p.call(b,"getStoreItemImage",b,64,l)))+'" width="64" height="64" />\n			<div class="details">\n				<div class="title">',(k=c.name)?j=k.call(b,{hash:{},data:e}):(k=b&&b.name,j=typeof k===n?k.call(b,{hash:{},data:e}):k),m+=o(j)+"</div>\n				",k=c.compare||b&&b.compare,l={hash:{},inverse:q.program(7,i,e),fn:q.program(5,h,e),data:e},j=k?k.call(b,b&&b.price,0,l):p.call(b,"compare",b&&b.price,0,l),(j||0===j)&&(m+=j),m+='\n			</div>\n		</div>\n	</div>\n\n	<div class="store-message">',k=c.successTitle||b&&b.successTitle,l={hash:{},data:e},j=k?k.call(b,b,l):p.call(b,"successTitle",b,l),(j||0===j)&&(m+=j),m+='</div>\n	<div class="recipients"></div>\n	<div class="message">'+o((k=c.successMessage||b&&b.successMessage,l={hash:{},data:e},k?k.call(b,b,l):p.call(b,"successMessage",b,l)))+"</div>\n</div>"})}),define("modules/view/store/store_item_purchase_success_layout",["jquery","underscore","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","hbs!modules/template/store/store-item-purchase-success-layout","modules/template/helpers/general_helpers","modules/template/helpers/store_helpers"],function(a,b,c,d,e,f,g,h,i,j){var k=e.Layout.extend({template:{type:"handlebars",template:i},regions:{recipients:".recipients"}});return k}),define("hbs!modules/template/store/store-item-purchase-success-recipient",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h,i="",j=c.helperMissing,k=this.escapeExpression,l="function";return i+='<a href="'+k((g=c.getProfileUrl||b&&b.getProfileUrl,h={hash:{},data:e},g?g.call(b,b&&b.recipient,h):j.call(b,"getProfileUrl",b&&b.recipient,h)))+'" class="profile-hovercard" data-username="',(g=c.recipient)?f=g.call(b,{hash:{},data:e}):(g=b&&b.recipient,f=typeof g===l?g.call(b,{hash:{},data:e}):g),i+=k(f)+'">\n	<img src="'+k((g=c.getUrl||b&&b.getUrl,h={hash:{},data:e},g?g.call(b,"image",h):j.call(b,"getUrl","image",h)))+"/dp/",(g=c.recipient)?f=g.call(b,{hash:{},data:e}):(g=b&&b.recipient,f=typeof g===l?g.call(b,{hash:{},data:e}):g),i+=k(f)+'?w=64&h=64&a=1&c=1" width="64" height="64" class="img-circle" />\n</a>\n<br />\n<a href="'+k((g=c.getProfileUrl||b&&b.getProfileUrl,h={hash:{},data:e},g?g.call(b,b&&b.recipient,h):j.call(b,"getProfileUrl",b&&b.recipient,h)))+'" class="profile-hovercard" data-username="',(g=c.recipient)?f=g.call(b,{hash:{},data:e}):(g=b&&b.recipient,f=typeof g===l?g.call(b,{hash:{},data:e}):g),i+=k(f)+'">\n	',(g=c.recipient)?f=g.call(b,{hash:{},data:e}):(g=b&&b.recipient,f=typeof g===l?g.call(b,{hash:{},data:e}):g),i+=k(f)+"\n</a>"})}),define("modules/view/store/store_item_purchase_success_recipient_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","modules/mig33_app","marionette_handlebars","hbs!modules/template/store/store-item-purchase-success-recipient","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j){var k=e.ItemView.extend({template:{type:"handlebars",template:h},tagName:"li",onRender:function(){j.parse_profile_hovercard(this)}});return k}),define("modules/view/store/store_item_purchase_success_recipient_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/view/store/store_item_purchase_success_recipient_item_view","modules/view/common/mig33_views","modules/template/helpers/general_helpers","modules/template/helpers/store_helpers"],function(a,b,c,d,e,f,g,h,i,j){var k=j.CollectionView.extend({itemView:i,tagName:"ul",className:"list-inline",initialize:function(b){a.bindAll(this)}});return k}),define("hbs!modules/template/store/store-item-inventory-success-layout",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="success">\n	<div class="image"><img src="'+j((f=c.getStoreItemImage||b&&b.getStoreItemImage,g={hash:{},data:e},f?f.call(b,b&&b.storeItemData,64,g):i.call(b,"getStoreItemImage",b&&b.storeItemData,64,g)))+'" width="64" height="64" /></div>\n	<div class="title">'+j((f=c.successTitle||b&&b.successTitle,g={hash:{},data:e},f?f.call(b,b&&b.storeItemData,g):i.call(b,"successTitle",b&&b.storeItemData,g)))+'</div>\n	<div class="recipients"></div>\n	<div class="message">'+j((f=c.successMessage||b&&b.successMessage,g={hash:{},data:e},f?f.call(b,b&&b.storeItemData,g):i.call(b,"successMessage",b&&b.storeItemData,g)))+"</div>\n</div>"})}),define("modules/view/store/store_item_inventory_success_layout",["jquery","underscore","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","hbs!modules/template/store/store-item-inventory-success-layout","modules/template/helpers/general_helpers","modules/template/helpers/store_helpers"],function(a,b,c,d,e,f,g,h,i,j){var k=e.Layout.extend({template:{type:"handlebars",template:i},regions:{recipients:".recipients"}});return k}),define("hbs!modules/template/store/store-item-inventory-list",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h,i="",j=c.helperMissing,k=this.escapeExpression,l="function";return i+='<div class="store-item">\n	<div class="image">\n		<img src="'+k((g=c.getStoreItemImage||b&&b.getStoreItemImage,h={hash:{},data:e},g?g.call(b,b&&b.storeItemData,64,h):j.call(b,"getStoreItemImage",b&&b.storeItemData,64,h)))+'" width="64" height="64" />\n	</div>\n	<div class="title" title="'+k((f=b&&b.storeItemData,f=null==f||f===!1?f:f.name,typeof f===l?f.apply(b):f))+'">\n		',(g=c.count)?f=g.call(b,{hash:{},data:e}):(g=b&&b.count,f=typeof g===l?g.call(b,{hash:{},data:e}):g),i+=k(f)+"&nbsp;"+k((f=b&&b.storeItemData,f=null==f||f===!1?f:f.name,typeof f===l?f.apply(b):f))+'\n	</div>\n	<div class="price">'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"common|unlocked",h):j.call(b,"translate","common|unlocked",h)))+"</div>\n</div>"})}),define("modules/view/store/store_item_inventory_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/store/store-item-inventory-list","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i){var j=e.ItemView.extend({template:{type:"handlebars",template:g},id:function(){return"store-item-inventory-"+this.model.get("id")},className:function(){var a="col-xs-3";return"STICKER"===this.model.get("storeItemData").type&&(a="col-xs-6"),"APP_ITEM"!==this.model.get("storeItemData").type&&"GAME_ITEM"!==this.model.get("storeItemData").type||(a="col-xs-12"),a+=" no-padding-right "+this.model.get("storeItemData").type.toLowerCase()},initialize:function(b){a.bindAll(this)},events:{"click .store-item":"goToStoreItemInventory"},goToStoreItemInventory:function(a){a.preventDefault(),this._add_index(),"APP_ITEM"!==this.model.get("storeItemData").type&&"GAME_ITEM"!==this.model.get("storeItemData").type&&(i.ecommerce_send_storeClick_to_ga(new c.Model(this.model.attributes.storeItemData)),this.model.goToStoreItemInventory())},_add_index:function(){"undefined"==typeof this.model.attributes.storeItemData.index&&(this.model.attributes.storeItemData.index=this.$el.index())}});return j}),define("hbs!modules/template/store/store-item-inventory-collection",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="store-content-header">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"store|inventory_congrats",g):i.call(b,"translate","store|inventory_congrats",g)))+'</div>\n<div id="store-item-inventory-list" class="row no-margin-right clearfix"></div>'})}),define("modules/view/store/store_item_inventory_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/view/store/store_item_inventory_item_view","hbs!modules/template/store/store-item-inventory-collection","modules/view/common/mig33_views","modules/template/helpers/general_helpers","modules/template/helpers/store_helpers"],function(a,b,c,d,e,f,g,h,i,j,k){var l=d.compile('{{translate "store|empty_item"}}'),m=d.compile('{{translate "common|loading"}}...'),n=e.ItemView.extend({template:{type:"handlebars",template:l},className:"empty"}),o=e.ItemView.extend({template:{type:"handlebars",template:m},className:"loading"}),p=k.CompositeView.extend({itemView:i,emptyView:n,loadingView:o,itemViewContainer:"#store-item-inventory-list",template:{type:"handlebars",template:j},initialize:function(b){a.bindAll(this)}});return p}),define("modules/model/store/store_category_model",["underscore","backbone","modules/mig33_app","modules/common/config","modules/common/utility"],function(a,b,c,d,e){var f=b.Model.extend({initialize:function(a){this.options=a},url:function(){return e.format(d.urls.store_category,this.options.category_id)}});return f}),define("modules/model/store/store_category_collection",["underscore","modules/model/common/mig33_collection","modules/mig33_app","modules/common/config","modules/common/utility","modules/model/store/store_category_model","modules/common/session_user"],function(a,b,c,d,e,f,g){var h=b.extend({model:f,initialize:function(a,b){this.options=b},url:function(){return e.format(d.urls.store_categories,this.options.category_id)},parse:function(b,c){return b.data&&!a.isUndefined(b.data)&&null!==b.data?b.data:[]}});return h}),define("modules/model/store/store_item_inventory_model",["underscore","backbone","modules/mig33_app","modules/common/config","modules/common/utility","modules/common/session_user"],function(a,b,c,d,e,f){var g=b.Model.extend({initialize:function(a){this.options=a},url:function(){return e.format(d.urls.user_store_item_inventory,this.options.username,this.options.item_id)+"?type="+this.options.type},goToStoreItemInventory:function(){b.history.navigate("u/"+f.getInstance().get("username")+"/store/"+d.store.type_to_category[this.get("storeItemData").type]+"/inventory/"+this.get("storeItemData").id,{trigger:!0})},give:function(a){var b=this,c=$.ajax({type:"post",dataType:"json",url:e.format(d.urls.user_store_item_inventory_give,f.getInstance().get("username"),b.get("storeItemData").id),data:$.toJSON(a)});return c.done(function(a){e.send_event_to_ga("Store","Give Item","Item "+b.get("id"))}),c.fail(function(a,b,c){e.show_error(c)}),c},getTypeNiceNameSingular:function(){var a="";switch(this.get("type")){case"VIRTUAL_GIFT":a=e.translate("user|gift");break;case"AVATAR":a=e.translate("user|avatar");break;case"EMOTICON":a=e.translate("chat|emoticon");break;case"STICKER":a=e.translate("chat|sticker");break;case"APP_ITEM":a=e.translate("store|applications_item");break;case"GAME_ITEM":a=e.translate("store|games_item")}return a}});return g}),define("modules/model/store/store_item_inventory_collection",["modules/model/common/mig33_collection","modules/mig33_app","modules/common/config","modules/common/utility","modules/model/store/store_item_inventory_model","underscore"],function(a,b,c,d,e,f){var g=a.extend({totalResults:0,model:e,initialize:function(a,b){this.options=b;var c=this;this.on("fetched",function(){c.sendImpression()})},url:function(){return d.format(c.urls.user_store_items_inventory,this.options.username)+"?type="+this.options.type+"&offset="+(this.currentPage-1)*c.store.items.received.limit+"&limit="+c.store.items.received.limit},parse:function(a,b){return a.data&&!f.isUndefined(a.data)&&null!==a.data?a.data:[]},sendImpression:function(){d.ecommerce_send_impressions_to_ga(this.models)}});return g}),define("hbs!modules/template/banner/store",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e="";return e+='\n	<ol class="carousel-indicators">\n		',d=c.each.call(a,a&&a.items,{hash:{},inverse:y.noop,fn:y.program(2,g,b),data:b}),(d||0===d)&&(e+=d),e+="\n	</ol>\n"}function g(a,b){var d,e,f,g="";return g+="\n			",e=c.compare||a&&a.compare,f={hash:{},inverse:y.program(5,i,b),fn:y.program(3,h,b),data:b},d=e?e.call(a,null==b||b===!1?b:b.index,0,f):z.call(a,"compare",null==b||b===!1?b:b.index,0,f),(d||0===d)&&(g+=d),g+="\n		"}function h(a,b){var c,d="";return d+='\n				<li data-target="#banner-store" data-slide-to="'+x((c=null==b||b===!1?b:b.index,typeof c===w?c.apply(a):c))+'" class="active"></li>\n			'}function i(a,b){var c,d="";return d+='\n				<li data-target="#banner-store" data-slide-to="'+x((c=null==b||b===!1?b:b.index,typeof c===w?c.apply(a):c))+'"></li>\n			'}function j(a,b){var d,e="";return e+='\n	<div class="carousel-inner">\n		',d=c.each.call(a,a&&a.items,{hash:{},inverse:y.noop,fn:y.program(8,k,b),data:b}),(d||0===d)&&(e+=d),e+="\n	</div>\n"}function k(a,b){var d,e,f,g="";return g+="\n			",e=c.compare||a&&a.compare,f={hash:{},inverse:y.program(11,m,b),fn:y.program(9,l,b),data:b},d=e?e.call(a,null==b||b===!1?b:b.index,0,f):z.call(a,"compare",null==b||b===!1?b:b.index,0,f),(d||0===d)&&(g+=d),g+="\n			",d=c["if"].call(a,a&&a.url,{hash:{},inverse:y.program(16,p,b),fn:y.program(13,n,b),data:b}),(d||0===d)&&(g+=d),g+="\n		</div>\n		"}function l(a,b){return'\n				<div class="item active">\n			'}function m(a,b){return'\n				<div class="item">\n			'}function n(a,b){var d,e,f="";return f+='\n				<a href="',(e=c.url)?d=e.call(a,{hash:{},data:b}):(e=a&&a.url,d=typeof e===w?e.call(a,{hash:{},data:b}):e),f+=x(d)+'" class="banner_a">\n					',d=c["if"].call(a,a&&a.imageUrl,{hash:{},inverse:y.noop,fn:y.program(14,o,b),data:b}),(d||0===d)&&(f+=d),f+="\n				</a>\n			"}function o(a,b){var d,e,f="";return f+='\n						<img src="',(e=c.imageUrl)?d=e.call(a,{hash:{},data:b}):(e=a&&a.imageUrl,d=typeof e===w?e.call(a,{hash:{},data:b}):e),f+=x(d)+'" />\n					'}function p(a,b){var d,e="";return e+="\n				",d=c["if"].call(a,a&&a.imageUrl,{hash:{},inverse:y.noop,fn:y.program(17,q,b),data:b}),(d||0===d)&&(e+=d),e+="\n			"}function q(a,b){var d,e,f="";return f+='\n					<img src="',(e=c.imageUrl)?d=e.call(a,{hash:{},data:b}):(e=a&&a.imageUrl,d=typeof e===w?e.call(a,{hash:{},data:b}):e),f+=x(d)+'" />\n				'}function r(a,b){return'\n	<!-- Left and right controls -->\n  	<a class="left carousel-control" href="#banner-store" role="button" data-slide="prev">\n    	<span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>\n    	<span class="sr-only">Previous</span>\n  	</a>\n  	<a class="right carousel-control" href="#banner-store" role="button" data-slide="next">\n   		<span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>\n    	<span class="sr-only">Next</span>\n  	</a>\n'}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var s,t,u,v="",w="function",x=this.escapeExpression,y=this,z=c.helperMissing;return t=c.compare||b&&b.compare,u={hash:{operator:">"},inverse:y.noop,fn:y.program(1,f,e),data:e},s=t?t.call(b,(s=b&&b.items,null==s||s===!1?s:s.length),1,u):z.call(b,"compare",(s=b&&b.items,null==s||s===!1?s:s.length),1,u),(s||0===s)&&(v+=s),v+="\n",t=c.compare||b&&b.compare,u={hash:{operator:">"},inverse:y.noop,fn:y.program(7,j,e),data:e},s=t?t.call(b,(s=b&&b.items,null==s||s===!1?s:s.length),0,u):z.call(b,"compare",(s=b&&b.items,null==s||s===!1?s:s.length),0,u),(s||0===s)&&(v+=s),v+="\n",t=c.compare||b&&b.compare,u={hash:{operator:">"},inverse:y.noop,fn:y.program(19,r,e),data:e},s=t?t.call(b,(s=b&&b.items,null==s||s===!1?s:s.length),1,u):z.call(b,"compare",(s=b&&b.items,null==s||s===!1?s:s.length),1,u),(s||0===s)&&(v+=s),v})}),define("modules/view/banner/store",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/banner/store","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i){var j=e.ItemView.extend({template:{type:"handlebars",template:g},id:"banner-store",className:"carousel slide",events:{"click .close":"close"},onRender:function(){this.collection.length>0&&b(this.$el).show().data("ride","carousel").carousel({interval:5e3}),b(this.$el).find(".banner_a").click(function(){i.send_event_to_ga("Miniblog","DiscoverBanner",b(this).find("img").attr("src"))})},close:function(c){a.isUndefined(c)||null===c||(c.preventDefault(),b(this.$el).remove())}});return j}),define("modules/controller/store_controller",["underscore","backbone","backbone.marionette","modules/mig33_app","modules/common/config","modules/common/utility","modules/common/session_user","modules/chat/models/user_session","modules/view/store/store_layout","modules/view/store/store_item_purchase_layout","modules/view/store/store_item_received_layout","modules/view/store/store_category_partner_layout","modules/view/store/store_category_collection_view","modules/view/store/store_category_default_item_view","modules/view/store/store_item_collection_view","modules/view/store/store_item_virtualgift_detail_item_view","modules/view/store/store_item_sticker_detail_item_view","modules/view/store/store_item_received_item_view","modules/view/store/store_item_inventory_give_item_view","modules/view/store/store_item_purchase_success_layout","modules/view/store/store_item_purchase_success_recipient_collection_view","modules/view/store/store_item_inventory_success_layout","modules/view/store/store_item_inventory_collection_view","modules/model/store/store_category_model","modules/model/store/store_partner_model","modules/model/store/store_category_collection","modules/model/store/store_item_model","modules/model/store/store_item_collection","modules/model/store/store_item_received_model","modules/model/store/store_item_inventory_model","modules/model/store/store_item_inventory_collection","modules/view/banner/store","modules/model/banner/banner_collection"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G){var H,I=h.Session.getInstance(),J=null,K=null,L=null,M=null,N="",O="",P=null,Q=null,R=null,S=null,T=null,U=c.Controller.extend({_createAndInitStoreLayout:function(a){J=new i({category_id:a,nice_name:this._getTypeNiceName(e.store.category_to_type[a])
}),J.on("close",function(){M=null,L=null}),null!==K&&(J.updateAccountBalance(K),J.setSearchCurrency(I.get("currency_code")))},_show:function(a){null!==J&&J&&(J.resetSearchForm(),J.update_back_button(a,this._getTypeNiceName(e.store.category_to_type[a]))),""!==f.get_query_params_by_name("username")&&(N=f.get_query_params_by_name("username")),""!==f.get_query_params_by_name("vote")&&(O=f.get_query_params_by_name("vote")),null!==L&&L?L.close():(f.highlight_top_menu("store"),this._createAndInitStoreLayout(a),d.content.show(J),null!=I.get("account_balance")&&(J.updateAccountBalance(f.add_thousands_seperator(I.get("account_balance"))+" "+I.get("currency_code")),J.setSearchCurrency(I.get("currency_code"))))},_getStoreSubCategories:function(a,c){var d;return a!=M&&(c=c||a,d=new z([],{category_id:a}),d.fetch(),P=new m({collection:d,category_id:c,category_nice_name:this._getTypeNiceName(e.store.category_to_type[a])}),M=a,J.categories.show(P),J.makeTabActive(a),Q=new n({model:new b.Model({category_id:a,category_nice_name:this._getTypeNiceName(e.store.category_to_type[a])})}),J.defaultCategories.show(Q),1===parseInt(a,10)?Q.showUnlockedDefaultCategory():Q.hideUnlockedDefaultCategory()),d},_getTypeNiceName:function(a){switch(a){case"VIRTUAL_GIFT":return f.translate("user|gifts");case"AVATAR":return f.translate("user|avatar");case"EMOTICON":return f.translate("chat|emoticons");case"STICKER":return f.translate("chat|stickers");case"APP_ITEM":return f.translate("store|applications_item");case"GAME_ITEM":return f.translate("store|games_item")}},initialize:function(){d&&(d.vent.on(d.ApplicationEvents.ACCOUNT_BALANCE,function(a){null!==J&&(J.updateAccountBalance(a),J.setSearchCurrency(I.get("currency_code"))),K=a}),d.vent.on(d.ApplicationEvents.STORE_ITEM_PURCHASED,function(a,c){if(null!==R&&null!==S){for(var d=new b.Collection,e=0;e<c.length;e++)d.add(new b.Model({recipient:c[e]}));R.details.show(S),R.togglePopularAndMoreTitle("more"),S.recipients.show(new u({collection:d})),N="",O=""}}))},index:function(){this._show("home");var a,c,d=$(J.container.options.el);J&&J.header.$el&&J.header.$el.hide();var f=new G;f.setPlacementStore(),f.fetch(),f.on("fetch:done",function(){d.prepend(new F({collection:f}).render().el)}),a=e.store.type_to_category.VIRTUAL_GIFT,c={category_id:a,category_nice_name:this._getTypeNiceName(e.store.category_to_type[a])};var g=new B([],{category_id:a});g.setByType(),g.sortByPopular(),g.setLimit(12),g.fetch({success:function(){g.trigger("fetched")}}),H=new o({collection:g,model:new b.Model(c),showHeader:!0}),d.append(H.render().el),a=e.store.type_to_category.STICKER,c={category_id:a,category_nice_name:this._getTypeNiceName(e.store.category_to_type[a])};var h=new B([],{category_id:a});h.setByType(),h.sortByPopular(),h.setLimit(6),h.fetch({success:function(){h.trigger("fetched")}}),H=new o({collection:h,model:new b.Model(c),showHeader:!0}),d.append(H.render().el),a=e.store.type_to_category.EMOTICON,c={category_id:a,category_nice_name:this._getTypeNiceName(e.store.category_to_type[a])};var i=new B([],{category_id:a});i.setByType(),i.sortByPopular(),i.setLimit(6),i.fetch({success:function(){i.trigger("fetched")}}),H=new o({collection:i,model:new b.Model(c),showHeader:!0}),d.append(H.render().el),a=e.store.type_to_category.AVATAR,c={category_id:a,category_nice_name:this._getTypeNiceName(e.store.category_to_type[a])};var j=new B([],{category_id:a});j.setByType(),j.sortByPopular(),j.setLimit(6),j.fetch({success:function(){j.trigger("fetched")}}),H=new o({collection:j,model:new b.Model(c),showHeader:!0}),d.append(H.render().el),a=e.store.type_to_category.APP_ITEM,c={category_id:a,category_nice_name:this._getTypeNiceName(e.store.category_to_type[a])};var k=new B([],{category_id:a});k.setByType(),k.sortByPopular(),k.setLimit(8),k.fetch({success:function(){k.trigger("fetched")}}),H=new o({collection:k,model:new b.Model(c),showHeader:!0}),d.append(H.render().el),a=e.store.type_to_category.GAME_ITEM,c={category_id:a,category_nice_name:this._getTypeNiceName(e.store.category_to_type[a])};var l=new B([],{category_id:a});H=new o({collection:l,model:new b.Model(c),showHeader:!0}),l.setByType(),l.sortByPopular(),l.setLimit(8),l.fetch({success:function(){l.length>0&&d.append(H.render().el),l.trigger("fetched")}}),J.hideSearch(),L=H},category:function(a,b,c,d){var g=this,h=new x({category_id:a});h.fetch(),h.on("change",function(){if(this.get("parentStoreCategoryID")!==!1){b=b||"default";var h=0===this.get("parentStoreCategoryID")?a:this.get("parentStoreCategoryID"),i=new B([],{category_id:a}),j=g._getTypeNiceName(e.store.category_to_type[h]);switch(g._show(h),g._getStoreSubCategories(h,a),b){case"popular":c=c||"popular",d=d||"desc",i.setByType(),f.send_event_to_ga("Store","View Category","Popular "+j);break;case"featured":c=c||"date",d=d||"desc",i.setByType(),i.featuredOnly(),f.send_event_to_ga("Store","View Category","Featured "+j);break;case"new":c=c||"date",d=d||"desc",i.setByType(),f.send_event_to_ga("Store","View Category","New "+j);break;default:c=c||"name",d=d||"asc",f.send_event_to_ga("Store","View Category","Category "+a)}switch(c){case"name":i.sortByName();break;case"price":i.sortByPrice();break;case"popular":i.sortByPopular();break;case"date":i.sortByDate()}"popular"!==c&&("asc"===d?i.sortOrderAsc():i.sortOrderDesc()),i.fetch({success:function(){i.trigger("fetched")}}),H=new o({collection:i}),J.container.show(H),J.showSearch(),"default"!==b?(null!==P&&P.removeHighlightFromCategory(),null!==Q&&Q.highlightCurrentDefaultCategory(b)):(null!==Q&&Q.removeHighlightFromDefaultCategory(),null!==P&&P.highlightCurrentCategory(a)),H.on("store:item:more",function(a){J.showPagination(),H.more=f.block_function(H.more),i.fetch({remove:!1,page:a,success:function(){i.trigger("fetched")}})}),i.on("fetch:done",function(){J.hidePagination(),J.setFilterTypeAndCategoryId(b,h,a),J.resetSearchForm(),J.setParamsForSortField(c,d),H.more=f.unblock_function(H.more)}),L=H}if(null!=this.get("storePartnerId")){var k=new y({partner_id:this.get("storePartnerId")});k.fetch(),k.on("change",function(){T=new l({model:k}),J.header.show(T),J.header.$el.show()})}else J.header.$el&&J.header.$el.hide()})},search:function(a,b,c,d,e,g){var h=this,i=new x({category_id:a});i.fetch(),i.on("change",function(){if(this.get("parentStoreCategoryID")!==!1){var i=0===this.get("parentStoreCategoryID")?a:this.get("parentStoreCategoryID"),j=new B([],{category_id:a});h._show(i),h._getStoreSubCategories(i),j.setBySearch(),j.setSearchType(i),j.setSearchCategoryId(a),j.setSearchQuery(b),j.setMinPrice(c),j.setMaxPrice(d),"price"===e?j.sortByPrice():j.sortByName(),"asc"===g?j.sortOrderAsc():j.sortOrderDesc(),j.fetch({success:function(){j.trigger("fetched")}}),H=new o({collection:j}),J.container.show(H),J.showSearch(),H.on("store:item:more",function(a){J.showPagination(),H.more=f.block_function(H.more),j.fetch({remove:!1,page:a,success:function(){j.trigger("fetched")}})}),j.on("fetch:done",function(){J.hidePagination(),J.setParamsForSearchField(b,c,d),J.setParamsForSortField(e,g),J.hightlightSearchTerms(b),H.more=f.unblock_function(H.more)}),L=H}})},item:function(a){var b,c=this,d=new A([],{item_id:a});J&&J.header.$el&&J.header.$el.hide(),d.fetch({success:function(){d.trigger("fetched")}}),d.on("change",function(){null!=this.get("storePartnerId")?(b=new y({partner_id:this.get("storePartnerId")}),b.fetch(),b.on("change",function(){d.set("storePartner",b.attributes,{silent:!0}),c._item_process(d)})):c._item_process(d),f.send_event_to_ga("Store","View Item","Item "+a)})},_item_process:function(a){var c=null===a.get("storeCategoryID")?e.store.type_to_category[a.get("type")]:a.get("storeCategoryID"),d=null===a.get("parentStoreCategoryID")?e.store.type_to_category[a.get("type")]:a.get("parentStoreCategoryID"),g=new B([],{category_id:d}),h=new o({collection:g}),i=null,k=f.get_query_params_by_name("action");switch(a.set("action",k,{silent:!0}),a.get("type")){case"VIRTUAL_GIFT":i=new p({model:a});break;case"STICKER":i=new q({model:a});break;case"APP_ITEM":case"GAME_ITEM":i=new p({model:a,action:k});break;default:b.history.navigate("v4/sites/ajax/store/view_item?itid="+a.get("id"),{trigger:!0})}R=new j({model:new b.Model({parent_category_id:d,category_id:c,category_nice_name:this._getTypeNiceName(e.store.category_to_type[d])})}),S=new t({model:a}),this._show(d),this._getStoreSubCategories(d),g.setByType(),g.sortByDate(),g.sortOrderDesc(),g.setLimit(4),g.fetch({success:function(){g.trigger("fetched")}}),J.container.show(R),J.hideSearch(),i.setToUsername(N),i.setCampaignId(O),R.popular.show(h),R.details.show(i),L=R},item_received:function(a,b,c){var d,e=this,f=new C({username:a,type:b,received_id:c});f.fetch({success:function(){f.trigger("fetched")}}),f.on("change",function(){null!=f.get("storeItemData").storePartnerId?(d=new y({partner_id:f.get("storeItemData").storePartnerId}),d.fetch(),d.on("change",function(){f.set("storePartner",d.attributes,{silent:!0}),e._item_received_process(f)})):e._item_received_process(f)})},_item_received_process:function(a){a.set("buyForSelf",!0,{silent:!0});var c=a.get("type"),d=new B([],{category_id:c}),f=(new o({collection:d}),new B([],{category_id:c})),g=(new o({collection:f}),new k({model:new b.Model({sender:a.get("sender"),category_id:c,category_nice_name:this._getTypeNiceName(e.store.category_to_type[c])})})),h=new r({model:a});this._show(c),this._getStoreSubCategories(c),J.container.show(g),J.hideSearch(),g.details.show(h),L=g},item_inventory:function(a,c,d){var h=this;if(d=d||0,J&&J.header.$el&&(J.header.$el.hide(),J.update_back_title(f.translate("store|category_unlocked",this._getTypeNiceName(c)))),a!==g.getInstance().get("username"))return void(window.location.href=g.getInstance().get("personalized_url")+"/store/1/inventory");if(this._show(c),this._getStoreSubCategories(c),Q.highlightCurrentDefaultCategory("unlocked"),d>0){var i=new D({username:a,type:c,item_id:d});i.fetch({success:function(){i.trigger("fetched")}}),i.on("change",function(){var a=new B([],{category_id:c}),d=new o({collection:a}),f=new s({model:i});R=new j({model:new b.Model({parent_category_id:c,category_id:c,category_nice_name:h._getTypeNiceName(e.store.category_to_type[c])})}),S=new v({model:i}),a.setByType(),a.sortByNumsold(),a.sortOrderDesc(),a.setLimit(4),a.fetch({success:function(){a.trigger("fetched")}}),J.container.show(R),J.hideSearch(),R.popular.show(d),R.details.show(f),L=R})}else{var k=new E([],{username:a,type:c}),l=new w({collection:k,model:new b.Model({type:c,category_nice_name:h._getTypeNiceName(e.store.category_to_type[c])})});k.fetch({success:function(){k.trigger("fetched")}}),J.container.show(l),L=l}}});return U}),define("hbs!modules/template/account/migcoins_convert_modal",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+="<div class='modal-dialog faq-outline flex-direction-column flex-align-start'>\n  <br/>\n  <div class='font-bold font-color-link'>\n    "+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|convert_migcoins",g):i.call(b,"translate","account|convert_migcoins",g)))+"\n  </div>\n\n  <br/>\n  <div class='account-about-balance font-color-caption'>\n    <div class='font-bold'>\n      <span id='account-about-balance'></span>\n      "+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|equals",g):i.call(b,"translate","account|equals",g)))+"\n    </div>\n    \n    <div class='recharge-balance-details'>\n      <img class='svg' src='"+j((f=c.getUrl||b&&b.getUrl,g={hash:{},data:e},f?f.call(b,"jsclient",g):i.call(b,"getUrl","jsclient",g)))+"/app/images/mig.me/wb_credit_filled.svg'></img>\n      <span id='recharge-balance'>"+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"common|loading",g):i.call(b,"translate","common|loading",g)))+"</span>\n      <span id='recharge-currency'></span>\n    </div>\n\n    <div>"+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|credit_not_expired",g):i.call(b,"translate","account|credit_not_expired",g)))+"</div>\n  </div>\n\n  <br/>\n  <div class='font-bold font-color-link'>\n    "+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|convert_title1",g):i.call(b,"translate","account|convert_title1",g)))+"\n  </div>\n  <div class='padding-top'>\n    "+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|convert_desc1",g):i.call(b,"translate","account|convert_desc1",g)))+"\n  </div>\n\n  <br/><br/>\n  <a href='#' class='btn btn-green-money btn-button btn-center text-center convert-to-migcoins'>\n    <div>\n      "+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|convert_me",g):i.call(b,"translate","account|convert_me",g)))+"\n    </div>\n  </a>\n\n  <a href='#' class='btn-center text-center decoration-underline padding-top' data-dismiss=\"modal\">\n    <div>\n      "+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|no_convert",g):i.call(b,"translate","account|no_convert",g)))+"\n    </div>\n  </a>\n\n  <br/>\n\n</div>"})}),define("modules/view/account/migcoins_convert_modal_view",["underscore","jquery","backbone","handlebars","modules/mig33_app","backbone.marionette","marionette_handlebars","modules/globals/session_user","hbs!modules/template/account/migcoins_convert_modal","modules/common/config","modules/common/utility","modules/chat/models/user_session","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j,k,l){var m=l.Session.getInstance(),n=f.ItemView.extend({template:{type:"handlebars",template:i},id:"migcoins-convert-modal",className:"account modal fade",onRender:function(){},events:{"click .convert-to-migcoins":"convertToMigcoins"},initialize:function(){var a=this;e.vent.on(e.ApplicationEvents.ACCOUNT_BALANCE,function(b){a.updateAccountBalance(b)})},updateAccountBalance:function(c){if(j.store.show_migcoins===!1&&this.hideMigcoins(),"undefined"==typeof c||null===c){if(void 0===m.get("account_balance")||null===m.get("account_balance"))return!1;c=k.add_thousands_seperator(m.get("account_balance"))+" "+m.get("currency_code")}var d=this,e=c.split(" "),f=parseFloat(e[0].replace(/[^0-9\.]+/g,"")),g=e[1];g==j.store.migcoins_currency_code&&this.hideMigcoins(),b(".recharge-balance-details",this.$el).removeClass("has-balance").removeClass("no-balance"),b.ajax({url:k.format(j.urls.account_convert_amount_in_mvc,g,f),async:!1}).then(function(c){a.isUndefined(c.data)||a.isNull(c.data)||(b("#recharge-balance",d.$el).text(k.add_thousands_seperator(c.data)),b("#recharge-currency",d.$el).text(j.store.migcoins_currency_code),c.data>0?b(".recharge-balance-details",this.$el).addClass("has-balance").removeClass("no-balance"):b(".recharge-balance-details",this.$el).removeClass("has-balance").addClass("no-balance"))}),k.inline_svg(),b("#account-about-balance",this.$el).text(c)},convertToMigcoins:function(){var c=this;b.ajax({url:k.format(j.urls.account_convert_to_mvc),type:"POST",async:!1}).then(function(b){a.isUndefined(b.data)||a.isNull(b.data)?k.is_empty(b.error)||k.is_empty(b.error.message)||k.show_error(b.error.message):(c.$el.modal("hide"),k.show_success_modal(k.translate("common|success_message_title"),k.translate("account|convert_success"),k.translate("common|got_it")))})},hideMigcoins:function(){b(".account-about-balance").hide(),b(".convert-to-migcoins").hide()}});return n}),define("hbs!modules/template/account/migcoins-convert-footer",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="migcoins-footer cursor_pointer">\n  <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>\n\n  <span class="font-bold font-color-link">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|convert_migcoins_now",g):i.call(b,"translate","account|convert_migcoins_now",g)))+'</span>\n  &nbsp;&nbsp;\n  <img class="svg" src="'+j((f=c.getUrl||b&&b.getUrl,g={hash:{},data:e},f?f.call(b,"jsclient",g):i.call(b,"getUrl","jsclient",g)))+'/app/images/mig.me/wb_exclamation.svg"></img>\n  &nbsp;&nbsp;\n  <span class="glyphicon glyphicon-menu-up"></span>\n</div>'})}),define("modules/view/account/migcoins_convert_footer_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/view/account/migcoins_convert_modal_view","hbs!modules/template/account/migcoins-convert-footer","modules/common/utility","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i){var j=e.ItemView.extend({template:{type:"handlebars",template:h},id:"migcoins-footer",className:"migcoins-convert-footer",events:{"click .migcoins-footer":"openConvertToMigcoins","click .close":"hideDisplay"},openConvertToMigcoins:function(){var a=b("#main-container");if(b("#migcoins-convert-modal").length>0)return!1;var c=new g;a.after(c.render().el),c.$el.modal("show"),c.updateAccountBalance(),c.$el.one("hidden.bs.modal",function(a){this.remove()})},hideDisplay:function(a){a.stopPropagation(),this.$el.hide()}});return j}),define("modules/model/account/account_user_payment_model",["underscore","backbone","modules/mig33_app","modules/common/config","modules/common/utility","modules/model/common/mig33_model"],function(a,b,c,d,e,f){var g=f.extend({});return g}),define("modules/model/account/account_user_payment_collection",["underscore","backbone","modules/mig33_app","modules/common/config","modules/common/utility","modules/model/account/account_user_payment_model","modules/common/session_user","modules/model/common/mig33_collection"],function(a,b,c,d,e,f,g,h){var i=h.extend({model:f,url:function(){return e.format(d.urls.account_user_payment,g.getInstance().get("id"))}});return i}),define("modules/model/account/account_balance_model",["underscore","backbone","modules/mig33_app","modules/common/config","modules/common/utility","modules/model/common/mig33_model"],function(a,b,c,d,e,f){var g=f.extend({});return g}),define("modules/model/account/account_balance_collection",["underscore","backbone","modules/mig33_app","modules/common/config","modules/common/utility","modules/model/account/account_balance_model","modules/common/session_user","modules/model/common/mig33_collection"],function(a,b,c,d,e,f,g,h){var i=h.extend({model:f,category:"",initialize:function(a,b){this.options=b,this.currentPage=0},url:function(){var a="";return a=this.category&&""!==this.category?"?username="+g.getInstance().get("username")+"&num_entries="+d.variable.limit+"&page="+this.currentPage+"&category="+this.category:"?username="+g.getInstance().get("username")+"&num_entries="+d.variable.limit+"&page="+this.currentPage,e.format(d.urls.account_history)+a}});return i}),define("modules/model/account/account_merchant_model",["underscore","backbone","modules/mig33_app","modules/common/config","modules/common/utility","modules/model/common/mig33_model"],function(a,b,c,d,e,f){var g=f.extend({follow:function(){var a=this,b=parseInt(a.get("userData").id,10),c=this.get("userData").username;return $.ajax({type:"post",cache:!1,dataType:"json",url:d.urls.miniblog_api_url+"/follow/"+b,success:function(a){a=e.parse_ajax_response(a),a.error?e.show_error(e.translate(a.error,c)):e.show_success(e.translate(a.success,c))},error:function(){e.show_error(e.translate("user|follow_error",c))}})}});return g}),define("modules/model/account/account_merchant_collection",["underscore","backbone","modules/mig33_app","modules/common/config","modules/common/utility","modules/model/account/account_merchant_model","modules/common/session_user","modules/model/common/mig33_collection"],function(a,b,c,d,e,f,g,h){var i=h.extend({model:f,limit:d.account.merchant.limit,initialize:function(a,b){this.options=b},url:function(){return e.format(d.urls.account_user_merchant,g.getInstance().get("username"))+"?offset="+(this.currentPage-1)*this.limit+"&limit="+this.limit}});return i}),define("modules/model/account/account_merchant_countries_model",["underscore","backbone","modules/mig33_app","modules/common/config","modules/common/utility","modules/model/common/mig33_model"],function(a,b,c,d,e,f){var g=f.extend({countryId:null,url:function(){return e.format(d.urls.country,this.countryId)},setCountryId:function(a){this.countryId=a}});return g}),define("modules/model/account/account_merchant_countries_collection",["underscore","backbone","modules/mig33_app","modules/common/config","modules/common/utility","modules/model/account/account_merchant_countries_model","modules/common/session_user","modules/model/common/mig33_collection"],function(a,b,c,d,e,f,g,h){var i=h.extend({model:f,url:function(){return d.urls.account_merchant_countries}});return i}),define("modules/model/account/account_merchant_country_collection",["underscore","backbone","modules/mig33_app","modules/common/config","modules/common/utility","modules/model/account/account_merchant_model","modules/model/common/mig33_collection"],function(a,b,c,d,e,f,g){var h=g.extend({model:f,countryId:0,limit:d.account.merchant.limit,url:function(){return e.format(d.urls.account_merchant_country,this.countryId)+"?offset="+(this.currentPage-1)*this.limit+"&limit="+this.limit},setCountryId:function(a){this.countryId=a}});return h}),define("modules/model/account/account_merchant_country_search_collection",["underscore","backbone","modules/mig33_app","modules/common/config","modules/common/utility","modules/model/account/account_merchant_model","modules/model/common/mig33_collection"],function(a,b,c,d,e,f,g){var h=g.extend({model:f,name:0,limit:d.account.merchant.limit,url:function(){return d.urls.account_merchant_country_search+"?name="+this.name+"&offset="+(this.currentPage-1)*this.limit+"&limit="+this.limit},setName:function(a){this.name=a}});return h}),define("hbs!modules/template/account/account-layout",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="col-sm-12 col-md-8 col-md-offset-2">\n  <div class="row">\n    <div class="col-xs-6 no-padding">\n      <div class="content-page-title">\n        <div class="font-size-12 font-bold">\n          <a href="/store">\n              < '+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"common|store",g):i.call(b,"translate","common|store",g)))+'\n          </a>\n        </div>\n        <h3 class="font-color-link font-light current-page-category no-margin">\n          '+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|credit",g):i.call(b,"translate","account|credit",g)))+"\n        </h3>\n      </div>\n    </div>\n    <div class='col-xs-6 no-padding'>\n      <a href='/credit/about' class='account-help pull-right no-decoration'>\n        <span class=\"icon-wb_info font-color-caption\">\n          <span class=\"hidden-xs font-color-link font-size-small font-bold\">\n            "+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"common|help",g):i.call(b,"translate","common|help",g)))+'\n          </span>\n        </span>\n      </a>\n\n      <div class="account-credits clearfix pull-right">\n        <a href="/credit" class="btn-outline btn-credit">\n          <span class="wb wb-20 icon-wb_staff text-right"></span>\n          <span id="store-account-balance" class="account-balance-amount">\n            <div class="loading"></div>Loading...\n          </span>\n          <span class="account-recharge hidden">\n            '+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"store|recharge",g):i.call(b,"translate","store|recharge",g)))+'\n          </span>\n        </a>\n      </div>\n    </div>\n  </div>\n\n  <div class="row background-color">\n    <div id="account" class="col-sm-12 content content-account">\n      <div class="account-content"></div>\n    </div>\n  </div>\n</div>'})}),define("modules/view/account/account_layout",["jquery","underscore","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/globals/url","hbs!modules/template/account/account-layout","modules/template/helpers/general_helpers","modules/template/helpers/store_helpers","jquery.highlight-4"],function(a,b,c,d,e,f,g,h,i,j){var k=e.Layout.extend({template:{type:"handlebars",template:j},regions:{container:".account-content"},events:{},className:"account",removeHighlightFromCategory:function(){a(this.$el).find("li").removeClass("active")},highlightCurrentCategory:function(b){this.removeHighlightFromCategory(),a("#recharge-category-"+b,this.$el).addClass("active")},makeTabActive:function(b){a(".account-tabs").find("li").removeClass("active").end().find("#account-tab-"+b).addClass("active")},updateBack:function(b,c,d){a(".content-page-title a",this.$el).html("< "+c),a(".content-page-title a",this.$el).attr("href",d),a(".current-page-category",this.$el).html(b)},updateAccountBalance:function(b){a("#store-account-balance",this.$el).text(b)},updatePendingPaymentCounter:function(b){b>0?a("#pending-payment-counter",this.$el).text(b).show():a("#pending-payment-counter",this.$el).text("0").hide()}});return k}),define("hbs!modules/template/account/account-transfer",["handlebars"],function(a){return a.template(function(a,b,c,d,e){return this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{},'<div class="credit-transfer">\n  <p class="title">All field are mandatory</p>\n  <form class="transfer-form" action="/sites/ajax/account/transfer_credit_confirm" target="myIframe" method="post" novalidate>\n    <div class="to recipient">\n      <h1>Transfer To</h1>\n      <input class="hidden" name="recipient_username" type="text" id="to" value="" />\n    </div>\n    <div class="transfer-details hidden">\n      <h1>You Send</h1>\n      <div class="transfer-amt">\n        <span class="currency"></span>\n        <input placeholder="Enter amount here" name="transfer_amount" type="number" id="amt-sent" value="" />\n      </div>\n      <h1>Receiver Gets</h1>\n      <div class="receive-amt">\n        <span class="currency"></span>\n        <input placeholder="Enter amount here" name="amount_received" type="number" id="amt_received" value="" />\n      </div>\n      <p class="description"></p>\n      <div class="merchant-pin hidden">\n        <h1>Enter Merchant Pin</h1>\n        <input placeholder="Enter Pin Number" name="pin" type="text" id="pin-number" value="" />\n      </div>\n    </div>\n    <div class="loading hidden"></div>\n    <p id="error-msg"></p>\n    <div class="text-center">\n      <input type="submit" id="transfer-credits" name="transfer" class="btn btn-button btn-default" value="Next" disabled>\n    </div>\n  </form>\n</div>\n<iframe id=\'recharge-iframe\' name="myIframe" src="" onload="window.AdjustIframeHeightOnLoad(\'recharge-iframe\')" onresize="window.AdjustIframeHeightOnLoad(\'recharge-iframe\')" ></iframe>'})}),define("modules/view/account/account_recharge_transfer",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/account/account-transfer","modules/common/config","modules/common/utility","modules/globals/session_user","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j){var k=e.ItemView.extend({initialize:function(){a.bindAll(this),this.requiredMerchantPin=!1,this.insideReq=!1},onRender:function(){var a=this,b=require("modules/chat/models/contacts").ContactGroupStore.getInstance();b.is_contacts_loaded()?a.autoCompleteWhoField(b.get_all_contacts()):b.on("contacts_load_complete",function(){a.autoCompleteWhoField(b.get_all_contacts())},a)},template:{type:"handlebars",template:g},events:{"click #transfer-credits":"doTransfer",'change input[name="transfer_amount"]':"doConversion",'change input[name="amount_received"]':"doConversion"},className:"recharge-main",getCurrency:function(a){var c=this,d=b.ajax({url:i.format(h.urls.get_currency,a)});d.done(function(a){var d=i.parse_ajax_response(a);d.error?b("#error-msg").html(d.error):c.setCurrency(d)})},setCurrency:function(a){b(".transfer-amt .currency",this.$el).html(a),this.transfer_amt=a},doTransfer:function(a){a.preventDefault(),a.stopPropagation(),b('input[name="recipient_username"]',this.$el).val()===j.username?b("#error-msg").html("Cannot transfer to own account."):(b(".credit-transfer",this.$el).addClass("hidden"),b(".transfer-form",this.$el).submit())},doConversion:function(a){b("#transfer-credits").prop("disabled",!0);var c,d="",e="",f=a.target.value;"transfer_amount"===a.target.name?(d=this.transfer_amt,e=this.receiver_amt,c=b('input[name="amount_received"]')):"amount_received"===a.target.name&&(d=this.receiver_amt,e=this.transfer_amt,c=b('input[name="transfer_amount"]')),"MGC"===d&&f%1!==0?b("#error-msg").html(i.translate("account|error_MGC_number")):(b("#error-msg").html(""),""!==d&&""!==e&&""!==f&&(this.insideReq===!0&&this.request.abort(),this.insideReq=!0,this.request=b.ajax({url:i.format(h.urls.account_convert_amount,d,e,f)}),this.request.done(function(a){this.insideReq=!1;var d=i.parse_ajax_response(a);d.error||b(c).val(d),parseFloat(f)>0&&parseFloat(d)>0?b("#transfer-credits").prop("disabled",!1):b("#transfer-credits").prop("disabled",!0)})))},autoCompleteWhoField:function(a){var c=this,d=[],e=0,f=b("#to",this.$el);a.each(function(a){a.isFusionContact()&&d.push(a.getUsername())}),f.prop("disabled",!1).tagit({fieldName:"to",caseSensitive:!1,tagLimit:1,autocomplete:{delay:1,minLength:3,autoFocus:!0},placeholderText:i.translate("account|recipient"),availableTags:d,onTagLimitExceeded:function(){i.show_error(i.translate("store|error_max_recipient",c.model.getTypeNiceNameSingular(),5))},beforeTagAdded:function(a,d){var e=/^@*([\w\d\.\-]{1,42})$/,f=b(d.tag[0]).text(),g=f.substr(0,f.length-1),h=e.test(g);return h?void 0:(i.show_error(i.translate("store|error_username",g)),b('input[name="recipient_username"]',c.$el).prop("disabled",!0),!1)},afterTagAdded:function(a,d){if(e=f.tagit("assignedTags").length,b('input[name="recipient_username"]',c.$el).prop("disabled",!1),b(".recipient .tagit input",c.$el).prop("placeholder",""),b("#error-msg").html(""),b('input[name="recipient_username"]',c.$el).val()===j.username)b("#error-msg").html(i.translate("account|error_own_account"));else{var g=b.ajax({url:i.format(h.urls.get_currency,d.tagLabel)});g.done(function(a){var d=i.parse_ajax_response(a);d.error?b("#error-msg").html(d.error):(b(".receive-amt .currency",c.$el).html(d),b(".transfer-details",c.$el).removeClass("hidden"),c.receiver_amt=d),b(".loading",c.$el).addClass("hidden")}).fail(function(a){b("#error-msg").html(i.translate("store|error_username",d.tagLabel)),b(".loading",c.$el).addClass("hidden")}),b(".loading",c.$el).removeClass("hidden")}},afterTagRemoved:function(a,d){e=f.tagit("assignedTags").length,e>0?b('input[name="recipient_username"]',c.$el).prop("disabled",!1):(b(".recipient .tagit input",c.$el).prop("placeholder",i.translate("account|recipient")),b('input[name="recipient_username"]',c.$el).prop("disabled",!0),b('input[name="transfer_amount"]',c.$el).val(""),b('input[name="amount_received"]',c.$el).val(""),b(".transfer-details",c.$el).addClass("hidden"),b(".loading",c.$el).addClass("hidden"),this.receiver_amt="")}}),""!==this.toUsername&&f.tagit("createTag",this.toUsername)}});return k}),define("hbs!modules/template/account/account-recharge-layout",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+='\n      <div class="col-sm-4 col-xs-6 eq-">\n        <a href="/credit/recharge/mimopay">\n          <div class="recharge-grid-cell">\n            <img class="recharge-grid-icon" src="'+s((d=c.getUrl||a&&a.getUrl,e={hash:{},data:b},d?d.call(a,"jsclient",e):r.call(a,"getUrl","jsclient",e)))+'/app/images/mig.me/payment/mimopay.svg"/>\n            <div class="recharge-grid-text">'+s((d=c.translate||a&&a.translate,
e={hash:{},data:b},d?d.call(a,"account|mimopay",e):r.call(a,"translate","account|mimopay",e)))+'</div>\n            <div class="recharge-grid-desc">'+s((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"account|mimopay_description",e):r.call(a,"translate","account|mimopay_description",e)))+"</div>\n          </div>\n        </a>\n      </div>\n    "}function g(a,b){var d,e,f="";return f+='\n      <div class="col-sm-4 col-xs-6 eq-">\n        <a href="/credit/recharge/doku_wallet">\n          <div class="recharge-grid-cell">\n            <img class="recharge-grid-icon" src="'+s((d=c.getUrl||a&&a.getUrl,e={hash:{},data:b},d?d.call(a,"jsclient",e):r.call(a,"getUrl","jsclient",e)))+'/app/images/mig.me/payment/doku.svg"/>\n            <div class="recharge-grid-text">'+s((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"account|doku_wallet",e):r.call(a,"translate","account|doku_wallet",e)))+'</div>\n            <div class="recharge-grid-desc">'+s((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"account|doku_description",e):r.call(a,"translate","account|doku_description",e)))+'</div>\n          </div>\n        </a>\n      </div>\n      <div class="col-sm-4 col-xs-6 eq-">\n        <a href="/credit/recharge/doku_mandiri">\n          <div class="recharge-grid-cell">\n            <img class="recharge-grid-icon" src="'+s((d=c.getUrl||a&&a.getUrl,e={hash:{},data:b},d?d.call(a,"jsclient",e):r.call(a,"getUrl","jsclient",e)))+'/app/images/mig.me/payment/doku-mandiri.svg"/>\n            <div class="recharge-grid-text">'+s((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"account|doku_mandiri",e):r.call(a,"translate","account|doku_mandiri",e)))+'</div>\n            <div class="recharge-grid-desc">'+s((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"account|doku_description",e):r.call(a,"translate","account|doku_description",e)))+'</div>\n          </div>\n        </a>\n      </div>\n      <div class="col-sm-4 col-xs-6 eq-">\n        <a href="/credit/recharge/doku_atm">\n          <div class="recharge-grid-cell">\n            <img class="recharge-grid-icon" src="'+s((d=c.getUrl||a&&a.getUrl,e={hash:{},data:b},d?d.call(a,"jsclient",e):r.call(a,"getUrl","jsclient",e)))+'/app/images/mig.me/payment/doku.svg"/>\n            <div class="recharge-grid-text">'+s((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"account|doku_atm",e):r.call(a,"translate","account|doku_atm",e)))+'</div>\n            <div class="recharge-grid-desc">'+s((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"account|doku_description",e):r.call(a,"translate","account|doku_description",e)))+'</div>\n          </div>\n        </a>\n      </div>\n      <div class="col-sm-4 col-xs-6 eq-">\n        <a href="/credit/recharge/doku_alfamart">\n          <div class="recharge-grid-cell">\n            <img class="recharge-grid-icon" src="'+s((d=c.getUrl||a&&a.getUrl,e={hash:{},data:b},d?d.call(a,"jsclient",e):r.call(a,"getUrl","jsclient",e)))+'/app/images/mig.me/payment/doku-alfamart.svg"/>\n            <div class="recharge-grid-text">'+s((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"account|doku_alfamart",e):r.call(a,"translate","account|doku_alfamart",e)))+'</div>\n            <div class="recharge-grid-desc">'+s((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"account|doku_description",e):r.call(a,"translate","account|doku_description",e)))+"</div>\n          </div>\n        </a>\n      </div>\n    "}function h(a,b){var d,e,f="";return f+='\n      <div class="col-sm-4 col-xs-6 eq-">\n        <a href="/credit/recharge/dompetku">\n          <div class="recharge-grid-cell">\n            <img class="recharge-grid-icon" src="'+s((d=c.getUrl||a&&a.getUrl,e={hash:{},data:b},d?d.call(a,"jsclient",e):r.call(a,"getUrl","jsclient",e)))+'/app/images/mig.me/payment/dompetku.svg"/>\n            <div class="recharge-grid-text">'+s((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"account|dompetku",e):r.call(a,"translate","account|dompetku",e)))+'</div>\n            <div class="recharge-grid-desc">'+s((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"account|dompetku_description",e):r.call(a,"translate","account|dompetku_description",e)))+"</div>\n          </div>\n        </a>\n      </div>\n    "}function i(a,b){var d,e,f="";return f+='\n      <div class="col-sm-4 col-xs-6 eq-">\n        <a href="/credit/recharge/esewa">\n          <div class="recharge-grid-cell">\n            <img class="recharge-grid-icon" src="'+s((d=c.getUrl||a&&a.getUrl,e={hash:{},data:b},d?d.call(a,"jsclient",e):r.call(a,"getUrl","jsclient",e)))+'/app/images/mig.me/payment/esewa.svg"/>\n            <div class="recharge-grid-text">'+s((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"account|esewa",e):r.call(a,"translate","account|esewa",e)))+'</div>\n            <div class="recharge-grid-desc">'+s((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"account|esewa_description",e):r.call(a,"translate","account|esewa_description",e)))+"</div>\n          </div>\n        </a>\n      </div>\n    "}function j(a,b){var d,e,f="";return f+='\n      <div class="col-sm-4 col-xs-6 eq-">\n        <a href="/credit/recharge/paytm">\n          <div class="recharge-grid-cell">\n            <img class="recharge-grid-icon" src="'+s((d=c.getUrl||a&&a.getUrl,e={hash:{},data:b},d?d.call(a,"jsclient",e):r.call(a,"getUrl","jsclient",e)))+'/app/images/mig.me/payment/paytm.svg"/>\n            <div class="recharge-grid-text">'+s((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"account|paytm",e):r.call(a,"translate","account|paytm",e)))+'</div>\n            <div class="recharge-grid-desc">'+s((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"account|paytm_description",e):r.call(a,"translate","account|paytm_description",e)))+"</div>\n          </div>\n        </a>\n      </div>\n    "}function k(a,b){var d,e,f="";return f+='\n      <div class="col-sm-4 col-xs-6 eq-">\n        <a href="/credit/recharge/yippster">\n          <div class="recharge-grid-cell">\n            <img class="recharge-grid-icon" src="'+s((d=c.getUrl||a&&a.getUrl,e={hash:{},data:b},d?d.call(a,"jsclient",e):r.call(a,"getUrl","jsclient",e)))+'/app/images/mig.me/payment/yippster.svg"/>\n            <div class="recharge-grid-text">'+s((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"account|yippster",e):r.call(a,"translate","account|yippster",e)))+'</div>\n            <div class="recharge-grid-desc">'+s((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"account|yippster_description",e):r.call(a,"translate","account|yippster_description",e)))+"</div>\n          </div>\n        </a>\n      </div>\n    "}function l(a,b){var d,e,f="";return f+='\n    <div class="col-sm-4 col-xs-6 eq-">\n      <a href="/credit/recharge/mol">\n        <div class="recharge-grid-cell">\n          <img class="recharge-grid-icon" src="'+s((d=c.getUrl||a&&a.getUrl,e={hash:{},data:b},d?d.call(a,"jsclient",e):r.call(a,"getUrl","jsclient",e)))+'/app/images/mig.me/payment/mol.svg"/>\n          <div class="recharge-grid-text">'+s((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"account|mol",e):r.call(a,"translate","account|mol",e)))+'</div>\n          <div class="recharge-grid-desc">'+s((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"account|mol_description",e):r.call(a,"translate","account|mol_description",e)))+"</div>\n        </div>\n      </a>\n    </div>\n    "}function m(a,b){var d,e,f="";return f+='\n    <div class="col-sm-4 col-xs-6 eq-">\n      <a href="/credit/recharge/western_union">\n        <div class="recharge-grid-cell">\n          <img class="recharge-grid-icon" src="'+s((d=c.getUrl||a&&a.getUrl,e={hash:{},data:b},d?d.call(a,"jsclient",e):r.call(a,"getUrl","jsclient",e)))+'/app/images/mig.me/payment/westernunion.svg"/>\n          <div class="recharge-grid-text">'+s((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"account|western_union",e):r.call(a,"translate","account|western_union",e)))+'</div>\n          <div class="recharge-grid-desc">'+s((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"account|westernunion_description",e):r.call(a,"translate","account|westernunion_description",e)))+"</div>\n        </div>\n      </a>\n    </div>\n    "}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var n,o,p,q="",r=c.helperMissing,s=this.escapeExpression,t=this,u="function",v=c.blockHelperMissing;return q+='<div class="col-sm-12 recharge-container">\n  <div class="recharge-grid equalBlocks">\n    ',p={hash:{},inverse:t.noop,fn:t.program(1,f,e),data:e},(o=c.ifUserCanAccessMimopay)?n=o.call(b,p):(o=b&&b.ifUserCanAccessMimopay,n=typeof o===u?o.call(b,p):o),c.ifUserCanAccessMimopay||(n=v.call(b,n,{hash:{},inverse:t.noop,fn:t.program(1,f,e),data:e})),(n||0===n)&&(q+=n),q+="\n    \n    ",p={hash:{},inverse:t.noop,fn:t.program(3,g,e),data:e},(o=c.ifUserCanAccessDoku)?n=o.call(b,p):(o=b&&b.ifUserCanAccessDoku,n=typeof o===u?o.call(b,p):o),c.ifUserCanAccessDoku||(n=v.call(b,n,{hash:{},inverse:t.noop,fn:t.program(3,g,e),data:e})),(n||0===n)&&(q+=n),q+="\n\n    ",p={hash:{},inverse:t.noop,fn:t.program(5,h,e),data:e},(o=c.ifUserCanAccessDompetku)?n=o.call(b,p):(o=b&&b.ifUserCanAccessDompetku,n=typeof o===u?o.call(b,p):o),c.ifUserCanAccessDompetku||(n=v.call(b,n,{hash:{},inverse:t.noop,fn:t.program(5,h,e),data:e})),(n||0===n)&&(q+=n),q+="\n\n    ",p={hash:{},inverse:t.noop,fn:t.program(7,i,e),data:e},(o=c.ifUserCanAccessEsewa)?n=o.call(b,p):(o=b&&b.ifUserCanAccessEsewa,n=typeof o===u?o.call(b,p):o),c.ifUserCanAccessEsewa||(n=v.call(b,n,{hash:{},inverse:t.noop,fn:t.program(7,i,e),data:e})),(n||0===n)&&(q+=n),q+="\n\n    ",p={hash:{},inverse:t.noop,fn:t.program(9,j,e),data:e},(o=c.ifUserCanAccessPaytm)?n=o.call(b,p):(o=b&&b.ifUserCanAccessPaytm,n=typeof o===u?o.call(b,p):o),c.ifUserCanAccessPaytm||(n=v.call(b,n,{hash:{},inverse:t.noop,fn:t.program(9,j,e),data:e})),(n||0===n)&&(q+=n),q+="\n\n    ",p={hash:{},inverse:t.noop,fn:t.program(11,k,e),data:e},(o=c.ifUserCanAccessYippster)?n=o.call(b,p):(o=b&&b.ifUserCanAccessYippster,n=typeof o===u?o.call(b,p):o),c.ifUserCanAccessYippster||(n=v.call(b,n,{hash:{},inverse:t.noop,fn:t.program(11,k,e),data:e})),(n||0===n)&&(q+=n),q+='\n\n    <div class="col-sm-4 col-xs-6 eq-">\n      <a href="/credit/recharge/merchant">\n        <div class="recharge-grid-cell">\n          <img class="recharge-grid-icon" src="'+s((o=c.getUrl||b&&b.getUrl,p={hash:{},data:e},o?o.call(b,"jsclient",p):r.call(b,"getUrl","jsclient",p)))+'/app/images/mig.me/payment/recharge-merchant.svg"/>\n          <div class="recharge-grid-text">'+s((o=c.translate||b&&b.translate,p={hash:{},data:e},o?o.call(b,"user|label_merchant",p):r.call(b,"translate","user|label_merchant",p)))+'</div>\n          <div class="recharge-grid-desc">'+s((o=c.translate||b&&b.translate,p={hash:{},data:e},o?o.call(b,"account|merchant_description",p):r.call(b,"translate","account|merchant_description",p)))+'</div>\n        </div>\n      </a>\n    </div>\n\n    <div class="col-sm-4 col-xs-6 eq-">\n      <a href="/credit/recharge/paypal">\n        <div class="recharge-grid-cell">\n          <img class="recharge-grid-icon" src="'+s((o=c.getUrl||b&&b.getUrl,p={hash:{},data:e},o?o.call(b,"jsclient",p):r.call(b,"getUrl","jsclient",p)))+'/app/images/mig.me/payment/paypal.svg"/>\n          <div class="recharge-grid-text">'+s((o=c.translate||b&&b.translate,p={hash:{},data:e},o?o.call(b,"account|paypal",p):r.call(b,"translate","account|paypal",p)))+'</div>\n          <div class="recharge-grid-desc">'+s((o=c.translate||b&&b.translate,p={hash:{},data:e},o?o.call(b,"account|paypal_description",p):r.call(b,"translate","account|paypal_description",p)))+'</div>\n        </div>\n      </a>\n    </div>\n\n    <div class="col-sm-4 col-xs-6 eq-">\n      <a href="/credit/recharge/creditcard">\n        <div class="recharge-grid-cell">\n          <img class="recharge-grid-icon" src="'+s((o=c.getUrl||b&&b.getUrl,p={hash:{},data:e},o?o.call(b,"jsclient",p):r.call(b,"getUrl","jsclient",p)))+'/app/images/mig.me/payment/cc.svg"/>\n          <div class="recharge-grid-text">'+s((o=c.translate||b&&b.translate,p={hash:{},data:e},o?o.call(b,"account|credit_card",p):r.call(b,"translate","account|credit_card",p)))+'</div>\n          <div class="recharge-grid-desc">'+s((o=c.translate||b&&b.translate,p={hash:{},data:e},o?o.call(b,"account|creditcard_description",p):r.call(b,"translate","account|creditcard_description",p)))+"</div>\n        </div>\n      </a>\n    </div>\n    ",p={hash:{},inverse:t.noop,fn:t.program(13,l,e),data:e},(o=c.ifUserCanAccessMOL)?n=o.call(b,p):(o=b&&b.ifUserCanAccessMOL,n=typeof o===u?o.call(b,p):o),c.ifUserCanAccessMOL||(n=v.call(b,n,{hash:{},inverse:t.noop,fn:t.program(13,l,e),data:e})),(n||0===n)&&(q+=n),q+="\n\n    ",p={hash:{},inverse:t.noop,fn:t.program(15,m,e),data:e},(o=c.ifUserCanAccessWesternUnion)?n=o.call(b,p):(o=b&&b.ifUserCanAccessWesternUnion,n=typeof o===u?o.call(b,p):o),c.ifUserCanAccessWesternUnion||(n=v.call(b,n,{hash:{},inverse:t.noop,fn:t.program(15,m,e),data:e})),(n||0===n)&&(q+=n),q+='\n\n    <div class="col-sm-4 col-xs-6 eq-">\n      <a href="/credit/recharge/skrill">\n        <div class="recharge-grid-cell">\n          <img class="recharge-grid-icon" src="'+s((o=c.getUrl||b&&b.getUrl,p={hash:{},data:e},o?o.call(b,"jsclient",p):r.call(b,"getUrl","jsclient",p)))+'/app/images/mig.me/payment/skrill.svg"/>\n          <div class="recharge-grid-text">'+s((o=c.translate||b&&b.translate,p={hash:{},data:e},o?o.call(b,"account|skrill",p):r.call(b,"translate","account|skrill",p)))+'</div>\n          <div class="recharge-grid-desc">'+s((o=c.translate||b&&b.translate,p={hash:{},data:e},o?o.call(b,"account|skrill_description",p):r.call(b,"translate","account|skrill_description",p)))+'</div>\n        </div>\n      </a>\n    </div>\n    <div class="col-sm-4 col-xs-6 eq-">\n      <a href="/credit/recharge/tele_trans">\n        <div class="recharge-grid-cell">\n          <img class="recharge-grid-icon" src="'+s((o=c.getUrl||b&&b.getUrl,p={hash:{},data:e},o?o.call(b,"jsclient",p):r.call(b,"getUrl","jsclient",p)))+'/app/images/mig.me/payment/telegraphic.svg"/>\n          <div class="recharge-grid-text">'+s((o=c.translate||b&&b.translate,p={hash:{},data:e},o?o.call(b,"account|telegraphic_transfer",p):r.call(b,"translate","account|telegraphic_transfer",p)))+'</div>\n          <div class="recharge-grid-desc">'+s((o=c.translate||b&&b.translate,p={hash:{},data:e},o?o.call(b,"account|teletransfer_description",p):r.call(b,"translate","account|teletransfer_description",p)))+'</div>\n        </div>\n      </a>\n    </div>\n    <div class="col-sm-4 col-xs-6 eq-">\n      <a href="/credit/recharge/bank_trans">\n        <div class="recharge-grid-cell">\n          <img class="recharge-grid-icon" src="'+s((o=c.getUrl||b&&b.getUrl,p={hash:{},data:e},o?o.call(b,"jsclient",p):r.call(b,"getUrl","jsclient",p)))+'/app/images/mig.me/payment/banktransfer.svg"/>\n          <div class="recharge-grid-text">'+s((o=c.translate||b&&b.translate,p={hash:{},data:e},o?o.call(b,"account|bank_transfer",p):r.call(b,"translate","account|bank_transfer",p)))+'</div>\n          <div class="recharge-grid-desc">'+s((o=c.translate||b&&b.translate,p={hash:{},data:e},o?o.call(b,"account|banktransfer_description",p):r.call(b,"translate","account|banktransfer_description",p)))+'</div>\n        </div>\n      </a>\n    </div>\n    <div class="col-sm-4 col-xs-6 eq-">\n      <a href="/credit/recharge/voucher">\n        <div class="recharge-grid-cell">\n          <img class="recharge-grid-icon" src="'+s((o=c.getUrl||b&&b.getUrl,p={hash:{},data:e},o?o.call(b,"jsclient",p):r.call(b,"getUrl","jsclient",p)))+'/app/images/mig.me/payment/vouchercharge.svg"/>\n          <div class="recharge-grid-text">'+s((o=c.translate||b&&b.translate,p={hash:{},data:e},o?o.call(b,"account|redeem_voucher",p):r.call(b,"translate","account|redeem_voucher",p)))+'</div>\n          <div class="recharge-grid-desc">'+s((o=c.translate||b&&b.translate,p={hash:{},data:e},o?o.call(b,"account|redeemvoucher_description",p):r.call(b,"translate","account|redeemvoucher_description",p)))+"</div>\n        </div>\n      </a>\n    </div>\n  </div>\n</div>\n"})}),define("modules/view/account/account_recharge_layout",["jquery","underscore","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/globals/url","hbs!modules/template/account/account-recharge-layout","modules/template/helpers/general_helpers","modules/template/helpers/store_helpers","jquery.highlight-4"],function(a,b,c,d,e,f,g,h,i,j){var k=e.Layout.extend({template:{type:"handlebars",template:j},regions:{defaultCategories:".store-categories-default",categories:".store-categories-content",container:".store-content",pagination:".load-more"},events:{"click .go-to-url":"goToUrl","click [data-toggle=offcanvas]":"toggleSideBar"},className:"recharge row",onShow:function(){var b=this;a(window).on("load resize",b.equaliseBlocks),b.equaliseBlocks()},toggleSideBar:function(b){a(".row-offcanvas",this.$el).toggleClass("active"),a(b.target).blur()},makeTabActive:function(b){a(".store-tabs",this.$el).find("li").removeClass("active").end().find("#store-category-tab-"+b).addClass("active")},goToUrl:function(b){b.preventDefault(),c.history.navigate(i.site.replace(window.location.protocol+"//"+window.location.hostname,"")+a(b.currentTarget).data("url"),{trigger:!0})},updateAccountBalance:function(b){a("#store-account-balance",this.$el).text(b)},showPagination:function(){a(".load-more",this.$el).show()},hidePagination:function(){a(".load-more",this.$el).hide()},setSearchCurrency:function(b){a(".store-search-user-currency",this.$el).text(b)},showSearch:function(){a(".store-search-form",this.$el).show()},hideSearch:function(){a(".store-search-form",this.$el).hide()},doSearchBy:function(b){b.preventDefault(),a(".store-searchby-text",this.$el).text(a(b.currentTarget).text()),"name"===a(b.currentTarget).data("searchby")?(a(".store-search-name",this.$el).show(),a(".store-search-price",this.$el).hide()):(a(".store-search-name",this.$el).hide(),a(".store-search-price",this.$el).show())},doSortBy:function(b){b.preventDefault(),a('input[name="store-sortby"]',this.$el).val(a(b.currentTarget).data("sortby")),a('input[name="store-sortorder"]',this.$el).val(a(b.currentTarget).data("sortorder")),a(".store-sortby-text",this.$el).text(a(b.currentTarget).text())},equaliseBlocks:function(){a.fn.eqHeights=function(b){var c={child:!1,parentSelector:null},d=a.extend(c,b),e=a(this);e.length>0&&!e.data("eqHeights")&&(a(window).bind("resize.eqHeights",function(){e.eqHeights()}),e.data("eqHeights",!0));var f;f=d.child&&d.child.length>0?a(d.child,this):a(this).children().find(".recharge-grid-cell");var g,h=Math.floor(a(this[0]).parent().width()/a(this[0]).width()),i=0,j=0,k=[];f.height("auto").each(function(){d.parentSelector&&g!==a(this).parents(d.parentSelector).get(0)&&(a(k).height(j),j=0,i=0,k=[],g=a(this).parents(d.parentSelector).get(0));var b=this.offsetTop;i>0&&i!=b&&(a(k).height(j),j=a(this).height(),k=[]),j=Math.max(j,a(this).height()),i=this.offsetTop,k.push(this),k.length>=h&&(a(k).height(j),j=0,k=[])})},a('.equalBlocks [class*="eq-"]').eqHeights({parentSelector:".equalBlocks"})}});return k}),define("hbs!modules/template/account/account-about",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+="<div class='row faq-outline flex-direction-column flex-align-start'>\n  <div class='font-bold font-color-link'>\n    "+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|about_title1",g):i.call(b,"translate","account|about_title1",g)))+"\n  </div>\n  <div class='padding-top'>\n    "+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|about_desc1",g):i.call(b,"translate","account|about_desc1",g)))+"\n  </div>\n\n  <br/>\n  <div class=\"about-migcoins\">\n    <div class='font-bold font-color-link'>\n      "+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|about_title2",g):i.call(b,"translate","account|about_title2",g)))+"\n    </div>\n    <div class='padding-top'>\n      "+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|about_desc2",g):i.call(b,"translate","account|about_desc2",g)))+"\n    </div>\n  <div>\n\n  <br/>\n  <div class='account-about-balance font-color-caption'>\n    <div class='font-bold'>\n      <span id='account-about-balance'></span>\n      "+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|equals",g):i.call(b,"translate","account|equals",g)))+"\n    </div>\n    \n    <div class='recharge-balance-details'>\n      <img class='svg' src='"+j((f=c.getUrl||b&&b.getUrl,g={hash:{},data:e},f?f.call(b,"jsclient",g):i.call(b,"getUrl","jsclient",g)))+"/app/images/mig.me/wb_credit_filled.svg'></img>\n      <span id='recharge-balance'>"+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"common|loading",g):i.call(b,"translate","common|loading",g)))+"</span>\n      <span id='recharge-currency'></span>\n    </div>\n\n    <div>"+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|credit_not_expired",g):i.call(b,"translate","account|credit_not_expired",g)))+"</div>\n  </div>\n\n  <br/>\n  <a href='#' class='btn-outline btn-center text-center convert-to-migcoins'>\n    <div>\n      "+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|convert_migcoins",g):i.call(b,"translate","account|convert_migcoins",g)))+"\n    </div>\n  </a>\n\n</div>"})}),define("modules/view/account/account_about_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/view/account/migcoins_convert_modal_view","hbs!modules/template/account/account-about","modules/common/config","modules/common/utility","modules/chat/models/user_session","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j,k){var l=k.Session.getInstance(),m=e.ItemView.extend({initialize:function(){a.bindAll(this)},onRender:function(){},template:{type:"handlebars",template:h},events:{"click .convert-to-migcoins":"openConvertToMigcoins"},className:"recharge-about",updateAccountBalance:function(c){if(i.store.show_migcoins===!1&&(this.hideMigcoins(),b(".about-migcoins").hide()),"undefined"==typeof c||null===c){if(void 0===l.get("account_balance")||null===l.get("account_balance"))return!1;c=j.add_thousands_seperator(l.get("account_balance"))+" "+l.get("currency_code")}this.balance=c;var d=this,e=c.split(" "),f=parseFloat(e[0].replace(/[^0-9\.]+/g,"")),g=e[1];g==i.store.migcoins_currency_code&&this.hideMigcoins(),b(".recharge-balance-details",this.$el).removeClass("has-balance").removeClass("no-balance"),b.ajax({url:j.format(i.urls.account_convert_amount_in_mvc,g,f),async:!1}).then(function(c){a.isUndefined(c.data)||a.isNull(c.data)||(b("#recharge-balance",d.$el).text(j.add_thousands_seperator(c.data)),b("#recharge-currency",d.$el).text(i.store.migcoins_currency_code),c.data>0?b(".recharge-balance-details",this.$el).addClass("has-balance").removeClass("no-balance"):b(".recharge-balance-details",this.$el).removeClass("has-balance").addClass("no-balance"))}),b("#account-about-balance",this.$el).text(c)},openConvertToMigcoins:function(){var a=b("#main-container"),c=new g;a.after(c.render().el),c.$el.modal("show"),c.updateAccountBalance(this.balance),c.$el.one("hidden.bs.modal",function(a){this.remove()})},hideMigcoins:function(){b(".account-about-balance").hide(),b(".convert-to-migcoins").hide()}});return m}),define("hbs!modules/template/account/account-pending-payment-list",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h,i="",j=c.helperMissing,k=this.escapeExpression,l="function";return i+='<div class="pending-icon">\n  <img src="'+k((g=c.getUrl||b&&b.getUrl,h={hash:{},data:e},g?g.call(b,"jsclient",h):j.call(b,"getUrl","jsclient",h)))+'/app/images/mig.me/wb_recent.svg"></img>\n</div>\n<div class="pending-row">\n  <div class="font-bold font-color-caption">'+k((g=c.mysqlDateFormat||b&&b.mysqlDateFormat,h={hash:{},data:e},g?g.call(b,b&&b.dateCreated,"mmm d, yyyy HH:MM:ss",h):j.call(b,"mysqlDateFormat",b&&b.dateCreated,"mmm d, yyyy HH:MM:ss",h)))+'</div>\n  <div class="">',(g=c.amount)?f=g.call(b,{hash:{},data:e}):(g=b&&b.amount,f=typeof g===l?g.call(b,{hash:{},data:e}):g),i+=k(f)+" ",(g=c.currency)?f=g.call(b,{hash:{},data:e}):(g=b&&b.currency,f=typeof g===l?g.call(b,{hash:{},data:e}):g),i+=k(f)+'</div>\n  <div class="font-size-small font-color-caption">',(g=c.vendorType)?f=g.call(b,{hash:{},data:e}):(g=b&&b.vendorType,f=typeof g===l?g.call(b,{hash:{},data:e}):g),i+=k(f)+"</div>\n</div>"})}),define("modules/view/account/account_pending_payment_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/account/account-pending-payment-list","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i){var j=e.ItemView.extend({template:{type:"handlebars",template:g},className:"pending-payment clearfix"});return j}),define("hbs!modules/template/account/account-pending",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="row recharge-merchant-container">\n  <div class="rechargetype-title">\n    '+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|pending_payment_title",g):i.call(b,"translate","account|pending_payment_title",g)))+'\n  </div>\n  <div class="recharge-content" style="margin-bottom:0px;">\n    <div class="recharge-content-merch">\n      '+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|pending_payment_desc",g):i.call(b,"translate","account|pending_payment_desc",g)))+'\n    </div>\n    <br/>\n  </div>\n</div>\n\n<div class="row recharge-content-list">\n  <div class="col-xs-12 no-padding">\n    <div class="pending-payments"></div>\n    <div class="pending-more text-center"><a href="#" class="btn btn-xs btn-default">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"common|more",g):i.call(b,"translate","common|more",g)))+"...</a></div>\n  </div>\n</div>"})}),define("modules/view/account/account_user_payment_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/view/account/account_pending_payment_item_view","hbs!modules/template/account/account-pending","modules/view/common/mig33_views","modules/template/helpers/general_helpers","modules/template/helpers/store_helpers"],function(a,b,c,d,e,f,g,h,i,j,k){var l=d.compile('{{translate "account|empty_pending"}}'),m=d.compile('{{translate "common|loading"}}...'),n=e.ItemView.extend({template:{type:"handlebars",template:l},className:"empty"}),o=e.ItemView.extend({template:{type:"handlebars",template:m},className:"loading"}),p=k.CompositeView.extend({itemView:i,emptyView:n,loadingView:o,itemViewContainer:".pending-payments",template:{type:"handlebars",template:j},events:{"click .pending-more a":"more"},onRender:function(){this.hideMore()},more:function(a){a.preventDefault(),this.trigger("account:pending:more")},hideMore:function(){b(".pending-more",this.$el).hide()}});return p}),define("hbs!modules/template/account/account-recharge",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="row">\n  <a href="/credit/history" class="faq-outline font-color-link">\n    <div class="col-xs-12 no-padding">\n      '+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"store|credit_balance",g):i.call(b,"translate","store|credit_balance",g)))+'\n      <span class="pull-right font-color-caption glyphicon glyphicon-triangle-right" aria-hidden="true"></span>\n    </div>\n  </a>\n\n  <div class="recharge-balance-details border-top">\n    <img class="svg" src="'+j((f=c.getUrl||b&&b.getUrl,g={hash:{},data:e},f?f.call(b,"jsclient",g):i.call(b,"getUrl","jsclient",g)))+'/app/images/mig.me/wb_credit_filled.svg"></img>\n    <span id="recharge-balance">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"common|loading",g):i.call(b,"translate","common|loading",g)))+'</span>\n    <span id="recharge-currency"></span>\n    <div class="hidden font-size-regular font-color-caption">\n      Last recharged on: <span id="last-recharged"></span>\n      <br/>\n      Next expiry date: <span id="next-expiry"></span>\n    </div>\n  </div>\n</div>\n\n<div class="recharge-reverse">\n  <div class="row padding-top">\n    <a href="/credit/recharge" class="faq-outline font-color-link">\n      <div class="col-xs-12 no-padding">\n        '+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|recharge_credits",g):i.call(b,"translate","account|recharge_credits",g)))+'\n        <span class="pull-right font-color-caption glyphicon glyphicon-triangle-right" aria-hidden="true"></span>\n      </div>\n    </a>\n    <a href="/credit/transfer" class="faq-outline font-color-link">\n      <div class="col-xs-12 no-padding">\n        '+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"user|transfer_credit",g):i.call(b,"translate","user|transfer_credit",g)))+'\n        <span class="pull-right font-color-caption glyphicon glyphicon-triangle-right" aria-hidden="true"></span>\n      </div>\n    </a>\n    <a href="/credit/pending" class="faq-outline font-color-link">\n      <div class="col-xs-12 no-padding">\n        '+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|pendingpayment",g):i.call(b,"translate","account|pendingpayment",g)))+'\n        <span class="pull-right font-color-caption glyphicon glyphicon-triangle-right" aria-hidden="true"></span>\n      </div>\n    </a>\n  </div>\n\n  <div class="row padding-top">\n    <div class="col-xs-12 faq-container">\n      <div class="faq-outline">\n        <div class="faq-image">\n          <img src="'+j((f=c.getUrl||b&&b.getUrl,g={hash:{},data:e},f?f.call(b,"jsclient",g):i.call(b,"getUrl","jsclient",g)))+'/app/images/mig.me/wb_illustwantcredit.svg"></img>\n          <div class="faq-header inline visible-xs">\n            '+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|recharge_title1",g):i.call(b,"translate","account|recharge_title1",g)))+'\n          </div>\n        </div>\n        <div class="faq-details">\n          <div class="faq-header hidden-xs">\n            '+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|recharge_title1",g):i.call(b,"translate","account|recharge_title1",g)))+'\n          </div>\n          <div class="faq-text">\n            '+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|recharge_desc1",g):i.call(b,"translate","account|recharge_desc1",g)))+'\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class="col-xs-12 faq-container blocks">\n      <div class="faq-outline">\n        <div class="faq-image">\n          <img src="'+j((f=c.getUrl||b&&b.getUrl,g={hash:{},data:e},f?f.call(b,"jsclient",g):i.call(b,"getUrl","jsclient",g)))+'/app/images/mig.me/wb_illustwhatiscredit.svg"></img>\n          <div class="faq-header inline visible-xs">\n            '+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|recharge_title2",g):i.call(b,"translate","account|recharge_title2",g)))+'\n          </div>\n        </div>\n        <div class="faq-details">\n          <div class="faq-header hidden-xs">\n            '+j((f=c.translate||b&&b.translate,
g={hash:{},data:e},f?f.call(b,"account|recharge_title2",g):i.call(b,"translate","account|recharge_title2",g)))+'\n          </div>\n          <div class="faq-text">\n            '+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|recharge_desc2",g):i.call(b,"translate","account|recharge_desc2",g)))+'\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class="col-xs-12 faq-container blocks">\n      <div class="faq-outline">\n        <div class="faq-image">\n          <img src="'+j((f=c.getUrl||b&&b.getUrl,g={hash:{},data:e},f?f.call(b,"jsclient",g):i.call(b,"getUrl","jsclient",g)))+'/app/images/mig.me/wb_illustmakefriendsmile.svg"></img>\n          <div class="faq-header inline visible-xs">\n            '+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|recharge_title3",g):i.call(b,"translate","account|recharge_title3",g)))+'\n          </div>\n        </div>\n        <div class="faq-details">\n          <div class="faq-header hidden-xs">\n            '+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|recharge_title3",g):i.call(b,"translate","account|recharge_title3",g)))+'\n          </div>\n          <div class="faq-text">\n            '+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|recharge_desc3",g):i.call(b,"translate","account|recharge_desc3",g)))+"\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>"})}),define("modules/view/account/account_recharge_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/account/account-recharge","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i){var j=e.ItemView.extend({initialize:function(){a.bindAll(this)},onRender:function(){},template:{type:"handlebars",template:g},className:"recharge-main",updateAccountBalance:function(a){var c=a.split(" "),d=parseFloat(c[0].replace(/[^0-9\.]+/g,"")),e=c[1];b("#recharge-balance",this.$el).text(i.add_thousands_seperator(d)),b("#recharge-currency",this.$el).text(e),d>0?b(".recharge-balance-details",this.$el).addClass("has-balance").removeClass("no-balance"):b(".recharge-balance-details",this.$el).removeClass("has-balance").addClass("no-balance")}});return j}),define("hbs!modules/template/account/account-recharge-merchant-list",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f,g="";return g+='\n	<div class="avatar">\n		<img src="'+G((e=c.getDisplayPictureUrl||a&&a.getDisplayPictureUrl,f={hash:{},data:b},e?e.call(a,(d=a&&a.userData,null==d||d===!1?d:d.username),(d=a&&a.userData,null==d||d===!1?d:d.displayPictureType),48,48,f):F.call(a,"getDisplayPictureUrl",(d=a&&a.userData,null==d||d===!1?d:d.username),(d=a&&a.userData,null==d||d===!1?d:d.displayPictureType),48,48,f)))+'" class="img-circle" />\n	</div>\n'}function g(a,b){return'\n	<div class="wrapper">\n'}function h(a,b){return'\n	<div class="wrapper" style="width: 100%;">\n'}function i(a,b){var d,e,f,g="";return g+='\n			<div class="username">\n				<a href="'+G((e=c.getProfileUrl||a&&a.getProfileUrl,f={hash:{},data:b},e?e.call(a,(d=a&&a.userData,null==d||d===!1?d:d.username),f):F.call(a,"getProfileUrl",(d=a&&a.userData,null==d||d===!1?d:d.username),f)))+'" title="'+G((d=a&&a.userData,d=null==d||d===!1?d:d.username,typeof d===H?d.apply(a):d))+'" class="font-size-regular profile-hovercard" data-username="'+G((d=a&&a.userData,d=null==d||d===!1?d:d.username,typeof d===H?d.apply(a):d))+'">',(e=c.name)?d=e.call(a,{hash:{},data:b}):(e=a&&a.name,d=typeof e===H?e.call(a,{hash:{},data:b}):e),g+=G(d)+"</a>\n				"+G((e=c.userGetLabels||a&&a.userGetLabels,f={hash:{},data:b},e?e.call(a,a&&a.userData,f):F.call(a,"userGetLabels",a&&a.userData,f)))+'\n        <br/>\n        <a href="'+G((e=c.getProfileUrl||a&&a.getProfileUrl,f={hash:{},data:b},e?e.call(a,(d=a&&a.userData,null==d||d===!1?d:d.username),f):F.call(a,"getProfileUrl",(d=a&&a.userData,null==d||d===!1?d:d.username),f)))+'" title="'+G((d=a&&a.userData,d=null==d||d===!1?d:d.username,typeof d===H?d.apply(a):d))+'" class="profile-hovercard" data-username="'+G((d=a&&a.userData,d=null==d||d===!1?d:d.username,typeof d===H?d.apply(a):d))+'">@'+G((d=a&&a.userData,d=null==d||d===!1?d:d.username,typeof d===H?d.apply(a):d))+'</a>\n			</div>\n\n			<div class="profile">\n				'+G((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|miglevel_with_level",(d=a&&a.userData,null==d||d===!1?d:d.migLevel),f):F.call(a,"translate","user|miglevel_with_level",(d=a&&a.userData,null==d||d===!1?d:d.migLevel),f)))+"&nbsp;&nbsp;&nbsp;\n				",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:I.noop,fn:I.program(8,j,b),data:b},d=e?e.call(a,(d=a&&a.userData,null==d||d===!1?d:d.country),f):F.call(a,"isNotEmpty",(d=a&&a.userData,null==d||d===!1?d:d.country),f),(d||0===d)&&(g+=d),g+="\n				",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:I.noop,fn:I.program(10,k,b),data:b},d=e?e.call(a,(d=a&&a.userData,null==d||d===!1?d:d.gender),f):F.call(a,"isNotEmpty",(d=a&&a.userData,null==d||d===!1?d:d.gender),f),(d||0===d)&&(g+=d),g+="\n			</div>\n		"}function j(a,b){var c,d="";return d+=G((c=a&&a.userData,c=null==c||c===!1?c:c.country,typeof c===H?c.apply(a):c))+", "}function k(a,b){var d,e;return G((d=c.userGetGender||a&&a.userGetGender,e={hash:{},data:b},d?d.call(a,a&&a.userData,e):F.call(a,"userGetGender",a&&a.userData,e)))}function l(a,b){var d,e,f,g="";return g+="\n			",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:I.noop,fn:I.program(13,m,b),data:b},d=e?e.call(a,a&&a.name,f):F.call(a,"isNotEmpty",a&&a.name,f),(d||0===d)&&(g+=d),g+="\n		"}function m(a,b){var d,e,f="";return f+='\n				<div class="username">\n					',(e=c.name)?d=e.call(a,{hash:{},data:b}):(e=a&&a.name,d=typeof e===H?e.call(a,{hash:{},data:b}):e),f+=G(d)+"\n				</div>\n			"}function n(a,b){var d,e,f,g="";return g+="\n				<dt>"+G((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"common|name",f):F.call(a,"translate","common|name",f)))+"</dt>\n				<dd>",(e=c.name)?d=e.call(a,{hash:{},data:b}):(e=a&&a.name,d=typeof e===H?e.call(a,{hash:{},data:b}):e),g+=G(d)+"</dd>\n			"}function o(a,b){var d,e,f,g="";return g+="\n				<dt>"+G((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"account|address",f):F.call(a,"translate","account|address",f)))+"</dt>\n				<dd>",(e=c.address)?d=e.call(a,{hash:{},data:b}):(e=a&&a.address,d=typeof e===H?e.call(a,{hash:{},data:b}):e),g+=G(d)+"</dd>\n			"}function p(a,b){var d,e,f,g="";return g+="\n				<dt>"+G((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"account|phone",f):F.call(a,"translate","account|phone",f)))+"</dt>\n				<dd>",(e=c.phoneNumber)?d=e.call(a,{hash:{},data:b}):(e=a&&a.phoneNumber,d=typeof e===H?e.call(a,{hash:{},data:b}):e),g+=G(d)+"</dd>\n			"}function q(a,b){var d,e,f,g="";return g+="\n				<dt>"+G((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"account|email",f):F.call(a,"translate","account|email",f)))+"</dt>\n				<dd>",(e=c.emailAddress)?d=e.call(a,{hash:{},data:b}):(e=a&&a.emailAddress,d=typeof e===H?e.call(a,{hash:{},data:b}):e),g+=G(d)+"</dd>\n			"}function r(a,b){var d,e,f,g="";return g+="\n				<dt>"+G((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"account|note",f):F.call(a,"translate","account|note",f)))+"</dt>\n				<dd>",(e=c.notes)?d=e.call(a,{hash:{},data:b}):(e=a&&a.notes,d=typeof e===H?e.call(a,{hash:{},data:b}):e),g+=G(d)+"</dd>\n			"}function s(a,b){var d,e,f,g="";return g+='\n	<div class="actions">\n		',e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:I.noop,fn:I.program(26,t,b),data:b},d=e?e.call(a,(d=a&&a.userData,null==d||d===!1?d:d.username),f):F.call(a,"isNotEmpty",(d=a&&a.userData,null==d||d===!1?d:d.username),f),(d||0===d)&&(g+=d),g+="\n		",e=c.isNotEmpty||a&&a.isNotEmpty,f={hash:{},inverse:I.noop,fn:I.program(37,A,b),data:b},d=e?e.call(a,(d=a&&a.userData,null==d||d===!1?d:d.emailAddress),f):F.call(a,"isNotEmpty",(d=a&&a.userData,null==d||d===!1?d:d.emailAddress),f),(d||0===d)&&(g+=d),g+="\n	</div>\n"}function t(a,b){var d,e,f,g="";return g+="\n			",d=c["if"].call(a,(d=a&&a.userData,d=null==d||d===!1?d:d._relationship,null==d||d===!1?d:d.isFriend),{hash:{},inverse:I.program(29,v,b),fn:I.program(27,u,b),data:b}),(d||0===d)&&(g+=d),g+='\n			<a href="#" class="mention btn btn-xs btn-default" title="'+G((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|mention",f):F.call(a,"translate","user|mention",f)))+'">'+G((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|mention",f):F.call(a,"translate","user|mention",f)))+"</a>\n		"}function u(a,b){var d,e,f,g="";return g+='\n				<a href="#" class="chat btn btn-xs btn-friends" data-username="'+G((d=a&&a.userData,d=null==d||d===!1?d:d.username,typeof d===H?d.apply(a):d))+'" title="'+G((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|friends",f):F.call(a,"translate","user|friends",f)))+'">'+G((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|friends",f):F.call(a,"translate","user|friends",f)))+"</a>\n				&nbsp;\n			"}function v(a,b){var d,e="";return e+="\n				",d=c["if"].call(a,(d=a&&a.userData,d=null==d||d===!1?d:d._relationship,null==d||d===!1?d:d.isFollower),{hash:{},inverse:I.program(32,x,b),fn:I.program(30,w,b),data:b}),(d||0===d)&&(e+=d),e+="\n			"}function w(a,b){var d,e,f="";return f+='\n					<span class="btn btn-xs btn-inverse-default" title="'+G((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"user|i_m_a_fan",e):F.call(a,"translate","user|i_m_a_fan",e)))+'">'+G((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"user|i_m_a_fan",e):F.call(a,"translate","user|i_m_a_fan",e)))+"</span>\n					&nbsp;\n				"}function x(a,b){var d,e="";return e+="\n					",d=c["if"].call(a,(d=a&&a.userData,d=null==d||d===!1?d:d._relationship,null==d||d===!1?d:d.isSelf),{hash:{},inverse:I.program(35,z,b),fn:I.program(33,y,b),data:b}),(d||0===d)&&(e+=d),e+="\n				"}function y(a,b){return"\n					"}function z(a,b){var d,e,f="";return f+='\n						<a href="#" class="follow btn btn-xs btn-inverse-default" title="'+G((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"user|add",e):F.call(a,"translate","user|add",e)))+'">'+G((d=c.translate||a&&a.translate,e={hash:{},data:b},d?d.call(a,"user|add",e):F.call(a,"translate","user|add",e)))+"</a>\n						&nbsp;\n					"}function A(a,b){var d,e,f,g="";return g+='\n			&nbsp;\n			<a href="mailto:',(e=c.emailAddress)?d=e.call(a,{hash:{},data:b}):(e=a&&a.emailAddress,d=typeof e===H?e.call(a,{hash:{},data:b}):e),g+=G(d)+'" class="email btn btn-xs btn-default" title="'+G((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"email|email",f):F.call(a,"translate","email|email",f)))+'">'+G((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"email|email",f):F.call(a,"translate","email|email",f)))+"</a>\n		"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var B,C,D,E="",F=c.helperMissing,G=this.escapeExpression,H="function",I=this;return C=c.isNotEmpty||b&&b.isNotEmpty,D={hash:{},inverse:I.noop,fn:I.program(1,f,e),data:e},B=C?C.call(b,(B=b&&b.userData,null==B||B===!1?B:B.username),D):F.call(b,"isNotEmpty",(B=b&&b.userData,null==B||B===!1?B:B.username),D),(B||0===B)&&(E+=B),E+="\n",C=c.isNotEmpty||b&&b.isNotEmpty,D={hash:{},inverse:I.program(5,h,e),fn:I.program(3,g,e),data:e},B=C?C.call(b,b&&b.userData,D):F.call(b,"isNotEmpty",b&&b.userData,D),(B||0===B)&&(E+=B),E+='\n	<div class="details">\n		',C=c.isNotEmpty||b&&b.isNotEmpty,D={hash:{},inverse:I.program(12,l,e),fn:I.program(7,i,e),data:e},B=C?C.call(b,b&&b.userData,D):F.call(b,"isNotEmpty",b&&b.userData,D),(B||0===B)&&(E+=B),E+='\n		<dl class="dl-horizontal hidden">\n			',C=c.isNotEmpty||b&&b.isNotEmpty,D={hash:{},inverse:I.noop,fn:I.program(15,n,e),data:e},B=C?C.call(b,b&&b.name,D):F.call(b,"isNotEmpty",b&&b.name,D),(B||0===B)&&(E+=B),E+="\n			",C=c.isNotEmpty||b&&b.isNotEmpty,D={hash:{},inverse:I.noop,fn:I.program(17,o,e),data:e},B=C?C.call(b,b&&b.address,D):F.call(b,"isNotEmpty",b&&b.address,D),(B||0===B)&&(E+=B),E+="\n			",C=c.isNotEmpty||b&&b.isNotEmpty,D={hash:{},inverse:I.noop,fn:I.program(19,p,e),data:e},B=C?C.call(b,b&&b.phoneNumber,D):F.call(b,"isNotEmpty",b&&b.phoneNumber,D),(B||0===B)&&(E+=B),E+="\n			",C=c.isNotEmpty||b&&b.isNotEmpty,D={hash:{},inverse:I.noop,fn:I.program(21,q,e),data:e},B=C?C.call(b,b&&b.emailAddress,D):F.call(b,"isNotEmpty",b&&b.emailAddress,D),(B||0===B)&&(E+=B),E+="\n			",C=c.isNotEmpty||b&&b.isNotEmpty,D={hash:{},inverse:I.noop,fn:I.program(23,r,e),data:e},B=C?C.call(b,b&&b.notes,D):F.call(b,"isNotEmpty",b&&b.notes,D),(B||0===B)&&(E+=B),E+="\n		</dl>\n	</div>\n</div>\n",C=c.isNotEmpty||b&&b.isNotEmpty,D={hash:{},inverse:I.noop,fn:I.program(25,s,e),data:e},B=C?C.call(b,b&&b.userData,D):F.call(b,"isNotEmpty",b&&b.userData,D),(B||0===B)&&(E+=B),E})}),define("modules/view/account/account_recharge_merchant_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/account/account-recharge-merchant-list","modules/common/config","modules/common/utility","modules/chat/models/chats","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j){var k=e.ItemView.extend({template:{type:"handlebars",template:g},className:"merchant clearfix",events:{"click .mention":"mention","click .follow":"follow","click .chat":"chat"},onRender:function(){i.parse_profile_hovercard(this)},follow:function(a){a.preventDefault();var c=this.model.follow();c.done(function(c){0===c.error.errno&&b(a.currentTarget).fadeOut()})},chat:function(a){a.preventDefault(),j.ChatStoreModel.getInstance().startPrivateChat(0,b(a.currentTarget).data("username"),null,b(a.currentTarget).data("username"))},mention:function(a){a.preventDefault();var c=this,d=b("#sharebox-modal");b('textarea[name="body"]',d).focus().val("@"+c.model.get("username")+" "),d.modal("show")}});return k}),define("hbs!modules/template/account/account-recharge-merchant",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="row recharge-merchant-container">\n  <div class="rechargetype-title">\n    '+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|merchant_recharge_title",g):i.call(b,"translate","account|merchant_recharge_title",g)))+'\n  </div>\n  <div class="recharge-content" style="margin-bottom:0px;">\n    <div class="recharge-content-merch">\n      '+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|merchant_recharge_desc",g):i.call(b,"translate","account|merchant_recharge_desc",g)))+'\n    </div>\n    <div class="row recharge-points-container">\n      <div class="recharge-points">\n        <div class="recharge-points-icon col-xs-2">1</div>\n        <div class="recharge-points-text-container col-xs-10">\n          <div class="recharge-points-header">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|merchant_recharge_title1",g):i.call(b,"translate","account|merchant_recharge_title1",g)))+'</div>\n          <div class="recharge-points-text">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|merchant_recharge_desc1",g):i.call(b,"translate","account|merchant_recharge_desc1",g)))+'</div>\n        </div>\n      </div>\n      <div class="recharge-points">\n        <div class="recharge-points-icon col-xs-2">2</div>\n        <div class="recharge-points-text-container col-xs-10">\n          <div class="recharge-points-header">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|merchant_recharge_title2",g):i.call(b,"translate","account|merchant_recharge_title2",g)))+'</div>\n          <div class="recharge-points-text">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|merchant_recharge_desc2",g):i.call(b,"translate","account|merchant_recharge_desc2",g)))+'</div>\n        </div>\n      </div>\n      <div class="recharge-points">\n        <div class="recharge-points-icon col-xs-2">3</div>\n        <div class="recharge-points-text-container col-xs-10">\n          <div class="recharge-points-header">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|merchant_recharge_title3",g):i.call(b,"translate","account|merchant_recharge_title3",g)))+'</div>\n          <div class="recharge-points-text">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|merchant_recharge_desc3",g):i.call(b,"translate","account|merchant_recharge_desc3",g)))+'</div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n\n<div class="row recharge-header">\n	<div class="font-size-14">\n		'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|recharge_through_merchant_description",g):i.call(b,"translate","account|recharge_through_merchant_description",g)))+"\n	</div>\n	\n  <br/>\n	<div>\n		"+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|this_is_how_it_works",g):i.call(b,"translate","account|this_is_how_it_works",g)))+'\n	</div>\n\n	<div class="instructions clearfix">\n		<div class="step col-sm-4">\n			<div class="title">\n				<span class="number">1</span>\n				<span class="t_description">\n          <div class="font-bold">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|recharge_merchant_step_1_title",g):i.call(b,"translate","account|recharge_merchant_step_1_title",g)))+"</div>\n          "+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|recharge_merchant_step_1",g):i.call(b,"translate","account|recharge_merchant_step_1",g)))+'\n        </span>\n			</div>\n		</div>\n		<div class="step col-sm-4">\n			<div class="title">\n				<span class="number">2</span>\n        <span class="t_description">\n          <div class="font-bold">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|recharge_merchant_step_2_title",g):i.call(b,"translate","account|recharge_merchant_step_2_title",g)))+"</div>\n          "+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|recharge_merchant_step_2",g):i.call(b,"translate","account|recharge_merchant_step_2",g)))+'\n        </span>\n			</div>\n		</div>\n		<div class="step col-sm-4">\n			<div class="title">\n				<span class="number">3</span>\n        <span class="t_description">\n          <div class="font-bold">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|recharge_merchant_step_3_title",g):i.call(b,"translate","account|recharge_merchant_step_3_title",g)))+"</div>\n          "+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|recharge_merchant_step_3",g):i.call(b,"translate","account|recharge_merchant_step_3",g)))+'\n        </span>\n			</div>\n		</div>\n	</div>\n</div>\n\n<div class="row content-page-tabs">\n	<div class="col-xs-12">\n		<ul class="nav nav-tabs merchant-tabs">\n			<li id="recharge-tab-merchant" class="col-xs-6"><a href="/credit/recharge/merchant">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|suggested_merchants",g):i.call(b,"translate","account|suggested_merchants",g)))+'</a></li>\n			<li id="recharge-tab-bylocation" class="col-xs-6" style="border-right-width:1px"><a href="/credit/recharge/merchant/location">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|browse_by_location",g):i.call(b,"translate","account|browse_by_location",g)))+'</a></li>\n		</ul>\n	</div>\n</div>\n\n<div class="row recharge-content-list">\n	<div class="col-xs-12 no-padding">\n		<div class="merchants"></div>\n		<div class="merchants-more text-center"><a href="#" class="btn btn-xs btn-default">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"common|more",g):i.call(b,"translate","common|more",g)))+"...</a></div>\n	</div>\n</div>"})}),define("modules/view/account/account_recharge_merchant_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/view/account/account_recharge_merchant_item_view","hbs!modules/template/account/account-recharge-merchant","modules/view/common/mig33_views","modules/template/helpers/general_helpers","modules/template/helpers/store_helpers"],function(a,b,c,d,e,f,g,h,i,j,k){var l=d.compile('{{translate "account|empty_merchants"}}'),m=d.compile('{{translate "common|loading"}}...'),n=e.ItemView.extend({template:{type:"handlebars",template:l},className:"empty"}),o=e.ItemView.extend({template:{type:"handlebars",template:m},className:"loading"}),p=k.CompositeView.extend({itemView:i,emptyView:n,loadingView:o,itemViewContainer:".merchants",current_tab:"merchant",template:{type:"handlebars",template:j},events:{'click input[name="merchant-location-search-submit"]':"doSearch",'keyup input[name="store-search-query"]':"searchEnter","click .merchants-more a":"more"},onRender:function(){this.makeTabActive()},setCurrentTab:function(a){this.current_tab=a,this.makeTabActive()},makeTabActive:function(){b(".merchant-tabs").find("li").removeClass("active").end().find("#recharge-tab-"+this.current_tab).addClass("active")},searchEnter:function(a){13==a.keyCode&&(a.stopPropagation(),this.doSearch(a))},doSearch:function(a){a.preventDefault();var d=b(".merchant-location-search-form",this.$el),e=b.trim(b('input[name="merchant-location-search-query"]',d).val()),f=0===e.length;f?c.history.navigate("account/recharge/merchant",{trigger:!0}):c.history.navigate(d.attr("action")+"?name="+encodeURIComponent(e),{trigger:!0})},resetSearchForm:function(){b(".merchant-location-search-form",this.$el).trigger("reset")},more:function(a){a.preventDefault(),this.trigger("account:recharge:merchant:more")},hideMore:function(){b(".merchants-more",this.$el).hide()},changeTitle:function(a){a.length>0?b(".merchant-title",this.$el).text(h.translate("account|recharge_through_merchant_description_2",a)):b(".merchant-title",this.$el).text(h.translate("account|recharge_through_merchant_description"))}});return p}),define("hbs!modules/template/account/account-recharge-merchant-countries-list",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i="function",j=this.escapeExpression;return h+='<a href="/credit/recharge/merchant/location/',(g=c.id)?f=g.call(b,{hash:{},data:e}):(g=b&&b.id,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'" title="',(g=c.name)?f=g.call(b,{hash:{},data:e}):(g=b&&b.name,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+'">',(g=c.name)?f=g.call(b,{hash:{},data:e}):(g=b&&b.name,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+"</a>&nbsp;(",(g=c.num)?f=g.call(b,{hash:{},data:e}):(g=b&&b.num,f=typeof g===i?g.call(b,{hash:{},data:e}):g),h+=j(f)+")"})}),define("modules/view/account/account_recharge_merchant_countries_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/account/account-recharge-merchant-countries-list","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i){var j=e.ItemView.extend({template:{type:"handlebars",template:g},tagName:"li",className:"country"});return j}),define("hbs!modules/template/account/account-recharge-merchant-countries",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="row recharge-merchant-container">\n  <div class="rechargetype-title">\n    '+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|merchant_recharge_title",g):i.call(b,"translate","account|merchant_recharge_title",g)))+'\n  </div>\n  <div class="recharge-content" style="margin-bottom:0px;">\n    <div class="recharge-content-merch">\n      '+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|merchant_recharge_desc",g):i.call(b,"translate","account|merchant_recharge_desc",g)))+'\n    </div>\n    <div class="row recharge-points-container">\n      <div class="recharge-points">\n        <div class="recharge-points-icon col-xs-2">1</div>\n        <div class="recharge-points-text-container col-xs-10">\n          <div class="recharge-points-header">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|merchant_recharge_title1",g):i.call(b,"translate","account|merchant_recharge_title1",g)))+'</div>\n          <div class="recharge-points-text">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|merchant_recharge_desc1",g):i.call(b,"translate","account|merchant_recharge_desc1",g)))+'</div>\n        </div>\n      </div>\n      <div class="recharge-points">\n        <div class="recharge-points-icon col-xs-2">2</div>\n        <div class="recharge-points-text-container col-xs-10">\n          <div class="recharge-points-header">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|merchant_recharge_title2",g):i.call(b,"translate","account|merchant_recharge_title2",g)))+'</div>\n          <div class="recharge-points-text">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|merchant_recharge_desc2",g):i.call(b,"translate","account|merchant_recharge_desc2",g)))+'</div>\n        </div>\n      </div>\n      <div class="recharge-points">\n        <div class="recharge-points-icon col-xs-2">3</div>\n        <div class="recharge-points-text-container col-xs-10">\n          <div class="recharge-points-header">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|merchant_recharge_title3",g):i.call(b,"translate","account|merchant_recharge_title3",g)))+'</div>\n          <div class="recharge-points-text">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|merchant_recharge_desc3",g):i.call(b,"translate","account|merchant_recharge_desc3",g)))+'</div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n\n<div class="row recharge-header">\n  <div class="font-size-14">\n    '+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|recharge_through_merchant_description",g):i.call(b,"translate","account|recharge_through_merchant_description",g)))+"\n  </div>\n  \n  <br/>\n  <div>\n    "+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|this_is_how_it_works",g):i.call(b,"translate","account|this_is_how_it_works",g)))+'\n  </div>\n\n  <div class="instructions clearfix">\n    <div class="step col-sm-4">\n      <div class="title">\n        <span class="number">1</span>\n        <span class="t_description">\n          <div class="font-bold">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|recharge_merchant_step_1_title",g):i.call(b,"translate","account|recharge_merchant_step_1_title",g)))+"</div>\n          "+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|recharge_merchant_step_1",g):i.call(b,"translate","account|recharge_merchant_step_1",g)))+'\n        </span>\n      </div>\n    </div>\n    <div class="step col-sm-4">\n      <div class="title">\n        <span class="number">2</span>\n        <span class="t_description">\n          <div class="font-bold">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|recharge_merchant_step_2_title",g):i.call(b,"translate","account|recharge_merchant_step_2_title",g)))+"</div>\n          "+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|recharge_merchant_step_2",g):i.call(b,"translate","account|recharge_merchant_step_2",g)))+'\n        </span>\n      </div>\n    </div>\n    <div class="step col-sm-4">\n      <div class="title">\n        <span class="number">3</span>\n        <span class="t_description">\n          <div class="font-bold">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|recharge_merchant_step_3_title",g):i.call(b,"translate","account|recharge_merchant_step_3_title",g)))+"</div>\n          "+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|recharge_merchant_step_3",g):i.call(b,"translate","account|recharge_merchant_step_3",g)))+'\n        </span>\n      </div>\n    </div>\n  </div>\n</div>\n\n<div class="row content-page-tabs">\n	<div class="col-xs-12">\n		<ul class="nav nav-tabs merchant-tabs">\n			<li id="recharge-tab-merchant" class="col-xs-6"><a href="/credit/recharge/merchant">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|suggested_merchants",g):i.call(b,"translate","account|suggested_merchants",g)))+'</a></li>\n			<li id="recharge-tab-bylocation" class="col-xs-6" style="border-right-width:1px"><a href="/credit/recharge/merchant/location">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|browse_by_location",g):i.call(b,"translate","account|browse_by_location",g)))+'</a></li>\n		</ul>\n	</div>\n</div>\n\n<div class="row recharge-content-list">\n	<div class="col-sm-12">\n		<form class="form-inline padding-8px" action="/credit/recharge/merchant/location/" method="get" >\n			<div class="form-group" style="width:100%; display: none;">\n				<input type="text" name="merchant-location-search-query" class="form-control input-sm merchant-search-bar" placeholder="'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"common|search",g):i.call(b,"translate","common|search",g)))+'">\n				<input type="submit" name="merchant-location-search-submit" value="'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"common|search",g):i.call(b,"translate","common|search",g)))+'" class="btn btn-sm btn-default" />\n			</div>\n		</form>\n\n		<ul class="countries list-unstyled"></ul>\n	</div>\n</div>'})}),define("modules/view/account/account_recharge_merchant_countries_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/view/account/account_recharge_merchant_countries_item_view","hbs!modules/template/account/account-recharge-merchant-countries","modules/view/common/mig33_views","modules/template/helpers/general_helpers","modules/template/helpers/store_helpers"],function(a,b,c,d,e,f,g,h,i,j,k){var l=d.compile('{{translate "account|empty_countries"}}'),m=d.compile('{{translate "common|loading"}}...'),n=e.ItemView.extend({template:{type:"handlebars",template:l},tagName:"li",className:"empty"}),o=e.ItemView.extend({template:{type:"handlebars",template:m},tagName:"li",className:"loading"}),p=k.CompositeView.extend({itemView:i,emptyView:n,loadingView:o,itemViewContainer:".countries",current_tab:"bylocation",template:{type:"handlebars",template:j},events:{'click input[name="merchant-location-search-submit"]':"doSearch",'keyup input[name="store-search-query"]':"searchEnter"},onRender:function(){b(".merchant-tabs").find("li").removeClass("active").end().find("#recharge-tab-"+this.current_tab).addClass("active")},setCurrentTab:function(a){this.current_tab=a},searchEnter:function(a){13==a.keyCode&&(a.stopPropagation(),this.doSearch(a))},doSearch:function(a){a.preventDefault();var d=b(".merchant-location-search-form",this.$el),e=b.trim(b('input[name="merchant-location-search-query"]',d).val()),f=0===e.length;f?c.history.navigate("account/recharge/merchant",{trigger:!0}):c.history.navigate(d.attr("action")+"?name="+encodeURIComponent(e),{trigger:!0})}});return p}),define("hbs!modules/template/account/account-recharge-paypal",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="row recharge-header">\n	<div class="title">\n		'+j((f=c.translate||b&&b.translate,
g={hash:{},data:e},f?f.call(b,"account|paypal_recharge_title",g):i.call(b,"translate","account|paypal_recharge_title",g)))+'\n	</div>\n	<hr>\n\n	<div class="font-size-14">\n		'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|paypal_recharge_desc",g):i.call(b,"translate","account|paypal_recharge_desc",g)))+'\n	</div>\n		\n	<div class="instructions clearfix">\n		<div class="step col-sm-4">\n			<div class="title">\n				<span class="number">1</span>\n				<div class="t_description">\n					'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|paypal_recharge_step_1",g):i.call(b,"translate","account|paypal_recharge_step_1",g)))+'\n				</div>\n			</div>\n		</div>\n		<div class="step col-sm-4">\n			<div class="title">\n				<span class="number">2</span>\n				<div class="t_description">\n					'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|paypal_recharge_step_2",g):i.call(b,"translate","account|paypal_recharge_step_2",g)))+'\n				</div>\n			</div>\n		</div>\n		<div class="step col-sm-4">\n			<div class="title">\n				<span class="number">3</span>\n				<div class="t_description">\n					'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|paypal_recharge_step_3",g):i.call(b,"translate","account|paypal_recharge_step_3",g)))+'\n				</div>\n			</div>\n		</div>\n	</div>\n</div>\n\n<div class="row recharge-content-list">\n	<iframe id="recharge-iframe" class="recharge-iframe" style="width: 100%; height:190px; padding: 0px; margin: 0px; border: 0px;" src="/sites/ajax/payment/create_paypal_payment" onload="window.AdjustIframeHeightOnLoad(\'recharge-iframe\')"></iframe>\n</div>'})}),define("modules/view/account/account_recharge_paypal_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/account/account-recharge-paypal","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i){var j=e.ItemView.extend({template:{type:"handlebars",template:g,sidebar:"asdf"},onShow:function(){var a=this;this._iframe=b("iframe",this.$el),this._iframe.load(function(){a._applyContainmentStyle(this)})},_applyContainmentStyle:function(a){b(a).ready(function(){b(a).contents().find("body").addClass("in-iframe")})}});return j}),define("hbs!modules/template/account/account-recharge-creditcard",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h,i="",j=c.helperMissing,k=this.escapeExpression,l="function";return i+='<div class="row recharge-header">\n	<div class="title">\n		'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"account|creditcard_recharge_title",h):j.call(b,"translate","account|creditcard_recharge_title",h)))+'\n	</div>\n	<hr>\n\n	<div class="font-size-14">\n		'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"account|creditcard_recharge_desc",h):j.call(b,"translate","account|creditcard_recharge_desc",h)))+'\n	</div>\n	\n	<div class="instructions clearfix">\n		<div class="step col-sm-4">\n			<div class="title">\n				<span class="number">1</span>\n				<div class="t_description">\n					'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"account|creditcard_recharge_step_1",h):j.call(b,"translate","account|creditcard_recharge_step_1",h)))+'\n				</div>\n			</div>\n		</div>\n		<div class="step col-sm-4">\n			<div class="title">\n				<span class="number">2</span>\n				<div class="t_description">\n					'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"account|creditcard_recharge_step_2",h):j.call(b,"translate","account|creditcard_recharge_step_2",h)))+'\n				</div>\n			</div>\n		</div>\n		<div class="step col-sm-4">\n			<div class="title">\n				<span class="number">3</span>\n				<div class="t_description">\n					'+k((g=c.translate||b&&b.translate,h={hash:{},data:e},g?g.call(b,"account|creditcard_recharge_step_3",h):j.call(b,"translate","account|creditcard_recharge_step_3",h)))+'\n				</div>\n			</div>\n		</div>\n	</div>\n</div>\n\n<div class="row recharge-content-list">\n	<iframe id="recharge-iframe" class="recharge-iframe" style="width: 100%; height:320px; padding: 0px; margin: 0px; border: 0px;" src="',(g=c.getHttpsUrl)?f=g.call(b,{hash:{},data:e}):(g=b&&b.getHttpsUrl,f=typeof g===l?g.call(b,{hash:{},data:e}):g),i+=k(f)+'/sites/ajax/account/credit_debit"" onload="window.AdjustIframeHeightOnLoad(\'recharge-iframe\')"></iframe>\n</div>'})}),define("modules/view/account/account_recharge_creditcard_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/account/account-recharge-creditcard","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i){var j=e.ItemView.extend({template:{type:"handlebars",template:g},onShow:function(){var a=this;this._iframe=b("iframe",this.$el),this._iframe.load(function(){a._applyContainmentStyle(this)})},_applyContainmentStyle:function(a){b(a).ready(function(){b(a).contents().find("body").addClass("in-iframe")})}});return j}),define("hbs!modules/template/account/account-recharge-skrill",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="row recharge-header">\n	<div class="title">\n		'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|skrill_recharge_title",g):i.call(b,"translate","account|skrill_recharge_title",g)))+'\n	</div>\n	<hr>\n\n	<div class="font-size-14">\n		'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|skrill_recharge_desc",g):i.call(b,"translate","account|skrill_recharge_desc",g)))+'\n	</div>\n	\n	<div class="instructions clearfix">\n		<div class="step col-sm-4">\n			<div class="title">\n				<span class="number">1</span>\n				<div class="t_description">\n					'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|skrill_recharge_step_1",g):i.call(b,"translate","account|skrill_recharge_step_1",g)))+'\n				</div>\n			</div>\n		</div>\n		<div class="step col-sm-4">\n			<div class="title">\n				<span class="number">2</span>\n				<div class="t_description">\n					'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|skrill_recharge_step_2",g):i.call(b,"translate","account|skrill_recharge_step_2",g)))+'\n				</div>\n			</div>\n		</div>\n		<div class="step col-sm-4">\n			<div class="title">\n				<span class="number">3</span>\n				<div class="t_description">\n					'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|skrill_recharge_step_3",g):i.call(b,"translate","account|skrill_recharge_step_3",g)))+'\n				</div>\n			</div>\n		</div>\n	</div>\n</div>\n\n<div class="row recharge-content-list">\n	<iframe id="recharge-iframe" class="recharge-iframe" style="width: 100%; height:300px; padding: 0px; margin: 0px; border: 0px;" src="/sites/ajax/account/moneybookers_form" onload="window.AdjustIframeHeightOnLoad(\'recharge-iframe\')"></iframe>\n</div>'})}),define("modules/view/account/account_recharge_skrill_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/account/account-recharge-skrill","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i){var j=e.ItemView.extend({template:{type:"handlebars",template:g},className:"account-recharge-wrapper",onShow:function(){var a=this;this._iframe=b("iframe",this.$el),this._iframe.load(function(){a._applyContainmentStyle(this)})},_applyContainmentStyle:function(a){b(a).ready(function(){b(a).contents().find("body").addClass("in-iframe")})}});return j}),define("hbs!modules/template/account/account-recharge-mol",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="row recharge-header">\n	<div class="title">\n		'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|mol_recharge_title",g):i.call(b,"translate","account|mol_recharge_title",g)))+'\n	</div>\n	<hr>\n\n	<div class="font-size-14">\n		'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|mol_recharge_desc",g):i.call(b,"translate","account|mol_recharge_desc",g)))+'\n	</div>\n	\n	<div class="instructions clearfix">\n		<div class="step col-sm-4">\n			<div class="title">\n				<span class="number">1</span>\n				<div class="t_description">\n					'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|mol_recharge_step_1",g):i.call(b,"translate","account|mol_recharge_step_1",g)))+'\n				</div>\n			</div>\n		</div>\n		<div class="step col-sm-4">\n			<div class="title">\n				<span class="number">2</span>\n				<div class="t_description">\n					'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|mol_recharge_step_2",g):i.call(b,"translate","account|mol_recharge_step_2",g)))+'\n				</div>\n			</div>\n		</div>\n		<div class="step col-sm-4">\n			<div class="title">\n				<span class="number">3</span>\n				<div class="t_description">\n					'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|mol_recharge_step_3",g):i.call(b,"translate","account|mol_recharge_step_3",g)))+'\n				</div>\n			</div>\n		</div>\n	</div>\n</div>\n\n<div class="row recharge-content-list">\n    <iframe id="recharge-iframe" class="recharge-iframe" style="width: 100%; height:150px; padding: 0px; margin: 0px; border: 0px;" src="/sites/ajax/payment/create_mol_payment" onload="window.AdjustIframeHeightOnLoad(\'recharge-iframe\')"></iframe>\n</div>'})}),define("modules/view/account/account_recharge_mol_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/account/account-recharge-mol","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i){var j=e.ItemView.extend({template:{type:"handlebars",template:g},onShow:function(){var a=this;this._iframe=b("iframe",this.$el),this._iframe.load(function(){a._applyContainmentStyle(this)})},_applyContainmentStyle:function(a){b(a).ready(function(){b(a).contents().find("body").addClass("in-iframe")})}});return j}),define("hbs!modules/template/account/account-recharge-westernunion",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="row recharge-header">\n	<div class="title">\n		'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|recharge_by_west_union",g):i.call(b,"translate","account|recharge_by_west_union",g)))+'\n	</div>\n	<hr>\n\n	<div class="font-size-14">\n		'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|recharge_by_west_union_description",g):i.call(b,"translate","account|recharge_by_west_union_description",g)))+'\n	</div>\n	\n	<div class="instructions clearfix">\n		<div class="step col-sm-4">\n			<div class="title">\n				<span class="number">1</span>\n				<div class="t_description">\n					'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|recharge_by_west_union_step_1",g):i.call(b,"translate","account|recharge_by_west_union_step_1",g)))+'\n				</div>\n			</div>\n		</div>\n		<div class="step col-sm-4">\n			<div class="title">\n				<span class="number">2</span>\n				<div class="t_description">\n					'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|recharge_by_west_union_step_2",g):i.call(b,"translate","account|recharge_by_west_union_step_2",g)))+'\n				</div>\n			</div>\n		</div>\n		<div class="step col-sm-4">\n			<div class="title">\n				<span class="number">3</span>\n				<div class="t_description">\n					'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|recharge_by_west_union_step_3",g):i.call(b,"translate","account|recharge_by_west_union_step_3",g)))+'\n				</div>\n			</div>\n		</div>\n	</div>\n\n	<div class="title">\n		'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|payment_details",g):i.call(b,"translate","account|payment_details",g)))+'\n	</div>\n	<div class="font-size-12">\n		<table class="recharge-details-table">\n			<tr>\n				<td>'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|receivers_name",g):i.call(b,"translate","account|receivers_name",g)))+"</td>\n				<td>"+j((f=c.getGTMVariable||b&&b.getGTMVariable,g={hash:{},data:e},f?f.call(b,"wu_name","Dinnah Otida Sanchez",g):i.call(b,"getGTMVariable","wu_name","Dinnah Otida Sanchez",g)))+"</td>\n			</tr>\n			<tr>\n				<td>"+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"common|city",g):i.call(b,"translate","common|city",g)))+"</td>\n				<td>Singapore</td>\n			</tr>\n			<tr>\n				<td>"+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"common|country",g):i.call(b,"translate","common|country",g)))+'</td>\n				<td>Singapore</td>\n			</tr>\n		</table>\n	</div>\n</div>\n\n<div class="row recharge-content-list">\n	<iframe id="recharge-iframe" class="recharge-iframe" style="width: 100%; height:980px; padding: 0px; margin: 0px; border: 0px;" src="/sites/ajax/account/western_union_form" onload="window.AdjustIframeHeightOnLoad(\'recharge-iframe\')"></iframe>\n</div>\n'})}),define("modules/view/account/account_recharge_westernunion_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/account/account-recharge-westernunion","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i){var j=e.ItemView.extend({template:{type:"handlebars",template:g},onShow:function(){var a=this;this._iframe=b("iframe",this.$el),this._iframe.load(function(){a._applyContainmentStyle(this)})},_applyContainmentStyle:function(a){b(a).ready(function(){b(a).contents().find("body").addClass("in-iframe")})}});return j}),define("hbs!modules/template/account/account-recharge-teletrans",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="row recharge-header">\n	<div class="title">\n		'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|telegraph_recharge_title",g):i.call(b,"translate","account|telegraph_recharge_title",g)))+'\n	</div>\n	<hr>\n\n	<div class="font-size-14">\n		'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|telegraph_recharge_desc",g):i.call(b,"translate","account|telegraph_recharge_desc",g)))+'\n	</div>\n	\n	<div class="instructions clearfix">\n		<div class="step col-sm-4">\n			<div class="title">\n				<span class="number">1</span>\n				<div class="t_description">\n					'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|telegraph_recharge_step_1",g):i.call(b,"translate","account|telegraph_recharge_step_1",g)))+'\n				</div>\n			</div>\n		</div>\n		<div class="step col-sm-4">\n			<div class="title">\n				<span class="number">2</span>\n				<div class="t_description">\n					'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|telegraph_recharge_step_2",g):i.call(b,"translate","account|telegraph_recharge_step_2",g)))+'\n				</div>\n			</div>\n		</div>\n		<div class="step col-sm-4">\n			<div class="title">\n				<span class="number">3</span>\n				<div class="t_description">\n					'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|telegraph_recharge_step_3",g):i.call(b,"translate","account|telegraph_recharge_step_3",g)))+'\n				</div>\n			</div>\n		</div>\n	</div>\n\n	<div class="title">\n		'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|payment_details",g):i.call(b,"translate","account|payment_details",g)))+'\n	</div>\n	<div class="font-size-12">\n		<table class="recharge-details-table">\n			<tr>\n				<td>'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|name_of_beneficiary",g):i.call(b,"translate","account|name_of_beneficiary",g)))+"</td>\n				<td>Mig33 Pte Ltd</td>\n			</tr>\n			<tr>\n				<td>"+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|company_address",g):i.call(b,"translate","account|company_address",g)))+"</td>\n				<td>111 North Bridge Road, #26-01, Peninsula Plaza, Singapore 179098</td>\n			</tr>\n			<tr>\n				<td>"+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|name_of_bank",g):i.call(b,"translate","account|name_of_bank",g)))+"</td>\n				<td>Citibank</td>\n			</tr>\n			<tr>\n				<td>"+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|address_of_bank",g):i.call(b,"translate","account|address_of_bank",g)))+"</td>\n				<td>8 Marina View #16-01, Asia Square Tower 1, Singapore 018960</td>\n			</tr>\n			<tr>\n				<td>"+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|routing_transit_number",g):i.call(b,"translate","account|routing_transit_number",g)))+"</td>\n				<td>0-852484-012</td>\n			</tr>\n			<tr>\n				<td>"+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|bank_swift_code",g):i.call(b,"translate","account|bank_swift_code",g)))+"</td>\n				<td>CITISGSG</td>\n			</tr>\n			<tr>\n				<td>"+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|payment_detail_desc",g):i.call(b,"translate","account|payment_detail_desc",g)))+'</td>\n				<td>Enter your migme username and registered mobile number including country code (eg. migmeusername, +12345678900)</td>\n			</tr>\n		</table>\n	</div>\n</div>\n\n<div class="row recharge-content-list">\n	<iframe id="recharge-iframe" class="recharge-iframe" style="width: 100%; height:400px; padding: 0px; margin: 0px; border: 0px;" src="/sites/ajax/account/tt_form" onload="window.AdjustIframeHeightOnLoad(\'recharge-iframe\')"></iframe>\n</div>'})}),define("modules/view/account/account_recharge_teletrans_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/account/account-recharge-teletrans","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i){var j=e.ItemView.extend({template:{type:"handlebars",template:g},onShow:function(){var a=this;this._iframe=b("iframe",this.$el),this._iframe.load(function(){a._applyContainmentStyle(this)})},_applyContainmentStyle:function(a){b(a).ready(function(){b(a).contents().find("body").addClass("in-iframe")})}});return j}),define("hbs!modules/template/account/account-recharge-banktrans",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="row recharge-header">\n	<div class="title">\n		'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|recharge_by_bank_transfer",g):i.call(b,"translate","account|recharge_by_bank_transfer",g)))+'\n	</div>\n	<hr>\n\n	<div class="font-size-14">\n		'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|recharge_through_bank_description",g):i.call(b,"translate","account|recharge_through_bank_description",g)))+'\n	</div>\n	\n	<div class="instructions clearfix">\n		<div class="step col-sm-4">\n			<div class="title">\n				<span class="number">1</span>\n				<div class="t_description">\n					'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|recharge_bank_step_1",g):i.call(b,"translate","account|recharge_bank_step_1",g)))+'\n				</div>\n			</div>\n		</div>\n		<div class="step col-sm-4">\n			<div class="title">\n				<span class="number">2</span>\n				<div class="t_description">\n					'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|recharge_bank_step_2",g):i.call(b,"translate","account|recharge_bank_step_2",g)))+'\n				</div>\n			</div>\n		</div>\n		<div class="step col-sm-4">\n			<div class="title">\n				<span class="number">3</span>\n				<div class="t_description">\n					'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|recharge_bank_step_3",g):i.call(b,"translate","account|recharge_bank_step_3",g)))+'\n				</div>\n			</div>\n		</div>\n	</div>\n</div>\n\n<div class="row recharge-content-list">\n	<iframe id="recharge-iframe" class="recharge-iframe" style="width: 100%; height:480px; padding: 0px; margin: 0px; border: 0px;" src="/sites/ajax/account/bank_deposit" onload="window.AdjustIframeHeightOnLoad(\'recharge-iframe\')"></iframe>\n</div>'})}),define("modules/view/account/account_recharge_banktrans_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/account/account-recharge-banktrans","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i){var j=e.ItemView.extend({template:{type:"handlebars",template:g},onShow:function(){var a=this;this._iframe=b("iframe",this.$el),this._iframe.load(function(){a._applyContainmentStyle(this)})},_applyContainmentStyle:function(a){b(a).ready(function(){b(a).contents().find("body").addClass("in-iframe")})}});return j}),define("hbs!modules/template/account/account-recharge-voucher",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="row recharge-header">\n	<div class="title">\n		'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|voucher_recharge_title",g):i.call(b,"translate","account|voucher_recharge_title",g)))+'\n	</div>\n	<hr>\n</div>\n\n<div class="row recharge-content-list" style="margin-top: -45px; background-color: white;">\n	<iframe id="recharge-iframe" class="recharge-iframe" style="width: 100%; height:220px; padding: 0px; margin: 0px; border: 0px;" src="/sites/ajax/account/redeem_voucher" onload="window.AdjustIframeHeightOnLoad(\'recharge-iframe\')"></iframe>\n</div>'})}),define("modules/view/account/account_recharge_voucher_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/account/account-recharge-voucher","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i){var j=e.ItemView.extend({template:{type:"handlebars",template:g},onShow:function(){var a=this;this._iframe=b("iframe",this.$el),this._iframe.load(function(){a._applyContainmentStyle(this)})},_applyContainmentStyle:function(a){b(a).ready(function(){b(a).contents().find("body").addClass("in-iframe")})}});return j}),define("hbs!modules/template/account/account-recharge-balance-item",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var c,d="";return d+='\n<div class="transaction-datails">\n	<div class="amount '+i((c=a&&a.type,typeof c===h?c.apply(a):c))+'">\n		<span>'+i((c=a&&a.amount,typeof c===h?c.apply(a):c))+"</span><span> "+i((c=a&&a.currency,typeof c===h?c.apply(a):c))+'</span>\n	</div>\n	<div class="date">\n		<span>'+i((c=a&&a.dateCreated,typeof c===h?c.apply(a):c))+' (GTM)</span>\n	</div>\n	<div class="description">\n		<span>'+i((c=a&&a.description,typeof c===h?c.apply(a):c))+"</span>\n	</div>\n</div>\n"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var g,h="function",i=this.escapeExpression,j=this;return g=c["if"].call(b,b&&b.id,{hash:{},inverse:j.noop,fn:j.program(1,f,e),data:e}),g||0===g?g:""})}),define("modules/view/account/account_recharge_balance_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/account/account-recharge-balance-item","modules/common/config","modules/common/utility","modules/chat/models/chats","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i,j){var k=e.ItemView.extend({template:{type:"handlebars",template:g},className:"transaction"});return k}),define("hbs!modules/template/account/account-recharge-balance",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="row recharge-balance-header">\n	<div class="recharge-balance-details border-top">\n		<img class="svg" src="'+j((f=c.getUrl||b&&b.getUrl,g={hash:{},data:e},f?f.call(b,"jsclient",g):i.call(b,"getUrl","jsclient",g)))+'/app/images/mig.me/wb_credit_filled.svg"></img>\n		<span id="recharge-balance">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"common|loading",g):i.call(b,"translate","common|loading",g)))+'</span>\n		<span id="recharge-currency"></span>\n	</div>\n</div>\n<div class="row recharge-balance-container">\n	<div class="recharge-balance-filter">\n		<ul class="filter-container">\n			<li id="recharge-balance-all" class="filter-button">All</li>\n			<li id="recharge-balance-recharge" class="filter-button">Recharges</li>\n			<li id="recharge-balance-purchase" class="filter-button">Purchases</li>\n			<li id="recharge-balance-transfer" class="filter-button">Transfers</li>\n		</ul>\n	</div>\n	<div class="recharge-balance-category-title">\n	</div>\n	<div class="recharge-balance-transaction">\n	</div>\n	<div class="transaction-details-more text-center"><a href="#" class="btn btn-xs btn-radius btn-default">'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"common|more",g):i.call(b,"translate","common|more",g)))+"...</a></div>\n</div>"})}),define("modules/view/account/account_recharge_balance_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/common/config","modules/common/utility","modules/view/account/account_recharge_balance_item_view","hbs!modules/template/account/account-recharge-balance","modules/view/common/mig33_views","modules/template/helpers/general_helpers","modules/template/helpers/store_helpers"],function(a,b,c,d,e,f,g,h,i,j,k){var l=d.compile('{{translate "account|empty_transaction"}}'),m=d.compile('{{translate "common|loading"}}...'),n=e.ItemView.extend({template:{type:"handlebars",template:l},className:"empty"}),o=e.ItemView.extend({template:{type:"handlebars",template:m},className:"loading"}),p=null,q=k.CompositeView.extend({itemView:i,emptyView:n,loadingView:o,itemViewContainer:".recharge-balance-transaction",template:{type:"handlebars",template:j},events:{"click .transaction-details-more a":"more","click #recharge-balance-all":"filterAll","click #recharge-balance-recharge":"filterRecharge","click #recharge-balance-purchase":"filterPurchase","click #recharge-balance-transfer":"filterTransfer"},initialize:function(a){this.options=a,this.setCurrentTab("all")},filterAll:function(){"all"!==this.current_tab&&(this.setCurrentTab("all"),this.clearTabData(),this.options.collection.category="",this.options.collection.setPage(0),this.options.collection.fetch())},filterRecharge:function(){"recharge"!==this.current_tab&&(this.setCurrentTab("recharge"),this.clearTabData(),this.options.collection.category="recharge",this.options.collection.setPage(0),this.options.collection.fetch())},filterPurchase:function(){"purchase"!==this.current_tab&&(this.setCurrentTab("purchase"),this.clearTabData(),this.options.collection.category="purchase",this.options.collection.setPage(0),this.options.collection.fetch())},filterTransfer:function(){"transfer"!==this.current_tab&&(this.setCurrentTab("transfer"),this.clearTabData(),this.options.collection.category="transfer",this.options.collection.setPage(0),this.options.collection.fetch())},onRender:function(){this.makeTabActive(),this.updateAccountBalance(p)},setCurrentTab:function(a){this.current_tab=a},clearTabData:function(){b(".recharge-balance-transaction").html('<div class="loading"></div>')},makeTabActive:function(){b(".filter-container").find("li").removeClass("active").end().find("#recharge-balance-"+this.current_tab).addClass("active"),"all"===this.current_tab?b(".recharge-balance-category-title",this.$el).html("All Transactions"):b(".recharge-balance-category-title",this.$el).html("Previous "+this.current_tab+"s")},more:function(a){a.preventDefault(),this.options.collection.nextPage(),"all"===this.current_tab?this.options.collection.fetch({remove:!1}):this.options.collection.fetch({accountEntryCategory:this.current_tab,remove:!1})},hideMore:function(){b(".transaction-details-more",this.$el).hide()},showMore:function(){b(".transaction-details-more",this.$el).show()},updateAccountBalance:function(a){if(null!==a?p=a:null!==p&&(a=p),null===a)return!1;var c=a.split(" "),d=parseFloat(c[0].replace(/[^0-9\.]+/g,"")),e=c[1];b("#recharge-balance",this.$el).text(h.add_thousands_seperator(d)),b("#recharge-currency",this.$el).text(e),d>0?b(".recharge-balance-details",this.$el).addClass("has-balance").removeClass("no-balance"):b(".recharge-balance-details",this.$el).removeClass("has-balance").addClass("no-balance"),h.inline_svg()}});return q}),define("hbs!modules/template/account/account-recharge-doku-alfamart",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="row recharge-header">\n	<div class="title">\n		'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|doku_alfamart_title",g):i.call(b,"translate","account|doku_alfamart_title",g)))+'\n	</div>\n	<hr>\n\n	<div class="font-size-14">\n		'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|doku_alfamart_desc",g):i.call(b,"translate","account|doku_alfamart_desc",g)))+'\n	</div>\n	\n	<div class="instructions clearfix">\n		<div class="step col-sm-4">\n			<div class="title">\n				<span class="number">1</span>\n				<div class="t_description">\n					'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|doku_offline_step_1",g):i.call(b,"translate","account|doku_offline_step_1",g)))+'\n				</div>\n			</div>\n		</div>\n		<div class="step col-sm-4">\n			<div class="title">\n				<span class="number">2</span>\n				<div class="t_description">\n					'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|doku_alfamart_step_2",g):i.call(b,"translate","account|doku_alfamart_step_2",g)))+'\n				</div>\n			</div>\n		</div>\n		<div class="step col-sm-4">\n			<div class="title">\n				<span class="number">3</span>\n				<div class="t_description">\n					'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|doku_step_3",g):i.call(b,"translate","account|doku_step_3",g)))+'\n				</div>\n			</div>\n		</div>\n	</div>\n</div>\n\n<div class="row recharge-content-list">\n	<iframe id="recharge-iframe" class="recharge-iframe" style="width: 100%; height:320px; padding: 0px; margin: 0px; border: 0px;" src="/sites/ajax/payment/doku_payment_request?pc=14" onload="window.AdjustIframeHeightOnLoad(\'recharge-iframe\')"></iframe>\n</div>'})}),define("modules/view/account/account_recharge_doku_alfamart_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/account/account-recharge-doku-alfamart","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i){var j=e.ItemView.extend({template:{type:"handlebars",template:g},onShow:function(){var a=this;this._iframe=b("iframe",this.$el),this._iframe.load(function(){
a._applyContainmentStyle(this)})},_applyContainmentStyle:function(a){b(a).ready(function(){b(a).contents().find("body").addClass("in-iframe")})}});return j}),define("hbs!modules/template/account/account-recharge-doku-atm",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="row recharge-header">\n	<div class="title">\n		'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|doku_atm_title",g):i.call(b,"translate","account|doku_atm_title",g)))+'\n	</div>\n	<hr>\n\n	<div class="font-size-14">\n		'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|doku_atm_desc",g):i.call(b,"translate","account|doku_atm_desc",g)))+'\n	</div>\n	\n	<div class="instructions clearfix">\n		<div class="step col-sm-4">\n			<div class="title">\n				<span class="number">1</span>\n				<div class="t_description">\n					'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|doku_offline_step_1",g):i.call(b,"translate","account|doku_offline_step_1",g)))+'\n				</div>\n			</div>\n		</div>\n		<div class="step col-sm-4">\n			<div class="title">\n				<span class="number">2</span>\n				<div class="t_description">\n					'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|doku_atm_step_2",g):i.call(b,"translate","account|doku_atm_step_2",g)))+'\n				</div>\n			</div>\n		</div>\n		<div class="step col-sm-4">\n			<div class="title">\n				<span class="number">3</span>\n				<div class="t_description">\n					'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|doku_step_3",g):i.call(b,"translate","account|doku_step_3",g)))+'\n				</div>\n			</div>\n		</div>\n	</div>\n</div>\n\n<div class="row recharge-content-list">\n	<iframe id="recharge-iframe" class="recharge-iframe" style="width: 100%; height:320px; padding: 0px; margin: 0px; border: 0px;" src="/sites/ajax/payment/doku_payment_request?pc=5" onload="window.AdjustIframeHeightOnLoad(\'recharge-iframe\')"></iframe>\n</div>'})}),define("modules/view/account/account_recharge_doku_atm_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/account/account-recharge-doku-atm","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i){var j=e.ItemView.extend({template:{type:"handlebars",template:g},onShow:function(){var a=this;this._iframe=b("iframe",this.$el),this._iframe.load(function(){a._applyContainmentStyle(this)})},_applyContainmentStyle:function(a){b(a).ready(function(){b(a).contents().find("body").addClass("in-iframe")})}});return j}),define("hbs!modules/template/account/account-recharge-doku-epay",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="row recharge-header">\n	<div class="title">\n		'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|doku_epay_title",g):i.call(b,"translate","account|doku_epay_title",g)))+'\n	</div>\n	<hr>\n\n	<div class="font-size-14">\n		'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|doku_epay_desc",g):i.call(b,"translate","account|doku_epay_desc",g)))+'\n	</div>\n	\n	<div class="instructions clearfix">\n		<div class="step col-sm-4">\n			<div class="title">\n				<span class="number">1</span>\n				<div class="t_description">\n					'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|doku_online_step_1",g):i.call(b,"translate","account|doku_online_step_1",g)))+'\n				</div>\n			</div>\n		</div>\n		<div class="step col-sm-4">\n			<div class="title">\n				<span class="number">2</span>\n				<div class="t_description">\n					'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|doku_epay_step_2",g):i.call(b,"translate","account|doku_epay_step_2",g)))+'\n				</div>\n			</div>\n		</div>\n		<div class="step col-sm-4">\n			<div class="title">\n				<span class="number">3</span>\n				<div class="t_description">\n					'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|doku_step_3",g):i.call(b,"translate","account|doku_step_3",g)))+'\n				</div>\n			</div>\n		</div>\n	</div>\n</div>\n\n<div class="row recharge-content-list">\n	<iframe id="recharge-iframe" class="recharge-iframe" style="width: 100%; height:320px; padding: 0px; margin: 0px; border: 0px;" src="/sites/ajax/payment/doku_payment_request?pc=6" onload="window.AdjustIframeHeightOnLoad(\'recharge-iframe\')"></iframe>\n</div>'})}),define("modules/view/account/account_recharge_doku_epay_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/account/account-recharge-doku-epay","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i){var j=e.ItemView.extend({template:{type:"handlebars",template:g},onShow:function(){var a=this;this._iframe=b("iframe",this.$el),this._iframe.load(function(){a._applyContainmentStyle(this)})},_applyContainmentStyle:function(a){b(a).ready(function(){b(a).contents().find("body").addClass("in-iframe")})}});return j}),define("hbs!modules/template/account/account-recharge-doku-mandiri",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="row recharge-header">\n		<div class="title">\n			'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|doku_mandiri_title",g):i.call(b,"translate","account|doku_mandiri_title",g)))+'\n		</div>\n		<hr>\n\n		<div class="font-size-14">\n			'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|doku_mandiri_desc",g):i.call(b,"translate","account|doku_mandiri_desc",g)))+'\n		</div>\n		\n		<div class="instructions clearfix">\n			<div class="step col-sm-4">\n				<div class="title">\n					<span class="number">1</span>\n					<div class="t_description">\n						'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|doku_online_step_1",g):i.call(b,"translate","account|doku_online_step_1",g)))+'\n					</div>\n				</div>\n			</div>\n			<div class="step col-sm-4">\n				<div class="title">\n					<span class="number">2</span>\n					<div class="t_description">\n						'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|doku_mandiri_step_2",g):i.call(b,"translate","account|doku_mandiri_step_2",g)))+'\n					</div>\n				</div>\n			</div>\n			<div class="step col-sm-4">\n				<div class="title">\n					<span class="number">3</span>\n					<div class="t_description">\n						'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|doku_step_3",g):i.call(b,"translate","account|doku_step_3",g)))+'\n					</div>\n				</div>\n			</div>\n		</div>\n</div>\n\n<div class="row recharge-content-list">\n	<iframe id="recharge-iframe" class="recharge-iframe" style="width: 100%; height:320px; padding: 0px; margin: 0px; border: 0px;" src="/sites/ajax/payment/doku_payment_request?pc=2" onload="window.AdjustIframeHeightOnLoad(\'recharge-iframe\')"></iframe>\n</div>'})}),define("modules/view/account/account_recharge_doku_mandiri_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/account/account-recharge-doku-mandiri","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i){var j=e.ItemView.extend({template:{type:"handlebars",template:g},onShow:function(){var a=this;this._iframe=b("iframe",this.$el),this._iframe.load(function(){a._applyContainmentStyle(this)})},_applyContainmentStyle:function(a){b(a).ready(function(){b(a).contents().find("body").addClass("in-iframe")})}});return j}),define("hbs!modules/template/account/account-recharge-doku-wallet",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="row recharge-header">\n	<div class="title">\n		'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|doku_wallet_title",g):i.call(b,"translate","account|doku_wallet_title",g)))+'\n	</div>\n	<hr>\n\n	<div class="font-size-14">\n		'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|doku_wallet_desc",g):i.call(b,"translate","account|doku_wallet_desc",g)))+'\n	</div>\n	\n	<div class="instructions clearfix">\n		<div class="step col-sm-4">\n			<div class="title">\n				<span class="number">1</span>\n				<div class="t_description">\n					'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|doku_online_step_1",g):i.call(b,"translate","account|doku_online_step_1",g)))+'\n				</div>\n			</div>\n		</div>\n		<div class="step col-sm-4">\n			<div class="title">\n				<span class="number">2</span>\n				<div class="t_description">\n					'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|doku_wallet_step_2",g):i.call(b,"translate","account|doku_wallet_step_2",g)))+'\n				</div>\n			</div>\n		</div>\n		<div class="step col-sm-4">\n			<div class="title">\n				<span class="number">3</span>\n				<div class="t_description">\n					'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|doku_step_3",g):i.call(b,"translate","account|doku_step_3",g)))+'\n				</div>\n			</div>\n		</div>\n	</div>\n</div>\n\n<div class="row recharge-content-list">\n	<iframe id="recharge-iframe" class="recharge-iframe" style="width: 100%; height:320px; padding: 0px; margin: 0px; border: 0px;" src="/sites/ajax/payment/doku_payment_request?pc=4" onload="window.AdjustIframeHeightOnLoad(\'recharge-iframe\')"></iframe>\n</div>'})}),define("modules/view/account/account_recharge_doku_wallet_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/account/account-recharge-doku-wallet","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i){var j=e.ItemView.extend({template:{type:"handlebars",template:g},onShow:function(){var a=this;this._iframe=b("iframe",this.$el),this._iframe.load(function(){a._applyContainmentStyle(this)})},_applyContainmentStyle:function(a){b(a).ready(function(){b(a).contents().find("body").addClass("in-iframe")})}});return j}),define("hbs!modules/template/account/account-recharge-dompetku",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="row recharge-header">\n	<div class="title">\n		'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|dompetku_recharge_title",g):i.call(b,"translate","account|dompetku_recharge_title",g)))+'\n	</div>\n	<hr>\n\n	<div class="font-size-14">\n		'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|dompetku_recharge_desc",g):i.call(b,"translate","account|dompetku_recharge_desc",g)))+'\n	</div>\n	\n	<div class="instructions clearfix">\n		<div class="step col-sm-4">\n			<div class="title">\n				<span class="number">1</span>\n				<div class="t_description">\n					'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|dompetku_recharge_step_1",g):i.call(b,"translate","account|dompetku_recharge_step_1",g)))+'\n				</div>\n			</div>\n		</div>\n		<div class="step col-sm-4">\n			<div class="title">\n				<span class="number">2</span>\n				<div class="t_description">\n					'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|dompetku_recharge_step_2",g):i.call(b,"translate","account|dompetku_recharge_step_2",g)))+'\n				</div>\n			</div>\n		</div>\n		<div class="step col-sm-4">\n			<div class="title">\n				<span class="number">3</span>\n				<div class="t_description">\n					'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|dompetku_recharge_step_3",g):i.call(b,"translate","account|dompetku_recharge_step_3",g)))+'\n				</div>\n			</div>\n		</div>\n	</div>\n</div>\n\n<div class="row recharge-content-list">\n	<iframe id="recharge-iframe" class="recharge-iframe" style="width: 100%; height:460px; padding: 0px; margin: 0px; border: 0px;" src="/sites/ajax/payment/dompetku_payment_request" onload="window.AdjustIframeHeightOnLoad(\'recharge-iframe\')"></iframe>\n	<script type="text/javascript">\n		var eventMethod = window.addEventListener ? "addEventListener" : "attachEvent";\n		var eventer = window[eventMethod];\n		var messageEvent = eventMethod == "attachEvent" ? "onmessage" : "message";\n\n		// Listen to messages from child window\n		eventer(messageEvent, function(e) {\n		    var key = e.message ? "message" : "data";\n		    var data = e[key];\n\n		    if (data=="resizeIframeHeight") {\n		    	window.AdjustIframeHeightOnLoad(\'recharge-iframe\', false);\n		    };\n		}, false);\n\n	</script>\n</div>'})}),define("modules/view/account/account_recharge_dompetku_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/account/account-recharge-dompetku","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i){var j=e.ItemView.extend({template:{type:"handlebars",template:g},onShow:function(){var a=this;this._iframe=b("iframe",this.$el),this._iframe.load(function(){a._applyContainmentStyle(this)})},_applyContainmentStyle:function(a){b(a).ready(function(){b(a).contents().find("body").addClass("in-iframe")})}});return j}),define("hbs!modules/template/account/account-recharge-mimopay",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="row recharge-header">\n		<div class="title">\n			'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|mimopay_recharge_title",g):i.call(b,"translate","account|mimopay_recharge_title",g)))+'\n		</div>\n		<hr>\n\n		<div class="font-size-14">\n			'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|mimopay_recharge_desc",g):i.call(b,"translate","account|mimopay_recharge_desc",g)))+'\n		</div>\n		\n		<div class="instructions clearfix">\n			<div class="step col-sm-4">\n				<div class="title">\n					<span class="number">1</span>\n					<div class="t_description">\n						'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|mimopay_recharge_step_1",g):i.call(b,"translate","account|mimopay_recharge_step_1",g)))+'\n					</div>\n				</div>\n			</div>\n			<div class="step col-sm-4">\n				<div class="title">\n					<span class="number">2</span>\n					<div class="t_description">\n						'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|mimopay_recharge_step_2",g):i.call(b,"translate","account|mimopay_recharge_step_2",g)))+'\n					</div>\n				</div>\n			</div>\n			<div class="step col-sm-4">\n				<div class="title">\n					<span class="number">3</span>\n					<div class="t_description">\n						'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|mimopay_recharge_step_3",g):i.call(b,"translate","account|mimopay_recharge_step_3",g)))+'\n					</div>\n				</div>\n			</div>\n		</div>\n</div>\n\n<div class="row recharge-content-list">\n	<iframe id="recharge-iframe" class="recharge-iframe" style="width: 100%; height:240px; padding: 0px; margin: 0px; border: 0px;" src="/sites/ajax/payment/mimopay_payment_request" onload="window.AdjustIframeHeightOnLoad(\'recharge-iframe\')"></iframe>\n</div>'})}),define("modules/view/account/account_recharge_mimopay_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/account/account-recharge-mimopay","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i){var j=e.ItemView.extend({template:{type:"handlebars",template:g},onShow:function(){var a=this;this._iframe=b("iframe",this.$el),this._iframe.load(function(){a._applyContainmentStyle(this)})},_applyContainmentStyle:function(a){b(a).ready(function(){b(a).contents().find("body").addClass("in-iframe")})}});return j}),define("hbs!modules/template/account/account-recharge-esewa",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="row recharge-header">\n		<div class="title">\n			'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|esewa_recharge_title",g):i.call(b,"translate","account|esewa_recharge_title",g)))+'\n		</div>\n		<hr>\n\n		<div class="font-size-14">\n			'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|esewa_recharge_desc",g):i.call(b,"translate","account|esewa_recharge_desc",g)))+'\n		</div>\n		\n		<div class="instructions clearfix">\n			<div class="step col-sm-4">\n				<div class="title">\n					<span class="number">1</span>\n					<div class="t_description">\n						'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|esewa_recharge_step_1",g):i.call(b,"translate","account|esewa_recharge_step_1",g)))+'\n					</div>\n				</div>\n			</div>\n			<div class="step col-sm-4">\n				<div class="title">\n					<span class="number">2</span>\n					<div class="t_description">\n						'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|esewa_recharge_step_2",g):i.call(b,"translate","account|esewa_recharge_step_2",g)))+'\n					</div>\n				</div>\n			</div>\n			<div class="step col-sm-4">\n				<div class="title">\n					<span class="number">3</span>\n					<div class="t_description">\n						'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|esewa_recharge_step_3",g):i.call(b,"translate","account|esewa_recharge_step_3",g)))+'\n					</div>\n				</div>\n			</div>\n		</div>\n</div>\n\n<div class="row recharge-content-list">\n	<iframe id="recharge-iframe" class="recharge-iframe" style="width: 100%; height:240px; padding: 0px; margin: 0px; border: 0px;" src="/sites/ajax/payment/esewa_payment_request" onload="window.AdjustIframeHeightOnLoad(\'recharge-iframe\')"></iframe>\n</div>'})}),define("modules/view/account/account_recharge_esewa_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/account/account-recharge-esewa","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i){var j=e.ItemView.extend({template:{type:"handlebars",template:g},onShow:function(){var a=this;this._iframe=b("iframe",this.$el),this._iframe.load(function(){a._applyContainmentStyle(this)})},_applyContainmentStyle:function(a){b(a).ready(function(){b(a).contents().find("body").addClass("in-iframe")})}});return j}),define("hbs!modules/template/account/account-recharge-yippster",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="row recharge-header">\n	<div class="title">\n		'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|yippster_recharge_title",g):i.call(b,"translate","account|yippster_recharge_title",g)))+'\n	</div>\n	<hr>\n\n	<div class="font-size-14">\n		'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|yippster_recharge_desc",g):i.call(b,"translate","account|yippster_recharge_desc",g)))+'\n	</div>\n	\n	<div class="instructions clearfix">\n		<div class="step col-sm-4">\n			<div class="title">\n				<span class="number">1</span>\n				<div class="t_description">\n					'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|yippster_recharge_step_1",g):i.call(b,"translate","account|yippster_recharge_step_1",g)))+'\n				</div>\n			</div>\n		</div>\n		<div class="step col-sm-4">\n			<div class="title">\n				<span class="number">2</span>\n				<div class="t_description">\n					'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|yippster_recharge_step_2",g):i.call(b,"translate","account|yippster_recharge_step_2",g)))+'\n				</div>\n			</div>\n		</div>\n		<div class="step col-sm-4">\n			<div class="title">\n				<span class="number">3</span>\n				<div class="t_description">\n					'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|yippster_recharge_step_3",g):i.call(b,"translate","account|yippster_recharge_step_3",g)))+'\n				</div>\n			</div>\n		</div>\n	</div>\n</div>\n\n<div class="row recharge-content-list">\n	<iframe id="recharge-iframe" class="recharge-iframe" style="width: 100%; height:240px; padding: 0px; margin: 0px; border: 0px;" src="/sites/ajax/payment/yippster_payment_request" onload="window.AdjustIframeHeightOnLoad(\'recharge-iframe\')"></iframe>\n</div>'})}),define("modules/view/account/account_recharge_yippster_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/account/account-recharge-yippster","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i){var j=e.ItemView.extend({template:{type:"handlebars",template:g},onShow:function(){var a=this;this._iframe=b("iframe",this.$el),this._iframe.load(function(){a._applyContainmentStyle(this)})},_applyContainmentStyle:function(a){b(a).ready(function(){b(a).contents().find("body").addClass("in-iframe")})}});return j}),define("hbs!modules/template/account/account-recharge-paytm",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='<div class="row recharge-header">\n		<div class="title">\n			'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|paytm_recharge_title",g):i.call(b,"translate","account|paytm_recharge_title",g)))+'\n		</div>\n		<hr>\n\n		<div class="font-size-14">\n			'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|paytm_recharge_desc",g):i.call(b,"translate","account|paytm_recharge_desc",g)))+'\n		</div>\n		\n		<div class="instructions clearfix">\n			<div class="step col-sm-4">\n				<div class="title">\n					<span class="number">1</span>\n					<div class="t_description">\n						'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|paytm_recharge_step_1",g):i.call(b,"translate","account|paytm_recharge_step_1",g)))+'\n					</div>\n				</div>\n			</div>\n			<div class="step col-sm-4">\n				<div class="title">\n					<span class="number">2</span>\n					<div class="t_description">\n						'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|paytm_recharge_step_2",g):i.call(b,"translate","account|paytm_recharge_step_2",g)))+'\n					</div>\n				</div>\n			</div>\n			<div class="step col-sm-4">\n				<div class="title">\n					<span class="number">3</span>\n					<div class="t_description">\n						'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"account|paytm_recharge_step_3",g):i.call(b,"translate","account|paytm_recharge_step_3",g)))+'\n					</div>\n				</div>\n			</div>\n		</div>\n</div>\n\n<div class="row recharge-content-list">\n	<iframe id="recharge-iframe" class="recharge-iframe" style="width: 100%; height:240px; padding: 0px; margin: 0px; border: 0px;" src="/sites/ajax/payment/paytm_payment_request" onload="window.AdjustIframeHeightOnLoad(\'recharge-iframe\')"></iframe>\n</div>'})}),define("modules/view/account/account_recharge_paytm_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/account/account-recharge-paytm","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h,i){var j=e.ItemView.extend({template:{type:"handlebars",template:g},onShow:function(){var a=this;this._iframe=b("iframe",this.$el),this._iframe.load(function(){a._applyContainmentStyle(this)})},_applyContainmentStyle:function(a){b(a).ready(function(){b(a).contents().find("body").addClass("in-iframe")})}});return j}),define("modules/controller/account_controller",["underscore","backbone","backbone.marionette","modules/mig33_app","modules/common/config","modules/common/utility","modules/globals/session_user","modules/chat/models/user_session","modules/view/account/migcoins_convert_footer_view","modules/model/account/account_user_payment_collection","modules/model/account/account_balance_collection","modules/model/account/account_merchant_collection","modules/model/account/account_merchant_countries_model","modules/model/account/account_merchant_countries_collection","modules/model/account/account_merchant_country_collection","modules/model/account/account_merchant_country_search_collection","modules/view/account/account_layout","modules/view/account/account_recharge_transfer","modules/view/account/account_recharge_layout","modules/view/account/account_about_view","modules/view/account/account_user_payment_collection_view","modules/view/account/account_recharge_item_view","modules/view/account/account_recharge_merchant_collection_view","modules/view/account/account_recharge_merchant_countries_collection_view","modules/view/account/account_recharge_paypal_view","modules/view/account/account_recharge_creditcard_view","modules/view/account/account_recharge_skrill_view","modules/view/account/account_recharge_mol_view","modules/view/account/account_recharge_westernunion_view","modules/view/account/account_recharge_teletrans_view","modules/view/account/account_recharge_banktrans_view","modules/view/account/account_recharge_voucher_view","modules/view/account/account_recharge_balance_collection_view","modules/view/account/account_recharge_doku_alfamart_view","modules/view/account/account_recharge_doku_atm_view","modules/view/account/account_recharge_doku_epay_view","modules/view/account/account_recharge_doku_mandiri_view","modules/view/account/account_recharge_doku_wallet_view","modules/view/account/account_recharge_dompetku_view","modules/view/account/account_recharge_mimopay_view","modules/view/account/account_recharge_esewa_view","modules/view/account/account_recharge_yippster_view","modules/view/account/account_recharge_paytm_view"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q){var R=null,S=null,T=null,U=null,V="",W=null,X=h.Session.getInstance(),Y=c.Controller.extend({_createAndInitStoreLayout:function(){R=new q,R.on("close",function(){U=null}),null!==T&&R.updateAccountBalance(T)},_show:function(){f.highlight_top_menu("credit"),null!==U&&U?U.close():(this._createAndInitStoreLayout(),d.content.show(R),void 0!==X.get("account_balance")&&null!==X.get("account_balance")&&R.updateAccountBalance(f.add_thousands_seperator(X.get("account_balance"))+" "+X.get("currency_code"))),null!==T&&T.indexOf(e.store.migcoins_currency_code)<0&&this._add_migcoins_footer()},initialize:function(){var a=this;d.vent.on(d.ApplicationEvents.ACCOUNT_BALANCE,function(b){null!==R&&R.updateAccountBalance(b),null!==R&&R.updateAccountBalance(b),null!==S&&S.updateAccountBalance(b),T=b,b.indexOf(e.store.migcoins_currency_code)>0?a._close_migcoins_footer():null===W&&a._add_migcoins_footer()}),this.on("controller:closed",function(b){null!==W&&a._close_migcoins_footer()})},index:function(){this._show(),R.updateBack(f.translate("account|credit"),f.translate("store|store"),"/store");var a=new v;R.container.show(a),null!==T&&a.updateAccountBalance(T),d.vent.on(d.ApplicationEvents.ACCOUNT_BALANCE,function(b){null!==a&&a.updateAccountBalance(b)}),U=a},about:function(){this._show(),R.updateBack(f.translate("account|about_credit"),f.translate("account|credit"),"/credit");var a=new t;R.container.show(a),a.updateAccountBalance(T),d.vent.on(d.ApplicationEvents.ACCOUNT_BALANCE,function(b){null!==a&&a.updateAccountBalance(b)}),U=a},pending:function(){this._show(),R.updateBack(f.translate("account|pendingpayment"),f.translate("account|credit"),"/credit");var a=new j,b=new u({collection:a});a.fetch(),R.container.show(b),a.on("account:pending:more",function(){a.nextPage(),a.fetch({remove:!1})})},recharge:function(){this._show(),R.updateBack(f.translate("account|recharge_credits"),f.translate("account|credit"),"/credit");var a=new s;R.container.show(a),U=a},recharge_transfer:function(){this._show(),R.updateBack(f.translate("user|transfer_credit"),f.translate("account|credit"),"/credit");var a=new r;R.container.show(a),a.getCurrency(g.username),U=a},recharge_balance:function(){V="balance",this._show(),R.updateBack(f.translate("account|credit_balance_title"),f.translate("account|credit"),"/credit");var a=new k;S=new G({collection:a}),a.fetch(),R.container.show(S),null!==T&&S.updateAccountBalance(T),a.on("fetch:done",function(a){S.render(),a[0].hasMore?S.showMore():S.hideMore(),a.shift(),null!==T&&S.updateAccountBalance(T)}),U=S,S.setCurrentTab("all")},recharge_merchant:function(){V="merchant",this._show(),R.updateBack(f.translate("account|recharge_through_merchant"),f.translate("account|recharge_credits"),"/credit/recharge");var a=new l,b=new w({collection:a});a.fetch(),b.setCurrentTab("merchant"),R.container.show(b),a.on("fetch:done",function(a){0===a.length&&b.hideMore(),b.changeTitle("")}),b.on("account:recharge:merchant:more",function(){a.nextPage(),a.fetch({remove:!1})}),U=b},recharge_merchant_location:function(b){V="merchant",this._show(),R.updateBack(f.translate("account|through_a_merchant"),f.translate("account|recharge_credits"),"/credit/recharge");var c=new m;if(!a.isUndefined(b)&&$.isNumeric(b)){var d=new o,e=new w({collection:d});c.setCountryId(b),c.fetch(),d.setCountryId(b),d.fetch(),e.setCurrentTab("bylocation"),R.container.show(e),c.on("fetch:done",function(a){e.changeTitle(a.name)}),d.on("fetch:done",function(a){0===a.length&&e.hideMore()}),e.on("account:recharge:merchant:more",function(){d.nextPage(),d.fetch({remove:!1})}),U=e}else{var g=new n,h=new x({collection:g});g.fetch(),R.container.show(h),h.setCurrentTab("bylocation"),U=h}},recharge_merchant_search_location:function(b){if(V="merchant",this._show(),R.updateBack(f.translate("account|through_a_merchant"),f.translate("account|recharge_credits"),"/credit/recharge"),!a.isUndefined(b)){var c=new p,d=new w({collection:c});c.setName(b),c.fetch(),d.setCurrentTab("bylocation"),R.container.show(d),c.on("fetch:done",function(a){0===a.length&&d.hideMore(),d.changeTitle(b.charAt(0).toUpperCase()+b.slice(1))}),d.on("account:recharge:merchant:more",function(){c.nextPage(),c.fetch({remove:!1})}),U=d}},_showPendingPaymentCounter:function(){var a=new j;a.fetch(),a.on("fetch:done",function(){R.updatePendingPaymentCounter(a.length)})},recharge_creditcard:function(){V="creditcard",this._show(),R.updateBack(f.translate("account|creditcard_recharge_title"),f.translate("account|recharge_credits"),"/credit/recharge");var a=new z;R.container.show(a),U=a},recharge_paypal:function(){V="paypal",this._show(),R.updateBack(f.translate("account|paypal_recharge_title"),f.translate("account|recharge_credits"),"/credit/recharge");var a=new y;R.container.show(a),U=a},recharge_skrill:function(){V="skrill",this._show(),R.updateBack(f.translate("account|skrill_recharge_title"),f.translate("account|recharge_credits"),"/credit/recharge");var a=new A;R.container.show(a),U=a;
},recharge_mol:function(){V="mol",this._show(),R.updateBack(f.translate("account|mol_recharge_title"),f.translate("account|recharge_credits"),"/credit/recharge");var a=new B;R.container.show(a),U=a},recharge_bank_transfer:function(){V="bank-trans",this._show(),R.updateBack(f.translate("account|recharge_by_bank_transfer"),f.translate("account|recharge_credits"),"/credit/recharge");var a=new E;R.container.show(a),U=a},recharge_western_union:function(){V="western-union",this._show(),R.updateBack(f.translate("account|recharge_by_west_union"),f.translate("account|recharge_credits"),"/credit/recharge");var a=new C;R.container.show(a),U=a},recharge_telegraph_transfer:function(){V="tele-trans",this._show(),R.updateBack(f.translate("account|telegraph_recharge_title"),f.translate("account|recharge_credits"),"/credit/recharge");var a=new D;R.container.show(a),U=a},recharge_voucher:function(){V="voucher",this._show(),R.updateBack(f.translate("account|redeem_voucher"),f.translate("account|recharge_credits"),"/credit/recharge");var a=new F;R.container.show(a),U=a},recharge_doku_alfamart:function(){V="doku-alfamart",this._show(),R.updateBack(f.translate("account|doku_alfamart_title"),f.translate("account|recharge_credits"),"/credit/recharge");var a=new H;R.container.show(a),U=a},recharge_doku_atm:function(){V="doku-atm",this._show(),R.updateBack(f.translate("account|doku_atm_title"),f.translate("account|recharge_credits"),"/credit/recharge");var a=new I;R.container.show(a),U=a},recharge_doku_epay:function(){V="doku-epay",this._show(),R.updateBack(f.translate("account|doku_epay_title"),f.translate("account|recharge_credits"),"/credit/recharge");var a=new J;R.container.show(a),U=a},recharge_doku_mandiri:function(){V="doku-mandiri",this._show(),R.updateBack(f.translate("account|doku_mandiri_title"),f.translate("account|recharge_credits"),"/credit/recharge");var a=new K;R.container.show(a),U=a},recharge_doku_wallet:function(){V="doku-wallet",this._show(),R.updateBack(f.translate("account|doku_wallet_title"),f.translate("account|recharge_credits"),"/credit/recharge");var a=new L;R.container.show(a),U=a},recharge_dompetku:function(){V="dompetku",this._show(),R.updateBack(f.translate("account|dompetku_recharge_title"),f.translate("account|recharge_credits"),"/credit/recharge");var a=new M;R.container.show(a),U=a},recharge_mimopay:function(){V="mimopay",this._show(),R.updateBack(f.translate("account|mimopay_recharge_title"),f.translate("account|recharge_credits"),"/credit/recharge");var a=new N;R.container.show(a),U=a},recharge_esewa:function(){V="esewa",this._show(),R.updateBack(f.translate("account|esewa_recharge_title"),f.translate("account|recharge_credits"),"/credit/recharge");var a=new O;R.container.show(a),U=a},recharge_yippster:function(){V="yippster",this._show(),R.updateBack(f.translate("account|yippster_recharge_title"),f.translate("account|recharge_credits"),"/credit/recharge");var a=new P;R.container.show(a),U=a},recharge_paytm:function(){V="paytm",this._show(),R.updateBack(f.translate("account|paytm_recharge_title"),f.translate("account|recharge_credits"),"/credit/recharge");var a=new Q;R.container.show(a),U=a},_add_migcoins_footer:function(){if(e.store.show_migcoins===!1)return!1;if(0!==b.history.fragment.indexOf("credit"))return!1;var a=$("#main-container");null===W&&(W=new i),(W.isClosed||"undefined"==typeof W.isClosed)&&(a.after(W.render().el),$("#main-container").attr("style","padding-bottom:"+W.$el.outerHeight()+"px"),W.delegateEvents(),f.inline_svg())},_close_migcoins_footer:function(){null!==W&&($("#main-container").attr("style",""),W.close())}});return Y}),define("hbs!modules/template/chatroom_info/chatroom-info-layout",["handlebars"],function(a){return a.template(function(a,b,c,d,e){this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var f,g,h="",i=c.helperMissing,j=this.escapeExpression;return h+='\n<div class="row">\n    <!--<div class="profile-header chatroom-cover-photo" style="background-image: url(\''+j((f=c.getUrl||b&&b.getUrl,g={hash:{},data:e},f?f.call(b,"jsclient",g):i.call(b,"getUrl","jsclient",g)))+'/app/images/mig.me/chatroom_cover_photo_01.jpg\');"></div>-->\n    <div class="profile-header chatroom-cover-photo" style="background-image: url(\'http://b-img.cdn.mig.me/i/b794/9651a44a9785ed6222e6919e8ca29ac21bc8/1433760531549\');"></div>\n</div>\n<div class="row chatroom-info-container">\n    <div class="chatroom-profile">\n        <div class="chatroom-name"></div>\n        <div class="user-profile-share">\n            <a href="#" class="show-prof-share" title="'+j((f=c.translate||b&&b.translate,g={hash:{},data:e},f?f.call(b,"common|share",g):i.call(b,"translate","common|share",g)))+'">\n                <span class="icon-wb_mb_share"></span>\n            </a>\n        </div>\n    </div>\n    <div class="chatroom-launcher">\n        <button class="btn btn-xs btn-default join-chatroom" type="button">\n            <span class="icon-wb_chat"></span>&nbsp;Start Chatting\n        </button>\n    </div>\n    <div class="chatroom-details">\n        <div class="chatroom-details-cell">\n            <div class="chatroom-details-row">\n                <div class="chatroom-details-title">Date Created</div>\n                <div class="chatroom-details-value" id="chatroom-date-created"></div>\n            </div>\n            <div class="chatroom-details-row">\n                <div class="chatroom-details-title">Keywords</div>\n                <div class="chatroom-details-value" id="chatroom-keywords"></div>\n            </div>\n            <div class="chatroom-details-row">\n                <div class="chatroom-details-title">Language</div>\n                <div class="chatroom-details-value" id="chatroom-language"></div>\n            </div>\n        </div>\n        <div class="chatroom-details-cell">\n            <div class="chatroom-details-row">\n                <div class="chatroom-details-title">Description</div>\n                <div class="chatroom-details-value" id="chatroom-description"></div>\n            </div>\n        </div>\n    </div>\n    <div id="chatroom-settings" class="chatroom-details" style="display: none">\n        <div class="chatroom-details-cell">\n            <div class="chatroom-details-row">\n                <div class="chatroom-moderators-header">Settings</div>\n            </div>\n            <div class="chatroom-details-row">\n                <a id="control-multis-link" href="#">Settings to control multi-IDs</a>\n            </div>\n            <div class="chatroom-details-row">\n                <a id="manage-banned-users-link" href="#">Manage banned users</a>\n            </div>\n            <div class="chatroom-details-row">\n                <a id="modify-kicking-rules-link" href="#">Modify kicking rules</a>\n            </div>\n            <div id="change-language" class="chatroom-details-row" style="display: none">\n                <a id="change-language-link" href="#">Change language and description</a>\n            </div>\n            <div id="manage-moderators" class="chatroom-details-row" style="display: none">\n                <a id="manage-moderators-link" href="#">Manage moderators</a>\n            </div>\n        </div>\n    </div>\n    <div class="chatroom-details">\n        <div class="chatroom-moderators-header">Owner</div>\n        <div class="user-profile-details" id="chatroom-owner"></div>\n    </div>\n    <div class="chatroom-details">\n        <div class="chatroom-moderators-header">Moderators</div>\n        <div class="user-profile-details"  id="chatroom-moderators"></div>\n    </div>\n</div> '})}),define("modules/view/chatroom_info/chatroom_info_layout",["jquery","underscore","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/chatroom_info/chatroom-info-layout","modules/common/utility","modules/common/session_user"],function(a,b,c,d,e,f,g,h,i){var j=e.Layout.extend({template:{type:"handlebars",template:g},events:{"click .show-prof-share":"showProfShare","click .join-chatroom":"joinChatroom"},regions:{moderatorsContent:"#chatroom-moderators",ownerContent:"#chatroom-owner"},initialize:function(a){this.chatroom_name=a.chatroom_name},updateChatroomData:function(b){a(".chatroom-name",this.$el).text(b.name);var c=new Date(1e3*b.dateCreated);a("#chatroom-date-created",this.$el).text(c.toDateString()),a("#chatroom-keywords",this.$el).text(b.keywords),a("#chatroom-language",this.$el).text(b.language),a("#chatroom-description",this.$el).text(b.description);var d=i.getInstance().get("username");if(d===b.creator[0].username)this._updateSettingsLinks(b.name),a("#chatroom-settings").show(),a("#change-language").show(),a("#manage-moderators").show();else for(var e=0;e<b.moderators.length;e++)if(console.log(b.moderators[e]),d===b.moderators[e].username){this._updateSettingsLinks(b.name),a("#chatroom-settings").show();break}},showProfShare:function(a){null!==a&&a.preventDefault(),h.show_share_dialog("chatroom",this.chatroom_name)},joinChatroom:function(){h.is_logged_in()?window.mig33.chatroom_manager&&window.mig33.chatroom_manager.join_chatroom(this.chatroom_name):h.show_login_dialog()},_updateSettingsLinks:function(b){a("#control-multis-link").attr("href","/sites/ajax/chatroom/setup_multiids?roomName="+b),a("#manage-banned-users-link").attr("href","/sites/ajax/chatroom/setup_banned_users?roomName="+b),a("#modify-kicking-rules-link").attr("href","/sites/ajax/chatroom/setup_kicking?roomName="+b),a("#change-language-link").attr("href","/sites/ajax/chatroom/setup_details?roomName="+b),a("#manage-moderators-link").attr("href","/sites/ajax/chatroom/setup_moderators?roomName="+b)}});return j}),define("modules/model/chatroom_info/chatroom_info",["modules/model/common/mig33_model","modules/common/config","modules/common/session_user","modules/common/utility","underscore"],function(a,b,c,d,e){var f=a.extend({chatroom:"",url:function(){return d.format(b.urls.chatroom_info_url,this.chatroom)+"?requestingUserId="+c.getInstance().get("id")},parse:function(a){return null!==a.data?a.data:[]},setRoomName:function(a){this.chatroom=a}});return f}),define("hbs!modules/template/chatroom_info/chatroom-info-user",["handlebars"],function(a){return a.template(function(a,b,c,d,e){function f(a,b){var d,e,f="";return f+='\n					<span class="gender">',(e=c.gender)?d=e.call(a,{hash:{},data:b}):(e=a&&a.gender,d=typeof e===n?e.call(a,{hash:{},data:b}):e),f+=o(d)+",</span>\n				"}function g(a,b){var d,e="";return e+="\n				",d=c["if"].call(a,(d=a&&a.userRelationship,null==d||d===!1?d:d.isSelf),{hash:{},inverse:q.program(6,i,b),fn:q.program(4,h,b),data:b}),(d||0===d)&&(e+=d),e+="\n			"}function h(a,b){return"\n				"}function i(a,b){var d,e,f,g="";return g+='\n					<button class="btn btn-xs btn-friends chat hidden" type="button">\n						<span class="icon-wb_friend"></span>&nbsp;'+o((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|friends",f):p.call(a,"translate","user|friends",f)))+'\n					</button>\n					<a href="#"\n					   class="btn btn-xs btn-following following hidden"\n					   data-toggle="clickover"\n					   data-placement="top"\n					   data-html="true"\n					   data-title="'+o((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|be_friends_to_chat",f):p.call(a,"translate","user|be_friends_to_chat",f)))+'"\n					   data-content="'+o((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|sweeten_the_invite",f):p.call(a,"translate","user|sweeten_the_invite",f)))+"<div class='padding-4px'></div><a href='/store/category/1/new/?username=",(e=c.username)?d=e.call(a,{hash:{},data:b}):(e=a&&a.username,d=typeof e===n?e.call(a,{hash:{},data:b}):e),g+=o(d)+"' class='btn btn-xs btn-default'>"+o((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|send_gift",f):p.call(a,"translate","user|send_gift",f)))+'</a>"\n					>\n						<span class="icon-wb_fanof"></span>&nbsp;'+o((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|i_m_a_fan",f):p.call(a,"translate","user|i_m_a_fan",f)))+'\n					</a>\n					<button class="btn btn-xs btn-following follow-pending hidden" type="button">\n						<span class="icon-wb_recent"></span>&nbsp;'+o((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|pending",f):p.call(a,"translate","user|pending",f)))+'\n					</button>\n					<button class="btn btn-xs btn-default follow hidden" type="button">\n						<span class="icon-wb_add"></span>&nbsp;'+o((e=c.translate||a&&a.translate,f={hash:{},data:b},e?e.call(a,"user|add",f):p.call(a,"translate","user|add",f)))+"\n					</button>\n				"}this.compilerInfo=[4,">= 1.0.0"],c=this.merge(c,a.helpers),e=e||{};var j,k,l,m="",n="function",o=this.escapeExpression,p=c.helperMissing,q=this,r=c.blockHelperMissing;return m+='<div class="user-details">\n	<div class="user-details-container">\n		<div class="user-details-inner-container">\n			<a href="'+o((k=c.getProfileUrl||b&&b.getProfileUrl,l={hash:{},data:e},k?k.call(b,b&&b.username,l):p.call(b,"getProfileUrl",b&&b.username,l)))+'" class="profile-hovercard" data-username="',(k=c.username)?j=k.call(b,{hash:{},data:e}):(k=b&&b.username,j=typeof k===n?k.call(b,{hash:{},data:e}):k),m+=o(j)+'">\n				<img src="'+o((k=c.getUrl||b&&b.getUrl,l={hash:{},data:e},k?k.call(b,"image",l):p.call(b,"getUrl","image",l)))+"/dp/",(k=c.username)?j=k.call(b,{hash:{},data:e}):(k=b&&b.username,j=typeof k===n?k.call(b,{hash:{},data:e}):k),m+=o(j)+'?w=90&h=90&a=1&c=1" width="90" height="90" class="img-circle" />\n			</a>\n			<div>\n				<span class="username">',(k=c.username)?j=k.call(b,{hash:{},data:e}):(k=b&&b.username,j=typeof k===n?k.call(b,{hash:{},data:e}):k),m+=o(j)+'</span>\n				<span class="user-label">'+o((k=c.userGetLabels||b&&b.userGetLabels,l={hash:{},data:e},k?k.call(b,b,l):p.call(b,"userGetLabels",b,l)))+'</span>\n				<span class="fullname">',(k=c.firstName)?j=k.call(b,{hash:{},data:e}):(k=b&&b.firstName,j=typeof k===n?k.call(b,{hash:{},data:e}):k),m+=o(j)+" ",(k=c.lastName)?j=k.call(b,{hash:{},data:e}):(k=b&&b.lastName,j=typeof k===n?k.call(b,{hash:{},data:e}):k),m+=o(j)+'</span>\n			</div>\n			<div>\n				<span class="level">Level ',(k=c.migLevel)?j=k.call(b,{hash:{},data:e}):(k=b&&b.migLevel,j=typeof k===n?k.call(b,{hash:{},data:e}):k),m+=o(j)+", </span>\n				",j=c["if"].call(b,b&&b.gender,{hash:{},inverse:q.noop,fn:q.program(1,f,e),data:e}),(j||0===j)&&(m+=j),m+='\n				<span class="location">',(k=c.country)?j=k.call(b,{hash:{},data:e}):(k=b&&b.country,j=typeof k===n?k.call(b,{hash:{},data:e}):k),m+=o(j)+'</span>\n			</div>\n		</div>\n		<div class="user-actions">\n			',l={hash:{},inverse:q.noop,fn:q.program(3,g,e),data:e},(k=c.ifLoggedIn)?j=k.call(b,l):(k=b&&b.ifLoggedIn,j=typeof k===n?k.call(b,l):k),c.ifLoggedIn||(j=r.call(b,j,{hash:{},inverse:q.noop,fn:q.program(3,g,e),data:e})),(j||0===j)&&(m+=j),m+="\n		</div>\n	</div>\n</div>"})}),define("modules/view/chatroom_info/chatroom_info_user_item_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","hbs!modules/template/chatroom_info/chatroom-info-user","modules/view/user/user_view","modules/common/config","modules/common/utility","modules/template/helpers/general_helpers","modules/template/helpers/user_helpers"],function(a,b,c,d,e,f,g,h,i,j){var k=h.extend({template:{type:"handlebars",template:g},initialize:function(){a.bindAll(this)},onRender:function(){var a=j.get_userlabel_color(this.model.get("labels"));b(".username",this.$el).addClass(a)}});return k}),define("modules/view/chatroom_info/chatroom_info_user_collection_view",["underscore","jquery","backbone","handlebars","backbone.marionette","marionette_handlebars","modules/view/chatroom_info/chatroom_info_user_item_view","modules/view/common/mig33_views","modules/template/helpers/general_helpers"],function(a,b,c,d,e,f,g,h){var i=h.CollectionView.extend({itemView:g,initialize:function(){a.bindAll(this)}});return i}),define("modules/model/chatroom_info/chatroom_info_user_collection",["modules/model/common/mig33_collection","modules/model/user/user_model","underscore"],function(a,b,c){var d=a.extend({model:b,initialize:function(a,b){this.options=b},parse:function(a){return null!==a.data&&a.data.username?a.data.username:[]}});return d}),define("modules/controller/chatroom_info_controller",["underscore","backbone","backbone.marionette","modules/mig33_app","modules/common/utility","modules/common/config","modules/view/chatroom_info/chatroom_info_layout","modules/model/chatroom_info/chatroom_info","modules/view/chatroom_info/chatroom_info_user_collection_view","modules/model/chatroom_info/chatroom_info_user_collection"],function(a,b,c,d,e,f,g,h,i,j){var k=c.Controller.extend({index:function(){var a=document.location.pathname.substring(1).split(/\//)[1];a=decodeURIComponent(a);var b=new g({chatroom_name:a}),c=new h;c.setRoomName(a),c.fetch(),c.on("fetch:done",function(a){$.isArray(a.creator)||(a.creator=[a.creator]);var c=new j(a.creator),d=new j(a.moderators),e=new i({collection:c}),f=new i({collection:d});b.updateChatroomData(a),b.ownerContent.show(e),b.moderatorsContent.show(f)}),d.content.show(b)}});return k}),define("modules/app_controller",["jquery","underscore","backbone","backbone.marionette","modules/common/utility","modules/controller/homefeed_controller","modules/controller/single_post_controller","modules/controller/profile_controller","modules/controller/migalert_controller","modules/controller/discover_controller","modules/controller/gamecenter_controller","modules/controller/music_controller","modules/controller/search_controller","modules/controller/migcore_containment_controller","modules/controller/migbo_containment_controller","modules/controller/group_controller","modules/controller/store_controller","modules/controller/account_controller","modules/controller/chatroom_info_controller","modules/globals/url"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){var u=null,v=d.Controller.extend({initialize:function(){b.bindAll(this),this.homeFeedController=new f,this.singlePostController=new g,this.profileController=new h,this.migalertController=new i,this.discoverController=new j,this.gameCenter=new k,this.musicController=new l,this.searchController=new m,this.migcoreContainmentController=new n,this.migboContainmentController=new o,this.groupController=new p,this.storeController=new q,this.accountController=new r,this.chatroomInfoController=new s},index:function(){this._triggerCloseController(this.homeFeedController),e.show_document_title("migme"),this.homeFeedController.index()},mentions:function(){this._triggerCloseController(this.profileController),e.show_document_title("Mentions - migme"),this.profileController.mentions()},watchlist:function(){this._triggerCloseController(this.homeFeedController),e.show_document_title("Subscriptions - migme"),this.homeFeedController.watchlist()},achievements:function(a,b){this._triggerCloseController(this.profileController),e.show_document_title(a+" Achievements on migme"),this.profileController.achievements(a,b)},single_post:function(a,b){this._triggerCloseController(this.singlePostController),this.singlePostController.index(a,b)},profile:function(a){this._triggerCloseController(this.profileController),e.show_document_title(a+" on migme"),this.profileController.index(a)},about:function(a){this._triggerCloseController(this.profileController),e.show_document_title("About - migme"),this.profileController.about(a),this.setBackButton()},followers:function(a){this._triggerCloseController(this.profileController),e.show_document_title(a+"'s Fans - migme"),this.profileController.followers(a),this.setBackButton()},following:function(a){this._triggerCloseController(this.profileController),e.show_document_title(a+"'s Fans of - migme"),this.profileController.following(a),this.setBackButton()},friends:function(a){this._triggerCloseController(this.profileController),e.show_document_title(a+"'s Friends - migme"),this.profileController.friends(a),this.setBackButton()},badges:function(a,b){this._triggerCloseController(this.profileController),e.show_document_title(a+"'s Badges - migme"),this.profileController.badges(a,b),this.setBackButton()},badges_archives:function(a,b){this._triggerCloseController(this.profileController),e.show_document_title(a+"'s Expired Badges - migme"),this.profileController.badges(a,b,!0),this.setBackButton()},recent_gifts:function(a){this._triggerCloseController(this.profileController),e.show_document_title(a+"'s Recent Gifts - migme"),this.profileController.recent_gifts(a),this.setBackButton()},gifts:function(a){this._triggerCloseController(this.profileController),e.show_document_title(a+"'s Gifts - migme"),this.profileController.gifts(a),this.setBackButton()},favorite_gifts:function(a){this._triggerCloseController(this.profileController),e.show_document_title(a+"'s Favorite Gifts - migme"),this.profileController.favorite_gifts(a),this.setBackButton()},groups:function(a){this._triggerCloseController(this.profileController),e.show_document_title(a+"'s Groups - migme"),this.profileController.groups(a),this.setBackButton()},games:function(a){this._triggerCloseController(this.profileController),e.show_document_title(a+"'s Games - migme"),this.profileController.games(a),this.setBackButton()},music:function(a){this._triggerCloseController(this.profileController),e.show_document_title(a+"'s Music - migme"),this.profileController.music(a),this.setBackButton()},chatrooms:function(a){e.show_document_title(a+"'s Chat Rooms - migme"),this.profileController.chatrooms(a),this.setBackButton()},coverphoto:function(a){this._triggerCloseController(this.profileController),e.show_document_title("Cover Photo - migme"),this.profileController.coverphoto(a),this.setBackButton()},migalert:function(a){this._triggerCloseController(this.migalertController),e.show_document_title("Notification - migme"),this.migalertController.index()},setBackButton:function(){var b="/u/"+e.get_username();a(".backButton").attr("href",b)},discover:function(){this._triggerCloseController(this.discoverController),e.show_document_title("Discover Recommended People - migme"),this.discoverController.index()},discover_abc:function(){this._triggerCloseController(this.discoverController),e.show_document_title("Discover People You Know - migme"),this.discoverController.address_book()},discover_rec_user_country:function(){this._triggerCloseController(this.discoverController),e.show_document_title("Discover Famous People in your Country - migme"),this.discoverController.recommended_users_by_country()},discover_migworld:function(){this._triggerCloseController(this.discoverController),e.show_document_title("Discover - migme");var a=e.get_query_params_by_name("path");this.discoverController.migworld(a)},gamecenter:function(){this._triggerCloseController(this.gameCenter),e.show_document_title("Games - migme");var a=e.get_query_params_by_name("id");this.gameCenter.index(a)},musiccenter:function(){this._triggerCloseController(this.musicController),e.show_document_title("Music - migme");var a=e.get_query_params_by_name("provider"),b=e.get_query_params_by_name("type"),c=e.get_query_params_by_name("id"),d=document.location.pathname.substring(1).split(/\//);4==d.length&&(a=d[1],b=d[2],c=d[3]),this.musicController.index(a,b,c)},search:function(){this._triggerCloseController(this.searchController);e.get_query_params_by_name("query");e.show_document_title("Search - migme"),this.searchController.index()},search_users:function(){this._triggerCloseController(this.searchController);var a=e.get_query_params_by_name("query");e.show_document_title("Search Users - migme"),this.searchController.users(a)},search_users_random:function(){this._triggerCloseController(this.searchController),e.show_document_title("Meet at Random - migme"),this.searchController.meetAtRandom()},search_posts:function(){this._triggerCloseController(this.searchController);var a=e.get_query_params_by_name("query");"#"===a.charAt(0)?(e.show_document_title("Search Topics - migme"),this.searchController.topics(a.substr(1))):(e.show_document_title("Search Posts - migme"),this.searchController.posts(a))},search_topics:function(){this._triggerCloseController(this.searchController);var a=e.get_query_params_by_name("query");e.show_document_title("Search Topics - migme"),this.searchController.topics(a)},search_chatrooms:function(){this._triggerCloseController(this.searchController);var a=e.get_query_params_by_name("query");e.show_document_title("Search Chatrooms - migme"),this.searchController.chatrooms(a)},group_index:function(){this._triggerCloseController(this.groupController),e.show_document_title("Groups - migme"),this.groupController.index()},group_single_post:function(a,b,c){this._triggerCloseController(this.singlePostController),this.singlePostController.index(b,c)},group_create:function(){this._triggerCloseController(this.groupController),e.show_document_title("Create - Group - migme"),this.groupController.create()},group_page:function(a,b){this._triggerCloseController(this.groupController),"members"==b?(e.show_document_title("Members - Group - migme"),this.groupController.members(a)):"settings"==b?(e.show_document_title("Settings - Group - migme"),this.groupController.settings(a)):(e.show_document_title("Group - migme"),this.groupController.details(a))},store:function(){this._triggerCloseController(this.storeController),e.show_document_title("Store - migme"),this.storeController.index()},store_category:function(a,b,c,d){this._triggerCloseController(this.storeController),e.show_document_title("Category - Store - migme"),this.storeController.category(a,b,c,d)},store_item:function(a){this._triggerCloseController(this.storeController),e.show_document_title("Item - Store - migme"),this.storeController.item(a)},store_search:function(a){this._triggerCloseController(this.storeController);var b=e.get_query_params_by_name("query"),c=e.get_query_params_by_name("minPrice"),d=e.get_query_params_by_name("maxPrice"),f=e.get_query_params_by_name("sortBy"),g=e.get_query_params_by_name("sortOrder");e.show_document_title("Search - Store - migme"),this.storeController.search(a,b,c,d,f,g)},store_item_received:function(a,b,c){this._triggerCloseController(this.storeController),e.show_document_title(a+"'s Items Received - Store - migme"),this.storeController.item_received(a,b,c)},store_item_inventory:function(a,b,c){this._triggerCloseController(this.storeController),e.show_document_title(a+"'s Items Unlocked - Store - migme"),this.storeController.item_inventory(a,b,c)},account:function(){this._triggerCloseController(this.accountController),this.accountController.index()},account_about:function(){this._triggerCloseController(this.accountController),this.accountController.about()},account_pending:function(){this._triggerCloseController(this.accountController),this.accountController.pending()},account_recharge:function(){this._triggerCloseController(this.accountController),this.accountController.recharge()},account_recharge_merchant:function(){this._triggerCloseController(this.accountController),this.accountController.recharge_merchant()},account_recharge_merchant_location:function(a){this._triggerCloseController(this.accountController),this.accountController.recharge_merchant_location(a)},account_recharge_merchant_search_location:function(){this._triggerCloseController(this.accountController);var a=e.get_query_params_by_name("name");this.accountController.recharge_merchant_search_location(a)},account_recharge_paypal:function(){this._triggerCloseController(this.accountController),this.accountController.recharge_paypal()},account_recharge_creditcard:function(){this._triggerCloseController(this.accountController),this.accountController.recharge_creditcard()},account_recharge_skrill:function(){this._triggerCloseController(this.accountController),this.accountController.recharge_skrill()},account_recharge_mol:function(){this._triggerCloseController(this.accountController),this.accountController.recharge_mol()},account_recharge_westernunion:function(){this._triggerCloseController(this.accountController),this.accountController.recharge_western_union()},account_recharge_teletrans:function(){this._triggerCloseController(this.accountController),this.accountController.recharge_telegraph_transfer()},account_recharge_banktrans:function(){this._triggerCloseController(this.accountController),this.accountController.recharge_bank_transfer()},account_recharge_voucher:function(){this._triggerCloseController(this.accountController),this.accountController.recharge_voucher()},account_recharge_transfer:function(){this.accountController.recharge_transfer()},account_recharge_balance:function(){this.accountController.recharge_balance()},account_recharge_doku_alfamart:function(){this._triggerCloseController(this.accountController),this.accountController.recharge_doku_alfamart()},account_recharge_doku_atm:function(){this._triggerCloseController(this.accountController),this.accountController.recharge_doku_atm()},account_recharge_doku_epay:function(){this._triggerCloseController(this.accountController),this.accountController.recharge_doku_epay()},account_recharge_doku_mandiri:function(){this._triggerCloseController(this.accountController),this.accountController.recharge_doku_mandiri()},account_recharge_doku_wallet:function(){this._triggerCloseController(this.accountController),this.accountController.recharge_doku_wallet()},account_recharge_dompetku:function(){this._triggerCloseController(this.accountController),this.accountController.recharge_dompetku()},account_recharge_mimopay:function(){this._triggerCloseController(this.accountController),this.accountController.recharge_mimopay()},account_recharge_esewa:function(){this._triggerCloseController(this.accountController),this.accountController.recharge_esewa()},account_recharge_yippster:function(){this._triggerCloseController(this.accountController),this.accountController.recharge_yippster()},account_recharge_paytm:function(){this._triggerCloseController(this.accountController),this.accountController.recharge_paytm()},chatroom_info:function(){this._triggerCloseController(this.chatroomInfoController),this.chatroomInfoController.index()},migcore_page:function(a){this._triggerCloseController(this.migcoreContainmentController),this._setMigcoreContainmentPageTitle(a),this.migcoreContainmentController.index(a)},miniblog_page:function(a){this._triggerCloseController(this.migboContainmentController),this.migboContainmentController.index(a)},profile_fallback:function(a){var b=/[\w\d\.-]{1,42}/g;b.test(a)?this.profile(a):this.error()},share:function(a){window.location.href=t.site+"share/"+a},error:function(){window.location.href=t.site+"error"},_setMigcoreContainmentPageTitle:function(b){if("undefined"!=typeof b){var c,d,f;b.indexOf("/")>-1&&(f=b.split("/"),f.length>0&&(c=f[1],d=a.trim(c.charAt(0).toUpperCase()+c.slice(1)).replace("Bot",e.translate("game|games")),e.show_document_title(d+" - migme")))}},_triggerCloseController:function(a){"undefined"!=typeof u&&null!==u&&u!==a&&u.trigger("controller:closed"),u=a}});return v}),define("modules/mig33_router",["backbone","backbone.marionette","modules/globals/session_user","modules/common/utility"],function(a,b,c,d){var e=b.AppRouter.extend({appRoutes:{"":"index","home(/)":"index","watchlist(/)":"watchlist","u/:u/post/:p(/)":"single_post","u/:u/post/:p/*parts(/)":"single_post","u/:u(/)":"profile","u/:u/about(/)":"about","u/:u/fans(/)":"followers","u/:u/fanof(/)":"following","u/:u/mentions(/)":"mentions","u/:u/friends(/)":"friends","u/:u/badges(/)":"badges","u/:u/badges/archived(/)":"badges_archives","u/:u/badge/:id":"badges","u/:u/achievements(/)":"achievements","u/:u/achievement/:id(/)":"achievements","u/:u/gifts/recent(/)":"recent_gifts","u/:u/gifts/favorite(/)":"favorite_gifts","u/:u/gifts(/)":"gifts","u/:u/gifts/*any":"gifts","u/:u/favorite_gifts(/)":"favorite_gifts","u/:u/games(/)":"games","u/:u/groups(/)":"groups","u/:u/chatrooms(/)":"chatrooms","u/:u/coverphoto(/)":"coverphoto","migalert(/)":"migalert","games(/)":"gamecenter",
"games?id=*any":"gamecenter","music(/)":"musiccenter","music/*any":"musiccenter","music?provider=*any&type=*any&id=*any":"musiccenter","discover(/)":"discover_migworld","discover/?path=*any":"discover_migworld","discover/recommended_people(/)":"discover","discover/addressbook_users(/)":"discover_abc","discover/recommended_people_country(/)":"discover_rec_user_country","search(/)":"search_posts","search/posts/*any":"search_posts","search/users/meetrandom":"search_users_random","search/users/*any":"search_users","search/topics/*any":"search_topics","search/chatrooms/*any":"search_chatrooms","group(/)":"group_index","group/create(/)":"group_create","group/:group_id(/)":"group_page","group/:group_id/:page(/)":"group_page","g/:group_id/:u/post/:id(/)":"group_single_post","store(/)":"store","store/?username=*any":"store","store/search/:category_id(/)":"store_search","store/search/:category_id/?*any":"store_search","store/category/:category_id(/:filter)(/:sortby)(/:sortorder)(/)":"store_category","store/item/:item_id(/)":"store_item","store/item/:item_id/?username=*any":"store_item","u/:u/store/:type/received/:received_id(/)":"store_item_received","u/:u/store/:type/inventory(/:item_id)(/)":"store_item_inventory","credit(/)":"account","credit/about":"account_about","credit/pending":"account_pending","credit/recharge":"account_recharge","credit/recharge/merchant":"account_recharge_merchant","credit/recharge/merchant/location/?name=(:name)":"account_recharge_merchant_search_location","credit/recharge/merchant/location(/:country_id)(/)":"account_recharge_merchant_location","credit/recharge/paypal":"account_recharge_paypal","credit/recharge/creditcard":"account_recharge_creditcard","credit/recharge/skrill":"account_recharge_skrill","credit/recharge/mol":"account_recharge_mol","credit/recharge/western_union":"account_recharge_westernunion","credit/recharge/tele_trans":"account_recharge_teletrans","credit/recharge/bank_trans":"account_recharge_banktrans","credit/recharge/voucher":"account_recharge_voucher","credit/history":"account_recharge_balance","credit/transfer":"account_recharge_transfer","credit/recharge/doku_alfamart":"account_recharge_doku_alfamart","credit/recharge/doku_atm":"account_recharge_doku_atm","credit/recharge/doku_epay":"account_recharge_doku_epay","credit/recharge/doku_mandiri":"account_recharge_doku_mandiri","credit/recharge/doku_wallet":"account_recharge_doku_wallet","credit/recharge/dompetku":"account_recharge_dompetku","credit/recharge/mimopay":"account_recharge_mimopay","credit/recharge/esewa":"account_recharge_esewa","credit/recharge/yippster":"account_recharge_yippster","credit/recharge/paytm":"account_recharge_paytm","chatroom/*any":"chatroom_info","v4/sites/*parts":"migcore_page","v4/debug/*parts":"migcore_page","bv4/*parts":"miniblog_page","tag/migup":"miniblog_page","tag/migup/*parts":"miniblog_page","web/captcha":"miniblog_page","web/captcha?:q":"miniblog_page","web/captcha/*parts":"miniblog_page","wap/captcha":"miniblog_page","wap/captcha?:q":"miniblog_page","wap/captcha/*parts":"miniblog_page",captcha:"miniblog_page","captcha?:q":"miniblog_page","captcha/*parts":"miniblog_page","u/:u/followers(/)":"followers","u/:u/following(/)":"following","discover/migworld(/)":"discover_migworld","discover/migworld/?path=*any":"discover_migworld","account(/)":"account","account/recharge/merchant":"account_recharge_merchant","account/recharge/merchant/location/?name=(:name)":"account_recharge_merchant_search_location","account/recharge/merchant/location(/:country_id)(/)":"account_recharge_merchant_location","share/*any":"share","asdf(/)":"store","settings/account":"store","*any":"profile_fallback"},onRoute:function(){var b="container";if(("games"==a.history.fragment||"music"==a.history.fragment||a.history.fragment.indexOf("music/")>=0)&&(b="container-fluid"),$("#main").removeClass().addClass(b),"object"!=typeof dataLayer||"undefined"!=typeof a.history.firstLoad&&a.history.firstLoad!==!1||dataLayer.push({event:"sendVirtualPageview",vpv:"/"+a.history.fragment,virtualPageTitle:document.title}),window.self!==window.top){$("body").append("<a href="+window.url.site+' class="gotoMigme"><div>More trending stories here <span></span></div></a>');var c=0;$(".gotoMigme div").slideUp(),$(window).scroll(function(a){var b=$(this).scrollTop();b>c&&$(".gotoMigme div").slideDown(800,"easeOutBounce"),c=b})}$(".profile-hovercard").each(function(){$(this).qtip("api")&&$(this).qtip("api").destroy()}),d.inline_svg()}});return e}),define("mig33_backbone",["backbone"],function(a){return a.Model.prototype.parse=function(a){return a.error&&0!==a.error.errno?[]:a.data?a.data:a},a.Collection.prototype.parse=a.Model.prototype.parse,a}),require.config({paths:{jquery:"../components/jquery/dist/jquery",bb:"../components/backbone/backbone",underscore:"../components/underscore/underscore","underscore.string":"../components/underscore.string/lib/underscore.string",text:"../components/requirejs-text/text",handlebars:"../components/handlebars/handlebars","backbone.babysitter":"../components/backbone.babysitter/lib/amd/backbone.babysitter","backbone.wreqr":"../components/backbone.wreqr/lib/amd/backbone.wreqr","backbone.marionette":"../components/marionette/lib/core/amd/backbone.marionette",marionette_handlebars:"../components/backbone.marionette.handlebars/backbone.marionette.handlebars",hbs:"../components/requirejs-hbs/hbs",bootstrap:"../components/bootstrap/dist/js/bootstrap","jquery.mousewheel":"../components/jquery-mousewheel/jquery.mousewheel",fancybox:"../components/fancybox/source/jquery.fancybox","fancybox.buttons":"../components/fancybox/source/helpers/jquery.fancybox-buttons","fancybox.thumbs":"../components/fancybox/source/helpers/jquery.fancybox-thumbs","jquery.cookie":"../components/jquery.cookie/jquery.cookie","jquery.scrollTo":"../components/jquery.scrollTo/jquery.scrollTo",jstorage:"../components/jstorage/jstorage","jquery.atwho":"../components/jquery.atwho/dist/js/jquery.atwho",imagesloaded:"../components/imagesloaded/imagesloaded","eventEmitter/EventEmitter":"../components/eventEmitter/EventEmitter","eventie/eventie":"../components/eventie/eventie",backgrid:"../components/backgrid/lib/backgrid",chosen:"../components/chosen/public/chosen.jquery",cropper:"../components/cropper/dist/cropper",qtip:"./vendor/jquery.qtip/mig33.qtip",CLDRPluralRuleParser:"./vendor/jquery.i18n/CLDRPluralRuleParser","jquery.i18n":"./vendor/jquery.i18n/jquery.i18n.min",jqueryui:"./vendor/jqueryui/jquery-ui-1.10.0.custom.min",easypaginate:"./vendor/jquery.easypaginate","jquery.loadmask":"./vendor/jquery.loadmask","jquery.rule":"./vendor/jquery.rule","jquery.textinputs":"./vendor/jquery.textinputs.min","jquery.caret":"./vendor/jquery.caret","jquery.mentions":"./vendor/jquery.mentions/jquery.mentions","bootstrapx-clickover":"./vendor/bootstrapx-clickover","jquery.highlight-4":"./vendor/jquery.highlight-4.min","jquery.tag-it":"./vendor/jquery.tag-it","jquery.json":"./vendor/jquery.json.min","jquery.waypoints":"./vendor/jquery.waypoints","jquery.timeago":"./vendor/jquery.timeago","jquery.tinysort":"./vendor/jquery.tinysort","jquery.menuaim":"./vendor/jquery.menu-aim","jquery.mCustomScrollbar":"./vendor/jquery.mCustomScrollbar","jquery.autosize":"./vendor/jquery.autosize.min","jquery.readmore":"./vendor/readmore",tourist:"./vendor/tourist",slick:"./vendor/slick",mig33_backbone:"../scripts/mig33_backbone"},shim:{jquery:{exports:"jQuery"},underscore:{exports:"_"},handlebars:{exports:"Handlebars"},bb:{deps:["underscore","jquery"],exports:"Backbone"},backgrid:{deps:["underscore","bb"]},"backbone.babysitter":{deps:["underscore","bb"]},"backbone.wreqr":{deps:["underscore","backbone"],exports:"Backbone.Wreqr"},"backbone.marionette":{deps:["backbone.babysitter"],exports:"Marionette"},marionette_handlebars:{deps:["backbone.marionette"]},bootstrap:{deps:["jquery"]},"bootstrapx-clickover":{deps:["bootstrap"]},"jquery.caret":{deps:["jquery"]},"jquery.atwho":{deps:["jquery.caret"]},"jquery.mousewheel":{deps:["jquery"]},"jquery.tinysort":{deps:["jquery"]},"jquery.cookie":{deps:["jquery"]},"jquery.highlight-4":{deps:["jquery"]},"jquery.tag-it":{deps:["jquery","jqueryui"]},"jquery.json":{deps:["jquery"]},"jquery.scrollTo":{deps:["jquery"]},"jquery.mentions":{deps:["jquery","underscore"]},fancybox:{deps:["jquery","jquery.mousewheel"]},"fancybox.buttons":{deps:["jquery","jquery.mousewheel","fancybox"]},"fancybox.thumbs":{deps:["jquery","jquery.mousewheel","fancybox"]},mig33_backbone:{deps:["underscore","backbone.marionette"],exports:"Backbone"},less:{exports:"less"},"jquery.i18n":{deps:["jquery","CLDRPluralRuleParser"]},"jquery.ui":{deps:["jquery"]},qtip:{deps:["jquery","imagesloaded"]},imagesloaded:{deps:["jquery"]},jstorage:{deps:["jquery"]},easypaginate:{deps:["jquery"]},"jquery.loadmask":{deps:["jquery"]},"jquery.rule":{deps:["jquery"]},"jquery.textinputs":{deps:["jquery"]},jqueryui:{deps:["jquery"]},"jquery.waypoints":{deps:["jquery"]},"jquery.timeago":{deps:["jquery"]},"jquery.menuaim":{deps:["jquery"]},"jquery.mCustomScrollbar":{deps:["jquery","jquery.mousewheel"]},chosen:{deps:["jquery"]},tourist:{exports:"Tourist",deps:["jquery","bootstrap"]},"jquery.autosize":{deps:["jquery"]},"jquery.readmore":{deps:["jquery"]},slick:{deps:["jquery"]}},map:{"*":{backbone:"bb"},"modules/*":{backbone:"mig33_backbone"}}}),require(["jquery","backbone","underscore","handlebars","backbone.marionette","marionette_handlebars","modules/mig33_app","modules/app_controller","modules/mig33_router","modules/common/session_user","modules/globals/session_user","modules/globals/session_user_settings","modules/globals/settings","modules/globals/url","modules/globals/variable","modules/template/helpers/general_helpers","modules/template/helpers/user_helpers","mig33_backbone"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){return j.initialize(k),g.addInitializer(function(a){var b=new h({});new i({controller:b})}),g.start({root:window.location.pathname,path_root:"/"}),{}}),define("main",function(){});